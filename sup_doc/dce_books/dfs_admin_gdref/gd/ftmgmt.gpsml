...\"
...\" @OSF_COPYRIGHT@
...\" COPYRIGHT NOTICE
...\" Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
...\" ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
...\" src directory for the full copyright text.
...\"
...\"
...\" HISTORY
...\" $Log: ftmgmt.gpsml,v $
...\" Revision 1.1.9.3  1996/09/16  20:07:07  wfl
...\" 	Added editorial changes
...\" 	[1996/09/16  20:05:43  wfl]
...\"
...\" Revision 1.1.9.2  1996/08/20  15:40:09  wfl
...\" 	{enh,13605,R1.2.2}
...\" 	Security enhancement
...\" 	[1996/08/20  15:37:47  wfl]
...\" 
...\" Revision 1.1.9.1  1996/05/14  19:52:22  wardr
...\" 	{enh,R1.2.2}
...\" 	Removed changebars
...\" 	[1996/05/14  19:51:13  wardr]
...\" 
...\" Revision 1.1.7.26  1995/07/24  18:42:39  weir
...\" 	Prentice-Hall corrections
...\" 	[1995/07/24  18:42:03  weir]
...\" 
...\" Revision 1.1.7.24  1994/10/14  19:35:25  jeff
...\" 	{defect, 12535, R1.1}
...\" 	Incorporate dcecp commands in DFS documentation.
...\" 	[1994/10/14  19:33:56  jeff]
...\" 
...\" Revision 1.1.7.23  1994/08/23  21:10:49  jeff
...\" 	Editorial changes.
...\" 	[1994/08/23  21:09:42  jeff]
...\" 
...\" Revision 1.1.7.22  1994/08/16  20:22:59  jeff
...\" 	Editorial work on Salvager text.
...\" 	[1994/08/16  20:22:37  jeff]
...\" 
...\" Revision 1.1.7.21  1994/07/25  22:24:42  jeff
...\" 	Still cleaning up....
...\" 	[1994/07/25  22:24:27  jeff]
...\" 
...\" Revision 1.1.7.20  1994/07/25  22:17:53  jeff
...\" 	More editorial cleanup.
...\" 	[1994/07/25  22:17:41  jeff]
...\" 
...\" Revision 1.1.7.19  1994/07/25  21:37:52  jeff
...\" 	Many editorial changes.
...\" 	[1994/07/25  21:37:26  jeff]
...\" 
...\" Revision 1.1.7.18  1994/06/03  17:55:45  jeff
...\" 	More editorial corrections (sigh).
...\" 	[1994/06/03  17:55:28  jeff]
...\" 
...\" Revision 1.1.7.17  1994/06/03  12:20:39  jeff
...\" 	Made some small editorial corrections.
...\" 	[1994/06/03  12:20:25  jeff]
...\" 
...\" Revision 1.1.7.16  1994/05/19  20:51:22  jeff
...\" 	{defect, 8118, R1.1}
...\" 	Correct use of double quotes.
...\" 	[1994/05/19  20:50:57  jeff]
...\" 
...\" Revision 1.1.7.15  1994/05/10  19:31:02  jeff
...\" 	{defect, 8118, R1.1}
...\" 	Work release notes into documentation (forgot index tags).
...\" 	[1994/05/10  19:29:46  jeff]
...\" 
...\" Revision 1.1.7.14  1994/05/10  19:12:07  jeff
...\" 	{defect, 8118, R1.1}
...\" 	Work release notes into documentation.
...\" 	[1994/05/10  19:11:30  jeff]
...\" 
...\" Revision 1.1.7.13  1994/05/04  21:33:19  jeff
...\" 	{defect, 10527, R1.1}
...\" 	Create structure for new DFS documentation organization.
...\" 	[1994/05/04  21:31:16  jeff]
...\" 
...\" Revision 1.1.7.12  1994/04/28  22:22:12  jeff
...\" 	{defect, 10439, R1.1}
...\" 	Correct cross-references for reorganization of DFS documentation.
...\" 	[1994/04/28  22:16:50  jeff]
...\" 
...\" Revision 1.1.7.11  1994/04/23  19:59:32  jeff
...\" 	{defect, 10440, R1.1}
...\" 	Incorporate user information into admin documentation; make simple
...\" 	editorial changes as necessary.
...\" 	[1994/04/23  19:49:54  jeff]
...\" 
...\" Revision 1.1.7.10  1994/04/05  20:48:41  zahn
...\" 	{enh,5923,R1.1}
...\" 	Fixed cross-references to now-defunct User's Guide
...\" 	and Reference.
...\" 	[1994/04/05  20:48:09  zahn]
...\" 
...\" Revision 1.1.7.9  1993/10/14  14:13:15  jeff
...\" 	{def,9066,R1.0.3}
...\" 	The dfsexport command with no options needs no privileges.
...\" 	[1993/10/14  14:12:47  jeff]
...\" 
...\" Revision 1.1.7.8  1993/10/13  20:47:04  tmw
...\" 	Index correction
...\" 	[1993/10/13  20:46:04  tmw]
...\" 
...\" Revision 1.1.7.7  1993/10/06  20:41:58  tmw
...\" 	Added index entries for second version of master index.
...\" 	[1993/10/06  20:41:08  tmw]
...\" 
...\" Revision 1.1.7.6  1993/09/23  13:05:47  kdu
...\" 	{def,7526,R1.0.3}
...\" 	Moving filesets between cells.
...\" 	[1993/09/23  13:04:35  kdu]
...\" 
...\" Revision 1.1.7.5  1993/09/15  21:58:20  kdu
...\" 	{def,5778,R1.0.3}
...\" 	Short forms of machine names.
...\" 
...\" 	{def,6358,R1.0.3}
...\" 	Fileset quota interface changes.
...\" 	[1993/09/15  21:56:14  kdu]
...\" 
...\" Revision 1.1.7.4  1993/09/01  15:56:54  kdu
...\" 	{def,8439,R1.0.3}
...\" 	Removed references to the dfsatab file.
...\" 
...\" 	{def,8512,R1.0.3}
...\" 	Rationalized and updated descriptions of fts syncfldb and fts syncserv.
...\" 	[1993/09/01  15:55:57  kdu]
...\" 
...\" Revision 1.1.7.3  1993/08/10  23:56:57  jeff
...\" 	Changed versions for defect fixes from 1.0.2A to 1.0.3.
...\" 	[1993/08/10  23:55:52  jeff]
...\" 
...\" Revision 1.1.7.2  1993/07/30  16:50:44  jeff
...\" 	{def,8386,R1.0.3}
...\" 	Incorporate OSF editorial comments into DFS Admin Guide and related
...\" 	documentation.
...\" 	[1993/07/30  16:49:20  jeff]
...\" 
...\" Revision 1.1.5.17  93/02/22  18:18:07  jeff
...\" 	Fix for defect 7219, review comments.
...\" 	[1993/02/22  18:17:22  jeff]
...\" 
...\" Revision 1.1.5.16  1993/02/09  01:43:24  jeff
...\" 	Fix for defect 7156, correct dump/restore restrictions.
...\" 	[1993/02/09  01:41:32  jeff]
...\" 
...\" Revision 1.1.5.15  1993/02/05  20:30:44  jeff
...\" 	Fix for defect 7135, change key file to keytab file.
...\" 	[1993/02/05  20:10:04  jeff]
...\" 
...\" Revision 1.1.5.14  1993/02/04  02:08:34  jeff
...\" 	Fix for defects 7063, 7023, 6999, 6960, 6837, and 4013.
...\" 	[1993/02/04  02:05:42  jeff]
...\" 
...\" Revision 1.1.5.13  1993/01/28  19:05:55  dbelch
...\" 	Embedding copyright notice
...\" 	[1993/01/28  18:29:50  dbelch]
...\" 
...\" Revision 1.1.5.12  1993/01/27  20:07:43  buckler
...\" 	Fixed cross-refs and figure calls for new book org
...\" 	[1993/01/27  20:05:28  buckler]
...\" 
...\" Revision 1.1.5.11  1993/01/27  19:19:03  jeff
...\" 	... TEMPORARY CHECK-IN TO ALLOW FOR OSF WORK....
...\" 	[1993/01/27  19:05:33  jeff]
...\" 
...\" Revision 1.1.5.10  1993/01/19  16:36:20  jeff
...\" 	Small clarification to fix for defect 6223.
...\" 	[1993/01/19  16:25:55  jeff]
...\" 
...\" Revision 1.1.5.9  1993/01/12  14:37:14  jeff
...\" 	Fix for defect 6223, df now works for DCE LFS aggregates.
...\" 	[1993/01/12  14:36:12  jeff]
...\" 
...\" Revision 1.1.5.8  1992/12/15  00:47:27  jeff
...\" 	Fix for defect 6447, add new -server option to fts dump
...\" 	command (and other small edits).
...\" 	[1992/12/15  00:46:39  jeff]
...\" 
...\" Revision 1.1.5.7  1992/12/14  20:23:57  jeff
...\" 	Fix for defect 6446, add new -server option to fts lsft
...\" 	command.
...\" 	[1992/12/14  20:23:06  jeff]
...\" 
...\" Revision 1.1.5.6  1992/12/03  09:52:54  jeff
...\" 	Fix for defect 5383, correct aggregate command privileges.
...\" 	[1992/12/03  09:49:53  jeff]
...\" 
...\" Revision 1.1.5.5  1992/11/13  00:56:56  jeff
...\" 	Fix for defect 5120, correct description of -localauth option.
...\" 	[1992/11/13  00:54:33  jeff]
...\" 
...\" Revision 1.1.5.4  1992/11/09  21:15:38  jeff
...\" 	Make small fts rmsite clarifications.
...\" 	[1992/11/09  21:14:19  jeff]
...\" 
...\" Revision 1.1.5.3  1992/11/02  20:31:45  jeff
...\" 	Fix for defect 5879, remove additional local-mounting restrictions.
...\" 	[1992/11/02  20:09:16  jeff]
...\" 
...\" Revision 1.1.5.2  1992/08/26  12:10:31  weir
...\" 	Removed change bars
...\" 	[1992/08/26  11:53:46  weir]
...\" 
...\" Revision 1.1.2.16  1992/07/02  18:52:11  jeff
...\" 	Verifying recent changes.
...\" 	[1992/07/02  18:50:39  jeff]
...\" 
...\" Revision 1.1.2.15  1992/07/02  18:12:15  jeff
...\" 	Corrected ACL permissions and small editorial stuff.
...\" 	[1992/07/02  18:10:13  jeff]
...\" 
...\" Revision 1.1.2.14  1992/06/25  13:34:32  jeff
...\" 	Included information on the df restriction.
...\" 	[1992/06/25  01:08:52  jeff]
...\" 
...\" Revision 1.1.2.13  1992/06/15  17:17:59  jeff
...\" 	Included text stating that a fileset's quota can be larger
...\" 	than the size of the aggregate on which it resides.
...\" 	[1992/06/15  16:44:26  jeff]
...\" 
...\" Revision 1.1.2.12  1992/06/04  18:19:48  jeff
...\" 	Included cfe's review comments.
...\" 	[1992/06/04  18:06:38  jeff]
...\" 
...\" Revision 1.1.2.11  1992/06/03  21:37:20  jeff
...\" 	Included a new section documenting the usage and syntax
...\" 	of the new growaggr administrative command.
...\" 	[1992/06/03  21:14:34  jeff]
...\" 
...\" Revision 1.1.2.10  1992/05/20  19:45:15  jeff
...\" 	Corrected referenced OT defect number (3369 to 3669).
...\" 	[1992/05/20  19:34:37  jeff]
...\" 
...\" 	Modified existing text and added new text to document the
...\" 	salvage command's new -norecover and -nosalvage options
...\" 	and their functionality.
...\" 	[1992/05/20  19:22:27  jeff]
...\" 
...\" Revision 1.1.2.9  1992/05/12  16:10:42  jeff
...\" 	Verified and/or modified italics and other editorial
...\" 	aspects of the file.
...\" 	[1992/05/12  14:59:00  jeff]
...\" 
...\" Revision 1.1.2.8  1992/05/07  15:19:32  jeff
...\" 	Modified general description of "mounted locally."
...\" 	[1992/05/07  00:16:54  jeff]
...\" 
...\" Revision 1.1.2.7  1992/04/29  22:21:03  jeff
...\" 	Added .zA/.zZ "enh, 13605, R1.2.2, Security enhancements" tags around -noauth/-localauth changes.
...\" 	[1992/04/29  22:14:48  jeff]
...\" 
...\" Revision 1.1.2.6  1992/04/29  19:03:31  jeff
...\" 	Modified syntax and description of -noauth and -localauth options.
...\" 	[1992/04/29  15:25:10  jeff]
...\" 
...\" Revision 1.1.2.5  1992/04/24  22:53:38  jeff
...\" 	Changed syntax of -fast and -long options on fts lsheader
...\" 	command.
...\" 	[1992/04/23  21:13:34  jeff]
...\" 
...\" Revision 1.1.2.4  1992/04/22  13:18:38  jeff
...\" 	Modified description of the meaning of the status flag for
...\" 	read-only filesets.  Also made some small formatting edits.
...\" 	[1992/04/21  16:27:00  jeff]
...\" 
...\" Revision 1.1.2.3  1992/04/17  22:42:25  jeff
...\" 	Many changes, some involving reorganization, to explain the real
...\" 	  functionality of the fts restore command and the conditions under
...\" 	  which it can be used.  The text is now more accurate and clearer
...\" 	  than it ever was.
...\" 	[1992/04/17  21:15:05  jeff]
...\" 
...\" Revision 1.1.2.2  1992/04/09  14:00:34  jeff
...\" 	Small fix to .zA/.zZ "enh, 13605, R1.2.2, Security enhancements" tag pair.
...\" 	[1992/04/09  13:17:51  jeff]
...\" 
...\" 	Made a small editorial change (changed a Note to a Caution).
...\" 	[1992/04/09  12:35:45  jeff]
...\" 
...\" Revision 1.1  1992/01/29  16:14:59  damon
...\" 	Initial revision
...\" 
...\" $EndLog$
...\"
...\" (c) Copyright 1991, Open Software Foundation, Inc.  ALL RIGHTS RESERVED
..."Copyright (C) 1989, 1991, Transarc Corporation
..."The Gulf Tower
..."707 Grant Street
..."Pittsburgh, PA  15219
...\" CHANGED
...\" 12-10-91:  In Section 7.2.1.1, added a paragraph break after
...\"            "Interpreting the Output" (middle of page 7-4).
...\" 12-10-91:  In Section 7.2.2.1, added a paragraph break after
...\"            "Interpreting the Output" (top of page).
...\" 12-10-91:  In Section 7.2.4.3, added an additional paragraph break to
...\"            reformat the example output for the cm whereis command.
...\" END CHANGED
...\"DOCUMENTSTYLE [12pt]{book}
.H 1 "Managing Filesets"
.iX "-[" "filesets" "managing"
.P
This chapter explains in detail how to manage filesets in DFS. It describes
how to obtain information about filesets, aggregates, and partitions, how to
set fileset quotas, and how to rename, move, dump, restore, and delete
filesets.  It also details how to verify and maintain the consistency of your
filesets and how to recover from possible file system problems.  Where
applicable, the management of filesets in other file systems is discussed.
.P
Chapter 6 provides details about how to export aggregates and partitions,
and how to create, replicate, backup, and mount filesets.  It also provides a
general overview of filesets and the differences between DCE LFS and non-LFS
filesets. (See Chapter 6 for introductory information about filesets.)
.H 2 "An Overview of Fileset Terminology"
.iX "filesets" "LFS and non-LFS compared"
.iX "-[" "filesets" "types"
.P
DCE LFS aggregates are similar to the disk partitions that are found in
UNIX and other operating systems.  However, a DCE LFS aggregate also supports
specialized fileset-level operations, such as quota-checking and cloning, and
low-level operations, such as logging of metadata.
.P
Each DCE LFS aggregate exported to the DCE namespace can house multiple
filesets; filesets stored on DCE LFS aggregates are referred to as DCE LFS
filesets.  Each exported non-LFS disk partition can house only a single fileset;
file systems stored on non-LFS partitions are referred to as non-LFS filesets.
Most of the specialized features supported for DCE LFS filesets are not
supported for non-LFS filesets.
.P
In DFS, only a single type of each non-LFS fileset is available: the version
that was made available when the partition on which it resides was exported.
However, three types of each DCE LFS fileset are available:
.ML
.LI
A \*Eread/write version\*O of a DCE LFS fileset contains modifiable versions
of the files and directories in that fileset.  Every DCE LFS fileset begins as
a single read/write fileset.  Other fileset types are derived from the
read/write version by creating an exact copy, or replica, of all of the data
in the read/write, source fileset.  There can be only one read/write version of
a fileset.
.LI
.iX "filesets" "read-only"
A \*Eread-only fileset\*O is a copy of a read/write, source DCE LFS fileset.
Read-write filesets can be replicated and placed at various sites in the file
system.  Every read-only copy of a fileset shares the name of the source
fileset, with the addition of a \*L.readonly\*O extension.  If a read/write
source changes, its read-only replicas can be updated to match.  Every
read-only copy of a read/write fileset is generally the same; however, replicas
at different sites can differ in controlled ways according to the replication
parameters associated with the fileset.
.LI
.iX "filesets" "backup"
A \*Ebackup fileset\*O is a clone of a read/write, source DCE LFS fileset.  It
is stored at the same site and with the same name as the source, with the
addition of a \*L.backup\*O extension.
.LE
.nL
.ne 20
.P
.iX "Fileset Location Database" "contents"
For both DCE LFS and non-LFS filesets, the Fileset Location Server (FL Server)
maintains the Fileset Location Database (FLDB).  The database records
information about the location of all filesets in a cell.  Every read/write
fileset has an entry in the FLDB.  Each entry for a DCE LFS fileset also
includes information about the fileset's read-only and backup versions.  For
each fileset, the information in the entry includes fileset names, ID numbers,
site definitions, and status flags for the sites.
.P
.iX "fileset headers" "about"
Information about DCE LFS filesets is also stored in fileset headers at each
site that contains a copy of the fileset.  Fileset headers are part of the data
structure that records the disk addresses on the aggregate of the files in the
fileset.  Fileset headers also record the fileset's name, ID number, size,
status flags, and the ID numbers of its copies.  Because the header records some
of the same information that appears in the FLDB, the \*Lfts\*O program can
access the information in the header if the FLDB becomes unavailable.  The FLDB
entry and the fileset header must always be synchronized; any \*Lfts\*O
commands that affect fileset status automatically record the change in the
appropriate FLDB entry.
.P
(See Chapter 6 for detailed information about DCE LFS filesets, non-LFS
filesets, and how the two types of filesets are created.)
.iX "-]" "filesets" "types"
.H 2 "Standard Options and Arguments"
.P
When using the \*Lfts\*O commands to create, manipulate, or delete filesets,
you can often add the \*L\-verbose\*O option to receive detailed information
from the \*Lfts\*O program about its actions as it executes the command.  This
can be particularly helpful if an operation fails for a reason that you do not
understand.  The amount of additional information produced by the
\*L\-verbose\*O option varies for different commands.
.P
The following options and arguments are common to many of the commands
described in this chapter.  If an option or argument is not described with a
command in the text, a description of it appears here. (See Part 2 of this
guide and reference for complete details about each command.)
.ML
.LI
The \*L\-fileset\*V name\*O option is the complete name (for example,
\*Luser.sandy\*O) or ID number (for example, \*L0,,34692\*O) of the fileset to
be used in the command.
.nL
.ne 20
.LI
The \*L\-server\*V machine\*O option is the File Server machine to use with 
the command.  Unless otherwise indicated, you can use any of the following to 
specify the File Server machine:
.ML
.LI
The machine's DCE pathname (for example, \*L/.../abc.com/hosts/fs1\*O)
.LI
The machine's host name (for example, \*Lfs1.abc.com\*O or \*Lfs1\*O)
.LI
The machine's IP address (for example, \*L11.22.33.44\*O)
.LE
.LI
The \*L\-aggregate\*V name\*O option is the device name (for example,
\*L/dev/lv01\*O), the aggregate name (for example, \*Llfs1\*O or \*L/usr\*O),
or the aggregate ID (for example, \*L3\*O or \*L12\*O) of the aggregate or
partition to be used in the command.  These identifiers are specified in the
first, second, and fourth fields of the entry for the aggregate or partition
in the \*Vdcelocal\*L/var/dfs/dfstab\*O file.
.LI
The \*L\-cell\*V cellname\*O option specifies the cell with respect to which the
command is to be run (for example, \*Labc.com\*O).  The default is the local
cell of the issuer of the command.
.LI
The \*L\-noauth\*O option directs the \*Lfts\*O program to use the unprivileged
identity \*Lnobody\*O as the identity of the issuer of the command.  If DFS
authorization checking has been disabled with the \*Lbos setauth\*O command,
the identity \*Lnobody\*O has the necessary privileges to perform any
operation. (See Chapter 4 for information about disabling DFS authorization
checking.) If you use the \*L\-noauth\*O option, do not use the
\*L\-localauth\*O option.
.LI
The \%\*L-localauth\*O option directs the \*Lfts\*O program to use the DFS server
principal of the machine on which the command is issued as the identity of the
issuer.  Each DFS server machine has a DFS server principal stored in the
Registry Database.  A DFS server principal is a unique, fully qualified
principal name that ends with the string \*Ldfs-server\*O (for example,
\*L/.../abc.com/hosts/fs1/dfs-server\*O).  Do not confuse a machine's DFS server
principal with its unique \*Lself\*O identity. (See Chapter 6 for information
about DFS server principals.)
.P
Use the \*L-localauth\*O option only if the command is issued from a DFS server
machine.  You must be logged into the server machine as \*Lroot\*O for this
option to work.  If you use this option, do not use the \*L\-noauth\*O option.
.LE
.P
The \*L\-cell\*O, \*L\-noauth\*O, and \*L\-localauth\*O options are always
optional.
.H 2 "Listing Fileset Information"
.iX "-[" "filesets" "viewing information"
.P
The following commands are available for listing information about filesets:
.ML
.LI
The \*Lfts lsfldb\*O command is used to list information about filesets from
the FLDB.
.LI
The \*Lfts lsheader\*O command is used to list information from fileset
headers on File Server machines and aggregates.
.LI
The \*Lfts lsft\*O command is used to list information from both the FLDB
entry and the fileset header of a specific fileset.
.LE
.P
If you know only the name of a file or directory that is housed in a fileset,
you can use the \*Lfts lsquota\*O, \*Lfts lsft\*O, and \*Lcm whereis\*O
commands to access information about the fileset. (See Section 7.3.4 for
complete instructions on using these commands with file or directory names.)
.H 3 "Listing FLDB Information"
.iX "-[" "filesets" "viewing FLDB information" 
.iX "-[" "Fileset Location Database" "viewing fileset entries"
.iX "-[" "\*Lfts\*O command suite" "\*Llsfldb\*O"
.P
The \*Lfts lsfldb\*O command is used to display information from entries in the
FLDB for both DCE LFS and non-LFS filesets.  By combining the command's options
in different ways, you can tailor the type of information to be displayed, as
follows:
.ML
.LI
To display every FLDB entry, do not supply any options.
.LI
To display every FLDB entry that mentions a specific File Server machine as the
site of any version of a fileset, specify the machine name with the
\*L\-server\*O option.
.LI
To display every FLDB entry that mentions a specific aggregate on a specific
File Server machine as the site of any version of a fileset, specify both the
\*L\-server\*O and \*L\-aggregate\*O options.
.LI
To display the FLDB entries for filesets with locked entries, use the
\*L\-locked\*O option alone or with the \*L\-server\*O option (and optionally
the \*L\-aggregate\*O option).
.LI
To display a single FLDB entry, specify the fileset name or ID number with the
\*L\-fileset\*O option.
.LE
.P
To list information about fileset entries in the FLDB, enter the \*Lfts
lsfldb\*O command with the options described previously:
.iS
\*C$ \*Lfts lsfldb \*O[\*L\-fileset\*O {\*Vname\*O | \*VID\*O}] [\*L\-server \*Vmachine\*O] [\*L\-aggregate \*Vname\*O] [\*L\-locked\*O]
.iE
.P
The \*L\-locked\*O option lists information only for filesets with locked FLDB
entries.  Use the \*L\-locked\*O option alone or with the \*L\-server\*O option
(and optionally the \*L\-aggregate\*O option), or use the \*L\-fileset\*O option
to view the FLDB entry for a specific fileset.
.P
\*LInterpreting the Output\*O
.P
The output appears in the following order:
.ML
.LI
The fileset's name.
.LI
The fileset IDs of the read/write, read-only, and backup versions of the
fileset.
.LI
For each version of a fileset, a status flag of \*Lvalid\*O or \*Linvalid\*O
indicates whether it actually exists at some site.  For the read-only version,
it indicates whether a replication site is defined.
.zA
.LI
The minimum and maximum advisory RPC authentication bounds for the fileset.  There are two sets of bounds: one governing communications with Cache Managers in the local cell and another governing communications with Cache Managers in foreign cells.
.zZ "enh, 13605, R1.2.2, Security enhancements"
.LI
The number of sites at which a version of the fileset exists.
.LI
An indicator if the FLDB entry is locked.  The indicator is omitted if the entry
is not locked.
.LI
The replication parameters that are associated with the fileset.
.LI
Information identifying the File Server machines and aggregates (sites) where
read/write (\*LRW\*O), read-only (\*LRO\*O), or backup (\*LBK\*O) versions of
the fileset reside.
.LI
For a read-only version, the MaxSiteAge defined for that site.  For a read/write
version, \*L0:00:00\*O is displayed because no MaxSiteAge is associated with
that version.
.LI
The abbreviated DCE principal name of each File Server machine on which a
version of the fileset resides, and the name of the group that owns the server
entry for the machine or \*L<nil>\*O if no group owns the server entry.
.LE
.nL
.ne 20
.P
If the output includes more than one FLDB entry, information about the filesets
is displayed in alphabetical order by fileset name.  The last line of the output
displays the total number of entries that were successfully reported and the
total number of entries that were not reported (the number of entries that
failed).
.P
Following is an example of the output that this command generates for a single
DCE LFS fileset:
.iS
\*C$ \*Lfts lsfldb user.terry\*O
.iE
.zA "enh, 13605, R1.2.2, Security enhancements"
.oS
\s-1
\*Cuser.terry
\ \ \ \ \ \ \ \ readWriteID\ \ 0,,196953\ \ valid
\ \ \ \ \ \ \ \ readOnlyID\ \ \ 0,,196594\ \ invalid
\ \ \ \ \ \ \ \ backupID\ \ \ \ \ 0,,196595\ \ valid
Minimum local protection level: rpc_c_protect_level_none
Maximum local protection level: rpc_c_protect_level_pkt_privacy
Minimum remote protection level: rpc_c_protect_level_none
Maximum remote protection level: rpc_c_protect_level_pkt_privacy
number of sites:\ 1
 Sched repl: maxAge=2:00:00;failAge=1d0:00:00;reclaimWait=18:00:00;
 minRepDelay=0:05:00;defaultSiteAge=0:30:00
\ \ \ server\ \ \ \ \ \ \ \ flags\ \ \ aggr\ \ \ siteAge\ principal\ \ owner
fs3.abc.com\ \ \ \ \ \ RW,BK\ \ \ lfs1\ \ \ 0:00:00\ hosts/fs3\ \ <nil>\*O
\s+1
.oE
.zZ "enh, 13605, R1.2.2, Security enhancements"
.iX "-]" "\*Lfts\*O command suite" "\*Llsfldb\*O"
.iX "-]" "filesets" "viewing FLDB information"
.iX "-]" "Fileset Location Database" "viewing fileset entries"
.H 3 "Listing Fileset Header Information"
.iX "-[" "fileset headers" "viewing"
.iX "-[" "\*Lfts\*O command suite" "\*Llsheader\*O"
.P
The \*Lfts lsheader\*O command displays the fileset header from every DCE LFS
fileset on a File Server machine or one of its aggregates.  You control the
amount of information to be displayed by including the \*L\-fast\*O option to
display only the fileset ID number of each fileset, including the \*L\-long\*O
option to display all available information about each fileset, or omitting
both options to display a single line of information about each fileset.
Information about the filesets is displayed in numeric order by fileset ID
number if the \*L\-fast\*O option is used; otherwise, it is displayed in
alphabetical order by fileset name.  To view the header of a single DCE LFS
fileset, use the \*Lfts lsft\*O command, as described in Section 7.3.3.
.P
Non-LFS filesets do not have DCE LFS fileset headers. However, the \*Lfts
lsheader\*O command can still be used to display some local information, such
as fileset ID numbers, that is stored in the \*Vdcelocal\*L/var/dfs/dfstab\*O
file on a File Server machine.
.nL
.ne 20
.P
To list information from fileset headers, do the following:
.AL
.LI
Verify that you have the necessary privilege.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the filesets reside.  If necessary,
issue the \*Lbos lsadmin\*O command to verify the members of the list.
.LI
Issue the \*Lfts lsheader\*O command to display information from fileset
headers.  Include the \*L\-fast\*O or \*L\-long\*O option to see less or more
information.
.iS
\*C$ \*Lfts lsheader -server \*Vmachine\*O [\*L\-aggregate \*Vname\*O] [{\*L\-fast\*O | \*L\-long\*O}]
.iE
.LE
.P
\*LInterpreting the Output\*O
.P
Following is an example of the output from this command when it is executed
with the \*L\-fast\*O option:
.iS
\*C$ \*Lfts lsheader /.../abc.com/hosts/fs3 /dev/lfs1 -fast\*O
.iE
.oS
\*C0,,196953
0,,196956
\ \ \ \ .
\ \ \ \ .
0,,199845
0,,199846\*O
.oE
.P
When you omit both the \*L\-fast\*O and \*L\-long\*O options, the command
produces the following information: 
.ML
.LI
The File Server machine name, aggregate name, and aggregate ID number where
the filesets reside.
.LI
The total number of filesets on the aggregate.
.LI
Each fileset's name (with a \*L.readonly\*O or \*L.backup\*O extension, if
appropriate).
.LI
Each fileset's ID number.
.LI
Each fileset's type (\*LRW\*O for read/write, \*LRO\*O for read-only, or
\*LBK\*O for backup).
.LI
Each fileset's allocation usage and quota usage, in kilobytes.
.nL
.ne 20
.LI
Each fileset's status (\*LOn-line\*O, \*LOff-line\*O, or an error indicator).
.LI
The total number of filesets online, the total number of filesets offline,
and the total number of filesets busy.  A busy fileset is one upon which a
fileset-related operation is currently in progress (for example, the fileset
is being moved or cloned, or the Replication Server is currently forwarding
changes from the fileset to read-only replicas).
.LE
.P
Following is an example of the output from the command when it is run without
the \*L\-fast\*O or \*L\-long\*O option:
.iS
\*C$ \*Lfts lsheader /.../abc.com/hosts/fs3 /dev/lfs1\*O
.iE
.oS
\s-1
\*CTotal filesets\ on\ server fs3 aggregate\ lfs1\ (ID 10): 16\*O
\*Cuser.terry\ \ \ \ \ \ 0,,196953\ RW\ \ \ \5071 K alloc \ \8421 K quota \On-line\*O
\*Cuser.wvh\ \ \ \ \ \ \ \ 0,,196956\ RW\ \ \ \4955 K alloc \ \9371 K quota \On-line\*O
\*C\ \ \ \ .\*O
\*C\ \ \ \ .\*O
\*CTotal\ filesets\ on-line\ 15;\ total\ off-line\ 1; \*Ctotal\ busy\ 0\*O
\s+1
.oE
.P
When you include the \*L\-long\*O option, the command displays the following
additional information for each fileset: 
.ML
.LI
Whether it is a DCE LFS (\*LLFS\*O) or non-LFS fileset
.LI
Information about the state of the fileset
.LI
The ID numbers of the parent, clone, and backup filesets that are related to
the fileset
.LI
The ID numbers of the low-level backing and low-level forward filesets that are
related to the fileset
.LI
The version number of the fileset
.LI
The allocation and allocation usage, in kilobytes, of the fileset
.LI
The quota and quota usage, in kilobytes, of the fileset
.LI
The day, date, and time when the fileset was created (replicated or cloned for
a read-only or backup fileset)
.LI
The day, date, and time when the contents of the fileset were last updated
(this is the same as the creation time for a read-only or backup fileset)
.LE
.nL
.ne 20
.P
Following is an example of the output from the command when it is executed
with the \*L\-long\*O option:
.iS
\*C$ \*Lfts lsheader /.../abc.com/hosts/fs3 /dev/lfs1 -long\*O
.iE
.oS
\*CTotal filesets\ on\ server fs3 aggregate\ lfs1\ (ID 10): 16\*O
\*Cuser.terry\ 0,,196953\ RW\ LFS\ \ \ \ \ states 0x10010005\ \ \ On-line\*O
\*C\ \ \ \ fs3.abc.com,\ aggregate lfs1\ (ID\ 10)\*O
\*C\ \ \ \ Parent\ 0,,196953\ \ \ Clone\ 0,,0\ \ \ Backup\ 0,,196955\*O
\*C\ \ \ \ llBack\ 0,,0\ \ \ \ \ \ \ \ llFwd\ 0,,0\ \ \ Version\ 0,,25963\*O
\*C\ \ \ \ 429496729 K alloc limit; \ \ \ \ \ \1252 K alloc usage\ \*O
\*C\ \ \ \ \ \ \ \ \15000 K quota limit; \ \ \ \ \ \9340 K quota usage\ \*O
\*C\ \ \ \ Creation\ Tue\ Oct\ 15\ 16:45:16\ 1991\*O
\*C\ \ \ \ Last\ Update\ Fri\ Nov\ 22\ 11:36:00\ 1991\*O

\*Cuser.wvh\ 0,,196956\ RW\ LFS\ \ \ \ \ states\ 0x10010005\ \ On-line\*O
\*C\ \ \ \ .\*O
\*C\ \ \ \ .\*O
\*CTotal\ filesets\ on-line\ 15;\ total\ off-line\ 1; \*Ctotal\ busy\ 0\*O
.oE
.iX "-]" "\*Lfts\*O command suite" "\*Llsheader\*O"
.iX "-]" "fileset headers" "viewing"
.H 3 "Listing FLDB and Fileset Header Information"
.iX "-[" "fileset headers" "viewing FLDB information"
.iX "-[" "\*Lfts\*O command suite" "\*Llsft\*O"
.P
You can use the \*Lfts lsft\*O command to display information from both the
FLDB and the fileset header for a single fileset.  The output from the \*Lfts
lsft\*O command consists of the output from the \*Lfts lsheader\*O command
with the \*L\-long\*O option followed by the output from the \*Lfts lsfldb\*O
command.  You can indicate the fileset about which information is to be
displayed in one of two ways: by specifying the name of a file or directory
that is stored in the fileset with the \*L\-path\*O option, or by specifying
the name or fileset ID number of the fileset with the \*L\-fileset\*O option.
.P
Because the \*Lfts lsft\*O command retrieves information from the fileset
header, you can examine the read-only or backup version of a DCE LFS fileset
by adding the \*L.readonly\*O or \*L.backup\*O extension to the name of the
fileset specified with the \*L\-fileset\*O option or by specifying the ID
number of the read-only or backup version.  An error message is displayed if
the read/write version no longer exists and you fail to specify the
\*L.readonly\*O or \*L.backup\*O extension with the name of the fileset.
.nL
.ne 20
.P
If multiple read-only replicas of a DCE LFS fileset exist, you can use the
\*L\-server\*O option to indicate the name of the File Server machine that
houses the specific replica to be examined.  While all replicas of a fileset
are identical by default, indicating a specific replica can be useful if
network or hardware problems caused only some of a fileset's replicas to be
updated.  Omit the \*L\-server\*O option to display information about the
replica at the fileset's oldest read-only site.  The \*L\-server\*O option is
always unnecessary when the command is used to examine the read/write or backup
version of a fileset.
.P
A read-only version of a DCE LFS fileset can exist independently of a
read/write version if the \*Lfts rmsite\*O command is not used to remove its
site when the \*Lfts delete\*O command is used to remove the read/write
version.  A backup version of a DCE LFS fileset can exist independently of a
read/write version if the \*Lfts delete\*O operation used to remove the
read/write version is interrupted before completion; for example, if a system
or hardware failure stops a delete operation after the read/write version is
removed but before the backup version is removed. (See Section 7.10 for more
information about deleting DCE LFS (and non-LFS) filesets.)
.P
Because non-LFS filesets do not have fileset headers, the \*Lfts lsft\*O
command displays much less fileset header information for non-LFS filesets
than it does for DCE LFS filesets.
.P
To display information about a fileset from both its FLDB entry and its fileset
header, enter the \*Lfts lsft\*O command:
.iS
\*C$ \*Lfts lsft \*O[{\*L\-path\*O {\*Vfilename\*O | \*Vdirectory_name\*O} | \*L\-fileset\*O {\*Vname\*O | \*VID\*O}}] \\
[\*L\-server \*Vmachine\*O]
.iE
.P
The \*L\-path\*O \*Vfilename\*O or \*Vdirectory_name\*O option is the name of a
file or directory in the fileset.  Use the \*L\-path\*O option or use the
\*L\-fileset\*O option to specify the name or ID number of the fileset; omit
both options to display information about the fileset that houses the working
directory.
.P
The \*L\-server\*O \*Vmachine\*O option names the File Server machine that
houses the version of the fileset about which information is to be displayed.
This option is useful for examining a particular read-only replica of a DCE LFS
fileset for which multiple replicas exist.
.P
Following is an example of the output for this command. The fileset ID number
is used to indicate the fileset about which information is to be displayed;
the leading 0 (zero) and commas are omitted from the ID number.
.nL
.ne 20
.iS
\*C$ \*Lfts lsft -fileset 196953\*O
.iE
.zA "enh, 13605, R1.2.2, Security enhancements"
.oS
\*C___________________________________________________________\*O
\*Cuser.terry\ 0,,196953\ RW\ LFS\ \ \ \ \ states 0x10010005\ On-line\*O 
\*C\ \ \ \ fs3.abc.com,\ aggregate lfs1\ (ID\ 10)\*O
\*C\ \ \ \ Parent\ 0,,196953\ \ \ Clone\ 0,,0\ \ \ Backup\ 0,,196955\*O
\*C\ \ \ \ llBack\ 0,,0\ \ \ \ \ \ \ \ llFwd\ 0,,0\ \ \ Version\ 0,,25963\*O
\*C\ \ \ \ 429496729 K alloc limit; \ \ \ \ \ \1252 K alloc usage\ \*O
\*C\ \ \ \ \ \ \ \ \15000 K quota limit; \ \ \ \ \ \9340 K quota usage\ \*O
\*C\ \ \ \ Creation\ Fri\ Oct\ 15\ 16:45:16\ 1993\*O
\*C\ \ \ \ Last\ Update\ Mon\ Nov\ 22\ 11:36:00\ 1993\*O
.oE
.P
.oS
\*Cuser.terry\*O
\*C\ \ \ \ \ \ \ \ readWriteID\ \ 0,,196953\ \ valid\*O
\*C\ \ \ \ \ \ \ \ readOnlyID\ \ \ 0,,196594\ \ invalid\*O
\*C\ \ \ \ \ \ \ \ backupID\ \ \ \ \ 0,,196595\ \ valid\*O
\*CMinimum local protection level: rpc_c_protect_level_none
Maximum local protection level: rpc_c_protect_level_pkt_privacy
Minimum remote protection level: rpc_c_protect_level_none
Maximum remote protection level: rpc_c_protect_level_pkt_privacy\*O
\*Cnumber of sites:\ 2\*O
\*C\ \ Sched\ repl:\ maxAge=2:00:00;\ failAge=1d0:00:00;\*O
\*C\ \ reclaimWait=18:00:00;\ minRepDelay=0:05:00;\*O
\*CdefaultSiteAge=0:30:00\*O
\*C\ \ \ server\ \ \ \ \ \ \ \ flags\ \ \ aggr\ \ \ siteAge\ principal\ \ owner\*O
\*Cfs3.abc.com\ \ \ \ \ \ RW,BK\ \ \ lfs1\ \ \ 0:00:00\ hosts/fs3\ \ <nil>\*O
\*C___________________________________________________________\*O
.oE
.zZ "enh, 13605, R1.2.2, Security enhancements"
.iX "-]" "\*Lfts\*O command suite" "\*Llsft\*O"
.iX "-]" "fileset headers" "viewing FLDB information"
.H 3 "Determining Other Fileset Information"
.P
The following subsections describe commands that are used to obtain information
about a fileset when you know only its name, its ID number, or the name of a
file or directory that it contains.  The subsections include descriptions of
the following commands:
.ML
.LI
The \*Lfts lsquota\*O command, which is used to determine the name of a fileset
from the name of a file or directory that it houses.  Note that the primary
usage of the \*Lfts lsquota\*O command is to list fileset quota information, 
as described in Section 7.6, not to determine fileset names.
.LI
The \*Lfts lsft\*O command, which is used to determine the ID number of a
fileset from its name or from the name of a file or directory that it houses.
.LI
The \*Lfts lsfldb\*O command, which is used to learn the location of a fileset
from its name or ID number.
.LI
The \*Lcm whereis\*O command, which is used to learn the location of a fileset
from the name of a file or directory that it houses.
.LE
.P
The \*Lcm whereis\*O command is from the DFS \*Lcm\*O command suite. (See
Chapter 8 for more information about \*Lcm\*O commands used to configure the
Cache Manager; see Part 2 of this guide and reference for more detailed
information about all \*Lcm\*O commands.)
.H 4 "Learning Fileset Names from Files or Directories"
.iX "filesets" "learning names"
.iX "\*Lfts\*O command suite" "\*Llsquota\*O, alternative use"
.P
To learn the names of filesets from the names of files or directories that they
contain, enter the \*Lfts lsquota\*O command with the \*L\-path\*O option:
.iS
\*C$ \*Lfts lsquota \*O[\*L\-path\*O {\*Vfilename\*O | \*Vdirectory_name\*O}...]
.iE
.P
The \*L\-path\*O \*Vfilename\*O or \*Vdirectory_name\*O option is the name of
a file or directory in each fileset whose name you want to determine.  You can
include multiple files or directories from different filesets.  Omit this option
to learn the name of the fileset that houses the working directory.
.P
The \*Lfts lsquota\*O command produces a single line of output for each
fileset that houses a named file or directory.  Each line begins with the name
of the fileset to which the information corresponds. (See Section 7.6 for a
complete description of the command's output.)
.P
The following example displays the name of the fileset that contains the
directory named \*L/.../abc.com/fs/usr/terry\*O:
.iS
\*C$ \*Lfts lsquota /.../abc.com/fs/usr/terry\*O
.iE
.oS
\s-1
\*CFileset\ Name\ \ \ Quota\ \ Used\ \ %\ Used\ \ Aggregate
user.terry\ \ \ \ \ 15000\ \ 5071\ \ \ \  34%\ \ \ \ 86% = 84538/98300 (LFS)\*O
\s+1
.oE
.H 4 "Learning Fileset ID Numbers from Fileset Names"
.iX "-[" "filesets" "ID numbers"
.iX "-[" "\*Lfts\*O command suite" "\*Llsft\*O, alternative use"
.P
To learn a fileset's ID number from its name, enter the \*Lfts lsft\*O command
with the \*L\-fileset\*O option:
.iS
\*C$ \*Lfts lsft -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.P
The \*Lfts lsft\*O command displays numerous lines of output about the named
fileset.  The first line of output lists the fileset's name followed by its ID
number. (See Section 7.3.3 for a description of the command's output.)
.P
The following example displays the fileset ID number (\*L0,,196953\*O) of the
fileset whose name is \*Luser.terry\*O:
.iS
\*C$ \*Lfts lsft -fileset user.terry\*O
.iE
.oS
\*C___________________________________________________________\*O
\*Cuser.terry\ 0,,196953\ RW\ LFS\ \ \ \ \ states 0x10010005\ On-line\*O 
\*C\ \ \ \ fs3.abc.com,\ aggregate lfs1\ (ID\ 10)\*O
\ \ \ \ .
\ \ \ \ .
\ \ \ \ .
\*C\ \ \ server\ \ \ \ \ \ \ \ flags\ \ \ aggr\ \ \ siteAge\ principal\ \ owner\*O
\*Cfs3.abc.com\ \ \ \ \ \ RW,BK\ \ \ lfs1\ \ \ 0:00:00\ hosts/fs3\ \ <nil>\*O
\*C___________________________________________________________\*O
.oE
.H 4 "Learning Fileset ID Numbers from Files or Directories"
.P
To learn a fileset's ID number from the name of a file or directory that it
contains, enter the \*Lfts lsft\*O command with the \*L\-path\*O option:
.iS
\*C$ \*Lfts lsft \*O[\*L\-path\*O {\*Vfilename\*O | \*Vdirectory_name\*O}]
.iE
.P
The \*L\-path\*O \*Vfilename\*O or \*Vdirectory_name\*O option is the name of
a file or directory in the fileset whose ID number you want to determine.  Omit
this option to learn the ID number of the fileset that houses the working
directory.
.P
The \*Lfts lsft\*O command begins its output with the name and ID number of
the fileset that houses the named file or directory. (See Section 7.3.3 for
a description of the command's output.)
.P
The following example displays the fileset ID number (again \*L0,,196953\*O)
of the fileset that contains the current working directory:
.iS
\*C$ \*Lfts lsft\*O
.iE
.oS
\*C___________________________________________________________\*O
\*Cuser.terry\ 0,,196953\ RW\ LFS\ \ \ \ \ states 0x10010005\ On-line\*O 
\*C\ \ \ \ fs3.abc.com,\ aggregate lfs1\ (ID\ 10)\*O
\ \ \ \ .
\ \ \ \ .
\ \ \ \ .
\*C\ \ \ server\ \ \ \ \ \ \ \ flags\ \ \ aggr\ \ \ siteAge\ principal\ \ owner\*O
\*Cfs3.abc.com\ \ \ \ \ \ RW,BK\ \ \ lfs1\ \ \ 0:00:00\ hosts/fs3\ \ <nil>\*O
\*C___________________________________________________________\*O
.oE
.iX "-]" "filesets" "ID numbers" 
.iX "-]" "\*Lfts\*O command suite" "\*Llsft\*O, alternative use"
.H 4 "Learning Fileset Locations from Fileset Names or ID Numbers"
.iX "-[" "filesets" "locations"
.iX "-[" "\*Lfts\*O command suite" "\*Llsfldb\*O, alternative use"
.P
To learn the location of a fileset from its name or ID number, enter the
\*Lfts lsfldb\*O command with the \*L\-fileset\*O option:
.iS
\*C$ \*Lfts lsfldb -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.P
The \*Lfts lsfldb\*O command concludes its output with a list of the File
Server machines that house existing versions of the fileset. (See Section
7.3.1 for a thorough description of the command's output.)
.P
The following example displays the name of the File Server machine that houses
the fileset named \*Luser.terry\*O:
.nL
.ne 20
.iS
\*C$ \*Lfts lsfldb user.terry\*O
.iE
.oS
\s-1
\*Cuser.terry
\ \ \ \ \ \ \ \ readWriteID\ \ 0,,196953\ \ valid
\ \ \ \ \ \ \ \ readOnlyID\ \ \ 0,,196594\ \ invalid
\ \ \ \ \ \ \ \ backupID\ \ \ \ \ 0,,196595\ \ valid
number of sites:\ 1
 Sched\ repl:maxAge=2:00:00;failAge=1d0:00:00;reclaimWait=18:00:00;
 minRepDelay=0:05:00; defaultSiteAge=0:30:00
\ \ \ server\ \ \ \ \ \ \ \ flags\ \ \ aggr\ \ \ siteAge\ principal\ \ owner
fs3.abc.com\ \ \ \ \ \ RW,BK\ \ \ lfs1\ \ \ 0:00:00\ hosts/fs3\ \ <nil>\*O
\s+1
.oE
.iX "-]" "\*Lfts\*O command suite" "\*Llsfldb\*O, alternative use"
.H 4 "Learning Fileset Locations from Files or Directories"
.iX "\*Lcm\*O command suite" "\*Lwhereis\*O"
.P
To learn the locations of filesets from the names of files or directories that
they contain, enter the \*Lcm whereis\*O command:
.iS
\*C$ \*Lcm whereis \*O[\*L\-path\*O {\*Vfilename\*O | \*Vdirectory_name\*O}...]
.iE
.P
The \*L\-path\*O \*Vfilename\*O or \*Vdirectory_name\*O option is the name of
a file or directory in the fileset whose location you want to determine.  You
can include multiple files or directories from different filesets.  Omit this
option to learn the location of the fileset that houses the working directory.
.P
For each named file or directory, the \*Lcm whereis\*O command displays the
name of the cell in which the file or directory exists, the name of the fileset
in which the file or directory resides, and the name of each File Server
machine that houses a copy of the fileset.  If the names of multiple machines
are displayed, the file or directory resides in a read-only fileset, and
replicas of the fileset are stored on each machine displayed by the command.
Typically, only filesets that are in demand by numerous users (for example,
filesets that house frequently accessed binary files) are replicated; filesets
that are used by only a limited number of users (for example, users' home
filesets) are seldom replicated.
.P
The following example displays location information about the fileset that
houses the directory named \*L/.../abc.com/fs/usr/terry\*O:
.nL
.ne 20
.iS
\*C$ \*Lcm whereis /.../abc.com/fs/usr/terry\*O
.iE
.oS
\*CFile `/.../abc.com/fs/usr/terry' resides in the cell
`abc.com', in fileset `user.terry', on host fs3.abc.com.\*O
.oE
.iX "-]" "filesets" "locations"
.iX "-]" "filesets" "viewing information"
.H 2 "Listing Aggregate and Partition Information"
.P
The following commands are available for listing information about any
aggregate or partition (non-LFS aggregate) that is exported to the DCE
namespace:
.ML
.LI
The \*Lfts lsaggr\*O command is used to list all exported aggregates or
partitions on a File Server machine.
.LI
The \*Lfts aggrinfo\*O command is used to list information about the amount of
disk space available on a specific aggregate or partition or on all exported
aggregates and partitions on a File Server machine.
.LE
.P
These commands are especially useful when exporting additional aggregates or
partitions from a machine, when creating read/write or read-only filesets on
an aggregate, or when moving filesets between machines.
.H 3 "Listing Aggregates and Partitions"
.iX "-[" "aggregates" "viewing information"
.iX "\*Lfts\*O command suite" "\*Llsaggr\*O"
.iX "\*Ldfstab\*O file" "viewing"
.P
The \*Lfts lsaggr\*O command is used to list the following information about
each exported aggregate or partition on a File Server machine.  The information
is specified for each aggregate and partition in the
\*Vdcelocal\*L/var/dfs/dfstab\*O file.
.ML
.LI
The aggregate name, which is specified in the second field of the \*Ldfstab\*O
file
.LI
The device name, which is specified in the first field of the \*Ldfstab\*O file
.LI
The aggregate ID, which is specified in the fourth field of the \*Ldfstab\*O
file
.LI
The file system type, which is specified in the third field of the \*Ldfstab\*O
file
.LE
.nL
.ne 20
.nS "note"
You can issue the \*Ldfsexport\*O command with no options on a File Server
machine to list all aggregates and partitions currently exported from the
local disk to the DCE namespace.  Like the \*Lfts lsaggr\*O command, no
privileges are required to issue the \*Ldfsexport\*O command with no options.
.nE
.P
Enter the \*Lfts lsaggr\*O command to list information about all of the
exported aggregates and partitions on a File Server machine:
.iS
\*C$ \*Lfts lsaggr -server \*Vmachine\*O
.iE
.P
The following example shows that two non-LFS partitions and two DCE LFS
aggregates are exported from the File Server machine named \*Lfs1\*O:
.iS
\*C$ \*Lfts lsaggr /.../abc.com/hosts/fs1\*O
.iE
.oS
\s-1
\*CThere are 4 aggregates on the server \\
\ \ /.../abc.com/hosts/fs1 (fs1.abc.com):
\ \ \ \ \ \ \ \ \ \ \ \ \ \ /usr (/dev/lv02):\ id=3\ \ \ \ \ (non-LFS)
\ \ \ \ \ \ \ \ \ \ \ \ \ \ /tmp (/dev/lv03):\ id=4\ \ \ \ \ (non-LFS)
\ \ \ \ \ \ \ \ \ \ \ \ \ \ lfs1 (/dev/lfs1):\ id=10\ \ \ \ \ (LFS)
\ \ \ \ \ \ \ \ \ \ \ \ \ \ lfs2 (/dev/lfs2):\ id=11\ \ \ \ \ (LFS)\*O
\s+1
.oE
.H 3 "Listing Disk Space on Aggregates and Partitions"
.iX "-[" "\*Lfts\*O command suite" "\*Laggrinfo\*O"
.iX "-[" "aggregates" "disk space information"
.iX "-[" "disk space" "aggregates and partitions"
.P
The \*Lfts aggrinfo\*O command lists information about the total amount of disk
space and the amount of disk space that is currently available on exported
aggregates and partitions.  It can be used to obtain size information about a
specific aggregate or partition or about all of the exported aggregates and
partitions on a File Server machine.  The command displays the following
information about each aggregate and partition:
.ML
.LI
The file system type (\*LLFS\*O for a DCE LFS aggregate, or \*LNon-LFS\*O for
a non-LFS partition).
.LI
The aggregate name.
.LI
The device name.
.LI
The number of kilobytes of disk space currently available on the aggregate or
partition.
.nL
.ne 20
.LI
The total number of kilobytes on the aggregate or partition (not including any
reserved disk space).
.LI
.iX "aggregates" "reserved disk space"
The number of kilobytes, if any, of reserved disk space on the aggregate or
partition.  DCE LFS reserves a variable amount of disk space on each aggregate
for internal purposes (for example, to accommodate additional space required
for fileset move and clone operations).  Some non-LFS file systems also reserve
some amount of overdraw disk space for administrative purposes.
.LE
.P
The \*Ldf\*O command available in the UNIX operating system displays roughly
the same information as the \*Lfts aggrinfo\*O command for non-LFS partitions,
exported DCE LFS aggregates, and locally mounted DCE LFS filesets.
.P
Enter the \*Lfts aggrinfo\*O command to display information about the disk
space that is available on a specific aggregate or partition or on all
aggregates and partitions on a File Server machine:
.iS
\*C$ \*Lfts aggrinfo -server \*Vmachine\*O [\*L\-aggregate \*Vname\*O]
.iE
.P
The following example displays information about the disk space that is
available on the aggregates and partitions that are exported from \*Lfs1\*O:
.iS
\*C$ \*Lfts aggrinfo /.../abc.com/hosts/fs1\*O
.iE
.oS
\s-1
\*CNon-LFS aggregate /usr (/dev/lv02): 24048 K free out of total 98304
\ \ \ \ \ (10923 reserved)
Non-LFS aggregate /tmp (/dev/lv03): 11668 K free out of total 12288
\ \ \ \ \ (1365 reserved)
LFS aggregate lfs1 (/dev/lfs1): 100537 K free out of total 101340
\ \ \ \ \ (2048 reserved)
LFS aggregate lfs2 (/dev/lfs2): 79957 K free out of total 81920
\ \ \ \ \ (2048 reserved)\*O
\s+1
.oE
.iX "-]" "\*Lfts\*O command suite" "\*Laggrinfo\*O"
.iX "-]" "disk space" "aggregates and partitions"
.iX "-]" "aggregates" "disk space information"
.iX "-]" "aggregates" "viewing information"
.nL
.ne 20
.H 2 "Increasing the Size of a DCE LFS Aggregate"
.iX "-[" "aggregates" "enlarging"
.iX "-[" "\*Lgrowaggr\*O command"
.P
DCE LFS aggregates are created with the \*Lnewaggr\*O command.  The initial
size of an aggregate is specified with the command's \*L\-aggrsize\*O option.
(See Chapter 6 for more information about the \*Lnewaggr\*O command.)
.P
The \*Lgrowaggr\*O command is used to increase the size of an existing DCE
LFS aggregate.  On operating systems that support logical volumes, the
\*Lgrowaggr\*O command is useful for increasing the size of an aggregate when
the size of the logical volume on which it resides is increased.  It can also be
used to increase the size of an aggregate that was deliberately created smaller
than the partition or logical volume on which it resides.
.P
The size of the aggregate can be made as large as the size of the partition
on which it resides.  To determine the total number of 1024-byte blocks on the
partition on which an aggregate resides without changing the size of the
aggregate, specify the \*Lgrowaggr\*O command's \*L\-noaction\*O option and
omit its \*L\-aggrsize\*O option.  To increase the size of an aggregate to
the total size of the partition on which it resides, omit both the
\*L\-aggrsize\*O and \*L\-noaction\*O options.
.P
The size of an existing aggregate cannot be decreased. A size specified with
the command's \*L\-aggrsize\*O option must be at least three DCE LFS blocks
greater than the current size of the aggregate. (The number of bytes in a DCE
LFS block is defined on a per-aggregate basis with the \*L\-blocksize\*O option
of the \*Lnewaggr\*O command when an aggregate is created.) Specify both the
\*L\-aggrsize\*O and \*L\-noaction\*O options with the command to determine
whether the size specified with the \*L\-aggrsize\*O option is valid without
changing the present size of the aggregate.
.P
To increase the size of a DCE LFS aggregate, do the following:
.AL
.LI
Log in as \*Lroot\*O on the machine on which the aggregate that is to be
enlarged resides.
.LI
Issue the \*Lgrowaggr\*O command to increase the size of the aggregate. (See
Part 2 of this guide and reference for more detailed information about the
\*Lgrowaggr\*O command.)
.iS
\*C# \*Lgrowaggr -aggregate \*Vname\*O [\*L\-aggrsize \*Vblocks\*O] [\*L\-noaction\*O]
.iE
.nL
.ne 20
.P
The \*L\-aggregate\*O \*Vname\*O option is the device name or aggregate name of
the DCE LFS aggregate to be grown.  These identifiers are specified in the first
and second fields of the entry for the aggregate in the
\*Vdcelocal\*L/var/dfs/dfstab\*O file.
.P
The \*L\-aggrsize\*O \*Vblocks\*O option is the total number of 1024-byte blocks
to be available on the specified aggregate.  The number of 1024-byte blocks
specified with this option cannot exceed the total size of the disk partition
on which the aggregate resides, and it must be at least three DCE LFS blocks
larger than the current size of the aggregate.  Omit both the \*L\-aggrsize\*O
option and the \*L\-noaction\*O option to increase the size of the aggregate to
the total size of the disk partition on which it resides.  Specify both the
\*L\-aggrsize\*O option and the \*L\-noaction\*O option to determine whether the
size specified with this option is valid without changing the current size of
the aggregate.
.P
The \*L\-noaction\*O option directs the command to display the total number of
1024-byte blocks on the disk partition on which the specified aggregate
resides, provided the \*L\-aggrsize\*O option is not specified.  If the
\*L\-aggrsize\*O option is specified with the \*L\-noaction\*O option, the
command determines whether the specified size is valid.  The current size of
the aggregate is not affected if the \*L\-noaction\*O option is used.
.LE
.iX "-]" "aggregates" "enlarging"
.iX "-]" "\*Lgrowaggr\*O command" 
.H 2 "Setting and Listing Fileset Quota"
.iX "-[" "filesets" "quotas, setting"
.iX "-[" "quotas" "setting fileset"
.iX "-[" "\*Lfts\*O command suite" "\*Lsetquota\*O"
.P
By default, every newly created DCE LFS fileset has a quota of 5000 kilobytes
(5000 units of 1024 bytes each).  The \*Lfts setquota\*O command can be used to
modify the quota of a DCE LFS fileset.  The \*Lfts lsquota\*O command can be
used to examine the available quota and quota usage for a DCE LFS fileset.
.nL
.ne 20
.P
Because it does not represent the amount of physical data stored on the
fileset, the quota of a DCE LFS fileset can be larger than the size of the
aggregate on which the fileset resides.  Similarly and more commonly, the
combined quota limits of all filesets on a DCE LFS aggregate can exceed
the size of the aggregate.  Assuming that all users who own filesets on an
aggregate do not use all of their quota, you can allocate more quota than
an aggregate actually contains to minimize user requests for additional quota.
If additional quota is allocated to filesets that reside on an aggregate whose
size can be increased, the aggregate can be grown to accommodate the additional
quota if necessary (see Section 7.5).
.P
The size of a non-LFS fileset is always equivalent to the size of the
partition on which it resides.  In the UNIX operating system, you can use the
\*Ldf\*O command to determine the size of a non-LFS partition.  The \*Ldf\*O
command can also be used to check the size of an exported DCE LFS aggregate,
but it cannot be used to display the size of a DCE LFS fileset unless the
fileset is mounted locally.  In addition, although you can use the \*Lfts
lsquota\*O command to check the space that is used and available on a non-LFS
fileset, you cannot use the \*Lfts setquota\*O command to set the quota of a
non-LFS fileset.
.P
With both the \*Lfts setquota\*O and \*Lfts lsquota\*O commands, you can
indicate the fileset whose quota you want to set or display either directly,
by specifying the name (or ID number) of the fileset or, indirectly, by
specifying the name of a file or directory located in the fileset.  With the
\*Lfts lsquota\*O command, you can display quota information about multiple
filesets by specifying either multiple fileset names (or ID numbers) \*Eor\*O
multiple file or directory names.
.P
The \*Lfts lsquota\*O command displays different information for DCE LFS and
non-LFS filesets.  For a DCE LFS fileset, the command displays the following
information:
.ML
.LI
The name of the fileset.
.LI
The quota for the fileset (expressed as a number of kilobytes), the number of
kilobytes currently in use on the fileset, and the percentage of the quota
currently in use on the fileset.
.LI
The percentage of disk space in use, the number of kilobytes in use, and the
number of kilobytes available on the aggregate on which the fileset resides.
.nL
.ne 20
.LI
An \*LLFS\*O indicator to show that the fileset is stored on a DCE LFS
aggregate.
.LE
.P
For a non-LFS fileset, the command displays the following information:
.ML
.LI
The name of the fileset.
.LI
Zeros for the quota, usage, and percentage used of the fileset.  Ignore these
values for a non-LFS fileset; refer instead to the corresponding values for
the partition on which the fileset resides.
.LI
The percentage of disk space in use, the number of kilobytes in use, and the
number of kilobytes available on the partition on which the fileset resides.
.LI
A \*Lnon-LFS\*O indicator to show that the fileset is stored on a non-LFS
aggregate (partition).
.LE
.P
Note again that the UNIX \*Ldf\*O command can be used to display the same
information for the partition on which a non-LFS fileset resides.
.H 3 "Setting Quota for a DCE LFS Fileset"
.P
To set the quota for a DCE LFS fileset, do the following:
.AL
.LI
Verify that you have the necessary privilege.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the fileset resides.  If necessary,
issue the \*Lbos lsadmin\*O command to verify the members of the list.
.LI
Issue the \*Lfts setquota\*O command:
.iS
\*C$ \*Lfts setquota \*O{\*L\-path\*O {\*Vfilename\*O | \*Vdirectory_name\*O} | \*L\-fileset\*O {\*Vname\*O | \*VID\*O}} \\
\*L\-size \*Vkbytes\*O
.iE
.P
The \*L\-path\*O \*Vfilename\*O or \*Vdirectory_name\*O option is the name
of a file or directory in the fileset whose quota you want to set.  Use the
\*L\-path\*O option or use the \*L\-fileset\*O option to specify the name or
ID number of the fileset whose quota you want to set.
.nL
.ne 20
.P
The \*L\-size\*O \*Vkbytes\*O option is the maximum amount of disk space that
all of the files and directories in the read/write version of the fileset can
occupy.  This includes files and directories in the read/write version of the
fileset that are actually pointers to disk blocks in the backup or read-only
version of the fileset.  Specify the value in kilobytes; a value of 1024
kilobytes equals 1 megabyte.
.LE
.iX "-]" "\*Lfts\*O command suite" "\*Lsetquota\*O"
.iX "-]" "quotas" "setting fileset"
.H 3 "Listing Quota, Size, and Other Information for a Fileset"
.iX "-[" "quotas" "viewing fileset"
.iX "-[" "\*Lfts\*O command suite" "\*Llsquota\*O"
.P
To display quota information about a fileset, enter the \*Lfts lsquota\*O
command:
.iS
\*C$ \*Lfts lsquota \*O[{\*L\-path\*O {\*Vfilename\*O | \*Vdirectory_name\*O}... | \*L\-fileset\*O {\*Vname\*O | \*VID\*O}...}]
.iE
.P
The \*L\-path\*O \*Vfilename\*O or \*Vdirectory_name\*O option is the name of
a file or directory in each fileset whose quota you want to display.  You can
include multiple files or directories from different filesets; it is not
necessary to name more than one file or directory from the same fileset.
Use the \*L\-path\*O option or use the \*L\-fileset\*O option to specify the
name or ID number of each fileset whose quota information you want to display.
Omit both options to display information about the fileset that contains the
working directory.
.P
Following is an example of this command and its output. The fileset named
\*Luser.terry\*O has a quota of 15,000 kilobytes, 5071 kilobytes (34%) of
which are currently in use.  The fileset named \*Luser.jean\*O has a quota of
only 5000 kilobytes, almost all of which is currently in use.  The \*L<<\*O and
\*L<<WARNING\*O messages indicate that the fileset named \*Luser.jean\*O is
over 90% full; the same message is displayed for an aggregate that is over
97% full.
.P
Ignore the values displayed in the fileset information columns for the non-LFS
fileset, \*Luser.jlw\*O.  The quota and usage information for a non-LFS fileset
is equal to the same information displayed for the partition on which the
fileset resides.  The partition that houses the fileset named \*Luser.jlw\*O
has 10,000 kilobytes available; 8448 kilobytes, or 84% of the partition, are
currently in use.
.nL
.ne 20
\s-1
.iS
\*C$ \*Lfts lsquota /.../abc.com/fs/usr/terry /.../abc.com/fs/usr/jean /.../abc.com/fs/usr/jlw\*O
.iE
.oS
\*CFileset\ Name\ \ \ Quota\ \ Used\ \ %\ Used\ \ Aggregate
user.terry\ \ \ \ \ 15000\ \ 5071\ \ \ \  34%\ \ \ \ 86% = 84538/98300 (LFS)
user.jean\ \ \ \ \ \ \ 5000\ \ 4955\ \ \ \ \ 99%<<\ \ 92%\ = 87436/98300 (LFS)
\ \ \ <<WARNING
user.jlw\ \ \ \ \ \ \ \ \ \ \ 0\ \ \ \ \ 0\ \ \ \ \ \ 0%\ \ \ \ 84%\ = 8448/10000 (non-LFS)\*O
.oE
\s+1
.iX "-]" "quotas" "viewing fileset"
.iX "-]" "\*Lfts\*O command suite" "\*Llsquota\*O"
.iX "-]" "filesets" "quotas, setting"
.zA "enh, 13605, R1.2.2, Security enhancements"
.H 2 "Setting Advisory RPC Authentication Bounds for Filesets"
.P
You can set upper and lower advisory RPC authentication bounds for any DCE LFS fileset. These bounds serve to bias a Cache Manager's initial RPC authentication level when transferring data to or from the fileset. The bound RPC authentication level values are stored in the FLDB by the \*Lfts setprotectlevels\*O command. Currently these bounds are only advisory, but a future release of DFS may enforce these bounds. 
.P
In operation, a Cache Manager contacts an FL Server to learn which File Servers house the required fileset (or replicas of the fileset). Along with the location, the Cache Manager also receives the upper and lower RPC authentication bounds for that fileset. The Cache Manager then compares its initial RPC authentication level with the range defined by the advisory bounds. If the initial level falls within the range, the Cache Manager begins the process of negotiating an RPC authentication level with the File Server by using the initial level.  If the initial level falls outside the range, the Cache Manager adjusts the initial level upward or downward to the closest bound value (though not below its own minimum setting) before beginning the process of negotiating an RPC authentication level.
.P
For example, suppose the following values represent the Cache Manager and fileset authentication level settings:
.ML
.LI
The Cache Manager initial RPC authentication level is set to packet.
.LI
The fileset upper bound is set to packet privacy.
.LI
The filset lower bound is set to packet integrity.
.LE
.P
When the Cache Manager compares its initial level to the range defined by the fileset advisory bounds, it discovers that its initial level is set below the lower bound.  The Cache Manager then adjusts its initial level to packet integrity and uses this RPC authentication level to begin the process of negotiating the RPC authentication level with the File Server.  If the File Server upper bound is below the Cache Manager's initial level (adjusted through the fileset advisory bounds), the Cache Manager then lowers its initial level.  Thus, the fileset bounds serve only to bias the selection of the RPC authentication level to a higher or lower level; however, the settings for the File Server and Cache Manager can override this bias.
.P
Issue the \*Lfts setprotectlevels\*O command to set advisory authentication bounds for filesets.
.P
.iS
\*C$ \*Lfts setprotectlevels\*O \*L-fileset\*O {\*Vname\*O|\*VID\*O}
[\*L-maxlocalprotectlevel \*O \*Vlevel\*O] 
[\*L-minlocalprotectlevel\*O \*Vlevel\*O]
[\*L-maxremoteprotectlevel\*O \*Vlevel\*O]
[\*L-minremoteprotectlevel\*L \*Vlevel\*O]
[\*L-cell\*O \*Vcellname\*O]
.iE
The following options set the various advisory RPC authentication bounds:
.ML
.LI
The \*L-maxlocalprotectlevel\*O option specifies the upper bound for use by Cache Managers in the local cell.
.LI
The \*L-minlocalprotectlevel\*O option specifies the lower bound for use by Cache Managers in the local cell.
.LI
The \*L-maxremoteprotectlevel\*O option specifies the upper bound for use by Cache Managers in foreign cells.
.LI
The \*L-minremoteprotectlevel\*O option specifies the lower bound for use by Cache Managers in foreign cells.
.LE
.P
The \*Vlevel\*O argument is set as follows:
.P
.ML
.LI
\*L0\*O or \*Lrpc_protect_level_default\*O or \*Ldefault\*O: Use the DCE default authentication level.
.LI 
\*L1\*O or \*Lrpc_protect_level_none\*O or \*Lnone\*O: Perform no authentication.
.LI 
\*L2\*O or \*Lrpc_protect_level_connect\*O or \*Lconnect\*O: Authenticate only when the Cache Manager establishes a 
connection with the File Server.
.LI 
\*L3\*O or \*Lrpc_protect_level_call\*O or \*Lcall\*O: Authenticate only at the beginning of each RPC received.
.LI 
\*L4\*O or \*Lrpc_protect_level_pkt\*O or \*Lpkt\*O: Ensure that all data received is from the expected host.
.LI 
\*L5\*O or \*Lrpc_protect_level_pkt_integrity\*O or \*Lpkt_integrity\*O: Authenticate and verify that none of the data transferred has been modified.
.LI
\*L6\*O or \*Lrpc_protect_level_pkt_privacy\*O or \*Lpkt_privacy\*O: Perform authentication as specified by all of the previous levels and also encrypt each RPC argument value.
.LE 
.P
The following command sets the authentication values as follows:
.ML
.LI
The maximum authentication level for communication with Cache Managers
in the local cell is set to packet integrity.
.LI
The minimum authentication level for communication with Cache Managers in the local cell is set to packet.
.LI
The maximum authentication level for communication with Cache Managers
in foreign cells is set to packet security.
.LI
The minimum authentication level for communication with Cache Managers in 
foreign cells is set to packet security.
.LE
.PP
.iS
\*C$\*O \*Lfts setprotectlevels -fileset richland.12 -maxlocalprotectlevel 5 
-minlocalprotectlevel 4 -maxremoteprotectlevel 6 
-minremoteprotectlevel 6\*O 
.iE 
.P
.zZ "enh, 13605, R1.2.2, Security enhancements"
.H 2 "Renaming Filesets"
.iX "-[" "filesets" "renaming"
.iX "-[" "\*Lfts\*O command suite" "\*Lrename\*O"
.P
You can use the \*Lfts rename\*O command to change the name of the read/write
version of any DCE LFS or non-LFS fileset.  When you change the name of a
fileset's read/write version, the names of the read-only and backup versions
of the fileset are automatically changed accordingly.  When you change the name
of a fileset, you must also replace any mount points that reference versions
of the fileset by the old name with mount points that indicate the new name.
.P
To rename a fileset, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the read/write fileset resides,
and you must be included in the \*Ladmin.fl\*O file on each Fileset Database
machine or own the server entry for each machine on which a version of the
fileset resides.  If necessary, issue the \*Lbos lsadmin\*O command to verify
the members of an administrative list.
.LI
Verify that you have the \*Lw\*O (write), \*Lx\*O (execute), \*Li\*O (insert),
and \*Ld\*O (delete) ACL permissions for the directory in which you need to
replace the mount point.  If necessary, issue the \*Ldcecp acl show\*O command
to list the permissions for the directory.
.LI
Issue the \*Lfts rename\*O command to rename the fileset:
.iS
\*C$ \*Lfts rename -oldname \*Voldname\*L -newname \*Vnewname\*O
.iE
.P
The \*L\-oldname\*O \*Voldname\*O option is the current name of the read/write
fileset.
.P
The \*L-newname\*O \*Vnewname\*O option is the new name of the fileset.  The new
name can be no longer than 102 characters. (See Chapter 6 for more information
on fileset naming conventions.)
.LI
Issue the \*Lfts delmount\*O command to remove the mount point that indicates
the fileset's old name:
.iS
\*C$ \*Lfts delmount -dir \*Vdirectory_name\*O...
.iE
.P
The \*L\-dir\*O \*Vdirectory_name\*O option is the name of each mount point you
want to remove.
.LI
Issue the \*Lfts crmount\*O command to create a new mount point that indicates
the fileset's new name:
.iS
\*C$ \*Lfts crmount -dir \*Vdirectory_name\*L -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.P
The \*L\-dir\*O \*Vdirectory_name\*O option is the location for the root
directory of the fileset; the specified location must not already exist.
However, the parent directory of the mount point must exist in the DCE
namespace.  Include a complete pathname unless you want to mount the fileset in
the current working directory.
.P
The \*L\-fileset\*O \*Vname\*O or \*VID\*O option is the name or ID number of
the fileset to be mounted.  Use the name you specified with the \*Lfts rename\*O
command in the earlier step.
.LE
.iX "-]" "filesets" "renaming"
.iX "-]" "\*Lfts\*O command suite" "\*Lrename\*O"
.H 2 "Moving DCE LFS Filesets"
.iX "-[" "filesets" "moving"
.iX "-[" "\*Lfts\*O command suite" "\*Lmove\*O"
.P
The \*Lfts move\*O command allows you to move read/write versions of DCE LFS
filesets between aggregates on the same machine or between machines.  Non-LFS 
filesets cannot be moved. 
.P
Filesets cannot be moved between sites in different cells. Furthermore, the
physical disk on which a fileset resides cannot be moved from a machine in one
cell to a machine in another cell with the expectation of simply running
the \*Lfts syncfldb\*O command to create an FLDB entry for the fileset in the
new cell.  There are two main reasons for these restrictions:
.nL
.ne 20
.ML
.LI
The ACLs associated with the file and directory objects in a fileset are
cell specific.  There is no easy way to translate the ACLs associated with a 
fileset in one cell into an equivalent set of ACLs for another cell.
.LI
Fileset IDs are unique to the local cell only.  Any attempt to introduce
a fileset from one cell into another cell risks a conflict between the 
newly introduced fileset and a fileset within the new cell that has the same
fileset ID.  A fileset ID conflict causes one of the two conflicting filesets to
be inaccessible.
.LE
.nS "note"
You cannot dump and restore filesets between cells of the same name, even if
you first remove the old cell and then recreate a new cell of the same name.
For the purposes of fileset movement, two cells are different, regardless of
whether they share a common name.
.nE
.P
Read-write filesets are the only types of filesets that you can move. When you
move the read/write version of a fileset, the backup version is automatically
deleted from the read/write site; you cannot move the backup version of a
fileset.  Use the \*Lfts clone\*O command to create a backup fileset at the
new site.  All read-only versions of a read/write fileset remain unaffected
when the read/write source moves; use the \*Lfts rmsite\*O and \*Lfts
addsite\*O commands to remove one replication site and add another.  You do
not need to change the mount point for a fileset when you move it.
.P
Move filesets to another machine if their current machine or disk must be
removed for repair.  Consider moving filesets if an aggregate becomes full or
if a File Server machine becomes overloaded.
.P
.nS "note"
You cannot move a DCE LFS fileset that is also mounted locally (as a file
system on its File Server machine) to a different File Server machine; you can
move it only to a different aggregate on the same File Server machine.  To move
a locally mounted DCE LFS fileset to a different server machine, remove its
local mount point before attempting to move it.  Also, because the backup
version of a DCE LFS fileset is removed when the read/write version is moved,
you cannot move a fileset, not even to another aggregate on the same File
Server machine, if its backup version is mounted locally; you must remove the
backup version's local mount point before moving the fileset.
.nE
.nL
.ne 20
.P
To move the read/write version of a DCE LFS fileset, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.ft\*O files on both the source and destination machines, and you must
be included in the \*Ladmin.fl\*O file on each Fileset Database machine or own
the server entries for the source machine, the destination machine, and any
machines on which replicas of the fileset reside.  In addition, the source
machine (specified with the \*L\-fromserver\*O option) must be listed in the
\*Ladmin.ft\*O file on the destination machine (specified with the
\*L\-toserver\*O option).  If necessary, issue the \*Lbos lsadmin\*O command to
verify the members of an administrative list.
.LI
Enter the \*Lfts move\*O command to move a read/write fileset from one site
to another:
.iS
\*C$ \*Lfts move -fileset \*O{\*Vname\*O | \*VID\*O} \*L\-fromserver \*Vsource_machine\*L \\
-fromaggregate \*Vsource_name \*L\-toserver \*Vdest_machine\*L \\
-toaggregate \*Vdest_name\*O
.iE
.P
The \*L\-fromserver\*O \*Vsource_machine\*O option names the File Server 
machine on which the fileset currently resides.  Specify the File Server 
machine using the machine's DCE pathname, the machine's host name, or the 
machine's IP address.
.P
The \*L\-fromaggregate\*O \*Vsource_name\*O option is the aggregate on which the
fileset is currently stored.
.P
The \*L\-toserver\*O \*Vdest_machine\*O option names the File Server machine 
to which the fileset is to move.  Specify the File Server machine using the 
machine's DCE pathname, the machine's host name, or the machine's IP address.
.P
The \*L\-toaggregate\*O \*Vdest_name\*O option is the aggregate on which the
fileset is to be stored after moving.
.LI
Enter the \*Lfts lsfldb\*O command to confirm that the move was successful:
.iS
\*C$ \*Lfts lsfldb -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.nL
.ne 20
.LI
Moving the read/write version of a fileset automatically deletes the backup
version of the fileset if it exists at the read/write fileset's previous site.
You can enter the \*Lfts clone\*O command to create a new backup version at the
new site:
.iS
\*C$ \*Lfts clone -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.LE
.iX "-]" "filesets" "moving"
.iX "-]" "\*Lfts\*O command suite" "\*Lmove\*O"
.H 2 "Dumping and Restoring Filesets"
.iX "incremental dumps" "about"
.iX "full dumps"
.iX "-[" "filesets" "dumping to disk"
.iX "-[" "dump files" "creating"
.iX "-[" "dump files" "restoring"
.iX "\*Lfts\*O command suite" "\*Ldump\*O"
.P
The \*Lfts dump\*O command converts the contents of a fileset to a byte stream
format that can be stored in a file.  Dumping a fileset does not affect its
status in the FLDB or at the site from which it is dumped.  You can dump a
non-LFS fileset or any of the three types of DCE LFS filesets.
.P
Dumping is useful when you need to save a snapshot of a fileset (for example,
when a fileset is removed but may later be restored).  It is also useful if the
read/write version of a fileset becomes corrupted; you can dump a backup or
read-only version of the fileset and restore it as the read/write version,
replacing the current, corrupted version.
.P
You can perform a full or incremental dump of a fileset. A full dump of a
fileset dumps the entire fileset as it currently exists.  An incremental dump
of a fileset dumps only those files from the fileset that have changed since
a specified date and time; only those files with modification time stamps
equal to or later than the specified time are dumped.
.P
With DCE LFS filesets, you can also perform incremental dumps of only those
files that have changed since a specified fileset version.  Every DCE LFS
fileset has a distinct version number that increments every time an operation
is performed on the fileset or a file it contains (for example, when a file,
directory, or ACL is modified).  Each file in the fileset also has a version
number.  When an operation is performed on a file in a fileset, both that file
and the fileset are marked with the current version number of the fileset
plus one.  When you do an incremental dump based on version, files in the
fileset with version numbers equal to or greater than the version number you
specify are dumped. (A DCE LFS fileset's version number is recorded in its
fileset header; it has the same format as a fileset ID number.  Use the \*Lfts
lsheader\*O or \*Lfts lsft\*O command to view the current version number of
a DCE LFS fileset.)
.P
.iX "\*Lfts\*O command suite" "\*Lrestore\*O"
The \*Lfts restore\*O command restores information from a previously dumped
fileset back into the file system.  Although you can dump a non-LFS fileset or
any of the three types of DCE LFS filesets, you can restore a dump file only
as a read/write fileset.  When you restore a fileset, its creation date is set
to the restoration date.
.P
You can use the \*Lfts dump\*O and \*Lfts restore\*O commands to dump and
restore data between different types of file systems.  For example, a dump file
of a DCE LFS fileset can be restored to a DCE LFS fileset or to any type of
non-LFS fileset.  Similarly, a dump file of a non-LFS fileset can be restored
to a DCE LFS fileset or to a different type of non-LFS fileset.  In any case,
the contents of the dump file are translated into the appropriate format for
the file system to which the file is restored. (See your vendor's documentation
to verify the level of support for dump and restore operations between
different types of file systems.)
.P
Note that incompatible information may be lost when a fileset is dumped and
restored between different types of file systems.  For example, ACLs on objects
in a DCE LFS fileset may be lost if the fileset is restored to a file system
that does not support ACLs.
.P
You can restore a dump file as a new DCE LFS fileset by specifying a name and
site (File Server machine and aggregate) for the new fileset.  The fileset is
assigned an entry in the FLDB, and it receives the name that you specify with
the command.  The dump file must contain the full dump of a fileset if it is
to be restored as a new fileset.  After the fileset is restored, use the \*Lfts
crmount\*O command to create a mount point for the fileset, which makes it
visible in the DCE namespace.
.P
.iX "filesets" "overwriting"
You can also restore a dump file as an existing read/write fileset (DCE LFS
or non-LFS) by specifying the name and site of the existing fileset that is to
be overwritten.  The contents of the dump file overwrite the contents of the
existing fileset.  Include the \*L\-overwrite\*O option with the \*Lfts
restore\*O command to specify that the existing fileset is to be overwritten;
if you omit the \*L\-overwrite\*O option, the command displays an error message
and exits instead of overwriting the fileset.  A non-LFS fileset must exist
before the non-LFS partition on which it resides can be exported to the DCE
namespace; therefore, when restoring a dump file as a non-LFS fileset, you
must use the \*L\-overwrite\*O option to overwrite the existing non-LFS fileset,
even if the fileset to be overwritten contains no data.
.nL
.ne 20
.P
If you are overwriting an existing fileset with an incremental dump, the
fileset to be overwritten should initially have been restored as a new
read/write fileset from a full dump.  Also, both the dump file that is to be
restored and the full dump that initially produced the read/write fileset that
is to be overwritten must be dumps of the same fileset.  Note that a full dump
can be restored to overwrite an existing fileset, but the restored dump file
overwrites all of the data in the existing fileset; an incremental dump cannot
be restored to overwrite an existing fileset that was not created from the
restoration of a full dump.
.P
For the same reasons that you cannot move a fileset between sites in different
cells, you cannot restore a fileset dumped in one cell to a site in another
cell. (See Section 7.8 for information on the reasons for this restriction.)
.P
Multiple incremental dumps of a fileset can be restored to overwrite the
same existing fileset provided the following conditions are true:
.ML
.LI
The fileset that is to be overwritten must not have been modified since its
most recent restoration.
.LI
The dump file that is to be restored must have been created \*Efrom\*O a date
and time (as specified with the \*L\-date\*O or \*L\-version\*O option of the
\*Lfts dump\*O command) \*Eno later\*O than the date and time at which the
most recently restored dump of the fileset that is to be overwritten was
dumped.
.LI
The dump file that is to be restored must have been created \*Eat\*O a date and
time \*Elater\*O than the date and time at which the most recently restored
dump of the fileset that is to be overwritten was dumped.
.LE
.P
The last two conditions specify that the span of time recorded in the
incremental dump that is to be restored must overlap and extend the span of
time recorded in the fileset that is to be overwritten.  For example, suppose a
full dump of a fileset was made on 1 February, an incremental dump from 31
January was made on 7 February, and a second incremental dump from 6 February
was made on 14 February.  The only possible way to restore all three dump files
is to restore the full dump to a new read/write fileset, overwrite the new
fileset with the incremental dump made on 7 February, and then overwrite the
fileset with the incremental dump made on 14 February.  Other sequences of
restore operations involving all three dumps are very likely to result in some
or all of the data in the fileset being inaccessible or inconsistent.
.nL
.ne 20
.P
When restoring a dump file as a DCE LFS fileset, you can use the \*L\-ftid\*O
option to specify the fileset ID number that is to be associated with the
fileset.  If you are restoring to a new DCE LFS fileset, omit the \*L\-ftid\*O
option to let the FL Server allocate a new ID number; if you are overwriting an
existing DCE LFS fileset, omit the option to retain the fileset's current ID
number.  Specify a fileset ID number only if you are sure you can specify an
unused ID.
.P
When restoring a dump file as a non-LFS fileset, do not use the \*L\-ftid\*O
option.  Omit the option to continue to use the fileset ID number specified for
the non-LFS fileset in the entry for the partition on which the fileset resides
in the \*Ldfstab\*O file.  Note that the restored dump file overwrites all data
on the non-LFS partition.
.nS "note"
The contents of a fileset are unavailable during a dump operation.  For this
reason, you may want to dump only the backup version of a fileset, which does
not interrupt access to the read/write and read-only versions.
.nE
.H 3 "Dumping a Fileset"
.P
To dump a fileset, do the following:
.AL
.LI
Verify that you have the necessary privilege.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the fileset is stored.  If
necessary, issue \*Lbos lsadmin\*O to verify the members of the administrative
list.
.LI
Verify that you have the \*Lw\*O (write), \*Lx\*O (execute), and \*Li\*O
(insert) ACL permissions for the directory in which you wish to store the
dump file.  If necessary, issue the \*Ldcecp acl show\*O command to list the
permissions for the directory.
.LI
.iX "\*Lfts\*O command suite" "\*Ldump\*O"
Enter the \*Lfts dump\*O command to dump the fileset:
.iS
\*C$ \*Lfts dump -fileset \*O{\*Vname\*O | \*VID\*O} {\*L\-time\*O {\*Vdate\*O | \*L0\*O} | \*L\-version \*Vnumber\*O} \\
[\*L\-server \*Vmachine\*O] [\*L\-file \*Vfilename\*O]
.iE
.P
The \*L\-time\*O \*Vdate\*O or \*L0\*O option specifies a full or incremental
dump.  Use the \*L\-time\*O option or use the \*L\-version\*O option.  There are
three valid entries for the \*L\-time\*O option:
.nL
.ne 20
.ML
.LI
The \*L0\*O entry causes a full dump of the current version.
.LI
The \*Vmm/dd/yy\*O entry causes an incremental dump from 12:00 a.m. on the
indicated date.
.LI
The \*Vmm/dd/yy hh:mm\*O entry causes an incremental dump from the specified
time on the indicated date.  The time must be in 24-hour format (for example,
\*L20:30\*O for 8:30 p.m.).  Surround the entire argument with "\|" (double
quotes) because it contains a space (for example, \*L"11/22/91 20:30"\*O).
.LE
.P
The \*L\-version\*O \*Vnumber\*O option specifies an incremental dump of the
indicated version of the fileset.  A fileset's version number is incremented
with every change to the fileset or a file that it contains.  Use the
\*L\-version\*O option or use the \*L\-time\*O option.  The \*L\-version\*O
option can be used \*Eonly\*O with DCE LFS filesets.
.P
The \*L\-server\*O \*Vmachine\*O option names the File Server machine that
houses the version of the fileset to be dumped.  This option is useful for
dumping a particular read-only replica of a DCE LFS fileset for which multiple
replicas exist.
.P
The \*L\-file\*O \*Vfilename\*O option specifies the complete pathname of the
file in which the dump is to be stored.  The current working directory is used
if a complete pathname is not provided.  If this option is omitted, the data is
sent to standard output (\*Lstdout\*O).
.LE
.iX "-]" "filesets" "dumping to disk"
.iX "-]" "dump files" "creating"
.H 3 "Restoring a Dump File to a New Fileset"
.iX "-[" "filesets" "restoring from disk"
.iX "-[" "\*Lfts\*O command suite" "\*Lrestore\*O"
.P
To restore a dump file to a new fileset, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the fileset is to be stored, and
you must be included in the \*Ladmin.fl\*O file on each Fileset Database
machine or own the server entry for the machine on which the fileset is to be
stored.  If necessary, issue the \*Lbos lsadmin\*O command to verify the members
of an administrative list.
.nL
.ne 20
.LI
Verify that you have the \*Lr\*O (read) ACL permission for the dump file and
the \*Lw\*O (write), \*Lx\*O (execute), and \*Li\*O (insert) ACL permissions
for the directory in which the mount point for the new fileset is to be
created.  If necessary, issue the \*Ldcecp acl show\*O command to list the
permissions for the objects.
.LI
Select a site (an aggregate on a File Server machine) for the fileset.  If
necessary, enter the \*Lfts aggrinfo\*O command to check the available space
on the aggregate on which the fileset is to be placed:
.iS
\*C$ \*Lfts aggrinfo -server \*Vmachine\*L -aggregate \*Vname\*O
.iE
.LI
Enter the \*Lfts restore\*O command to restore the dump file to a new fileset:
.iS
\*C$ \*Lfts restore -ftname \*Vname\*L -server \*Vmachine\*L -aggregate \*Vname\*O \\
[\*L\-file \*Vfilename\*O] [\*L\-ftid \*VID\*O]
.iE
.P
The \*L\-ftname\*O \*Vname\*O option specifies the name to be assigned to the
restored fileset.  The name can be no longer than 102 characters. (See Chapter
6 for more information on fileset naming conventions.)
.P
The \*L\-file\*O \*Vfilename\*O option specifies the complete pathname of the
file that is to be restored.  The current working directory is used if a
complete pathname is not provided.  If this option is omitted, the data is
taken from standard input (\*Lstdin\*O).
.P
The \*L\-ftid\*O \*VID\*O option specifies the fileset ID number that is to be
assigned to the fileset.  If this option is omitted, a new ID number is
allocated for the fileset.  Use this option with great care; make sure the
fileset ID number that you specify is not in use.
.LI
Issue the \*Lfts crmount\*O command to create a mount point in the file
system for the new fileset, making its contents visible to other users:
.iS
\*C$ \*Lfts crmount -dir \*Vdirectory_name\*L -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.P
The \*L\-dir\*O \*Vdirectory_name\*O option is the location for the root
directory of the fileset; the specified location must not already exist.
However, the parent directory of the mount point must exist in the DCE
namespace.  Include a complete pathname unless you want to mount the fileset in
the working directory.
.LE
.nL
.ne 20
.H 3 "Restoring a Dump File by Overwriting an Existing Fileset"
.iX "filesets" "overwriting"
.P
To restore a dump file by overwriting an existing fileset, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the fileset is to be stored, and
you must be included in the \*Ladmin.fl\*O file on each Fileset Database
machine or own the server entry for each machine on which a version of the
fileset to be overwritten is stored.  If necessary, issue the \*Lbos lsadmin\*O
command to verify the members of an administrative list.
.LI
Verify that you have the \*Lr\*O (read) ACL permission for the dump file.  If
necessary, issue the \*Ldcecp acl show\*O command to list the permissions for
the file.
.LI
Enter the \*Lfts restore\*O command to restore the dump file over an existing
read/write fileset, using the \*L\-overwrite\*O option to overwrite the current
contents of the fileset:
.iS
\*C$ \*Lfts restore -ftname \*Vname\*L -server \*Vmachine\*L -aggregate \*Vname\*O \\
[\*L\-file \*Vfilename\*O] [\*L\-ftid \*VID\*O] [\*L\-overwrite\*O]
.iE
.P
The \*L\-ftname\*O \*Vname\*O option specifies the name of the fileset that is
to be overwritten.
.P
The \*L\-file\*O \*Vfilename\*O option specifies the complete pathname of the
file that is to be restored.  The current working directory is used if a
complete pathname is not provided.  If this option is omitted, the data is read
from standard input (\*Lstdin\*O).
.P
The \*L\-ftid\*O \*VID\*O option specifies the fileset ID number that is to be
assigned to the fileset.  If this option is omitted, the current ID number of
the existing fileset is retained.  Use this option with great care; make sure
the fileset ID number you specify is not in use.  Use this option \*Eonly\*O
when restoring a dump file as a DCE LFS fileset; omit this option when
restoring a dump file as a non-LFS fileset.
.nL
.ne 20
.P
The \*L\-overwrite\*O option specifies that the restored fileset can overwrite
an existing fileset.  If this option is omitted, the command refuses to
overwrite an existing fileset.  You must use this option to overwrite a
previously restored version of a fileset with a dump file that contains an
incremental dump of the same fileset or to restore a dump file as a non-LFS
fileset.
.LI
If read-only copies of the former read/write fileset exist, use the \*Lfts
update\*O command to replace them with replicas of the new fileset.  If a
backup version exists, use the \*Lfts clone\*O command to replace it with
a backup version of the new fileset.
.LE
.iX "-]" "filesets" "restoring from disk"
.iX "-]" "dump files" "restoring"
.iX "-]" "\*Lfts\*O command suite" "\*Lrestore\*O" 
.H 2 "Removing DCE LFS Filesets"
.iX "-[" "filesets" "deleting"
.iX "replicas" "deleting (DFS)"
.P
You can use the \*Lfts delete\*O command to remove read/write and backup DCE
LFS filesets.  You can use the \*Lfts rmsite\*O command to remove replication
sites and instruct the Replication Servers at the sites to remove the read-only
DCE LFS filesets.  You can remove a read/write version without removing its
read-only versions, and vice versa.  You can also remove the backup version
without removing the read/write version by including the \*L.backup\*O
extension on the name of the fileset that is to be removed with the \*Lfts
delete\*O command.  However, the backup version is automatically removed when
the read/write version is removed. (Note that it is possible for a backup
version to remain after its read/write source is deleted if a delete operation
is interrupted prior to completion.)
.P
.iX "mount points" "deleting"
.iX "Fileset Location Database" "deleted filesets"
If no other versions of any kind exist when you remove the last version of a
DCE LFS fileset, the entire FLDB entry for the fileset is removed.  When you
remove the last version of a DCE LFS fileset, you also need to remove its
mount point with the \*Lfts delmount\*O command so users do not continue to
try to access the fileset's contents.  It is often better to remove a fileset's
mount point before deleting the fileset; removing the mount point first ensures
you that no users are accessing the fileset when it is deleted.
.nL
.ne 20
.P
If you remove a read/write version of a DCE LFS fileset and read-only copies
still exist, the FLDB status flags for the read/write version and the backup
version change to \*Linvalid\*O.  The fileset ID is still recorded for each
type, so you can restore the read/write version later.  However, when you
remove a read/write version of a fileset with the \*Lfts delete\*O command,
you should normally also remove its read-only copies by removing its
replication sites with the \*Lfts rmsite\*O command.
.P
If you remove a read-only DCE LFS fileset while other read-only sites still
exist, the site information for the removed copy is deleted from the FLDB
entry.  If no other read-only sites exist, the status flag for the read-only
version is also changed to \*Linvalid\*O; the fileset ID is still recorded, so
you can recreate the read-only version later.  If no other versions exist, the
entire FLDB entry for the fileset is removed.
.P
Removing the backup version of a DCE LFS fileset frees the space that it
occupied on disk and changes the backup status flag in the FLDB to
\*Cinvalid\*O.  Its fileset ID is still recorded, since under normal
circumstances the backup version cannot be the last existing version.  When you
remove the backup version, you may also want to remove its mount point from the
file system.
.P
.iX "\*Lfts\*O command suite" "\*Ldelete\*O"
The \*Lfts delete\*O command can be used only when an FLDB entry and a fileset
header exist for the fileset.  Other commands can be used to remove individual
FLDB entries and fileset headers. (See Section 7.10.2 for more information
about these commands.)
.P
Note that, when you delete a read/write or backup version of a DCE LFS fileset,
that version of the fileset no longer exists on disk.  Before removing the
read/write or backup version of a fileset, use the DFS Backup System to
preserve a permanent copy of it on tape.
.P
.nS "note"
You cannot remove a DCE LFS fileset that is also mounted locally (as a file
system on its File Server machine).  You must remove the fileset's local mount
point before attempting to delete the fileset.  Also, because the backup version
of a fileset is removed when the read/write version is removed, you cannot
remove the read/write version of a fileset if its backup version is mounted
locally; you must remove the backup version's local mount point before deleting
the read/write version.
.nE
.H 3 "Removing a DCE LFS Fileset and Its Mount Point"
.iX "-[" "mount points" "deleting"
.P
To remove a DCE LFS fileset and its mount point, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the fileset resides, and you must
be included in the \*Ladmin.fl\*O file on each Fileset Database machine or own
the server entry for each machine on which a version of the fileset resides.
If necessary, issue the \*Lbos lsadmin\*O command to verify the members of an
administrative list.
.LI
Verify that you have the \*Lw\*O (write), \*Lx\*O (execute), and \*Ld\*O
(delete) ACL permissions for the directory in which the fileset is mounted.  If
necessary, issue the \*Ldcecp acl show\*O command to list the permissions for
the directory.
.LI
Issue the \*Lfts rmsite\*O command to remove the fileset's replication sites
and to instruct the Replication Servers at the sites to remove the read-only
versions of the fileset:
.iS
\*C$ \*Lfts rmsite -fileset \*O{\*Vname\*O | \*VID\*O} \*L\-server \*Vmachine \*L\-aggregate \*Vname\*O
.iE
.P
Repeat the \*Lfts rmsite\*O command to remove each of the fileset's replication
sites.  If Release Replication was used for the fileset, the \*Lfts rmsite\*O
command must also be used to remove the replication site and read-only replica
on the read/write fileset's File Server machine.
.LI
Issue the \*Lfts delete\*O command to remove the read/write version of the
fileset.  The backup version of the fileset is removed automatically.
.iS
\*C$ \*Lfts delete -fileset \*O{\*Vname\*O | \*VID\*O}\*L -server \*Vmachine \*L\-aggregate \*Vname\*O
.iE
.LI
After removing the last copy of the fileset, enter the \*Lfts delmount\*O
command to remove the mount point for the fileset.  Disregard this step if any
copies of the read-only version remain in the file system and you want them to
be accessible.
.iS
\*C$ \*Lfts delmount -dir \*Vdirectory_name\*O
.iE
.P
The \*L\-dir \*Vdirectory_name\*O option is the name of the mount point for
the fileset.
.P
If you previously mounted the backup version as a subdirectory of the
read/write fileset's root directory, removing the read/write version's mount
point makes the backup version's mount point inaccessible.  If you mounted the
backup version at a separate directory, you must explicitly remove the backup
version's mount point, again using the \*Lfts delmount\*O command.
.LE
.H 3 "Other Commands for Removing Filesets"
.iX "-[" "filesets" "deleting in emergency"
.P
Under normal circumstances, always use the \*Lfts delete\*O or \*Lfts
rmsite\*O command to remove a fileset; these commands automatically record the
deletion in the FLDB.  Under special circumstances, however, you may need to
use the following commands.  Keep in mind that, if the FLDB and the filesets are
consistent with each other, these commands make them inconsistent.  Never use
these commands unless absolutely necessary.
.ML
.LI
.iX "\*Lfts\*O command suite" "\*Ldelfldbentry\*O"
Use the \*Lfts delfldbentry\*O command to remove an FLDB entry that mentions
a particular fileset.  If versions of the fileset still exist at sites, they
are not affected.  This is useful if you are certain that a fileset removal
was not recorded in the FLDB, and you do not want to use the \*Lfts syncfldb\*O
and \*Lfts syncserv\*O commands to synchronize the entire FLDB.  Use the \*Lfts
lsfldb\*O or \*Lfts lsft\*O command to determine if a fileset removal was
recorded in the FLDB.
.LI
.iX "\*Lfts\*O command suite" "\*Lzap\*O"
Use the \*Lfts zap\*O command when it is urgent that a fileset be removed from
its site, but the FLDB is inaccessible (for example, if the FL Server is
unavailable).  You can then remove the fileset's entry from the FLDB by entering
the \*Lfts delfldbentry\*O command or by entering the \*Lfts syncfldb\*O and
\*Lfts syncserv\*O commands to synchronize the FLDB.  The \*Lfts zap\*O command,
like the \*Lfts delete\*O command, cannot be used to remove a DCE LFS fileset
that is also mounted locally; you must remove the fileset's local mount point
before attempting to delete the fileset.
.LE
.P
The following subsections provide brief descriptions of the syntax and use of
these commands.
.iX "-]" "filesets" "deleting in emergency"
.H 4 "Removing a Fileset's FLDB Entry Without Removing the Fileset"
.iX "Fileset Location Database" "deleting fileset entries"
.P
To remove a fileset's FLDB entry without removing the fileset, do the
following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.fl\*O file on each Fileset Database machine or own the server entry
for each machine that houses a version of any fileset whose FLDB entry is to
be removed.  If necessary, issue the \*Lbos lsadmin\*O command to verify the
members of an administrative list.
.LI
Enter the \*Lfts delfldbentry\*O command to remove the fileset entry from
the FLDB.  Because this command lets you remove multiple FLDB entries
simultaneously, be careful to remove only those FLDB entries you no longer
need.
.iS
\*C$ \*Lfts delfldbentry \*O{\*L\-fileset\*O {\*Vname\*O | \*VID\*O} | \*L\-prefix \*Vstring\*O} \\
[\*L\-server \*Vmachine\*O] [\*L\-aggregate \*Vname\*O]
.iE
.P
The \*L\-prefix\*O \*Vstring\*O option specifies a character string of any
length.  Every FLDB entry that lists a fileset whose name begins with
\*Vstring\*O is removed.  If the \*L\-server\*O and \*L\-aggregate\*O options
are specified, only entries for filesets on the specified server machine and
the specified aggregate are removed.  Use the \*L\-prefix\*O option, or use the
\*L\-fileset\*O option to specify the name or ID number of the fileset whose
FLDB entry is to be removed.
.LE
.H 4 "Removing a DCE LFS Fileset Without Updating Its FLDB Entry"
.P
To remove a DCE LFS fileset without updating its FLDB entry, do the following:
.AL
.LI
Verify that you have the necessary privilege.  You must be included in the
\*Ladmin.ft\*O file on the machine on which the fileset to be removed resides.
If necessary, issue the \*Lbos lsadmin\*O command to verify the members of the
administrative list.
.LI
Enter the \*Lfts zap\*O command to remove the fileset without recording the
removal in the FLDB:
.iS
\*C$ \*Lfts zap -ftid \*VID\*L -server \*Vmachine\*L -aggregate \*Vname\*O
.iE
.P
The \*L\-ftid\*O \*VID\*O option specifies the fileset ID number of the fileset
that is to be removed.
.LE
.H 3 "Removing Non-LFS Filesets"
.iX "-[" "filesets" "deleting non-LFS"
.iX "\*Lfts\*O command suite" "\*Ldelfldbentry\*O"
.P
When you remove a non-LFS fileset, it becomes inaccessible in the DCE
namespace.  However, it is still available on the local disk of the machine on
which it resides. (You can use the appropriate command in your local operating
system to remove the partition that houses the non-LFS fileset from the disk.)
.P
To remove a non-LFS fileset from the DCE namespace, use the \*Lfts
delfldbentry\*O command to remove the entry for the fileset from the FLDB.
This prevents the FL Server from reporting the location of the fileset to a
Cache Manager that requests data from the fileset.  The \*Lfts delfldbentry\*O
command lets you remove multiple FLDB entries simultaneously; be careful to
remove only those FLDB entries you no longer need.
.P
Once you remove the fileset's FLDB entry, use the \*Lfts delmount\*O command to
remove the mount point for the fileset.  Then issue the \*Ldfsexport\*O command
with the \*L\-detach\*O option to detach the non-LFS partition on which the
fileset resides from the namespace; when you detach a partition, it is no
longer exported.  These steps make the fileset unavailable in the DCE
namespace.  After you issue the \*Ldfsexport\*O command, remove the partition's
entry from the \*Vdcelocal\*L/var/dfs/dfstab\*O file to prevent it from being
exported the next time the machine is rebooted; note that this occurs only if
the \*Ldfsexport\*O command is included in the machine's initialization file
(\*L/etc/rc\*O or its equivalent).
.P
Any of these steps performed alone makes the fileset inaccessible. However,
you should always perform all of the steps whenever you remove a non-LFS
fileset to prevent future problems, such as a mount point that refers to a
fileset that is no longer exported.
.P
To remove a non-LFS fileset and its mount point, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.fl\*O file on each Fileset Database machine or own the server entry
for the machine on which the fileset resides.  If necessary, issue the \*Lbos
lsadmin\*O command to verify the members of an administrative list.
.LI
Verify that you have the \*Lw\*O (write), \*Lx\*O (execute), and \*Ld\*O
(delete) ACL permissions for the directory in which the fileset is mounted.  If
necessary, issue the \*Ldcecp acl show\*O command to list the permissions for
the directory.
.LI
Issue the \*Lfts delfldbentry\*O command to remove the fileset entry from the
FLDB:
.iS
\*C$ \*Lfts delfldbentry \*O{\*L\-fileset\*O {\*Vname\*O | \*VID\*O} | \*L\-prefix \*Vstring\*O} \\
[\*L\-server \*Vmachine\*O] [\*L\-aggregate \*Vname\*O]
.iE
.P
The \*L\-prefix\*O \*Vstring\*O option specifies a character string of any
length.  Every FLDB entry that lists a fileset whose name begins with
\*Vstring\*O is removed.  If the \*L\-server\*O and \*L\-aggregate\*O options 
are specified, only entries for filesets on the specified server machine and 
the specified aggregate are removed.  Use the \*L\-prefix\*O option, or use the
\*L\-fileset\*O option to specify the name or ID number of the fileset whose
FLDB entry is to be removed.
.LI
Enter the \*Lfts delmount\*O command to remove the fileset's mount point:
.iS
\*C$ \*Lfts delmount -dir \*Vdirectory_name\*O
.iE
.P
The \*L\-dir\*O \*Vdirectory_name\*O option is the name of the mount point you
want to remove.
.LI
Log in as \*Lroot\*O on the machine on which the fileset resides.
.LI
Enter the \*Ldfsexport\*O command with the \*L\-detach\*O option to detach the
partition from the DCE namespace:
.iS
\*C# \*Ldfsexport -aggregate \*Vname \*L\-detach\*O
.iE
.P
The \*L\-aggregate \*Vname\*O option specifies the device name or exported
aggregate name of the partition to be detached.
.P
The \*L\-detach\*O option indicates that the specified partition is to be
detached.
.LI
Use a text editor to remove the partition's entry from the \*Ldfstab\*O file.
An entry for a non-LFS partition in the \*Ldfstab\*O file has the following
format:
.oS
\*C/dev/lv02\ \ /usr\ \ ufs\ \ 1\ \ 0,,18756\*O
.oE
.LE
.iX "-]" "mount points" "deleting"
.iX "-]" "filesets" "deleting non-LFS"
.iX "-]" "filesets" "deleting"
.H 2 "Locking and Unlocking FLDB Entries"
.iX "-[" "Fileset Location Database" "locking fileset entries"
.iX "-[" "Fileset Location Database" "unlocking fileset entries"
.iX "\*Lfts\*O command suite" "\*Llock\*O"
.iX "-[" "\*Lfts\*O command suite" "\*Lunlock\*O"
.iX "-[" "filesets" "blocking operations"
.iX "-[" "filesets" "unblocking operations"
.P
The FL Server locks the FLDB entry for a DCE LFS or non-LFS fileset before the
Fileset Server executes any operations on it.  A fileset with a locked FLDB
entry is not affected by any other fileset manipulation operations such as
moving or backing up a fileset.  This immunity from other operations prevents
inconsistencies or corruptions that can result from multiple simultaneous
operations on a fileset.  You can use the \*Lfts lock\*O command to lock an
FLDB entry and prevent an \*Lfts\*O command from accessing it.  You may want to
lock an entry when you suspect it may be in error to prevent anyone from
writing to it while you check the problem.
.P
If an \*Lfts\*O command operation fails prematurely, the FLDB entries can
remain locked, preventing you from executing commands that can correct the
problems.  You can use the \*Lfts lsft\*O and \*Lfts lsfldb\*O commands to
examine locked FLDB entries; you can use the \*Lfts unlock\*O command to unlock
a specific FLDB entry. 
.P
The \*Lfts unlockfldb\*O command lets you unlock a set of entries based on the
options you provide:
.ML
.LI
When you provide no options, all locked entries are unlocked
.LI
When you specify a File Server machine with the \*L\-server\*O option, all locked 
entries with that machine in a site definition are unlocked
.LI
When you specify an aggregate with the \*L\-aggregate\*O option and a File Server 
machine with the \*L\-server\*O option, all locked entries with that aggregate 
and that machine in a site definition are unlocked
.LE
.H 3 "Determining Whether an FLDB Entry is Locked"
.P
To determine whether an FLDB entry is locked, issue the \*Lfts lsfldb\*O
command:
.iS
\*C$ \*Lfts lsfldb -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.P
If the entry is locked, the word \*LLocked\*O appears on a line of the output
of the command.  The \*Lfts lsft\*O command also displays the same line in its
output if an entry it is examining is locked.
.H 3 "Locking an FLDB Entry"
.P
To lock an FLDB entry, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.fl\*O file on each Fileset Database machine or own the server entry
for each machine on which a version of the fileset to be locked resides.  If
necessary, issue the \*Lbos lsadmin\*O command to verify the members of an
administrative list.
.LI
Issue the \*Lfts lock\*O command to lock the entry:
.iS
\*C$ \*Lfts lock -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.LE
.H 3 "Unlocking a Single FLDB Entry"
.P
To unlock a single FLDB entry, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.fl\*O file on each Fileset Database machine or own the server entry
for each machine on which a version of the fileset to be unlocked resides.  If
necessary, issue the \*Lbos lsadmin\*O command to verify the members of an
administrative list.
.nL
.ne 20
.LI
Issue the \*Lfts unlock\*O command to unlock the entry:
.iS
\*C$ \*Lfts unlock -fileset \*O{\*Vname\*O | \*VID\*O}
.iE
.LE
.H 3 "Unlocking Multiple FLDB Entries"
.P
To unlock multiple FLDB entries, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.fl\*O file on each Fileset Database machine or own the server entry
for each machine on which a version of any fileset to be unlocked resides.  If
necessary, issue the \*Lbos lsadmin\*O command to verify the members of an
administrative list.
.LI
Issue the \*Lfts unlockfldb\*O command to unlock all entries or only those
entries on a specified server, on a specified aggregate, or on both:
.iS
\*C$ \*Lfts unlockfldb \*O[\*L\-server \*Vmachine\*O] [\*L\-aggregate \*Vname\*O]
.iE
.LE
.iX "-]" "\*Lfts\*O command suite" "\*Lunlock\*O"
.iX "-]" "Fileset Location Database" "locking fileset entries"
.iX "-]" "Fileset Location Database" "unlocking fileset entries"
.iX "-]" "filesets" "blocking operations"
.iX "-]" "filesets" "unblocking operations"
.H 2 "Synchronizing the FLDB and Fileset Headers"
.iX "-[" "fileset headers" "synchronizing with FLDB"
.iX "-[" "Fileset Location Database" "synchronizing with fileset headers"
.P
In DFS, transparent file access is possible because the FLDB constantly tracks
fileset locations.  When the Cache Manager needs a file, it contacts the FL
Server, which consults the FLDB to find the current location of the file.
Therefore, the FLDB must accurately reflect the state of filesets on all File
Server machines.  To keep the FLDB accurate, all \*Lfts\*O commands that affect
fileset status automatically record the change in the appropriate FLDB entry.
.P
Whenever you issue a command that changes the status of a fileset, the
\*Lfts\*O program does the following:
.ML
.LI
Directs the FL Server to lock the FLDB entry; the lock advises other operations not to
attempt to manipulate any of the fileset's versions (read/write, read-only, or
backup).  This prevents simultaneous operations.
.LI
Directs the FL Server to set an intention flag in the FLDB entry to indicate the type of
operation to be performed.
.nL
.ne 20
.LI
Directs the Fileset Server to perform the operation on the fileset.  It may set an
\*LOff-line\*O flag in the header, making the fileset inaccessible to other
operations.  When the operation is completed, the fileset is again marked
\*LOn-line\*O.
.LI
Directs the FL Server to record the changes from the Fileset Server's operation in the
FLDB.  When the operation completes, the lock is released and the intention
flag is removed.  The fileset is again available for further operations.
.LE
.P
Errors can occur if you are forced to stop an operation with an abort signal
or if a File Server machine or server process goes down after you issue an
\*Lfts\*O command but before the requested operation is complete.  It is likely
in these situations that the FLDB is not synchronized with the headers of
filesets on File Server machines.  The following symptoms indicate that the
FLDB and fileset headers are not synchronized:
.ML
.LI
Error messages indicate that the operation terminated abnormally.
.LI
A subsequent \*Lfts\*O operation fails because the initial failure left an
FLDB entry locked.
.LI
A subsequent \*Lfts\*O operation fails because the initial failure left a
fileset marked \*LOff-line\*O.
.LE
.P
.iX "-[" "\*Lfts\*O command suite" "\*Lsyncfldb\*O"
.iX "-[" "\*Lfts\*O command suite" "\*Lsyncserv\*O"
The \*Lfts syncfldb\*O and \*Lfts syncserv\*O commands are used to synchronize
the FLDB and fileset headers.  The \*Lfts syncfldb\*O command examines the
fileset header of each online fileset on a specified File Server machine (or,
optionally, a specified aggregate or partition on that File Server machine). 
It then checks the FLDB entry associated with the fileset header to verify 
that the FLDB entry is consistent with the fileset header.  If an FLDB entry 
is not consistent with its fileset header, the \*Lfts syncfldb\*O command 
changes the FLDB entry to make it consistent with the fileset header.  If no 
FLDB entry exists for an online fileset, the command creates one; if an FLDB 
entry exists for a nonexistent fileset, the command deletes that entry.
.P
The \*Lfts syncfldb\*O command also performs three additional functions:
.ML
.LI
If it finds a backup fileset whose read/write source no longer exists at the
same site, it displays a warning message.
.nL
.ne 20
.LI
If it finds a fileset ID number that is larger than the value of the counter
that is used by the FL Server when allocating fileset ID numbers, it records
this ID number as the new value of the counter.  The next fileset to be created
receives a fileset ID number that is one greater than this number.
.LI
If necessary, it increments or decrements the number of fileset entries
recorded as residing on a File Server machine in the FLDB entry for the server.
.LE
.P
Note that the \*Lfts syncfldb\*O command exits if it encounters a fileset
that is busy.  A busy fileset is one on which a fileset-related operation such
as a move, clone, or release is currently in progress.
.P
The \*Lfts syncserv\*O command inspects the FLDB entry of each fileset on a
specified File Server machine (or, optionally, a specified aggregate or
partition on that File Server machine).  The command then checks that
each fileset header is consistent with its FLDB entry.  If the command
finds an inconsistency between the fileset name found in the fileset header
and the name found in the FLDB entry, the fileset header is renamed to reflect
the name in the FLDB entry.  If the command encounters a fileset marked as
\*LOff-line\*O, but the fileset's FLDB entry lists it as being \*Lvalid\*O,
the command places the fileset online.
.P
To ensure that the FLDB and all fileset headers in your cell are synchronized,
run the \*Lfts syncfldb\*O command once for each File Server machine in your
cell.  Then run the \*Lfts syncserv\*O command once for each File Server machine
in your cell.
.P
Note that, while the \*Lfts syncfldb\*O and \*Lfts syncserv\*O commands are
useful in error recovery, they do not, in general, recover all of the
information that is stored with a fileset's entry in the FLDB.  More
specifically, if the FLDB entry for a DCE LFS fileset is removed somehow and
then recreated with the \*Lfts syncfldb\*O command, replication information
associated with the fileset is not restored.  The \*Lfts syncfldb\*O and \*Lfts
syncserv\*O commands cannot reproduce replication information once the entry
for a DCE LFS fileset is removed from the FLDB.  You must use the \*Lfts
setrepinfo\*O and \*Lfts addsite\*O commands to reconstruct the replication
information.
.iX "-]" "\*Lfts\*O command suite" "\*Lsyncfldb\*O"
.iX "-]" "\*Lfts\*O command suite" "\*Lsyncserv\*O"
.nL
.ne 20
.H 3 "Synchronizing Non-LFS Filesets"
.iX "-[" "filesets" "synchronizing non-LFS"
.P
The \*Lfts syncfldb\*O and \*Lfts syncserv\*O commands can be used to ensure
the consistency of non-LFS filesets.  However, because non-LFS filesets do not
have fileset headers, the effectiveness of the commands is limited.  You may
need to take a more active role in returning consistency to non-LFS filesets
and their FLDB entries.
.P
For example, because non-LFS filesets do not have fileset headers, the \*Lfts
syncfldb\*O command cannot determine the name of a non-LFS fileset that has no
FLDB entry.  If the command determines that it needs to create an FLDB entry for
a non-LFS fileset, it generates a unique name of the form
\*LSYNCFLDB-ADDED-\*Vnumber\*O.  You then need to issue the \*Lfts rename\*O
command to rename the fileset to its original name.
.P
.H 3 "Synchronizing Fileset Information"
.P
To synchronize the FLDB and fileset headers, do the following:
.AL
.LI
Verify that you have the necessary privileges.  You must be included in the
\*Ladmin.ft\*O file on each machine that houses a version of any fileset
stored at a site specified with the \*Lfts syncfldb\*O or \*Lfts syncserv\*O
command.  You must also be included in the \*Ladmin.fl\*O file on each Fileset
Database machine or own the server entry for each machine that houses a
version of any fileset stored at a site specified with either command.  If
necessary, issue the \*Lbos lsadmin\*O command to verify the members of an
administrative list.
.LI
Issue the \*Lfts syncfldb\*O command to make FLDB entries consistent with
filesets that are stored at the specified site. \*ERepeat this command for
every File Server machine in your cell.\*O
.iS
\*C$ \*Lfts syncfldb -server \*Vmachine\*O [\*L\-aggregate \*Vname\*O]
.iE
.P
The \*L\-aggregate\*O \*Vname\*O option names the aggregate on the server
machine specified with the \*L\-server\*O option for which fileset headers
and FLDB entries are to be compared.  Do not use this option under normal
circumstances; omitting it allows synchronization of all of the filesets on
the machine specified with the \*L\-server\*O option.  Use it only when just a
single aggregate needs to be synchronized.
.LI
Issue the \*Lfts syncserv\*O command to make filesets that are stored at the
specified site consistent with FLDB entries. \*ERepeat this command for every
File Server machine in your cell.\*O
.iS
\*C$ \*Lfts syncserv -server \*Vmachine\*O [\*L\-aggregate \*Vname\*O]
.iE
.P
The \*L\-aggregate\*O \*Vname\*O option names the aggregate on the server
machine specified with the \*L\-server\*O option for which fileset headers
and FLDB entries are to be compared.  Do not use this option under normal
circumstances; omitting it allows synchronization of all of the filesets on
the machine specified with the \*L\-server\*O option.  Use it only when just a
single aggregate needs to be synchronized.
.LE
.iX "-]" "Fileset Location Database" "synchronizing with fileset headers"
.iX "-]" "filesets" "synchronizing non-LFS"
.iX "-]" "fileset headers" "synchronizing with FLDB"
.H 2 "Verifying and Maintaining File System Consistency"
.iX "-[" "Distributed File Service (DFS)" "structural integrity"
.iX "-[" "Salvager" "about"
.P
Many operating systems use the \*Lfsck\*O program to ensure file system
consistency after a system failure.  The \*Lfsck\*O program checks the
consistency of a file system and reports its findings.  Optionally, it repairs
problems that it finds in the file system.  The \*Lfsck\*O program (or its
equivalent) is still used to return consistency to many types of non-LFS
partitions.
.P
DFS employs a log mechanism and an additional system application, the DFS
Salvager, to ensure the consistency of DCE LFS aggregates.  A log is kept of
all changes made to metadata on a DCE LFS aggregate as a result of operations
such as file creation and deletion.  The metadata records the structure and
organization of the file system.  Each DCE LFS aggregate has its own log, which
physically resides on the aggregate, where it is completely transparent to
users.
.P
The DFS Salvager returns consistency to a file system when the system is
restarted by replaying the log.  Under normal circumstances, replaying the log
returns the file system to a consistent state.  However, if the Salvager detects
problems in the basic structure of the aggregate, if the log mechanism is
damaged, or if the physical storage medium of the aggregate is suspect,
replaying the log cannot restore consistency.  In these cases, a system
administrator must invoke the Salvager a second time to examine and repair
the structure of the aggregate.
.H 3 "Overview of the DFS Salvager"
.P
The DFS Salvager is used to replay the log on an aggregate and, if necessary,
to find and repair file system inconsistencies that cannot be repaired by
replaying the log.  Along with the normal consistency guarantees provided by
the log mechanism, the Salvager performs the same type of functions as the
\*Lfsck\*O program in other operating systems: It reads the metadata that
describes the contents of a file system, analyzes the internal organization
and structure of the file system, and detects and repairs inconsistencies.
.P
The Salvager is invoked with the \*Vdcelocal\*L/bin/salvage\*O command. The
command can be used to direct the Salvager to do the following:
.ML
.LI
Recover an aggregate following a system restart by replaying the log on the
aggregate.  The Salvager's replaying of the log is referred to as running
recovery on the aggregate (or simply recovering the aggregate).  This is the
normal production use of the Salvager.  Unless the contents of the log or the
physical structure of the aggregate is damaged, replaying the log is an
effective guarantee of a file system's integrity.
.LI
Verify the structure of an aggregate to determine if it contains any
inconsistencies.  Recovering an aggregate and then verifying its structure 
represents a cautious application of the Salvager.  Note that the Salvager can
also be used to verify an aggregate before recovery is run, but the Salvager
typically finds problems with an unrecovered aggregate that it would not find
were recovery run first.  In general, the findings of the Salvager for an
unrecovered aggregate are of questionable worth.
.LI
Salvage an aggregate by attempting to repair any inconsistencies it finds in
the structure of the aggregate.  Because recovery eliminates inconsistencies in
an undamaged file system, an aggregate is typically recovered before it is
salvaged.  It is usually a good idea first to recover and then to salvage an
aggregate if a machine panics or experiences a hardware failure.
.LE
.P
As noted, running recovery to return consistency to a file system at restart
time is the normal application of the Salvager.  When it is installed, DFS
automatically updates the local \*L/etc/rc.dfs\*O configuration file to
include the commands necessary to recover each DCE LFS aggregate listed in
the \*Ldfstab\*O file when the system is restarted.  The system administrator
can use the Salvager to verify or salvage an aggregate in addition to or
instead of running recovery, as the situation warrants.
.P
It is important to distinguish between file system consistency and user data
consistency.  The Salvager reads file system metadata; it does not try to verify
the contents of the files in that file system.  The Salvager can verify that
each block in a file is correctly attached to that file, but it cannot verify
the actual contents of the blocks.  In cases where the metadata associated with
a file is damaged, the owner of the file needs to verify that the file's
contents are intact.
.P
For example, if a disk controller accidentally writes on the disk surface,
the Salvager tries to repair any inconsistencies in the structure of the file
system.  However, it has no mechanism to guarantee the contents of any file.
In this case, the Salvager identifies any files whose metadata was damaged.
After the file system is salvaged, users can verify the contents of these
files; files whose contents were damaged can be restored from backups made
before the file system problems occurred.
.P
Not all aggregates can be salvaged. In the case of extensive damage to the
structure of an aggregate or damage to the physical disk that houses an
aggregate, the Salvager cannot repair inconsistencies.
.iX "-]" "Salvager" "about"
.H 3 "Differences Between the DFS Salvager and fsck"
.iX "Salvager" "compared to \*Lfsck\*O program"
.iX "\*Lfsck\*O program" "compared to Salvager"
.iX "Salvager" "and data consistency"
.P
While the DFS Salvager performs a role similar to that of the \*Lfsck\*O
program, several major differences distinguish the two programs:
.ML
.LI
Recovery is usually sufficient to restore file system consistency at boot time.
For this reason, the Salvager is typically used only to recover, not to verify
or salvage, an aggregate when the system reboots.  An administrator needs to use
the Salvager to salvage an aggregate only if file system damage is suspected;
for example, if the log cannot be replayed successfully, if a fileset cannot be
mounted, or if a controller or disk failure affects the file system.
.nL
.ne 20
.LI
The Salvager does not normally prompt the issuer for direction.  It asks for
confirmation to proceed only if it suspects that the aggregate on which it is
run is not a DCE LFS aggregate or if it finds that the size of the aggregate
that is recorded on disk exceeds the capacity of the partition on which the
aggregate resides.  It never asks the issuer for direction on how to repair the
file system, in which respect it is similar to the \*Lfsck -p\*O command.
Because of this, it can be run in the background, and several Salvager
processes can be run simultaneously.
.P	
Note that the \*L\-force\*O option of the \*Lsalvage\*O command can be used to
direct the Salvager to proceed with all operations without requesting
confirmation.  However, if the Salvager is run on an invalid aggregate, using
the \*L\-force\*O option can produce unexpected changes.
.LI
The Salvager displays information about files to be restored based on problems
it discovers when it verifies or salvages an aggregate.  A complete list of
files (with pathnames, if possible) is printed when the operation completes.
This output helps the system administrator complete the recovery of the files
in the repaired file system.
.LE
.H 3 "Using the DFS Salvager"
.iX "\*Lsalvage\*O command"
.iX "aggregates" "repairing structure"
.iX "disk space" "DFS Salvager requirements"
.iX "-[" "Salvager" "using"
.P
The \*Lsalvage\*O command is used to direct the Salvager to recover, verify,
or salvage the structure of an aggregate.  Combine the command's
\*L\-recoveronly\*O, \*L\-verifyonly\*O, and \*L\-salvageonly\*O options as
follows to specify the operations the Salvager is to perform on the specified
aggregate:
.VL
.LI "Specify the \*L\-recoveronly\*O option\*O"
.P
To run recovery on the aggregate without attempting to determine or repair any
inconsistencies found on it.  Use this option to quickly return  consistency to
an aggregate that does not need to be salvaged.  This represents the normal
production use of the Salvager.
.nL
.ne 20
.LI "Specify the \*L\-verifyonly\*O option"
.P
To determine whether the structure of the aggregate contains any
inconsistencies without running recovery or attempting to repair any
inconsistencies found on the aggregate.  Use this option to assess the extent
of the damage to an aggregate.  The Salvager makes no modifications to an
aggregate during verification.  Note again that it is normal for the Salvager
to find errors when it verifies an aggregate that has not been recovered.
.LI "Specify the \*L\-recoveronly\*O and \*L\-verifyonly\*O options"
.P
To run recovery on the aggregate and then analyze its structure without
attempting to repair any inconsistencies found on it.  Use these options if
you believe that replaying the log can return consistency to the aggregate, but
you want to verify the consistency of the aggregate after recovery is run.  This
approach is more cautious than recovering the aggregate without verification.
.LI "Specify the \*L\-salvageonly\*O option\*O"
.P
To attempt to repair any inconsistencies found in the structure of the
aggregate without first running recovery on it.  Use this option if you believe
that the log is damaged or that replaying the log will not return consistency
to the aggregate and may in fact further damage it.  Under normal circumstances,
do not salvage an aggregate without first recovering it.
.LI "Omit the \*L\-recoveronly\*O, \*L\-verifyonly\*O, and \*L\-salvageonly\*O options"
.P
To run recovery on the aggregate and then attempt to repair any inconsistencies
found in the structure of the aggregate.  Omit these three options if you
believe the log should be replayed before attempts are made to repair any
inconsistencies found on the aggregate.
.LE
.P
You cannot use the Salvager to recover or salvage an aggregate that is
currently exported to the DCE namespace.  If asked to perform either of these
operations on an exported aggregate, the Salvager exits without performing
the operation.  If necessary, use the \*Ldfsexport\*O command to detach an
aggregate from the global namespace before recovering or salvaging it.  Note
that the Salvager also exits if it is run on an aggregate that houses a locally
mounted fileset.
.nL
.ne 20
.P
The Salvager prompts for direction only if one of the following is true:
.ML
.LI
The aggregate on which it is run contains a non-LFS superblock whose creation
time is more recent than that of its DCE LFS superblock.
.LI
The size of the aggregate that is recorded in its DCE LFS superblock exceeds
the capacity of the partition on which the aggregate resides.
.LE
.P
At the prompt, you can choose to cancel or continue the operation.  If you
continue the operation in either of these situations and the aggregate proves
to be invalid, the operation can produce unpredictable results.  The best
response in either case is to cancel the operation and attempt to determine
the cause of the problem.  Note that the command's \*L\-force\*O option can be
used to direct the Salvager to proceed rather than prompt for confirmation in
these cases.
.P
Internal structures maintained by the Salvager require a minimum of 1 megabyte
of swap space.  However, the total amount of swap space required by the Salvager
depends largely on the size of the aggregate being salvaged and the extent of
the damage to the aggregate.
.H 3 "Recovering, Verifying, or Salvaging a File System"
.P
To recover, verify, or salvage a file system, do the following:
.AL
.LI
If the specified aggregate is to be recovered or salvaged, log in as \*Lroot\*O
on the local machine or verify that you have both the \*Lr\*O (read) and
\*Lw\*O (write) permissions for the aggregate.  If the specified aggregate is to
be verified, log in as \*Lroot\*O on the local machine or verify that you have
the \*Lr\*O (read) permission for the aggregate.
.LI
Ensure that the DCE LFS aggregate to be specified with the command is not
exported and contains no locally mounted filesets.
.LI
Enter the \*Lsalvage\*O command to run recovery on the aggregate, verify the
consistency of the aggregate, or attempt to repair the consistency of the
aggregate:
.iS
\*C# \*Lsalvage -aggregate \*Vname\*O [\*L\-recoveronly\*O] \\
[{\*L\-verifyonly\*O | \*L\-salvageonly\*O}] \\
[\*L\-force\*O] [\*L\-verbose\*O]
.iE
.nL
.ne 20
.P
The \*L\-aggregate\*V name\*O option is the device name or aggregate name of the
DCE LFS aggregate that is to be recovered, verified, or salvaged.  Note that the
aggregate ID of the aggregate is not an acceptable value.
.P
The \*L\-recoveronly\*O option directs the Salvager to recover the specified
aggregate.  The Salvager replays the log of metadata changes that resides on the
aggregate.
.P
The \*L\-verifyonly\*O option directs the Salvager to verify the specified
aggregate.  The Salvager examines the structure of the aggregate to determine
if it contains any inconsistencies, reporting any that it finds.
.P
The \*L\-salvageonly\*O option directs the Salvager to salvage the specified
aggregate.  The Salvager attempts to repair any inconsistencies it finds on the
aggregate.
.P
The \*L\-force\*O option executes the Salvager in noninteractive mode.  By
default, the Salvager prompts for confirmation before proceeding in certain
situations.  Use this option to direct the Salvager to proceed with all
operations without asking whether it should continue.
.P
The \*L\-verbose\*O option directs the Salvager to produce detailed information
about the aggregate as it executes.  The information is useful primarily for
debugging purposes.  Use this option alone or with any other combination of
options.
.LE
.iX "-]" "Salvager" "using"
.H 3 "Interpreting Salvager Output"
.iX "-[" "Salvager" "interpreting output"
.P
The Salvager displays output on standard output and standard error.  When
the \*Lsalvage\*O command is first executed, the Salvager displays the device
name of the aggregate on which it is to run and the operation it is to perform.
For example, the Salvager displays the following message if it is instructed to
recover an aggregate:
.oS
\*CWill run recovery on \*Vdevice\*O
.oE
.nL
.ne 20
.P
If you use the Salvager to recover an aggregate and the log on the aggregate
does not need to be replayed, the Salvager displays only the brief introductory
information.  If the log does need to be replayed and the Salvager can
successfully recover the aggregate, the Salvager displays the following
messages:
.oS
\*CRecovery statistics\*O
\*C \ \ \*Vstatistics\*O
\*CRan recovery on \*Vdevice\*O
.oE
.P
In the output, \*Vstatistics\*O consists of a few lines of information about
the log and its replaying, and \*Vdevice\*O is again the device name of the
recovered aggregate.  If recovery fails for any reason, the Salvager returns
an appropriate exit code. (All Salvager exit codes are described at the end of
this section.)
.P
The Salvager can display much more output if it is used to verify or salvage
an aggregate on which it finds metadata errors.  As it verifies or salvages a
damaged aggregate, it displays a message similar to the following for each
fileset in which it encounters metadata problems:
.oS
\*CIn volume \*Vfileset\*C (avl #\*Vinteger\*C)\*O
\*C \ \ in anode (#\*Vinteger\*C)\*O
\*C \ \ \ \ \ \*Vdescription\*O
.oE
.P
It displays the first line once for each fileset, repeating the second and
third lines once for each problem anode in the fileset.  An anode is an area on
disk that provides information used to locate data such as files, directories,
ACLs, and other types of file system objects.  Each fileset contains an
arbitrary number of anodes, all of which must reside on the same aggregate.
.P
In the output, \*Vfileset\*O is the name and ID number of each affected
fileset; \*Lavl #\*Vinteger\*O indicates the anode for the fileset; \*Lin anode
(#\*Vinteger\*L)\*O indicates the anode for a file or other object in the
fileset; and \*Vdescription\*O provides a brief description of the problem the
Salvager found with the anode (and any actions it took as a result, if it is
salvaging the aggregate).
.nL
.ne 20
.P
When it has finished executing, the Salvager lists files whose metadata it
found to be damaged, many of which it likely repaired if it salvaged the
aggregate.  For each file, it displays a line of the form
.oS
\*Vcondition\*O \ \ \*Vfileset\*C:\*Vpathname\*C volume index: \*Vinteger\*C anode index: \*Vinteger\*O
.oE
.P
In the output, \*Vcondition\*O is a string that describes the state of the
file or its metadata; \*Vfileset\*O is the name of the fileset in which the
affected file resides; and \*Vpathname\*O is the pathname of the file,
relative to the root directory of the fileset.  Note that the Salvager may not
be able to determine the fileset name or reconstruct the pathname for every
file.
.P
The \*Lvolume index: \*Vinteger\*O and \*Lanode index: \*Vinteger\*O provide
pointers to the anodes that are associated with filesets and files whose
metadata was damaged (and possibly repaired).  The \*Lvolume index\*O indicates
the anode for the fileset; the \*Lanode index\*O indicates the anode for the
file.  Anode-related information is not useful for verifying or restoring data
on an aggregate, but it does serve to identify earlier messages displayed by
the Salvager that are related to this file.
.P
The following conditions accompany the files most in need of attention:
.VL 15
.LI "\*LoughtRestore\*O"
Files in which one or more block references in the associated anode were
removed or changed.  Because it is unlikely that such files contain all of their
original data, these files should be restored from existing backups.  This
condition applies only to files on salvaged aggregates.
.LI "\*LmayRestore\*O"
Files to which modifications were made (for example, files whose ACLs or
property lists were changed).  The owners of these files should verify their
contents, or a system administrator should simply restore them from backups if
a directory listing indicates that they have not been modified since the last
backup was made.  This condition also applies only to files on salvaged
aggregates.
.LI "\*LzeroLinkCnt\*O"
Files whose link counts should be 0 (zero).  These files were deleted but not
closed when the system crashed or were orphaned by the Salvager as it made
repairs to the file system.  The system will delete them when the aggregate is
exported.
.nL
.ne 20
.LI "\*LbadLinkCnts\*O"
Files whose link counts were inconsistent with the number of references found
to them.  These files should be examined, if possible, or simply restored.
.LE
.P
The Salvager can list a file more than once if it finds that multiple
conditions apply to the file.  It can also display one or more additional
conditions, but files with which the additional conditions are associated are
usually already covered by one or more of the conditions just described.
.P
The Salvager also returns one of various exit codes summarizing its actions
and findings.  It returns the exit codes in the form of bits, which it uses to
indicate the state of the aggregate.  It can set multiple bits but, in general,
the higher the bit, the greater the severity of the aggregate's problems; the
higher bit always takes precedence when interpreting the output.  The Salvager
can return the following exit codes:
.VL 19
.LI "All\ bits\ off"
The Salvager found no problems.  It displays a message that includes \*CDone\*O
and \*CChecks out\*O.  The command need not be run again.
.LI "First\ bit\ (\*L0x1\*O)\ set"
The Salvager found one or more problems.  It displays a message that includes
\*LDone\*O and \*LSome inconsistencies found\*O.  Run the command on the
aggregate without the \*L\-verifyonly\*O option to attempt to correct the
problems.
.LI "Second\ bit\ (\*L0x2\*O)\ set"
The Salvager found one or more problems and fixed them.  It displays a message
that includes \*LDone\*O and \*LSome inconsistencies repaired\*O.  The command
need not be run again. (Note that, if the second bit is set, the first bit is
typically set as well; because the higher bit takes precedence, you do not need
to run the command again.)
.LI "Third\ bit\ (\*L0x4\*O)\ set"
The Salvager found one or more problems and fixed some of them.  It displays
a message that includes \*LIncomplete\*O and \*LSome repairs made\*O.  Some of
the problems were more severe and require a subsequent salvage to be repaired;
run the command on the aggregate without the \*L\-verifyonly\*O option to
attempt to correct the problems.
.nL
.ne 20
.LI "Fourth\ bit\ (\*L0x8\*O)\ set"
The Salvager found the aggregate to be irreparably damaged.  It displays a
message that begins \*LProblem\*O.  Use the \*Lnewaggr\*O command to
reinitialize the aggregate, and reconstruct the data from existing backups if
possible.
.LI "Fifth\ bit\ (\*L0x10\*O)\ set"
The Salvager found some serious problem that prevents it from running; for
example, the attempted recovery of the aggregate failed because of damage to
the log, or the attempted salvage of the aggregate failed because the
aggregate is not a DCE LFS aggregate or it is currently exported.  The Salvager
displays a message that begins \*LProblem\*O.  Attempt to determine the cause
of the problem.
.LE
.P
Including the \*L\-verbose\*O option with the \*Lsalvage\*O command causes the
Salvager to produce more detailed information about the aggregate.  Much of the
additional information is useful primarily for debugging purposes.
.iX "-]" "Salvager" "interpreting output"
.iX "-]" "Distributed File Service (DFS)" "structural integrity"
.iX "-]" "filesets" "managing"
