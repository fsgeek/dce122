CR Number                     : 13004
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsalias create vs uppercase chars
Reported Date                 : 8/2/95
Found in Baseline             : 1.1, 1.2
Found Date                    : 8/2/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/2/95 public]

dcecp -c cdsalias create /.:/aaBB results in the creation of
Alias /.../cellname /aaBB, which can be viewed with dcecp -c cdsalias catalog. 
dcecp -c cdsalias create /.../aaCC results in the creation of
Alias /.../cellname/aacc, which can be viewed with dcecp -c cdsalias catalog.
Summary: Uppercase characters are converted to lowercase characters if /... is
used when creating the alias.  This can create a problem if the user's program
expects to see the uppercase characters using catalog or if it tries to delete
/.../aaCC.  It can only be deleted using /.:/aaCC. /.../cellname/aaBB, which can be viewed with dcecp -c cdsalias catalog.  `

[8/2/95 public]
My suspicion is that dcecp is not really doing this.  It is calling
rpc_ns_expand_name()  (or whatever the real name of that routine is)
which expands the DCE name into it's canonical form.  That is, /.: is
expanded to the cell name, etc.  One of those rules is to look at the
name, if it begins with /... it is a full DCE name, what follows is a
slash and then the name of a cell.  If the next portion of the name
(RDN in X.500 parlance) contains an = then it's an X.500 cellname,
otherwise it's a DNS cellname.  Why is this important?  DNS names are
case INsensitive.  So /.../aaCC is a name of a DCE cell registered in
DNS and is equivalent to /.../aacc.

I recommend cancelling this defect and renaming the cell with a valid
DNS name (that is, one that could actually be registered).

[8/2/95 public]
Here is some more information from AES/DS Rev B Page A-10, table A-4:

Characteristics          CDS               GDS                DNS
------------------------------------------------------------------------------
Char set           a-z, A-Z, 0-9...       a-z, A-Z, 0-9...    a-z, A-Z, 0-9,...
------------------------------------------------------------------------------
.....
------------------------------------------------------------------------------
Case-matching       Case exact            Attr name case      Case insensitive
rule                                      insensitive, value
                                          either...
------------------------------------------------------------------------------
Internal            Case exact            Depends on case     Alphabets conv
Representation                            matching rule at    to all lower case
                                          DSA..
------------------------------------------------------------------------------
......

This does not however imply that rpc_ns_expand_name should convert cell name
(which could very well be CDS only), to all lower case. This defect probably
stay open. Comments?

[2/26/96 public]

As Howard stated (months ago), dcecp uses rpc_ns_expand_name() when
playing with cell names and aliases.  It is a *feature*, correct or
otherwise, that rpc_ns_expand_name() will force the 'global name' part
of the DCE pathname to lowercase, something to do with DNS-style names
being case-insensitive.

Currently, dcecp operates on a consistent basis...  If you create
/.../newNAME, you get /.../newname.  If you delete /.../newNAME,
you delete /.../newname.  Changing dcecp's behavior (to ignore,
or somehow force changes to the output of rpc_ns_expand_name())
is incorrect, as it could break existing sites which utilize the
uppercase-to-lowercase functionality as it exists.

I'm going to forward this OT to CDS for a discussion on whether
rpc_ns_expand_name() works correctly.  The CDS people can then
make a decision on closing this bug.

[08/20/96 public]

I'm cancelling this OT; Howard is correct.  A cell name cannot be
CDS-only.  In the chart that Parul mentions, "CDS" refers to the
local or cell-relative part of a global compound name.  In fact,
the Directory Services AES (section 1.3.3 Global Namespace Name
Syntax) states that:

"Names that are not indentified as being either X.500 or DNS are
not specified (BNF element <GlobalCompositeName>).  Implementations
may reject these as unsupported."

So a compliant DCE implementation could reject a cell name of
/.../foo_cell since "foo_cell" is neither an X.500 nor a DNS name.
Isn't it nice that we don't? ;^)



CR Number                     : 12783
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : doc
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : command_ref
Short Description             : The ARGUMENTS section is missing an argument name ("attribute-value")
Reported Date                 : 1/27/95
Found in Baseline             : 1.1
Found Date                    : 1/27/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : src/dce_books/command_ref/man8cds/set_link.8cds
Sensitivity                   : public

[1/27/95 public]

                          DCE Problem Report
                  =================================


Submitter Information 
----------------------

Submitter Name:           lconrad
Organization:             Hitachi Computer Products (America), Inc. 
Email Address:            osd.dce@hi.com lconrad@hi.com 
Phone:                    617-890-0444 
DCE License Number:       1616-MDCE-92
Licensee's Defect Number: OSDqa10198


Hardware/Software Configuration
--------------------------------

Offering and Version:   DCER1.0 
Component (Module):      
Client Hardware:        see below 
Client Software:        see below 
Server Hardware:        see below 
Server Software:        see below 
Compiler:               n/a

Problem Description
--------------------

Severity Level: Severe

Date of First Occurrence: 12/19/94

One Line Description:
   OSDqa10198 The ARGUMENTS section is missing an argument name ("attribute-value")

Full Description:

Related-file:::: Problem
 DESCRIPTION:
 The cdscp set link(8cds) man page is missing the "attribute-value" argument
 from the ARGUMENTS section. Its synopsis is listed, however.
 
 REPRODUCIBLE: yes
 
 TEST SOFTWARE DESCRIPTION:
 % man cdscp_set_link.8
 
 cdscp set link(8cds)   Hitachi DCE/Base-M    cdscp set link(8cds)
 
 NAME
      cdscp set link - Changes the value of a modifiable, single-
      valued attribute of a soft link
 
 SYNOPSIS
      cdscp set link link-name attribute-name = attribute-value
 
 ARGUMENTS
      link-name The full name of the soft link.
 
      attribute-name
                The name of the attribute to be modified.  Specify
                only one attribute at a time.
 ---->
 |              The value of a particular attribute.
 |
 - The "attribute-value" string is not there, but should be.
 
 DESCRIPTION OF HARDWARE WHERE BUG OCCURRED: Hitachi Mainframe VM - sybil
 
 DESCRIPTION OF WHERE TEST SUCCESSFULLY RAN: n/a
Related-file::Added 950118 by lconrad:: /build/hiosfm/RCS/dce/doc/admin.rf/man8cds/./cdscp_set_link.8cds,v 7.4
 /build/hiosfm/RCS/dce/doc/admin.rf/man8cds/./cdscp_set_link.8cds,v 7.4
 lconrad 1995/01/18 15:58:11 +3 -3
 Reason:  OSDqa10198 The ARGUMENTS section is missing an argument name ("attribute-value")
 Corrected TROFF coding error
 
     *** /tmp/ci.2884..cdscp_set_link.8cds.2915.1	Wed Jan 18 10:58:14 1995
     --- /tmp/cdscp_set_link.8cds.2915.2	Wed Jan 18 10:58:14 1995
     ***************
     *** 57,67 ****
       .LI "\fIlink-name\fR"
       The full name of the soft link.
       .LI "\fIattribute-name\fR"
       The name of the attribute to be modified.  Specify only one attribute at a 
       time.  
     ! .LI \"fIattribute-value\fR"
       The value of a particular attribute.  
       .wH "<endargdeflist>"
       .LE
       .SH "DESCRIPTION"
       .PP
     --- 57,67 ----
       .LI "\fIlink-name\fR"
       The full name of the soft link.
       .LI "\fIattribute-name\fR"
       The name of the attribute to be modified.  Specify only one attribute at a 
       time.  
     ! .LI "\fIattribute-value\fR"
       The value of a particular attribute.  
       .wH "<endargdeflist>"
       .LE
       .SH "DESCRIPTION"
       .PP
 
Related-file::Added 950118 by lconrad:: doc workaround
 Corrected TROFF coding error.

[11/2/95 public]
Assigned to Bob Binstock, who is doing editorial work
on this book.

[11/03/95 public]

This error had already been corrected.



CR Number                     : 12687
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd core dumps while
configuring additionial cdsd server
Reported Date                 : 10/20/94
Found in Baseline             : 1.1b23
Found Date                    : 10/20/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/20/94 public]

I am using BL-23. I configured a cell of 5 machines.
While on 4 machines system tests were running, I tried to 
configure a CDS replica on the 5th machine. I got the following
errors and the cdsd master did a coredump.

ERRORS where the CDS master was running are: 

root@dce3> 1994-10-20-12:48:53.510-04:00I0.706 cdsd(1047) FATAL cds adver
dceassert.c 63 0x006547c0
Assertion "((rd_p->rec_offset+rd_p->rec_length) <=
(newbkt_p->node_blocks*BLOCK_SIZE))" failed in "/project
/dce/build/dce1.1-snap/src/directory/cds/server/db_btree.c"file> line <637
1994-10-20-12:50:48.470-04:00I0.821 dtsd WARNING dts events
logevent_v_ultrix.c 373 0xa44de9fc
Time provider timeout detected
1994-10-20-12:53:17.960-04:00I0.970 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0xa44de9fc
Failed to retrieve server binding from the namespace: Requested operation
would result in lost connectivity
 to root directory (dce / cds)
1994-10-20-12:56:09.220-04:00I1.142 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0xa44de9fc
Failed to retrieve server binding from the namespace: Requested operation
would result in lost connectivity
 to root directory (dce / cds)
1994-10-20-12:58:57.015-04:00I0.732 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0xa44de9fc
Failed to retrieve server binding from the namespace: Requested operation
would result in lost connectivity
 to root directory (dce / cds)

ERRORS during the additions CDS master config:

        selection:  1
S:****** Configuring additional CDS Server...
S:****** Checking for active sec_client service...
        A CDS server must have already been configured.
        What is the name of a CDS server in this cell
        (if there is more than one, enter the name of
        the server to be cached if necessary)? dce3

        Create LAN profile so clients and servers can be divided
        into profile groups for higher performance in a multi-lan cell ?
(n) 
S:****** Starting cdsd...
S:****** Waiting for registry propogation...
S:****** Initializing the name space for additional CDS server...
        Modifying acls on /.:/hosts/needle/cds-server
        Modifying acls on /.:/hosts/needle/cds-gda
        What is the name for this clearinghouse?  needle
1994-10-20-12:51:57.236-04:00I1.674 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0x7aff92e8
Failed to retrieve server binding from the namespace: Connection request
rejected (dce / rpc)
        Modifying acls on /.:/needle
ERROR: Requested operation would result in lost connectivity to root
directory (dce / cds)
Unable to bind to object /.:/needle
ERROR: Requested operation would result in lost connectivity to root
directory (dce / cds)
Unable to bind to object /.:/needle
        Should more directories be replicated? (n)

CORE INFO:


Core info:

root@dce3> ls -l ./var/directory/cds/adm/cdsd/core
-rw-r--r--   1 root     bin             45840844 Oct 20 12:50
./var/directory/cds/adm/cdsd/core
root@dce3> gdb /opt/dcelocal/bin/cdsd ./var/directory/cds/adm/cdsd/core
GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.5, Copyright 1992 Free Software Foundation, Inc.

OSF version 1.0 created Mon Dec  7 14:40:14 1992

..(no debugging symbols found)...
Core was generated by `cdsd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0xa403fea4 in bkgdskulkhalf ()
(gdb) where
#0  0xa403fea4 in bkgdskulkhalf ()
Cannot access memory at address 0xc6037d40.
(gdb)

[10/20/94 public]
I configured two machines 
486 initial cds server
hp secondary cds server
and ran killer on the secondary.  No problem.

I then reversed them
hp initial cds server
486 secondary cds server
and ran killer on the secondary again. No problem.

I had dts local servers on both machines fo reach configuration.

I'll talk to Martha in the morning to find out what she had running.

[10/21/94 public]
It would help if you have servicability events (level 5) on 
for the cds subcomponent "database" while trying to reproduce 
this problem.  Since the core isn't telling use much, we may 
need the trace.

[10/21/94 public]
Yep. The problem is making it happen. It may not be very reproducable but I
haven't talked to Martha yet. I'll assign this to me until we can get more
data.

[10/24/94 public]
This isn't reproducable under *normal* circumstances. Martha will try
again under the same conditions but can;t do it now. I'm dropping this
to a 1.

[07/25/96 public]
I'm cancelling this OT since we don't know how to reproduce this and
a large database fix (OT 12879) is now in R1.1-maint and R1.2.2, which
hanges the above server database condition.



CR Number                     : 12576
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv core dump
Reported Date                 : 10/11/94
Found in Baseline             : 1.1b21
Found Date                    : 10/11/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/11/94 public]

In a 5 machine, split sec and cds server idle DFS cell, at about
the 35 hour mark:

m1 (sec server):
1994-10-09-04:00:17.853-04:00I0.450 secd ERROR rpc auth cnsassm.c 4028 0x401fe39
8 RPC_CN_AUTH_VFY_CLIENT_REQ on server failed: Ticket expired (dce / krb)

m2 (cds server):
1994-10-09-04:00:18.173-04:00I0.560 cdsclerk(2598) ERROR cds general clerk_bind.c 627 0x40188128 Rou
tine sec_rgy_pgo_is_member(3sec) failed : status = 382312679.
then many:
1994-10-09-04:07:36.657-04:00I0.973 cdsclerk(2598) ERROR cds general clerk_bind.c 627 0x40188128 Routine sec_rgy_pgo_is_member(3sec) failed : status = 382312543.

where:

root@dce8> stcode_hp 382312679
382312679 (decimal), 16c9a0e7 (hex): Authentication ticket expired (dce / rpc)
root@dce8> stcode_hp 382312543
382312543 (decimal), 16c9a05f (hex): Who are you failed (dce / rpc)

The Assertion failure was:
Assertion failed: (scte)->refcnt < 255, file
/project/dce/build/dce1.1-snap/src/rpc/runtime/dgscall.c, line 1144

The trace was:
 0 _kill@libc + 0x00000008 (hp-ux export stub)
 1 _raise@libc + 0x00000024 (0x7aff7504, 0x405e4090, 0x400e5a0c, 0)
 2 _abort@libc + 0x00000078 (0x405e3fb0, 0x3, 0, 0)
 3 _assert@libc + 0x00000128 (0x400a496c, 0x400a3750, 0x405e2ca0, 0)
 4 rpc__dg_scall_alloc@libdce + 0x0000012c (0x400a4968, 0x400a3750,
0x405e2ca0, 0x1dc)
 5 rpc__dg_sct_new_call@libdce + 0x0000032c (0x400a4968, 0x400a3750,
0x405e2ca0, 0x400e582c)
 6 rpc__dg_do_request@libdce + 0x000002c4 (0x400a3750, 0x405e2ca0, 0x2, 0x400e5788)
 7 recv_dispatch@libdce + 0x00000f78 (0x400a3750, 0x405e2ca0, 0x400e5680, 0)
 8 rpc__dg_network_select_dispatc + 0x00000648 (0x6, 0x400a3750, 0x1, 0x400e5680)

The self credentials on all machines are still good and the cell appears
healthy* other than the cdsadv coredump and it's effects on all processes
on m2 (ie. Name service unavailable). Note that this was probably prompted
by the DFS bosserver that tries to restart itself and a number of DFS user
space daemons at 4am on Sunday mornings ... these processes all reported
"Who are you failed" on m2 before reporting Name service unavailable.

NOTE: one machine, m3, that was to be a security replica and cds replica,
hung during configuration on the command:

rpccp export -i 4ea31de8-9a94-11c9-bb60-08002b0f79aa,0003.0000                  -b ncadg_ip_udp: -o faf2e540-58b8-11ca-a04a-08002b12a70d -s dce                  /.:/hosts/rum/cds-server > /dev/null

I believe this is a separate unrelated problem and have just added
it here for completeness.

[07/25/96 public]
I'm cancelling this OT for the following reasons:

1) None of the above helps debug a cdsadv core dump.

2) I don't see any evidence that the above notes indicate why CDS owns
   this OT (more like RPC with the assertion failure).  A cdsadv core
   dump does not mean that node cannot access the namespace.  Existing
   processes with their corresponding cdsclerk process will still be
   able access the namespace.  If the cdsadv process goes away,
   losing accessibility to the namespace occurs if you get back a Socket
   Error.  "name service unavailable" implies either a connectivity
   problem to the CDS server (RPC), or the remote cdsd may be down.

3) We don't have the system resources to begin to try and reproduce
   whatever happened above (and that's a lot).



CR Number                     : 12483
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd fatal error - cdsclerk(752) ERROR cds general clerk_bind.c
Reported Date                 : 10/4/94
Found in Baseline             : 1.1
Found Date                    : 10/4/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/4/94 public]

Core smoketest failed on AT486; passed on HPUX and RIOS

Platform - AT486
Machine name - sif

Extract from /u1/RAT_tools/do_automatic_test.log


S:****** Configuring CDS Server...
S:****** Checking for active sec_client service...
S:****** Starting cdsadv...
S:****** Starting cdsd...
1994-10-04-08:36:20.813+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e6768
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:22.713+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e6768
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:23.693+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e5078
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:24.593+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x0078d5a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:25.273+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e5078
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:24.593+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x0078d5a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:25.273+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e5078
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:37:03.770+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x0078d5a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:37:04.810+00:00I----- cdsd(756) ERROR cds general unix_cds_net.c 8
04 0xa449e9fc
Routine rpc_ns_binding_export(3rpc) failed: status = 382312662.
1994-10-04-08:37:04.910+00:00I----- cdsd(756) ERROR cds general unix_cds_net.c 8
14 0xa449e9fc
Routine rpc_ns_binding_export(3rpc) failed: status = 382312662.
1994-10-04-08:37:04.910+00:00I----- cdsd(756) FATAL cds server dns_service_ncl.c
 325 0xa449e9fc
Cannot export bindings to clearinghouse.
ERROR:   cdsd failed to start

[10/4/94 public]
We believe this is likely a different problem that the one in 11566. Reopening
it. Also making it a P1 because its not readily reproducable. I'll leave
this one with cds because if we see it again I'm going to spend more time 
fishing around the cell and the net its attached to.

[10/5/94 public]
The same problem was observed today on sif (AT486).  The config failed
last night during the scheduled core smoketest.  When I reconfigured in
the morning, the cell configured OK.

[10/5/94 public]
I talked to Avi this morning asking him to come and get me if this happens
again tomorrow. Don't reconfigure it. Got to admit its beginning to look 
more like some sort of configuration problem. I'll recheck the uptime on 
the smoke test machines again. If it happens tomorrow maybe we can get a
handle on it. I'm going to leave this at a P1 untill we acertain wether its
a configuration problem or not. Still assigned to me.

[10/5/94 public]
We just rebooted all three smoke test machines and configured the machine that 
hits the problem. It worked fine. Sooooo.....

Mike and Rob were appear to be right. It certainly does appear to be a 
configuration problem of some sort. One of the other two machines is getting
itself into a state that is causing a problem for the 486. One possibility
is one of them kicking off the multi machine test pre-maturely. Don't know,
but assuming we hit the problem tomorrow I'll see if I can get a handle on
it.

[10/6/94 public]
The smoke test did not hit the failure this morning but the multi machine
test did not run for reasons unrelated to this problem. If the failure
is due to some kind of problem in the timeing of the multi machine test
kick off we would not have seen the failure this morning. We'll continue 
monitoring the tests.

[10/12/94 public]
The smoke test hit this problem on 'sif' today morning and failed.

[07/09/96 public]
Since:

1. It hasn't been determined where the problem lies, let alone assigning
   this to CDS.
2. It is unlikely to get attention unless it happens on the latest
   reference platform.

I am canceling this OT.  Fee free to re-open it if further evidence
is found.

--Roger

[8/15/96 public]
The fix for this requires a change in two files, adver_main.c and
adver_cds_event.c.

The advertiser is only supposed to cache server/clearinghouse information
from servers within the local cell (by default).

In the cases when the clerk is reporting rpc_set_auth_info failures, we
noticed that non-local clearinghouses were cached.  It also turns out that
these clearinghouses were from machines which had a "dying" clearinghouse.

Because these bogus clearinghouses were cached, rpc would return the wrong
information on a rpc_mgmt_inq_server_princ_name call.  This caused the
clerk to attempt to bind to the wrong server.

The fix we made is to correct the way the cell matching works to not
look at the UUID, but rather just to look at the cell name.

Changes to the files are as follows:

adver_main.c:

define a variable of type character, all_cells, and set it to FALSE:
char all_cells = FALSE;

adver_cds_event.c:

in routine cds_advertisement_cellmatch()

static int
cds_advertisement_cellmatch (
    cds_FullName_t *cellname_p,
    uuid_t      *cell_diruid_p)
{
    DEB_ASCII_BUF_cds_FullName(cellnameBuf)
    DEB_ASCII_BUF_ObjUID(diruidBuf)

    register int cell_name_match = FALSE; /* Cell matching flags */
    register int cell_uuid_match = FALSE;
    register int cell_match = FALSE;

    DCE_SVC_DEBUG((cds__svc_handle, cds_svc_adver,  svc_c_debug7,
                   " >cds_Advertise_cellmatch(%s,%s)",
                   deb_ascii_cds_FullName(cellnameBuf,cellname_p),
                   deb_ascii_ObjUID(diruidBuf,cell_diruid_p)));



    /*
     *  Rules for accepting an advertisement:
     *
     *    If the cell name matches, accept.  (On the side, grab it's uuid).
     *    Else see if the uuid advertised matches the configured cell's
     *        uuid.  If it does, accept (this is a cell alias).
     */

    cell_name_match =
     (adv_cache_cellname_p
      && (cellname_p->fn_length == adv_cache_cellname_len)
      && EQ_bytes(cellname_p->fn_name, adv_cache_cellname_p,
                                         adv_cache_cellname_len));

    if (!cell_name_match) {
     cell_uuid_match = EQ_ObjUID(cell_diruid_p, &adv_cache_cell_diruid);
    } else if (ObjUID_is_nil(&adv_cache_cell_diruid)) {
     cell_uuid_match = FALSE;
     COPY_ObjUID(cell_diruid_p, &adv_cache_cell_diruid);
    }

   extern char all_cells;
   cell_match = (cell_name_match || cell_uuid_match || all_cells);
    if (!stand_alone && cell_match) {
   DCE_SVC_DEBUG((cds__svc_handle, cds_svc_adver, svc_c_debug7,
                     " >cds_Advertise_cellmatch(%s,%s) return(TRUE)",
                     deb_ascii_cds_FullName(cellnameBuf,cellname_p),
                     deb_ascii_ObjUID(diruidBuf,cell_diruid_p)));
   return (TRUE);
    } else {
   DCE_SVC_DEBUG((cds__svc_handle, cds_svc_adver, svc_c_debug7,
                     " >cds_Advertise_cellmatch(%s,%s) return(FALSE)",
                     deb_ascii_cds_FullName(cellnameBuf,cellname_p),
                     deb_ascii_ObjUID(diruidBuf,cell_diruid_p)));
   return (FALSE);
    }
}



CR Number                     : 12382
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdsalias
Short Description             : cdsalias create always forces name to lowercase.
Reported Date                 : 9/28/94
Found in Baseline             : 1.1
Found Date                    : 9/28/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/28/94 public]

The 'cdsalias' commands force the alias name supplied to lower case 
before performing operation. 

   dcecp> cdsalias create /.../FOO
   dcecp> cdsalias cat
   {CDS_CellAliases 
    {Primary /.../drkstr}
    {Alias /.../foo}}
   dcecp> cdsalias create /.../SHIRT
   dcecp> cdsalias cat              
   {CDS_CellAliases 
    {Primary /.../drkstr}
    {Alias /.../foo}
    {Alias /.../shirt}}
   dcecp> cdsalias delete /.../SHIRT
   dcecp> cdsalias cat              
   {CDS_CellAliases 
    {Primary /.../drkstr}
    {Alias /.../foo}}

[9/28/94 public]
According to the AES object names and directory names in CDS are case 
exact. I can create objects /.:/Foo and /.:/foO as well as directories 
/.:/Users and /.:/userS and show them all. I verified that this works.

Also according to the AES names in the global namespaces gds and dns are
case insensitive. This means that cell names themselves in either of these
spaces must be case insensitive. What the AES doesn't say but seems to be
true is that cell names that are niether gds not dns are also case 
insensitive. At least I verified this in a single machine cell. I created
a cell as  /.../JOHN and can show it as either /.../JOHN or /.../john.
This all seems ok to me. It also makes sense, at least to me,  given the case 
insensitivity of cell names that aliases be cas insenitive. Other may disagree
with the later.

What I'm puzzled by and I want to know the answer to before I cancel this
is that when I do a show dir /.: on on the cell /.../JOHN it emits the cellname
in lower case /.../john. From the above the alias are also mapped to lower
case on output as well even though either case is taken as input. This
does have the potential of breaking shell scripts that create things
and then look for them. 

Another data point. /opt/dcelocal/dce_cf.db contains the cellname /.../JOHN
but getcellname emits /.../john.

[9/28/94 public]
Executive summary: This should be cancelled.

There are only three types of cellnames: GDS, DNS, CDS.  To be CDS it must
have more than one RDN.  So the examples above are either GDS or DNS.
Since there is no = in the first RDN it's a DNS name.  It might not be a
good name to put in a DNS service but it's a DNS name.

DNS names are case insensitive.  DCE outputs names in a canonicalized form.
For case insensitive names that form is in lowercase.  All of this should
be happening in rpc_ns_expand_name().

FYI: GDS names can be case exact or case inexact based on the syntax of the
particular attribute.  There are no attribute types defined by the standard
that are caseExact but that doesn't prevent someone from defining their
own.  There are additional rules in GDS strings though involving spaces.
leading and trailing spaces are not significant AND multiple consecutive
spaces are compressed to one space (believe it or not).  Fortunately this
stuff isn't used much :-)

[07/09/96 public]
Gee, it takes 22 months to clean this one up 8^(  As per Howard's research
and executive order, I'm canceling this OT.



CR Number                     : 12180
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : client
Short Description             : cdsadv and cdsclerk coredumps
Reported Date                 : 9/14/94
Found in Baseline             : 1.1b17
Found Date                    : 9/14/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/14/94 public]

hp800 config'd as a dts local server in a dfs cell (1 day later
than rest of nodes in cell)

cdsadv and cdsclerk core dumps 1 minute apart:

-rw-rw-rw-   1 root     sys      5260156 Sep 13 18:23 cdsadv/core
-rw-rw-rw-   1 root     sys      5886844 Sep 13 18:24 cdsclerk/core

which was 2-3 hours after config of this machine

no tests were running on or to this machine (tests were running on
2 of the other machines in the cell, cell contains 3 cds servers,
2 on RIOS, 1 on another HP)

cdsadv:
Core file from:  cdsadv
Child died due to: segmentation violation
Procedures:      0
Files: 0
 0 CA_FreeListRemove + 0x00000078 (0x807a33bc, 0x4, 0x8, 0x4001211c)
 1 CA_FreeListFree + 0x00000378 (0x807a31a8, 0x80799b28, 0x6, 0x400106d0)
 2 CA_InsertCle + 0x00000aac (0x40365740, 0x40153434, 0x40364bc0, 0)
 3 CAInsertClearinghouse + 0x000001cc (0x40363a79, 0x40153434, 0x40364bc0, 0)
 4 adver_cache_add_cle + 0x000000fc (0x400a32c0, 0x40363a79, 0x40153434, 0x403639b5)
 5 cds_advertisement + 0x00000350 (0x4036290c, 0x40362f28, 0x400deea8, 0)
 6 cds_Advertise_s + 0x00000124 (0x400e38e8, 0x4036290c, 0x40362f28, 0x400deea8)
 7 op1_ssr + 0x00000180 (0x400e38e8, 0x4014d850, 0x4036253c, 0x40362520)
 8 rpc__dg_execute_call@libdce + 0x00001dd8 (0x4014d850, 0, 0, 0)
 9 cthread_call_executor@libdce + 0x000002d4 (0x4014d3a0, 0x7af4e478,
  0x401668f8, 0x16)
10 cma__thread_base@libdce + 0x0000021c (0x401668f8, 0, 0, 0)
11 cma__thread_start1@libdce + 0x0000004c (0x401668f8, 0, 0, 0)
12 cma__thread_start0@libdce + 0x00000008 (0x401668f8, 0, 0, 0)
13 CA_FreeListRemove + 0x00000078 (0, 0, 0, 0)
14 rpc_x_call_id_not_found@libdce + 0xc51629f8 (Address not found (UE302)

cdsclerk:
Core file from:  cdsclerk
Child died due to: segmentation violation
Procedures:      0
Files: 0
 0 CA_FreeListRemove + 0x00000078 (0x807a33bc, 0x4, 0x8, 0x40017024)
 1 CA_FreeListAlloc + 0x000000e4 (0x210, 0x2, 0x8, 0x40016e6c)
 2 CA_GlobalAlloc + 0x0000008c (0x210, 0x2, 0x6, 0x400154b8)
 3 CA_InsertCle + 0x0000046c (0x402b298c, 0x40484e50, 0x402b2584, 0x1)
 4 CAClearinghousesUsed + 0x000001a4 (0x40484e48, 0x1, 0x3, 0x40003c88)
 5 clerk_request + 0x00000940 (0x4023c4d8, 0x4023c6d0, 0x9, 0x40018d88)
 6 th_start + 0x000000cc (0x4023c6d0, 0x7af4e478, 0x4017b978, 0x3c)
 7 cma__thread_base@libdce + 0x0000021c (0x4017b978, 0, 0, 0)
 8 cma__thread_start1@libdce + 0x0000004c (0x4017b978, 0, 0, 0)
 9 cma__thread_start0@libdce + 0x00000008 (0x4017b978, 0, 0, 0)
10 CA_FreeListRemove + 0x00000078 (0, 0, 0, 0)
11 _end + 0x0015b248 (Address not found (UE302)

[9/21/94 public]
Dropping to a 1 as this is NOT blocking system test ... cache corruption
seems like a REALLY bad thing however, especially since there was
no activity on the machine and the only unique thing was that it was
added into the cell late ... I'm doing this "late addition" again today -
with bl-18 - will update if seen again.

[9/26/94 public]
Really dropped ot to a 1.

[10/12/94 public]
We have some code for that fixes a window of vulnerability in th ecache code.
Its for 1.0.3 and Janet is looking at it to see if it applies to 1.1; the
code has changed somewhat between the two releases. Up'ing this to a 0
and susan will mark it as UHYPE. If it doesn't apply to 1.1 we will drop it.

[10/19/94 public]
The code from hp really does some thingsappropriate fo r1.0.3 only. Janet 
doesn;t think the window that the code addresses is an open one in the current
code. This hasn't happened since this occurrence. Droping to a 1. It may be
an open window but its a very small one. Hp is running with code much closer to
1.0.3.

[07/09/96 public]
I'm canceling this OT since the above indicates that it occurred with
1.0.3-based code.  Feel free to re-open if it occurs again against R1.1
or R1.2-based code.



CR Number                     : 12165
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : gdad
Short Description             : gdad default principal isn't correct
Reported Date                 : 9/13/94
Found in Baseline             : 1.1
Found Date                    : 9/13/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/13/94 public]

HP reports that the default principal that gdad uses when it
doesn't find anything in the cds.conf file is incorrect.

[9/13/94 public]
turns out the gda and cdsd call dce_cf_get_host_name which returns
hosts as part of the string so this works as is.
HP was looking at code, didn't actually try it.



CR Number                     : 12137
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : acl
Short Description             : unable to bind to /.:
Reported Date                 : 9/12/94
Found in Baseline             : 1.1b17
Found Date                    : 9/12/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/12/94 public]
This is from bl17...

dcecp> ca
You are 'cell_admin' logged into '/.../dcecp_cell.osf.org'.
dcecp> acl show -e /.:
Error: 

(as cell_admin)
[rescue]:/am/ninja/usr/users/rousseau> acl_edit /.: -e
ERROR:  (dce / sec)
Unable to bind to object /.:

[9/13/94 public]
You don't need the -e switch to edit a directory.  The directory is
the target object.  The -e means edit the child pointer of
the directory.  In you case, the root doesn't have a child pointer
so the error is correct.



CR Number                     : 12112
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Access to CDS directories only cause acl_modify_P FVT tests to fail.
Reported Date                 : 9/8/94
Found in Baseline             : 1.1b16
Found Date                    : 9/8/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/8/94 public]

Create a directory and then use "dcecp" or "acl_edit" to view it
unauthenticated.  dcecp returns "Error: invalid acl handle". And
"acl_edit" returns "ERROR: acl object not found".

The sec_acl_bind() API returns a good status code but a null security
handle.

Note that I have seen this same behavior authenticated also.
It happens only on the HP_UX platform using dcecp and logging in via
dcecp.  (Note that _u is the current login context.)

ON HP_UX:
dcecp> set _u
dcecp> acl sh /.:/JAS_DIR_34
Error: invalid acl handle
dcecp> login cell_admin -p dcecp
dcecp> acl sh /.:/JAS_DIR_34
Error: invalid acl handle

ON OSF/1:
dcecp> set _u
dcecp> acl sh /.:/JAS_DIR_34
Error: invalid acl handle
dcecp> login cell_admin -p dcecp
dcecp> acl sh /.:/JAS_DIR_34
{user cell_admin rwdtcia}
{user hosts/frick/cds-server rwdtcia}
{group subsys/dce/cds-admin rwdtcia}
{group subsys/dce/cds-server rwdtcia}
{any_other r--t---}


Note that I've tested this using security objects such as principals and 
other CDS objects like clearinghouses and everything works as expected.
This behavior seems to occur on CDS directories only.


In src/test/admin/dcecp/ts/acl/acl_modify_P.tcl, these are some of the
tests that are failing under HP_UX only.
acl_modify_046_P
acl_modify_048_P
acl_modify_057_P

[9/8/94 public]
I tried acl_edit and dcecp acl show on a newly created direftory and
it worked fine. I am running last nights build + the fix for the 
strdup/strcpy problem in cds_dacl.c. Its possible that fix may have 
an impact. Julie will try it again in the morning to see if its working
any better for her.

[10/3/94 public]
Seems to work now as of 1.1b20.



CR Number                     : 11821
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : SVC
Short Description             : cds should provide a new function initializing SVC
Reported Date                 : 8/23/94
Found in Baseline             : 1.1
Found Date                    : 8/23/94
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/23/94 public]

A XDS application using CDS dumps core if CDS calls the first time
a SVC function. To reproduce:
Run an arbitrary invalid gds_switch testcase.

The reason is that XDS calls cds functions (i.e.
cdsGetHandle, cdsEnumAttr, cdsFreeHandle) which do SVC calls.
But SVC isn't initialized - means dce_svc_register isn't called.
So cds__svc_handle isn't initialized.

[08/23/94 public]
I'm confused.  Since cds/library/library_svc.c uses DCE_SVC_DEFINE_HANDLE
then the handle should exist and be non-NULL.  If there is code
that explicitly calls dce_svc_register() with cds__svc_handle, then *that*
is the bug and the dce_svc_register calls should be removed.

[08/23/94 public]
OK - cds/library/library_svc.c is in libdce and sets cds__svc_handle.
You (Rich Salz?) can cancel this OT - I'll check why my
XDS application is dumping core in CDS and will open a new OT for that.



CR Number                     : 11785
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : clearinghouse verify cores cdsd
Reported Date                 : 8/19/94
Found in Baseline             : 1.1b14
Found Date                    : 8/19/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/94 public]
Running DCE Nightly Build started 8/11/94 on an HP

I was trying to test cdsalias create.  I had to upgrade the directory to
3.1.  So I:

 dcecp> cdscp set directory /.: CDS_UpgradeTo = 3.1
 dcecp> directory synch /.:
 dcecp> clearinghouse verify /.:/absolut_ch

It ran for a short while and then cdsd core dumped.
Here's the traceback:

 0 db_checkpoint + 0x000005f0 (0x4013f2a0, 0x7, 0x2, 0x40009354)
 1 db_checkpoint_memory + 0x00000068 (0x4013f2a0, 0x400d57d8, 0x9, 0x40027da8)
 2 th_start + 0x000000cc (0x400d57d8, 0x7af53108, 0x403eb708, 0xae)
 3 TMEM@libdce + 0x000d28cc (0x403eb708, 0, 0, 0)
 4 TMEM@libdce + 0x000dbc54 (0x403eb708, 0, 0, 0)
 5 TMEM@libdce + 0x000db894 (0x403eb708, 0, 0, 0)
 6 db_checkpoint + 0x000005f0 (0, 0, 0, 0)

I have the core file around if anyone wants it.

[8/19/94 public]
I restarted cdsd but it doesn't seem to be happy:

  dcecp> dir show /.:
  Error: Implementation specific error
  dcecp> dir show /.:/hosts
  Error: Implementation specific error
  dcecp> dir li /.:/hosts  
  Error: Implementation specific error
  
  root@absolut cds/server$ cdsd_diag
  CDS Server Diagnostics - Version V2.019   (Aug 18 1994)
  
  diag> ex fib
  ___ File Info Block: 0x0 __________________________________
  ** Invalid file information block referenced
  diag>  

I'll be reinstalling in a minute...

[9/1/94]
I tried to recreate the problem on the hp with 1.1bl16 to no avail.
The dcecp clearinghouse verify command just sets off the background thread
of cdsd to run.  This is unrelated to checkpointing the clearinghouse to
disk.  My hypothesis is the clearinghouse got corrupted somehow in memory
or on disk (and then read in), and the verify command happened to be
running at the same time the clearinghouse was checkpointing.  I haven't
been able to get a good dce1.1 build, so I'll refrain from marking this
"fixed" until I (or someone) can verify this with a more recent baselevel.

--Roger

[9/1/94 public]
Well I just tried it with the nightly started evening of 8/31/94.

dcecp> dir mod /.: -ch {CDS_UpgradeTo 3.1}
dcecp> dir show /.:
{RPC_ClassVersion {01 00}}
{CDS_CTS 23831-02-28-15:27:09.175-05:00I0.000/08-00-09-25-13-52}
{CDS_UTS -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_ObjectUUID 616f6834-c58f-11cd-98f3-080009251352}
{CDS_Replicas
 {{CH_UUID 60458db2-c58f-11cd-98f3-080009251352}
  {CH_Name /.../absolut_cell/absolut_ch}
  {Replica_Type Master}  
  {Tower {ncacn_ip_tcp 130.105.5.93}}
  {Tower {ncadg_ip_udp 130.105.5.93}}}}
{CDS_AllUpTo 0}
{CDS_Convergence medium}
{CDS_InCHName new_dir}
{CDS_DirectoryVersion 4.0}
{CDS_UpgradeTo 3.1}
{CDS_ReplicaState on}
{CDS_ReplicaType Master}
{CDS_LastSkulk 23831-02-28-15:27:09.175-05:00I0.000/08-00-09-25-13-52}
{CDS_LastUpdate -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_Epoch 616f5ad8-c58f-11cd-98f3-080009251352}
{CDS_ReplicaVersion 4.0}
dcecp> dir synch /.:
dcecp> clearinghouse verify /.:/absolut_ch
dcecp> dir show /.:
{RPC_ClassVersion {01 00}}
{CDS_CTS 23831-02-28-15:27:09.175-05:00I0.000/08-00-09-25-13-52}
{CDS_UTS -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_ObjectUUID 616f6834-c58f-11cd-98f3-080009251352}
{CDS_Replicas
 {{CH_UUID 60458db2-c58f-11cd-98f3-080009251352}
  {CH_Name /.../absolut_cell/absolut_ch}
  {Replica_Type Master}  
  {Tower {ncacn_ip_tcp 130.105.5.93}}
  {Tower {ncadg_ip_udp 130.105.5.93}}}}
{CDS_AllUpTo -19299-10-11-07:46:54.798-05:00I0.000/08-00-09-25-13-52}
{CDS_Convergence medium}
{CDS_InCHName new_dir}
{CDS_DirectoryVersion 4.0}
{CDS_UpgradeTo 3.1}
{CDS_ReplicaState on}
{CDS_ReplicaType Master}
{CDS_LastSkulk -19299-10-11-07:46:54.798-05:00I0.000/08-00-09-25-13-52}
{CDS_LastUpdate -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_Epoch 616f5ad8-c58f-11cd-98f3-080009251352}
{CDS_ReplicaVersion 4.0}

The clearinghouse verify command returned basically immediately.  The cdsd
is still running.  BUT I noticed that the directory level was 4.0 and I set
UpgradeTo to 3.1.  All I had done was configure this cell and stop and
restart it once.  Is the default now version 4.0 directories?  Is version
4.0 indeed the new name for version 3.1?

[9/2/94]
Yes, starting with the code I checked in on 8/26, A DirectoryVersion of
3.1 ceases to have real meaning.  The default
DirectoryVersion is 4.0.  This is also the version that is minimally
needed for Hcells and cell aliasing.  So, if you create a new cell with
V1.1, you no longer need to update the directory version.  However, if
you install a V1.1 server in a pre-V1.1 cell and replicate an old
directory (CDS_DirectoryVersion = 3.0), once you replace all of the
pre-V1.1 servers with V1.1 servers and you wish to use Hcells, then
you would want to set CDS_UpgradeTo = 4.0.

The only normal time you will use "clearinghouse verify" is for upgrading
directories.  Its other uses would be for troubleshooting and doing
certain cleanup-type operations on the clearinghouse.

The command may indeed return rather quickly for a small clearinghouse
at an unloaded server.

--Roger

[9/7/94  public]
Howard says its a cancel.



CR Number                     : 11737
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdsclerk
Short Description             : cdsclerk spins and hangs while
running the sanity tests
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b14
Found Date                    : 8/17/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/17/94 public]

A 4 machine cell, where the sanity tests were running, hung.
cdscp or rgy_edit could not get any response, on any of the
machines. The only unsual thing was that the cdsclerk process
was spinning, on 3 of the 4 machines (all OSF1).

John Dugas took a SVC log, from one of the machines, and will 
try to find more information. 

The machine, where cdsd was running, was returned to a workable
state after having killed the clerk and the advertiser and 
re-started the advertiser again. The CDS clients machines had not 
remedy.

[08/17/94 public]

Whatever happened in the cell that left the cdsclerk spinning 
and/or hung, left the cell also in a state that cannot be 
restarted. So, the only solution, at this point, is to 
re-configured or a super-duper-clever-dce-guru to unhang it.
Guess which one I did?

[08/17/94 public]

I'm running the NB from Sunday, (08/14), in a cell where there is no
current test activity, and I have a spinning cdsd on my HP server after
re-starting the cell this afternoon.  

John D. believes this is a related problem.  I'll let it go overnight and see 
what happens.

[07/09/96 public]

Since:

1. There is no update as to what occurred next.
2. We don't have that many reference platform machines to even begin
   to try and reproduce this problem (and don't know the cell
   configuration).
3. No evidence as to where the cdsclerk process may be spinning.

I am canceling this OT.  Feel free to re-open it if there is further
evidence to help debug the situation.

--Roger



CR Number                     : 11704
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdsd
Short Description             : cdsd core dumps while running
system tests
Reported Date                 : 8/15/94
Found in Baseline             : 1.1b14
Found Date                    : 8/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/15/94 public]

BUILD: NB from Friday 08/13/94

I am opening this bug because I had the exact same problem on two
different cells where I was running system tests this weekend. 
On both cells cdsd was running on an OSF1 machine; one cell was all 
1.1 server and clients. The other had 1.1 servers and 1.0.3 clients.

There were not CDS replicas configured on either cell.

On cell 1 (all 1.1. cell)
=========

1. Core size

root@dce3> ls -l ./var/directory/cds/adm/cdsd/core                     
-rw-r--r--   1 root     bin             24117184 Aug 14 05:11 ./var/directory/cds/adm/cdsd/core


2. gbd info ( I tried what Tom told me to do to get more info but did not
   anu more info) 


..(no debugging symbols found)...
Core was generated by `cdsd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0xa403fea4 in bkgdskulkhalf ()
(gdb) where


On cell 2
=========

1. Core size (1.1 servers and 1.0.3 clients)

root@raven> ls -l ./var/directory/cds/adm/cdsd/core                     
-rw-r--r--   1 root     bin             13939824 Aug 14 05:09
./var/directory/cds/adm/cdsd/core

2. gdb info ( could not get more out gbd)

..(no debugging symbols found)...
Core was generated by `cdsd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0xa403fea4 in bkgdskulkhalf ()
(gdb) break main
Breakpoint 1 at 0x447b98
(gdb) run
Starting program: /opt/dcelocal/bin/cdsd 

Breakpoint 1, 0x447b98 in main ()
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0xa403fea4 in kill ()
(gdb) bt
#0  0xa403fea4 in kill ()
Cannot access memory at address 0xc6051d44.
(gdb) quit

[8/15/94 public]
I don't know what's going on with the first one but the second one left 
a cma_dump.log in the same directory as the core file. This means it
failed a cma bugcheck. The log give as cause 

% Reason: cma__ts_open:  fd is too large

Some one isn't closing files. On the 486 the maximum number of open 
files allowed is 256.

[8/15/94 public]
I won't take more than a couple of hours for me to add some code
conditional on DEBUG that keeps the name of the file in the cma
descriptor table for all open files. The bug check code can then
dump the list of open files at the time of the hit. I'll assign
this to myself and as soon as the dust clears on the other ots
tommorrow I'll add the code to the cma library.

[8/18/94 public]
Not holding anyone up, lowered to P1.
John will add some debug code to CMA to record names of files opened to try
and help get more info if this reoccurs.

[07/09/96 public]
Since:

1. There is no way to reproduce this reliably.
2. The original problem hints at the problem possibly being in CMA, but
   we don't know its status.
3. No direct evidence indicating that the problem is in cdsd (no call context
   for that matter).

For the above reasons, I am canceling this OT.  If any of the above
changes, feel free to re-open this.

--Roger



CR Number                     : 11574
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cdsd
Short Description             : cdsd fails to configure on AIX
Reported Date                 : 8/5/94
Found in Baseline             : 1.1b14
Found Date                    : 8/5/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/5/94 public]

During the multi-machine smoketest config, the cdsd on mudslide core
dumps silently such that the first command to try to use cds:

	cdscp create clearinghouse /.:/mudslide_ch

gets:

	connection closed (dce/rpc)

Core dump is not usable at all.

This has been reproduced twice - HOWEVER, the identical configuration
of cobbler, another rios, into the multi-machine smoketest cell
succeeded WITHOUT a cdsd coredump. Unconfig'ing, turning on svc and
reconfig'ing - then this one's yours John.

[8/5/94 public]
On the 3rd attempt to reproduce, blocked by:

S:****** Starting cdsadv...
**** Assertion warning. attempt to release mutex owned by another thread
     at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
  at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
  at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
  at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
 at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
    at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
 at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706

arrggh ...

[8/5/94 public]
4th attempt - still blocked by cdsadv assertion above - assigning to you
John - you'll probably want to open a separate bug for the cdsadv assertion
that may have something to do having serviceabilty on - routing file contains:

VERBOSE:FILE:/opt/dcelocal/var/svc/verbose
NOTICE:FILE:/opt/dcelocal/var/svc/notice
WARNING:FILE:/opt/dcelocal/var/svc/warning
ERROR:FILE:/opt/dcelocal/var/svc/error
FATAL:FILE:/opt/dcelocal/var/svc/fatal
cds:*.9:FILE:/opt/dcelocal/var/svc/debug

[8/8/94 public]
The problem here is that the smoke test was inadvertantly putting the
secondary machine in a bad state and dce_config was allowing it to 
happen. The unconfig option in dce_config only unconfigures the client,
it does nothing to the secondary server. We know that during configuration
a host must be configured as a client prior to being configured as a 
server. During unconfig the server should be unconfigured prior to
unconfiging the client entries. dce_config does do a check to make sure
the that there isn't a server on the machine its running on but that's
not the correct check. It should check the host that's being unconfig'd.
If a server exists on that host it should not proceed. 

I'll leave this open until I get a chance to fix the check in dce_config
but it won't be until I finish the threads serviceability at least. I'll
down grade it to an A1.

I'll talk to Gail to see if we can make the automated smoke test work 
given the limitation of unconfig on a secondary server host.

[8/9/94 public]

OT 11566 should not have been assigned to yesterdays DFS
Smoketest, OT 11574 (this one) should have.
So I am clarifiying that this ot 11574 should have been applied to 
yesterdays 8-8-94 DFS Smoketest on mudslide not ot11566. I am lowering
ot11566 to 1 and reassigning to baum.

[8/9/94 public]

Multi-machine smoke test failed to configure on the RIOS.
The test is a three machines cell with the at386 as the server
and the RIOS and the HP800 as the client.  

Configuration and testing were o.k. on both the AT386 and HP800 
platforms. 
On the RIOS platform, we got the following ERROR during configuration:

S:****** Configuring additional CDS Server...
S:****** Starting cdsd...
ERROR:   cdscp - creating clearinghouse /.:/mudslide_CH.
  Message from cdscp:
  connection closed (dce / rpc)
	Press <RETURN> to continue, CTRL-C to exit: 	Initializing the name space for additional CDS server...

>>> binding information and objects exported


>>> binding information and objects exported

	Modifying acls on /.:/mudslide_CH
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/mudslide_CH
	Modifying acls on /.:/hosts/mudslide/cds-server
	Modifying acls on /.:/hosts/mudslide/cds-gda
...

The smoke test never got to the DFS one hour read-write 
test because it did not configure successfully.  

An additional note is that initial configuraion i.e. the 
core smoke test was successful.

[8/9/94]

Using yesterday's NB, DCE fails to configure a one machine cell because
cdsd core dumps and prints the following errors. (this is related to the
errors Annie reported in the previous entry, but those were from the
replica).  So at this point, we are unable to configure a one machine
cell on a RIOS because of this problem.


        selection:  2
S:****** Configuring initial CDS Server...
S:****** Please wait for user authentication and authorization...



        Create LAN profile so clients and servers can be divided
        into profile groups for higher performance in a multi-lan cell ? (n) 
S:****** Starting cdsadv...
S:****** Starting cdsd...
1994-08-09-15:32:04.932-04:00I----- cdsd(9005) ERROR rpc recv cnrcvr.c 895 0x20129120
RPC_CN_AUTH_RECV_CHECK on server failed: received packet has an invalid checksum (dce / rpc)
1994-08-09-15:32:04.958-04:00I----- cdsd(9005) ERROR rpc auth cnassoc.c 2079 0x20129120
RPC_CN_AUTH_PRE_SEND on server failed: requested protection level is not supported (dce / rpc)
ERROR:   acl_edit - setting ACLs on /.:
  Message from acl_edit:
  ERROR: connection closed (dce / rpc)
Unable to bind to object /.:

[8/9/94 public]

To verify this problem, I started all over and re-configured. The problem 
is definitely there but the error reported had was slightly different.

        Create LAN profile so clients and servers can be divided
        into profile groups for higher performance in a multi-lan cell ? (n) 
S:****** Starting cdsadv...
S:****** Starting cdsd...
S:****** Setting ACLs for all new namespace entries...
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/sec-v1
ERROR:   acl_edit - setting ACLs on new namespace entries.
  Message from acl_edit:
  ERROR: connection closed (dce / rpc)
Unable to bind to object /.:/subsys/dce/sec
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/cell-profile

....
.....

[8/10/94 public]

PROBLEM MACHINE: Problem occured on RIOS system mudslide  rs6000/aix

CURRENT STATUS:	 This error is still blocking the multicell test

TYPE OF TEST:	 Multi cell test

CORE FILES ON: mudslide:./dcelocal/var/directory/cds/adm/cdsd/core

Configuration:	sif = sec and cds master, dts server
		budapest = sec replica, cds replica, dts server, dfs server
		mudslide = sec replica, cds replica, dfs client

Failed IN: 	dce_config

Output from log file /tmp/dce_config.log

S:****** Starting cdsd...
D:         Executing: cdsd
DEBUG:     Executing: modify_rcfile(cdsd)
V:         Successfully modified rcfile /etc/rc.dce for "cdsd"
DEBUG:     Executing: cds_replicate()
V:         Creating clearinghouse files and replica for root directory.
D:         Executing: cdscp create clearinghouse /.:/mudslide_CH
DEBUG:     Executing: chk_cdscp(cdscp - creating clearinghouse /.:/mudslide_C
H.)
DEBUG:     Executing: err_exit(cdscp - creating clearinghouse /.:/mudslide_CH
.
  Message from cdscp:
  connection closed (dce / rpc))
ERROR:   cdscp - creating clearinghouse /.:/mudslide_CH.
  Message from cdscp:
  connection closed (dce / rpc)
V:         User query: Press <RETURN> to continue, CTRL-C to exit:
V:         User entry:
DEBUG:     Executing: clean_and_remove(prompt)



Output from log file /usr/rrizzo/RAT_tools/do_test.dfs.log



S:****** Configuring additional CDS Server...
S:****** Starting cdsd...
ERROR:   cdscp - creating clearinghouse /.:/mudslide_CH.
  Message from cdscp:
  connection closed (dce / rpc)
        Press <RETURN> to continue, CTRL-C to exit:     Initializing the name space for add
itional CDS server...

>>> binding information and objects exported


>>> binding information and objects exported

        Modifying acls on /.:/mudslide_CH
ERROR: acl object not found (dce / sec)
Unable to bind to object /.:/mudslide_CH
        Modifying acls on /.:/hosts/mudslide/cds-server
        Modifying acls on /.:/hosts/mudslide/cds-gda
S:****** Configuring DTS Local Server...
S:****** Waiting for node self-identity to be established...
S:****** Starting dtsd...
S:****** This node is now a DTS local server.
S:****** Configuring DFS Client...
S:****** Loading kernel extensions...
SYS_KLOAD: A file or directory in the path name does not exist.
exec(): 0509-036 Cannot load program cfgdfs because of the following errors:
SYS_KLOAD: A file or directory in the path name does not exist.
exec(): 0509-036 Cannot load program cfgdfs because of the following errors:
S:****** Starting dfsbind...
dfsbind failed to start : There is a request to a device or address that does not exist.
S:****** Starting dfsd...
dfsd: failed to invoke the TKN server! (code 109)
S:****** Exiting from dce_config.

[8/11/94 public]
I was able to replicate this problem on three machine of the same flavors as
those used for the smoktest and without involvment of the smoketest shell 
scripts. I was however using the .cmd and .env files from the smoke test 
machines that get passed to dce_config. For those unfamiliar with these files
dce_config may be invoked as follows...

dce_config -c config.cmd -e config.env

config.cmd lists the installation and or configuration commands to be performed
while config.env sets all of the appropriate environment variables  that
may be needed by dce_config during the execution of those commands.

After reproducing the problem using the config scripts I attempted the same
configuration by hand. All three machines worked perfectly. I then brought in
a config.cmd and config.env from my own work station that I know work. I 
put them on all three of the test machines editing only the hostname and
ip address fields where appropriate. I set the .cmd files to do exactly the 
same configurations as the smoke test machine. It all worked.

At this point I think there is something in one of the smoketest config.env
files that's causing the rios not to configure properly. I'll retest in the
morning as a check to make sure it didn't 'just happen to work once'. If  
it still works  with my configuration files I'll track down what's wrong 
with the smoke test files.

[8/15/94 public]

I just finished the configuration of a two machine, RIOS only cell.  The
cell consists of a Cell server being the primary cdsd and secd.  The other
machine is a secrity replica and a secondary cds server.  Everything 
configured fine and is working fine.  I am using the BL13 build.

Should I try with another build?   Gerry Thome (512)838-2256

[8/15/94 public]
Yep. The bug was detected pretty much the day it was opened. The
smoke test was working prior to that. That places the problem after
8/5. BL13 was cut on 7/26. BL14 should fail. 

I was about to update this with more information. As I said above a change
to the configuration files caused the test to go from working to broken. It
wasn;t the change I was looking for however. I changed the cell name from
/.../john.qadce.osf.org to /.../john and it broke. I fipped back and forth
a few time just to be sure and its reproducable with the systems I'm
working with.  All I know is that the following messsage comes out in
the dce_config.log file on  the machine where the security replica and 
secondary cds server are being configured. cdsd then core dumps. 
The rios is wolfboy.

V:         Creating clearinghouse files and replica for root directory.
D:         Executing: cdscp create clearinghouse /.:/wolfboy_ch
DEBUG:     Executing: chk_cdscp(cdscp - creating clearinghouse
/.:/wolfboy_ch.)
DEBUG:     Executing: err_exit(cdscp - creating clearinghouse
/.:/wolfboy_ch.
  Message from cdscp:
  connection closed (dce / rpc))
ERROR:   cdscp - creating clearinghouse /.:/wolfboy_ch.
  Message from cdscp:
  connection closed (dce / rpc)
V:         User query: Press <RETURN> to continue, CTRL-C to exit:

The smoke test machines are configured is as follows.

486
comes up as a single cell machine and dts local server

HP
comes up as a security replica, secondary cds server, and a dts local
server 

RIOS
comes up as a security replica, secondary cds server, and a dts loca

I can reproduce the problem with the following.

486
comes up as a single cell machine

HP
comes up as a security replica, secondary cds server

Its not making a whole lot of sense.........

[8/15/94 public]
I was wrong about BL14. It was cut on 8/3 and probably doen't exhibit the
problem. 

I talked to Bob Whitehurst and he will put it on his list. Assigning it
to him.

[8/23/94 public]

I am on the correct build (14.3) and I cannot repro this.  Here is
what I tried.

1) create an initial cell server on a machine (cds server, sec server)
2) create a secondary cds server adn security replica on a second machine
3) create another secondary cds and security replica on a RIOS, this 
   should fail.

I only have RIOS machines and  this does not fail in a RIOS only
environment.  Any sugggestions?

[gthome public]

I noticed in the build log today that the multi-machine smoketests
passed on the RIOS.  Does this mean that this defect is fixed???

[gmd public]
Gerry - no, the config of a secondary cds server on the RIOS was
temporarily removed since it was blocking the rest of the smoketests.
There is a significant DFS submission going in today that I would
like to have smoketested but if there are no objections, I can re-enable
the secondary cds server on the RIOS for Thursday am.

[bmw public]
I just configured 16 without experiencing this problem. However, I
was not able to configure the dts local server before configuring the
cds secondary. Would this matter?

[gmd public]
No - I don't believe this is related - thanks for the detail though -
apparently some other people are seeing dts problems with 16 (although
I was able to configure 3 local servers, 1 on a RIOS, w/ 16 fine). Since
you aren't seeing the problem w/ RIOS-only cells and we were w/ hetero
cells, I can only guess this is an interop problem. Adjusting the
smoketest now - we'll see what happens.

[bmw public]
I tried to configure a cell with a long cellname as specified by John
Dugas in his comments on 8/15 and did not encounter any problems. I
normally configure a cell with a short cellname and have not encountered
this problem. If I reconfigure again I will try with a short name.

[gmd public]
I successfully configured a cds replica on a RIOS w/ bl-17 BUT you
must use the dce_config submitted 9/9 (one day AFTER bl-17 was cut)
otherwise, regardless of platform, you'll hang during the config.
George is going to repeatedly configure dts local servers (CR 11939)
and cds replicas on RIOS using bl-17 to give us confidence in downgrading
or canceling this CR.

[gmd public]
Canceling - this one just disappeared - not seen in the smoketest or
with the script George is using. Other cds problems are being seen but
they are not RIOS specific and are covered in other CRs.



CR Number                     : 11508
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11405
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : intermittent failure to return a binding from a group entry
Reported Date                 : 8/1/94
Found in Baseline             : 1.1b13
Found Date                    : 8/1/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/1/94 public]

During a 48 hour run of DCDREL001, 4 passes out of 111 failed with
one or more test servers never being accessed by the test clients.
Given the design of the test, this would appear to have been due to
the test servers successfully exporting their bindings to the
namespace and successfully adding their individual object entries
to a group entry, but then not being found on an import from the 
group entry. Since the expiration age is set to 0 for the import
context which the test clients use to import the server bindings,
I believe that proper cache operation should not be causing this
problem.

[9/14/94 public]
See response to 11405. Could be the same issue.

[08/20/96 public]
I'm cancelling this OT since Janet gave a plausible response in 11405
and no verification occurred.



CR Number                     : 11475
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Error with socket
Reported Date                 : 7/28/94
Found in Baseline             : 1.1
Found Date                    : 7/28/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/94 public]



Output from /tmp/dce_config.log from DFS Smoketest




DEBUG:     Executing: err_exit(cdscp error while initializing the name space
           for DFS.
             Message from cdscp:
             create dir /.:/subsys/dce/dfs
           Error on entity: /.../sif_cell/subsys/dce/dfs
           Error with socket
           Function: dnsCreateDir

           add entry /.../sif_cell/subsys/dce/dfs/bak
           export -o 8ff29f40-a97f-11cd-9240-080009253315
           /.../sif_cell//dfs/bak
           quit)

[7/28/94 public]
Couldn't reproduce - error APPEARS to have been the inability
for cdsadv to recognize the existence of OR to spawn a clerk
for dfs - but cdsadv was running fine when I got to it, as were
a couple of clerks - I was able to spawn a new clerk too. Will
keep an eye out for it - lowering priority to a 1.

[8/24/94 public]
Cancelling - never seen again.



CR Number                     : 11405
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : rpc_ns_group_mbr_add fails intermittently
Reported Date                 : 7/23/94
Found in Baseline             : 1.1b11
Found Date                    : 7/23/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/23/94 public]

The system test DCDREL001 fails intermittently because attempts
to add a server object to a group entry in the namespace (using the
call rpc_ns_group_mbr_add )sometimes fail. The group entry in the 
namespace is deleted at the start of the test, and the call 
rpc_ns_mgmt_set_exp_age is used to set the expiration age to 0 
before making the rpc_ns_group_mbr_add call, in case old cached 
information would otherwise interfere.

The status returned is "entry already exists (dce / rpc)". If the
group entry is examined during a failing test pass, (using the 
dcecp command "rpcgroup list <entry>") the entry that "already exists" 
is not listed. 

In the current test configuration 4 application servers are
started, each registering one unique entry name and adding that 
name to a shared group entry.  In a recent test run the error 
occurred in 1/3 of the test repetitions.

[9/14/94 public]
If you have CDS replicas of the entry it is possible that the removes
have not propagates to the server you talk to on the read.  If
the parent directory is replicated, you will have to skulk it after modifies
to ensure all replicas have the new data added or removed.

[08/20/96 public]
I'm cancelling this OT since Janet gave a plausible explanation and
no response was given.



CR Number                     : 11351
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11564
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cds set dir to new epoch master results in two masters
Reported Date                 : 7/18/94
Found in Baseline             : 1.1
Found Date                    : 7/18/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/18/94 public]

Invoking the cdscp command set directory to new epoch master does not
change the current master directory to the new node.

Build: BL-11

Cell: HPUX: sec server, cds server
      OSF1: client, cds replica
      OSF1: client, cds replica

On the HP server the following commands are invoked:


dce_login cell_admin -dce-

cdscp create directory /.:/admindir

cdscp set directory /.:/admindir CDS_Convergence = high

cdscp create object /.:/admindir/adminobj

cdscp create replica /.:/admindir clearinghouse /.../admin_cell/admintest2_ch

cdscp set directory /.:/admindir to new epoch master /.:/admintest2_ch exclude /.:/admintest1_ch

cdscp show replica /.:/admindir clearinghouse /.:/admintest2_ch CDS_Epoch CDS_ReplicaType
                        SHOW
                     REPLICA   /.../systest/admindir
                          AT   1994-07-18-16:41:45
                   CDS_Epoch = ad4bfa62-a26a-11cd-ab5d-0800093251fc
             CDS_ReplicaType = readonly

(The show replica command can be run on any of the cell nodes with the
same result.)

[7/19/94 publib]
I checked - this isn't blocking anyone in system testing. We will get
to it soon but not today. Its a B1.

[8/3/94 public]
Fixed.  Table size was incorrectly modified, messing up opcode.

[8/4/94 public]

The set dir to new epoch command now results in two masters.

The output after the set dir to new epoch command:

(original master)
cdscp sho replica /.:/admindir clearinghouse /.:/brandy_ch  CDS_Epoch \
CDS_ReplicaType
                        SHOW
                     REPLICA   /.../systest/admindir
                          AT   1994-08-04-10:15:27
                   CDS_Epoch = 7e705424-af92-11cd-823c-0800093251fc
             CDS_ReplicaType = master


(new epoch master)
cdscp sho replica /.:/admindir clearinghouse /.:/aruba_ch CDS_Epoch \
        CDS_ReplicaType
                        SHOW
                     REPLICA   /.../systest/admindir
                          AT   1994-08-04-10:17:12
                   CDS_Epoch = 1a1aad88-af94-11cd-b1b4-0000c07ad04c
             CDS_ReplicaType = master

[8/4/94 public]
Please cancel this.  This is how it works.  New epoch should be used to
change the master or to exclude replicas that are off-line and will most likely
not ever be back.  What you have is not a good idea.  New epoch was
mostly designed for disaster recovery.

[8/4/94 public]

More fun with masters and replicas.  An excluded master should not be 
referenced once excluded.  The cds replica checklist test will be changed
to reflect this.

CR #11564 has been created to track the changes.



CR Number                     : 11291
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : nsi
Short Description             : problems re-exporting to the namespace
Reported Date                 : 7/14/94
Found in Baseline             : 1.1
Found Date                    : 7/14/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/14/94 public]

Problems re-exporting to the namespace (originally reported in
CR 11119) will be tracked here.

[7/14/94 public]
As luck (good? bad?) would have it, I am unable to reproduce this
problem with the build available today. Martha Dassarma, Rick Fadden
and I all hit problems trying to restart our cells with /etc/rc.dce
and had to resort to reconfig'ing for every cell restart. Downgrading
for the time being - this will either resurface when testing
between cell restarts is done (rather than the clean shutdown/restart
attempts used to attempt to reproduce this) or get cancelled.

[7/28/94 public]
Suspecting this was an operator error on my part - mishandling restarting
of a split server configuration such that security was not available
via the namespace when dts and dfs were trying to start up. Rick and
Martha were hitting secd core dumps that spin cds (CR 11067) which
results in similar symptoms. Cancelling ...



CR Number                     : 11272
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : client
Short Description             : cds client side hangs
Reported Date                 : 7/13/94
Found in Baseline             : 1.1
Found Date                    : 7/13/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/13/94 public]

Simple cdscp commands hung in the SINGLE MACHINE smoketest cells
yesterday. Buried among all the dtsd ERROR outputs were the
following cds error messages:

1994-07-12-17:28:42.098-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:29:23.023-04:00I----- cdsd(2853) ERROR cds library sec_init.c 419 0x40053330
1994-07-12-17:30:27.054-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:31:37.099-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:33:22.054-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:42:11.618-04:00I----- cdsd(2853) ERROR cds library sec_init.c 419 0x40053330

1994-07-12-18:20:37.628-04:00I----- cdsd(2853) ERROR cds library sec_init.c 419 0x40053330

Note that these error messages began appearing around 5:30 pm while the
cell was configured around 7:45 am ...

[8/24/94 public]
Lowering to a priority 2 since this problem, if it still exists, hasn't
seemed to have blocked anything ... Not ready to cancel this since, although
the line numbers no longer have meaning, data point may prove useful now
that (hopefully) more and longer system test runs can happen.

[08/20/96 public]
I'm cancelling this OT because it is not reproducible, the above messages
are missing status codes so we don't know what possibly happened then,
and no subsequent references were made to this OT during testing.



CR Number                     : 11137
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd aborts if cdsadv dies unexpectedly
Reported Date                 : 6/29/94
Found in Baseline             : 1.0.3
Found Date                    : 6/29/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : cds/library/unix_mbx.c
Sensitivity                   : public

[6/29/94 public]
 
 DESCRIPTION: Running the SDC test suites included trying the command
 "cdscp disable clerk."  This command shuts down all clerks and the
 cdsadv on the local system.  The next time the cdsd attempted to ping
 the cdsadv, it took a SIGPIPE, because there was no process at the
 other end of its connection.  The cdsd had no handler for this
 condition and the resulting mass of circumstances caused it to abort.

 PROPOSED SOLUTION:
 Put a TRY clause around the mailbox write so that SIGPIPE errors
 can be mapped to an error status.
 
*** unix_mbx.c  Wed Jun 29 17:01:37 1994
--- unix_mbx.c.new      Wed Jun 29 17:14:08 1994
***************
*** 743,762 ****
      byte_t            *buf_p;
      int                       len;
  {
!     register int fd, status;
  
!     while (0 <= (fd = mbx_p->data_fd))
        /* CANCEL POINT */
        if (0 < (status = dthread_write(fd, (char *)buf_p, len))) {
!           buf_p = SKIP_bytes(buf_p, status);
!           if ((len -= status) == 0)
!               break;
!       } else if (status == 0)
!           return (DNS_ERROR);
!       else
!           return (DNS_UNIXERRORS + errno);
  
!     return (DNS_SUCCESS);
  }
  
  static void
--- 743,772 ----
      byte_t            *buf_p;
      int                       len;
  {
!     register int fd, status, code = DNS_SUCCESS;
  
!     TRY {
!       while (0 <= (fd = mbx_p->data_fd))
        /* CANCEL POINT */
        if (0 < (status = dthread_write(fd, (char *)buf_p, len))) {
!         buf_p = SKIP_bytes(buf_p, status);
!         if ((len -= status) == 0)
!           break;
!       } else if (status == 0) {
!         code = DNS_ERROR;
!         break;
!       } 
!       else {
!           code = DNS_UNIXERRORS + errno;
!           break;
!         }
!     }
!     CATCH (exc_e_SIGPIPE) {
!       code = DNS_UNIXERRORS + EPIPE;
!     }
!     ENDTRY;
  
!     return (code);
  }
  
  static void

[6/30/94 public]
This was fixed in 1.1 a month or two ago.  I just went through the closed bugs
and couldn't spot the ot. I'll see if I can find it today and make this a dup.

[7/5/94 public]
Cancelled.



CR Number                     : 11119
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11223,11272
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cds client
Short Description             : Error with socket/entry not found
Reported Date                 : 6/28/94
Found in Baseline             : 1.1b10
Found Date                    : 6/28/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/28/94 public]
I'm having problems with running dced as the endpoint mapper.

[ninja]:/usr/sandbox/opt/dcelocal/var# /etc/rc.dce
        /opt/dcelocal/bin/dced
No currently established network identity for which context exists
DCED listening...
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/auditd -a
        /opt/dcelocal/bin/dtsd -s
1994-06-28-15:31:19.914-04:00I----- dtsd ERROR dts events 0x004fb368
DCE error Couldn't export time server mgmt interface: : Error with socket (dce / cds)
1994-06-28-15:31:20.264-04:00I----- dtsd ERROR dts events 0x004fb368
DCE error Can't export time control interface: : Error with socket (dce / cds)
        /opt/dcelocal/bin/dts_ntp_provider -h pooch -p 600 -i 30
1994-06-28-15:31:25.043-04:00I----- dtsd ERROR dts events 0xa44d1acc
LAN profile not found
[ninja]:/usr/sandbox/opt/dcelocal/var# 1994-06-28-15:31:25.993-04:00I----- dtsd ERROR dts events 0xa44d1acc
DCE error Can't unexport time server mgmt interface: : Error with socket (dce / cds)
1994-06-28-15:31:26.123-04:00I----- dtsd ERROR dts events 0xa44d1acc
DCE error Failure in rpc_ep_unregister: : not registered in endpoint map (dce / rpc)
1994-06-28-15:31:26.143-04:00I----- dtsd ERROR dts events 0xa44d1acc
DCE error Failure in TService interface rpc_ns_binding_unexport: : Error with socket (dce / cds)

[6/30/94 public]
After reconfiguring my machine, auditd will come up, but if I stop auditd,
it will not restart. svc returns the following message:

[ninja]:/usr/users/rousseau# /opt/dcelocal/bin/auditd -a
[ninja]:/usr/users/rousseau# 1994-06-30-13:05:49.400-04:00I----- auditd FATAL aud general 0xa44d1acc
cannot register daemon's svc manager bindings with RPCD

[06/30/94 public]
Note that that status code -- 0xa44d1acc -- is completely bogus:
   ; showst 0xa44d1acc
   Tech = 10 = 012 = 0xa = <unknown>
   Comp = 17617 = 042321 = 0x44d1 = lar
   Mesg = 2764 = 05314 = 0xacc = ???

[7/5/94 public]

I was unable to reproduce what John got (on the 486).

Here's what happens to me:

<config, shutdown, then restart>

root@surf# /etc/rc.dce
        /opt/dcelocal/bin/dced
No currently established network identity for which context exists
DCED listening...
        /opt/dcelocal/bin/secd
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/cdsd
        /opt/dcelocal/bin/auditd -a
        /opt/dcelocal/bin/dtsd -s
1994-07-05-15:49:37.639-04:00I----- auditd FATAL aud general 0xa44b0bc4
cannot register daemon's ACL manager interface bindings
        /opt/dcelocal/bin/dts_ntp_provider -h clock -p 600 -i 30

Looks to me like Audit is having problems somewhere, not RPC.

[07/06/94 public]
John sent this email before taking some time off.  I took a quick
skim through the audit code and didn't see any obvious incorrect
calling sequences...
  What I saw on the way up was rpc_set_auth_info failure with a completly
  bogus status code. On the way down I saw rpc_ep_unregister failures.
  I configed a cell on the 486 and hp this am and did not see the problem
  on the way up. I didn't  bring the cell down so I'm not sure if those 
  messages are still there. I didn't see the error messages below about not
  being able to export a mgmt interface but it might be related

[07/06/94 public]
Upgraded to 0. I'm blocked on this. I can't start auditd to work on any
of the slew of audit bugs I just inherited.

[07/07/94 public]

Other source of "Error with socket"

The are several Error with socket errors printed when running
/etc/dce_shutdown -f:

root@west> /etc/dce_shutdown -f
1994-07-07-11:54:26.710-04:00I0.612 dtsd ERROR dts dtserror 0x7aff8340
Failed to unexport Control interface from the namespace: Error with socket
(dce / cds)
Caught signal 15.  Exiting.
WARNING: dtsd not killed
WARNING: cdsadv not killed
root@west> 1994-07-07-11:55:01.792-04:00I0.647 dtsd ERROR dts dtserror
0x7aff8340
Failed to unexport Service interface from the namespace: communications
failure (dce / rpc)
1994-07-07-11:55:01.810-04:00I0.647 dtsd ERROR dts dtserror 0x7aff8340
Failed to unexport Service interface from the namespace: Error with socket
(dce / cds)
1994-07-07-11:55:01.828-04:00I0.647 dtsd ERROR dts dtserror 0x7aff8340
Failed to remove Service interface from the profile
/.../west_cell/lan-profile: Error with socket (dce / cds)
1994-07-07-11:56:11.757-04:00I0.717 dtsd ERROR dts dtserror 0x7aff8340
Couldn't unregister the version 1.0 rdacl interface from the endpoint map:
communications failure (dce / rpc)
1994-07-07-11:56:11.766-04:00I0.717 dtsd ERROR dts dtserror 0x7aff8340
Failed to unregister dtsd ACL manager interface: communications failure
(dce / rpc)

[7/7/94 public]
You will see these errors from DTS because it now reports errors
on shutdown.  Since you sent a signal to dts and it wnt to shutdown
gracefully, it tries to do namespace things, but its too late, since
dce_shutdown has already moved on to killing CDS.  So, you get errors.
These always happened, but now with SVC, you get to see them.
I believe there is a defect against DTS saying that we should ignore
all errors on shutdown.

Anyway, I believe this problem to be with CDS, since the 
error with socket is a CDS generated status code:

start
code    CDS_SOCKET
tables  (cds_msg_table)
text    "Error with socket"
explanation     "The communications between the DCE library and the cds clerk ch
ild has failed. The connection is closed."
action  "If the problem persists, restart DCE."
end

This is probably because the clerks have died or something.  Note that
libdce does not user RPC to communicate with the clerks, but rather
a local host socket.

[7/7/94 public]
I just tried the same test in the HP server that failed on the client
486, it worked fine. This may explain why other folks could not reproduce
the problem on single machine cells.

[7/7/94 public]
I'm hitting something similar when trying to restart my cell.

1994-07-07-13:54:30.644-04:00I----- dtsd ERROR dts events 0x200dee98
DCE error Couldn't export time server mgmt interface: : entry not found (dce / rpc)
1994-07-07-13:54:30.914-04:00I----- dtsd ERROR dts events 0x200dee98
DCE error Can't export time control interface: : entry not found (dce / rpc)
root@cobbler> 1994-07-07-13:54:36.111-04:00I----- dtsd ERROR dts events 0x200aaef8
LAN profile not found
1994-07-07-13:54:36.563-04:00I----- dtsd ERROR dts events 0x200aaef8
DCE error Can't unexport time server mgmt interface: : entry not found (dce / rpc)
1994-07-07-13:54:36.686-04:00I----- dtsd ERROR dts events 0x200aaef8
DCE error Failure in rpc_ep_unregister: : not registered in endpoint map (dce / rpc)
1994-07-07-13:54:36.759-04:00I----- dtsd ERROR dts events 0x200aaef8
DCE error Failure in TService interface rpc_ns_binding_unexport: : entry not found (dce / rpc)

I am using rpcd so this is not a dced issue. I need DTS to run DFS so this is
blocking me - rebooting and reconfiguring is VERY time consuming - help!

[7/7/94 public]
It is conclusive that this is a cds client problem.  I just configured
my 486 as a client to an HP server with last night nightly build.

DTS, AUD, and DCED (it looks like)  can not use CDS.  

Here is what I did, note that the clerks are running, but I can't
talk to them.

Since John isn't here till tomorrow, can someone at DEC take a look at this?

root@surf# /etc/rc.dce
        /opt/dcelocal/bin/dced
DCED listening...
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/auditd -a
        /opt/dcelocal/bin/dtsd -c
1994-07-07-14:28:10.845-04:00I----- dtsd ERROR dts dtserror 0x004fc368
Failed to export Time Control V2 interface to the namespace: Error with socket (dce / cds)
1994-07-07-14:28:10.975-04:00I----- dtsd ERROR dts dtserror 0x004fc368
Failed to export Time Control interface to the namespace: Error with socket (dce / cds)
1994-07-07-14:28:12.914-04:00I----- auditd FATAL aud general 0xa44b3bd4
cannot register daemon's ACL manager interface bindings
1994-07-07-14:28:15.884-04:00I----- dtsd ERROR dts dtserror 0xa44b3bd4
Failed to retrieve server binding from the namespace: Error with socket (dce / cds)
1994-07-07-14:28:15.934-04:00I----- dtsd ERROR dts events 0xa44b3bd4
LAN profile not found
1994-07-07-14:28:15.944-04:00I----- dtsd ERROR dts dtserror 0xa44b3bd4
Can't retrieve DCE cell name from configuration DB: Error with socket (dce / cds)
1994-07-07-14:28:15.954-04:00I----- dtsd WARNING dts config 0xa44b3bd4
Too fews servers (0), need 1 servers
root@surf# Can't NS export Security Certification server, Unknown message number 0x10d0a96c
Can't NS export Login Pre-Authentication server, Unknown message number 0x10d0a96c
Can't NS export Password Override server, Unknown message number 0x10d0a96c
Can't NS export Host Data server, Unknown message number 0x10d0a96c
Can't NS export Keytab Management server, Unknown message number 0x10d0a96c
Can't NS export Schema Management server, Unknown message number 0x10d0a96c
Can't NS export Server Configuration server, Unknown message number 0x10d0a96c
Can't NS export Server Execution server, Unknown message number 0x10d0a96c
Can't NS export Security Validation server, Unknown message number 0x10d0a96c

root@surf# 
root@surf# cdscp show dir /.:

                        SHOW
                   DIRECTORY   /.../tsunami_cell
                          AT   1994-07-07-14:29:49
Error on entity: /.../tsunami_cell
Error with socket
Function: dnsEnumAttr

surf>stcode -h 0x10d0a96c
Tech = 1 = 01 = 0x1 = dce
Comp = 3338 = 06412 = 0xd0a = cds
Mesg = 2412 = 04554 = 0x96c = Error with socket

surf>ps auxww | grep opt
tom      20389  2.5  1.0 7.52M 372K pts/0    S  + 14:32:28     0:00.07 grep opt
root     18478  0.0  6.3 9.15M 2.26 ??       S    14:27:58     0:01.48 /opt/dcelocal/bin/sec_clientd
root     18490  0.0  6.3 9.92M 2.29 ??       S    14:27:55     0:01.21 /opt/dcelocal/bin/dced
root     18467  0.0  6.9 9.32M 2.49 ??       S    14:28:04     0:01.55 /opt/dcelocal/bin/dtsd -c
root     18475  0.0  6.6 9.74M 2.39 ??       S    14:28:00     0:01.62 /opt/dcelocal/bin/cdsadv
root     20355  0.0  3.3 8.90M 1.18 ??       S    14:28:05     0:00.38 /opt/dcelocal/bin/cdsclerk
root     20354  0.0  7.1 9.67M 2.57 ??       S    14:28:06     0:02.45 /opt/dcelocal/bin/cdsclerk

[7/8/94 public]
Janet Mccan is unavailable this week so I'm  assigning this to myself until
I can talk to Alan Peckham. I'm back and will look into this this am.

[7/11/94 public]
The auditd problem seems to be a permission problem. auditd on either
the client or the server machine fails to export its binding through
rc.dce because as self it does not have permission to write the server
entry /.:/hosts/<host-name>/aud-acl. During initial configuration
auditd comes up as cell_admin which does have write permission.

The dtsd problem seems a bit harder to get a handle on. I've been running
with a 486 cds/secd/dtsd server, hp800 cds/secd/dtsd pair and the only 
error messages I see in response to either dce.config or dce_shutdown -f
are

On the client (hp)....
Caught signal 15.  Exiting.
Can't NSI unexport Security Validation server, Unknown message number 0x10d0a96c
Unknown message number 0x10d0a96c

On the 486 server
Caught signal 15.  Exiting.
Can't NSI unexport Security Validation server, Error with socket
Error with socket

The 'Caught signal 15' is from the clerk in response to the sig15 sent by
the advertiser. Its ok and a notice shows up in the serviceability log
saying its ok. I'm trying to find out where the other message is comming 
from. I'm also trying to find out why I'm not seeing all the other dts error
messages that others are seeing. I've brought my cell up and down several 
times and dtscp works fine.

[07/13/94 public]
Messages that look like this:
    Can't NS export Security Certification server,
	Unknown message number 0x10d0a96c
are probably dced bugs covered under OT CR 11211 (dced isn't waiting for
cdsd to come up before it registers).
Messages that look like this:
	Can't NS unexport XXXX server
can be ignored because cdsd is down before dced.

[7/13/94 public]

As Rich pointed out all messages with 'Can't NS' should be ignored.

The messages from auditd on its inability to export its ACL manager
bindings are a permission problem and a seperate ot against auditing 
has been opened.

The following two errors from cdsd during shutdown are harmless. We are
looking into it but at a lower priority than other problems. I will open
a seperate lower priority ot. Basically the rpc_ep_unregiter call is
being made with correct arguments but the call is failing. Since all
endpoints are reinitialized on the way up the fact that one doesn't get
unregistered un the way down is of little consequence.

1994-07-13-13:59:25.982-04:00I----- cdsd(18327) ERROR cds server unix_cds_net.c 1522 0x007a8440 Attempt to unregister the clerk/server RPC endpoint has failed with status = not registered in endpoint map (dce / rpc)
1994-07-13-13:59:26.432-04:00I----- cdsd(18327) ERROR cds server unix_cds_net.c 1561 0x007a8440 Attempt to unregister the dacl RPC endpoint has failed with status = not registered in endpoint map (dce / rpc)


The remaining problem is the error messages from dtsd while attempting 
export. I'm still looking at this. 


I don't believe the cds hang problem is related to anything in this ot and 
I have asked Gail to open a seperate ot. Its 11272.

[7/13/94 public]
Regarding the dts error messages, I compared what happens when you
shut the cell down with /etc/dce_shutdown vs. /etc/dce_shutdown -f.
I used the same command on both the server and client in each of 10
runs. The cell was just brought back up, not reconfigured, on each run.

/etc/dce_shutdown 5 times - no dts error messages
/etc/dce_shutdown -f 2 times - got dts error messages
/etc/dce_shutdown 2 times - no dts error messages
/etc/dce_shutdown -f 1 time - got the error messages

Says to me if you let things shut down in order useing the command
programs to shut all of the servers down things work. If you send
kills to the servers at least dts isn't finished with the namespace
and or dced when they go away. I'll see what I can do to sequence things
so the forced shutdown works a bit better but the message here is
don't use forced shutdown. The non forced shutdown attempts to bring
things down gracefully and if anything is left it then and only then
dispatches it with a signal. This takes a bit longer but it works much
better. The -f option tells shutdown to send the signals now - make
no attempt to take the servers down gracefully.

[7/13/94 public]
I'm downgrading the priority on this. The only remaining issue is
sequencing the forced shutdown a bit better. It will remain open untill
then. Tom already opened an ot on cdsd not always going away gracefully
and I'll add the unregister error messages to that. I may very well be
related.

[7/14/94 public]
This bug has gotten too confusing - cancelling and reopening 2 others:
	1 - for the sequencing of the forced shutdown (CR 11290)
	2 - for problems with re-exporting to the namespace (CR 11291)



CR Number                     : 11064
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDSPI - does not accept back slash in Simple Names
Reported Date                 : 6/23/94
Found in Baseline             : 1.0.3
Found Date                    : 6/23/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/23/94 public]

As per OSF DCE 1.0.3 documentation, the meta - characters ( \ * ?)
in CDS simple names can be escaped with back slash. (Appendix A-1 of
Admin Guide -- Core Comp.). This was working in OSF DCE 1.0.2. But in DCE 1.0.3
ig gives syntax error if the simple name contains a back slash
( ie it contains two back slash characters - one escape
character and other the actual back slash character in the name).

DCE 1.1's cdscp and dcecp show the same problem.

To see the problem, do the following:

	$ cdscp
	cdscp> create obj /.:/o\\b

Proposed Solution:

      If this a new restriction in DCE 1.0.3 , please update the
      DCE documentation else fix this defect.

      FYI -- in DCE 1.0.3 there was a change in the parsing logic
             in file "src/directory/cds/library/cdsstrtosimple.c"

[06/27/94 public]
I believe that the docs are misleading -- the intent was that you use
backslash to get Unix wildcard characters into a cds pathname, not
that you can have any chars in a CDS pathname.  The legal set of chars
is defined in the docs somewhere.

I think this should either be a doc defect or cancelled.

[6/27/94 public]
Indeed, the above example is not good. Try the following:

	$ cdscp create obj /.:/o\\b

In 1.0.2, this will create an object of name "o\b". in 1.0.3 and 1.1, it gives 
"syntax error".

So, either the code or the doc must be modified.

[06/27/94 public]
Sorry I was not clear enough.
The code is now right; it was wrong.
Are the docs wrong?

[6/27/94 public]
Then the doc should be changed. Here is what it says in the Appendix A of 
Admin Guide (Core Component), Section A.1 "Metachacters":

"CDS \	Used where necessary in front of a \ (backslash), an *
	(asterisk), or a ? (question mark) to escape the chacter;
	indicates that the following character is not a metacharacter.

Some metachacters are not permitted as normal characters within a name. For
example, a \ (backslash) cannot be used as anything but an escape character
in GDS. ..."

If it is also the case that \ can be used only for escape character but not
as a normal character, this section needs to be changed. Maybe other places 
too.

[6/27/94 public]
According to our Dev Guide Table 23-1:

For CDS a backslash may be used in front of a \, an *, or a ? to escape 
the character. 

For GDS a \ cannot be used as anything but an escape character.

So, it ought to work in CDS and although I don't have a 1.0.3 cell up
I seem to believe it did then. I'll  verify it though. I'll also look
at the AES.

[6/27/94 public]
The AES contains language very simmilar to the above with one notable 
exception. 

For CDS a backslash may be used in front of an *, or a ? to escape 
the character.

Note that it does not require that the backslash work when escaping
another backslash. It doesn't mean it shouldn't work - just that its
not required. We'll have to do some more digging on this one.

[6/12/94 public]
I tried creatinf foo\\bar in 1.0.3 and 1.1 and as observed above both
failed. I don't have 1.0.2 and it doesn't matter 1.1 will do what 1.0.3
did - not allow \\. I will open a doc bug. Cancelling this one.



CR Number                     : 10959
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : configuring secondary cds server on 486 fails.
Reported Date                 : 6/15/94
Found in Baseline             : 1.1
Found Date                    : 6/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/15/94 public]
Configuring a secondary server from a 486 to an hp primary fails. An hp
secondary to a 486 primary seems to work ok. Sometimes the error
is 'connection closed (dce / rpc) and sometime the cdscp create clear
doesn't complain but the secondary clearing house can't be shown or
acl_edit'd. You can;t see it with show obj either. I can create 
multiple clearinghouses on a single machine 486 ok.

I've assigned this to Janet Mccann for ideas and I'm still investigating.

[jd 7/5/94 public] 
This problem like 10649 can only be replicated in my office. I've already
swapped machines, everything except the disk, to no avail. I'll move my 
machine to another office to elimenate the cables. In the meantime. since
this only affects me, I'm lowering the priority.

[7/5/94 public]
Nope I was mistaken. This one did go away with the new box.
Cancelled.



CR Number                     : 10927
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : cdscp "show
clearinghouse" fails as unauthenticated user
Reported Date                 : 6/10/94
Found in Baseline             : 1.1
Found Date                    : 6/10/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/10/94 public]

When run under my Unix user and group id (1549, 1000) respectively, 
with no network credentials, a "cdscp show clearinghouse" fails 
consistently with the following diagnostic. 


cbrooks> cdscp show clearinghouse /.:/falcon_ch
Warning: you have no network credentials. All requests will be unauthenticated.

                        SHOW
               CLEARINGHOUSE   /.../falcon_ch/falcon_ch
                          AT   1994-06-10-10:01:24
Error on entity: /.../falcon_ch/falcon_ch
Specified clearinghouse does not exist (dce / cds)
Function: dnsReadAttrValue

I'm running /bin/ksh, and my environment looks like the following:

EFILE=/users/cbrooks/.kshrc
MANPATH=/project/tools/man:/usr/man:/usr/local/man:/usr/local/X11R5/man:/users/cbrooks/Man
TEXFONTS=.:/project/tools/libdata/tex/fonts/
NLSPATH=/usr/lib/nls/C/%N:/usr/lib/nls/C/%N.cat
TEXFORMATS=/project/tools/libdata/tex/formats/
PAGER=less
FPATH=/users/cbrooks/funcdefs
VISUAL=emacs
PATH=/users/cbrooks/bin/scripts:/users/cbrooks/bin/9000-710:/project/tools/bin/hp9000_700:/bin:/usr/bin:/usr/contrib/bin:/usr/local/bin:/usr/local/bin:/usr/local/X11R5/bin:/usr/bin/X11:/usr/local/bin/mh:/usr/local/lib/gnu-emacs/etc-19
COLUMNS=79
WINDOWID=92274702
TeXBase=/project/tools/libdata/tex
EDITOR=emacs
LOGNAME=cbrooks
MAIL=/usr/mail/cbrooks
PRINTER=milhaus
SYSPATH=/bin:/usr/bin:/usr/contrib/bin:/usr/local/bin
USER=cbrooks
OT_PROJECT=dce
TEXPOOL=/project/tools/libdata/tex
DISPLAY=falcon:0.0
SHELL=/bin/ksh
HOME=/users/cbrooks
TEXINPUTS=.:/project/tools/libdata/tex/inputs
TERM=xterm
XAPPLRESDIR=/users/cbrooks/App-defaults
TEXEDIT=vi +%d %s
PWD=/users/cbrooks
hostname=falcon
TZ=EST5EDT
LPDEST=milhaus
ENV=/users/cbrooks/.kshrc
UI=/usr/include
DCEtype=hp800
LINES=52

Other notes: works if I run as root via a "su - root", but NOT via 
su root. Works as another logged in user.

[6/29/94 public]
I need more information here.  This command uses acl to check access so
your locol userid should not be relevant.  What does the acl look like on
the clearinghouse and server.  So you expect unauthenicated read?
When you loggin as root do you have credentials??

[9/12/94 public]
The .cdscpinit file in your home directory had a set preferred clearinghouse
line for a clearinghouse that didn't exist in cell falcon_cell,



CR Number                     : 10790
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : intercell broken
Reported Date                 : 5/26/94
Found in Baseline             : 1.1b9
Found Date                    : 5/25/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1beta
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/26/94 public]

Unauthenticated intercell in 1.1b9 is broken. The command
"cdscp show dir /.../<cellname>" using a <cellname> registered in 
DNS returns the NAMESERVERBUG message ("Software error detected in 
server (dce/cds)").

[5/31/94 public]
What I know so far is that gdad is sending out the request, getting the
TXT string back but no addresses. It correctly forms the element structures
based oin what it did get and wakes up the requesting thread. That thread
parses what it got but throws its hands up when it becomes aware that it
got no addresses. I'm really suspecting a nameserver problem here. I'll set
up to try another today.

[5/31/94 public]
Well folks, the problem has disappeared completly. I haven't a clue as
to why. At least three people saw this problem last week and this week
we can't replicate it. I checked with our network people and nothing got
fixed over the weekend. Gdad got no changes and it doesn't depend on rpc
to do what it was failing to do - it makes straight socket calls to the
nameserver. Cancel it for now. If it reappears we will reopen it.



CR Number                     : 10777
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv coredumps during rep rtest3
Reported Date                 : 5/25/94
Found in Baseline             : 1.1
Found Date                    : 5/25/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public
z                             : 

[5/25/94 public]

Placeholder CR while I try to gather more information. Unclear if
this is reproducable yet.

Running dfs 1.1ab5 (based on core bl-5) in the CHO cell with 
regression tests running, cdsadv coredumped on the HP apparently
during rtest3 (which, at the time, was incorrectly being run as
dce principal root instead of dce principal cell_admin).

Coredump contained no useful data.

[7/5/94 public]

Don't have time to reproduce - dropping priority.

[08/20/96 public]
I'm cancelling this OT since there is no useful information here.



CR Number                     : 10706
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : delete clearinghouse
Short Description             : The "object delete" command
allows a user to delete the Master clearinghouse name, or any CH, the CH name
is deleted, the CH stays and is usable.
Reported Date                 : 5/19/94
Found in Baseline             : 1.1
Found Date                    : 5/19/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/19/94 public]

"dcecp -c object delete" or "cdscp delete object" should not allow a user
remove the name of the Master clearinghouse or any clearinghouse.

The command "object delete <name>", where <name> is a clearinghouse (CH),
let's one delete the CH. Eventhough, the CH name is deleted from 
the directory entry, the MOST (not all) CH commands continue to function.  
                         

Using dcecp:

Deleting Master clearinghouse's name:

1. List your cell's /.: dir
2. find out the name of the master clearinghouseuse 
3. use "object delete", dir list /.:
4. dir list /.: and check that the CH name is gone.

In this example the Master CH name is: /.../bronze/bronze_ch

dcecp> object del /.../bronze/bronze_ch
dcecp> clearinghouse del /.../bronze/bronze_ch
Error: Directory must be empty to be deleted
dcecp> clearing creat /.../bronze/bronze_ch
Error: Specified full name already exists


2. Deleteing a secondary clearinghouse's name:

dcecp> clearinghouse create /.:/house_ch
dcecp> dir create /.:/dir1
dcecp> dir create /.:/dir1 -replica -clearinghouse /.:/house_ch
dcecp> directory synchronize /.:
dcecp> object delete /.:/house_ch
dcecp> 					<== SUCCEEDS - No Error or warning
dcecp> dir list /.:
/.../bronze/dir1 /.../bronze/hosts /.../bronze/subsys /.../bronze/bronze_ch
/.../bronze/cell-profile /.../bronze/fs /.../bronze/lan-profile
/.../bronze/sec /.../bronze/sec-v1
dcecp> 					<== /.:/house_ch not in the dir
list

dcecp> dir show /.:/dir1 -replica -clearinghouse /.:/house_ch  <= SUCCEEDS
     <<output>>

dcecp> directory synchronize /.:       
dcecp> delet dir /.../bronze/dir1                               
Error: Replica set of specified directory contains more than one replica
dcecp> dir del /.:/dir1 -replica -clearinghouse /.../bronze/house_ch

dcecp> clearinghouse show /.:/house_ch
Error: Requested entry does not exist
dcecp> clearinghouse delete /.:/house_ch                     
Error: Requested entry does not exist
dcecp> clearinghouse create /.:/house_ch
Error: Specified full name already exists

[5/20/94 public]
There are only three types of entities in cds - directories,objects, and
links. A clearinghouse is in reality an object. It contains attributes
neccesary for maintainence of replica sets but it is an object and can
therefore be removed with the delete object command. Since removing the 
object in this manner does not result in the performance of other internal
operations that would be done through use of the remove clearinghouse 
command the clearinghouse and replica sets will in all likelyhood be
left in a bad way. For this reason removing the clearinhouse object in 
this manner is a very bad thing to do. The clearinghouse is normally
a well protected entity that can be operated on by an administrator
with sufficient rights who would presumably not do this.

I suppose we could put some code in to check that the name of the object
being deleted is not also the name of a clearing house. I'll let Janet
Mccann comment on this. I'm inclined to leave it the way it is in which
case the answer is 'Don't do that'.

[5/20/94 public]
I can agree with the "don't do that" argument.  The question is can we
do anything to make "doing that" a little more difficult.  Even if it is
just a doc issue or the way we set up default ACL's (I guess it would be
the Initial Object ACL in /.: since all clearinghouse's should be in the
root directory).

[5/20/94 public]
Agreed. We'll see what Janet has to say next week.

[8/2/94 public]
I am going to cancel this cause the acl is already set up to
disallow this by a 'normal' user.  cell_admin and cds-admin are given all
access.  The server will recreate the entry if it detects it has been deleted.
This happens in the background thread.



CR Number                     : 10649
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDS unusable
Reported Date                 : 5/16/94
Found in Baseline             : 1.1
Found Date                    : 5/16/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/16/94 public]

Saturday I smoked friday nights builds. More often than not, about
4 out of 5 times I got CDS unusable during configuration. I spent
some time on it but couldn't pin it down. Finally I installed 
baseline 7 and in 2 out of three attempts I got the same problem.
I think it might be a network problem but untill we know more I 
would not advise installing the latest build.

[5/16/94 public]
This is what I saw:

S:****** Configuring initial CDS Server...
S:****** Please wait for user authentication and authorization...



      Create LAN profile so clients and servers can be divided
      into profile groups for higher performance in a multi-lan cell ? (n)  
S:****** Starting cdsadv...
S:****** Starting cdsd...
(rpc) *** FATAL ERROR "(rpc__list_element_alloc) (*list_desc->alloc_rtn)
(element) call failed   at rpclist.c\355 ***
ERROR:   cdscp show dir /.: failing -- CDS not usable
        Press <RETURN> to continue, CTRL-C to exit:

[5/20/94 public]
Turns out this problem was a result of a network problem in our building
that didn't seem to affect other operations. The network problem was 
detected and fixed and the dce problem immediatly went away. This is
HOWEVER bad. I don't believe there is any reason a flaky network should cause
a single machine cell to not work and it certainly shouldn't cause cdsd
to dump core, sooooo the bug remains open. It will not affect the bata
schedule however. The priority is droped to 1 and the fixed by field is
set to 1.1. 

We can reproduce this, at least I did on my 486, by unplugging the ethernet
connection. 

This is what I have on this so far......

On the 486, gdb showed a back trace through rpc_ep_register with valid
arguments that ended up core dumping in malloc. Everyone agrees this is 
due to someone, entity unknown, stomping on malloc's data base. Arguments
to rpc_mem_alloc and presumably malloc were perfectly valid. So there
appears to be a wandering pointer somewhere. The hp didn't seem to hit 
the problem as often but when it did in the debugger it came up with things 
like invaid instruction. This again seems  to point to stomped memory. I 
didn't spend much time working this on the hp so when we get back to it I 
will get more data. 

A nightly build from the night of Monday May 9 did not have the problem 
and the nightly from Friday May 14 did. There were three drops between 
these dates - dts, security, and cds. I was not configuring dts so
its an unlikely candidate. That leaves security and cds. I performed
the following in an attempt at isolating the problem to cds or something
other than cds. I could not simply copy executables or libdce from a working
build into the broken install area since the changes that came in during 
the drops causing the problem are incompatible with the previous builds. 

baseline 8 worked and is here referred to as bl8.
The nighty of Monday May 16 didn't work and is here refered to as nb.

I copied a complete object tree from nb into a sandbox backed by 
the latest source. I then removed all cds objects and copied all cds 
objects from bl8 onto the sanbdbox. I copied all of the cds makefiles 
from the bl8 source tree into the sandbox. This was necessary because 
of some files were outdated between the two builds. I then relinked
libdce and all of the cds executables with the result. Nothing was
recompiled. After installing this libdce and executables in my install 
area which came from nb I configured. It had the cdsd problem. Now this is 
with cds objects objects from a build known not to have the problem and
everything else from a build known to have the problem. It could still be
a timing problem in cds or a changed signature on one side or the other
but at this point I believe the problem is far more likely to be in the
everything else side of the equation, probably security. 

I then reversed the process. I built an install area with nb cds objects 
and bl8 objects for everything else. This time it worked, again pointing the
finger in the direction of everything else.

That's all I have at this point. Now that I know I can reproduce the problem
I don't plan on doing anything with this for the next week or so. At that
time Rajendra and I can put our heads together to see if we can isolate it
further. 

I'll leave the bug assigned to cds and myself a responsible engineer but
I'll add security to the interest list. Anyone on either the security or 
cds side should feel free to investigate further.

[8/15/94 public]
This roblem appears to be gone. cancel.



CR Number                     : 10254
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : Lack of "d" access doesn't prevent deletion of CDS entries
Reported Date                 : 3/30/94
Found in Baseline             : 1.1
Found Date                    : 3/30/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/30/94 public]

Removing "d" access from the CDS entry of an object or a link doesn't
prevent it from being deleted. Thus:

dcecp> dir list /.:/temp -obj
/.:/temp/obj
dcecp> acl mod /.:/temp/obj -e -ch {user cell_admin r--t-}
dcecp> acl show /.:/temp/obj -e
{unauthenticated r--t-}
{user cell_admin r--t-}
{group subsys/dce/cds-admin rwdtc}
{group subsys/dce/cds-server rwdtc}
{any_other r--t-}
dcecp> obj del /.:/temp/obj                <---no error
dcecp> dir list /.:/temp -obj
dcecp>					   <---obj gone

Links behave similarly. Directories are OK (i.e., cannot delete a
directory without "d" access).

[3/31/94 public]
The permissions for deleting an object entry are either delete on the
entry or administer on the directory containing the object. Either will
do. Removing both does cause cdscp to deny permission to delete the
object.



CR Number                     : 10213
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : directory/cds/child
Short Description             : cds_clerkserver_cstub.c compile errors
Reported Date                 : 3/23/94
Found in Baseline             : 1.1
Found Date                    : 3/23/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : cds_clearserver_cstub.c
Sensitivity                   : public

[3/23/94 public]

[ /directory/cds/child at 04:18 (AM) Wednesday ]

xlc -c -Dunix -DDNS_CMA -DDNS_CDS -DDNS_V3API -D_ALL_SOURCE -DDCE_SEC \
 -DDNS_DFS -DDEBUG  -D_ALL_SOURCE -DAIX32   -I. \
 -I/u1/devobj/sb/nb_rios/src/directory/cds/child \
 -I/project/dce/build/dce1.1-snap/src/directory/cds/child \
 -I../stubs -I/u1/devobj/sb/nb_rios/src/directory/cds/stubs \
 -I/project/dce/build/dce1.1-snap/src/directory/cds/stubs -I../includes \
 -I/u1/devobj/sb/nb_rios/src/directory/cds/includes \
 -I/project/dce/build/dce1.1-snap/src/directory/cds/includes \
 -I/u1/devobj/sb/nb_rios/export/rios/usr/include \
 -I/project/dce/build/dce1.1-snap/export/rios/usr/include dcecdsmsg.c
"cds_clerkserver_cstub.c", line 3185.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3266.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3362.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3455.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3539.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
Etc.

[3/23/94 public]

I am cancelling this OT since the RIOS compiler messages above do not flag
problems that break anything in the build and the exact meaning of these
"(E)" is not clearly understood.



CR Number                     : 9901
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cfg
Short Description             : cds always defines a cached server during a split server config
Reported Date                 : 2/7/94
Found in Baseline             : 1.1
Found Date                    : 2/7/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/7/94 public]

When the CDS server resides on a separate host from the 
security server, dce_config will define a cached server
for all of the CDS clients in that cell, even if all the
same machines are on the same lan.

[8/24/94 public]
This does not belong in the config component, so I am reassigning
this to John so he can verify that this is still a problem
or close as being fixed.

[8/24/94 public]
No longer a problem. Canceled.



CR Number                     : 9576
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : cdscp list dir /.:/hosts/* fails from command line
Reported Date                 : 12/6/93
Found in Baseline             : 1.0.3
Found Date                    : 12/6/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[12/6/93 public]

After the cdscp parser change of 10/12/93 for OT3159 and
OT5925, there are some differences between the interactive
parsing of commands from within cdscp and the parsing
of cdscp commands from a single shell command line.
The differences found so far involve the * character.


This first case just doesn't work from the shell command
line.  This is a popular and frequently-used construct.
Scripts using this construct may also be broken.

$ cdscp list dir /.:/hosts/*
/.:/hosts/: No such file or directory
$ cdscp
cdscp> list dir /.:/hosts/*
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:46:53
clarity
cdscp> exit


This second case shows a difference in the interpretation
of the \* construct between command line and interactive use.

$ cdscp list dir /.:/hosts/\*
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:47:39
clarity
$ cdscp
cdscp> list dir /.:/hosts/\*
                        LIST
                   DIRECTORY   /.../hotsite/hosts/*
                          AT   1993-12-02-16:48:00
cdscp> exit


This third case works as expected, and is currently the only
way to get the desired functionality.  This should continue
to work after this bug is fixed.

$ cdscp
cdscp> list dir "/.:/hosts/*"
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:50:42
clarity
cdscp> exit
$ cdscp list dir "/.:/hosts/*"
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:47:29
clarity

[12/06/93 public]

Paul, your shell is giving you the error message because its looking
for a directory named '/.:'. The string isn't getting passed to cdscp.

Running unauthenticated on my system.....

% cdscp show dir /.:
Warning: you have no network credentials. All requests will be
unauthenticated.


                        SHOW
                   DIRECTORY   /.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx
                          AT   1993-12-06-13:16:10
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-11-15-20:14:13.199000100/08-00-09-25-e3-2c
                     CDS_UTS =
1993-11-15-20:14:37.958756100/08-00-09-25-e3-2c
              CDS_ObjectUUID = 3b178644-e1e7-11cc-8933-08000925e32c
                CDS_Replicas = :
          Clearinghouse UUID = 393dd698-e1e7-11cc-8933-08000925e32c
33-08000925e32c
          CDS_ReplicaVersion = 3.0
% cdscp show dir /.:/*
/.:/: No such file or directory

Note that the warning isn't present. This is because cdscp never gets
called by the shell. I find this only happens with the c shell. Running 
with the ksh.....

$ cdscp show dir /.:/*
Warning: you have no network credentials. All requests will be
unauthenticated.


                        SHOW
                   DIRECTORY
/.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx/hosts
                          AT   1993-12-06-13:20:27
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-11-15-20:14:50.315246100/08-00-09-25-e3-2c
                     CDS_UTS =
1993-12-04-12:33:20.043420100/08-00-09-25-e3-2c
              CDS_ObjectUUID = 5136fe50-e1e7-11cc-8933-08000925e32c
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk =
1993-12-04-10:32:53.062581100/08-00-09-25-e3-2c
              CDS_LastUpdate =
1993-12-04-12:33:20.043420100/08-00-09-25-e3-2c
             CDS_RingPointer = 393dd698-e1e7-11cc-8933-08000925e32c
                   CDS_Epoch = 515e71b0-e1e7-11cc-8933-08000925e32c
          CDS_ReplicaVersion = 3.0

                        SHOW
                   DIRECTORY
/.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx/subsys
                          AT   1993-12-06-13:22:05
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-11-15-20:14:45.420387100/08-00-09-25-e3-2c
                     CDS_UTS =
1993-12-04-12:33:19.450244100/08-00-09-25-e3-2c
me = /.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx/subsys
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk =
1993-12-04-10:32:52.629330100/08-00-09-25-e3-2c
              CDS_LastUpdate =
1993-12-04-12:33:19.450244100/08-00-09-25-e3-2c
             CDS_RingPointer = 393dd698-e1e7-11cc-8933-08000925e32c
                   CDS_Epoch = 4e8a045e-e1e7-11cc-8933-08000925e32c
          CDS_ReplicaVersion = 3.0
$

I'm not a c shell user but I'm told that if one enters the following in
their .cshrc the problem is remedied.

set nonomatch

I'll cancel this a bit later if you don;t object.

[10/6/93 public]
cancelled.



CR Number                     : 9514
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : dns_reader() should signal cond. var. on error
Reported Date                 : 11/18/93
Found in Baseline             : 1.0.2a
Found Date                    : 11/18/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : directory/cds/library/dnsread.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/18/93 public]

In the dns_reader() routine of library/dnsread.c, the read failure case,
which is handled in the default clause following the return from the read,
does not signal any waiters on the condition variable. This may leave a
thread hanging in dns_read on a signal that never comes.

Here are context diffs for the change:

     *** /tmp/ci.29496..dnsread.c.29525.1       Fri Oct 22 14:00:52 1993
     --- /tmp/dnsread.c.29525.2 Fri Oct 22 14:00:52 1993
     ***************
     *** 1028,1037 ****
     --- 1028,1041 ----
             */
+	DNS_LOCK {
	   dns_reader_state = reader_rundown;
+	   if (Flags_p) pthread_cond_signal((pthread_cond_t*)&Flags_p->fsOpqDNS[OPQCND0]);
+	} DNS_END_LOCK;
            dns_reader_state = reader_rundown;
            close(dns_clerk_socket);
            dns_clerk_socket = -1;
            dns_pending_cleanup(DNS_SOCKET);
            status = read_none;
            break;
        }
        break;
           }

[5/26/94 public]
Unless this is demonstrated on a running system to find what
the real problem is, I would request that this report be cancelled.
I believe that the Flags_p mentioned is still on the cds_pending_p ring,
and the dns_pending_cleanup() call will cause all requests including
the one controlled by Flags_p to be signalled and terminated.

[6/3/94 public]
The customer (Hitachi) told me that they withdrew this change from their
own source base in Feb this year. Go ahead and cancel this.

[08/20/96 public]
Cancelling.



CR Number                     : 9473
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : Can't delete directory
Reported Date                 : 11/10/93
Found in Baseline             : 1.0.3
Found Date                    : 11/10/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/10/93 public]
After having run the GDS switch tests I was trying to cleanup the CDS
namespace prior and was unable to remove a directory.

  cdscp> list dir /.../c=ie/o=digital/sales
			  LIST
		     DIRECTORY   /.../c=ie/o=digital/sales
			    AT   1993-11-10-14:59:38
  sales
  cdscp> del dir /.:/sales/
  
  cdscp> show dir /.:/sales/sales
  
			  SHOW
		     DIRECTORY   /.../c=ie/o=digital/sales/sales
			    AT   1993-11-10-15:00:07
  Error on entity: /.../c=ie/o=digital/sales/sales
  Requested entry does not exist (dce / cds)
  Function: dnsEnumAttr
  dnsEnumAttr: partial results = /.../c=ie/o=digital/sales

A description of the DCE cell configuration can be found in section 5.6.3
of the DCE1.0.3 Porting Guide (or 5.6.4 of the DCE1.0.2 Porting Guide --
it really didn't change.).  A script is provided below to configure the
GDS cache.  GDS switch tests are found in the dcetest install tree in:

  install/hp800/dcetest/dce1.0/test/directory/xds/tests.switch

Here is the GDS initialization script.  This can be used instead of
instructions provided in the Porting Guide.  To initialize the GDS cache,

	1.  Use gdsyssadm option 'c' to configure 
	2.  Use gdssysadm option 'b' to activate
	3.  Exit gdssysadm
	4.  gdsditadm < <name-of-file-you-saved-the-script-in>

Note: you will need to change the IP address in the script to be that of
the machine on which you are reproducing the defect.

The script:

:******************************************************************************:
:****                                                                     *****:
:**** INITIALIZATION BATCHFILE FOR switch tests                           *****:
:****                                                                     *****:
:****  1. initialize cache of dir ID 1                                    *****:
:****                                                                     *****:
:******************************************************************************:
:**** INITIALIZATION BATCHFILE FOR MACHINE #1   (step 1/4)                *****:
:directory id:1
:password:
:Country:
:Organisation:
:Organisational unit:
:common name:
:options():Logon to the DUA Cache
:****Administration ****:
:Function:1
:****Add Client Address *******:
:Operation:05
:P-Selector:
:S-Selector:
:T-Selector:Client
:Net-address 1:TCP/IP!internet=130.105.5.41+port=21010__________________
:Net-address 2:
:Net-address 3:
:Net-address 4:
:Net-address 5:
:****AddObject  ie/digital/dce/dsa/dsa-m1 *******:
:Operation:01
:Objekttypnummer:07
:country:ie
:organization:digital
:OrganizationalUnit:dce
:Common-Name:dsa
:Common-Name:dsa-m1
:ObjectClass:DSA
:Auxiliary Object class:NO
:Attribute Name1:Presentation-Address
:Attribute Name2:DSA-Type
:Attribute Name3:
:Attribute Name4:
:Attribute Name5:
:More:
:attributName:DSA-Type
:attributwert:default/local'
:attributwert:
:attributName:
:attributwert:
:attributwert:
:attributName:
:attributwert:
:attributwert:
:P-Selector:
:S-Selector:
:T-Selector:Server
:Net-address 1:TCP/IP!internet=130.105.5.41+port=21011___________________
:Net-address 2:
:Net-address 3:
:Net-address 4:
:Net-address 5:
:******** RETURN ******:
:operation:00
:**** Administration ****:
:Function:0

[11/10/93 public]
>  cdscp> list dir /.../c=ie/o=digital/sales
>                          LIST
>                     DIRECTORY   /.../c=ie/o=digital/sales
>                            AT   1993-11-10-14:59:38
>  sales
>  cdscp> del dir /.:/sales/
>
>  cdscp> show dir /.:/sales/sales
>
>                          SHOW
>                     DIRECTORY   /.../c=ie/o=digital/sales/sales
>                            AT   1993-11-10-15:00:07
>  Error on entity: /.../c=ie/o=digital/sales/sales
>  Requested entry does not exist (dce / cds)
>  Function: dnsEnumAttr
>  dnsEnumAttr: partial results = /.../c=ie/o=digital/sales
>
Maybe I missed something, but /.:/sales has been removed and what
was "show dir /.:/sales/sales" (I guss you mean "show dir /.:/sales")
going to show you? If you type "list show dir /.:/sales" 
after "del dir /.:/sales", I believe it'll return nothing.

[11/11/93 public]
The command 
cdscp list dir /.../c=ie/o=digital/sales
will list the directory /.../c=ie/o=digital/sales as sales. If
you want to see what directories currently exist in a directory do
cdscp list dir /.../c=ie/o=digital/sales/*
The delete command is probably telling the truth 
/.../c=ie/o=digital/sales/sales does not exist.



CR Number                     : 9346
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7530
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv won't spawn new clerks
Reported Date                 : 11/3/93
Found in Baseline             : 1.0.3
Found Date                    : 11/3/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/3/93 public]
During today's dfs smoketest, cdsadv would not spawn clerks for non-root
users. A root clerk existed and worked fine. Cdsadv was not built with
debug so attaching useless. Killing and restarting the
cdsadv got rid of the problem so there was no chance to catch
events file. This did not appear to be a "process table full" or
other resource limitation problem since I was able to start other
processes. Assigned to myself - I'll watch for it.

[11/5/93 public]
After rebooting my rios and restarting my dce client, I ran into this
same problem.  I could not get cdsadv to spawn a clerk.  I was running
as root.

Killing and restarting cdsadv fixed the problem.  I too was not built
debug, so I could not attach.  Prior to being rebooted the cleint was
in a dceseact system test for 12 hours.

[11/5/93 public]
Thanks for the update Gerry - so this is not HP-specific then? If you hit
this again, debug or no, can you see if, in your case, this is specific to
root (a clerk that was definitely running at one time) or is it that the
cdsadv won't spawn ANY clerks? Thanks again.

[7/6/94 public]
Not seen since and not enough info in this CR to make it worth keeping
open ... cancelling.



CR Number                     : 9226
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : Inrercell Broken
Reported Date                 : 10/21/93
Found in Baseline             : 1.0.3
Found Date                    : 10/21/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/21/93 public]
cdscp show dir /.../foo.qadce.osf.org
Error on entity /.../foo.qadce.osf.org
Software error detected in server (dce / cds)
Function: dnsEnumAttr

Alan Peckham believes the gdad is at faultand we are looking at it.
.

[10/21/93 public]
After looking at the gda trace, I believe this is user error.
It looks like the gda is not finding any nameserver entries
in /etc/resolv.conf. Thus it is not a bind client.
Now, obviously this should be easier to track down, but...
Please cancel this CR or defer for better error notification
in 1.1.

[10/22/93 public]
It wan't the user error that we thought but it was user error. The name
server wasn;t configured correctly to know about the cells. I'm going to
close this bug but will open another to the effect that we need to visit
the complexity of the bind configuration. Most people here that do this
on a regular basis usually screw something up on the first try. We need 
to make the process simpler or at least have gdad give more information
on what's wrong.



CR Number                     : 9196
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDSSERV/DCECDSACL6 ==> CDSD spin
Reported Date                 : 10/19/93
Found in Baseline             : 1.0.3
Found Date                    : 10/19/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/19/93 public]

In running the system tests CDSSERV/DCECDSACL6 the cell failed because CDSD
went into an infinite loop.  I am attempting to isolate the problem more than
it already is.  I thought earlier that CDSD was in a loop because SECD had
crashed, but that was due to another test.  The loop always seems to start at
about the 5 hour mark.

[10/21/93 public]

It should be noted that this problem only shows up on a RIOS.  Runs on HP
and OSF1 servers have been ok for over 20 hours.

This problem may be an artifact of the CPU time limit set by RIOS machines.
The run we had going last night bombed sometime after the CDSD got to 59
minutes runtime - and the CPU limit was 60 minutes.  This is confusing in
light of the fact that the runs that were spinning were way over that time.
There is another run going now with a 60 year time limit.

[10/21/93 public]

I cancelled this CR because it represents a confusing and buggy behavior of
AIX.  It is NOT a DCE problem.  The problem was that CDSD was hitting the
AIX CPU time limit.  Last night's runs succeeded with a suitably large CPU
time limit.

The AIX bug is that for some reason hitting the time limit under the
conditions created by these two tests caused AIX to put CDSD into an
infinite loop rather than simply terminate it.  Note that the bug (symptom
CDSD spin) was only occurring when CDSSERV was run on some machine other
than the RIOS server, if this is of any help to IBM in fixing this problem.
(DCECDSACL6 has to be run on the server machine.)



CR Number                     : 9071
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7851
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : The limit MAXATTRIBUTE is NOT enfor
ced
Reported Date                 : 10/7/93
Found in Baseline             : 1.0.3
Found Date                    : 10/7/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/7/93 public]
The MAXATTRIBUTE is used as the maximum sizs of an attribute value.
Accordingly, AtomicValue_[tu], Update_[tu], SetMember_[tu], 
MemberValue_[tu], ReplicaPointer_[tu], gdaPointer_[tu], READ_BUF_SIZE,
etc, are bound by this limit. But most serious problem is that this
limit is NOT checked and enforced anywhere! Such as update_dns_build() 
doesn't checks data_p against Update_p which is passed in and assume its
caller does allocate enough memory for Update_p, but unfortunately
its caller doesn't check either. The result is CORE DUMP. And when read
from the cds entry, assumption is MAXATTRIBUTE, so reader allocates
buf[MAXATTRIBUTE] and copy over the attibute value which may have len 
longer than MAXATTRIBUTE, cores dump! For example dacl_get().

The second problem is that limit applies certain restriction. For example,
a acl object associated with a cds directory cannot have more than 75 users
in because otherwise it'll exceeds the max size allowed. this could be
hard for a big organization.

[6/28/94 public]
The clerk does inforce maxattribute.  The dacl_get got through cause it
doesn't use the clerk.  We believe all other cases are handle in the library onbehalf of the server.



CR Number                     : 9065
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv core dumps when no swap
Reported Date                 : 10/7/93
Found in Baseline             : 1.0.3
Found Date                    : 10/7/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/7/93 public]

Using the nightly build available 10/6/93, I configured a 2 machine cell:
RIOS:	core server + fldb exporting lfs aggregate (root.dfs)
HP:	core client + fldb exporting 1 lfs aggregate

I kicked off the dfs.read_write_all.main system test with the data file
indicating 4 users, 2 servers, 2 aggregates.

Almost immediately, the hp (configured with 97 mb of device swap) had NO
swap available - you couldn't fork a process to even reboot the machine.

The cdsadv core dumped - possibly while trying to fork a clerk for one of
the 4 test users.

Assigning to myself since I saved the core dump in a directory that was
blown away by a subsequent smoketest. Please look to see if the code is
missing error handling for failed forks - thanks.

NOTE: a second test run succeeded after rebooting and restarting dce.

[10/08/93 public]
Its not the fork. The code in adver/adver_clerk_event.c......

        if ((newChild->pid = fork()) == -1) {
          sprintf ( opt_string, "adver: can't fork, errno: %d", errno);
#ifdef DNS_CDS
          LogEvent ( &evp, 0, opt_string );
#else
          printf("%s",opt_string);
#endif

          close(cfd);
          unlink(newChild->saddr.sun_path);
          return;
        }

It would have logged the event and waited for the next one. The client
should have come up with the socket error that we see when a clerk failes
to start. Looks like it probably failed to detect a failed malloc. About 
the only thing it can do in this case is call abort. It may not even be
able to right anything meaningfull to the log since doing so would probably
require a malloc. The call to LogEvent could very well have resulted in
an attempted malloc.

[10/08/93 public]
When a system's runing out swap space anything could happen, especially
the current runing process which could die. who should be blamed?, #1
swap space, #2 system, but not the customer i.e runing process. Remember
in OSF/1 system, if you run out swap space, the current runing process
immediately got killed. This is only way to have the swap space back when
you got into that deep hole. A core dump file may help. This bug should 
either be cancelled because wrong target to blame, or low the proority and
severity but you may cancel it by the end.

[10/12/93 public]
Many operating systems cause the memory request to fail rather than
shooting the process outright. This give the app a chance to handle 
the failure if it can. I'm not sure what the advertiser could do in
this case. We arn't even sure where in the advertiser the failure
occurred but it may have been a point at which a wait/sleep/delay could
have helped. I'm going to lower the priority on this but leave it open.
Hopefully during 1.1 cleanup we can look at each malloc in cds, the
number isn't infinite, and determine whether something other than abort 
is possible.Granted in most cases it won't be but.......

[01/17/94 public]
Changing responsible engineer to John. John - if you feel this can't
be handled more gracefully, then go ahead and cancel.

[08/20/96 public]
Cancelling from the recommendations above.



CR Number                     : 8561
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdscp show object
Short Description             : show object fails on preferred clearinghouse
Reported Date                 : 09/07/93
Found in Baseline             : 1.0.3
Found Date                    : 09/07/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[09/07/93 public]

Doing a "cdscp show object /.:/<testdir>/<object>" on a secondary clearinghouse
failed 6% of the time (52,700 failures out of 875,000 attempts).  My test
attempts to show 1000 objects (100 objects on 10 directories) after doing
a "set cdscp preferred clearinghouse /.:/tahiti_ch command".  This test
had never failed before on 1.0.3.  My test does the following:

	cdscp set directory <testdir> to skulk
	cdscp show obj /.:/<testdir>/<object>
	echo "set cdscp preferred clearinghouse /.:/tahiti_ch" > /.cdscpinit
	cdscp show obj /.:/<testdir>/<object>
	rm /.cdscpinit

The configuration being used was:

  hp    = DCE 1.0.3 Nightly Build Available 09/03/93
  i486  = DCE 1.0.3 Nightly Build Available 09/03/93
  rios  = DCE 1.0.3 Nightly Build Available 09/03/93
  pmax  = DCE 1.0.2a Final

  largo (hp)    - SEC Master, CDS Client, DTS Clerk
  west (hp)     - SEC Client, CDS Server, DTS Local Server, dts_ntp_provider
  dce9 (pmax)   - SEC Client, CDS Client, DTS Clerk
  soldier (rios)- SEC Client, CDS Client, DTS Local Server
  tahiti (i486) - SEC Slave, CDS Replica, DTS Local Server
  brandy (hp)   - SEC Client, CDS Client, DTS Clerk

[09/07/93 public]
Cancelled, further investigation showed that the create replica command
had failed during the directory/object setup causing the errors.



CR Number                     : 8492
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsclerk / cdsadv
Short Description             : cdsclerk and cdsadv dumping core
Reported Date                 : 08/20/93
Found in Baseline             : 1.0.3
Found Date                    : 08/20/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[08/20/93 public]

Using the DCE 1.0.3 nightly build available on 08/13/93, the cdsclerk and
cdsadv on the CDS master dumped core.  The cell configuration being used is:

                  dce11 (hp)    - SEC Master, CDS Client, DTS Clerk
                  dce13 (hp)    - SEC Client, CDS Server, DTS Local Server
                  largo (hp)    - SEC Slave, CDS Replica, DTS Clerk
                  west (hp)     - SEC Client, CDS Client, DTS Local Server
                  tahiti (i486) - SEC Slave, CDS Replica, DTS Local Server,
                                  dts_ntp_provider
                  brandy (hp)   - SEC Client, CDS Client, DTS Clerk

There were six tests running, one on each machine, which do show object
commands on the master namespace and then show obj on one of the two replica
namespaces.  The namespace contains 20,000 objects in 20 directories (1000
objects per directory).  I ran this same test on the nightly build available
on 08/06 it did not see this problem.

John Dugas has copies of the cdsclerk and cdsadv cores.

[09/23/93 public]

Cancelled, I haven't seen this problem in the last three builds.



CR Number                     : 8285
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsclerk.h and dnsclerk.h should not be on ILIST
Reported Date                 : 7/15/93
Found in Baseline             : 1.0.2
Found Date                    : 7/15/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/93 public]
The include files cdsclerk.h and dnsclerk.h give the prototypes for
the cds programming interface (cdspi). The cdspi is an unsupported
and undocumented interface used by the dce core components. Both
cdsclerk.h and dnsclerk.h are currently on the ILIST, so they are
installed on customer systems.  Customers will use these routines
and eventually require support for them.  We should either delete
cdsclerk.h and dnsclerk.h from the ILIST, or document and support
this interface.

[07/29/93 public]
I checked with management on this end, Dave Loundsbury in particular, and
the headers stay in the ILIST. Although we do not encourage the use of
the cdspi and those who do use it must be responsible for the consequences
of a change we realize it is being used on occasion.



CR Number                     : 8241
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : doc
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : No error message when removing
a non-existent attribute value.
Reported Date                 : 7/7/93
Found in Baseline             : 1.0.3
Found Date                    : 7/7/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/7/93 public]
Removing a non-existing value from a set-valued attribute gives
no error. I would guess it should say something. 
The pertinent man  page is remove object(8cds) in the Admistration 
Reference Manual.

[07/08/93 public]
Reassigned this CR to Diana Goldfarb.

[10/15/93 public]
The current inplementation by designe does not complain in such situations.
It might be argued that this should be rethougt in a future release but
right now this isn;t a bug. I opened this because someone asked about it
and at the time I wasn;t sure. I don;t remember who asked but if its
brought up again I suppose we'll open an enhancement request and *consider*
it in a future release but for now its canceled.



CR Number                     : 8081
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Administrative tasks in
active namespace creates problems
Reported Date                 : 6/1/93
Found in Baseline             : 1.0.2
Found Date                    : 6/1/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[6/1/93 public]
Our testing lab has an administration test whereby they create 
clearinghouses, add several directories, delete the directories, and
then delete the clearinghouses.  They do this when several other tests
are running, and we have frequently seen database corruption problems.
We have not detailed the problems here, because the problems vary.  

We have told the lab to have the namespace in a quiet state when they
are addind or deleting clearinghouses.  However, the question remains:
Should we be able to do administrative tasks while other application
programs are running using the CDS namespace?  If the answer is 'yes',
and the problems we are seeing should not be happening, then we can
capture more information to add to this defect.  If the answer is
'no,' then the documentation should be modified to state that the cell
should be in a quiesced state before administrative tasts are done.

Test recognizes that the documentation states that a single
Clearinghouse per server is the recommended set-up, but should this be
documented as a stronger restriction?

[8/24/94 public]
You should be able to do administrative tasks as you describe with the
server active.  The only time you need to worry is for a backup.  The
server should be shut down for that.

There was a bug in the database discovered in 1.0.3 (db_btree.c)
See if you can re-create with 1.1

[08/20/96 public]
I'm cancelling this OT since there are no specific problems to fix.
Plus, fixes to OTs 12879, 13208, and 12932 will help in this space.



CR Number                     : 7987
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : control
Short Description             : CDS_LinkTimeout Expiration
displays 1 hour earlier than it is set for
Reported Date                 : 5/12/93
Found in Baseline             : 1.0.2.b23
Found Date                    : 5/12/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/12/93 public]
I create a link to an object, assigning a CDS_LinkTimeout Expiration and
Extension.  I set the directory to skulk, and then show the link.  Some of
the time, the expiration shows as 1 hour earlier than what was set.

For example:

> cdscp create link /.:/jsirkin/dir1/link3 CDS_LinkTarget = \
> /.:/jsirkin/dir1/obj1 CDS_LinkTimeout = \(1993-11-13-10:18:00
365-00:00:00\)

[root@yale:12] /
> cdscp set directory /.:/jsirkin/dir1 to skulk

[root@yale:12] /
> cdscp show link /.:/jsirkin/dir1/link3 CDS_LinkTarget CDS_LinkTimeout

                        SHOW
                    SOFTLINK   /.../xinu.cell/jsirkin/dir1/link3
                          AT   1993-05-12-10:46:17
              CDS_LinkTarget = /.../xinu.cell/jsirkin/dir1/obj1
             CDS_LinkTimeout = :
                  Expiration = 1993-11-13-09:18:00.000-06:
                   Extension = +365-00:00:00.000I-----

[06/16/93 public]
Any idea how to force this condition. I've made several attempts at
replicating it without  success.

[07/29/93 public]
I can't reproduce this now. Cancelled.



CR Number                     : 7937
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Cannot delete an object completely
Reported Date                 : 5/5/93
Found in Baseline             : 1.0.2
Found Date                    : 5/5/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/5/93 public]
Running on B23, I created the directory /.:/jeanne and the object
/.:/jeanne/obj1.  After doing some other things in the directory,
I decided to cdscp del obj /.:/jeanne/obj1, and was given an error
(see output below).  The end result is that I cannot delete the
directory /.:/jeanne, because it is not empty.  A cdscp list obj
returns nothing, but a cdscp list dir returns obj1.  Needless to
say, I can't recreate the object since it's in a "half existance"
state.

> cdscp del obj /.:/jeanne/obj1
Error on entity: /.../xinu.cell/jeanne/obj1
Requested entry does not exist (dce / cds)
Function: dnsDelObj
dnsDelObj: partial results = /.../xinu.cell/jeanne/obj1

[root@yale:2] /
> cdscp del link /.:/jeanne/*
Error on entity: /.../xinu.cell/jeanne/*
Requested entry does not exist (dce / cds)
Function: dnsDelSLink
dnsDelSLink: partial results = /.../xinu.cell/jeanne

> cdscp set dir /.:/jeanne to skulk

[root@yale:2] /
> cdscp show dir /.:/jeanne

                        SHOW
                   DIRECTORY   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:35:37
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-05-05-14:02:49.465112100/10-00-5a-4f-33-bf
                     CDS_UTS =
1993-05-05-14:02:55.755194100/10-00-5a-4f-33-bf
              CDS_ObjectUUID = 0047096e-c909-1be7-9387-10005a4f33bf
                CDS_Replicas = :
          Clearinghouse UUID = 003e367c-8d44-1bd5-a00c-10005a4f33bf
                       Tower = ncacn_ip_tcp:129.35.67.232[]
                       Tower = ncadg_ip_udp:129.35.67.232[]
                Replica type = master
          Clearinghouse Name = /.../xinu.cell/yale_ch
                 CDS_AllUpTo =
1993-05-05-14:35:31.015560100/10-00-5a-4f-33-bf
             CDS_Convergence = medium
           CDS_ParentPointer = :
               Parent's UUID = 00430dfa-8d4c-1bd5-a00c-10005a4f33bf
                     Timeout = :
                  Expiration = 1993-05-05-09:02:49.492-05:
                   Extension = +1-00:00:00.000I0.000
                      MyName = /.../xinu.cell/jeanne
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk =
1993-05-05-14:35:31.015560100/10-00-5a-4f-33-bf
              CDS_LastUpdate =
1993-05-05-14:18:04.817453100/10-00-5a-4f-33-bf
             CDS_RingPointer = 003e367c-8d44-1bd5-a00c-10005a4f33bf
                   CDS_Epoch = 003e0f62-c90c-1be7-9387-10005a4f33bf
          CDS_ReplicaVersion = 3.0

[root@yale:2] /
> cdscp del dir /.:/jeanne
Error on entity: /.../xinu.cell/jeanne
Directory must be empty to be deleted (dce / cds)
Function: dnsDelDir

[root@yale:2] /
> cdscp
cdscp> list dir /.:/jeanne/*
                        LIST
                   DIRECTORY   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:37:10
obj1
cdscp> delete object /.:/jeanne/obj1
Error on entity: /.../xinu.cell/jeanne/obj1
Requested entry does not exist (dce / cds)
Function: dnsDelObj
dnsDelObj: partial results = /.../xinu.cell/jeanne/obj1

cdscp> set dir /.:/jeanne to skulk
cdscp> list obj /.:/jeanne/*
                        LIST
                      OBJECT   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:39:17
cdscp> list dir /.:/jeanne/*
                        LIST
                   DIRECTORY   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:39:24
obj1

[05/05/93 public]
My guess is an acl permission problem.

[05/05/93 public]
Sorry I bounced out of the ot report early. What I meant to say is
that principal jd needs either delete permission to the object or
administer permission to the directory. Note - you need read permission
to do the acl_edits.

jd@eyeball $ dce_login jd -dce-
$ acl_edit /.:/foo -l

# SEC_ACL for /.:/foo:
# Default cell = /.../c=us/o=osf/ou=dce/cn=eyeball_cell
unauthenticated:r--t---
user:cell_admin:rwdtcia
user:hosts/eyeball/cds-server:rwdtcia
user:jd:r--t--a
group:subsys/dce/cds-admin:rwdtcia
group:subsys/dce/cds-server:rwdtcia
any_other:r--t---
$ acl_edit -e /.:/foo/obj1 -l

# SEC_ACL for /.:/foo/obj1:
# Default cell = /.../c=us/o=osf/ou=dce/cn=eyeball_cell
unauthenticated:r--t-
user:cell_admin:rwdtc
user:jd:r-dt-
group:subsys/dce/cds-admin:rwdtc
group:subsys/dce/cds-server:rwdtc
any_other:r--t-
$ cdscp del obj /.:/foo/obj1

[05/05/93 public]
I was running as cell_admin with full permissions.  However, even if I
didn't have the correct acls, it should have completely failed rather than
putting me in the "half deleted" state.



CR Number                     : 7802
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDS database is getting corrupted
via object deletes, resulting in nameserverbug being returned from cdsd.
Reported Date                 : 4/26/93
Found in Baseline             : 1.0.2b22
Found Date                    : 4/26/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/26/93 public]
Our Customer Environment Test (CET) lab has been running into a problem where
when a directory is attempted to be deleted, a "Software Error Detected in
Server" message comes back.  This directory has objects created under it (
usually only one, an RPC server entry) that do not appear to be there any
more due to a cdscp delete operation (the object will not show during a list
operation).  

Upon getting into cdsd via dbx, I noticed that the routine find_entry_pos() 
is returning a position that db_btree_locate_entry_bkt() doesn't like.  The 
node_header record gives a node_count of 1 and the position coming back is 1.  
This condition causes db_btree_locate_entry_bkt() to dereference the 
node_next_p pointer, only to find that it is null.

This generates the nameserverbug error condition.  Upon talking with Alan
Peckham he feels the dummy name (sentinal) is getting stomped.  He and Dave
Griffin have discussed the problem.  I have instructed CET to immediately save
any checkpoint and tlog files the minute this problem occures.  I will then
use cdsdb_dump to check out the operations that have taken place against the
directory in question.

[09/22/93 public]
I can't make this happen. Is it still a problem? Can I get a test case
that reproduces it.

[09/27/93 public]
Not reproducable. cancelled.

[jd 09/28/93 public] 
Set status to cancel...



CR Number                     : 7771
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : control
Short Description             : CDS_Ringpointer problems, it
frequently does not display, or shows wrong value
Reported Date                 : 4/21/93
Found in Baseline             : 1.0.2
Found Date                    : 4/21/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/21/93 public]

CDS_RingPointer is supposed to show the UUID of a clearinghouse containing
another replica of this directory when you do either a show directory or a
show replica.  After creating three clearinghouses on a single cell
machine, creating a directory in one, and replicas in the other two, I run
show dir and show rep with very inconsistent results.

On B22 code, the last time I ran it, CDS_RingPointer did not show up.  If I
specified the attribute, it showed as <empty set> in all three
clearinghouses.  On other tests, repeated calls of cdscp show dir have
intermittent results - sometimes the CDS_Ringpointer will show up, and
sometimes it will not.  

Several times cdscp show dir will result in the CDS_RingPointer displaying
the UUID of the clearinghouse in which the master exists, rather than the
UUID of a clearinghouse which holds a replica.  The cdscp show replica
calls then usually show a CDS_RingPointer of <empty set>

[8/20/93 public]
After some digging I believe the above described behavior is normal. The
CDSPI Technical Suplement says

CDS_RingPointer Used by CDS software. Esists only on the master replica of
                a directory. Coordinates the convergence of distrubuted 
                updates during a skulk. Contains the universal unique 
                identifier (UUID) of a clearinghouse.

Now, if I set cdscp confidence to high I always get a RingPointer. If
I set my preferred clearinghouse to the master replica of the directory
I'm showing I always get a RingPointer. If I set my preferred clearinghouse
to a read only replica of the directory I always get <empty set>. If I
set nither preferred clearinghouse nor confidence equal high I sometimes
get a RingPointer and I sometimes don't. But this is as it should be
because it will depend on whether the request was satisfied from the
master or a replica. 
Cancelled.



CR Number                     : 7599
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : doc
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : Restarting a Clerk/server
wrong in Admin Guide.
Reported Date                 : 3/26/93
Found in Baseline             : 1.0.2
Found Date                    : 3/26/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : admin_gd/directory/cds/7_cds_clerksrvch.gpsml
Sensitivity                   : public

[3/26/93 public]
1.0.1 Administration Guide, Module 3 Section 7.5
The sections 'To Restart a Clerk' and 'To Restart a Server' both 
tell the reader to dce_login as the machine principal. This isn't
possible since the machine principal is given a random password.
One only needs to be running as root on the local machine to 
accomplish either task. This requirement is already met in step 
one so just take out step 2.

[07/06/93 public]
Reassigned this CR to Diana Goldfarb.

[10/11/93 -- verified by Alan Peckham]
The fix was entered in the file and marked "Review,R1.0.2,corrected technical procedure".
I have no changes to make to the existing text.

[10/19/93 public]

This CR was opened against the DCE 1.0.1 Admin. Guide.
The problem was fixed in the DCE 1.0.2 documentation
and appears in the Ed. Services version of the manual.
The fix is also present in the current DCE 1.0.3 source file
for the document. As a result, I am changing the "fixed in" field
to "null" from "1.0.3" and I'm cancelling the bug.



CR Number                     : 7429
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : root cdsclerk hung
Reported Date                 : 3/5/93
Found in Baseline             : 1.0.2b17
Found Date                    : 3/5/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[3/5/93 public]
BUILD:	b17 aka dfs 2.6
CONFIG:	4 pmax cell - 3 fl servers, root.dfs in ufs
TEST:	2 dfs.glue, 1 dfs.lock
By machine:
dce12 = sec,cds,dts,fldb server and file server exporting root.dfs in ufs
glue test (without cache consistency portion enabled) 6 CHO 
/usr/adm/messages contains:
Mar  4 20:18:24 dce12 vmunix: dfs: Warning: the rpc call to server 130.105.201.1
0 in cell dce12_cell timed out.
Mar  4 20:18:25 dce12 vmunix: dfs: dce errors (code 668147713) from the fileset
location server 130.105.202.31 in cell dce12_cell
Mar  4 20:18:49 dce12 last message repeated 7 times
Mar  4 20:21:13 dce12 last message repeated 2 times
Mar  4 20:23:14 dce12 last message repeated 8 times
Mar  4 20:40:41 dce12 last message repeated 16 times
Mar  4 20:48:04 dce12 last message repeated 12 times
Mar  4 20:48:08 dce12 vmunix: dfs: fx server 130.105.202.25 in cell dce12_cell b
ack up!
Mar  4 20:48:14 dce12 vmunix: dfs: dce errors (code 668147713) from the fileset
location server 130.105.202.31 in cell dce12_cell
20:21
Suddenly, it can't find a directory under /:. For the next
20 minutes, tests fail for this reason, then, just as suddenly, it CAN
find the directory under /: and tests start passing for the next 8 minutes.
Then can't find the directory under /: for 6 minutes, then CAN for 5 minutes,
can't for 10 minutes, CAN for 5 minutes, etc.
Due to errors on my part/in my tests, AFTER these problems started
I filled  the ufs partition being exported as root.dfs.
NOW:
dce12 bos status -long indicates that none of the servers has had
to be restarted, there are no core files anywhere nor do the adm logs
show anything. fts commands hang, 
root@dce12> cm statservers
These servers are still down:  osfloan.osf.org, valentine.osf.org.
***********************************************************
dce5 = file server, client for everything else exporting lfs
dfs.lock ran until (oops!) disk quota exceeded
/usr/adm/messages contains:
Mar  4 19:18:58 dce5 vmunix: dfs: server disk quota exceeded
Mar  4 19:19:58 dce5 vmunix: dfs: dce errors (code 668147713) from the fileset l
ocation server 130.105.202.31 in cell dce12_cell
Mar  4 19:19:58 dce5 vmunix: dfs: fileset (0,,10) is not available!
(where 130.105.202.31 = dce12)
NOW:
dce5 bos status -long indicates that none of the servers has had to
be restarted, no core files, adm logs show nothing, fts commands hang,
root@dce5> cm statservers
These servers are still down:  valentine.osf.org.
***********************************************************
valentine = dts, fl server exporting lfs and ufs aggregates
no test running here - merely a client in 3 other tests.
/usr/adm/messages contains:
Mar  4 19:28:15 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 19:30:45 valentine vmunix: dfs: Warning: the rpc call to server 130.105.5
.27 in cell dce12_cell timed out.
Mar  4 19:30:45 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 19:33:51 valentine vmunix: dfs: fileset location server 130.105.201.10 in
 cell dce12_cell back up!
Mar  4 20:25:01 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 20:25:02 valentine vmunix: dfs: dce errors (code 668147713) from the file
set location server 130.105.202.31 in cell dce12_cell
Mar  4 20:25:02 valentine vmunix: dfs: dce errors (code 668147713) from the file
set location server 130.105.202.31 in cell dce12_cell
Mar  4 20:27:31 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 20:27:31 valentine vmunix: dfs: dce errors (code 668147713) from the file
set location server 130.105.202.31 in cell dce12_cell
Mar  4 20:27:32 valentine vmunix: dfs: fileset (0,,7) is not available!
NOW:
valentine bos status -long indicates that none of the servers has had to
be restarted, no core files, adm logs show nothing, fts commands hang,
root@valentine> cm statservers
These servers are still down:  osfloan.osf.org, valentine.osf.org.
***********************************************************
osfloan = dts, fl server exporting ufs aggregate
dfs.glue (without cache consistency) 0.5 CHO
Valentine unable to see osfloan's directory - see /usr/adm/messages
above (osfloan = 130.105.201.10) - then recovers - then osfloan 
has trouble seeing a directory under /: (since dce12 was having trouble)
at 20:20. Like dce12, alternates between being able to see /: and
not until the test fills up the ufs partition.
/usr/adm/messages contains:
Mar  4 20:16:01 osfloan vmunix: dfs: fx server 130.105.202.25 in cell dce12_cell
 back up!
Mar  4 20:18:08 osfloan vmunix: dfs: dce errors (code 668147713) from the filese
t location server 130.105.202.31 in cell dce12_cell
Mar  4 20:18:18 osfloan last message repeated 3 times
Mar  4 20:20:51 osfloan last message repeated 2 times
Mar  4 20:23:11 osfloan last message repeated 8 times
Mar  4 20:40:38 osfloan last message repeated 14 times
Mar  4 20:49:17 osfloan last message repeated 22 times
Mar  4 20:55:57 osfloan last message repeated 26 times
Mar  4 21:10:08 osfloan last message repeated 40 times
Mar  4 21:20:56 osfloan last message repeated 68 times
Mar  4 21:31:02 osfloan last message repeated 165 times
Mar  4 21:41:06 osfloan last message repeated 169 times
Mar  4 21:51:10 osfloan last message repeated 183 times
Mar  4 21:51:18 osfloan last message repeated 3 times
Mar  4 21:51:21 osfloan vmunix: dfs: fx server 130.105.201.10 in cell dce12_cell
 back up!
Mar  4 21:51:21 osfloan vmunix: dfs: dce errors (code 668147713) from the filese
t location server 130.105.202.31 in cell dce12_cell
Mar  4 21:51:21 osfloan vmunix: dfs: fileset (0,,7) is not available!
NOW:
osfloan bos status - long indicates that none of the servers has had to
be restarted, no core files, adm logs show nothing, fts commands hang,
but get slightly further than the others with:
root@osfloan> fts lsfldb
fts: Using unauthenticated connection for cell /.../dce12_cell: auth ticket expired (dce / rpc).
root@osfloan> cm statservers
All servers are running.
*************************************************
Ron and Diane think this may be related to an ftserver hang seen in 2.7.
I can leave this cell up for awhile - let me know if you are interested
in logging in.

[3/5/93 public]
Changed Interest List CC from `vijay@transarc.com' to `pakhtar@transarc.com' 
Changed Responsible Engr. from `pakhtar' to `vijay@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[3/5/93 public]
Lowering the priority to 2 since, realistically, no work will be
done on this unless it is seen again with 2.7 or later drops.
In response to Vijay and Craig (thanks for asking):
	- osfloan's time was off by ~45 minutes! Osfloan was one
	of the flservers and had most likely been the sync site at
	the start of the test - this explains SOME things, sort of -
	unclear why osfloan would be more affected than other pmaxes
	by console printf's and why the remaining 2 flservers couldn't
	get their act together inspite of osfloan ...
	- rpccp show entry /.:/fs output was identical on all 4 machines,
	the FlLogs on all machines indicate that all 3 flservers were
	known at the last time I restarted.
	- udebug output below
	- bos lsadmin /.:/hosts/<hostname> showed dfs-admin present
	on all 3 machines
	- klist's for machine self show refreshes working (good check 
	though ... the core system test people and I have seen the
	fff creds file disappear but not consistently)
Udebug output:
root@osfloan> cd /:
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: fileset (0,,1) is not available!
/:: No such device
root@osfloan> date
Fri Mar  5 13:04:58 EST 1993
root@osfloan> date 03051345
Fri Mar  5 13:45:55 EST 1993
root@osfloan> cd /:
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: fileset (0,,1) is not available!
/:: No such device
root@osfloan> cd /opt/dcelocal/bin
root@osfloan> udebug /.:/fs
root@osfloan> udebug /.:/fs 
root@osfloan> bos restart -server /.:/hosts/osfloan -process flserver -localauthroot@osfloan> udebug /.:/fs -long
Host 130.105.201.10, his time is 0
Vote: Last yes vote for 130.105.5.27 at 0 (sync site); Last vote started at -57
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at 0
Sync host 130.105.5.27 at 0
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -731358502
Server 31.202.105.130: (db 0.0)
    last vote rcvd at 1, last beacon sent at 1, last vote was no
    dbcurrent=0, up=1 beaconSince=1
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -30, last beacon sent at -30, last vote was no
    dbcurrent=0, up=1 beaconSince=1
***********************************************************
root@valentine> udebug /.:/fs
root@valentine> bos restart -server /.:/hosts/valentine -process flserver -localauth
root@valentine> udebug /.:/fs -long
Host 130.105.5.27, his time is 0
Vote: Last yes vote for 130.105.5.27 at -4 (sync site); Last vote started at -16
Local db version is 731358416.1
I am sync site until 86 (3 servers)
Recovery state 1f
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -45
Server 31.202.105.130: (db 731358416.1)
    last vote rcvd at 56, last beacon sent at -1, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
Server 10.201.105.130: (db 731358416.1)
    last vote rcvd at 45, last beacon sent at 0, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
root@valentine> udebug /.:/fs -long
Host 130.105.5.27, his time is 0
Vote: Last yes vote for 130.105.5.27 at -7 (sync site); Last vote started at -7
Local db version is 731358416.1
I am sync site until 83 (3 servers)
Recovery state 1f
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -96
Server 31.202.105.130: (db 731358416.1)
    last vote rcvd at 47, last beacon sent at -8, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
Server 10.201.105.130: (db 731358416.1)
    last vote rcvd at 37, last beacon sent at -8, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
root@valentine> cm statservers
All servers are running.
**************************************************************
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 130.105.5.27 at -64206 (sync site); Last vote started at -64206
Local db version is 731290861.1
I am not sync site
Lowest host 130.105.5.27 at -64206
Sync host 130.105.5.27 at -64206
Sync site's db version is 731290861.1
0 locked pages, 0 of them for write
This server started at -731358365
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -85770, last beacon sent at -85770, last vote was no
    dbcurrent=0, up=1 beaconSince=1
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -85770, last beacon sent at -85770, last vote was no
    dbcurrent=0, up=1 beaconSince=1
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 130.105.5.27 at -5 (sync site); Last vote started at -62
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at -5
Sync host 130.105.5.27 at -5
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -731358522
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -85927, last beacon sent at -138, last vote was no
    dbcurrent=0, up=1 beaconSince=0
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -85927, last beacon sent at -79, last vote was no
    dbcurrent=0, up=1 beaconSince=0
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 130.105.5.27 at -8 (sync site); Last vote started at -63
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at -8
Sync host 130.105.5.27 at -8
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -731358568
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -85974, last beacon sent at -185, last vote was no
    dbcurrent=0, up=1 beaconSince=0
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -85974, last beacon sent at -126, last vote was no
    dbcurrent=0, up=1 beaconSince=0
root@dce12> bos restart -server /.:/hosts/dce12 -proc flserver -localauth
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 255.255.255.255 at -68 (not sync site); Last vote started at -731358866
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at -6
Sync host 130.105.5.27 at -6
Sync site's db version is 0.0
0 locked pages, 0 of them for write
This server started at -731358866
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -6, last beacon sent at -6, last vote was no
    dbcurrent=0, up=1 beaconSince=1
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -6, last beacon sent at -6, last vote was no
    dbcurrent=0, up=1 beaconSince=1
****************************************************************

[3/21/93 public]
Up'ing priority from 2 to 0 - this was an IDLE CELL! 
BUILD:	nb available 3/11/93 (aka DFS 2.8)
CONFIG:	3 pmax cell, 2 flservers, all 3 machines = dfs servers and clients
DETAILS:
	DFS healthy and usable when I left Friday the 19th.
	Cell idle from Friday to today, Sunday the 21st.
	All bosserver processes automatically restarted at 4 in the
	morning on all 3 machines. Since then, unable to achieve quorum.
	Time on the 3 machines differs by 3 seconds .
SYMPTOMS:
	dce5 - dfsbind catatonic, flserver process hung
	dce12 - repserver reporting quorum problem
	valentine - (non-flserver) looks okay
dce12's FlLog looks normal:
93-Mar-21 04:00:13 flserver: log initialized to /opt/dcelocal/var/dfs/adm/FlLog
93-Mar-21 04:00:22 flserver: using default group of /.../dce12_cell/fs
93-Mar-21 04:01:35 flserver: cell dce12_cell, trial ID 134228757,,3182475965, 2
servers.
93-Mar-21 04:01:35 flserver: ready to service requests.
dce5's FlLog doesn't:
93-Mar-21 04:00:19 flserver: log initialized to /opt/dcelocal/var/dfs/adm/FlLog
93-Mar-21 04:00:24 flserver: using default group of /.../dce12_cell/fs
in other words, missing last 2 log messages.
udebug on dce5 produces comm failure:
root@dce5> ./udebug -group  /.:/fs
return code 382312470 from UBIKVOTE_Debug
udebug on dce12 produces odd output:
root@dce12> /opt/dcelocal/bin/udebug -group /.:/fs
Host 130.105.202.31, his time is -1
Vote: Last yes vote for 130.105.202.31 at -9 (not sync site); Last vote started at -9
Local db version is 732473521.13
I am not sync site
Lowest host 130.105.202.31 at -9
Sync host 0.0.0.0 at -732732944
Sync site's db version is 732473521.13
0 locked pages, 0 of them for write
This server started at -732732944
Both flserver machines know about each other:
root@dce12> rpccp show group /.:/fs
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: fileset (0,,1) is not available!
group members:
  /.../dce12_cell/hosts/dce12/self
  /.../dce12_cell/hosts/dce5/self
root@dce5> rpccp show group /.:/fs
group members:
  /.../dce12_cell/hosts/dce12/self
  /.../dce12_cell/hosts/dce5/self
I have an icl.bind and dfstrace dump on dce5 (/opt/dcelocal/var/dfs/adm:
icl.bind.catatonic, dump.catatonic) - sorry, krpc debugging was not turned
on. Stopping and restarting dfsbind did not cure anything. I have NOT tried
restarting the flserver on dce5 because that would just cover up the 
problem. Please take a look at this before the next automatic restart -
Thanks.

[3/22/93 public]
Vijay and I checked the cell out again today. I discovered that the dfsbind
process was catatonic and that rpccp and cdscp requests as root hang (root
cdsclerk) now (not the case yesterday). Vijay discovered that the flserver
was in a loop calling:
	rpc_ns_entry_object_inq_next
Killing the cdsclerk for root caused the flserver to exit with:
93-Mar-22 13:41:19 flserver: ubik_ServerInit(/.../dce12_cell/fs, subsys/dce/dfs-fs-servers) failed: 282110316 (Error with socket (dce / cds))
The flserver process was restarted and succeeded (with a new cdsclerk). The
core file from the hung cdsclerk looked normal (from John Dugas:
Afraid the dump doesn't help much. I ran cdsclerk on the core and found
that the null thread was in the process of checking to see if there is
pending io for any thread.
(gdb) bt
#0  0x73056584 in select ()
#1  0x7321fd70 in cma__io_available ()
This is a pretty reasonable thing for an idl clerk to be doing.
Except that the clerk shouldn't have been idle - there were requests
pending. Vijay noticed that the cdsclerk was NOT gaining any CPU time
- it was in the "U" state (uninterruptible sleeping process). 
Looks like (potentially) a cds or threads bug ... Debug ideas welcome
for the next time this is seen.

[3/22/93 public]
I just wanted to add some of my notes on debugging the above situation. The
flserver process was hung (not looping) at
rpc_ns_entry_object_inq_{begin,next}
compat_get_group_object_uuid
ubik_ServerInit
flserverDriver
The flserver process was accumulating CPU time slowly but all of it was
within rpc_ns_entry_object_inq_begin or rpc_ns_entry_object_inq_next (which 
one of these two I'm not sure). When Gail killed the hung cdsclerk, 
ubik_ServerInit failed with the error 
93-Mar-22 13:41:19 flserver: ubik_ServerInit(/.../dce12_cell/fs, subsys/dce/dfs-fs-servers) failed: 282110316 (Error with socket (dce / cds))
This error was logged by the flserver, and the flserver quit. The bosserver
then restarted a new flserver. The flservers then achieved quorum.
The fact that dfsbind was catatonic, the flserver hung on a rpc_ns call, and
rpccp and cdscp command hung point to the fact that the cdsclerk was unable
to service requests and was hung. 
root  679 1.0 11.6 12.4M 2.78 ?? S Mar 17 180:48.52 /opt/dcelocal/bin/cdsclerk -U root -u 0 -m 0
root 1469 0.0  4.0 9.05M 984K ??  S Mar 21   0:31.42 /opt/dcelocal/bin/flserver
As can be noticed the cdsclerk has been running since Mar 17. The only baffling
part of this scenario is how the rpccp command worked for Gail on Sunday when
the flserver failed to start up on Sunday morning. Based on the facts we have
it is clear that the cdsclerk is responsible for the hang. The flserver is hung
during startup and has not called rpc_server_listen yet. Without this call
made, ubik RPCs cannot be made and so, the process of quorum establishment has
not begun yet. Since there were only two flservers in the cell, quorum could
be achieved which is perfectly normal. Killing the cdsclerk process seemed to
solve the problem with flserver getting a CDS error code, dfsbind moving from
catatonic to normal state, and fts and cd /.:/fs commands working. 
Based on the above notes, I would suggest lowering the priority, and/or
assigning it to the cds folks. One thing that might aid debugging is to 
run "-g" versions of flserver and cdsclerk. This way, we could use a core
dump to find out the state of the process at the time of hang. I noticed
that the flserver binary on dce5 was not built with symbols and the same may
be true of cdsclerk. The other aid would be to get a debugger that can 
attach to running process and be thread aware to get stack back traces of
each thread.

[3/22/93 public]
Thanks for clarifying Vijay. Unfortunately, the OSF/1 ref plat doesn't
support attaching a debugger to a running proc. I've been seeing problems
with CDS in DFS cells (CRs 7530,7307 and 7134) so this may be related/a
dup of those. I've altered the short description, component and responsible
engineer to reflect the CDS portion of the problem. Hopefully someone can
suggest a non-verbose way to trace the root cdsclerk's activites.

[3/23/93 public]
Thanks!
Adding DFS readers to the CC list.
Changed Interest List CC from `pakhtar@transarc.com,jd' to 
 `pakhtar@transarc.com,jd,dce-ot-dfs,cfe,vijay'

[3/23/93 public]
One last piece of information - the original catatonic dfsbind process (ie.
on Sunday) was doing a call to:
	rpc_ns_entry_inq_resolution

Last lines of the icl.bind file were:

time 4.199684, pid 786: helper read: exit code:114
time 4.199684, pid 786: helper read: entry
time 4.199684, pid 786: ProcessRequest: entry
time 4.199684, pid 786: do_auth_request: entry
time 4.340364, pid 786: do_auth_request: exit code:0
time 4.340364, pid 786: ProcessRequest: exit code:0
time 4.340364, pid 786: helper write: entry
time 4.359894, pid 786: helper write: exit code:786
time 4.367706, pid 786: helper read: exit code:794
time 4.367706, pid 786: helper read: entry
time 4.367706, pid 786: ProcessRequest: entry
time 4.367706, pid 786: do_auth_request: entry
time 4.480980, pid 786: do_auth_request: exit code:0
time 4.480980, pid 786: ProcessRequest: exit code:0
time 4.480980, pid 786: helper write: entry
time 4.512228, pid 786: helper write: exit code:387
time 286.202312, pid 786: helper read: exit code:23
time 286.350740, pid 786: helper read: entry
time 286.397612, pid 786: ProcessRequest: entry
time 286.471826, pid 786: sec_id_parse_name: entry name=/.../dce12_cell
time 286.780464, pid 786: sec_id_parse_name: exit code:0
time 286.819524, pid 786: dfs_GetJunctionName: entry
time 288.678923, pid 786: dfs_GetJunctionName: exit code:0
time 288.678923, pid 786: rpc_ns_entry_inq_resolution: entry

[3/25/93 public]
Downgrading to a "2" until seen again. Using single cdsclerk setup to
catch problem next time with debug info.

[09/27/93 public]
This wasn;t seen throughout the 1.0.2 system test cycle and we can;t
reproduces it now. Cancelled.



CR Number                     : 7307
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : Unable to see namespace after reboot
Reported Date                 : 2/22/93
Found in Baseline             : 1.0.2
Found Date                    : 2/22/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/22/93 public]

Low priority since I haven't seen this before and doubt I'll see it
again soon ...

BUILD:	nb available 2/17
CONFIG:	3 pmax cell, 1 = sec+cds server, all 3 = fl servers and dfs clients
DETAILS:
Config cell successfully (btw, all 3 on different subnets). Reboot the pmax
that happens to house root.dfs. Unable to bring up the file exporter after
the reboot:

fxd -mainprocs 7 -admingroup subsys/dce/dfs-admin 
fxd: can't get the DFS junction name for cell /.../dce12_cell: entry not found (dce / rpc)

All cdscp show attempts fail as well:
cdscp show dir /.:

                        SHOW
                   DIRECTORY   /.../dce12_cell
                          AT   1993-02-22-06:00:19
Error on entity: /.../dce12_cell
Requested entry does not exist (dce / cds)
Function: dnsEnumAttr
dnsEnumAttr: partial results = %x000000000000000000000000000000000000

Stop and restart sec + cds daemons with an events file for cdsadv and
cdsclerk.

Here's what they contain after 2 attempts to list dir /.:/hosts/* (unauth
and auth) and the above show dir attempt.

(Feel free to cut them down to the useful portions)

CDSADV.LOG
----------------------------------------------------------------------

Unloading cache
Kill pid 26890
Kill pid 26870
 >InitEvent()
 <InitEvent() return(1)
 >dnsInitAdver()
 >CAInitLocks
 >InitiateTimer(1)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <InitiateTimer(1) return(1)
 >InitiateRandomTimer(0)
 >RandomizeInterval()
 <RandomizeInterval()
 >InitiateTimer(0)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <InitiateTimer(0) return(1)
 <InitiateRandomTimer(0)
 <dnsInitAdver() return(1)
 >adver_rpc_start()
 >dthread_lock(0x10071178)
 >dthread_create(,0x10000470,0x410a54,0x10072200)
 >th_birth(0x410a54,0x10072200,268436592->(adver_rpc_thread,0))
 <th_birth(0x410a54,0x10072200,0x10000470->(adver_rpc_thread,0)) return(0x10070930)
 <dthread_create(0x10070930,0x10000470,0x410a54,0x10072200) return(282107905)
 >dthread_unlock(0x10071178)
 <adver_rpc_start() return(0x10072200)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >dthread_create_mutex()
 >dthread_create_condition()
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
><dthreads: switch to 0x10070930->adver_rpc_thread
 >adver_rpc_thread() return(0x00000000)
 >dthread_lock(0x10071178)
 >dthread_signal(0x100711b8)
 >dthread_unlock(0x10071178)
><dthreads: switch to 0x10070030->main
  GetNextEvent() 0=select(256,00000000000001011,0,00000000000000011)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetTimeEvent(0)
 >CancelTimer(0)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <CancelTimer(0)
 <GetTimeEvent(0,0x10001008->ETdnsSolicit)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <GetNextEvent() return(0x10001008->ETdnsSolicit)
 >ProcessEvent(0x10001008->ETdnsSolicit)
 >dnsSolicit(0x10001008->ETdnsSolicit)
 >cds_bind(7fffe6b8,)
 <cds_bind(7fffe6b8,) return(TRUE) protseq(ncadg_ip_udp)
 <dnsSolicit(0x10001008->ETdnsSolicit)
 >ProcessEvent(0x10001008->ETdnsSolicit) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
><dthreads: switch to 0x10070a30->*foreign*
 >cds_Solicit_s()
 >cds_SendAdvertisements()
 >dthread_create_mutex()
 >dthread_create_condition()
 >dthread_lock(0x100715f8)
 >dthread_unlock(0x100715f8)
 >dthread_lock(0x100715f8)
 >dthread_signal(0x10071638)
 >dthread_unlock(0x100715f8)
 <cds_SendAdvertisements()
 <cds_Solicit_s()
 >cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 <cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 >cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 <cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 >cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 <cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 <cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 >cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 <cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 <cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 >cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 <cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
><dthreads: switch to 0x10070030->main
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >GetConnectEvent(000000000000000100000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetConnectEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(1)
 >GetConnectEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetConnectEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >GetConnectEvent(000000100000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetConnectEvent(000000100000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 >newSocket()
 >GetSockName(7)
 <GetSockName(7,/opt/dcelocal/var/adm/directory/cds/dssS0) return(1)
 <newSocket()
 >dthread_create_mutex()
 >dthread_lock(0x100718f8)
 >dthread_unlock(0x100718f8)
  BindChildDssd() exec(/opt/dcelocal/bin/cdsclerk) for(0,1) name(/opt/dcelocal/var/adm/directory/cds/cdsclerk_26970_root)
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
><dthreads: switch to 0x10070a30->*foreign*
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 >cds_Solicit_s()
 >cds_SendAdvertisements()
 >dthread_lock(0x100715f8)
 >dthread_unlock(0x100715f8)
 >dthread_lock(0x100715f8)
 >dthread_signal(0x10071638)
 >dthread_unlock(0x100715f8)
 <cds_SendAdvertisements()
 <cds_Solicit_s()
 >cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 <cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 >cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 <cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 >cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 <cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 >cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 <cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 <cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 >cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 <cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 >cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 <cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 >cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 <cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 >cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 <cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 >cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 <cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 >cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 <cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 >cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 <cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 <cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
><dthreads: switch to 0x10070030->main
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000[gmd 8/13/93 public]
Well - wouldn't ya know - I HAVE seen this problem again! I logged it
separately as a "need cdscp define cached server" bug months later when
I discovered that solved the problem but apparently that one was closed
after Ed Perkins did some testing and couldn't reproduce it (without
DFS - although it seems unrelated to DFS). The steps to reproduce this are:

	- config with cds server on one subnet, dfs machine (client or server)
	on another

	- shutdown -r dfs machine
	- sh -x /etc/rc.dce and sh -x /etc/rc.dfs
.
.
.
dfsd: All DFS daemons started.
root@claus> dfsexport
dfsexport: /dev/rz3c, ufs, 3, 0,,7
dfsexport: /dev/rz1c, lfs, 2, 0,,0
root@claus> fts crmount -dir /:/claus.u3 -fileset claus.u3
fts: DFS junction for cell '/.../dce12_cell.qadce.osf.org' not found: entry not found (dce / rpc).

root@claus> cdscp show dir /.:

                        SHOW
                   DIRECTORY   /.../dce12_cell.qadce.osf.org
                          AT   1993-08-13-14:11:22
Error on entity: /.../dce12_cell.qadce.osf.org
Requested entry does not exist (dce / cds)
Function: dnsEnumAttr
dnsEnumAttr: partial results = %x000000000000000000000000000000000000

root@claus> ping claus           
PING claus.qadce.osf.org: (130.105.201.9): 56 data bytes

root@claus> ping dce12
PING dce12.qadce.osf.org: (130.105.202.31): 56 data bytes
root@claus> cdscp dump clerk cache

CACHED DIRECTORIES*****************************************************

CACHED CLEARINGHOUSES**************************************************

CACHED ATTRIBUTE VALUES************************************************

CACHED USERS***********************************************************


Somehow, the cache is getting cleared when I do a shutdown -r on pmax. If
this doesn't happen on the 103 reference platforms, probably not an issue.

[9/15/93 public]
Gail, please let me know while you reproduce it. We may need your cell
to work on it. Thanks.

[9/21/93 public]
Unable to reproduce. Rebooted numerous times with the following config:

shades = 486 on subnet 5:

        CELL:   shades_cell
        CONFIG: sec, cds, dts server, dfs client
        BUILD:  1.0.3 build available 9/13/93

dce13 = hp on subnet 201:

        CELL:   shades_cell
        CONFIG: sec, cds, dts client, fl server
        BUILD:  1.0.3 build available 9/13/93

Canceling.



CR Number                     : 7162
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd hangs after a session of
abuse.
Reported Date                 : 2/8/93
Found in Baseline             : 1.0.2b14
Found Date                    : 2/8/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[2/8/93 public]

Running "abuse" on a two machine cell (one CDS Server, and one Security Server) 
ends with a "No Errors Detected" message, at which time a "cdscp del clear" is
attempted and the CDS server fails to respond.  While several other operations
seem to work (list, show, etc.) it is impossible to delete an existing
clearinghouse, or create a new one.

Upon an attempt to perform a set dir /.: to new epoch (in order to restore
some order to cds), cdsd dumped a partial core file.  We will attempt to get
a decent core file and annotate this OpenTrack with more information.

[2/23/93 public]
Ed - I have been asked to look into this problem. It would seem to me
that this problem is a hung or dying thread. The information that would
(hopefully) help to isolate the problem would be to kill the server
before the "del clear" and restart with event tracing turned on.
Hopefully the bug won't go away by the stop/start. I will be at
(508)597-0942 on 2/24, otherwise at (508)486-7217.

[3/2/93 public]
Lowered the severity to B2.
Changed Priority from `1' to `2' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[10/13/93 public]
This bug has nothing (or at least now) to do with abuse test.
The problem with cannot-create-delete-clearinghous is that 
you're NOT allowed to create or delete a clearinghouse on a
host which has not cdsd running. I tried both ways (with and
whitout) abuse run first. You can create/delete clearinghouse
on server host not client host. But if you create a secondary
server on client host you're able to do so on this client host
too. The code is written this way in cprpc_server.c to call
cprpc_get_binding_handle() with ch_fullname_p = (cds_FullName_t *)0
which means go get a local binding for me. Concel by now.



CR Number                     : 7134
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdscp /.: fails
Reported Date                 : 2/4/93
Found in Baseline             : 1.0.2
Found Date                    : 2/4/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/4/93 public]

BUILD:	nb available 1/29/93 (= b14)
CONFIG:	2 pmax cell with dfs

problem on client pmax:

cdscp show dir /.:
returns Entry not found
partial results

after cell had been idle 2 - 3 days

different dce_login status and other unix ids all fail.

[2/5/93 public]
Need more information. Stack trace from cores, clerk and server logs...
Please reproduce. Is this problem occurring on other platforms?

[2/5/93 public]
Yes - it was a short description - snoopy was being taken down. 
More facts:
	* no core files anywhere
	* same command (cdscp show dir /.:) works fine on the server
	* even new cdsclerks have the same problem
	* I have not seen this before but am curious if some
	dfsbind problems we've been seeing are related.

Here's a clerk log produced by killing the root clerk, creating the
cdsclerk.events file and doing a cdscp show dir /.:

(feel free to chop it down to a useful size)


  main() using cache(0)
 >dthread_create(,0x100000c8,0x4013ec,0x7fffeaf0)
 >th_birth(0x4013ec,0x7fffeaf0,268435656->(signal_catcher,0))
 <th_birth(0x4013ec,0x7fffeaf0,0x100000c8->(signal_catcher,0)) return(0x100725b8)
 <dthread_create(0x100725b8,0x100000c8,0x4013ec,0x7fffeaf0) return(282107905)
 >start_listener(0x7fffeaf0->)
 >dthread_create(,0x10000090,0x402544,0x7fffeaf0)
 >th_birth(0x402544,0x7fffeaf0,268435600->(clerk_listener,0))
 <th_birth(0x402544,0x7fffeaf0,0x10000090->(clerk_listener,0)) return(0x100726b8)
 <dthread_create(0x100726b8,0x10000090,0x402544,0x7fffeaf0) return(282107905)
 <start_listener(0x7fffeaf0->) return(TRUE)
 >dthread_lock(0x10077208)
 >dthread_wait(0x10077288,0x10077208)
><dthreads: switch to 0x100726b8->clerk_listener
 >clerk_listener()
 >dthread_handler_push(0x1002e9f8->0x402c4c(0x7fffeaf0))
 <dthread_handler_push(0x1002e9f8->0x402c4c(0x7fffeaf0))
 >dthread_import_fd(3)
 <dthread_import_fd(3)
 >dthread_lock(0x10077208)
 >dthread_broadcast(0x10077288)
 >dthread_unlock(0x10077208)
 >dthread_accept(3,0x1002ea10,0x1002e798->106)
 <dthread_accept(3,0x1002ea10,0x1002e798->16) return(5)
 >start_client(0x7fffeaf0->,5)
 >dthread_create_mutex()
 >dthread_create_condition()
 >dthread_lock(0x10077208)
 >dthread_unlock(0x10077208)
 >dthread_create(,0x10000080,0x404470,0x100727b8)
 >th_birth(0x404470,0x100727b8,268435584->(clerk_client,0))
 <th_birth(0x404470,0x100727b8,0x10000080->(clerk_client,0)) return(0x100728b8)
 <dthread_create(0x100728b8,0x10000080,0x404470,0x100727b8) return(282107905)
 <start_client(0x7fffeaf0->,5) return(TRUE)
 >dthread_accept(3,0x1002ea10,0x1002e798->106)
><dthreads: switch to 0x100720b8->main
 >dthread_timed_wait(0x10077288,0x10077208,05-feb-1993 19:20:12.4594039)
><dthreads: switch to 0x100728b8->clerk_client
 >clerk_client(0x100727b8->5)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_handler_push(0x10046a48->0x406e20(0x100727b8))
 <dthread_handler_push(0x10046a48->0x406e20(0x100727b8))
 >read_request(5)
 >dthread_read(5,0x100727e4,54)
 <dthread_read(5,0x100727e4,54) return(54)
 >dthread_read(5,0x100729b8,118)
 <dthread_read(5,0x100729b8,118) return(118)
 <read_request(5) 172=read()
 >dthread_lock(0x10077308)
 >dthread_create(,0x10000088,0x404dbc,0x100727b8)
 >th_birth(0x404dbc,0x100727b8,268435592->(clerk_request,0))
 <th_birth(0x404dbc,0x100727b8,0x10000088->(clerk_request,0)) return(0x10072ab8)
 <dthread_create(0x10072ab8,0x10000088,0x404dbc,0x100727b8) return(282107905)
 >dthread_detach(0x10072ab8->clerk_request)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_lock(0x10077308)
 >dthread_handler_push(0x100467d8->0x40365c(0x100727c4))
 <dthread_handler_push(0x100467d8->0x40365c(0x100727c4))
 >dthread_wait(0x10077348,0x10077308)
><dthreads: switch to 0x10072ab8->clerk_request
 >dthread_create_mutex()
 >dthread_create_condition()
 >dthread_lock(0x10077308)
 >dthread_unlock(0x10077308)
 >clerk_request(0x100727b8->5)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >clerkEnumerateAttributes()
 >sendToWalkTree(/.../dce5_cell)
 >clerk_WalkTree(/.../dce5_cell)
 >CAResolveName(/.../dce5_cell)
 >CALock
 <CALock
 >CAResolveName(FILE:/opt/dcelocal/var/security/creds/dcecred_ffffffff,0,/.../dce5_cell,)
 >CAFindLink(/.../dce5_cell,12)
 <CAFindLink(/.../dce5_cell,12) return(0)
 <CAResolveName(FILE:/opt/dcelocal/var/security/creds/dcecred_ffffffff,0,/.../dce5_cell,00000000-0000-0000-0000-000000000000) return(0)
 >CAUnlock
 <CAUnlock
 <CAResolveName(/.../dce5_cell)
 >ChooseInitCh(,/.../dce5_cell)
 >CALock
 <CALock
 >CAFindDir(/.../dce5_cell,6)
 <CAFindDir(/.../dce5_cell,6) return(0)
 >CAFindDir(/...,17)
 <CAFindDir(/...,17) return(0)
 >CAFindDir(/,20)
 <CAFindDir(/,20) return(0)
 <ChooseInitCh(,00000000-0000-0000-0000-000000000000) return(0)
 >CAUnlock
 <CAUnlock
  clerk_WalkTree looking for (00000000-0000-0000-0000-000000000000)
 <clerk_WalkTree(/.../dce5_cell)
 <sendToWalkTree(/.../dce5_cell)
 <clerkEnumerateAttributes() status(282108916)
 >dthread_lock(0x10077308)
 >dthread_unlock(0x10077308)
 >dthread_write(5,0x10086188,16)
 <dthread_write(5,0x10086188,16) return(16)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_lock(0x10077308)
 >dthread_wait(0x10077348,0x10077308)
><dthreads: switch to 0x100728b8->clerk_client
 >dthread_handler_pop(0x100467d8->0x40365c(0x100727c4),0)
 <dthread_handler_pop(0x100467d8->0x40365c(0x100727c4),0)
 >dthread_unlock(0x10077308)
 >read_request(5)
 >dthread_read(5,0x100727e4,54)
 <dthread_read(5,0x100727e4,54) return(0)
 <read_request(5) 0=read() errno(0)
 >dthread_setcancel(0)
 <dthread_setcancel(0) return(1)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_wait(0x10077348,0x10077308)
><dthreads: switch to 0x10072ab8->clerk_request
 >dthread_unlock(0x10077308)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_delete_condition(0x10086144)
 >dthread_delete_mutex(0x10086048)
 <clerk_request(0x100727b8->5) return(0)
 >dthread_exit(0x0) thread(0x10072ab8->clerk_request)
  th_death(0x10072ab8->clerk_request)
><dthreads: switch to 0x100728b8->clerk_client
 >dthread_unlock(0x10077308)
 >dthread_setcancel(1)
 <dthread_setcancel(1) return(0)
 >dthread_handler_pop(0x10046a48->0x406e20(0x100727b8),1)
 >link_free(100727b8)
 >dthread_lock(0x10077308)
 >dthread_close(5)
 <dthread_close(5) return(0)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_lock(0x10077208)
 >dthread_broadcast(0x10077288)
 >dthread_unlock(0x10077208)
 >dthread_delete_mutex(0x100727c4)
 >dthread_delete_condition(0x100727dc)
 >dthread_detach(0x100728b8->clerk_client)
 <link_free(100727b8)
 <dthread_handler_pop(0x10046a48->0x406e20(0x100727b8),1)
 <clerk_client(0x100727b8->5) return(0)
 >dthread_exit(0x0) thread(0x100728b8->clerk_client)
  th_death(0x100728b8->clerk_client)
><dthreads: switch to 0x100720b8->main
 >dthread_timed_wait(0x10077288,0x10077208,05-feb-1993 19:20:12.4594039)

[2/8/93 public]
Raising the Severity to A since rebooting and restarting DCE does NOT
solve the problem.

[2/25,93 public]
Thanks for the clerk log. It is obvious from the log and your description
that there is a broadcast problem. The above clerk has no clearinghouses
in its cache and has nowhere to go, yet there is a healthy server on the
LAN accessable by the node-local clerk. Peter Keegan says that he has seen
situations where local netmasks are broken.
Try the "cdscp define cached server" command to directly enter the server
into the cache. Look at your configuration. If there is nothing obvious,
we can try turning logging on both the client advertiser and the server
advertiser to see whether it is a transmit or receive problem.

[2/25/93 public]
Thanks Alan. I have not seen this problem again so I am lowering the priority
for now.

[07/08/93 public]
Hasn't beem any activity on this since the above. I'm going to
assume the problem was a network glitch. Canceled.

[7/16/93 public]
Unless this bug can be reproduced with the logging requested by
Alan Peckham, above, this bug should be closed.



CR Number                     : 7114
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : rc.dce
Short Description             : Unable to restart CDS
Reported Date                 : 2/3/93
Found in Baseline             : 1.0.2
Found Date                    : 2/3/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[2/3/93 public]
It isn't clear if this needs to be addressed by CDS or the configuration
mechanisms... I'll describe the symptoms:
 
On an AIX machine, running b6 core components,  the machine
was running successfully. Upon rebooting the machine, CDS wouldn't start,
thereby causing a cascade of startup failures for other components including
DFS. Several reboot attempts failed to fix the problem, but served to
identify CDS as the cause of failures.
 
Finally, removing
/opt/dcelocal/etc/cdscache.shmid 
and rebooting permitted the entire system to come up correctly.
 
Either the startup scripts need to clean up appropriate state, or CDS
isn't starting correctly in some circumstances.
 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[2/9/93 public]
It's not a dfs defect.  As Pervaze says, it may be viewed as a CDS defect
or a startup-script defect.  Let's start with it as a CDS problem.
Changed Component Name from `dfs' to `cds' 
Filled in Interest List CC with `cfe@transarc.com'

[2/12/93 public]
I had similar problems starting up the cdsadv on clean machines (ie.
no old shared memory segments, dce had NOT been started since the last reboot)
 
sh -x /etc/dce.rm
rm -rf /opt/dce*
ksh /etc/dce_config -> install and config a pmax
 
During dce_config, cdsadv complained that it:
 
Can't initialize shared memory cache 
Cannot auto-enable clerk
 
These same error messages appeared on both
machines, one was being configured as a dce server, the other as a dce
client to a healthy rios dce server.
 
My pmaxes were both running b14 efsvmunix for kernels, but I was installing
and configing b15 so I rebooted with the b15 efsvmnunix and
tried both again - voila! - all is well now.

[06/08/93 public]
Changed "Fix By Baseline" field from 1.0.2 to 1.0.3.
Changed Interest List CC from `cfe@transarc.com rsarbo@osf.org' to 
 `cfe@transarc.com, rsarbo@osf.org, bww@transarc.com'

[9/15/93 public]
Cannot reproduce this bug on dce1.0.3 code base. 
The /opt/dcelocal/etc/cdscache.shmid should not be a reason because cdsadv is
going to get a new shared memory region and if there is a cdscache.shmid
left over it is going to remove the existed shm key and this cdscache.shmid 
and write a new one. Cancel this bug by now.



CR Number                     : 6853
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : mx300
S/W Ref Platform              : sinix
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : inconsistent error message on 'delete clearinghouse'
Reported Date                 : 1/15/93
Found in Baseline             : 1.0.2
Found Date                    : 1/15/93
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/15/93 public]

Set up the a clearinghouse with the following acl:

	unauthenticated:r----
	user:000003F8-F0BB-21CB-8300-0000C0365F52:-w---
	group:subsys/dce/cds-admin:rw-tc
	group:subsys/dce/cds-server:rw-tc
	any_other:r----

and then issue:

	cdscp delete clearinghouse

command.  The error message returned is:

	Failure in routine: cp_clrdel_clh; code = 282108909
	Insufficient rights to perform requested operation (dce / cds)

This is different than other permission problem error message.  For
example, most other problems print out something like:

	Error on entity: /.../psycho.cells.sni-usa.com/dacl_delete_anyother_13070/dacl_deletes
	Insufficient rights to perform requested operation (dce / cds)
	Function: dnsDelDir

[12/13/93 public]
The second message results from an error status being returned by one
of the cdspi functions while the first is the result of failure being
detected in some other function. The kind of information in hand at the
time of a cdspi failure is more or less predictable and a special error
message routine is called to put out what you see in the second message.
The first message on the other hand is a best effort notification of
a condition at the time of failure. The information in hand is by nature
unpredictable and the message routine in intentionaly simple minded.
I investigated the possibility of improving the exiting mechanism and
concluded any worthwhile change would involve substantial changes to
the exiting code. Since the 1.1 servicability package will replace the
existing mechanism, and hopefully rid the code of the above
inconsistancies, we will forego any changes for 1.0.3.



CR Number                     : 6819
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : doc
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : port_gd
Short Description             : the documentation on
cp_test.sh and cdstest is seriously lacking
Reported Date                 : 1/13/93
Found in Baseline             : 1.0.1
Found Date                    : 1/13/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[1/13/93 public]

	The porting and testing guide Section 4.5.2 is too simple. It only
	gives a man page for cp_test.sh. A lot of why and when are not
	there. For example, why do we have "-noshow" and "-nodeldir"
	switches,  when to use them, etc.

	Also nothing is mentioend about cdstest.c

[8/13/96 public]

Cancelled--Porting Guide no longer exists.



CR Number                     : 6196
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cds/library/cdspi function
Short Description             : CDSPI - cdsCreateObj() converts attribute CDS_ClassVersion value
Reported Date                 : 11/24/92
Found in Baseline             : 1.0.1
Found Date                    : 11/24/92
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/24/92 public]

One Line Description:

        CDSPI - cdsCreateObj() converts attribute CDS_ClassVersion value

Full Description:

        Supplying a very large or very small value to the
        CDS_ClassVersion attribute on the cdsCreateObj() function
        will convert it to some small value.

        Class version values will converts like the following
        (in v.n format):
            -1.9999999999999999         to   255.255
            -11111111111111.300         to   0.44
            1000000000000.300           to   255.44
            1000.-100000000000000       to   232.0
            -24599999999.-1009999999999 to   0.0

        In CDSCP, if specify a value outside of range 0-255 for the
        version major or minor number, an object without the
        CDS_Class and CDS_ClassVersion attribute will be created.

        There is a limit ( zero to 255 ) to the value of v.n and
        this is not documented.  To the administrator, it would be
        unacceptable if these values were lost without warning.
        This limit exists because both the version major and version
        minor value are of type 'unsigned char'.  At the minimum, some
        warning message should be provided when these attributes are
        omitted.

Proposed Solution:

        Error checking should be done by CDSCP, warning message should
        be given when value is lost and this (the limits) must be
        documented.

[12/8/92 public]
Changed Sev/Pri as per OSF reclassification.

[9/22/93 public]
This bug is somewhat confusing. The "One Line Description" claimed that
CDSPI: cdsCreateObj converted attribute CDS_ClassVersion value wrong. But
CDSPI is private API which is not exported and the value check is supposed
to be done on upper layer not CDSPI/cdsCreateObj(). The "Full Description"
claimed that cdscp doesn't check the value (major or minor number) which is
never happened. The cdscp parser does check to make sure the values are in

[0-255]. The checking is done by cdscp parser and if a out-range value is 
detected whole process is gone off.  Cancel this non-bug!



CR Number                     : 6155
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : Wrong error message when
setting CDS_InCHName attribute of a directory.
Reported Date                 : 11/19/92
Found in Baseline             : 1.0.2b5
Found Date                    : 11/19/92
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/19/92 public]

Full Description:

        Setting the CDS_InCHName attribute to false (from true) of
        a directory that contains a child directory whose
        CDS_InCHName attribute is true returns error message:

            "Error on entity: /.../TLBDS4MEcell/dir1
             Directory must be empty to be deleted (dce / cds)
             Function: dnsDisallowCH                           "

        This error message is incorrect since no delete operation is
        performed.  The error message should indicate that all its
        descendants must not have the ability to store clearinghouse
        names.

Repeated By:

        from the CDSCP prompt, enter

              cdscp>  create dir /.:/dir1
              cdscp>  set    dir /.:/dir1 CDS_InCHName = true
              cdscp>  create dir /.:/dir1/dir2
              cdscp>  set    dir /.:/dir1/dir2 CDS_InCHName = true
              cdscp>  set    dir /.:/dir1 CDS_InCHName = false
              Error on entity: /.../TLBDS4MEcell/dir1
              Directory must be empty to be deleted (dce / cds)
              Function: dnsDisallowCH

              cdscp>

Proposed Solution:

        Change the error message in the code to reflect the nature of
        the error more accurately.

[11/24/92 public]
(Proxy for Dave Griffin)
This is a design bug -- a new error code will have to be invented.   I don't
see any alternative mappings for the error that are any better than NotEmpty
(what it uses right now).

[8/9/93 public]
The fix is to add a new error code to dns[cds]msg.msg though. But the
attribute is going to go away in 1.1. So defer this one to 1.1.

[8/9/93 public]
Since this bug is going to be cancelled in 1.1. We decided to cancel
it now instead of deferring it.



CR Number                     : 5449
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cdsd
Short Description             : cdsd aborts on restart
Reported Date                 : 9/23/92
Found in Baseline             : 1.0.1
Found Date                    : 9/23/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/23/92 public]
This problem can occur on any restart.  Currently, we are running with
compression=0 because of problems we've seen when compression was on.
This stack is:

abort process in raise at 0xd000693c
0xd000693c (raise+0x24) 80410014          l   r2,0x14(r1)
(dbx) where
raise(0x0) at 0xd000693c
abort.abort(0x0) at 0xd012ad14
node_check(0x0) at 0x10033bbc
insert_record(0x0, 0xdeadbeef, 0xdeadbeef, 0xdeadbeef) at 0x100347e0
build_index(0x0) at 0x10036a84
db_btree_build(0x0, 0xdeadbeef, 0xdeadbeef, 0xdeadbeef) at 0x10036e1c
db_checkpoint_load(0x0) at 0x1003d278
db_setup(0x0) at 0x1001f7dc
dns_enable(0x0, 0xdeadbeef) at 0x1006a014
server_auto(0x0) at 0x10000830
server_watchdog(0x0) at 0x10000b48
main(0x0, 0xdeadbeef) at 0x10000438

[9/23/92 public]
A potential fix (workaround? kludge?) to this problem would be to take a
snapshot of the bucket at the beginning of insert_record() after determining
len and passing node_check() the first time, then attempt the insert,
then if the final node_check() fails revert to the snapshot.  This would
involve a version of node_check() that returned a bad code instead of
abort()ing.  Is this worth pursuing?  Clearinghouse files which cause the
failure are available on request.

[12/8/92 public]
Changed severity and priority as per OSF reclassification.

[9/17/93 public]
This problem is not happening in 1.0.3 code base. David Skeen of IBM
believes it got fixed by DEC in 1.0.2 work. Cancel it by now.



CR Number                     : 5234
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 2515
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cds/control/dnscp_creobj.c & cds.txt
Short Description             : Cannot use cdscp to create an
object with CDS_ObjectUUID
Reported Date                 : 8/27/92
Found in Baseline             : 1.0.1
Found Date                    : 8/27/92
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/27/92 public]

        An Administrator cannot modify the CDS_ObjectUUID once the
        object is created because the CDS_ObjectUUID is unmodifiable
        (This is a bug fix for OT2515.) Therefore in order to have
        a CDS_ObjectUUID, we must supply this value during creation
        time. The CDSPI cdsCreateObj allows an option UUID parameter
        but the CDS Control Program always called the API with an
        NULL UUID parameter.
Repeat By:

        Create an obj with CDSCP, then try to change the CDS_ObjectUUID
        attribute using CDSP. Another case is try to create an obj
        with a CDS_ObjectUUID.

cdscp> create obj /.:/foo
cdscp> set obj /.:/foo CDS_ObjectUUID = 12345678-1234-1234-1234-123456789012
(This gave an error message saying attribute is unmodifiable)

cdscp> create obj /.:/foo CDS_ObjectUUID 12345678-1234-1234-1234-123456789012
(syntax error             x )


Note, if you create an obj with cdscp create obj /.:/foo, it does not have
a value for CDS_ObjectUUID. I can understand why we don't want people to
modify the uuid, for obvious reason. But in that case, shouldn't it always
create one uuid for the new obj?

The proposed solution from IBM:

        Change the code in dnscp_creobj to have the cdsCreateObj api
        called with an Non-Null UUID if supplied by the user. Also
        the cds.txt (parser text file) would have to be update to
        avoid the syntax checking of the control program.

[10/27/92 public]

Changed to defect.

[07/07/93 public]
According to the AES draft CDS_objectUID is read/write/delete therfore
the current behavior is definitely broken. It will not become an
enhancement request and should be fixed in 1.0.3.

[9/8/93 public]
Based on the AES/Distributed Computing - Directory Services, and a discussion 
with Norbert and John, the CDS_ObjectUUID is one time writable during the 
creation time and the purpose of this attribute is to identify the object. 
The use of cdscp should not be allowed to supply a uuid because the supply
can not be guaranteed to be unique. So the behavior of cdscp is correct.
Cancel this bug.



CR Number                     : 5126
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : server bugcheck
Reported Date                 : 8/19/92
Found in Baseline             : 1.0.1
Found Date                    : 8/19/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/92 public]


I had a rios which was a server for core components and dfs and I did a dce.clean and
then a rc.dce and I got a bug check message from cds. I can't say that I know how to
reproduce this.

root@singsing> sh /etc/rc.dce
Starting DCE daemons:
        /opt/dcelocal/bin/rpcd
        /opt/dcelocal/bin/secd
        /opt/dcelocal/bin/sec_clientd
SECD Incomplete NSI registration; task sleeping for 60 seconds
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/cdsd
************* BUGCHECK *************
A module in the server has bugchecked
Bugcheck code is ... -902
Thread id .......... 20103490
Thread errno ....... 0
UNIX errno ......... 22
Bug ref# ........... 974
Module id........... ../../../../../src/directory/cds/server/db_compression.c
************* BUGCHECK *************
At 363, writing up to last 500 allocations to ./vm_data
At 363, writing all current allocations to ./vm_data
        /opt/dcelocal/bin/gdad

[08/19/92 public]

Here's the vm_data file contents:




At 363, DECdns Server Database up to last 500 allocations.

     1 Alloc    92 Unkn at  1046, ../../../../../src/directory/cds/library/threads_lib.c
     2 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
     3 Alloc   317 Unkn at   849, ../../../../../src/directory/cds/library/dnscfg.c
     4 Alloc   111 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     5 Alloc   104 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     6 Alloc    81 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     7 Alloc    85 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     8 Alloc    83 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     9 Alloc   272 Unkn at   914, ../../../../../src/directory/cds/library/dnscfg.c
    10 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
    11 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    12 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    13 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    14 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    15 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    16 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    17 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    18 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    19 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    20 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
     21 Alloc    24 Unkn at  1321, ../../../../../src/directory/cds/server/unix_net.c;     31 Freed
    22 Alloc   452 Unkn at  1340, ../../../../../src/directory/cds/server/unix_net.c
     23 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     24 Freed
     25 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     26 Freed
     27 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     28 Freed
     29 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     30 Freed
    32 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    33 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    34 Alloc    36 Unkn at   926, ../../../../../src/directory/cds/server/ta_adver.c
    35 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    36 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    37 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    38 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    39 Alloc  1780 Unkn at  1768, ../../../../../src/directory/cds/server/dns_service_ncl.c
    40 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    41 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    42 Alloc  2828 Perm at  1037, ../../../../../src/directory/cds/server/db_common.c
    43 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    44 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    45 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    46 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    47 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    48 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    49 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    50 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    51 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    52 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    53 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    54 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    55 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    56 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    57 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    58 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    59 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    60 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    61 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    62 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    63 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    64 Alloc  8192 Perm at  2094, ../../../../../src/directory/cds/server/db_btree.c
    65 Alloc  4096 Perm at  1915, ../../../../../src/directory/cds/server/db_btree.c
    66 Alloc  5120 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    67 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    68 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    69 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    70 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    71 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    72 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    73 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    74 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    75 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    76 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    77 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    78 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    79 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    80 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    81 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    82 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    83 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    84 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    85 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    86 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    87 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    88 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    89 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    90 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    91 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    92 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    93 Alloc  5120 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    94 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    95 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    96 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    97 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    98 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    99 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   100 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   101 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   102 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   103 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   104 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   105 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   106 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   107 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   108 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   109 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   110 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   111 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   112 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   113 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   114 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   115 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   116 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   117 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   118 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   119 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   120 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   121 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   122 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   123 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   124 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   125 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   126 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   127 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   128 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   129 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   130 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   131 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   132 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   133 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   134 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   135 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   136 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   137 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   138 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   139 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   140 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   141 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   142 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   143 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   144 Alloc    12 Unkn at  1

At 363, DECdns Server Database up to last 500 allocations.

     1 Alloc    92 Unkn at  1046, ../../../../../src/directory/cds/library/threads_lib.c
     2 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
     3 Alloc   317 Unkn at   849, ../../../../../src/directory/cds/library/dnscfg.c
     4 Alloc   111 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     5 Alloc   104 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     6 Alloc    81 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     7 Alloc    85 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     8 Alloc    83 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     9 Alloc   272 Unkn at   914, ../../../../../src/directory/cds/library/dnscfg.c
    10 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
    11 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    12 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    13 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    14 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    15 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    16 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    17 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    18 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    19 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    20 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
     21 Alloc    24 Unkn at  1321, ../../../../../src/directory/cds/server/unix_net.c;     31 Freed
    22 Alloc   452 Unkn at  1340, ../../../../../src/directory/cds/server/unix_net.c
     23 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     24 Freed
     25 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     26 Freed
     27 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     28 Freed
     29 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     30 Freed
    32 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    33 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    34 Alloc    36 Unkn at   926, ../../../../../src/directory/cds/server/ta_adver.c
    35 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    36 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    37 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    38 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    39 Alloc  1780 Unkn at  1768, ../../../../../src/directory/cds/server/dns_service_ncl.c
    40 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    41 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    42 Alloc  2828 Perm at  1037, ../../../../../src/directory/cds/server/db_common.c
    43 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    44 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    45 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    46 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    47 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    48 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    49 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    50 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    51 Alloc     8 U

[10/13/92 public]
One more data point from Richard Mark <rmark@llnl.gov>:

We recently installed the V1.0.1 release and have begun testing the various
components as described in the Porting and Testing Guide.  During the process
of testing the CDS using the supplied test scripts, we encountered a
bugcheck in the cdsd when running the cp_abuse.tests.  The script creates a
flurry of directories and then proceeds to create a bunch of object entries.
After creating approximately 1200 object entries, I believe the cdsd crashes.
The following is an example of what appears in the log for the abuse script

cdscp> cre obj /.:/root/testdir/w394.object CDS_Class = object_class CDS_ClassVe
rsion = 1.0
Error on entity: /.../zodiac/root/testdir/w394.object
connection closed (dce / rpc)
Function: dnsCreateObj

cdscp> cre obj /.:/root/testdir/w395.object CDS_Class = object_class CDS_ClassVe
rsion = 1.0
Error on entity: /.../zodiac/root/testdir/w395.object
connection request rejected (dce / rpc)
Function: dnsCreateObj

<several similiar entries deleted>

cdscp> cre obj /.:/root/testdir/w401.object CDS_Class = object_class CDS_ClassVe
rsion = 1.0
Error on entity: /.../zodiac/root/testdir/w401.object
Timeout occurred, operation not performed (dce / cds)
Function: dnsCreateObj

The contents of the cdsd.log file are as follows:

 [16630] Thu Sep 24 16:07:27 1992

************* BUGCHECK *************
A module in the server has bugchecked
Bugcheck code is ... -902
Thread id .......... 20b476d0
Thread errno ....... 0
UNIX errno ......... 22
Bug ref# ........... 966
Module id........... ../../../../../src/directory/cds/server/db_compression.c
************* BUGCHECK *************
At 280747, writing up to last 500 allocations to ./vm_data
At 280747, writing all current allocations to ./vm_data

Since neither of these logs have timestamped entries, I can only assume some
relationship of events. When I went to examine running processes, I didn't
locate a cdsd from which I conclude the bug check forced or caused it to die.
This problem is reproducable, it doesn't occur at the exact same location in
the abuse script but it has the same behavior and the same bugcheck message
is logged.  In recovering from this we had to clean up the environment (using
dce.rm and dce.clean scripts) and the configure again.

In what is probably a related problem, about 5-6 hours after I started the
abuse scripts, we started getting the following messages:

sec_clientd 09/24/92 23:32:17 - Host Principal key management failure
... connection request rejected (dce / rpc)

These messages appear every 10 minutes (which I assume is somebody's retry
value) and then 5 or 6 hours later the following messages appear:

sec_clientd 09/24/92 06:12:56 - Warning - unable to refresh identity ...
will id
le
... Cannot contact any KDC for requested realm (dcsec_clientd 09/24/92 ...
... Cannot contact any KDC for requested realm (dce / krb)

This seems related because of the security service's use of name services and
/or it's inability to make use of those services if the cds daemon is dead.

All other CDS test scripts appear to have been successful.

[12/7/92 public]
Cancelled due to non-reproducibility. Possibly related to the fixed CR 5047.

[12/7/92 public]
My mistake. OSF should attempt to reproduce and cancel if they can't.

[09/14/93 public]
Not reproducable. Cancelled.



CR Number                     : 4741
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDS spurious returns error
Reported Date                 : 7/16/92
Found in Baseline             : 1.0.1
Found Date                    : 7/16/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[7/16/92 public]
After running for about a day (actuually 22 hours), CDS calls started
returning "error with socket (dce / cds)" (that's the message from
the DCE error message function.

The CDS client program was a user command, and so the problem is
almost certainly not due to corruption of the client address space,
since it is a fresh one each time.  The command executing was "fts lsquota ."
and the function that was returning this error is rpc_ns_profile_elt_inq_next.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[7/16/92 public]
This looks like a duplicate of 4245: "A rpc call suddenly returns comm_failure"

[8/25/92 public]
Is this behavior still occurring with the frozen 1.0.1? Otherwise this CR
should be cancelled.

[9/30/92 public]

This was observed in the current 1.0.2 by a stress test scenario:

12 clients in separate processes, with the same DCE principal, concurrently
attempting to locate a single server by calls to
rpc_ns_binding_import_next.  Nine clients found the service, the others
received "error with socket (dce / cds)".

Contact Mark Hickey at OSF for more info on this.

[10/9/92 public]

Another data point: This problem was observed when two processes, running
as the machine principal, executed:

	do forever
		cdscp show dir /.:
	end do.

[12/7/92 public]
OSF should attempt to reproduce this problem. We suspect that this is
really an RPC problem. Please verify or cancel.

[08/27/93 public]
I ran Dave's forever loop in three windows on both the hp ant the 486 with
no problems. I beleive this problem has gone away. Cancelled.



CR Number                     : 4406
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd depends on advertiser
Reported Date                 : 6/23/92
Found in Baseline             : 1.0.b13
Found Date                    : 6/23/92
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/23/92 public]

The porting guide on page 4-8 talks about the
ability to bring up cdsd withOUT cdsadv.  This
no longer works since the cdsd was changed to
fix a timing problem.  What happens now is:
 <adver_wait_for_advertisement()
 >probe_root_dir()
 attempt #1 to read CDS_CTS from root
 >dthread_delay(1.000000)
 attempt #2 to read CDS_CTS from root
     .
     .
     .

The ablity to bring up a cell without the advertiser
has been lost.  (which makes debugging a clerk a lot
harder).

[6/24/92 public]
Will be fixed subsequent to 1.0.1.

[10/12/92 public]
Change ENH to DEF.

[12/7/92 public]
This will be integrated in 1.1. Abby's fix will be incorporated at that time.

[9/8/93 public]
Tested on both 486(balder) and HP_UX(gnocci), cdsd works fine
without cdsadv now. So cancel this bug.



CR Number                     : 3943
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : Removing attribute with wrong value behaves incorrectly
Reported Date                 : 6/1/92
Found in Baseline             : 1.0.1b17
Found Date                    : 6/1/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/1/92 public]
Create set-valued attribute; remove a value from the attribute that doesn't 
exist--no error given.  Create single-valued attribute; remove an incorrect
value for that attribute--value becomes an empty set.  console follows:

cdscp> cre o /.:/foo
cdscp> set o /.:/foo 1.2.3 = 50
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:00
                       1.2.3 = 50
cdscp> rem o /.:/foo 1.2.3 = 10
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:16
                       1.2.3 = <empty set>
cdscp> add o /.:/foo 1.2.3 = 20
cdscp> add o /.:/foo 1.2.3 = 40
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:40
                       1.2.3 = 20
                       1.2.3 = 40
cdscp> rem o /.:/foo 1.2.3 = 10
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:54
                       1.2.3 = 20
                       1.2.3 = 40
cdscp>

[6/1/92 public]
> Create set-valued attribute; remove a value from the attribute that doesn't
> exist--no error given.
This is indeed the intended, if not obvious, behavior.

Other problems with attribute values have been previously categorized
as priority 2's and 3's. I am changing this to a 2 as you do not indicate
why this is a "high priority defect".

[6/30/92 public]
Here is a diff of a fix here.  The problem seems to be in ta_modify_attribute 
of file ta_modify.c.  All I basically did was to call set_test() with the 
attribute value that was passed in.
*** 239,244 ****
--- 239,268 ----
       */
      if (status == DNS_SUCCESS)
          {
+ 
+               if (EXT16(valuePresent_p->bl_value) &&
+                       (EXT8(update_p->ud_operation) == UD_absent) &&
+                         rec_p->data_p)
+
+                 {
+                         byte_t *val_p, val_type;
+                         AtomicValue_t av;
+                         int val_len;
+
+                         val_p = SKIP_AttributeSpecifier(update_p->ud_attribute
);
+                         GET8(val_p);
+                         val_len = GET16(val_p);
+                         val_type = GET8(val_p);
+                         INS16(&av.av_length, val_len);
+                         INS8(&av.av_valuetype, val_type);
+                         COPY_bytes(val_p, av.av_value, val_len);
+                         if (set_test(rec_p->data_p, (AttributeName_t *)attribu
te_p->as_name, &av) == FALSE)
+                         {
+                                 db_close_stream(stream_p);
+                                 return(DNS_INVALIDARGUMENT);
+                         }
+                 }
+

<

[7/13/92 public]
Changed strncpy() to COPY_bytes() above ...

[7/28/92 public]
The above fix is overwriting the stack during background skulks.  We're beginning
to investigate why.

[11/17/92 public]
We believe that this is a duplicate of OT 2520.

I have retried this on a stock b20 OSF DCE machine and an AIX DCE machine
with the new sets_lib.c that OT3525 changed.  I still can remove invalid 
attributes from CDS entities and not get any complaints.

I have been running a cdsd with the above mentioned fix and haven't seen any
stack overwrites.  I am keeping an eye out though.

[04/01/93 public]
Fix in 1.0.3.

[07/07/93 public]
What am I missing here. The 1.0.1 documentation says that set object
chagnes the value of a modifiable, *single-valued* attribute of an 
object entry. If it doesn't exist it creates it.

cdscp> cre o /.:/foo
cdscp> set o /.:/foo 1.2.3 = 50
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/foo
                          AT   1993-07-07-05:07:37
                       1.2.3 = 50
cdscp> add o /.:/foo 1.2.3 = 20
Error on entity: /.../vanilla.qadce.osf.org/foo
Specified attribute type is incorrect (dce / cds)
Function: dnsAddAttrValue

This is correct since the attribute is not set valued.

I can however...

cdscp> rem o /.:/foo 1.2.3
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/foo
                          AT   1993-07-07-05:21:02
                       1.2.3 = <empty set>

and the following works...

cdscp> cre o /.:/bar
cdscp> add o /.:/bar 1.2.3 = 50
cdscp> add o /.:/bar 1.2.3 = 20
cdscp> add o /.:/bar 1.2.3 = 40
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:14:39
                       1.2.3 = 50
                       1.2.3 = 20
                       1.2.3 = 40
cdscp> rem o /.:/bar 1.2.3 = 10
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:15:01
                       1.2.3 = 50
                       1.2.3 = 20
                       1.2.3 = 40
cdscp> rem o /.:/bar 1.2.3 = 50
cdscp> rem o /.:/bar 1.2.3 = 20
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:16:45
                       1.2.3 = 40
cdscp> rem o /.:/bar 1.2.3 = 40
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:17:53
                       1.2.3 = <empty set>

This all seems ok now.

If noone objects this will be canceled shortly.

[07/07/93 public]
The problem with single-valued attributes was fixed (at some time).  Should the
behaviour for set-valued attributes be documented in the 'cdscp remove object' man
page?  The "success" when removing a non-existent attribute value seems unintuitive.

[07/07/93 public]
I opened a doc bug - 8241. Canceling this.....



CR Number                     : 3769
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cds_clerk
Short Description             : clerk should retry binding unauthenticated if authenticated binding fails
Reported Date                 : 5/22/92
Found in Baseline             : 1.0.1b16
Found Date                    : 5/22/92
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/22/92 public]
If authenticated binding to server fails, eg when perusing in foreign cell before rgy_edit
cell command is issued, the clerk should retry binding in unauthenticated mode.

[12/7/92 public]
This is work we will consider for 1.1

[6/29/94 public]
This is viewed as undesirable from a security point of view.  this ot is
being canceld.



CR Number                     : 3531
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : The 'set directory to skulk' removes wrong softlinks.
Reported Date                 : 5/14/92
Found in Baseline             : 1.0
Found Date                    : 5/14/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : time_actions.c
Sensitivity                   : public

[5/14/92 public]

  The 'set directory to skulk' removes all non-permanent softlinks
  if their expiration time is within 5 hours of when the SKULK is issued.

Repeat By:

  Issue the following CDSCP commands:

--------------------------------------------------------------------------------------
-------------------------
cdscp> create directory /.:/test_dir
cdscp> create link /.:/test_dir/test_link CDS_LinkTarget = /.:/object
CDS_LinkTimeout
= (current time + 4hours)
cdscp> set directory /.:/test_dir to skulk
cdscp> list link /.:/test_dir/*


                        LIST
                    SOFTLINK  /.../c=ca/o=cell3/test_dir
                          AT   1992-05-06-15:49:09
cdscp>



--------------------------------------------------------------------------------------
-------------------------

Proposed Solution:

  CDS should not be deleting these non-permanent soft-links which have
  not yet expired.

[6/2/92 public]
The problem is that cdscp expects the expiration time to be entered in UTC.
It should assume that it is entered in local time and then convert to UTC.
So if your offset from UTC is +5 hours, any timeout less than that will
cause the link to be deleted when the directory is skulked.

[6/9/92 public]
cdscp now converts localtime to UTC, fixed and bsubmit'd, changing status
to "fix".

[6/15/92 public]
Tried test sequence, incorrect behavior persists.  Verified that
control/time_actions.c was successfully submitted.  Resetting status to
OPEN.

[8/4/92 public]
Is this problem occurring because OSF/1's localtime code is broken? If
this problem doesn't occur on AIX 3.2, I suggest that it be cancelled.

[10/12/92 public]

Changed platform to pmax/osf1.  Mark's comment above is correct, but this
remains a functional problem on the pmax reference platform.  Change to
defer.

[08/02/93 public]
This problem does not appear on either the 486 or hp platforms. Tested
both platforms after scratch installations.



CR Number                     : 791
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : cds
Subcomponent Name             : 
Short Description             : consider changing the name of prs to something else (cdsprs) to
Reported Date                 : 06/20/91
Found in Baseline             : 1.0
Found Date                    : 
Severity                      : D
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[01/29/92 public]

Orbit reference number 2094
reference     
product       dce_osf
phaseFound    development

History:
lastUpdate    91/11/18 08:59:59
endDate                                
assignDate    91/06/20 16:28:58   





    addDate              action          userLogin (userName)
    -------------------- --------------- ----------------------------------
    91/06/20 16:28:58    create          leban (Dick Leban)
    91/08/08 14:48:42    modify          leban (Dick Leban)
    91/08/08 16:57:13    modify          leban (Dick Leban)
    91/10/23 17:29:35    modify          drb (Defect Review Board)
    91/11/18 08:59:59    modify          leban (Dick Leban)

    pref name   compName                  originLogin     duplicate answer
    ---- ------ ------------------------- --------------- --------- ----------
    exte 003226 naming.local.src          page            000002094 duplicate

[06/20/91 public]
consider changing the name of prs to something else (cdsprs) to avoid silly conflicts with sccs tools

[3/19/92 public]
Taken off the front burner, changed to enhancement and defer.

[3/18/94 public]
Changing it caused other sillier but more harmful conficts.



