CR Number                     : 13667
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : Fixes to Certification API test procedures
Reported Date                 : 11/14/96
Found in Baseline             : 1.2.2b5
Found Date                    : 11/14/96
Severity                      : B
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/25/96 public]

This OT contains all the fixes to the build procedures
needed to run the Certification API functional tests described
in the Testing Guide.

If you are interested in just picking up the new files,
all the files that need to be modified as per the discussion in
this OT have been included in their entirety at the end of the OT
(search for string "Complete Set of Files".)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

[11/14/96 public]


Currently, in R1.2, the tetized version of Certification API (CAPI) tests 
(in directory "src/test/functional/security/ts/capi")
have the following two bugs:

1.  test-registry.sh :  This shell script invokes the
    tetized program "test_registry_tet" twice, once for
    testing with certificed login credentials, and another
    time for testing with uncertified login credentials.

    Due to a deficiency in tcc, the output of the second
    invocation of test_registry_tet is not appended to
    the resulting journal file (even though the test
    succeeds).


2.  test-hierarchy.sh : This shell script invokes
    the tetized program "trycase_a_tet" which runs
    the CAPI tests for two configurations at once:
          (a) when certificates are stored in DCE CDS.
          (b) when certificates are stored in X500.

    Even though this cannot be classified strictly as
    a bug, it may be important to run just (a) or (b)
    separately. 

This OT describes fixes to these two problems.     

The changes  affect only the way the tests are run for CAPI and 
does not change any files that implement basic CAPI functionality. 
So these changes don't  impact  the existing code for CAPI in any 
significant way.

All changes (two completely new files not in the current R1.2 
distribution, and three modified files since the R1.2 distribution)  
are localized to component directory "src/test/functional/security/ts/capi".

The new files are:

src/test/functional/security/ts/capi/test-registry-second.sh  (described in Part IV)
src/test/functional/security/ts/capi/test-hierarchy-second.sh (described in Part V)

The  files to be modified  are:

src/test/functional/security/ts/capi/Makefile                 (described in Part I)
src/test/functional/security/ts/capi/test-registry.sh         (described in Part II)
src/test/functional/security/ts/capi/test-hierarchy.sh        (described in Part III)

The OT has five parts indicating either a change to an
existing R1.2 file (Parts I, II, III), or a new file
to be added to your  R1.2 distribution (Parts IV and V) 
in the directory "src/test/functional/security/ts/capi".

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Part I.


Changes to src/test/functional/security/ts/capi/Makefile:

  a) Change the line 

     TESTS = test-registry test-hierarchy               TO

     TESTS = test-registry test-hierarchy test-registry-second test-hierarchy-second

  b) Change the line

     SCRIPTS = test-registry test-hierarchy             TO
  
     SCRIPTS = test-registry test-hierarchy test-registry-second test-hierarchy-second

  c) Add the following two lines after the line beginning with word "PROGRAMS":

     SUBDIRS = certs keys testcases
     ILIST = ${PROGRAMS} ${DATAFILES} ${SCRIPTS}
 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Part II.

"src/test/functional/security/ts/capi/test-registry.sh"
This shell script runs a specific test for retrieving public keys stored 
in the security registry.

BELOW  IS THE MODIFIED FILE and not a DIFF OUTPUT. 

Please replace the file test-registry.sh (inbetween ------ lines)
in your source distribution with the one below: 

-------------------- modified test-registry.sh for R1.2 -------------------
#!/bin/sh
#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-registry.sh
#

echo "**********************************************************"
echo "Invoking test-registry..."
echo "**********************************************************"
echo "Doing dce_login_noexec..."
rm -f dce_login_noexec
ln -s `which dce_login` dce_login_noexec
KRB5CCNAME=`dce_login_noexec -c cell_admin -dce-`
export KRB5CCNAME
klist
#
# ignore any errors here.
#
echo "============================================================"
echo "** IGNORE Any Errors while deleteing principal foo
echo "** This is just a cleanup"
echo "============================================================"
echo "Deleting principal foo.."
rgy_edit < delete_foo
echo "============================================================"
echo "** Creating principal test_capi **, This better work! 
echo "============================================================"
rgy_edit < create_foo
echo "============================================================"
echo "Creating Authn/Cipher ERA schema and attaching it to test_capi's xattrs..."
echo "If the ERA schema already exists, you can ignore the error here as well.."
echo "We don't delete the schema since it may affect existing principals"
echo "other than the test principal test_capi which use this schema"
echo "============================================================"
dcecp < create_era
echo "============================================================"
echo "** STARTING Registry Policy Test **, "
echo "   Any errors now will result in failure"
echo "============================================================"
#
# running first with certified credentials
#
REGISTRY_TEST_ARGUMENTS=direct
export REGISTRY_TEST_ARGUMENTS
echo "Trying <test_registry_tet direct> ......"
./test_registry_tet
echo "RETURNED from <test_registry_tet direct>"
echo "CLEANING up after run of Registry Policy Test"
echo "Deleting principal foo.."
rgy_edit < delete_foo
kdestroy
echo "END of Registry Policy Test"
#EOF
-------------------- end of test-registry.sh ----------------------



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Part III.

"src/test/functional/security/ts/capi/test-hierarchy.sh"
This shell script runs a specific test for retrieving public keys stored 
in DCE CDS 

BELOW  IS THE MODIFIED FILE and not a DIFF OUTPUT. 

Please replace the test-hierarchy.sh (inbetween ------ lines)
in your source distribution with the one below: 

--------------------  modified test-hierarchy.sh for R1.2 ----------------------
#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-hierarchy.sh
#
echo "******************************************************"
echo "Invoking test-hierarchy (Hierarchical Policy Test) ..."
echo "******************************************************"
echo "Doing dce_login_noexec..."
rm -f dce_login_noexec
ln -s `which dce_login` dce_login_noexec
KRB5CCNAME=`dce_login_noexec -c cell_admin -dce-`
export KRB5CCNAME
klist
#
# running first with certified credentials
#
HIERARCHICAL_TEST_ARGUMENTS="pc1 pc2 pc3 pc4 pc5 pc6 pc7"
export HIERARCHICAL_TEST_ARGUMENTS
echo " ===  Starting a run of test with arguments $HIERARCHICAL_TEST_ARGUMENTS"
./trycase_a_tet
echo "Returned from trycase_a_tet"
echo "******************************************************"
echo "END of Hierarchical Policy Test"
echo "******************************************************"
kdestroy
KRB5CCNAME=
export KRB5CCNAME
#EOF
--------------------  end of test-hierarchy.sh ----------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Part IV.


"src/test/functional/security/ts/capi/test-registry-second.sh"
This shell script runs a specific test for retrieving public keys 
stored in the security registry. 

THIS IS A NEW FILE  not in R1.2 

Please add  this file into your corresponding R1.2 directory.


--------------------  test-registry-second.sh ----------------------
#!/bin/sh
#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-registry-second.sh
#

echo "**********************************************************"
echo "Invoking test-registry..."
echo "**********************************************************"
echo "Doing dce_login_noexec..."
rm -f dce_login_noexec
ln -s `which dce_login` dce_login_noexec
KRB5CCNAME=`dce_login_noexec cell_admin -dce-`
export KRB5CCNAME
klist
#
# ignore any errors here.
#
echo "============================================================"
echo "** IGNORE Any Errors while deleteing principal foo
echo "** This is just a cleanup"
echo "============================================================"
echo "Deleting principal foo.."
rgy_edit < delete_foo
echo "============================================================"
echo "** Creating principal test_capi **, This better work! 
echo "============================================================"
rgy_edit < create_foo
echo "============================================================"
echo "Creating Authn/Cipher ERA schema and attaching it to test_capi's xattrs..."
echo "If the ERA schema already exists, you can ignore the error here as well.."
echo "We don't delete the schema since it may affect existing principals"
echo "other than the test principal test_capi which use this schema"
echo "============================================================"
dcecp < create_era
echo "============================================================"
echo "** STARTING Registry Policy Test **, "
echo "   Any errors now will result in failure"
echo "============================================================"
#
# running without certified credentials
#
REGISTRY_TEST_ARGUMENTS=untrusted
export REGISTRY_TEST_ARGUMENTS
echo "Trying <test_registry_tet untrusted> ......."
./test_registry_tet
echo "RETURNED from <test_registry_tet untrusted>"
echo "CLEANING up after run of Registry Policy Test"
echo "Deleting principal foo.."
rgy_edit < delete_foo
kdestroy
echo "END of Registry Policy Test"
#EOF
-------------------- end of test-registry-second.sh ----------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Part V


"src/test/functional/security/ts/capi/test-hierarchy-second.sh"
This shell script runs test cases for retrieving public keys stored in the X500 

THIS IS A NEW FILE not in R1.2 

Please add this file into your corresponding R1.2 directory.

--------------------  test-hierarchy-second.sh ----------------------
#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-hierarchy-second.sh
#
echo "******************************************************"
echo "Invoking test-hierarchy (Hierarchical Policy Test) ..."
echo "******************************************************"
#
# running first with certified credentials
#
HIERARCHICAL_TEST_ARGUMENTS="xc1 xc2 xc3 xc7"
export HIERARCHICAL_TEST_ARGUMENTS
echo " ===  Starting a run of test with arguments $HIERARCHICAL_TEST_ARGUMENTS"
./trycase_a_tet
echo "Returned from trycase_a_tet"
echo "******************************************************"
echo "END of Hierarchical Policy Test"
echo "******************************************************"
#EOF
--------------------  end of test-hierarchy-second.sh ----------------------


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

[11/25/96 public]


We discovered the following two additional problems in the 
Makefiles  used to build and install tests for certification API:

  (a). Doing a "build" from the "src/test" directory
     does not copy the following data directories (and files within)
     
       "src/test/security/api/capi/certs"
       "src/test/security/api/capi/testcases"
       "src/test/security/api/capi/keys"
       
      to the following directories: 

       "obj/rios/test/security/api/capi/certs"
       "obj/rios/test/security/api/capi/testcases"
       "obj/rios/test/security/api/capi/keys"

     This will cause the tests to fail if they are run
     directly from the "obj/rios/test/security/api/capi"
     directory without using tet.

  (b). Doing a "build install_all" from "src/test" directory
     does not copy the above data directories (and files within)

     to  the following directories:

      "/releases/release/rios/test/functional/security/ts/capi/certs"
      "/releases/release/rios/test/functional/security/ts/capi/testcases"
      "/releases/release/rios/test/functional/security/ts/capi/certs"

     This can cause the tests to fail when run under tet.

To solve the above two problems, you need to make the following changes
to your R1.2 distribution  (in addition to the changes described
in the when this OT was created):

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  (Change I) Change the file 
    "src/test/security/api/Makefile" as follows:

    Replace the lines (Set 1 below) currently in this file to 
    to the next set of lines (Set 2 below) 

    ===============================================
    Set 1  (lines currently in the above Makefile):
    ===============================================

    DATA_SUBDIRS   = control moretests
    .if ${TARGET_MACHINE}=="HP800" || !defined(USE_DES)
    SUBDIRS = testsh moretests control gssapi
    .else
    SUBDIRS = testsh moretests control gssapi capi
    .endif


    ======================================================
    Set 2 (Replacement lines for the lines shown in Set 1)
    ======================================================
    .if ${TARGET_MACHINE}=="HP800" || !defined(USE_DES)
    SUBDIRS = testsh moretests control gssapi
    DATA_SUBDIRS   = control moretests
    .else
    SUBDIRS = testsh moretests control gssapi capi
    DATA_SUBDIRS   = control moretests capi
    .endif


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  (Change II) Append the following two lines to  file
    "src/test/security/api/capi/Makefile" :

      SUBDIRS = certs keys testcases
      ILIST=${PROGRAMS}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  (Change III) Append the following lines to file 
    "src/test/security/api/capi/certs/certs_data.mk":

     ILIST += ${DATAFILES}
     .if defined(_TEST_MK_)
     IDIR = /test/tet/functional/security/ts/capi/certs/
     .endif

              Append the following lines to file 
    "src/test/security/api/capi/keys/keys_data.mk":

     ILIST += ${DATAFILES}
     .if defined(_TEST_MK_)
     IDIR = /test/tet/functional/security/ts/capi/keys/
     .endif

              Append the following lines to file 
    "src/test/security/api/capi/testcases/test_data.mk":

     ILIST += ${DATAFILES}
     .if defined(_TEST_MK_)
     IDIR = /test/tet/functional/security/ts/capi/testcases/
     .endif

   

===========================================
Complete Set of Files
===========================================

Files that need modification as per the OT discussion
are enclosed below in their entirety between lines of asterisk's ("*"):

File 1:  ./src/test/security/api/capi/Makefile

*****************************************************************

#
# @OSF_COPYRIGHT@
# COPYRIGHT NOTICE
# Copyright (c) 1990, 1991, 1992, 1993, 1996 Open Software Foundation, Inc.
# ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
# src directory for the full copyright text.
#
# HISTORY
# $Log:	c013667,v $
# Revision 1.2  96/11/25  13:49:55  root
# changed fields:  new/changed/deleted note(s) [girkar 11/25/96 public] [girkar 11/14/96 public] [girkar 11/25/96 public] [girkar 11/14/96 public]
# 
# Revision 1.1.2.1  1996/11/14  16:17:51  arvind
# 	OSF DCE 1.2.2 Drop 5
# 	[1996/11/14  14:31:49  arvind]
#
# Revision /main/DCE_1.2.2/1  1996/10/18  00:45 UTC  arvind
# 	CAPI drop from DEC
# 	[1996/10/16  20:45 UTC  arvind  /main/arvind_capi/1]
# 
# $EndLog$
#
#  @DEC_COPYRIGHT@
#  Copyright (c) 1996
#  Digital Equipment Corporation, Maynard, Massachusetts, USA
#  All Rights Reserved
#  



LIBS = -lpkplcy -lpktrust -lpk -lpkcrypto -lpkxds -ldce -bloadmap:error
CC_LD = xlC

DATA_SUBDIRS = certs keys testcases
SUBDIRS = certs keys testcases

LIBFLAGS = -L../../../../security/pkc -L../../../../security/pkc/capi/trust \
            -L../../../../security/pkc/capi/plcy  -L../../../../security/pkc/capi/crypto \
            -L../../../../security/pkc/xds

INCFLAGS = -I. -I../../../../security/pkc/h -I../../../../security/h -I../../../../directory/cds/includes

test_registry_OFILES = test_registry.o trycase_helper.o
trycase_a_OFILES = trycase_a.o cds_help_a.o trycase_helper.o
PROGRAMS = trycase_a test_registry 

ILIST=${PROGRAMS}

.include <${RULES_MK}>

****************************************************************

File 2: ./src/test/security/api/capi/certs/certs_data.mk


****************************************************************
#
# @OSF_COPYRIGHT@
# COPYRIGHT NOTICE
# Copyright (c) 1990, 1991, 1992, 1993, 1996 Open Software Foundation, Inc.
# ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
# src directory for the full copyright text.
#
# All Rights Reserved
#
# @DEC_COPYRIGHT@
# Copyright (c) 1996
# Digital Equipment Corporation, Maynard, Massachusetts, USA
# All Rights Reserved
#
# HISTORY
# $Log:	c013667,v $
# Revision 1.2  96/11/25  13:49:55  root
# changed fields:  new/changed/deleted note(s) [girkar 11/25/96 public] [girkar 11/14/96 public] [girkar 11/25/96 public] [girkar 11/14/96 public]
# 
# Revision 1.1.2.1  1996/11/14  16:59:29  arvind
# 	OSF DCE 1.2.2 Drop 5
# 	[1996/11/14  15:02:58  arvind]
#
# Revision /main/DCE_1.2.2/2  1996/11/04  22:38 UTC  arvind
# 	Cert-API drop 2 from DEC
# 	[1996/11/03  22:48 UTC  arvind  /main/DCE_1.2.2/arvind_capi2/1]
# 
# Revision /main/DCE_1.2.2/1  1996/10/18  00:49 UTC  arvind
# 	CAPI drop from DEC
# 	[1996/10/17  01:16 UTC  arvind  /main/arvind_capi/1]
# 
# $EndLog$
#
#  






CERTS = 0_1_0_0.cert 0_2_0_0.cert 0_3_0_0.cert 0_4_0_0.cert 0_5_0_0.cert 0_6_0_0.cert \
        0_7_0_0.cert 1_0_0_0.cert 1_2_0_0.cert 1_3_0_0.cert 1_4_0_0.cert 1_5_0_0.cert \
        1_6_0_0.cert 1_7_0_0.cert 2_0_0_0.cert 2_1_0_0.cert 2_3_0_0.cert 2_4_0_0.cert \
        2_5_0_0.cert 2_6_0_0.cert 2_7_0_0.cert 3_0_0_0.cert 3_1_0_0.cert 3_2_0_0.cert \
        3_4_0_0.cert 3_5_0_0.cert 3_6_0_0.cert 3_7_0_0.cert 4_0_0_0.cert 4_1_0_0.cert \
        4_2_0_0.cert 4_3_0_0.cert 4_5_0_0.cert 4_6_0_0.cert 4_7_0_0.cert 5_0_0_0.cert \
        5_1_0_0.cert 5_2_0_0.cert 5_3_0_0.cert 5_4_0_0.cert 5_6_0_0.cert 5_7_0_0.cert \
        6_0_0_0.cert 6_1_0_0.cert 6_2_0_0.cert 6_3_0_0.cert 6_4_0_0.cert 6_5_0_0.cert \
        6_7_0_0.cert 7_0_0_0.cert 7_1_0_0.cert 7_2_0_0.cert 7_3_0_0.cert 7_4_0_0.cert \
        7_5_0_0.cert 7_6_0_0.cert

XCERTS =  8_9_0_0.cert 8_10_0_0.cert 8_11_0_0.cert 8_12_0_0.cert 8_13_0_0.cert 8_14_0_0.cert 8_15_0_0.cert \
          9_10_0_0.cert 9_11_0_0.cert  9_12_0_0.cert  9_13_0_0.cert  9_14_0_0.cert  9_15_0_0.cert 9_8_0_0.cert \
         10_11_0_0.cert  10_12_0_0.cert  10_13_0_0.cert  10_14_0_0.cert  10_15_0_0.cert 10_8_0_0.cert   10_9_0_0.cert  \
         11_12_0_0.cert  11_14_0_0.cert  11_10_0_0.cert  11_13_0_0.cert  11_15_0_0.cert 11_6_0_0.cert   11_8_0_0.cert  \
         12_11_0_0.cert  12_14_0_0.cert  12_9_0_0.cert 12_10_0_0.cert  12_13_0_0.cert  12_15_0_0.cert  12_8_0_0.cert \
         13_11_0_0.cert  13_14_0_0.cert  13_9_0_0.cert 13_10_0_0.cert  13_12_0_0.cert  13_15_0_0.cert  13_8_0_0.cert \
         14_11_0_0.cert  14_13_0_0.cert 14_9_0_0.cert 14_10_0_0.cert  14_12_0_0.cert  14_15_0_0.cert 14_8_0_0.cert \
         15_11_0_0.cert  15_13_0_0.cert  15_9_0_0.cert 15_10_0_0.cert  15_12_0_0.cert  15_14_0_0.cert  15_8_0_0.cert








CROSS_CERTS =   0_1_0_0.crcert 0_2_0_0.crcert 0_3_0_0.crcert 0_4_0_0.crcert \
                0_5_0_0.crcert 0_6_0_0.crcert 0_7_0_0.crcert 1_2_0_0.crcert \
                1_3_0_0.crcert 1_4_0_0.crcert 1_5_0_0.crcert 1_6_0_0.crcert \
                1_7_0_0.crcert 2_3_0_0.crcert 2_4_0_0.crcert 2_5_0_0.crcert \
                2_6_0_0.crcert 2_7_0_0.crcert 3_4_0_0.crcert 3_5_0_0.crcert \
                3_6_0_0.crcert 3_7_0_0.crcert 4_5_0_0.crcert 4_6_0_0.crcert \
                4_7_0_0.crcert 5_6_0_0.crcert 5_7_0_0.crcert 6_7_0_0.crcert 

XCROSS_CERTS = 8_10_0_0.crcert  8_11_0_0.crcert  8_12_0_0.crcert  8_13_0_0.crcert \
               8_14_0_0.crcert  8_15_0_0.crcert  8_9_0_0.crcert \
               9_10_0_0.crcert  9_11_0_0.crcert  9_12_0_0.crcert  9_13_0_0.crcert  \
               9_14_0_0.crcert 9_15_0_0.crcert \
               10_11_0_0.crcert  10_12_0_0.crcert  10_13_0_0.crcert  10_14_0_0.crcert  \
               10_15_0_0.crcert \
               11_12_0_0.crcert  11_13_0_0.crcert  11_14_0_0.crcert  11_15_0_0.crcert \
               12_13_0_0.crcert  12_14_0_0.crcert  12_15_0_0.crcert \
               13_14_0_0.crcert  13_15_0_0.crcert \
               14_15_0_0.crcert


CRLS =      1_0_0.crl

XCRLS =     9_0_8.crl

DATAFILES =  ${CERTS} ${CROSS_CERTS} ${CRLS} ${XCERTS} ${XCROSS_CERTS} ${XCRLS}

ILIST += ${DATAFILES}
.if defined(_TEST_MK_)
IDIR = /test/tet/functional/security/ts/capi/certs/
.endif

****************************************************************

File 3: ./src/test/security/api/capi/testcases/test_data.mk

****************************************************************

#
# @OSF_COPYRIGHT@
# COPYRIGHT NOTICE
# Copyright (c) 1990, 1991, 1992, 1993, 1996 Open Software Foundation, Inc.
# ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
# src directory for the full copyright text.
#
# All Rights Reserved
#
# @DEC_COPYRIGHT@
# Copyright (c) 1996
# Digital Equipment Corporation, Maynard, Massachusetts, USA
# All Rights Reserved
#
# HISTORY
# $Log:	c013667,v $
# Revision 1.2  96/11/25  13:49:55  root
# changed fields:  new/changed/deleted note(s) [girkar 11/25/96 public] [girkar 11/14/96 public] [girkar 11/25/96 public] [girkar 11/14/96 public]
# 
# Revision 1.1.2.1  1996/11/14  17:11:43  arvind
# 	OSF DCE 1.2.2 Drop 5
# 	[1996/11/14  15:19:14  arvind]
#
# Revision /main/DCE_1.2.2/2  1996/11/04  22:39 UTC  arvind
# 	Cert-API drop 2 from DEC
# 	[1996/11/03  22:53 UTC  arvind  /main/DCE_1.2.2/arvind_capi2/1]
# 
# Revision /main/DCE_1.2.2/1  1996/10/18  00:51 UTC  arvind
# 	CAPI drop from DEC
# 	[1996/10/16  20:47 UTC  arvind  /main/arvind_capi/1]
# 
# $EndLog$
#
#  



TESTCASES = pc1 pc2 pc3 pc4 pc5 pc6 pc7 xc1 xc2 xc3 xc7
TEST_PRINCIPALS = principals
HELPERS = cdsconfig cdscreatedir cdsdeletedir cdsprincattr revokelist xdsconfig \
          xdscreatedir xdsdeletedir xdsprincattr

DATAFILES =  ${TESTCASES} ${TEST_PRINCIPALS} ${HELPERS}
           
ILIST += ${DATAFILES}
.if defined(_TEST_MK_)
IDIR = /test/tet/functional/security/ts/capi/testcases/
.endif


****************************************************************

File 4: ./src/test/security/api/capi/keys/keys_data.mk


****************************************************************


#
# @OSF_COPYRIGHT@
# COPYRIGHT NOTICE
# Copyright (c) 1990, 1991, 1992, 1993, 1996 Open Software Foundation, Inc.
# ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
# src directory for the full copyright text.
#
# All Rights Reserved
#
# @DEC_COPYRIGHT@
# Copyright (c) 1996
# Digital Equipment Corporation, Maynard, Massachusetts, USA
# All Rights Reserved
#
# HISTORY
# $Log:	c013667,v $
# Revision 1.2  96/11/25  13:49:55  root
# changed fields:  new/changed/deleted note(s) [girkar 11/25/96 public] [girkar 11/14/96 public] [girkar 11/25/96 public] [girkar 11/14/96 public]
# 
# Revision 1.1.2.1  1996/11/14  17:06:52  arvind
# 	OSF DCE 1.2.2 Drop 5
# 	[1996/11/14  15:14:31  arvind]
#
# Revision /main/DCE_1.2.2/2  1996/11/04  22:39 UTC  arvind
# 	Cert-API drop 2 from DEC
# 	[1996/11/03  22:52 UTC  arvind  /main/DCE_1.2.2/arvind_capi2/1]
# 
# Revision /main/DCE_1.2.2/1  1996/10/18  00:50 UTC  arvind
# 	CAPI drop from DEC
# 	[1996/10/16  20:45 UTC  arvind  /main/arvind_capi/1]
# 
# $EndLog$
#
#  




PUBLIC_KEYS = \
0_0.pubkey \
1_0.pubkey \
2_0.pubkey \
3_0.pubkey \
4_0.pubkey \
5_0.pubkey \
6_0.pubkey \
7_0.pubkey \


PRIVATE_KEYS = \
0_0.privkey \
1_0.privkey \
2_0.privkey \
3_0.privkey \
4_0.privkey \
5_0.privkey \
6_0.privkey \
7_0.privkey \

XPUBLIC_KEYS = \
11_0.pubkey  13_0.pubkey  15_0.pubkey \
8_0.pubkey 10_0.pubkey  12_0.pubkey  14_0.pubkey  9_0.pubkey


XPRIVATE_KEYS = \
11_0.privkey  13_0.privkey  15_0.privkey  8_0.privkey \
10_0.privkey  12_0.privkey  14_0.privkey 9_0.privkey



DATAFILES =  ${PUBLIC_KEYS} ${PRIVATE_KEYS} ${XPUBLIC_KEYS} ${XPRIVATE_KEYS}
 
ILIST += ${DATAFILES}
.if defined(_TEST_MK_)
IDIR = /test/tet/functional/security/ts/capi/keys/
.endif



****************************************************************

File 5: ./src/test/security/api/Makefile


****************************************************************


#
# @OSF_COPYRIGHT@
# COPYRIGHT NOTICE
# Copyright (c) 1990, 1991, 1992, 1993, 1996 Open Software Foundation, Inc.
# ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
# src directory for the full copyright text.
#
#
# HISTORY
# $Log:	c013667,v $
# Revision 1.2  96/11/25  13:49:55  root
# changed fields:  new/changed/deleted note(s) [girkar 11/25/96 public] [girkar 11/14/96 public] [girkar 11/25/96 public] [girkar 11/14/96 public]
# 
# Revision 1.1.14.1  1996/11/14  16:17:38  arvind
# 	OSF DCE 1.2.2 Drop 5
# 	[1996/11/14  14:31:41  arvind]
#
# Revision /main/DCE_1.2.2/3  1996/11/04  22:39 UTC  arvind
# 	Don't build CAPI for HP/UX
# 	[1996/10/18  15:36 UTC  arvind  /main/DCE_1.2.2/arvind_work/1]
# 
# Revision /main/DCE_1.2.2/arvind_work/4  1996/10/31  19:50 UTC  arvind
# 	Don't build CAPI tests for intl build
# 
# Revision /main/DCE_1.2.2/arvind_work/1  1996/10/18  15:36 UTC  arvind
# 	Don't build CAPI for HP/UX
# 
# Revision /main/DCE_1.2.2/1  1996/10/18  00:45 UTC  arvind
# 	CAPI drop from DEC
# 	[1996/10/16  20:47 UTC  arvind  /main/arvind_capi/1]
# 
# Revision 1.1.12.2  1996/03/11  02:29:52  marty
# 	Update OSF copyright years
# 	[1996/03/10  20:01:04  marty]
# 
# Revision 1.1.12.1  1995/12/11  20:15:54  root
# 	Submit OSF/DCE 1.2.1
# 	[1995/12/11  19:48:58  root]
# 
# Revision 1.1.10.1  1994/06/28  20:01:05  wray
# 	GSSAPI BL3 (OT 10824)
# 	[1994/06/28  19:25:27  wray]
# 
# Revision 1.1.8.2  1993/05/24  20:48:43  cjd
# 	Submitting 102-dme port to 103i
# 	[1993/05/24  20:16:11  cjd]
# 
# Revision 1.1.6.2  1993/05/12  18:20:02  jd
# 	486 port: Add control to the subdirs line so install will visit.
# 	[1993/05/12  18:15:17  jd]
# 
# Revision 1.1.2.2  1992/12/31  17:25:15  htf
# 	Embedding copyright notice
# 	[1992/12/31  16:50:12  htf]
# 
# Revision 1.1  1992/01/19  04:08:46  devrcs
# 	Initial revision
# 
# $EndLog$
#
#
# DCE Security Services 
# test/security/api Makefile
#

EXPINC_SUBDIRS = control
.if ${TARGET_MACHINE}=="HP800" || !defined(USE_DES)
SUBDIRS = testsh moretests control gssapi 
DATA_SUBDIRS   = control moretests
.else
SUBDIRS = testsh moretests control gssapi capi
DATA_SUBDIRS   = control moretests capi
.endif

.include <${RULES_MK}>


****************************************************************

File 6: ./src/test/functional/security/ts/capi/Makefile


****************************************************************

#   
# @OSF_COPYRIGHT@
# COPYRIGHT NOTICE
# Copyright (c) 1996 Open Software Foundation, Inc.
# ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE for
# the full copyright text.
#  
# All Rights Reserved
#  
# HISTORY
# $Log:	c013667,v $
# Revision 1.2  96/11/25  13:49:55  root
# changed fields:  new/changed/deleted note(s) [girkar 11/25/96 public] [girkar 11/14/96 public] [girkar 11/25/96 public] [girkar 11/14/96 public]
# 
# Revision 1.1.2.1  1996/11/14  16:10:59  arvind
# 	OSF DCE 1.2.2 Drop 5
# 	[1996/11/14  15:22:19  arvind]
#
# Revision /main/DCE_1.2.2/1  1996/10/18  00:44 UTC  arvind
# 	Fix build errors
# 	[1996/10/17  20:30 UTC  arvind  /main/arvind_capi/4]
# 
# 	Fix build errors
# 	[1996/10/17  20:10 UTC  arvind  /main/arvind_capi/3]
# 
# 	Fix build error
# 	[1996/10/17  19:44 UTC  arvind  /main/arvind_capi/2]
# 
# 	CAPI drop from DEC
# 	[1996/10/16  20:36 UTC  arvind  /main/arvind_capi/1]
# 
# $EndLog$
#
# (c) Copyright 1996,
# Digital Equipment Corporation, Maynard, Massachusetts, USA
# All Rights Reserved
#
# Makefile for Private Key Store Server (PKSS) and friends
#


#
# Need this for the TET tests
TET_ROOT      = /test/tet/functional/security
TET_TESTS     = ../..
TET_SCEN_FILE = $(TET_TESTS)/tet_scen
UPDATE_TET_SCEN = ${TET_TESTS}/tools/update_tet_scen
OTHERS          = update_tet_scen_rule
TESTS	= test-registry test-hierarchy test-registry-second test-hierarchy-second


STANDARD_TETLIBS = -ltettcm -ltetapi
COMPONENT_DIR = /ts/capi

DATA_SUBDIRS = certs keys testcases
SUBDIRS = certs keys testcases

# VPATH = ${MAKETOP}/test/security/api/capi:\
#        ${MAKETOP}/security/pkc/h
VPATH = ../../../../security/api/capi:${MAKETOP}/security/pkc/h


RIOS_CPP_LIBS = -L/usr/lpp/xlC/lib -L/usr/lpp/xlC -lC -lm
CPP_LIBS = ${${TARGET_MACHINE}_CPP_LIBS}


#
# libs for binding
#
# LIBS = ${${TARGET_MACHINE}_LIBS} -lpk -lcdsutil -lgdb -lpsm -ldce -lbsafe2 ${CPP_LIBS} ${STANDARD_TETLIBS}


LIBFLAGS = -L../../../../../security/pkc -L../../../../../security/pkc/capi/trust \
            -L../../../../../security/pkc/capi/plcy  -L../../../../../security/pkc/capi/crypto \
            -L../../../../../security/pkc/xds

LIBS = ${${TARGET_MACHINE}_LIBS} -lpkplcy -lpktrust -lpk -lpkcrypto -lpkxds -ldce \
       ${CPP_LIBS} ${STANDARD_TETLIBS} -bloadmap:error 

CC_LD = xlC



# LIBDIRS = -L../../../../../security/psm -L../../../../../security/pkc -L../../../../../directory/cds/gloria/gdb -L../../../../../directory/cds/library -L../../../../tet/src/posix_c/api
#
# flags for compiling
#
#CFLAGS		= ${${TARGET_MACHINE}_CFLAGS} -g -DDEBUG -DSVC_DEBUG -DENABLE_ALL
# CFLAGS		= ${${TARGET_MACHINE}_CFLAGS} -g -DENABLE_ALL -DMALLOCTRACE -DENVIRONMENT_TET

CFLAGS		= ${${TARGET_MACHINE}_CFLAGS}  -DENVIRONMENT_TET 

INCFLAGS = -I. -I../../../../../security/pkc/h -I../../../../../security/h \
               -I../../../../../directory/cds/includes \
               -I${BSAFE_ROOT}/usr/include

SCRIPTS = test-registry test-hierarchy test-registry-second test-hierarchy-second
DATAFILES = create_foo delete_foo create_era


test_registry_tet_OFILES = test_registry.o trycase_helper.o
trycase_a_tet_OFILES = trycase_a.o cds_help_a.o trycase_helper.o
PROGRAMS =  trycase_a_tet  test_registry_tet


#
# install directory
#
IDIR		= ${TET_ROOT}/${COMPONENT_DIR}/

#
# things to install
#

ILIST = ${PROGRAMS} ${SCRIPTS} ${DATAFILES}

.include <${RULES_MK}>

update_tet_scen_rule:
	${UPDATE_TET_SCEN} ${TET_SCEN_FILE} ${COMPONENT_DIR} ${TESTS}



****************************************************************

File 7: ./src/test/functional/security/ts/capi/test-registry.sh


****************************************************************

#!/bin/sh
#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-registry.sh
#

echo "**********************************************************"
echo "Invoking test-registry..."
echo "**********************************************************"
echo "Doing dce_login_noexec..."
rm -f dce_login_noexec
ln -s `which dce_login` dce_login_noexec
KRB5CCNAME=`dce_login_noexec -c cell_admin -dce-`
export KRB5CCNAME
klist
#
# ignore any errors here.
#
echo "============================================================"
echo "** IGNORE Any Errors while deleteing principal foo
echo "** This is just a cleanup"
echo "============================================================"
echo "Deleting principal foo.."
rgy_edit < delete_foo
echo "============================================================"
echo "** Creating principal test_capi **, This better work! 
echo "============================================================"
rgy_edit < create_foo
echo "============================================================"
echo "Creating Authn/Cipher ERA schema and attaching it to test_capi's xattrs..."
echo "If the ERA schema already exists, you can ignore the error here as well.."
echo "We don't delete the schema since it may affect existing principals"
echo "other than the test principal test_capi which use this schema"
echo "============================================================"
dcecp < create_era
echo "============================================================"
echo "** STARTING Registry Policy Test **, "
echo "   Any errors now will result in failure"
echo "============================================================"
#
# running first with certified credentials
#
REGISTRY_TEST_ARGUMENTS=direct
export REGISTRY_TEST_ARGUMENTS
echo "Trying <test_registry_tet direct> ......"
./test_registry_tet
echo "RETURNED from <test_registry_tet direct>"
echo "CLEANING up after run of Registry Policy Test"
echo "Deleting principal foo.."
rgy_edit < delete_foo
kdestroy
echo "END of Registry Policy Test"
#EOF

****************************************************************

File 8: ./src/test/functional/security/ts/capi/test-hierarchy.sh


****************************************************************

#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-hierarchy.sh
#
echo "******************************************************"
echo "Invoking test-hierarchy (Hierarchical Policy Test) ..."
echo "******************************************************"
echo "Doing dce_login_noexec..."
rm -f dce_login_noexec
ln -s `which dce_login` dce_login_noexec
KRB5CCNAME=`dce_login_noexec -c cell_admin -dce-`
export KRB5CCNAME
klist
#
# running first with certified credentials
#
HIERARCHICAL_TEST_ARGUMENTS="pc1 pc2 pc3 pc4 pc5 pc6 pc7"
export HIERARCHICAL_TEST_ARGUMENTS
echo " ===  Starting a run of test with arguments $HIERARCHICAL_TEST_ARGUMENTS"
./trycase_a_tet
echo "Returned from trycase_a_tet"
echo "******************************************************"
echo "END of Hierarchical Policy Test"
echo "******************************************************"
kdestroy
KRB5CCNAME=
export KRB5CCNAME
#EOF

****************************************************************

File 9: ./src/test/functional/security/ts/capi/test-registry-second.sh


****************************************************************


#!/bin/sh
#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-registry-second.sh
#

echo "**********************************************************"
echo "Invoking test-registry..."
echo "**********************************************************"
echo "Doing dce_login_noexec..."
rm -f dce_login_noexec
ln -s `which dce_login` dce_login_noexec
KRB5CCNAME=`dce_login_noexec cell_admin -dce-`
export KRB5CCNAME
klist
#
# ignore any errors here.
#
echo "============================================================"
echo "** IGNORE Any Errors while deleteing principal foo
echo "** This is just a cleanup"
echo "============================================================"
echo "Deleting principal foo.."
rgy_edit < delete_foo
echo "============================================================"
echo "** Creating principal test_capi **, This better work! 
echo "============================================================"
rgy_edit < create_foo
echo "============================================================"
echo "Creating Authn/Cipher ERA schema and attaching it to test_capi's xattrs..."
echo "If the ERA schema already exists, you can ignore the error here as well.."
echo "We don't delete the schema since it may affect existing principals"
echo "other than the test principal test_capi which use this schema"
echo "============================================================"
dcecp < create_era
echo "============================================================"
echo "** STARTING Registry Policy Test **, "
echo "   Any errors now will result in failure"
echo "============================================================"
#
# running without certified credentials
#
REGISTRY_TEST_ARGUMENTS=untrusted
export REGISTRY_TEST_ARGUMENTS
echo "Trying <test_registry_tet untrusted> ......."
./test_registry_tet
echo "RETURNED from <test_registry_tet untrusted>"
echo "CLEANING up after run of Registry Policy Test"
echo "Deleting principal foo.."
rgy_edit < delete_foo
kdestroy
echo "END of Registry Policy Test"
#EOF

****************************************************************

File 10: ./src/test/functional/security/ts/capi/test-hierarchy-second.sh

****************************************************************

#
# JC - Aug 20, 1996
# Script to invoke the PKSS tests             
# test-hierarchy-second.sh
#
echo "******************************************************"
echo "Invoking test-hierarchy (Hierarchical Policy Test) ..."
echo "******************************************************"
#
# running first with certified credentials
#
HIERARCHICAL_TEST_ARGUMENTS="xc1 xc2 xc3 xc7"
export HIERARCHICAL_TEST_ARGUMENTS
echo " ===  Starting a run of test with arguments $HIERARCHICAL_TEST_ARGUMENTS"
./trycase_a_tet
echo "Returned from trycase_a_tet"
echo "******************************************************"
echo "END of Hierarchical Policy Test"
echo "******************************************************"
#EOF

****************************************************************



CR Number                     : 13415
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : file
Short Description             : update tests
Reported Date                 : 3/28/96
Found in Baseline             : 1.2.1
Found Date                    : 3/28/96
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : dfs.lock,dfs.glue,dfs.repfs,dfs.read_write_all.main
Sensitivity                   : public

[3/28/96 public]


Several of the systest/file tests do not run in 1.2.1. I have
repaired these in the Transarc tree and the new tests will be
submitted in 1.2.2. Here are the diffs for the changes:

dfs.glue:

1,23d0
< #!/bin/ksh -
< #-
< # @TRANSARC_COPYRIGHT@
< #
< # $TALog: dfs.glue,v $
< # Revision 12.5  1996/03/20  13:17:16  gait
< # Retrofit Solaris changes back to AIX. Now all tests run
< # smoothly on both platforms.
< #
< # Get running on both platforms.
< # [from r12.4 by delta gait-db17508-repair-system-tests-for-DFS, r1.2]< #
< # Revision 12.4  1996/03/18  15:18:07  gait
< # Fix several broken system tests that are used by OSF to test DFS.
< # The fixes are for both Solaris and AIX.
< #
< # Fixes to the glue test. Mainly to fix mode bits on mount points and
< # shared files, replace relative paths with absolute paths, other small
< # stuff.
< # [from r12.1 by delta gait-db17508-repair-system-tests-for-DFS, r1.1]< #
< # $EndTALog$
< 
33a11,14
> # Revision 1.1.14.1  1995/12/11  21:59:21  root
> #     Submit OSF/DCE 1.2.1
> #     [1995/12/11  20:58:40  root]
> #
37c18
< #
---
> # 
203c184
< HOSTNAME=`/bin/hostname`
---
> HOSTNAME=`hostname`
239d219
<       chmod 777 ${DFS_PATH}/${RUNDIR}
241d220
< chmod 777 ${UFS_PATH}/${RUNDIR}
311d289
< chmod 777 ${UFS_PATH}/${RUNDIR}/*


dfs.lock:

1,30d0
< #!/bin/sh -
< #-
< # @TRANSARC_COPYRIGHT@
< #
< # $TALog: dfs.lock,v $
< # Revision 12.6  1996/03/26  21:27:13  gait
< # Incorporate reviewer changes.
< #
< # Don't remove files twice in cleanup routine. Make setup cleaner
< # for test directories.
< # [from r12.5 by delta gait-db17508-repair-system-tests-for-DFS, r1.3]< #
< # Revision 12.5  1996/03/20  13:17:17  gait
< # Retrofit Solaris changes back to AIX. Now all tests run
< # smoothly on both platforms.
< #
< # Get running on both platforms.
< # [from r12.4 by delta gait-db17508-repair-system-tests-for-DFS, r1.2]< #
< # Revision 12.4  1996/03/18  15:18:12  gait
< # Fix several broken system tests that are used by OSF to test DFS.
< # The fixes are for both Solaris and AIX.
< #
< # As above plus code to bullet-proof killing processes and removing
< # files. This has to be done carefully so as not to break other CHO
< # tests.
< # [from r12.1 by delta gait-db17508-repair-system-tests-for-DFS, r1.1]< #
< # $EndTALog$
< 
40a11,14
> # Revision 1.1.15.1  1995/12/11  21:59:24  root
> #     Submit OSF/DCE 1.2.1
> #     [1995/12/11  20:58:43  root]
> #
44c18
< #
---
> # 
608d581
<       chmod 666 $log_dir/*.$$.$ITERATION.*.$wfc_case.log > /dev/null 2>&1
615,616d587
<       chmod 666 $cliinfo.$wfc_case > /dev/null 2>&1
<       chmod 666 $tmp_dir/$$.wfc_mess_lines.$wfc_case > /dev/null 2>&1
618d588
<       chmod 666 $wfc_errout > /dev/null 2>&1
696,704d665
< 
<       # delete detritus files
<       # all these have been coerced to end in "lock_test"
<       cd ..
<       rm -rf $DFS_PATH
<       rm -rf $SYNCH_DIR
<       rm -rf $TMP_DIR
<       rm -rf $LOG_DIR
< 
717d677
< 
801d760
<    chmod 777 ${data_base}.$ITERATION > /dev/null 2>&1
803d761
<    chmod 666 $log_dir/$host.$$.$ITERATION.$seq.$sc_case.log > /dev/null 2>&1
828d785
< chmod 666 $cliinfo > /dev/null 2>&1
838d794
< chmod 666 $cliinfo.$sc_case > /dev/null 2>&1
956d911
<       chmod 666 $log_dir/*.$$.$ITERATION.*.$cls_case.log > /dev/null 2>&1
961d915
<       chmod 666 $tmp_dir/$$.cls_lock_tries.$cls_case > /dev/null 2>&1
963d916
<       chmod 666 $tmp_dir/$$.cls_lock_lines.$cls_case > /dev/null 2>&1
969d921
<       chmod 666 $cliinfo.$cls_case > /dev/null 2>&1
971d922
<       chmod 666 $tmp_dir/$$.cls_chk_out.$cls_case > /dev/null 2>&1
984d934
<        chmod 666 $tmp_dir/$$.cls_lock_tries.$cls_case > /dev/null 2>&1996d945
<        chmod 666 $tmp_dir/$$.cls_lock_chk.$cls_case > /dev/null 2>&1
1002,1003c951
<       #
<       chmod 666 $tmp_dir/$$.cls_lock_tries.$cls_case > /dev/null 2>&1
---
>       #      
1008,1010c956
<       #
<       chmod 666 $tmp_dir/$$.cls_locker_lines.$cls_case > /dev/null 2>&1
<       chmod 666 $tmp_dir/$$.cls_lock_chk.$cls_case  > /dev/null 2>&1
---
>       # 
1012d957
<       chmod 666 $tmp_dir/$$.cls_locker_out.$cls_case > /dev/null 2>&1
1018d962
<        chmod 666 $synch_base.$ITERATION.$sc_case > /dev/null 2>&1
1027d970
<        chmod 666 $synch_base.$ITERATION.$sc_case > /dev/null 2>&1
1033d975
<       chmod 666 $tmp_dir/$$.cls_chk_out.$cls_case > /dev/null 2>&1
1089d1030
<       chmod 666 $tmp_dir/$$.crs_prob_cli.$crs_case > /dev/null 2>&1
1101d1041
<       chmod 666 $log_dir/*.$$.$ITERATION.*.$cls_case.log > /dev/null 2>&1
1107d1046
<       chmod 666 $tmp_dir/$$.crs_comp_lines.$crs_case > /dev/null 2>&1
1109d1047
<       chmod 666 $tmp_dir/$$.crs_cli_passed.$crs_case > /dev/null 2>&1
1114d1051
<       chmod 666 $cliinfo.$crs_case > /dev/null 2>&1
1132,1133d1068
<       chmod 666 $tmp_dir/$$.crs_cli_passed.$crs_case > /dev/null 2>&1
<       chmod 666 $tmp_dir/$$.crs_pass_cli.$crs_case > /dev/null 2>&1
1135d1069
<       chmod 666 $tmp_dir/$$.crs_chk_pass.$crs_case > /dev/null 2>&1
1145d1078
<        chmod 666 $tmp_dir/$$.crs_comp_lines.$crs_case > /dev/null 2>&11190d1122
<       chmod 666 $log_dir/$mach.$$.$ITERATION.*.$kj_case.log > /dev/null 2>&1
1197c1129
<          jobsleft=`$RSH $PS -ef | grep lock_test`
---
>          jobsleft=`$RSH ps -e | grep filewnr`
1202,1204c1134,1135
<             pidsleft=`echo $jobsleft | awk '{print $2}'`
<             echo "killing $pidsleft on $mach"
<           $RSH kill -9 $pidsleft
---
>             pidsleft=`echo $jobsleft | awk '{print $1}'`
>             echo "   Could not kill $pidsleft on $mach"
1207c1138
<          echo "Any jobs still running on $mach?"
---
>          echo "No jobs running on $mach..."
1209,1221d1139
< 
<       # above code, while theoretically correct, does not work reliably
<       # and sometimes relict processes are left hanging on client
<       # we arranged that the string "lock_test" is always imbedded
<       # in command lines so we can grep for it
<       # last chance to kill client processes
<       pids=`$RSH $PS -ef | grep lock_test | awk '{print $2}'`
<       for pid in $pids
<       do
<       echo killing $pid on $mach
<       $RSH kill -9 $pid > /dev/null 2>&1
<       done
<       echo killed all jobs on $mach
1224,1229d1141
<    # delete detritus files
<    # all these have been coerced to end in "lock_test"
<    rm -rf $DFS_PATH/*
<    rm -rf $SYNCH_DIR/*
<    rm -rf $LOG_DIR/*
< 
1244,1245d1155
< PS=/usr/bin/ps
< 
1383,1421d1292
< # modify path so we can kill relict client process
< # make sure the string "lock_test" is in the execution path
< # this will work even when running CHO
< 
< rm -f /:/lock_test > /dev/null 2>&1
< ln -s $TROOT /:/lock_test
< TROOT=/:/lock_test
< echo TROOT $TROOT
< 
< # make sure the working directory is private to this test
< # be careful because we sometimes use the same directory
< # for multiple purposes in this test
< 
< rm -rf $DFS_PATH/lock_test > /dev/null 2>&1
< rm -rf $SYNCH_DIR/lock_test > /dev/null 2>&1
< rm -rf $LOG_DIR/lock_test > /dev/null 2>&1
< rm -rf $TMP_DIR/lock_test >  > /dev/null 2>&1
< mkdir $DFS_PATH/lock_test
< chmod 777 $DFS_PATH/lock_test
< DFS_PATH=$DFS_PATH/lock_test
< if test ! -d $SYNCH_DIR/lock_test
< then
<       mkdir $SYNCH_DIR/lock_test
<       chmod 777 $SYNCH_DIR/lock_test
< fi
< SYNCH_DIR=$SYNCH_DIR/lock_test
< if test ! -d $TMP_DIR/lock_test
< then
<       mkdir $TMP_DIR/lock_test
<       chmod 777 $TMP_DIR/lock_test
< fi
< TMP_DIR=$TMP_DIR/lock_test
< if test ! -d $LOG_DIR/lock_test
< then
<       mkdir $LOG_DIR/lock_test
<       chmod 777 $LOG_DIR/lock_test
< fi
< LOG_DIR=$LOG_DIR/lock_test
< 
1634d1504
< chmod 777 ./* > /dev/null 2>&1
1795d1664
<     chmod 666 $cliinfo > /dev/null 2>&1
1941d1809
<        chmod 666 $synch_base.$ITERATION.$curr_case > /dev/null 2>&1
1989,1990d1856
<       kill_jobs $curr_case
< 
2015c1881
<    rm -f $data_base.$ITERATION
---
>    rm $data_base.$ITERATION



dfs.repfs:

1,34d0
< #!/bin/ksh -
< #-
< # @TRANSARC_COPYRIGHT@
< #
< # $TALog: dfs.repfs,v $
< # Revision 12.5  1996/03/20  13:17:25  gait
< # Retrofit Solaris changes back to AIX. Now all tests run
< # smoothly on both platforms.
< #
< # Get running on both platforms.
< # [from r12.3 by delta gait-db17508-repair-system-tests-for-DFS, r1.2]< #
< # Revision 12.3  1995/11/07  19:41:07  moyer
< # Delta created to fix a number of errors in the dfs.repfs test.
< # In particular, there were a number of errors in the manipulation of
< # replication site lists, and the fileset owner was not getting set
< # at creation time.  Other minor improvements were made as well.
< #
< # Function-specific updates:
< #   create_mountpoints() - added chown and chmod of working fileset.
< #   add_rep() - fixed sed args for updating REP_SERVERS_LEFT and REP_AGGRS_LEFT.
< #   same_machine_rep() - removed incorrect and unrequired update of
< #     REP_SERVERS_LEFT and REP_AGGRS_LEFT.
< #   switch_rep() - fixed sed args for removing old (orig) rep site from
< #     REP_SERVERS and REP_AGGRS.
< #   update_fileset() - made dirwrite.sh's file arg a variable set in repfs.data.
< #   main() - added cm checkfilesets at start; fixed add_rep() args
< # General updates:
< #   Added -f flag to all rm's.
< #   Documented some requirements for correctly maintaining rep site lists.
< # [from r12.1 by delta moyer-7072-dfs.repfs-test-fix-various-errors, r1.1]
< #
< # $EndTALog$
< 
44a11,14
> # Revision 1.1.6.1  1995/12/11  21:59:37  root
> #     Submit OSF/DCE 1.2.1
> #     [1995/12/11  20:58:52  root]
> #
48c18
< #
---
> # 
206,208d175
< #
< # Note: for all this list maintenance to work, $1 must be REP_SERVERS_LEFT
< #       and $2 must be REP_AGGRS_LEFT.
210d176
<  servers=$1
211a178
>  servers=$1
218c185
<      ERROR_STRING="ERROR (add_rep): addsite" ; break 
---
>      ERROR_STRING="ERROR (setup_rep): addsite" ; break 
224,226c191,193
<    REP_AGGRS_LEFT=`print ${REP_AGGRS_LEFT} | sed 's/'$A'//'`
<    REP_SERVERS_LEFT=`print ${REP_SERVERS_LEFT} | sed 's/'$S'//'`
<    aggrs=`print ${aggrs} | sed 's/^ *[^ ]* *//'`
---
>    REP_AGGRS_LEFT=`print ${REP_AGGRS_LEFT} | sed 's/'$3'//'`
>    REP_SERVERS_LEFT=`print ${REP_SERVERS_LEFT} | sed 's/'$4'//'`
>    aggrs=`print ${aggrs} | sed 's/^[^ ]* *//'`
242,243d208
<    chown $DCE_PRIN ${MOUNT_PATH}/${FILESET}
<    chmod 755 ${MOUNT_PATH}/${FILESET}
265c230
< # the read/write fileset. REP_SERVERS and REP_AGGRS are set.
---
> # the read/write fileset. REP_SERVERS and REP_AGGRS are updated.
275,276c240,246
<  REP_SERVERS="$FILESET_SERVER"
<  REP_AGGRS="$FILESET_AGGR"
---
>  REP_SERVERS="$FILESET_SERVER $REP_SERVERS"
>  REP_AGGRS="$FILESET_AGGR $REP_AGGRS"
> # update the what's left lists 
> # Note: the FILESET_SERVER and FILESET_AGGR should not be in the lists, but
> #       they should be removed if they are
>  REP_AGGRS_LEFT=`print ${REP_AGGRS_LEFT} | sed 's/'$FILESET_AGGR'//'`
>  REP_SERVERS_LEFT=`print ${REP_SERVERS_LEFT} | sed 's/'$FILESET_SERVER'//'`
315c285
<  rm -rf ${MOUNT_PATH}/${FILESET}/*.$1
---
>  rm -r ${MOUNT_PATH}/${FILESET}/*.$1
361c331
<  rm -rf ${MOUNT_PATH}/${FILESET}/*.M
---
>  rm -r ${MOUNT_PATH}/${FILESET}/*.M
380,383d349
< #
< # Note: for all this list maintenance to work, $1 must be $FILESET_SERVER,
< #       $2 must be $FILESET_AGGR, $3 must be left-most of REP_SERVERS_LEFT,
< #       and $4 must be left-most of REP_AGGRS_LEFT.
410,412c376,378
< # remove old server and aggr from lists; must be last elements of each<  REP_SERVERS=`print ${REP_SERVERS} | sed 's/'$1' *$//'`
<  REP_AGGRS=`print ${REP_AGGRS} | sed 's/'$2' *$//'`
---
> # remove old server and aggr from lists
>  REP_SERVERS=`print ${REP_SERVERS} | sed 's/'$1'//'`
>  REP_AGGRS=`print ${REP_AGGRS} | sed 's/'$2'//'`
422c388
<    ERROR_STRING="ERROR (switch_rep): update_fileset"
---
>    ERROR_STRING="ERROR (same_machine_rep): update_fileset"
435c401
<  rm -rf ${MOUNT_PATH}/${FILESET}/*.N
---
>  rm -r ${MOUNT_PATH}/${FILESET}/*.N
522c488
<      rm -f ${MOUNT_PATH}/${FILESET}/$M.testfile.*
---
>      rm ${MOUNT_PATH}/${FILESET}/$M.testfile.*
525c491
<      rm -rf ${MOUNT_PATH}/${FILESET}/$M.testdir.*
---
>      rm -r ${MOUNT_PATH}/${FILESET}/$M.testdir.*
528d493
<    echo DO: $RSH $M -n dce_login $DCE_PRIN $DCE_PRIN_PW -exec ksh -c "'${TROOT}/filewnr -n 100 -b 100 -p $M.test.$1 -f ${MOUNT_PATH}/${FILESET}/$M.testfile.$1'"
535,537d499
<    chown -R ${DCE_PRIN} ${MOUNT_PATH}/${FILESET}/*
<    chgrp -R ${DCE_PRIN_GROUP} ${MOUNT_PATH}/${FILESET}/*
<    chmod -R 777 ${MOUNT_PATH}/${FILESET}/*
539,540c501
<    echo DO: $RSH $M -n dce_login $DCE_PRIN  $DCE_PRIN_PW -exec ksh -c "'${TROOT}/dirwrite.sh -p ${MOUNT_PATH}/${FILESET} -t $M.testdir.$1 -n 10 -l $BIG_FILE '"
<    $RSH $M -n dce_login $DCE_PRIN  $DCE_PRIN_PW -exec ksh -c "'${TROOT}/dirwrite.sh -p ${MOUNT_PATH}/${FILESET} -t $M.testdir.$1 -n 10 -l $BIG_FILE '"
---
>    $RSH $M -n dce_login $DCE_PRIN  $DCE_PRIN_PW -exec ksh -c "'${TROOT}/dirwrite.sh -p ${MOUNT_PATH}/${FILESET} -t $M.testdir.$1 -n 10 -l /etc/dce_config '"
546,548d506
<    chown -R ${DCE_PRIN} ${MOUNT_PATH}/${FILESET}/*
<    chgrp -R ${DCE_PRIN_GROUP} ${MOUNT_PATH}/${FILESET}/*
<    chmod -R 777 ${MOUNT_PATH}/${FILESET}/*
551d508
<    echo DO: $RSH $M -n dce_login $DCE_PRIN $DCE_PRIN_PW -exec ksh -c "'echo $M.$1 >> ${MOUNT_PATH}/${FILESET}/update-file '"
558,560d514
<    chown -R ${DCE_PRIN} ${MOUNT_PATH}/${FILESET}/*
<    chgrp -R ${DCE_PRIN_GROUP} ${MOUNT_PATH}/${FILESET}/*
<    chmod -R 777 ${MOUNT_PATH}/${FILESET}/*
934d887
< cm checkfilesets
989c942
< add_rep ${REP_SERVERS_LEFT} ${REP_AGGRS_LEFT} || {
---
> add_rep  ${SERVERS_LEFT} ${AGGRS_LEFT} || {


dfs.read_write_all.main:

2,6d1
< 
< #-
< # @TRANSARC_COPYRIGHT@
< #
< 
14a10,20
> # Revision 1.1.10.1  1995/12/11  21:59:32  root
> #     Submit OSF/DCE 1.2.1
> #
> #     HP revision /main/jrr_1.2_mothra/1  1995/12/06  16:12 UTC  bell_d
> #     additions to make test operate on non-LFS dfs
> #
> #           Insert Checks for Machines, Aggregates, and Servers using DFS commands
> #           to locate the information and extract it for use, rather than require
> #     the fixed information in the dfs.read.write.data file
> #     [1995/12/11  20:58:48  root]
> #
18c24
< #
---
> # 
104c110
<      RSH="/bin/rsh"
---
>      RSH="rsh"
196a203,238
> #  Now set the machines names variable based on the set in the hosts file
> 
> MACHINES=`cdscp list dir /.:/hosts/* |awk '{print $1}' |sed 's/LIST//'|\
>   sed 's/DIRECTORY//' |sed 's/AT//'`
> 
> x=0
> for i in ${MACHINES}
> do
>   ((x = x + 1))
> done
> NUMBER_OF_USERS=$x
> 
>   
> #
> #   At this point we've found the list of machines possible for testing.
> #   Now get the number of sites from the fts lsfldb data and use it to determine
> #   how many possible servers there may be.
> #   Also get the server names from the FLDB listing, as well as the aggregate
> #   names associated with each server.
> #
> 
> numb_sites=`fts lsfldb|grep "number of sites"| awk '{print $4}'`
> 
> ## Locate the servers and their aggregates for testing 
> #
> 
> 
>   AGGR_SERVERS=`fts lsfldb |grep ".ch." |awk '{print $1}'|sed 's/.cell//'\
>     |sed 's/.ch//'|sed 's/.apollo//' |sed 's/.hp//'|sed 's/.com//'|sed 's/.c//'\
>     |sed 's/.co//'`
> echo " $AGGR_SERVERS "
>   AGGR_NAMES=`fts lsfldb |grep ".ch." |awk '{print $3}'`
> 
> echo "Aggregates:   $AGGR_NAMES "
> 
> 
267,270d308
<    if [[ $HOSTTYPE = SunOS ]]
<    then
<        ping_command='eval ping $rhost 1'
<    else
277d314
<    fi
417c454
<          u=${BASE_USER_NAME}${n}-fs
---
>          u=${BASE_USER_NAME}${n}
420c457,464
<           print "fts create -ftname ${u}.fs -server ${agger_server} -aggregate ${agger_name}"
---
>           
>           if [ $aggr_type = Non-LFS ]
>           then
>           cd ${i}
>           mkdir ${u}
>           
>           else
>             print "fts create -ftname ${u}.fs -server ${agger_server} -aggregate ${agger_name}"
425,427d468
<             chmod 777 ${i}/${u}
<             chown ${DCE_PRIN} ${i}/${u}
<             chgrp ${DCE_PRIN_GROUP} ${i}/${u}
432a474
>         fi
434a477,482
>             
>             if [ $aggr_type = Non-LFS ]
>             then
>            cd ${i}
>            rm -R ${u}
>           else
440a489
>           fi
474c523
<         ${RSH} $rhost cm check
---
>         ${RSH} $rhost -n -l ${BASE_USER_NAME}1 cm check
522,530c571,580
<       print "${CHMOD} 777 ${i}"
<       ${CHMOD} 777 ${i}
<         print "${COPY} ${TROOT}/${USER_PROFILE} ${i}-fs/.${USER_PROFILE}"
<         ${COPY} ${TROOT}/${USER_PROFILE} ${i}-fs/.${USER_PROFILE}
<         print "${COPY} ${TROOT}/${TODO_SCRIPT} ${i}-fs/${TODO_SCRIPT}"<         ${COPY} ${TROOT}/${TODO_SCRIPT} ${i}-fs/${TODO_SCRIPT}
<       chmod 777 ${i}-fs/${TODO_SCRIPT}
<         print "${CHMOD} -R 777 ${i}-fs"
<         ${CHMOD} -R 777 ${i}-fs
---
>         print "${COPY} ${TROOT}/${USER_PROFILE} ${i}/.${USER_PROFILE}">         ${COPY} ${TROOT}/${USER_PROFILE} ${i}/.${USER_PROFILE}
>         print "${COPY} ${TROOT}/${TODO_SCRIPT} ${i}/${TODO_SCRIPT}"
>         ${COPY} ${TROOT}/${TODO_SCRIPT} ${i}/${TODO_SCRIPT}
>         print "${CHOWN} -R ${BASE_USER_NAME}${n} ${i}"
>         ${CHOWN} -R ${BASE_USER_NAME}${n} ${i}
>         print "${CHMOD} -R 755 ${i}"
>         ${CHMOD} -R 755 ${i}
>         print "${CHGRP} -R ${GROUP_NAME} ${i}"
>         ${CHGRP} -R ${GROUP_NAME} ${i}
567,568c617
< echo DO: ${RSH} ${m} ${DCE_LOGIN} ${u} ${DFS_USER_PWD} -exec ${user_home}-fs/${TODO_SCRIPT} ${COMMON_LOG_FILE} ${u} ${TIME_TO_RUN}
<        ${RSH} ${m} ${DCE_LOGIN} ${u} ${DFS_USER_PWD} -exec ${user_home}-fs/${TODO_SCRIPT} ${COMMON_LOG_FILE} ${u} ${TIME_TO_RUN} > ${LOCAL_LOG_DIR}/${m}.${u}.log 2>&1 &
---
>        ${RSH} ${m} -n -l ${u} ${DCE_LOGIN} ${u} ${DFS_USER_PWD} -exec ${user_home}/${TODO_SCRIPT} ${COMMON_LOG_FILE} ${u} ${TIME_TO_RUN} > ${LOCAL_LOG_DIR}/${m}.${u}.log 2>&1 &
796c845,846
<       if [[ $aggr_type != LFS ]]
---
> 
>       if [[ $aggr_type = LFS ]]
798,800c848,855
<         print "FAILED - $aggr_name on $rhost is NOT an LFS aggregate."<         print "$PROGNAME exiting."
<         exit 1
---
>         aggr_free=`print $aggr_info | awk '{print $5}'`
>         if (( aggr_size > aggr_free ))
>         then
>            print "FAILED - Info on $rhost aggregate $aggr_name incorrect."
>            print "Only $aggr_free K free, not $aggr_size."
>            print "$PROGNAME exiting."
>            exit 1
>         fi
802,810d856
<       aggr_free=`print $aggr_info | awk '{print $5}'`
<       if (( aggr_size > aggr_free ))
<       then
<         print "FAILED - Info on $rhost aggregate $aggr_name incorrect."
<         print "Only $aggr_free K free, not $aggr_size."
<         print "$PROGNAME exiting."
<         exit 1
<       fi
< 
834,835c880,881
<       ruid_rgids=`${RSH} $rhost grep $user /etc/passwd`
<       ruid=`print $ruid_rgids | awk -F: '{print $3}'`
---
>         ruid_rgids=`${RSH} $rhost -n -l $user id`
>         ruid=`print $ruid_rgids | awk -F= '{print $2}' | awk -F\( '{print $1}'`
903d948
<      echo Wait for $pid
965d1009
< cm checkfilesets
969c1013
< check_dirs "${BASE_MOUNT_POINTS}" "777"
---
> check_dirs "${BASE_MOUNT_POINTS}" "755"
1006d1049
< cm checkfilesets


dirwrite.sh:

2,3d1
< #-
< # @TRANSARC_COPYRIGHT@
5d2
< 
13a11,14
> # Revision 1.1.6.1  1995/12/11  22:00:06  root
> #     Submit OSF/DCE 1.2.1
> #     [1995/12/11  20:59:16  root]
> #
19c20
< #
---
> # 
78c79
< HOST=`uname -n`
---
> HOST=`hostname`
99c100
< ME=`/usr/ucb/whoami`
---
> ME=`whoami`


do.ksh:

1,21d0
< #!/bin/ksh -
< #-
< # @TRANSARC_COPYRIGHT@
< #
< # $TALog: do.ksh,v $
< # Revision 12.5  1996/03/20  13:17:27  gait
< # Retrofit Solaris changes back to AIX. Now all tests run
< # smoothly on both platforms.
< #
< # Get running on both platforms.
< # [from r12.4 by delta gait-db17508-repair-system-tests-for-DFS, r1.2]< #
< # Revision 12.4  1996/03/18  15:18:23  gait
< # Fix several broken system tests that are used by OSF to test DFS.
< # The fixes are for both Solaris and AIX.
< #
< # Fixes as above.
< # [from r12.1 by delta gait-db17508-repair-system-tests-for-DFS, r1.1]< #
< # $EndTALog$
< 
30a10,13
> # Revision 1.1.8.1  1995/12/11  22:00:08  root
> #     Submit OSF/DCE 1.2.1
> #     [1995/12/11  20:59:17  root]
> #
34c17
< #
---
> # 
111d93
<      chmod 777 $myhome/$i
180,187c162,169
<       cp /opt/dcelocal/etc/cds.conf .
<       dd if=$myhome/myfiles/cds.conf of=$myhome/myfiles/cds.conf.upper conv=ucase
<       dd if=$myhome/myfiles/cds.conf.upper of=$myhome/myfiles/cds.conf.lower conv=lcase
<       rm cds.conf.upper 
<       cat $myhome/myfiles/cds.conf.lower | tr '[a-z]' '[A-Z]' > $myhome/myfiles/cds.conf.upper
<       rm $myhome/myfiles/cds.conf.lower
<       cat $myhome/myfiles/cds.conf.upper | tr '[A-Z]' '[a-z]' > $myhome/myfiles/cds.conf.lower
<       rm cds.conf cds.conf.upper $myhome/myfiles/cds.conf.lower
---
>       cp /opt/dcelocal/etc/dce_config .
>       dd if=$myhome/myfiles/dce_config of=$myhome/myfiles/dce_config.upper conv=ucase
>       dd if=$myhome/myfiles/dce_config.upper of=$myhome/myfiles/dce_config.lower conv=lcase
>       rm dce_config.upper 
>       cat $myhome/myfiles/dce_config.lower | tr '[a-z]' '[A-Z]' > $myhome/myfiles/dce_config.upper
>       rm $myhome/myfiles/dce_config.lower
>       cat $myhome/myfiles/dce_config.upper | tr '[A-Z]' '[a-z]' > $myhome/myfiles/dce_config.lower
>       rm dce_config dce_config.upper $myhome/myfiles/dce_config.lower
231c213
< . ./.profile
---
> . .profile
235c217
< host=`/bin/hostname`
---
> host=`hostname`



CR Number                     : 13309
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : tc_slv_delfrc unable to determine replica deletion
Reported Date                 : 2/7/96
Found in Baseline             : 1.2.1
Found Date                    : 2/7/96
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/7/96 public]

       Replica deletion in tc_slv_delfrc is unable to confirm that 
       the replica has been deleted.
       
	|............  
	|............  subsys/dce/sec/blu2 (master)
	| 
	|........ subsys/dce/sec/ibm_l3 on subsys/dce/sec/blu2 subsys/dce/sec/knuckle's replist
	| 
	|**** ERROR **** : subsys/dce/sec/ibm_l3 exists on some replica lists :
	   subsys/dce/sec/blu2 subsys/dce/sec/knuckle
	|.... Checking if ibm_l3 is a replica
	|........ Waiting until secd started on hosts: ibm_l3
	|........ secd running on ibm_l3
	|**** ERROR **** : ibm_l3 is not a replica because : 
	|**** ERROR **** : registry does not exist
	|**** ERROR **** : The .mkey file does not exist
	|**** ERROR **** : Failed to verify if replica subsys/dce/sec/ibm_l3 deleted 
	   (delrep -force)
	|
	|+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



CR Number                     : 13308
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : svccfg003 fails with notice of log not created
Reported Date                 : 2/7/96
Found in Baseline             : 1.2.1
Found Date                    : 2/7/96
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/7/96 public]

svcc003 fails with the following message when it executes on AIX:

	|According to /etc/rc.dce, the following DCE dced daemons
	|  are configured to run on this machine:
	|dced
	|FAILURE: /usr/tmp/svc_logs/DASH-W/dced.NOTICE not created
	|FAIL



CR Number                     : 13134
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : update/query
Short Description             : query on heavily traffic'ed net fails
Reported Date                 : 10/2/95
Found in Baseline             : 1.2
Found Date                    : 08/22/95
Severity                      : E
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : query.c
Sensitivity                   : public

[10/2/95 public]

On a heavily loaded network the Security query test after update will 
have a varying number (2 or 3) of errors because it is unforgiving 
in its time limits to get information over the net.



CR Number                     : 13133
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcerpidl5
Short Description             : dcerpidl5 test executable dumps core
Reported Date                 : 10/2/95
Found in Baseline             : 1.2
Found Date                    : 09/04/95
Severity                      : E
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/2/95 public]

dcerpidl5 test does not operate, the test executable repas_client 
dumps core.  This has been the case for quite a while, according to 
SQA here.  This problem has been seen in all versions of DCE to date. 
Because of the way the test is written, it will dump core, but give 
a tet_result of "pass."  This is because it looks for failure information 
in a log file, which never gets there because of the core dump.



CR Number                     : 13132
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : hclrel001
Short Description             : hclrel001 run to same cell fails
Reported Date                 : 10/2/95
Found in Baseline             : 1.1
Found Date                    : 06/21/95
Severity                      : E
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/2/95 public]

When hclrel001 is run with the same cell name twice as its arguements, 
(so that it runs to the same cell) it fails.  This is a problem with 
the test itself, and not DCE intercell. 

to itself



CR Number                     : 13116
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : systest
Subcomponent Name             : rpc, sec, dced, dcecp, thr, systest
Short Description             : SVR4 porting changes
Reported Date                 : 9/11/95
Found in Baseline             : 1.1
Found Date                    : 9/11/95
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/11/95 public]

SVR4 porting changes from support customer:

*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/aud/audevents_show_P.tcl	Tue Dec 13 11:06:41 1994
--- ./test/functional/admin/dcecp/ts/aud/audevents_show_P.tcl	Tue May  2 12:08:31 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:04:18  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.2  1994/10/01  01:33:24  rousseau
  # 	Updated for auditd changes.
  # 	[1994/10/01  01:24:54  rousseau]
! #
  # Revision 1.1.2.1  1994/09/28  21:38:08  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:06:47  melman]
--- 8,24 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:08:29  tomj
! # 	Change audit event codes to start at 0x300, instead of 0x100
! # 	security uses 0x100.
  #
+ # Revision 2.1  1994/12/13  16:04:18  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.2  1994/10/01  01:33:24  rousseau
  # 	Updated for auditd changes.
  # 	[1994/10/01  01:24:54  rousseau]
! # 
  # Revision 1.1.2.1  1994/09/28  21:38:08  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:06:47  melman]
***************
*** 70,76 ****
      # Run the test
      test {
  	audevents show {dce_audit_filter_modify}
!     } compare_strings {{dce_audit_filter_modify 0x100 0x103 0x104}}
  
      # Cleanup steps
  }
--- 74,80 ----
      # Run the test
      test {
  	audevents show {dce_audit_filter_modify}
!     } compare_strings {{dce_audit_filter_modify 0x300 0x303 0x304}}
  
      # Cleanup steps
  }
***************
*** 84,90 ****
      # Run the test
      test {
  	audevents show [audevents cat]
!     } compare_lists {{dce_audit_admin_modify 0x105 0x106 0x107 0x108} {dce_audit_admin_query 0x109 0x10a} {dce_audit_filter_modify 0x100 0x103 0x104} {dce_audit_filter_query 0x101 0x102} {dce_dts_mgt_modify 0x200 0x201 0x202 0x203 0x207 0x208 0x209 0x20a} {dce_dts_mgt_query 0x20b 0x20c 0x20d 0x20e 0x20f 0x210} {dce_dts_synch 0x204 0x205 0x206} {dce_dts_time_provider 0x211 0x212} {dce_sec_authent 0x101 0x102 0x103 0x104 0x10c 0x125} {dce_sec_control 0x105 0x106 0x107 0x108 0x109 0x10a 0x10b 0x10c 0x10d 0x10e 0x10f 0x110 0x111 0x112 0x113 0x114 0x115 0x116 0x117 0x118 0x119 0x11a 0x11b 0x11c 0x11d 0x11e 0x11f 0x120 0x121 0x122 0x123 0x124 0x125 0x126 0x127 0x128 0x129 0x12a} {dce_sec_modify 0x106 0x10d 0x10e 0x10f 0x111 0x114 0x115 0x116 0x117 0x11a 0x11b 0x11f 0x121 0x123} {dce_sec_query 0x105 0x107 0x108 0x109 0x10a 0x10b 0x110 0x112 0x113 0x118 0x11c 0x11d 0x11e 0x120 0x122} {dce_sec_server 0x124 0x125 0x126 0x127 0x128}}
  
      # Cleanup steps
  }
--- 88,94 ----
      # Run the test
      test {
  	audevents show [audevents cat]
!     } compare_lists {{dce_audit_admin_modify 0x305 0x306 0x307 0x308} {dce_audit_admin_query 0x309 0x30a} {dce_audit_filter_modify 0x300 0x303 0x304} {dce_audit_filter_query 0x301 0x302} {dce_dts_mgt_modify 0x200 0x201 0x202 0x203 0x207 0x208 0x209 0x20a} {dce_dts_mgt_query 0x20b 0x20c 0x20d 0x20e 0x20f 0x210} {dce_dts_synch 0x204 0x205 0x206} {dce_dts_time_provider 0x211 0x212} {dce_sec_authent 0x101 0x102 0x103 0x104 0x10c 0x125} {dce_sec_control 0x105 0x106 0x107 0x108 0x109 0x10a 0x10b 0x10c 0x10d 0x10e 0x10f 0x110 0x111 0x112 0x113 0x114 0x115 0x116 0x117 0x118 0x119 0x11a 0x11b 0x11c 0x11d 0x11e 0x11f 0x120 0x121 0x122 0x123 0x124 0x125 0x126 0x127 0x128 0x129 0x12a} {dce_sec_modify 0x106 0x10d 0x10e 0x10f 0x111 0x114 0x115 0x116 0x117 0x11a 0x11b 0x11f 0x121 0x123} {dce_sec_query 0x105 0x107 0x108 0x109 0x10a 0x10b 0x110 0x112 0x113 0x118 0x11c 0x11d 0x11e 0x120 0x122} {dce_sec_server 0x124 0x125 0x126 0x127 0x128}}
  
      # Cleanup steps
  }
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/aud/audtrail_show_P.tcl	Tue Dec 13 11:06:50 1994
--- ./test/functional/admin/dcecp/ts/aud/audtrail_show_P.tcl	Tue May  2 12:08:35 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:04:28  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:38:21  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:01  melman]
! #
  # Revision 1.1.2.5  1994/06/10  20:03:26  devsrc
  # 	cr10872 - fixed copyright
  # 	[1994/06/10  16:53:02  devsrc]
--- 8,23 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:08:33  tomj
! # 	Make sure tmp file is removed before and after test.
  #
+ # Revision 2.1  1994/12/13  16:04:28  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:38:21  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:01  melman]
! # 
  # Revision 1.1.2.5  1994/06/10  20:03:26  devsrc
  # 	cr10872 - fixed copyright
  # 	[1994/06/10  16:53:02  devsrc]
***************
*** 127,132 ****
--- 130,136 ----
      tet_infoline audtrail_show_7_P: Check that we can dump an audit trail to a file using -to.
  
      # Setup steps
+     catch {exec rm -f $DCP_AUD_TRAIL_OUTFILE } donotcare
  
      # Run the test
      if {([catch {audtrail show $TET_ROOT/$DCP_AUD_TRAIL_FILE_1 -to $DCP_AUD_TRAIL_OUTFILE} msg] != 0) || ([file exists $DCP_AUD_TRAIL_OUTFILE] == 0)} {
***************
*** 139,144 ****
--- 143,149 ----
      }
  
      # Cleanup steps
+     catch {exec rm -f $DCP_AUD_TRAIL_OUTFILE } donotcare
  }
  
  
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/cds/clearinghouse_create_P.tcl	Tue Dec 13 11:06:59 1994
--- ./test/functional/admin/dcecp/ts/cds/clearinghouse_create_P.tcl	Tue May  2 12:08:38 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:04:36  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:38:33  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:17  melman]
! #
  # Revision 1.1.2.5  1994/09/06  13:14:35  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:39  kevins]
--- 8,26 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:08:36  tomj
! # 	Sleep before removing freshly created clearinghouses.
! # 	If the replicated root directory is still in the 'new' state
! # 	when the delete request arrives, the directory isn't (and can't be)
! # 	removed so the clearinghouse can't be removed.
  #
+ # Revision 2.1  1994/12/13  16:04:36  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:38:33  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:17  melman]
! # 
  # Revision 1.1.2.5  1994/09/06  13:14:35  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:39  kevins]
***************
*** 72,77 ****
--- 78,86 ----
           } dcp_find_pgo clrcr_ch
  
      # Cleanup steps
+     # if we delete too fast, it wont work
+     exec sleep 10
+ 
          # The clearinghouses /.:/clrcr_ch must be deleted
      if {[dcp_wrap {clearinghouse delete /.:/clrcr_ch}] != 0} {return;}
  }
***************
*** 95,100 ****
--- 104,112 ----
          # Successful completion
  
      # Cleanup steps
+     # if we delete too fast, it wont work
+     exec sleep 10
+ 
          # The clearinghouses /.:/clrcr_ch /.:/clrcl1_ch must be deleted. 
      if {[dcp_wrap {clearinghouse delete {/.:/clrcr_ch /.:/clrcl1_ch}}] != 0} {return;}
  
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/cds/clearinghouse_delete_P.tcl	Tue Dec 13 11:07:01 1994
--- ./test/functional/admin/dcecp/ts/cds/clearinghouse_delete_P.tcl	Tue May  2 12:08:41 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:04:38  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:38:35  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:22  melman]
! #
  # Revision 1.1.2.5  1994/09/06  13:14:37  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:47  kevins]
--- 8,26 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:08:39  tomj
! # 	Sleep before removing the freshly created clearinghouses.
! # 	If the replicated root directory is still in the 'new' state
! # 	when the delete request arrives, the directory isn't (and can't be)
! # 	removed so the clearinghouse can't be removed.
  #
+ # Revision 2.1  1994/12/13  16:04:38  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:38:35  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:22  melman]
! # 
  # Revision 1.1.2.5  1994/09/06  13:14:37  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:47  kevins]
***************
*** 67,72 ****
--- 73,81 ----
          # Clearinghouse /.:/clrd_ch  must exist 
      if {[dcp_wrap {clearinghouse create /.:/clrd_ch}] != 0} {return;}
  
+     # can't delete the clearinghouse too fast or it will fail
+     exec sleep 10
+ 
      # Run the test
      test { clearinghouse delete /.:/clrd_ch
           dcp_missing [directory list /.: -object -simple] clrd_ch
***************
*** 86,91 ****
--- 95,103 ----
          # Must be on the machine that contains the cdsd process.
          # Clearinghouses /.:/clrd_ch /.:/clrd1_ch must exist. 
      if {[dcp_wrap {clearinghouse create {/.:/clrd_ch /.:/clrd1_ch}}] != 0} {return;}
+ 
+     # can't delete the clearinghouse too fast or it will fail
+     exec sleep 10
  
      # Run the test
      test { clearinghouse delete {/.:/clrd_ch /.:/clrd1_ch} 
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/cds/clearinghouse_disable_P.tcl	Tue Dec 13 11:07:03 1994
--- ./test/functional/admin/dcecp/ts/cds/clearinghouse_disable_P.tcl	Tue May  2 12:09:52 1995
***************
*** 7,20 ****
  #
  #
  # HISTORY
! # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:04:40  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:38:37  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:26  melman]
! #
  # Revision 1.1.2.5  1994/09/06  13:14:38  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:52  kevins]
--- 7,25 ----
  #
  #
  # HISTORY
! # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:09:50  tomj
! # 	Sleep between create and delete of clearinghouse.
! # 	Hack tests not to fail because delete command returns non-zero
! # 	and test driver thinks this means failure.
  #
+ # Revision 2.1  1994/12/13  16:04:40  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:38:37  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:26  melman]
! # 
  # Revision 1.1.2.5  1994/09/06  13:14:38  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:52  kevins]
***************
*** 69,80 ****
  
      # Run the test
      test { clearinghouse disable /.:/clrdi_ch 
!          clearinghouse delete /.:/clrdi_ch
!          } compare_strings {Specified clearinghouse does not exist}
  
  
      # Cleanup steps
      if {[dcp_wrap {clearinghouse create /.:/clrdi_ch}] != 0} {return;}
      if {[dcp_wrap {clearinghouse delete /.:/clrdi_ch}] != 0} {return;}
  }
  
--- 74,87 ----
  
      # Run the test
      test { clearinghouse disable /.:/clrdi_ch 
!          catch {clearinghouse delete /.:/clrdi_ch} out
! 	 list $out
!          } compare_strings {{Specified clearinghouse does not exist}}
  
  
      # Cleanup steps
      if {[dcp_wrap {clearinghouse create /.:/clrdi_ch}] != 0} {return;}
+     exec sleep 10
      if {[dcp_wrap {clearinghouse delete /.:/clrdi_ch}] != 0} {return;}
  }
  
***************
*** 92,102 ****
  
      # Run the test
      test { clearinghouse disable {/.:/clrdi_ch /.:/clrdi1_ch}
!          clearinghouse delete  {/.:/clrdi_ch /.:/clrdi1_ch}
!          } compare_strings {Specified clearinghouse does not exist}
  
      # Cleanup steps
      if {[dcp_wrap {clearinghouse create {/.:/clrdi_ch /.:/clrdi1_ch} }] != 0} {return;}
      if {[dcp_wrap {clearinghouse delete {/.:/clrdi_ch /.:/clrdi1_ch} }] != 0} {return;}
  }
  
--- 99,111 ----
  
      # Run the test
      test { clearinghouse disable {/.:/clrdi_ch /.:/clrdi1_ch}
!          catch {clearinghouse delete {/.:/clrdi_ch /.:/clrdi1_ch}} out
! 	 list $out
!          } compare_strings {{Specified clearinghouse does not exist}}
  
      # Cleanup steps
      if {[dcp_wrap {clearinghouse create {/.:/clrdi_ch /.:/clrdi1_ch} }] != 0} {return;}
+     exec sleep 10
      if {[dcp_wrap {clearinghouse delete {/.:/clrdi_ch /.:/clrdi1_ch} }] != 0} {return;}
  }
  
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/cds/clearinghouse_show_P.tcl	Tue Dec 13 11:07:05 1994
--- ./test/functional/admin/dcecp/ts/cds/clearinghouse_show_P.tcl	Tue May  2 12:09:55 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:04:42  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:38:40  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:31  melman]
! #
  # Revision 1.1.2.5  1994/09/06  13:14:40  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:59  kevins]
--- 8,26 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:09:53  tomj
! # 	Sleep before removing the freshly created clearinghouses.
! # 	If the replicated root directory is still in the 'new' state
! # 	when the delete request arrives, the directory isn't (and can't be)
! # 	removed so the clearinghouse can't be removed.
  #
+ # Revision 2.1  1994/12/13  16:04:42  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:38:40  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:07:31  melman]
! # 
  # Revision 1.1.2.5  1994/09/06  13:14:40  kevins
  # 	OT 10617 modified messages in negative tests
  # 	[1994/09/06  12:30:59  kevins]
***************
*** 73,78 ****
--- 79,86 ----
           } compare_strings found 
  
      # Cleanup steps
+     # If we delete too fast, it will fail
+     exec sleep 10
      if {[dcp_wrap {clearinghouse delete /.:/clrsh_ch}] != 0} {return;}
  }
  
***************
*** 92,97 ****
--- 100,107 ----
         } compare_strings found
  
      # Cleanup steps
+     # If we delete too fast, it will fail
+     exec sleep 10
      if {[dcp_wrap {clearinghouse delete {/.:/clrsh_ch /.:/clrsh1_ch}}] != 0} {return;}
  }
  
***************
*** 105,110 ****
--- 115,121 ----
      # Setup steps
          # Must be running as cell administrator.
      if {[dcp_wrap {clearinghouse create /.:/clrsh_ch }] != 0} {return;}
+     exec sleep 10
  
      # Run the test
      test {
***************
*** 112,117 ****
--- 123,130 ----
           } compare_strings found
  
      # Cleanup steps
+     # If we delete too fast, it will fail
+     exec sleep 10
      if {[dcp_wrap {clearinghouse delete /.:/clrsh_ch}] != 0} {return;}
  }
  
***************
*** 125,130 ****
--- 138,144 ----
      # Setup steps
          # Must be running as cell administrator. 
      if {[dcp_wrap {clearinghouse create /.:/clrsh_ch}] != 0} {return;}
+     exec sleep 10
  
      # Run the test
      test { 
***************
*** 132,137 ****
--- 146,153 ----
           } compare_strings found
  
      # Cleanup steps
+     # If we delete too fast, it will fail
+     exec sleep 10
      if {[dcp_wrap {clearinghouse delete /.:/clrsh_ch}] != 0} {return;}
  }
  
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/ktb/keytab_add_N.tcl	Tue Dec 13 11:08:03 1994
--- ./test/functional/admin/dcecp/ts/ktb/keytab_add_N.tcl	Tue May  2 12:09:58 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:05:39  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.2  1994/09/29  22:01:32  baum
  # 	Fixed negative messages (OT 12370)
  # 	[1994/09/29  22:01:06  baum]
! #
  # Revision 1.1.2.1  1994/09/28  21:40:19  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:09:32  melman]
--- 8,24 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:09:56  tomj
! # 	For unauthenticated test, we don't care about the logout result
! # 	and corrected the expected error message.
  #
+ # Revision 2.1  1994/12/13  16:05:39  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.2  1994/09/29  22:01:32  baum
  # 	Fixed negative messages (OT 12370)
  # 	[1994/09/29  22:01:06  baum]
! # 
  # Revision 1.1.2.1  1994/09/28  21:40:19  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:09:32  melman]
***************
*** 190,201 ****
      tet_infoline keytab_add_9_N: Check that unauthenticated users are handled correctly.
  
      # Setup steps
!     if {[dcp_wrap {logout}] != 0} {return;}
  
      # Run the test
      test {
          list [catch {keytab add ktb2 -member test_princ1 -random -registry} msg] $msg
!     } compare_strings {1 {No currently established network identity for which context exists}}
  
      # Cleanup steps
  }
--- 194,206 ----
      tet_infoline keytab_add_9_N: Check that unauthenticated users are handled correctly.
  
      # Setup steps
!     #if {[dcp_wrap {logout}] != 0} {return;}
!     catch {logout} donotcare
  
      # Run the test
      test {
          list [catch {keytab add ktb2 -member test_princ1 -random -registry} msg] $msg
!     } compare_strings {1 {Not authenticated}}
  
      # Cleanup steps
  }
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/misc/shell_P.tcl	Tue Dec 13 11:08:33 1994
--- ./test/functional/admin/dcecp/ts/misc/shell_P.tcl	Tue May  2 12:10:01 1995
***************
*** 8,20 ****
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:06:10  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:41:13  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:10:26  melman]
! #
  # Revision 1.1.2.2  1994/06/17  18:43:32  devsrc
  # 	cr10872 - fix copyright
  # 	[1994/06/17  18:27:00  devsrc]
--- 8,23 ----
  #
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:09:59  tomj
! # 	Don't give explicit path for hostname
  #
+ # Revision 2.1  1994/12/13  16:06:10  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:41:13  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:10:26  melman]
! # 
  # Revision 1.1.2.2  1994/06/17  18:43:32  devsrc
  # 	cr10872 - fix copyright
  # 	[1994/06/17  18:27:00  devsrc]
***************
*** 46,55 ****
      tet_infoline shell_1_P: Verify that we can run a command from the OS.
  
      # Setup steps
!     if {[dcp_wrap {set HOSTNAME [exec /bin/hostname]}] != 0} {return;}
  
      # Run the test
!     test { shell /bin/hostname } compare_strings $HOSTNAME
  
      # The command should return the output of the local OS's 'hostname'
      # command.
--- 49,58 ----
      tet_infoline shell_1_P: Verify that we can run a command from the OS.
  
      # Setup steps
!     if {[dcp_wrap {set HOSTNAME [exec hostname]}] != 0} {return;}
  
      # Run the test
!     test { shell hostname } compare_strings $HOSTNAME
  
      # The command should return the output of the local OS's 'hostname'
      # command.
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/secval/secval_cleanup.tcl	Tue Dec 13 11:11:39 1994
--- ./test/functional/admin/dcecp/ts/secval/secval_cleanup.tcl	Tue May  2 12:10:04 1995
***************
*** 8,20 ****
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:09:16  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:46:04  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:14  melman]
! #
  # Revision 1.1.2.2  1994/06/17  18:44:04  devsrc
  # 	cr10872 - fix copyright
  # 	[1994/06/17  18:29:40  devsrc]
--- 8,23 ----
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:10:02  tomj
! # 	Use explicit path for tet_setup.
  #
+ # Revision 2.1  1994/12/13  16:09:16  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:46:04  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:14  melman]
! # 
  # Revision 1.1.2.2  1994/06/17  18:44:04  devsrc
  # 	cr10872 - fix copyright
  # 	[1994/06/17  18:29:40  devsrc]
***************
*** 41,49 ****
  	    
      # Delete acl entry user:cell_admin
      set rescode [catch \
! 		{exec tet_setup secval_cleanup.sh $DCP_HOSTNAME_THREE} result]
      if {$rescode != 0} {
! 	tet_infoline Command failed: exec tet_setup secval_cleanup.sh \
  	$DCP_HOSTNAME_THREE
  	tet_infoline Command returned: $result
  	tet_infoline Test aborted.
--- 44,52 ----
  	    
      # Delete acl entry user:cell_admin
      set rescode [catch \
! 		{exec $TET_ROOT/tools/tet_setup secval_cleanup.sh $DCP_HOSTNAME_THREE} result]
      if {$rescode != 0} {
! 	tet_infoline Command failed: exec $TET_ROOT/tools/tet_setup secval_cleanup.sh \
  	$DCP_HOSTNAME_THREE
  	tet_infoline Command returned: $result
  	tet_infoline Test aborted.
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/secval/secval_setup.tcl	Tue Dec 13 11:11:43 1994
--- ./test/functional/admin/dcecp/ts/secval/secval_setup.tcl	Tue May  2 12:10:07 1995
***************
*** 8,20 ****
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:09:20  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:46:12  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:20  melman]
! #
  # Revision 1.1.2.2  1994/06/17  18:44:05  devsrc
  # 	cr10872 - fix copyright
  # 	[1994/06/17  18:29:44  devsrc]
--- 8,23 ----
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:10:05  tomj
! # 	Use explicit path for tet_setup.
  #
+ # Revision 2.1  1994/12/13  16:09:20  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:46:12  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:20  melman]
! # 
  # Revision 1.1.2.2  1994/06/17  18:44:05  devsrc
  # 	cr10872 - fix copyright
  # 	[1994/06/17  18:29:44  devsrc]
***************
*** 41,49 ****
  		
      # Add acl entry user:cell_admin
      set rescode [catch \
! 		{exec tet_setup secval_setup.sh $DCP_HOSTNAME_THREE} result]
      if {$rescode != 0} {
! 	tet_infoline Command failed: exec tet_setup secval_setup.sh \
  						  $DCP_HOSTNAME_THREE
  	tet_infoline Command returned: $result
  	tet_infoline Test aborted.
--- 44,52 ----
  		
      # Add acl entry user:cell_admin
      set rescode [catch \
! 		{exec $TET_ROOT/tools/tet_setup secval_setup.sh $DCP_HOSTNAME_THREE} result]
      if {$rescode != 0} {
! 	tet_infoline Command failed: exec $TET_ROOT/tools/tet_setup secval_setup.sh \
  						  $DCP_HOSTNAME_THREE
  	tet_infoline Command returned: $result
  	tet_infoline Test aborted.
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/secval/secval_status_P.tcl	Tue Dec 13 11:11:44 1994
--- ./test/functional/admin/dcecp/ts/secval/secval_status_P.tcl	Tue May  2 12:10:10 1995
***************
*** 8,20 ****
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:09:21  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:46:15  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:22  melman]
! #
  # Revision 1.1.2.1  1994/09/01  20:24:43  pwang
  # 	Initial implementation
  # 	[1994/09/01  20:19:56  pwang]
--- 8,23 ----
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:10:08  tomj
! # 	Turn secval back on after last test otherwise cell is hosed!
  #
+ # Revision 2.1  1994/12/13  16:09:21  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:46:15  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:22  melman]
! # 
  # Revision 1.1.2.1  1994/09/01  20:24:43  pwang
  # 	Initial implementation
  # 	[1994/09/01  20:19:56  pwang]
***************
*** 124,129 ****
--- 127,133 ----
      } compare_strings {0 0}
  
      # Cleanup steps
+     catch {secval activate} donotcare
  }
  
  set iclist "ic1 ic2 ic3 ic4 ic5 "
*** /animal/build/dce1.1/src/./test/functional/admin/dcecp/ts/server/server_stop_P.tcl	Tue Dec 13 11:12:03 1994
--- ./test/functional/admin/dcecp/ts/server/server_stop_P.tcl	Tue May  2 12:10:13 1995
***************
*** 8,20 ****
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1  1994/12/13  16:09:40  devrcs
! # OSF DCE 1.1 Source
  #
  # Revision 1.1.2.1  1994/09/28  21:46:58  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:51  melman]
! #
  # Revision 1.1.2.5  1994/09/20  22:12:22  pwang
  # 	Used match_string.
  # 	[1994/09/20  22:11:38  pwang]
--- 8,23 ----
  # 
  # HISTORY
  # $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
! # Revision 2.1.1.2  1995/05/02  16:10:11  tomj
! # 	Check for core files with pids for unixware2.0
  #
+ # Revision 2.1  1994/12/13  16:09:40  devrcs
+ # 	OSF DCE 1.1 Source
+ # 
  # Revision 1.1.2.1  1994/09/28  21:46:58  melman
  # 	moved admin tests to test/functional
  # 	[1994/09/28  21:14:51  melman]
! # 
  # Revision 1.1.2.5  1994/09/20  22:12:22  pwang
  # 	Used match_string.
  # 	[1994/09/20  22:11:38  pwang]
***************
*** 136,142 ****
      # Setup steps
      catch {server stop tserver -method hard} dontcare 
      if {[dcp_wrap {server start tserver}] != 0} {return;}
!     catch {exec rm -f $TET_ROOT/functional/admin/dcecp/ts/server/core} dontcare
  
      # Run the test
      test {
--- 139,145 ----
      # Setup steps
      catch {server stop tserver -method hard} dontcare 
      if {[dcp_wrap {server start tserver}] != 0} {return;}
!     catch {exec rm -f $TET_ROOT/functional/admin/dcecp/ts/server/core*} dontcare
  
      # Run the test
      test {
***************
*** 145,156 ****
  
      exec sleep 20
      test {
!       list [catch {exec ls $TET_ROOT/functional/admin/dcecp/ts/server/core} msg] $msg
!     } compare_strings "0 $TET_ROOT/functional/admin/dcecp/ts/server/core"
  
      # Cleanup steps
      catch {server stop tserver -method hard} dontcare 
!     catch {exec rm -f $TET_ROOT/functional/admin/dcecp/ts/server/core} dontcare
  }
  
  
--- 148,159 ----
  
      exec sleep 20
      test {
!       list [catch {exec ls $TET_ROOT/functional/admin/dcecp/ts/server/core*} msg] $msg
!     } compare_strings "0 $TET_ROOT/functional/admin/dcecp/ts/server/core*"
  
      # Cleanup steps
      catch {server stop tserver -method hard} dontcare 
!     catch {exec rm -f $TET_ROOT/functional/admin/dcecp/ts/server/core*} dontcare
  }
  
  
*** /animal/build/dce1.1/src/./test/functional/admin/dced/ts/api/dtapi_srvr_utils.c	Tue Dec 13 11:12:28 1994
--- ./test/functional/admin/dced/ts/api/dtapi_srvr_utils.c	Tue May  2 12:10:16 1995
***************
*** 10,22 ****
  /*
   * HISTORY
   * $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
!  * Revision 2.1  1994/12/13  16:10:05  devrcs
!  * OSF DCE 1.1 Source
   *
   * Revision 1.1.2.2  1994/09/30  22:55:36  baum
   * 	Fixed a number of test things (OT 12393)
   * 	[1994/09/30  22:54:24  baum]
!  *
   * Revision 1.1.2.1  1994/09/28  21:47:45  melman
   * 	moved admin tests to test/functional
   * 	[1994/09/28  21:15:24  melman]
--- 10,26 ----
  /*
   * HISTORY
   * $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
!  * Revision 2.1.1.2  1995/05/02  16:10:14  tomj
!  * 	Don't sleep, use pthread_delay_np.
!  * 	Pass correct status when server never listens.
   *
+  * Revision 2.1  1994/12/13  16:10:05  devrcs
+  * 	OSF DCE 1.1 Source
+  * 
   * Revision 1.1.2.2  1994/09/30  22:55:36  baum
   * 	Fixed a number of test things (OT 12393)
   * 	[1994/09/30  22:54:24  baum]
!  * 
   * Revision 1.1.2.1  1994/09/28  21:47:45  melman
   * 	moved admin tests to test/functional
   * 	[1994/09/28  21:15:24  melman]
***************
*** 47,52 ****
--- 51,57 ----
  
  #include <dtapi_impl.h>
  #include <dtapi_1_srvr.h>
+ #include <pthread.h>
  
  
  /*
***************
*** 67,72 ****
--- 72,78 ----
          rpc_binding_handle_t    rpc_binding;
          error_status_t          st,tmp_st;
  	int			i;
+ 	struct timespec		wait_time;
  
          rpc_string_binding_compose(DCED_SRVR_OBJ1,
                                     (unsigned_char_p_t)DCED_SRVR_PROTO,
***************
*** 83,89 ****
--- 89,101 ----
  #endif
                  return false;
          }
+ 	{
+ 	    char txt_msg[DCED_TEST_MSG_LEN];
  
+ 	    sprintf(txt_msg, "String binding is: %s", string_binding);
+ 	    tet_infoline(txt_msg);
+ 	}
+ 
          rpc_binding_from_string_binding(string_binding, &rpc_binding, &st);
          rpc_string_free(&string_binding, &tmp_st);
          if (st != error_status_ok)
***************
*** 102,117 ****
  #define NUM_TRIES 6
  #define SLEEP_INTERVAL 10
  
  	for ( i = 0; i < NUM_TRIES; i++ ) {
! 	  rpc_mgmt_is_server_listening ( rpc_binding, &tmp_st );
! 	  if ( tmp_st == error_status_ok )
! 	    break;
! 	  sleep ( SLEEP_INTERVAL );
  	}
  	if ( i == NUM_TRIES ) {
  	  
  	  tet_infoline("dced_test_server never started listening" );
! 	  dced_util_printerr(st);
  	  return false;
  	}
  	  
--- 114,132 ----
  #define NUM_TRIES 6
  #define SLEEP_INTERVAL 10
  
+ 	wait_time.tv_sec = SLEEP_INTERVAL;
+ 	wait_time.tv_nsec = 0;
  	for ( i = 0; i < NUM_TRIES; i++ ) {
! 	  if (rpc_mgmt_is_server_listening(rpc_binding, &tmp_st) &&
! 	     (tmp_st == error_status_ok) ) {
! 	      break;
! 	  }
! 	  pthread_delay_np ( &wait_time );
  	}
  	if ( i == NUM_TRIES ) {
  	  
  	  tet_infoline("dced_test_server never started listening" );
! 	  dced_util_printerr(tmp_st);
  	  return false;
  	}
  	  
*** /animal/build/dce1.1/src/./test/functional/admin/dced/ts/api/dtapi_utils.c	Tue Dec 13 11:12:30 1994
--- ./test/functional/admin/dced/ts/api/dtapi_utils.c	Tue May  2 12:10:21 1995
***************
*** 10,25 ****
  /*
   * HISTORY
   * $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
!  * Revision 2.1  1994/12/13  16:10:06  devrcs
!  * OSF DCE 1.1 Source
   *
   * Revision 1.1.2.2  1994/09/30  22:55:39  baum
   * 	Fixed a number of test things (OT 12393)
   * 	[1994/09/30  22:54:27  baum]
!  *
   * 	New secval tests plus the ability to run without TET (OT 11975)
   * 	[1994/09/30  21:14:44  baum]
!  *
   * Revision 1.1.2.1  1994/09/28  21:47:47  melman
   * 	moved admin tests to test/functional
   * 	[1994/09/28  21:15:25  melman]
--- 10,28 ----
  /*
   * HISTORY
   * $Log:	c013116,v $
# Revision 1.1  95/09/11  15:54:39  root
# new CR
# 
!  * Revision 2.1.1.2  1995/05/02  16:10:17  tomj
!  * 	In print_key, don't try to print password when it's des encrypted.
   *
+  * Revision 2.1  1994/12/13  16:10:06  devrcs
+  * 	OSF DCE 1.1 Source
+  * 
   * Revision 1.1.2.2  1994/09/30  22:55:39  baum
   * 	Fixed a number of test things (OT 12393)
   * 	[1994/09/30  22:54:27  baum]
!  * 
   * 	New secval tests plus the ability to run without TET (OT 11975)
   * 	[1994/09/30  21:14:44  baum]
!  * 
   * Revision 1.1.2.1  1994/09/28  21:47:47  melman
   * 	moved admin tests to test/functional
   * 	[1994/09/28  21:15:25  melman]
***************
*** 503,510 ****
--- 506,518 ----
  )
  {
  
+     if((key_ptr->passwd)->key.key_type == sec_passwd_plain) {
  	sprintf(txt_msg,"principal, version, passwd: %s %d %s\n",
  		key_ptr->principal, key_ptr->version, (key_ptr->passwd)->key.tagged_union.plain);
+     } else {
+ 	sprintf(txt_msg,"principal, version, passwd: %s %d %s\n",
+ 		key_ptr->principal, key_ptr->version, "<encrypted>");
+     }
  	tet_infoline(txt_msg);
  }
  
*** /animal/build/dce1.1/src/./test/

CR Number                     : 12891
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : admin
Short Description             : rep_ch_2_checklist test prematurely disables cds server
Reported Date                 : 5/26/95
Found in Baseline             : 1.1
Found Date                    : 5/26/95
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : test/systest/admin/cds/tests/rep_ch_2_checklist
Sensitivity                   : public

[5/26/95 public]

A support customer reports:

> The rep_ch_2_checklist disables the server then tries to
> clear the clearinghouse without the server present.  
> 
> cdscp> cdscp disable server
> cdscp> cdscp clear clearinghouse /.:/admintest2_ch
> Binding incomplete (no object ID and no endpoint) (dce / rpc)
> Binding incomplete (no object ID and no endpoint) (dce / rpc)
> Binding incomplete (no object ID and no endpoint) (dce / rpc)
> Binding incomplete (no object ID and no endpoint) (dce / rpc)

The suggested fix is to reverse the sequence of these commands:

>     *** /tmp/ci.10240..rep_ch_2_checklist.10272.1      Thu Mar  2 13:50:04 1995
>     --- /tmp/rep_ch_2_checklist.10272.2        Thu Mar  2 13:50:04 1995
>     ***************
>     *** 596,613 ****
>         >       Known Clearinghouses = /.../admin_cell/admintest2_ch
>       
>       - On admintest2 disable the admintest2_ch clearinghouse using the clear
>         clearinghouse command.
>       
>     -   cdscp disable server
>     - 
>     -   >  No Output Expected
>     -   
>         cdscp clear clearinghouse /.:/admintest2_ch
>       
>         >  No Output Expected
>       
>       - On admintest3 copy the admintest2_ch files locally from admintest2.
>       
>         cd /opt/dcelocal/var/directory/cds
>       
>         >  No Output Expected
>     --- 596,613 ----
>         >       Known Clearinghouses = /.../admin_cell/admintest2_ch
>       
>       - On admintest2 disable the admintest2_ch clearinghouse using the clear
>         clearinghouse command.
>       
>         cdscp clear clearinghouse /.:/admintest2_ch
>       
>         >  No Output Expected
>       
>     +   cdscp disable server     # hitm
>     + 
>     +   >  No Output Expected
>     +   
>       - On admintest3 copy the admintest2_ch files locally from admintest2.
>       
>         cd /opt/dcelocal/var/directory/cds
>       
>         >  No Output Expected

Curious that this was never noticed before--timing-sensitive, it would
appear.


[ 09/20/95 bhandaru ]

 This is also reported by Hal Soft. Systems. Customer Ticket # 22031
 I am including the report below

 
>
>
>
>                          DCE Problem Report
>                  =================================
>
>
>Submitter Information (Include Email address at miminum)
>- ---------------------
>
>Submitter Name:         Scott LoGiudice
>Organization:           HaL Software Systems
>Email Address:          scottl@hal.com
>Phone:                  (512) 834-9964 x 5019
>DCE License Number:     1352
>
>
>Hardware/Software Configuration
>- -------------------------------
>
>Offering and Version:   DCE 1.1
>Component (Module):     src/test/systest/admin/cds/tests/rep_ch_2_checklist
>Client Hardware:        Irrelevant
>Client Software:        Irrelevant
>Server Hardware:        Irrelevant
>Server Software:        Irrelevant
>Compiler:               Irrelevant
>
>Problem Description
>- -------------------
>
>Severity Level: Minor
>
>Date of First Occurrence: 9/20/95
>
>One Line Description:
>
>        Instructions to "cdscp disable server" prior to "cdscp clear clearinghouse" are wrong
>
>Full Description:
>
>        The instructions in the rep_ch_2_checklist to clear a clearinghouse
>        need to omit the "cdscp diable server" step. Here's the current
>        instruction segment in question:
>
>        - On admintest2 disable the admintest2_ch clearinghouse using the clear
>          clearinghouse command.
> 
>          cdscp disable server
> 
>          >  No Output Expected
> 
>          cdscp clear clearinghouse /.:/admintest2_ch
>
>          >  No Output Expected
>
>        THIS COMMAND WILL FAIL AS SHOWN BELOW UNLESS
>        THE "cdscp diable server" COMMAND WAS OMITTED.
>
>        root@wilma>$ cdscp clear clearinghouse /.:/wilma_ch
>        Binding incomplete (no object ID and no endpoint) (dce / rpc)
>        Binding incomplete (no object ID and no endpoint) (dce / rpc)
>        Binding incomplete (no object ID and no endpoint) (dce / rpc)
>        Binding incomplete (no object ID and no endpoint) (dce / rpc)
>        root@wilma>$
>
>Repeat By:
>
>        
>
>Proposed Solution:
>
>        Omit the "cdscp disable server" step in the test instructions 
>
> ------------------ Scott LoGiudice (512) 834-9962 x5019 ----------------------



CR Number                     : 12888
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dlgcfg001
Short Description             : The dlgcfg001 systest should
use -update flag with rgy_edit
Reported Date                 : 5/26/95
Found in Baseline             : 1.1
Found Date                    : 5/26/95
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dlgcfg001
Sensitivity                   : public

[5/26/95 public]

Reported by Tom Jordahl at Gradient:

dlgcfg001 is missing the -update switch to rgy_edit so if you have
a replica in your system test cell, the setup could fail if the
rgy_edit binds to a replica.

Proposed Solution:

use the variable already defined in the test:

replace

	rgy_edit <<EOF

with

	${RGY_EXEC} <<EOF



CR Number                     : 12750
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc
Short Description             : dcerpcrun; bad call to free in server, results in SEGV
Reported Date                 : 11/18/94
Found in Baseline             : 1.1
Found Date                    : 11/18/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : ./test/systest/rpc/rpc.runtime.1/manager.c
Sensitivity                   : public

[11/18/94 public]

Full Description:

in dcerpcrun, there is a call to free in the server for a buffer which has
never been allocated, depending on how sensitive your memory mangement
system is to heap corruption, this may cause the server to SEGV.

Proposed solution:

remove the free.

***************
*** 498,504 ****
           if (j > MANAGER_ELEMENT_COUNT) break;
      }
      (*iop_struct->push)(iop_struct->state,(pt_struct *)manager_buffer,0);
!     free(manager_buffer);
      fflush(fp);
  CATCH_ALL
        RERAISE;
--- 498,507 ----
           if (j > MANAGER_ELEMENT_COUNT) break;
      }
      (*iop_struct->push)(iop_struct->state,(pt_struct *)manager_buffer,0);
! 
! /*  the manager buffer was not allocated, therefore it cannot be freed!
!     free(manager_buffer);
! */
      fflush(fp);
  CATCH_ALL
        RERAISE;



CR Number                     : 12749
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : delay; unitialized variable secrgy_client
Reported Date                 : 11/18/94
Found in Baseline             : 1.1
Found Date                    : 11/18/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : ./test/systest/security/sec.rgy.7/secrgy_client.c
Sensitivity                   : public

[11/18/94 public]


Full Description:

for the secrgy system test, the client makes a remote procedure call to
the server, passing in the rpc a value which the server uses (if non-zero)
as a timeout paramter to a clall to select. The value of delay is
esatablished
as an optional parameter of the client startup. If you do NOT specify delay
on the client startup (as does the secrgy system test), a value for delay 
obtained simply by taking the value occuring in storage at program startup.
In our case, the result was that a single iteration of the test apperared
to
run forever.

Proposed solution:

Initialize delay in the client.

--- 8,13 ----
***************
*** 181,187 ****
     sec_passwd_str_t     passwd;
     unsigned32         duration;
     unsigned32         add_number = 0;
!    unsigned32         delay;
     unsigned_char_p_t  protseq = ( unsigned_char_p_t ) NULL;
     unsigned_char_p_t  import_protseq;
     unsigned32         expire_tm, cur_tm, exc_exp;
--- 178,184 ----
     sec_passwd_str_t     passwd;
     unsigned32         duration;
     unsigned32         add_number = 0;
!    unsigned32         delay = 0;
     unsigned_char_p_t  protseq = ( unsigned_char_p_t ) NULL;
     unsigned_char_p_t  import_protseq;
     unsigned32         expire_tm, cur_tm, exc_exp;



CR Number                     : 12747
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc
Short Description             : hostname resolved differently
Reported Date                 : 11/11/94
Found in Baseline             : 1.1b24
Found Date                    : 11/11/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
		src/test/systest/file/rpc/rpc.runtime.1/dcerpcrun
		src/test/systest/file/rpc/rpc.runtime.1/clientwrapper
Sensitivity                   : public

[11/11/94 public]

In the function checkHost in dcerpcrun, the list of client hosts is
being checked by rsh to that machine and using "uname -n" to extract
the hostname. However, in clientwrapper, the hostname is being resolved
by "hostname". If "uname -n" and "hostname" return different values
the test will either fail to run on a client (when "uname -n" is
different than the client hostname specified) or the timestamp file
created by clientwrapper with the command:

$RSHELL $SERVER -n "/bin/date \"+%M%S%n\" >$WORKDIR/client_$HOST.start &"

will not be found, since HOST is resolved by using hostname.

[11/11/94 public]
Everything should use "uname -n", that's the POSIX command.



CR Number                     : 12742
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : rpc.sec.2_runtest.sh syntax error
Reported Date                 : 11/7/94
Found in Baseline             : 1.1b24
Found Date                    : 11/7/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/7/94 public]

While running the rpc.sec.2 test a syntax error was encountered on
line 217 in rpc.sec.2_runtest.sh.

The incorrect line is:

 if ["$rs2_rt_local_os" = "SINIX-D" ]

this should be:

 if [ "$rs2_rt_local_os" = "SINIX-D" ]



CR Number                     : 12722
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : erarel001
Short Description             : erarel001 gets occasional failures w/ secd replica
Reported Date                 : 10/25/94
Found in Baseline             : 1.1b23
Found Date                    : 10/25/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/25/94 public]

The erarel001 test sometimes fails when run in a cell
with a security replica (other than the master).  The
reason for this is believed to be that the test will
use one 'dcecp -c' command to update the registry and
follow it immediately with another 'dcecp -c' command
to verify the update.  If the update has not propagated
from the master to the slave and the second dcecp command
binds to the slave then it won't get the expected results.
~
This usually just happens on 'deletes' as shown it TET log:
520|0 1 12970 9 44|ERROR: Attribute sestrneedleaneedle was not deleted from registry as expecte
din delete_attr
520|0 1 12970 9 45|Output of previous command:
520|0 1 12970 9 46|{sestrneedleaneedle sestrleneedleneedleorigval}

The test could be changed to always bind to the master.  Or further
investigation could be done into whether or not the update SHOULD
have reached the replicas in the time between the dcecp command.

Workaround for now is to only run it in a cell with a single secd running.
~



CR Number                     : 12685
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : Audit systests need to be moved
Reported Date                 : 10/20/94
Found in Baseline             : 1.1
Found Date                    : 10/20/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/26/94 public]

Deferred to 1.2

[10/20/94 public]

Since the audit component is located under security,
the audit system tests should be moved under the security system tests too.



CR Number                     : 12649
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : dcecdsacl6 test fails
Reported Date                 : 10/18/94
Found in Baseline             : 1.1b22
Found Date                    : 10/18/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/18/94 public]

The following failure was found in the journal file:

...
520|0 1 32373 1 62|acl_edit /.../doyen.test.cell/hosts/yale.austin.ibm.com -l
520|0 1 32373 1 63|ERROR on test case 11
...

The variable CDSSHOST does not strip the domain name. The following line
needs to be changed in src/test/systest/directory/cds/cds.acl.6/dcecdsacl6:

    export CDSSHOST=`hostname | awk -F"." '{print $1}'`



CR Number                     : 12630
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : systest
Subcomponent Name             : 
Short Description             : audstr001 systest fails
Reported Date                 : 10/14/94
Found in Baseline             : 1.1b21
Found Date                    : 10/14/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/14/94 public]

The audstr001 system test fails with the following error:

...
AUDITD is running
Password must be changed!
Do try_logins
1st shmget: File exists
Could not get first shared memory segment id
10/14/94:13:19:24-error---:try_logins failed
Finish try_logins
...

In the file src/test/systest/audit/ts/try_logins.c the value of key
in the call to shmget is a static value. For some reason when I ran
this test shget was returning EEXIST. I modified try_logins.c to
increment the key until shget either succeeded or returned an
errno value that was not EEXIST. When I ran this version of try_logins
the test passed.

Perhaps the key should be generated from ftok?



CR Number                     : 12626
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : systest
Subcomponent Name             : 
Short Description             : rpc dcerpper system test fails
Reported Date                 : 10/14/94
Found in Baseline             : 1.1b21
Found Date                    : 10/14/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/14/94 public]

The following errors were found in the journal file:

...
520|0 1 20403 1 46|Checking results in /tmp/perf_client_yale.austin.ibm.com.log.
yale
520|0 1 20403 1 47|ERROR: rpper_check_results: Test failure detected in /tmp/per
f_client_yale.austin.ibm.com.log.yale
520|0 1 20403 1 48|Checking results in /tmp/perf_client_yale.austin.ibm.com.log.
agony
520|0 1 20403 1 49|ERROR: rpper_check_results: Test failure detected in /tmp/per
f_client_yale.austin.ibm.com.log.agony
220|0 1 1 22:32:07|FAIL
...
520|0 0 20403 1 2|LOG: /tmp/perf_client_yale.austin.ibm.com.log.yale
520|0 0 20403 1 3|LOG: rshsp yale /tmp/perf_client_yale.austin.ibm.com 00 ncadg_
ip_udp:129.35.67.232[2001] 3 400 y n
520|0 0 20403 1 4|LOG: *** Call count mismatch (Null call test [0]
...
520|0 0 20403 1 16|LOG: rshsp yale /tmp/perf_client_yale.austin.ibm.com 01 ncadg
_ip_udp:129.35.67.232[2001] 3 50 y n 3000
520|0 0 20403 1 17|LOG: *** Call count mismatch (101, 50)
520|0 0 20403 1 18|LOG: *** Call count mismatch (101, 50)
520|0 0 20403 1 19|LOG: *** Call count mismatch (Variable length input arg test
...
520|0 0 20403 1 76|LOG: rshsp yale /tmp/perf_client_yale.austin.ibm.com 10 ncadg
_ip_udp:129.35.67.232[2001] 2 2 y n 60
520|0 0 20403 1 77|LOG: *** Call count mismatch (203, 2)
520|0 0 20403 1 78|LOG: Slow call test [10]
...
520|0 0 20403 1 88|LOG: /tmp/perf_client_yale.austin.ibm.com.log.agony
520|0 0 20403 1 89|LOG: rshsp agony /tmp/perf_client_yale.austin.ibm.com 00 ncad
g_ip_udp:129.35.67.232[2001] 3 400 y n
520|0 0 20403 1 90|LOG: *** Call count mismatch (Null call test [0]
...
520|0 0 20403 1 102|LOG: rshsp agony /tmp/perf_client_yale.austin.ibm.com 01 nca
dg_ip_udp:129.35.67.232[2001] 3 50 y n 3000
520|0 0 20403 1 103|LOG: *** Call count mismatch (103, 50)
520|0 0 20403 1 104|LOG: *** Call count mismatch (119, 50)
520|0 0 20403 1 105|LOG: *** Call count mismatch (Variable length input arg test
...
520|0 0 20403 1 162|LOG: rshsp agony /tmp/perf_client_yale.austin.ibm.com 10 nca
dg_ip_udp:129.35.67.232[2001] 2 2 y n 60
520|0 0 20403 1 163|LOG: *** Call count mismatch (4, 2)
520|0 0 20403 1 164|LOG: Slow call test [10]

[10/14/94 public]
The call count mis-match happens when you run two clients against
one server.  Notice that it was expecting 50 calls and get back
around 100, which implies that someone else is calling the
same routines.

I would think you are running several system tests at the same time
on the same machines.

[10/14/94 public]
I re-ran the test and made sure there were no other tests running
and I still got the same results.

[10/14/94 public]

Is your client running multi-threaded?

[10/14/94 public]
The enrties in the journal file indicate that the client is NOT running
multi-threaded.



CR Number                     : 12604
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dfs
Short Description             : dfs.wan_checklist needs corrections
Reported Date                 : 10/12/94
Found in Baseline             : 1.1b21
Found Date                    : 10/12/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/12/94 public]

The following corrections should be made to the dfs.wan_checklist:

C. 2.	Use dce_config to configure the necessary principal and acls and
	to start the gdad daemon as an "Additional Server".

	d. 2. If the above fails, you may want to investigate further with
	nslookup or other name service utilities on your machine. (The 
	gda_clerk process is no longer built.)

D. 2. a. On the local_cell:
	> cd /.../foreign_cell/fs;ls
	> mkdir local_cell_dir
	> cd local_cell_dir
	> echo "local_cell cell_admin" > local_cell_file

      b. On the foreign_cell:
	> cd /.../foreign_cell/fs/local_cell_dir
	> cat local_cell_file

	> cd /.../local_cell/fs;ls
	> mkdir foreign_cell_dir
	> cd foreign_cell_dir
	> echo "foreign_cell cell_admin" > foreign_cell_file

      c. On the local_cell:
	> cat /.../local_cell/fs/foreign_cell_dir/foreign_cell_file



CR Number                     : 12589
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : eraobj001
Short Description             : eraobj001 (dceseacl) test leaves acls on /.:/sec/xattrschema
Reported Date                 : 10/12/94
Found in Baseline             : 1.1b21
Found Date                    : 10/12/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/12/94 public]

The eraobj001 test (dceseacl with ERA=yes) adds a test user acl
to /.:/sec/xattrschema but doesn't remove it.  The test user
is removed by the test and the result is that /.:/sec/xattrschema
has 'orphaned' uuids with acls on it as follows:

520|0 1 3775 1 668|dcecp -c acl show /.:/sec/xattrschema
520|0 1 3775 1 669|{unauthenticated r----}
520|0 1 3775 1 670|{user cell_admin rcidm}
520|0 1 3775 1 671|{user 000005fa-e200-21cd-9800-0000c0dade56 r----}
520|0 1 3775 1 672|{user 000005fc-e201-21cd-9800-0000c0dade56 r--d-}
520|0 1 3775 1 673|{user 00000622-e209-21cd-9800-0000c0dade56 r----}
520|0 1 3775 1 674|{user 00000623-e20a-21cd-9800-0000c0dade56 r--d-}
520|0 1 3775 1 675|{user 0000064a-e212-21cd-9800-0000c0dade56 r----}
520|0 1 3775 1 676|{user 0000064b-e213-21cd-9800-0000c0dade56 r--d-}
520|0 1 3775 1 677|{user 00000672-e219-21cd-9800-0000c0dade56 r----}

...

The test should be updated to remove the user acl from /.:/sec/xattrschema



CR Number                     : 12588
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : systest
Subcomponent Name             : era
Short Description             : eraobj001 systest fails to add/del attr on group
Reported Date                 : 10/12/94
Found in Baseline             : 1.1b21
Found Date                    : 10/12/94
Severity                      : B
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/12/94 public]

Running the ERAOBJ001 test on osf/1 w/ bl-21 gives errors
when trying to add and delete an era from a group.  The purpose
of the test is to verify ACL manipulation on rgy objects.  The
test passes on hpux and I can't recreate it with a short example
outside of the test (on osf1).  I've added checks on the ACLs right
before the xattr operation and they show that I should have
permission (according the the aclmgr setting in the schema) to
add and then delete the attributes.  There are no problems with
the principal or org objects, just group.  The test can be run by
installing the sec systests and running:

  run.sec -l 1 eraobj001

Here are excerpts from the TET journal:

520|0 1 3775 1 439|dcecp -c xattr show /.:/sec/xattrschema/seaclclifiji0attr
520|0 1 3775 1 440|{aclmgr
520|0 1 3775 1 441|{{principal {{query r} {update rfu} {test r} {delete rDm}}}
520|0 1 3775 1 442|{group {{query r} {update rm} {test rt} {delete rDm}}}
520|0 1 3775 1 443|{organization {{query r} {update rm} {test rt} {delete rDm}}}}}
520|0 1 3775 1 444|{annotation {schema-added-by-seaclclifiji0-for-testing}}
520|0 1 3775 1 445|{applydefs yes}
520|0 1 3775 1 446|{encoding printstring}
520|0 1 3775 1 447|{intercell reject}
520|0 1 3775 1 448|{multivalued yes}
520|0 1 3775 1 449|{reserved no}
520|0 1 3775 1 450|{scope {}}
520|0 1 3775 1 451|{trigbind {none {}}}
520|0 1 3775 1 452|{trigtype none}
520|0 1 3775 1 453|{unique no}
520|0 1 3775 1 454|{uuid d5480e28-e524-11cd-9886-0000c0dade56}

...

520|0 1 3775 1 593|The cell is now authenticated by seaclclifiji1
520|0 1 3775 1 594|Attempting to add attr seaclclifiji0attr with val fiji1oval to group seaclclifiji0gr
oup
520|0 1 3775 1 595|Output of previous command:
520|0 1 3775 1 596|dcecp -c acl check /.:/sec/xattrschema
520|0 1 3775 1 597|r----
520|0 1 3775 1 598|dcecp -c acl show /.:/sec/group
520|0 1 3775 1 599|{unauthenticated r-----}
520|0 1 3775 1 600|{user cell_admin rcidDn}
520|0 1 3775 1 601|{user seacladfijip rc----}
520|0 1 3775 1 602|{group acct-admin rcidDn}
520|0 1 3775 1 603|{other_obj r-----}
520|0 1 3775 1 604|{any_other r-----}
520|0 1 3775 1 605|dcecp -c acl check /.:/sec/group
520|0 1 3775 1 606|r-----
520|0 1 3775 1 607|dcecp -c acl show /.:/sec/group/seaclclifiji0group
520|0 1 3775 1 608|{unauthenticated r-t-----}
520|0 1 3775 1 609|{user cell_admin rctDnfmM}
520|0 1 3775 1 610|{user seaclclifiji0 rctDnfmM}
520|0 1 3775 1 611|{user seacladfijip rc------}
520|0 1 3775 1 612|{user seaclclifiji1 r-----m-}
520|0 1 3775 1 613|{group_obj r-t-----}
520|0 1 3775 1 614|{group acct-admin rctDnfmM}
520|0 1 3775 1 615|{other_obj r-t-----}
520|0 1 3775 1 616|{any_other r-------}
520|0 1 3775 1 617|dcecp -c acl check /.:/sec/group/seaclclifiji0group
520|0 1 3775 1 618|r-----m-
520|0 1 3775 1 619|ERROR: dcecp group modify seaclclifiji0group -add {seaclclifiji0attr fiji1oval} fail
ed in add_attr
520|0 1 3775 1 620|Output of previous command:
520|0 1 3775 1 621|Error: User is not authorized to update record

...

520|0 1 3775 1 649|The cell is now authenticated by seaclclifiji1
520|0 1 3775 1 650|Attempting to delete attr seaclclifiji0attr from group object seaclclifiji0group
520|0 1 3775 1 651|Output of previous command:
520|0 1 3775 1 652|dcecp -c xattr show /.:/sec/xattrschema/seaclclifiji0attr
520|0 1 3775 1 653|{aclmgr
520|0 1 3775 1 654|{{principal {{query r} {update rfu} {test r} {delete rDm}}}
520|0 1 3775 1 655|{group {{query r} {update rm} {test rt} {delete rDm}}}
520|0 1 3775 1 656|{organization {{query r} {update rm} {test rt} {delete rDm}}}}}
520|0 1 3775 1 657|{annotation {schema-added-by-seaclclifiji0-for-testing}}
520|0 1 3775 1 658|{applydefs yes}
520|0 1 3775 1 659|{encoding printstring}
520|0 1 3775 1 660|{intercell reject}
520|0 1 3775 1 661|{multivalued yes}
520|0 1 3775 1 662|{reserved no}
520|0 1 3775 1 663|{scope {}}
520|0 1 3775 1 664|{trigbind {none {}}}
520|0 1 3775 1 665|{trigtype none}
520|0 1 3775 1 666|{unique no}
520|0 1 3775 1 667|{uuid d5480e28-e524-11cd-9886-0000c0dade56}
520|0 1 3775 1 758|dcecp -c acl check /.:/sec/group
520|0 1 3775 1 759|r-----
520|0 1 3775 1 760|dcecp -c acl show /.:/sec/group
520|0 1 3775 1 761|{unauthenticated r-----}
520|0 1 3775 1 762|{user cell_admin rcidDn}
520|0 1 3775 1 763|{user seacladfijip rc----}
520|0 1 3775 1 764|{group acct-admin rcidDn}
520|0 1 3775 1 765|{other_obj r-----}
520|0 1 3775 1 766|{any_other r-----}
520|0 1 3775 1 767|dcecp -c acl show /.:/sec/group/seaclclifiji0group
520|0 1 3775 1 768|{unauthenticated r-t-----}
520|0 1 3775 1 769|{user cell_admin rctDnfmM}
520|0 1 3775 1 770|{user seaclclifiji0 rctDnfmM}
520|0 1 3775 1 771|{user seacladfijip rc------}
520|0 1 3775 1 772|{user seaclclifiji1 r--D--m-}
520|0 1 3775 1 773|{group_obj r-t-----}
520|0 1 3775 1 774|{group acct-admin rctDnfmM}
520|0 1 3775 1 775|{other_obj r-t-----}
520|0 1 3775 1 776|{any_other r-------}
520|0 1 3775 1 777|dcecp -c acl check /.:/sec/group/seaclclifiji0group
520|0 1 3775 1 778|r--D--m-
520|0 1 3775 1 779|ERROR: dcecp group modify seaclclifiji0group -remove seaclclifiji0attr failed in del
ete_attr
520|0 1 3775 1 780|Output of previous command:
520|0 1 3775 1 781|Error: User is not authorized to update record



CR Number                     : 12489
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : hcell
Short Description             : HCLREL001 needs to have a dcecp command sequence incorporated
Reported Date                 : 10/4/94
Found in Baseline             : 1.1b20
Found Date                    : 10/4/94
Severity                      : A
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/4/94 public]

HCLREL001 would be significantly more thorough if it incorporated
a dcecp test sequence for intercell testing. Julie wrote 
this test sequence last week. Now it needs to be incorporated into the test.

[10/5/94 public]
off the HYP list as this will not be able to be completed in time
for the bit freeze.  It could potentially go into unintegrated, if
completed in time for that deadline.



CR Number                     : 12488
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : hcells
Short Description             : HCLREL001 needs state file for secondary clearinghouses
Reported Date                 : 10/4/94
Found in Baseline             : 1.1b20
Found Date                    : 10/4/94
Severity                      : B
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/4/94 public]

HCLREL001 is written to create state files for primary and 
secondary clearinghouses. Currently no files are included for 
the secondary clearinghouses. At a minimum, a copy 
of the primary state file should be made for use in testing
the secondaries.



CR Number                     : 12388
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcesergy
Short Description             : dcesergy reports occassional rpc errors
Reported Date                 : 9/28/94
Found in Baseline             : 1.1b19
Found Date                    : 9/28/94
Severity                      : B
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/28/94 public]

A 18 hour run of dcesergy (sec.rgy.7) test over the weekend showed
various  errors, resulting in a total of 39 passes and 27 failures.
While this may be attributable to poor performance, that's not
immediately clear and these need to be investigated further.  Here
are the errors and the number of times they occurred:

81	log_in: Registry object not found (dce / sec)
 3	rgy_test_login: Connection request timed out (dce / rpc)
11	rpc_ns_binding_import_next: Entry not found (dce / rpc)
 1	rpc_ns_binding_import_next: No more bindings (dce / rpc)
 7	rpc_ns_binding_import_next: Not an RPC entry (dce / rpc)
 1	sec_login_set_context: status 0x141290bd (dce / krb)



CR Number                     : 12270
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dceseacl
Short Description             : reports passed incorrectly but records error
Reported Date                 : 9/20/94
Found in Baseline             : 1.1b18
Found Date                    : 9/20/94
Severity                      : A
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/20/94 public]

When the dceseacl test fails it still prints out the message
that it passed at the end, right before recording the tet_result
as an error:

20|0 1 11269 1 571|DCESEACL Passed
220|0 1 41 19:18:02|DCE_ERROR



CR Number                     : 12225
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : systest
Subcomponent Name             : rpbnk_auth
Short Description             : HUGE # of defunct processes on 'hung' machine
Reported Date                 : 9/16/94
Found in Baseline             : 1.1b17
Found Date                    : 9/16/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/16/94 public]

In a CHO cell, a 1.1 osf/1 client seemingly hung (entire
node, couldn't do anything in any windows but could still
ping).  Returning to the node some time later (at least a 
day later) it was back up and running.  Not sure what 
happened in what order, or how reproducible this is, but 
I wanted to record it and here's what's left:

DCED had crashed (at least 8hrs after noticing the hung machine)
and there were an ENORMOUS number of defunct processes, looking 
like the following to ps:
30691 ??         <      0:00.00 <defunct>

root@trinidad> ps ax | grep defunct | wc -l
       549

I've seen this happen once before but didn't record what
was running.  This cell was running a 48 CHO of rpbank_auth
(udp), which may cause the defunct processes(?)

Here's the info from the dced core file, don't know if
if means anything, except maybe the acl_db part:

Core was generated by `dced'.
Program terminated with signal 10, Bus error.
#0  0xa4003548 in acl_db ()
(gdb) break main
Breakpoint 1 at 0x40038e: file /project/dce/build/dce1.1-snap/src/admin/dced/server/main.c, line 329.
(gdb) run
Starting program: /opt/dcelocal/bin/dced 

Breakpoint 1, main (ac=1, av=0xbffff9cc)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/main.c:329
Source file is more recent than executable.
329         pthread_t           tid;
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0xa4003548 in malloc (Cannot access memory at address 0xa40034a8.
(gdb) where
#0  0xa4003548 in malloc (Cannot access memory at address 0xa40034a8.

[9/16/94 public]
In looking at some machine statistics recorded during the run, it appears
that the defunct processes appeared at the same time that /usr filled to
100%.  Also, the dced crash coincided with swap space hitting 100%.  So,
I'm cancelling this...

[9/19/94 public]
I'm re-opening this and assigning it to systest since it seems like
it's a problem with rpbank.  It hosed the CHO cell again with the
same symptoms of defunct processes (788 this a.m. to be exact).  It
happened about 13hrs into the run.  /usr never got above 66%; swap
never got above 59%; all other local filesystems ok, all daemons up
and running.
The only constant is rpbank_auth.  Last time was udp, this time tcp.
No apparent test failures associated with it.  Need to look into how 
it spawns/waits for child processes.

[9/21/94 public]
Well I no longer think it's a problem with rpbank since it happened
yesterday on yet another osf/1 machine (sec master) while running
one loop of dcesepol.  Test seemingly hung and machine slowed to a
near halt.  ps showed 746 defunct processes.  Rumor has it this is
an osf/1 bug that has reared it's head before.  The three machines
where I've encountered it all have the most recent OS:
root@edgar> uname -a
OSF1 edgar 1.2 osc1.2 DCE i386

[9/28/94 public]
Just to leave more info in here, Jeff Carter says:

> There's a good possibility that this is a symptom of CR7246/8703/9075, which
> was fixed shortly after OSF/1 R1.2 was released. The changes for these CRs
> are in OSF/1 R1.2.2 (and OSF/1 R1.3), and are probably in OSF/1 R1.2.1.

Since this is so sporadic and has not occurred in the last round of 
system test runs, we won't bother upgrading or doing further investigation



CR Number                     : 12092
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : era/epac
Short Description             : dlg_client era/epac test needs expanding
Reported Date                 : 9/7/94
Found in Baseline             : 1.1b16
Found Date                    : 9/7/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/7/94 public]

The dlg_client program needs to have the ERA test expanded
to test more attribute types carried in EPACs.

[9/12/94 public]

Assigned.



CR Number                     : 12091
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dceseacl
Short Description             : documenting dceseacl CHO failures
Reported Date                 : 9/7/94
Found in Baseline             : 1.1b16
Found Date                    : 9/7/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/7/94 public]

dceseact records seldom failures during 48CHO.  An example of the
journal files reads as follows:

root@barbados> cat journal.00105
0|1.10 15:30:41 19940904|User: root (0) TCC Start, Command Line:
/dcetest/dcelocal/test/tet/bin/tcc -e -j
/dcetest/dcelocal/status/system/dceseact.barbados.940902172414/fail/journal.00105
-i /tmp/dceseact.940902172414.6323 system/security dceseact 
20|/dcetest/dcelocal/test/tet/system/security/tetexec.cfg 1|Config Start
30||TET_VERSION=1.10
30||TET_OUTPUT_CAPTURE=False
30||TET_RESCODES_FILE=tet_code
30||TET_EXEC_IN_PLACE=False
30||TET_NSIG=31
30||TET_SIG_IGN=26
40||Config End
70||"Starting DCESEACT Test Suite"
10|0 /ts/dceseact/dceseact 15:30:42|TC Start, scenario ref 69-1
15|0 1.9 1|TCM Start
520|0 0 24478 1 1|Attempting to authenticate the cell by cell_admin
520|0 0 24478 1 2|The cell is now authenticated by cell_admin
520|0 0 24478 1 3|Attempting to access rgy_edit as current user.
520|0 0 24478 1 4|Current user can access registry
520|0 0 24478 1 5|Starting test DCESEACT
400|0 1 1 15:32:19|IC Start
200|0 1 15:32:19|TP Start
520|0 1 24478 1 6|Scanning registry for users...begin check_rgy()
520|0 1 24478 1 7|Determining the current state of registry
520|0 1 24478 1 8|Attempting to verify existence of seactbarbadosp
520|0 1 24478 1 9|Attempting to verify existence of seactbarbadosa
520|0 1 24478 1 10|Attempting to verify existence of seactbarbadosg
520|0 1 24478 1 11|Attempting to verify existence of seactbarbadoso
520|0 1 24478 1 12|State of registry is fine...end check_rgy()
520|0 1 24478 1 13|Attempting to add users to registry...begin add_to_rgy
520|0 1 24478 1 14|Attempting to add person seactbarbadosp to registry
520|0 1 24478 1 15|Person seactbarbadosp has been ADDED to the registry.
520|0 1 24478 1 16|Attempting to add alias seactbarbadosa to registry
520|0 1 24478 1 17|Alias seactbarbadosa has been added to the registry.
520|0 1 24478 1 18|Attempting to add group seactbarbadosg
520|0 1 24478 1 19|Group seactbarbadosg has been ADDED to the registry.
520|0 1 24478 1 20|Attempting to add organization seactbarbadoso
520|0 1 24478 1 21|Organization seactbarbadoso has been ADDED to the
registry.
520|0 1 24478 1 22|Attempting to add account for person seactbarbadosp
520|0 1 24478 1 23|Account seactbarbadosp has been ADDED to the registry.
520|0 1 24478 1 24|Attempting to add account for person seactbarbadosa
520|0 1 24478 1 25|Account seactbarbadosa has been ADDED to the registry.
520|0 1 24478 1 26|Attempting remote login...begin remote_login_first()
520|0 1 24478 1 27|Attempting to change seactbarbadosp's password at west
520|0 1 24478 1 28|ERROR: Unable to change seactbarbadosp account's
password at: west (rlogin_to_machine 1)
520|0 1 24478 1 29|ERROR: seactbarbadosp account's password was not changed
at: west (rlogin_to_machine 2)
2)
520|0 1 24478 1 38|ERROR: Cannot verify seactbarbadosp account's new
password at: dce3 (rlogin_to_machine 3)
520|0 1 24478 1 39|Attempting to change seactbarbadosa's password at dce3
520|0 1 24478 1 40|ERROR: Unable to change seactbarbadosa account's
password at: dce3 (rlogin_to_machine 1)
520|0 1 24478 1 41|seactbarbadosa account's password was changed at: dce3
(rlogin_to_machine 2) AS EXPECTED
520|0 1 24478 1 42|Verified seactbarbadosa account's new password at: dce3
(rlogin_to_machine 3) AS EXPECTED
520|0 1 24478 1 43|Attempting to change seactbarbadosp's password at
trinidad
520|0 1 24478 1 44|Was able to change seactbarbadosp account's password at:
trinidad (rlogin_to_machine 1) AS EXPECTED
520|0 1 24478 1 45|seactbarbadosp account's password was changed at:
trinidad (rlogin_to_machine 2) AS EXPECTED
520|0 1 24478 1 46|Verified seactbarbadosp account's new password at:
trinidad (rlogin_to_machine 3) AS EXPECTED
520|0 1 24478 1 47|Attempting to change seactbarbadosa's password at
trinidad
520|0 1 24478 1 48|Was able to change seactbarbadosa account's password at:
trinidad (rlogin_to_machine 1) AS EXPECTED
520|0 1 24478 1 49|seactbarbadosa account's password was changed at:
trinidad (rlogin_to_machine 2) AS EXPECTED
520|0 1 24478 1 50|Verified seactbarbadosa account's new password at:
trinidad (rlogin_to_machine 3) AS EXPECTED
520|0 1 24478 1 51|Attempting to change seactbarbadosp's password at
barbados
520|0 1 24478 1 52|Was able to change seactbarbadosp account's password at:
barbados (rlogin_to_machine 1) AS EXPECTED
520|0 1 24478 1 53|seactbarbadosp account's password was changed at:
barbados (rlogin_to_machine 2) AS EXPECTED
520|0 1 24478 1 54|Verified seactbarbadosp account's new password at:
barbados (rlogin_to_machine 3) AS EXPECTED
520|0 1 24478 1 55|Attempting to change seactbarbadosa's password at
barbados
520|0 1 24478 1 56|Was able to change seactbarbadosa account's password at:
barbados (rlogin_to_machine 1) AS EXPECTED
520|0 1 24478 1 57|seactbarbadosa account's password was changed at:
barbados (rlogin_to_machine 2) AS EXPECTED
520|0 1 24478 1 58|Verified seactbarbadosa account's new password at:
barbados (rlogin_to_machine 3) AS EXPECTED
520|0 1 24478 1 59|Attempting updates to registry...begin run_updates()
520|0 1 24478 1 60|Attempting to change name of group
520|0 1 24478 1 61|New group name has been ADDED to the registry
520|0 1 24478 1 62|Name of group has been changed to newseactbarbadosg
520|0 1 24478 1 63|Was able to change group to new
name...change_group_name()
520|0 1 24478 1 64|Attempting to add cell_admin member to group in
add_to_group_or_org
520|0 1 24478 1 65|Members cell_admin have been ADDED properly to group
newseactbarbadosg
520|0 1 24478 1 66|Attempting to change the full name of organization
seactbarbadoso
520|0 1 24478 1 67|Organization seactbarbadoso's full name has been changed
AS EXPECTED
520|0 1 24478 1 68|Attempting to add cell_admin member to org in
add_to_group_or_org
520|0 1 24478 1 69|Members cell_admin have been ADDED properly to org
seactbarbadoso
520|0 1 24478 1 70|Attempting to change home directory of person
seactbarbadosp
520|0 1 24478 1 71|Was able to change home directory for seactbarbadosp
520|0 1 24478 1 72|Attempting to delete objects from database
520|0 1 24478 1 73|/opt/dcelocal/bin/rgy_edit -update executed properly
520|0 1 24478 1 74|Determining the current state of registry
520|0 1 24478 1 75|Attempting to verify existence of seactbarbadosp
520|0 1 24478 1 76|Attempting to verify existence of seactbarbadosa
520|0 1 24478 1 77|Attempting to verify existence of newseactbarbadosg
520|0 1 24478 1 78|Attempting to verify existence of seactbarbadoso
520|0 1 24478 1 79|Objects created for testing have been removed from
registry
520|0 1 24478 1 80|Attempting second set of remote logins...begin
remote_login_second()
520|0 1 24478 1 81|Attempting to login non-existent accounts at west
520|0 1 24478 1 82|Was NOT able to login to non-existent person account:
seactbarbadosp AS EXPECTED
520|0 1 24478 1 83|Was NOT able to login to non-existent alias account:
seactbarbadosa AS EXPECTED
520|0 1 24478 1 84|Attempting to login non-existent accounts at dce3
520|0 1 24478 1 85|Was NOT able to login to non-existent person account:
seactbarbadosp AS EXPECTED
520|0 1 24478 1 86|Was NOT able to login to non-existent alias account:
seactbarbadosa AS EXPECTED
520|0 1 24478 1 87|Attempting to login non-existent accounts at trinidad
520|0 1 24478 1 88|Was NOT able to login to non-existent person account:
seactbarbadosp AS EXPECTED
520|0 1 24478 1 89|Was NOT able to login to non-existent alias account:
seactbarbadosa AS EXPECTED
520|0 1 24478 1 90|Attempting to login non-existent accounts at barbados
520|0 1 24478 1 91|Was NOT able to login to non-existent person account:
seactbarbadosp AS EXPECTED
520|0 1 24478 1 92|Was NOT able to login to non-existent alias account:
seactbarbadosa AS EXPECTED
520|0 1 24478 1 93|DCESEACT Failed
220|0 1 1 16:06:11|FAIL
410|0 1 1 16:06:11|IC End
80|0 0 16:06:54|TC End
70||"Completed DCESEACT Test Suite"
900|16:06:54|TCC End

[9/12/94 public]

Assigned.



CR Number                     : 12090
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : thr
Short Description             : dcethrpc failures because
thd_client core dumps
Reported Date                 : 9/7/94
Found in Baseline             : 1.1b16
Found Date                    : 9/7/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/7/94 public]

In a 48CHO run of dcethrpc and dcethrpc_auth, it is not unusual
to find a small number (1 to 10) of failures. These failures are 
recorded in the journal files and they read as follows:

520|0 1 3822 1 22|ERROR: Start of thd_client -h dce3 on west failed
...
520|0 1 3822 1 31|ERROR: dcethrpc threads test failed

or

520|0 1 4031 1 28|ERROR:Failed to start thd_server on trinidad
...
520|0 1 4031 1 33|ERROR: dcethrpc threads test failed

[9/12/94 public]

Assigned.

[9/28/96 public]

I am just entering some reference data for those interested:

In a 48CHO run of this tests I had 11 failures- all were as described 
in this CR. The failures happened a different times, as the times in
the logs show:

root@alan> pwd
/dcetest/dcelocal/results/system/dcethrpc.alan.940926175137/fail
root@alan> ls -lt
total 68
-rw-rw-rw-   1 root     system             2827 Sep 28 15:26 journal.01147
-rw-rw-rw-   1 root     system             2796 Sep 28 13:45 journal.01110
-rw-rw-rw-   1 root     system             2796 Sep 28 10:55 journal.01044
-rw-rw-rw-   1 root     system             2827 Sep 28 10:39 journal.01041
-rw-rw-rw-   1 root     system             2796 Sep 28 07:51 journal.00978
-rw-rw-rw-   1 root     system             2827 Sep 28 07:30 journal.00973
-rw-rw-rw-   1 root     system             1746 Sep 28 05:58 journal.00934
-rw-rw-rw-   1 root     system             2827 Sep 28 04:40 journal.00901
-rw-rw-rw-   1 root     system             2827 Sep 27 21:27 journal.00712
-rw-rw-rw-   1 root     system             4559 Sep 27 06:02 journal.00310
-rw-rw-rw-   1 root     system             2939 Sep 27 05:43 journal.00309

root@alan> grep ERROR *        
journal.00309:520|0 1 13424 1 27|ERROR:Failed to start thd_server on alan
journal.00309:520|0 1 13424 1 33|ERROR: dcethrpc threads test failed
journal.00309:220|0 1 41 05:43:34|DCE_ERROR
journal.00310:520|0 1 16200 1 25|ERROR:Failed to start thd_server on dce3
journal.00310:520|0 1 16200 1 36|ERROR:Failed to start thd_server on west
journal.00310:520|0 1 16200 1 48|ERROR:Failed to start thd_server on needle
journal.00310:520|0 1 16200 1 53|ERROR: dcethrpc threads test failed
journal.00310:220|0 1 41 06:02:06|DCE_ERROR
journal.00712:520|0 0 21663 1 4|ERROR: Copying thd_server to dce3:/tmp
failed
journal.00712:520|0 1 21663 1 25|ERROR:Failed to start thd_server on alan
journal.00712:520|0 1 21663 1 31|ERROR: dcethrpc threads test failed
journal.00712:220|0 1 41 21:27:16|DCE_ERROR
journal.00901:520|0 0 21002 1 4|ERROR: Copying thd_server to dce3:/tmp
failed
journal.00901:520|0 1 21002 1 25|ERROR:Failed to start thd_server on alan
journal.00901:520|0 1 21002 1 31|ERROR: dcethrpc threads test failed
journal.00901:220|0 1 41 04:39:49|DCE_ERROR
.....

[10/11/94 public]

I think I found the reason why this test is failing. 
The ouput log to the screen says:

-log-----: host:barbados
program:/dcetest/dcelocal/test/tet/system/threads/ts/dcethrpc/thd_client
          pid:2960
Array reads served by barbados successful

/dcetest/dcelocal/test/tet/system/tools/su.dce[74]: 2960 Memory
fault(coredump)

The coredump is actually that of thd_client which is kept in the TET 
temporary directory and it gets removed as soon as the iteration
finishes. (we never save them). Today I saved the coredump and 
found that it belonged to thd_client. gdb gave some information
but I did not find it very useful. Here it is:

root@barbados> ts/dcethrpc/thd_client /tmp/core
<

GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.5, Copyright 1992 Free Software Foundation, Inc.

OSF version 1.0 created Mon Dec  7 14:40:14 1992

OSF version 1.0 created Mon Dec  7 14:40:14 1992

..
Core was generated by `thd_client'.
Program terminated with signal 11, Segmentation fault.
#0  0x408a28 in head ()
(gdb) break main
Breakpoint 1 at 0x40011c: file
/project/dce/build/dce1.1-snap/src/test/systest/threads/thd_client.c, line
216.
(gdb) run
Starting program:
/dcetest/dcelocal/test/tet/system/threads/ts/dcethrpc/thd_client 

Breakpoint 1, main (argc=1, argv=0xbffffd3c)
    at
/project/dce/build/dce1.1-snap/src/test/systest/threads/thd_client.c:216
Source file is more recent than executable.
216             cma_init();
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0x408a28 in head ()
(gdb) where
#0  0x408a28 in head ()
Cannot access memory at address 0xc608dd40.
(gdb)



CR Number                     : 12077
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : Name service unavailable
Reported Date                 : 9/7/94
Found in Baseline             : 1.1b16
Found Date                    : 9/7/94
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/7/94 public]

During a weekend run of DCDREL001 using BL16.3, the following 
error message was output repeatedly (roughly 20 times) to the 
terminal on the HP-UX core services node:

  "Failed to retrieve server binding from the namespace: 
     Name service unavailable (dce / rpc)"

DCE appeared to still be operational on this node after these 
messages were output.

[9/13/94 public]

Rick... do you still see this on BL17 or latest? If so, please 
try to find the appropriate component to assign it to (dced or rpc).

[09/15/94 public]
Assigning to systest until we can get more info (e.g., what RPC call
failed to what server).  First guess is that CDS died for some
reason.

[09/15/94 public]

The cds server was unreachable for a time yesterday from a dce client, a
cdscp sho dir /.: command failed.  After a time it  became reachable again.  
I am running BL17.

Martha Lynch has also seen cds 'go away' and come back.



CR Number                     : 11966
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : sec
Short Description             : dcesepol fails when executed
on a 1.0.3 client in a cell with 1.1 core servers
Reported Date                 : 8/30/94
Found in Baseline             : 1.1b16
Found Date                    : 8/30/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/30/94 public]

dcecepol fails when executed on a 1.0.3 client in a cell that 
has its core servers running on a 1.1 cell. At this point I don't
know if the test is the problem of DCE.

The test was executed on soldier with the command:

run.sec -l 1 -m "soldier west barbados trinidad" dcesepol

where soldier is an 1.0.3 machine (AIX); the others are running 1.1

The abridge version of the error messages says:

                "run.sec -l 1 -m soldier west barbados trinidad dcesepol"
completed at 08/30/94-16
:21:21
                /opt/dcelocal/bin complete: Feb 16 1994
                Failures under
/dcetest/dcelocal/results/system/dcesepol.soldier.940829160804
                There were 4886 ERRORs and/or FAILures total in
                the 1 failed iterations.  Here's the breakdown:
                1 - ERROR: Some users were able to login UNEXPECTEDLY or 
			warning messages did not appear
                1 - ERROR: Unable to complete all remote logins
                1 - ERROR: sepolsoldier1p unable to login to barbados
                1 - ERROR: sepolsoldier1p unable to login to soldier
                1 - ERROR: sepolsoldier1p unable to login to trinidad
                1 - ERROR: sepolsoldier1p unable to login to west
             523 - ERROR: sepolsoldier2p unable to login to barbados
             223 - ERROR: sepolsoldier2p unable to login to soldier
             523 - ERROR: sepolsoldier2p unable to login to trinidad
             523 - ERROR: sepolsoldier2p unable to login to west
               1 - ERROR: sepolsoldier3p unable to login to barbados
               1 - ERROR: sepolsoldier3p unable to login to soldier
               1 - ERROR: sepolsoldier3p unable to login totrinidad
               1 - ERROR: sepolsoldier3p unable to login to west
               2 - FAIL
               1 - Final Logins: Pass = 7164, Fail = 1800, Total = 8964
               1 - Logins: Pass = 1008, Fail = 0, Total = 1008
               1 - Logins: Pass = 1020, Fail = 0, Total = 1020

...

               1 - Logins: Pass = 300, Fail = 0, Total = 300              
               1 - Logins: Pass = 3012, Fail = 108, Total =3120
               1 - Logins: Pass = 3021, Fail = 111, Total =3132
               1 - Logins: Pass = 3030, Fail = 114, Total =3144
               1 - Logins: Pass = 3039, Fail = 117, Total =3156
               1 - Logins: Pass = 3048, Fail = 120, Total =3168
               1 - Logins: Pass = 3057, Fail = 123, Total =3180
               1 - Logins: Pass = 3066, Fail = 126, Total =3192
               1 - Logins: Pass = 3075, Fail = 129, Total =3204
               1 - Logins: Pass = 3084, Fail = 132, Total =3216
               1 - Logins: Pass = 3093, Fail = 135, Total =3228
               1 - Logins: Pass = 3102, Fail = 138, Total =3240
               1 - Logins: Pass = 3111, Fail = 141, Total =3252
               1 - Logins: Pass = 312, Fail = 0, Total = 312

...
        6 - Sorry. Password Validation Failure. 
	  - Client's entry in database has expired (dce / krb)
      746 - Sorry. Password Validation Failure. -Invalid password. (dce / sec)
     1578 - Sorry. Password Validation Failure. 
	  - Password has expired (dce / krb)
        2 - Sorry. User Identification Failure. 
	  - Client's entry in database has expired (dce / krb)
        2 - Sorry. User Identification Failure. 
	  - KRB5 error code 23

[9/12/94 public]

Assigned.



CR Number                     : 11935
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : audit system tests need updated README
Reported Date                 : 8/29/94
Found in Baseline             : 1.1b14
Found Date                    : 8/29/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/29/94 public]


The audit system tests now require that the audit daemon
is running first, the README file should be updated 
to reflect this fact.



CR Number                     : 11847
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : gdx_xds_str_001 tests failing
Reported Date                 : 8/24/94
Found in Baseline             : 1.1b16
Found Date                    : 8/24/94
Severity                      : B
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/24/94 public]

The gds_xds_str_001 tests are failing after an hour.  The tests appear
to be having problems setting up some test clients.  I'm enclosing a 
typical log from one of the error runs.  I don't know enough about gds
and the gds system tests to make any sense of this.  Any help would be
appreciated.

   BEGINNING gds_xds_str_001 ITERATION 3 (bXrdXu) AT Tue Aug 23 17:21:25 EDT 19
94
   -----------------------------------------------------------------------

   Beginning client startup for process 11770 Iteration 3 at Tue Aug 23 17:21:2
6 EDT 1994
   --------------------------------------------------------------------------

      Testcase is bXrdXu
      Testcase file is T4bXrdXuX.11770
      Running on system davis to create the test tree.

      Starting tree create on davis (OSF1) at Tue Aug 23 17:21:26 EDT 1994
      Looking for Testcase gds_xds_str_001_brdX_bt passed in the logs for itera
tion 3
      Starting at Tue Aug 23 17:21:26 EDT 1994 (maximum of 5 loops).
      Done looking for Testcase gds_xds_str_001_brdX_bt passed in the logs for
iteration 3.
      Finished at Tue Aug 23 17:23:27 EDT 1994 (after 3 loops)...
      All clients got message
      Cleaning up temporary files...
      Tree creation completed at Tue Aug 23 17:23:27 EDT 1994
      STARTing xt_test client 1 (testcase bXrdXu) on brandy (HP-UX) at Tue Aug
23 17:23:27 EDT 1994
      STARTed xt_test client 1 (testcase bXrdXu) - local PID is 13183
      STARTing xt_test client 2 (testcase bXrdXu) on brandy (HP-UX) at Tue Aug
23 17:23:28 EDT 1994
      STARTed xt_test client 2 (testcase bXrdXu) - local PID is 13187
      STARTing xt_test client 3 (testcase bXrdXu) on davis (OSF1) at Tue Aug 23
 17:23:33 EDT 1994
      STARTed xt_test client 3 (testcase bXrdXu) - local PID is 13191
      STARTing xt_test client 4 (testcase bXrdXu) on davis (OSF1) at Tue Aug 23
 17:23:35 EDT 1994
      STARTed xt_test client 4 (testcase bXrdXu) - local PID is 13195
   ------------------------------------------------------------------------
   Finished client startup for process 11770 at Tue Aug 23 17:23:35 EDT 1994


   Check startup for iteration 3 (bXrdXu) at Tue Aug 23 17:23:35 EDT 1994
   ------------------------------------------------------------------
      Looking for (startup) passed in the logs for iteration 3
      Starting at Tue Aug 23 17:23:35 EDT 1994 (maximum of 5 loops).
      Done looking for (startup) passed in the logs for iteration 3.
      Finished at Tue Aug 23 17:26:20 EDT 1994 (after 3 loops)...
      All clients got message
      Cleaning up temporary files...
      ERROR: CLIENT STARTUP FAILED!!
         The following clients reported errors during startup:
           1 brandy HP-UX
           4 davis OSF1
      Removing temporary files...
   ------------------------------------------------------------------
   Startup check for iteration 3 (bXrdXu) done at Tue Aug 23 17:26:22 EDT 1994

      ERROR in bXrdXu client startup for iteration 3
   Starting to kill jobs for process 11770 , iteration 3 at Tue Aug 23 17:26:23
 EDT 1994
   ---------------------------------------------------------------------
      No jobs running on brandy...
      No jobs running on davis...
   ---------------------------------------------------------------------
   Finished killing jobs for process 11770 at Tue Aug 23 17:26:27 EDT 1994

   Starting pass 3 cleanup at Tue Aug 23 17:26:27 EDT 1994
   -----------------------------------------------------------------
      Starting tree delete on davis (OSF1) at Tue Aug 23 17:26:28 EDT 1994
      Looking for Testcase gds_xds_str_001_brdX_dt passed in the logs for itera
tion 3
      Starting at Tue Aug 23 17:26:28 EDT 1994 (maximum of 5 loops).
      Done looking for Testcase gds_xds_str_001_brdX_dt passed in the logs for
iteration 3.
      Finished at Tue Aug 23 17:30:29 EDT 1994 (after 5 loops)...
      After 5 loops some clients still missing message.
      Cleaning up temporary files...
      WARNING - Tree deletion failed (see  for details)
      Creating /dcetest/dcelocal/status/current/gds_xds_str_001/error/3 for the
 logs...
      Copying logs to /dcetest/dcelocal/status/current/gds_xds_str_001/error/3.
..
        Pass log (/dcetest/dcelocal/status/current/gds_xds_str_001/working/1177
0.3.passlog)...
        D2 and xt logs...
      Copying logs from brandy to /dcetest/dcelocal/status/current/gds_xds_str_
001/error/3...
     Removing the logs from brandy...
      Copying logs from davis to /dcetest/dcelocal/status/current/gds_xds_str_0
01/error/3...
   Removing the logs from davis...
   ------------------------------------------------------------------
   Finished pass 3 cleanup at Tue Aug 23 17:30:42 EDT 1994


      gds_xds_str_001: ITERATION 3 - testcase (bXrdXu) GOT AN ERROR.


   --------------------------------------------------------------------
   COMPLETED gds_xds_str_001 ITERATION 3 AT Tue Aug 23 17:30:43 EDT 1994

[8/24/94 public]
This log really doesn't help identify the problem.  Please try to identify
the actual commands on which the test is tripping.

[8/24/94 public]

The following errors were returned in gds_xds_str_001 logs for this iteration:

 brandy.3.1.11770.HP-UX.d2log:

[7]gds_xds_str_001_bXrdu_1: Function BIND :
[7]gds_xds_str_001_bXrdu_1:     session = session1
[7]gds_xds_str_001_bXrdu_1:     workspace = workspace1
[7]gds_xds_str_001_bXrdu_1:     call ds_bind()
[7]gds_xds_str_001_bXrdu_1:     xt_cmp_status: received status from XT_BIND was
:
[7]gds_xds_str_001_bXrdu_1: "Some part of the directory is currently not availa
ble."
[7]gds_xds_str_001_bXrdu_1: xt_cmp_status: DS_SUCCESS expected but not returned
 from XT_BIND
[7]gds_xds_str_001_bXrdu_1:     (ERROR) expected and received DS_status from xt
_ds_bind differ
[7]gds_xds_str_001_bXrdu_1:     BIND returned ERROR

brandy.3.1.11770.HP-UX.xtlog:

1994-08-23-17:24:39.435-04:00I0.579 PID#13183 WARNING gds general d21readc.c 25
3 0x400baee8
Allocation of 2048 byte failed.
[7]gds_xds_str_001_bXrdu_1:     xt_cmp_status: received status from XT_BIND was
:
[7]gds_xds_str_001_bXrdu_1: "Some part of the directory is currently not availa
ble."
[7]gds_xds_str_001_bXrdu_1: xt_cmp_status: DS_SUCCESS expected but not returned
 from XT_BIND
[7]gds_xds_str_001_bXrdu_1:  Func xt_ds_bind : expected and received DS_status
differ
[7]gds_xds_str_001_bXrdu_1:  Func xt_run : Function call FAILED
[7]gds_xds_str_001_bXrdu_1: BIND returned ERROR

davis.3.3.11770.OSF1.cud2_log:

: Function BIND :
:       session = default_session
:       workspace = workspace1
:       call ds_bind()
:       xt_cmp_status: received status from XT_BIND was:
: "Some part of the directory is currently not available."
: xt_cmp_status: DS_SUCCESS expected but not returned from XT_BIND
:       (ERROR) expected and received DS_status from xt_ds_bind differ
:       BIND returned ERROR

davis.3.3.11770.OSF1.cuxtlog:

[1]: INITIALIZE returned OK
[1]: VERSION returned OK
[1]:    xt_cmp_status: received status from XT_BIND was:
[1]: "Some part of the directory is currently not available."
[1]: xt_cmp_status: DS_SUCCESS expected but not returned from XT_BIND
[1]:  Func xt_ds_bind : expected and received DS_status differ
[1]:  Func xt_run : Function call FAILED
[1]: BIND returned ERROR

davis.3.4.11770.OSF1.d2log: (several of the following errors)

[5]gds_xds_str_001_bXrdu_3: Function READ :
[5]gds_xds_str_001_bXrdu_3:     session = bound_session1
[5]gds_xds_str_001_bXrdu_3:     name = name76
[5]gds_xds_str_001_bXrdu_3:     selection = entry_info_selection1
[5]gds_xds_str_001_bXrdu_3:     call ds_read()
[6]gds_xds_str_001_bXrdu_2:     xt_cmp_status: received status from XT_DSREAD w
as:
[4]gds_xds_str_001_bXrdu_1:     xt_cmp_status: received status from XT_DSREAD w
as:
[7]gds_xds_str_001_bXrdu_1:     xt_cmp_status: received status from XT_DSREAD w
as:
[6]gds_xds_str_001_bXrdu_2: "Some part of the Directory Service is not willing
to perform the operation."
[6]gds_xds_str_001_bXrdu_2: xt_cmp_status: DS_SUCCESS expected but not returned
 from XT_DSREAD
[6]gds_xds_str_001_bXrdu_2:     (ERROR) expected and received DS_status from xt
_ds_read differ
[6]gds_xds_str_001_bXrdu_2:     READ returned ERROR

[6]gds_xds_str_001_bXrdu_2: Function UNBIND :
[6]gds_xds_str_001_bXrdu_2:     session = bound_session1
[6]gds_xds_str_001_bXrdu_2:     call ds_unbind()
[4]gds_xds_str_001_bXrdu_1: "Some part of the Directory Service is not willing
to perform the operation."
[4]gds_xds_str_001_bXrdu_1: xt_cmp_status: DS_SUCCESS expected but not returned
 from XT_DSREAD
[4]gds_xds_str_001_bXrdu_1:     (ERROR) expected and received DS_status from xt
_ds_read differ
[4]gds_xds_str_001_bXrdu_1:     READ returned ERROR

[6]gds_xds_str_001_bXrdu_2: Function BIND :
[6]gds_xds_str_001_bXrdu_2:     session = session1
[6]gds_xds_str_001_bXrdu_2:     workspace = workspace1
[6]gds_xds_str_001_bXrdu_2:     call ds_bind()
[7]gds_xds_str_001_bXrdu_1: "Some part of the Directory Service is not willing
to perform the operation."
[7]gds_xds_str_001_bXrdu_1: xt_cmp_status: DS_SUCCESS expected but not returned
 from XT_DSREAD
[7]gds_xds_str_001_bXrdu_1:     (ERROR) expected and received DS_status from xt
_ds_read differ
[7]gds_xds_str_001_bXrdu_1:     READ returned ERROR

[8/29/94 public]

Some further info:

The gdsdirinfo command on the HP server after the tests were run returned:

#       PROCTYPE    PID    DIRID    IPCID    STATE
#
        Monitor     5549     -        5        -        
        DUA-Cache   5553     -        1        -        
        C-Stub      5555     -        2        -        
        DSA         5559     1        31       - 

The gdsdirinfo on the OSF1 client after the test run was completed returned:

#       PROCTYPE    PID    DIRID    IPCID    STATE
#
        Monitor     19955    -        5        -        
        DUA-Cache   6581     -        1        -        
        DSA         5875     1        31       -        
        C-Stub      5533     -        2        -        
        S-Stub      6039     1        11       -        
        S-Stub      6304     2        12       -        
        DSA         6049     2        32       -

[9/26/94 public]

I'm going to reassign this to test, as it looks to be a problem with setup.
Assigning more than one server per dirid may well fix this.

[10/12/94 public]
This should have been switch to the 'systest' component when this was
reassigned to 'test.'  Doing so now.



CR Number                     : 11839
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : need to add dcecp verification to audstr001 test
Reported Date                 : 8/23/94
Found in Baseline             : 1.1b14
Found Date                    : 8/23/94
Severity                      : A
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/23/94 public]


Need to add dcecp verification of resulting security audit trail
into audstr001 test.

[9/19/94 public]

Discussed this bug with Susan,
Can manually verify results of tests 
by doing "dcecp audtrail show" after tests complete.
Lowering priority of this bug to a 2.



CR Number                     : 11831
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcecdsacl6
Short Description             : dcecdsacl6 config variables don't work
Reported Date                 : 8/23/94
Found in Baseline             : 1.1b14
Found Date                    : 8/23/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/23/94 public]

This test uses a variety of variables in different places to
specify the number of administrative and non-administrative
users to generate. With the current test code, the only way the
test can work is if you use the exact set of values specified
currently in the data file. The variables are interrelated in
unexpected, and not particularly obvious, ways, and they don't
define what the comments state that they define.

[9/12/94 public]

Assigned to Peter O'Malley.



CR Number                     : 11788
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcecdsacl6
Short Description             : Test operations don't overlap
Reported Date                 : 8/19/94
Found in Baseline             : 1.1b14
Found Date                    : 8/19/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/19/94 public]

The documentation for this test states that "five administrators
on each host in Cell1 and Cell2 simulataneously verify valid and
invalid ACL entry type permissions and management on replicas, soft
links, objects, and directories." (DCE 1.0.3 Porting and Testing Guide, 
section 11.1.2.7. In the test, however, all the test operations are
performed sequentially. That is, the commands for one adminstrator
on one clearinghouse in one cell for one specified state are executed,
and then the next set for a different adminstrator are executed, etc.
There is no overlapping of operations at all in this test as far
as I can determine.

[9/12/94 public]

Assigned to Peter O'Malley



CR Number                     : 11784
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcecdsacl6
Short Description             : dcecdsacl6 doesn't create CDS clearinghouses or replicas
Reported Date                 : 8/19/94
Found in Baseline             : 1.1b14
Found Date                    : 8/19/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/19/94 public]

cds.acl.6, prior to being ported to TET, created clearinghouses
and directory replicas. This functionality was apparently dropped 
in the port to TET, but its removal was not highlighted. The 
documentation of the TET-ized version of the test in the DCE Porting 
and Testing Guide for DCE 1.0.3 (section 11.5.4) describes this 
ts part of the test's functionality. It states, for example, that "Three 
clearinghouse replicas are created on server machines". None are actually 
created by the TET-ized version of the test.

[9/12/94 public]

Assigned to Peter O'Malley.



CR Number                     : 11741
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dced
Short Description             : DCDREL001,002, and 003 need module headers expanded
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b13
Found Date                    : 8/17/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/17/94 public]

The module headers in the code modules used in DCDREL001, 002, 
and 003 have incomplete entries, such as "TBD" for items that 
have been determined. These need to be completed.

[09/28/94 public]
Not necessary for 1.1, deferred.



CR Number                     : 11740
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dced
Short Description             : Modify DCDREL002 and 003 so that each dcecp procedure targets the dced on some other node
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b13
Found Date                    : 8/17/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/17/94 public]

DCDREL002 and DCDREL003 allow an unlimited number of test nodes but
are currently restricted to performing their operations locally on each 
of the test nodes selected.

When time permits these should be modified to operate between
nodes, so that the dcecp commands executed on each selected node effect
a dced on some other selected node.

[10/25/94 public]

Clearly time doesn't permit in this release. Deferred.



CR Number                     : 11739
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dced
Short Description             : DCDREL001 needs modification to use dce_server_register
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b13
Found Date                    : 8/17/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/17/94 public]

DCDREL001 runs two test servers per node, with the intent being
that one of these servers will register endpoints using rpc_ep_register() 
and the other will use dce_server_register(). Since the definition
of the API for the latter routine wasn't finalized when the test
was developed, both servers were initially setup to use the former. 

The test should be enhanced when time permits to use the dced call.



CR Number                     : 11648
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : dlgcfg001 not capturing all output
Reported Date                 : 8/10/94
Found in Baseline             : 1.1b13
Found Date                    : 8/10/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/10/94 public]


The dlgcfg001 system test is not capturing all output
when there is an error.  When rsh does not succeed
it should report back an error.

[9/19/94 public]

Discussed this bug with Susan, lowering priority to a 2.



CR Number                     : 11645
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : dlgcfg001 test not checking rsh
Reported Date                 : 8/10/94
Found in Baseline             : 1.1b13
Found Date                    : 8/10/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/10/94 public]

The dlgcfg001 test does not check first if the the other
nodes in the cell are accessible by rsh.

The test should do this first.

[9/19/94 public]

After discussing with Susan, lowering priority
of this bug to a 2.



CR Number                     : 11615
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : 64-bit porting changes
Reported Date                 : 8/9/94
Found in Baseline             : 1.1
Found Date                    : 8/9/94
Severity                      : E
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/9/94 public]

The following systest files have occurances of 'long' and 'unsigned
long's that need to be changed to 'signed32' and 'unsigned32' types:

	bank.c			rpc.cds.3_cmain.c	client_aux.c
	bankd.c			rpc.cds.3_smain.c 	server.c	
	transactions.c					client.c

	rpc.sec.2._smain.c	secrgy_client.c		dceth002_c.c
				secrgy_server.c		thd_client.c
				utils.c			thd_server.c
							thd_util.c

The following systest files needed to have the RPC stacksize increased 
for a 64-bit platform:
	
	bankd.c
	rpc.cds.3_smain.c
	rpc.sec.2_smain.c
	secrgy_server.c

The following systest files needed to have the pthread stacksize increased 
for a 64-bit platform:

	secrgy_client.c

The follOwing systset files included an include file not needed by the alpha
platform:

	xx_lib_r.c

Following are the diff files from the above files:
===========================================================================
systest/src/rpc/bank.c
------------------------------
209,211c206,208
< static void DoWithdraw(handle_t, char *, signed32, error_status_t *);
< static void DoDeposit(handle_t, char *, signed32, error_status_t *);
< static void DoInquire(handle_t, char *, signed32, error_status_t *);
---
> static void DoDeposit(handle_t, char *, long, error_status_t *);
> static void DoWithdraw(handle_t, char *, long, error_status_t *);
> static void DoInquire(handle_t, char *, long, error_status_t *);
252c249
<                                           char **, char **, signed32 *,
---
>                                           char **, char **, long *,
274,276c271
< **    long amount = -1;
< */
<       signed32 amount = -1;
---
>       long amount = -1;

569c564
<                                   signed32 *amt, unsigned32 *etry_syntax,
---
>                                   long *amt, unsigned32 *etry_syntax,
779c774
< static void DoDeposit(handle_t h, char *acct_name, signed32 amt,
---
> static void DoDeposit(handle_t h, char *acct_name, long amt,
842c837
< static void DoWithdraw(handle_t h, char *acct_name, signed32 amt,
---
> static void DoWithdraw(handle_t h, char *acct_name, long amt,
905c900
< static void DoInquire(handle_t h, char *acct_name, signed32 amt,
---
> static void DoInquire(handle_t h, char *acct_name, long amt,
                                                                      
systest/rpc/bankd.c
-----------------------------
199,201d195
< #ifdef __alpha
< #include <dce/dtss_long_size.h.
< #endif
213,216c207,210
< error_status_t res_deposit(handle_t, char *, signed32);
< error_status_t unres_deposit(handle_t, char *, signed32);
< error_status_t res_withdraw(handle_t, char *, signed32);
< error_status_t unres_withdraw(handle_t, char *, signed32);
---
> error_status_t res_deposit(handle_t, char *, long);
> error_status_t unres_deposit(handle_t, char *, long);
> error_status_t res_withdraw(handle_t, char *, long);
> error_status_t unres_withdraw(handle_t, char *, long);
242c236
< signed32 NumAccts, NextAcct;
---
> long NumAccts, NextAcct;
276,278c270
< #ifdef __alpha
<         unsigned32 thread_stack_size, status;
< #endif
---
>
283,296d274
< #if BITS_IN_LONG >= 64
<         /*
<          * If 64 bits, increase the RPC thread stack size, because
<        * addresses take twice as much room.
<         */
<          thread_stack_size = 64000;
<          rpc_mgmt_set_server_stack_size(thread_stack_size, &status);
<          if (status != rpc_s_ok)
<                 {
<                 perror("\n Error increasing thread_stack_size");
<                 exit(1);
<                 }
< #endif
<
628c606
<       signed32 tot;
---
>       long tot;
791c769
<       signed32 current_time;
---
>       long current_time;
888c866
< error_status_t res_deposit(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t res_deposit(handle_t h, char *acct_name, long amount)
962c940
< error_status_t res_withdraw(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t res_withdraw(handle_t h, char *acct_name, long amount)
1041c1019

< error_status_t unres_deposit(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t unres_deposit(handle_t h, char *acct_name, long amount)
1108c1086
< error_status_t unres_withdraw(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t unres_withdraw(handle_t h, char *acct_name, long amount)
                                                                          
systest/rpc/transactions.c
------------------------------
<  *
142,145c138,141
<       signed32 ck_trans;      /* total checking transactions */
<       signed32 sv_trans;      /* total savings transactions */
<       signed32 cd_trans;      /* total cd transactions */
<       signed32 ira_trans;     /* total ira transactions */
---
>       long ck_trans;  /* total checking transactions */
>       long sv_trans;  /* total savings transactions */
>       long cd_trans;  /* total cd transactions */
>       long ira_trans; /* total ira transactions */
164c160
<       signed32 amount, finish_time;
---
>       long amount, finish_time;
193,194c189,190
<       finish_time = time((signed32 *)0) + atoi(argv[4]);
<       while (time((signed32 *)0) < finish_time)
---
>       finish_time = time((long *)0) + atoi(argv[4]);
>       while (time((long *)0) < finish_time)
196c192
<               srand((int) time((signed32 *)0));
---
>               srand((int) time((long *)0));
201c197
<               srand((int) time((signed32 *)0));
---
>               srand((int) time((long *)0));
207c203
<               srand((int) time((signed32 *)0));
---
>               srand((int) time((long *)0));
212c208
<               srand((int) time((signed32 *)0));
---
>               srand((int) time((long *)0));

systest/rpc/rpc.cds.3/rpc.cds.3_cmain.c
-------------------------------------------
323c319
< signed32  id_lifetime;             /*---* expiration interval      *---*/
---
> long  id_lifetime;                 /*---* expiration interval      *---*/
2225c2221
<    signed32 tbuf;
---
>    long tbuf;

systest/rpc/rpc.cds.3/rpc.cds.3_smain.c
-----------------------------------------
<  *
315c310
< signed32  id_lifetime;
---
> long  id_lifetime;
575,577c570
< #ifdef __alpha
<    unsigned32 thread_stack_size;
< #endif
---
>
1442,1456c1435
< #if BITS_IN_LONG >=64
<      /*
<       * If 64 bits, increase the RPC thread stack size, because
<       * addresses take twice as much room.
<      */
<      thread_stack_size = 64000;
<      rpc_mgmt_set_server_stack_size(thread_stack_size, &status);
<      if (status != rpc_s_ok)
<       {
<       perror("rpc stacksize increase failed");
<       exit(1);

< #endif

systest/rpc/rpc.sec.2/rpc.sec.2_smain.c
--------------------------------------------
<  *
233,236d228
< #ifdef __alpha
< #include <dce/dtss_long_size.h>
< #include <rpc.h>
< #endif
247,250d238
<
< #ifdef __alpha
< unsigned32 thread_stack_size;
< #endif
332c320
< signed32  id_lifetime;
---
> long  id_lifetime;
1323,1336d1310
<
< #if BITS_IN_LONG >= 64
<    /*
<     * If 64 bits, increase the RPC thread stack size, because
<     * addresses take twice as much room.
<    */
<    thread_stack_size = 64000;
<    rpc_mgmt_set_server_stack_size(thread_stack_size, &status);
<    if (status != rpc_s_ok)
<      {
<       perror(" \n Error increasing thread_stack_size :");
<       exit(1);
<       }
< #endif

systest/security/sec.rgy.7/secrgy_client.c
--------------------------------------------
<  *
105,107c101
< #ifdef __alpha
< #include <dce/dtss_long_size.h>
< #endif
---
>
210,214d203
<
< #ifdef __alpha
<    pthread_attr_t       attr;
<    int                  stacksize;
< #endif
252c241
<                 duration =  atoi(optarg);
---
>                 duration =  atol(optarg);
271c260
<                 client_number = atoi(optarg);
---
>                  client_number = atol(optarg);
284c273
<                 delay = atoi(optarg);
---
>                 delay = atol(optarg);
288c277
<                 add_number = atoi(optarg);
---
>                 add_number = atol(optarg);
490,514d478
< #if BITS_IN_LONG >= 64
<   /* Increase pthreads stack size, because 64 bit addresses need twice
<   ** as much room.
<   */
<   ret = pthread_attr_create(&attr);
<   if (ret == -1)
<    {
<       perror("pthread_attr_create failed");
<       exit(0);
<    }
<    stacksize = pthread_attr_getstacksize(attr);
<    if (ret == -1)
<    {
<       perror("pthread_attr_getstacksize failed");
<       exit(0);
<    }
<    stacksize = 64000;
<    ret = pthread_attr_setstacksize(&attr,stacksize);
<    if (ret == -1)
<    {
<       perror("pthread_attr_set stacksize failed");
<       exit(0);
<    }
<
<    /* create the threads using the new attributes */
518,527d481
<                       attr,
<                       (pthread_startroutine_t) do_test,
<                       (pthread_addr_t) &call_args[i]);
<       }
<
< #else /* create the threads using the default */
<
<    if ( server_exit_f != TRUE && userkey == NULL ){
<       for (i = 0; i < client_number; ++i) {
<               ret = pthread_create ( &thd_id[i],
532d485
532d485
< #endif
579,580c532,533
<               unsigned32 esize,
<               unsigned32 *ecount)
---
>               unsigned long esize,
>               unsigned long *ecount)
606c559
<                  unsigned32 bsize,
---
>                  unsigned long bsize,
608c561
<                  unsigned32 *bcount)
---
>                  unsigned long *bcount)
                                       
systest/security/sec.rgy.7/secrgy_server.c
------------------------------------------------
<  *
121,123c117
< #ifdef __alpha
< #include <dce/dtss_long_size.h>
< #endif
---
>
130,134d123
< #ifdef __alpha
< unsigned32      thread_stack_size;
< int             pstacksize;
< pthread_attr_t  attr;
< #endif
215,216c204,205
<    signed32           cert_expire;
<    signed32           refresh_interval;
---
>    long                       cert_expire;
>    long               refresh_interval;
470,516d458
< #if BITS_IN_LONG >= 64
<         /*
<         ** Increase the pthread stacksize because 64 bit addresses take twice
<         ** as much room.
<         */
<         ret = pthread_attr_create(&attr);
<         if (ret == -1)
<         {
<             perror("pthread_attr_create failed");
<             exit(0);
<         }
<         pstacksize = pthread_attr_getstacksize(attr);
<         if (ret == -1)
<         {
<             perror("pthread_attr_getstacksize failed");
<             exit(0);
<         }
<         pstacksize = 64000;
<         ret = pthread_attr_setstacksize(&attr,pstacksize);
<         if (ret == -1)
<         {
<             perror("pthread_attr_set stacksize failed");
<             exit(0);
<         }
<
<         /*
<         ** Increase the RPC thread stacksize, also.
<         */
<         thread_stack_size = 50000;
<         rpc_mgmt_set_server_stack_size(thread_stack_size, &tstatus);
<         if (tstatus != rpc_s_ok)
<           {
<           perror("rpc stacksize increase failed");
<           exit(1);
<           }
<
<
<         /* Create the thread using the increased values */
<         if (pthread_create(&thread_id,
<                                attr,
<           (pthread_startroutine_t)maintain_id,
<           (pthread_addr_t)&ref_thread_params) != 0 ) {
<               perror(" \n    Error creating refresh thread:");
<               exit(1);
<        }
<
< #else  /* Create the thread using the defaults */
523,524d464
< #endif
<
584,588c524,528
<    unsigned32                 secs;
<    unsigned32                 microsecs;
<    unsigned32                 rt_secs;
<    unsigned32                 rt_duration;
<    signed32                   cert_expire;
---
>    unsigned long              secs;
>    unsigned long              microsecs;
>    unsigned long              rt_secs;
>    unsigned long              rt_duration;
>    long                               cert_expire;
621c561
< #if defined(SNI_SVR4) || defined(__alpha)
---
> #ifdef SNI_SVR4
648c588
<     unsigned32 data_count;
---
>     unsigned long data_count;

708c648
<       signed32                add_number,
---
>       long                    add_number,
719,720c659,660
<       unsigned32              secs;
<       unsigned32              microsecs;
---
>       unsigned long           secs;
>       unsigned long           microsecs;
781c721
<       signed32                add_number,
---
>       long                    add_number,
792,793c732,733
<       unsigned32              secs;
<       unsigned32              microsecs;
---
>       unsigned long           secs;
>       unsigned long           microsecs;
907c847
<    signed32           cert_expire;
---
>    long                       cert_expire


systest/security/utils.c
------------------------------
120c117
< void getimer(unsigned32 *sec, unsigned32 *usec)
---
> void getimer(long *sec, long *usec)
122c119
<         unsigned32 tsec;
---
>         long tsec;
272c269
< signed32           unix_num;
---
> long               unix_num;

systest/threads/dceth002_c.c
-------------------------------
167c165
<     threads_p = (pthread_t *)malloc(sizeof(pthread_t)*thread_count);
---
>     threads_p = malloc(sizeof(pthread_t)*thread_count);

systest/threads/thd_client.c
------------------------------
412c409
< void assign_array(signed32 *a, int n)
---
> void assign_array(long *a, int n)
417c414
<               a[i] = (signed32)i;
---
>               a[i] = (long)i;
429,430c426,427
<       void allocate_arrays(signed32 **, signed32 **, int), assign_arrays(signe
d32 *, int);
<       void validate_and_free_arrays(signed32 *, signed32 *, int, char *);
---
>       void allocate_arrays(long **, long **, int), assign_arrays(long *, int);
>       void validate_and_free_arrays(long *, long *, int, char *);
437c434
<       signed32 *original, *copy;
---
>       long *original, *copy;
440,446c437,443
<
<       rpc_string_binding_compose((unsigned_char_t *)nil_string,
<                                   (unsigned_char_t *)a->protocol,
<                                   (unsigned_char_t *)a->address,
<                                   (unsigned_char_t *)a->endpoint,
<                                   (unsigned_char_t *)nil_string,
<                                   (unsigned_char_t **)&string_binding,
---
>
>       rpc_string_binding_compose(nil_string,
>                                   a->protocol,
>                                   a->address,
>                                   a->endpoint,
>                                   nil_string,
>                                   &string_binding,
452c449
<       rpc_binding_from_string_binding((unsigned_char_p_t)string_binding, &rh,
&status);
---
>       rpc_binding_from_string_binding(string_binding, &rh, &status);
518c515
< void allocate_arrays(signed32 **original_array, signed32 **copy_array, int arr
ay_size)
---
> void allocate_arrays(long **original_array, long **copy_array, int array_size)
520,521c517,518
<       *original_array = (signed32 *) malloc(array_size * sizeof(signed32));
<       if (*original_array == (signed32 *)NULL)
---
>       *original_array = (long *) malloc(array_size * sizeof(long));
>       if (*original_array == (long *)NULL)
528,529c525,526
<       *copy_array = (signed32 *) malloc(array_size * sizeof(signed32));
<       if (*copy_array == (signed32 *)NULL)
---
>       *copy_array = (long *) malloc(array_size * sizeof(long));
>       if (*copy_array == (long *)NULL)
542c539
< void validate_and_free_arrays(signed32 *original_array, signed32 *copy_array,
---
> void validate_and_free_arrays(long *original_array, long *copy_array,
                                                                          
systest/rpc/threads/thd_server.c
-------------------------------------
161,162c158,159
<       signed32 *orig_ar;     /* address of the original array */
<       signed32 *sub_ar;      /* address of the copy array */
---
>       long *orig_ar;     /* address of the original array */
>       long *sub_ar;      /* address of the copy array */
182c179
<       void get_port(unsigned_char_t *, unsigned_char_t *, unsigned32), get_and
_show_bindings(void);
---
>       void get_port(char *, char *, unsigned32), get_and_show_bindings(void);
214c211
<       get_port((unsigned_char_t *)protocol, (unsigned_char_t *)endpoint, max_c
alls);
---
>       get_port(protocol, endpoint, max_calls);
318c315
< void get_port(unsigned_char_t *prot, unsigned_char_t *port, unsigned32 max)
---
> void get_port(char *prot, char *port, unsigned32 max)
322c319
<       rpc_server_use_protseq_ep(prot, max, (unsigned_char_t *)port, &status);
---
>       rpc_server_use_protseq_ep(prot, max, port, &status);
350,353c347,349
<                 rpc_binding_to_string_binding(bind_vec->binding_h[i],
<                               (unsigned_char_p_t *)&string_binding,
<                               &status);
<
---
>               rpc_binding_to_string_binding(bind_vec->binding_h[i],
>                                            &string_binding,
>                                            &status);
359c355
<                 rpc_string_free((unsigned_char_p_t *)&string_binding, &status)
;
---
>                 rpc_string_free(&string_binding, &status);
411,412c407,408
< error_status_t thd_read_portion (handle_t h, signed32 *orig_ar, signed32 s, si
gned32 *copy,
<                                signed32 mi, signed32 count, signed32 chunks)
---
> error_status_t thd_read_portion (handle_t h, long *orig_ar, long s, long *copy
,
>				long mi, long count, long chunks)


systest/threads/thd_util.c
------------------------------
257c254
<       unsigned32 long_host_addr;
---
>       ulong long_host_addr;
260c257
<       hp = gethostbyaddr(&long_host_addr, sizeof(unsigned32), AF_INET);
---
>       hp = gethostbyaddr(&long_host_addr, sizeof(ulong), AF_INET);
514a512
> }

systest/tools/xx_lib_r.c
---------------------------
108d104
< #ifndef __alpha
110d105
< #endif

[10/11/94 public]
Bumping priority to 0 and assigning to Susan now that the unintegrated
tree is open. The steps that need to happen are:
	- changes reviewed
	- changes tested
	- submission to unintegrated
	- logs compressed and placed in project archive
	- pointer in Rel Notes to tests and logs

The changed files and logs are in:

	/afs/dce.osf.org/project/dce/osf/gmd

The review should verify that there are no "ifdef/ifndef alpha"
directives and that the:

#if BITS_IN_LONG >= 64

directives have been changed to

#if LONG_BIT >= 64

I promised Kim all the tests and logs would go out on the 1.1 tape.
If the unintegrated tree is not appropriate (ie. because the above
steps can not happen), please submit to the nosupport/unsupport area.

Kim tested on:
	- 1.1 on the intel 486/osf1
	- 1.0.3 on the HP/hp-ux

[10/17/94 public]
I've reviewed the changes and just noticed that there is still one
instance of 'alpha' used in secrgy_server.c:
616c561
< #if defined(SNI_SVR4) || defined(__alpha)
---
> #ifdef SNI_SVR4

Is this required?  Also, can you tell me where I can get the
full files so that I can try to build/run them on the 1.1 HP
platform?  If they are checked into your sandbox I can just 
check them out from that branch into my sanbox and rebuild.

[10/26/94 public]
Due to time constraints, we were unable to test these changes in 
time for submission to the unintegrated tree.  So we've included
the diffs here:


===src/test/systest/audit/ts/Makefile===
30c30
< audrel001_LIBS		= -ltettcm -ltetapi -ldcetst -laudit ${${TARGET_MACHINE}_LIBS} -ldce 
---
> audrel001_LIBS		= -ltettcm -ltetapi -ldcetst -laudit -ldce 

===src/test/systest/dced/ts/rel/dcdrel001/Makefile===
49c49
< LIBS		= -ldceutils -ldcetst -ldcdtst ${${TARGET_MACHINE}_LIBS} -ldce
---
> LIBS		= -ldceutils -ldcetst -ldcdtst -ldce

===src/test/systest/dced/ts/rel/dcdrel002/Makefile===
40c40
< LIBS            =  ${${TARGET_MACHINE}_LIBS} -ldce
---
> LIBS            =  -ldce

===src/test/systest/dced/ts/rel/dcdrel003/Makefile===
46c46
< LIBS            = ${${TARGET_MACHINE}_LIBS} -ldce
---
> LIBS            = -ldce

===src/test/systest/rpc/rpc.cds.3/Makefile===
134c134
< LIBS = -ldce ${${TARGET_MACHINE}_LIBS}
---
> LIBS = -ldce

===src/test/systest/rpc/rpc.sec.2/Makefile===
174c174
< LIBS = -ldce ${${TARGET_MACHINE}_LIBS} 
---
> LIBS = -ldce  

===src/test/systest/rpc/bank.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  * 	Changed longs to signed32 and unsigned longs to unsigned32 
<  *
209,211c206,208
< static void DoWithdraw(handle_t, char *, signed32, error_status_t *); 
< static void DoDeposit(handle_t, char *, signed32, error_status_t *); 
< static void DoInquire(handle_t, char *, signed32, error_status_t *);
---
> static void DoDeposit(handle_t, char *, long, error_status_t *); 
> static void DoWithdraw(handle_t, char *, long, error_status_t *); 
> static void DoInquire(handle_t, char *, long, error_status_t *);
252c249
< 					    char **, char **, signed32 *, 
---
> 					    char **, char **, long *, 
274,276c271
< ** 	long amount = -1; 
< */
< 	signed32 amount = -1; 
---
> 	long amount = -1; 
569c564
< 				    signed32 *amt, unsigned32 *etry_syntax, 
---
> 				    long *amt, unsigned32 *etry_syntax, 
779c774
< static void DoDeposit(handle_t h, char *acct_name, signed32 amt, 
---
> static void DoDeposit(handle_t h, char *acct_name, long amt, 
842c837
< static void DoWithdraw(handle_t h, char *acct_name, signed32 amt, 
---
> static void DoWithdraw(handle_t h, char *acct_name, long amt, 
905c900
< static void DoInquire(handle_t h, char *acct_name, signed32 amt, 
---
> static void DoInquire(handle_t h, char *acct_name, long amt, 

===src/test/systest/rpc/bankd===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Increases RPC stacksize for 64-bit compatibility 
<  *
210,213c207,210
< error_status_t res_deposit(handle_t, char *, signed32); 
< error_status_t unres_deposit(handle_t, char *, signed32); 
< error_status_t res_withdraw(handle_t, char *, signed32); 
< error_status_t unres_withdraw(handle_t, char *, signed32);
---
> error_status_t res_deposit(handle_t, char *, long); 
> error_status_t unres_deposit(handle_t, char *, long); 
> error_status_t res_withdraw(handle_t, char *, long); 
> error_status_t unres_withdraw(handle_t, char *, long);
239c236
< signed32 NumAccts, NextAcct;
---
> long NumAccts, NextAcct;
273,275c270
< #ifdef __osf__
<         unsigned32 thread_stack_size, status; 
< #endif
---
> 
280,293d274
< #if LONG_BIT >= 64
<         /* 
<          * If 64 bits, increase the RPC thread stack size, because
< 	 * addresses take twice as much room.
<         */
<          thread_stack_size = 24000;
<          rpc_mgmt_set_server_stack_size(thread_stack_size, &status);
<          if (status != rpc_s_ok)
<                 {
<                 perror("\n Error increasing thread_stack_size");
<                 exit(1);
<                 }
< #endif
< 
625c606
< 	signed32 tot;
---
> 	long tot;
788c769
< 	signed32 current_time;
---
> 	long current_time;
885c866
< error_status_t res_deposit(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t res_deposit(handle_t h, char *acct_name, long amount)
959c940
< error_status_t res_withdraw(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t res_withdraw(handle_t h, char *acct_name, long amount)
1038c1019
< error_status_t unres_deposit(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t unres_deposit(handle_t h, char *acct_name, long amount)
1105c1086
< error_status_t unres_withdraw(handle_t h, char *acct_name, signed32 amount)
---
> error_status_t unres_withdraw(handle_t h, char *acct_name, long amount)

===src/test/systest/rpc/bnk_util===
11,13d10
<  * Revision 1994/08/08 khelbick
<  * 	cast malloc of uuid_* for 64-bit compatability
<  *
287c284
< 	uuid_t *handle_obj = (uuid_t *)malloc(sizeof(uuid_t));
---
> 	uuid_t *handle_obj = malloc(sizeof(uuid_t));

===src/test/systest/rpc/rpc.runtime.1/client.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32 
<  *
196c193
<         my_addr = *(unsigned32 *) hp->h_addr;
---
>         my_addr = *(unsigned long *) hp->h_addr;

===src/test/systest/rpc/rpc.runtime.1/client_aux.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *
66,67c63,64
< void client_alloc (ndr_void_p_t state,
< 		   unsigned32 bsize,
---
>  void client_alloc (ndr_void_p_t state,
> 		   unsigned long bsize,
69c66
< 		   unsigned32 *bcount)
---
> 		   unsigned long *bcount)
76c73
< void client_iop_pull (rpc_ss_pipe_state_t state_arg,
---
>  void client_iop_pull (rpc_ss_pipe_state_t state_arg,
78,79c75,77
< 		      unsigned32 esize,
< 		      unsigned32 *ecount)
---
>  		      unsigned long esize,
> 		      unsigned long *ecount)
> 
113c111
< 		      unsigned32 ecount)
---
> 		      unsigned long ecount)
163c161
<     unsigned32 msec;
---
>     unsigned long msec;
173c171
<         unsigned32 elapsed_usec;
---
>          unsigned long elapsed_usec;
185,186c183,184
<         avg_time->msec = (unsigned32) (elapsed_usec / 1000);
<         avg_time->usec = (unsigned32) (elapsed_usec % 1000);
---
>          avg_time->msec = (unsigned long) (elapsed_usec / 1000);
>         avg_time->usec = (unsigned long) (elapsed_usec % 1000);
207,208c205,206
<     iop_struct.pull = (void *)client_iop_pull;
<     iop_struct.push = (void *)client_iop_push;
---
>     iop_struct.pull = client_iop_pull;
>     iop_struct.push = client_iop_push;

===src/test/systest/rpc/rpc.runtime.1/dcerpcrun===
336,338d335
< # we had problems with this in v1.0.3 test script - had to change to 
< # while [ $n -le $NETRETRYS ] && [ $n -ne $status ] && [ $n -ne $rflag ] 
< # kh - 8/8/94
354,358d350
< # there is no match function in DEC/OSF 1 awk function - however, it is
< # supported in gawk from Free Software Foundation which OSF supports - kh
< # in V1.0.3 script I changed this to gawk as follows:
< # print - $pingresult | gawk '{ if (match($(NF-2),"100%")) {exit 1} else {exit 0# } }' - kh 8/8/94
< 

===src/test/systest/threads/dceth002_c.c===
11,12d10
<  * Revision 1994/08/08 
<  *    Cast the malloc to the correct type. C Groder 8/94 
167c165
<     threads_p = (pthread_t *)malloc(sizeof(pthread_t)*thread_count);
---
>     threads_p = malloc(sizeof(pthread_t)*thread_count);

===src/test/systest/rpc/rpc.runtime.1/dumpDB.c===
23d22
< #ifndef __osf__
25,26d23
< #ifndef __i386
< #ifndef __hpux           /** cg add - not needed for HPUX or i386*/

===src/test/systest/rpc/rpc.cds.3/rpc.cds.3_cmain.c===
11,14d10
<  *
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *
323c319
< signed32  id_lifetime;             /*---* expiration interval      *---*/
---
> long  id_lifetime;                 /*---* expiration interval      *---*/
2225c2221
<    signed32 tbuf;
---
>    long tbuf;

===src/test/systest/rpc/rpc.cds.3/rpc.cds.3_smain.c===
11,15d10
<  *
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  * 	Increase RPC stacksize for 64-bit compatibility
<  *
315c310
< signed32  id_lifetime;
---
> long  id_lifetime;
575,577c570
< #ifdef __osf__
<    unsigned32 thread_stack_size;
< #endif
---
> 
1442,1456c1435
< #if LONG_BIT >=64
<      /*
<       * If 64 bits, increase the RPC thread stack size, because
<       * addresses take twice as much room.
<      */
<      thread_stack_size = 64000; 
<      rpc_mgmt_set_server_stack_size(thread_stack_size, &status);
<      if (status != rpc_s_ok) 
< 	{
< 	perror("rpc stacksize increase failed");
< 	exit(1);
<         }
< #endif
< 
<     /*---*
---
>    /*---*

===src/test/systest/rpc/rpc.sec.2/rpc.sec.2_smain.c===
11,14d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *  	Increased RPC stacksize for 64-bit compatability
<  *
233d228
< #include <dce/rpc.h>
244,247d238
< 
< #ifdef __osf__
< unsigned32 thread_stack_size;
< #endif
329c320
< signed32  id_lifetime;
---
> long  id_lifetime;
1320,1333d1310
< 
< #if LONG_BIT >= 64
<    /* 
<     * If 64 bits, increase the RPC thread stack size, because
<     * addresses take twice as much room.
<    */
<    thread_stack_size = 64000;
<    rpc_mgmt_set_server_stack_size(thread_stack_size, &status);
<    if (status != rpc_s_ok)
<      {   
<       perror(" \n Error increasing thread_stack_size :");
<       exit(1);
<       }
< #endif

===src/test/systest/security/sec.rgy.7/secrgy_client.c===
11,14d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *      Increased pthread stacksize to be 64-bit compatible  
<  *
104a101
> 
207,211d203
< 
< #ifdef __osf__
<    pthread_attr_t       attr;
<    int                  stacksize;
< #endif
249c241
<                 duration =  atoi(optarg);
---
>                 duration =  atol(optarg);
268c260
<                 client_number = atoi(optarg);
---
>                  client_number = atol(optarg);
281c273
<                 delay = atoi(optarg);
---
>                 delay = atol(optarg);
285c277
<                 add_number = atoi(optarg);
---
>                 add_number = atol(optarg);
487,511d478
< #if LONG_BIT >= 64
<   /* Increase pthreads stack size, because 64 bit addresses need twice 
<   ** as much room.
<   */
<   ret = pthread_attr_create(&attr);
<   if (ret == -1)
<    {
< 	perror("pthread_attr_create failed");
< 	exit(0);
<    }
<    stacksize = pthread_attr_getstacksize(attr);
<    if (ret == -1)
<    {
< 	perror("pthread_attr_getstacksize failed");
< 	exit(0);
<    }
<    stacksize = 64000; 
<    ret = pthread_attr_setstacksize(&attr,stacksize);
<    if (ret == -1)
<    {
< 	perror("pthread_attr_set stacksize failed");
< 	exit(0);
<    }
< 
<    /* create the threads using the new attributes */
515,524d481
< 			attr, 
< 			(pthread_startroutine_t) do_test,
< 			(pthread_addr_t) &call_args[i]); 
<    	}
< 
< #else /* create the threads using the default */
< 
<    if ( server_exit_f != TRUE && userkey == NULL ){	
<    	for (i = 0; i < client_number; ++i) {
< 		ret = pthread_create ( &thd_id[i], 
529d485
< #endif
576,577c532,533
< 		unsigned32 esize,
< 		unsigned32 *ecount)
---
> 		unsigned long esize,
> 		unsigned long *ecount)
603c559
< 		   unsigned32 bsize,
---
> 		   unsigned long bsize,
605c561
< 		   unsigned32 *bcount)
---
> 		   unsigned long *bcount)

===src/test/systest/security/sec.rgy.7/secrgy_server.c===
11,14d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *	Increased pthread stacksize for 64-bit compatibility
<  *
120a117
> 
127,131d123
< #ifdef __osf__
< unsigned32      thread_stack_size;
< int             pstacksize;
< pthread_attr_t  attr;
< #endif
212,213c204,205
<    signed32		cert_expire;
<    signed32		refresh_interval;
---
>    long			cert_expire;
>    long 		refresh_interval;
467,513d458
< #if LONG_BIT >= 64
<         /*
<         ** Increase the pthread stacksize because 64 bit addresses take twice
<         ** as much room.
<         */
<         ret = pthread_attr_create(&attr);
<         if (ret == -1)
<         {
<             perror("pthread_attr_create failed");
<             exit(0);
<         }
<         pstacksize = pthread_attr_getstacksize(attr);
<         if (ret == -1)
<         {
<             perror("pthread_attr_getstacksize failed");
<             exit(0);
<         }
<         pstacksize = 64000;
<         ret = pthread_attr_setstacksize(&attr,pstacksize);
<         if (ret == -1)
<         {
<             perror("pthread_attr_set stacksize failed");
<             exit(0);
<         }
<                                                  
<         /*
<         ** Increase the RPC thread stacksize, also.
<         */
<         thread_stack_size = 50000;
<         rpc_mgmt_set_server_stack_size(thread_stack_size, &tstatus);
<         if (tstatus != rpc_s_ok)
< 	    {
<     	    perror("rpc stacksize increase failed");
< 	    exit(1);
< 	    }
< 
<        
<         /* Create the thread using the increased values */
<         if (pthread_create(&thread_id,
<           			 attr,
<           (pthread_startroutine_t)maintain_id,
<           (pthread_addr_t)&ref_thread_params) != 0 ) {
<           	perror(" \n    Error creating refresh thread:");
<           	exit(1);
<        }
< 
< #else  /* Create the thread using the defaults */
522c467
< #endif
---
> 
579,583c524,528
<    unsigned32   		secs; 
<    unsigned32   		microsecs;
<    unsigned32    		rt_secs;
<    unsigned32    		rt_duration;
<    signed32			cert_expire;
---
>    unsigned long		secs; 
>    unsigned long		microsecs;
>    unsigned long 		rt_secs;
>    unsigned long		rt_duration;
>    long				cert_expire;
616c561
< #if defined(SNI_SVR4) || defined(__alpha) 
---
> #ifdef SNI_SVR4
643c588
<     unsigned32 data_count;
---
>     unsigned long data_count;
703c648
< 	signed32		add_number,
---
> 	long			add_number,
714,715c659,660
<    	unsigned32		secs; 
<    	unsigned32		microsecs;
---
>    	unsigned long		secs; 
>    	unsigned long		microsecs;
776c721
< 	signed32		add_number,
---
> 	long			add_number,
787,788c732,733
<    	unsigned32		secs; 
<    	unsigned32		microsecs;
---
>    	unsigned long		secs; 
>    	unsigned long		microsecs;
902c847
<    signed32		cert_expire;
---
>    long			cert_expire;

===src/test/systest/rpc/rpc.runtime.1/server.c===
11,14d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *	Included include file stdlib.h - needed for clean compile
<  *
224c220
<     rpc_server_listen((signed32)1, &st);
---
>     rpc_server_listen((long)1, &st);

===src/test/systest/threads/thd_client.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  * 
412c409
< void assign_array(signed32 *a, int n)
---
> void assign_array(long *a, int n)
417c414
< 		a[i] = (signed32)i;
---
> 		a[i] = (long)i;
429,430c426,427
< 	void allocate_arrays(signed32 **, signed32 **, int), assign_arrays(signed32 *, int);
< 	void validate_and_free_arrays(signed32 *, signed32 *, int, char *);
---
> 	void allocate_arrays(long **, long **, int), assign_arrays(long *, int);
> 	void validate_and_free_arrays(long *, long *, int, char *);
437c434
< 	signed32 *original, *copy;
---
> 	long *original, *copy;
440,446c437,443
< 
< 	rpc_string_binding_compose((unsigned_char_t *)nil_string,
< 				    (unsigned_char_t *)a->protocol,
< 				    (unsigned_char_t *)a->address,
< 				    (unsigned_char_t *)a->endpoint,
< 				    (unsigned_char_t *)nil_string,
< 				    (unsigned_char_t **)&string_binding,
---
> 	
> 	rpc_string_binding_compose(nil_string,
> 				    a->protocol,
> 				    a->address,
> 				    a->endpoint,
> 				    nil_string,
> 				    &string_binding,
518c515
< void allocate_arrays(signed32 **original_array, signed32 **copy_array, int array_size)
---
> void allocate_arrays(long **original_array, long **copy_array, int array_size)
520,521c517,518
< 	*original_array = (signed32 *) malloc(array_size * sizeof(signed32));
< 	if (*original_array == (signed32 *)NULL)
---
> 	*original_array = (long *) malloc(array_size * sizeof(long));
> 	if (*original_array == (long *)NULL)
528,529c525,526
< 	*copy_array = (signed32 *) malloc(array_size * sizeof(signed32));
< 	if (*copy_array == (signed32 *)NULL)
---
> 	*copy_array = (long *) malloc(array_size * sizeof(long));
> 	if (*copy_array == (long *)NULL)
542c539
< void validate_and_free_arrays(signed32 *original_array, signed32 *copy_array, 
---
> void validate_and_free_arrays(long *original_array, long *copy_array, 

===src/test/systest/threads/thd_server.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *
161,162c158,159
< 	signed32 *orig_ar;     /* address of the original array */
< 	signed32 *sub_ar;      /* address of the copy array */
---
> 	long *orig_ar;     /* address of the original array */
> 	long *sub_ar;      /* address of the copy array */
182c179
< 	void get_port(unsigned_char_t *, unsigned_char_t *, unsigned32), get_and_show_bindings(void); 
---
> 	void get_port(char *, char *, unsigned32), get_and_show_bindings(void); 
214c211
< 	get_port((unsigned_char_t *)protocol, (unsigned_char_t *)endpoint, max_calls);
---
> 	get_port(protocol, endpoint, max_calls);
318c315
< void get_port(unsigned_char_t *prot, unsigned_char_t *port, unsigned32 max)
---
> void get_port(char *prot, char *port, unsigned32 max)
322c319
< 	rpc_server_use_protseq_ep(prot, max, (unsigned_char_t *)port, &status);
---
> 	rpc_server_use_protseq_ep(prot, max, port, &status);
350,353c347,349
<                 rpc_binding_to_string_binding(bind_vec->binding_h[i],
< 				(rpc_binding_handle_t *)&string_binding,
< 			        &status);
< 
---
> 		rpc_binding_to_string_binding(bind_vec->binding_h[i],
> 					     &string_binding,
> 					     &status);
359c355
<                 rpc_string_free((rpc_binding_handle_t *)&string_binding, &status);
---
>                 rpc_string_free(&string_binding, &status);
411,412c407,408
< error_status_t thd_read_portion (handle_t h, signed32 *orig_ar, signed32 s, signed32 *copy,
< 				 signed32 mi, signed32 count, signed32 chunks)
---
> error_status_t thd_read_portion (handle_t h, long *orig_ar, long s, long *copy,
> 				 long mi, long count, long chunks)

===src/test/systest/threads/thd_util.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *
257c254
< 	unsigned32 long_host_addr;
---
> 	ulong long_host_addr;
260c257
< 	hp = gethostbyaddr(&long_host_addr, sizeof(unsigned32), AF_INET);
---
> 	hp = gethostbyaddr(&long_host_addr, sizeof(ulong), AF_INET);
514a512
> }

===src/test/systest/rpc/transactions.c===
11,14d10
<  *
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *
127,130d122
< #include <dce/dce.h>
< #ifdef __osf__
< #include <dce/nbase.h>
< #endif
146,149c138,141
< 	signed32 ck_trans; 	/* total checking transactions */
< 	signed32 sv_trans; 	/* total savings transactions */
< 	signed32 cd_trans; 	/* total cd transactions */
< 	signed32 ira_trans;	/* total ira transactions */
---
> 	long ck_trans; 	/* total checking transactions */
> 	long sv_trans; 	/* total savings transactions */
> 	long cd_trans; 	/* total cd transactions */
> 	long ira_trans;	/* total ira transactions */
168c160
< 	signed32 amount, finish_time;
---
> 	long amount, finish_time;
197,198c189,190
< 	finish_time = time((signed32 *)0) + atoi(argv[4]);
< 	while (time((signed32 *)0) < finish_time)
---
> 	finish_time = time((long *)0) + atoi(argv[4]);
> 	while (time((long *)0) < finish_time)
200c192
< 		srand((int) time((signed32 *)0));
---
> 		srand((int) time((long *)0));
205c197
< 		srand((int) time((signed32 *)0));
---
> 		srand((int) time((long *)0));
211c203
< 		srand((int) time((signed32 *)0));
---
> 		srand((int) time((long *)0));
216c208
< 		srand((int) time((signed32 *)0));
---
> 		srand((int) time((long *)0));

===src/test/systest/security/sec.rgy.7/utils.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *      Changed longs to signed32 and unsigned longs to unsigned32
<  *
120c117
< void getimer(unsigned32 *sec, unsigned32 *usec)
---
> void getimer(long *sec, long *usec)
122c119
<         unsigned32 tsec;
---
>         long tsec;
272c269
< signed32           unix_num;
---
> long               unix_num;

===src/test/systest/tools/xx_lib_r.c===
11,13d10
<  * Revision for AXP porting purposes 1994/08/08 khelbick
<  *     cma include files not needed for DEC/OSF - our threads are in kernal 
<  *
108d104
< #ifndef __osf__
110d105
< #endif



CR Number                     : 11569
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : gds
Short Description             : fix machine name output in worldSetup.gds
Reported Date                 : 8/5/94
Found in Baseline             : 1.1b13
Found Date                    : 8/5/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/5/94 public]

Test setup output should be fixed to indicate the node name where gds is being 
configured.  Test setup output currently uses the DSA directory id.



CR Number                     : 11564
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 11351
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : cds
Short Description             : rep_ch_2_checklist should not access excluded clearinghouse
Reported Date                 : 8/4/94
Found in Baseline             : 1.1b13
Found Date                    : 8/4/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/4/94 public]

Once a clearinghouse has been excluded using set dir to new epoch ... exclude,
it should not be accessed again.

The expected output and commands in rep_ch_2_checklist should be changed to
reflect this.

[9/26/94 public]

rep_ch_2_checklist cannot be run completely due to the inability to move the 
clearinghouse to another machine (CR 9700).



CR Number                     : 11537
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : systest
Subcomponent Name             : 
Short Description             : problems running rep_ch_1_checklist testcase
Reported Date                 : 8/3/94
Found in Baseline             : 1.0.3
Found Date                    : 8/3/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/3/94 public]

This is being opened on behalf of the IBM DCE System Test 
group.  They have been unable to run the testcase 
rep_ch_1_checklist.  Here is their report:

        OSF test case rep_ch_1_checklist needs to be reworked.

        The Following   are errors I found in OSF test   case 
        rep_ch_1_checklist, so for:

        1. According to the context, it is a mixture of automatic and 
           manual test case.    It needs to be fixed to become a 
           fully pure automatic test case.


        2. In line 370 of the test case it tries to stop dce on the remote
           host, but, then in the next line, it checks the dce status in
           the current machine.     It causes false failure because dce
           still runs on the current machine.

        line 370:       stop_dce_remote ${ADD_SRV} ${OSPASSWORD}
                                         ^^^^^^^^^
        line 371:       dcestatus ${HOSTNAME}
                                   ^^^^^^^^^^

        3. In line 501, there is an undefined "<cellname>"
 
        line 501:       cdscp create replica /.:/testdir clearinghouse \
                        /.../<cellname>/admintest_ch
                             ^^^^^^^^^^
 
        4. In line 506, there is an undefined "<local>_ch".   Also
           "(capture status)" needs either to be removed or marked as
           comment.

        line 506:       cdscp show replica /.:/testdir clearinghouse \
                        /.:/<local>_ch (capture stats)
                            ^^^^^^^^^^

        5. In line 632, the test case tries to DISABLE THE TEST CLEARINGHOUSE
           ON THE REMOTE MACHINE, but, actually, the command will be executed
           on the LOCAL machine. 

        line 632:       cdscp disable server

        6. in lines 540, 681, 743, 806 and 847, the command cdscp is executed
           interactively, it needs to be fixed to become a automatic test case.

        line 540:cdscp
        line 681:cdscp
        line 743:cdscp
        line 806:cdscp
        line 847:cdscp


        Best regards,


                Charles Hsieh

[9/12/94 public]

Assigned to Peter O'Malley.



CR Number                     : 11536
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcegdshd
Short Description             : Add capability to GDS dcegdshd
system test to dump state information..
Reported Date                 : 8/3/94
Found in Baseline             : 1.1b13
Found Date                    : 8/3/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/3/94 public]

Add capability to GDS dcegdshd system test to dump state information
and enable tracing when a bind error occurs.



CR Number                     : 11277
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : sec_admin commands change_master and become master need to be added to replica_checklist
Reported Date                 : 7/13/94
Found in Baseline             : 1.1
Found Date                    : 7/13/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/13/94 public]

The sec_admin commands change_master and become_master should be added
to the security checklist test replica_checklist.



CR Number                     : 11221
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : Should be able to run audit tests in parrallel on different machines.
Reported Date                 : 7/8/94
Found in Baseline             : 1.1
Found Date                    : 7/8/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/20/94 public]

This is a test message.

[7/8/94 public]


Currently, a tester is restricted to running the audit tests
one one node at a time.  The tester should be able to 
run multiple copies of the tests on different nodes at the same time.



CR Number                     : 10946
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : checklist
Short Description             : problems in checklist tests
Reported Date                 : 6/14/94
Found in Baseline             : 1.1
Found Date                    : 6/14/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : DCPSAN002 DCPSAN003 admin_test_env.tcl functions rep_ch_1_checklist rep_ch_2_checklist start_dce stop_dce
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[6/14/94 public]

Problems in checklist tests, mostly due to directory structures changing,
some tool changes, etc.



CR Number                     : 10828
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : systest
Subcomponent Name             : rpc
Short Description             : alignment error in
.../src/test/systest/rpc/rpc.runtime.1/client_aux.c
Reported Date                 : 6/1/94
Found in Baseline             : 1.0.3
Found Date                    : 6/1/94
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : .../src/test/systest/rpc/rpc.runtime.1/client_aux.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[6/1/94 public]

 In .../src/test/systest/rpc/rpc.runtime.1/client_aux.c the declaration

          byte client_buffer[CLIENT_BUFFER_SIZE];

causes an alignment fault when it is accessed as 

	pt_struct *
        
in the function client_iop_pull().


Peter, If this fix is obvious/easy, go for it.  Otherwise, please
defer.  Thanks,Susan



CR Number                     : 10486
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : admin/Makefile
Short Description             : SUBDIRS includes ``file'' unconditionally.
Reported Date                 : 4/28/94
Found in Baseline             : 1.1
Found Date                    : 4/28/94
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : test/systest/admin/Makefile
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[4/28/94 public]

Defining NO_DFS has no effect in test/systest/admin; the file part
is always made.

*** Makefile~	Thu Apr 28 15:29:32 1994
--- Makefile	Thu Apr 28 15:30:46 1994
***************
*** 24,30 ****
--- 24,34 ----
  # 
  # $EndLog$
  #
+ .ifdef NO_DFS
+ SUBDIRS = cds sec
+ .else
  SUBDIRS = cds sec file
+ .endif
  
  .include <${RULES_MK}>

[7/6/94 public]
Assigning to me - probably applies to test/systest/file as well, no?



CR Number                     : 10484
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dts
Short Description             : dcetmsyn tests invalid / last sync
Reported Date                 : 4/28/94
Found in Baseline             : 1.0.3
Found Date                    : 4/28/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[4/28/94 public]
The test "dcetmsyn" is incorrect.  The test checks the time reported in
last synchronization before and after a sync occurred.  The time gets updated
whether the sync was completed or not.  Therefore the only check that should
be made to ensure that the sync occurred is the sync complete counter.
If the counter is not updated, then maybe check the other counters
(such as too few servers detected) for possible reasons of failure).



CR Number                     : 9984
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcerpbnk
Short Description             : dcerpbnk - Unconditionally overrides options.
Reported Date                 : 2/21/94
Found in Baseline             : 1.1
Found Date                    : 2/21/94
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[2/21/94 public]

There are a number of options supported by RUN.RPC for the DCERPBNK_AUTH
variant of DCERPBNK which are simply overridden by fixed values in the test
code.  They are: PRIN_NAME, AUTH_LVL, AUTH_SVC, and AUTHZ_SVC.



CR Number                     : 9972
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc/rpc.sec.2
Short Description             : rpc.sec.2 - Many problems with test
Reported Date                 : 2/16/94
Found in Baseline             : 1.0.3
Found Date                    : 2/16/94
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc.sec.2_smain.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[2/16/94 public]

There are several problems of varying importance:

1) When you run the rpc.sec.2 system test more than once without cleaning up
the CDS entry it uses to export binding and objects, this test failes. I
haven't saved the log messages.

2) This test prints error messages for status that was expected in a good
situation also.

3) Possible memory leak that could hurt in stress test.

Solve #2: To fix the printing of annoying error messages change the main() in
          rpc.sec.2_smain.c as shown below:

-----BEGIN FIX 1-------------
         if (status == rpc_s_entry_not_found)
         {
            printf("\n Server: No name space entry for %s\n",
                                                        PVAL(params,cds_name));           break;
         }

+#ifdef SNI_SVR4
+         /*
+          * Need to check 'status != rpc_s_no_more_members' before calling
+          * rpcsec2_check_stat() so that it won't print ERROR message for
+          * an expected status value = rpc_s_no_more_members. - Parul 1/11/94
+          */
+         if (status != rpc_s_no_more_members &&
+             rpcsec2_check_stat(status, "getting uuid",
+                              err_stats, &nerr_stats,  debug, 0) )
+#else /* !SNI_SVR4 */
         if (rpcsec2_check_stat(status, "getting uuid",
                              err_stats, &nerr_stats,  debug, 0) &&
                                              status != rpc_s_no_more_members)
#endif /* SNI_SVR4 */
         {
            /*---* error getting uuid, report it... *---*/
            printf("Can't get uuids to unexport!! \n");
            dump_uuid_v((uuid_vector_p_t)&uuid_v, &status);
-----END FIX 1-------------

Solve #3: To avoid possible memory leak free up the NS handle at the correct
          place in main() in file rpc.sec.2_smain.c as shown below:

-----BEGIN FIX 2-------------
      /*---*
       *---* we always push count one too far and allocate one too many uuids
       *---* so decrement the count and free the extra uuid slot.
       *---*/
      uuid_v.count--;
      free(uuid_v.uuid[uuid_v.count]);

+#ifdef SNI_SVR4    /* Moved up to more appropriate place */
+      {
+         unsigned32 status1;          /*---* Generic status return param *---*/+         /*---* free the context for the inquiry *---*/
+         printf(" Server: freeing inquiry context...");
+         rpc_ns_entry_object_inq_done(&inq_ctxt, &status1);
+
+         if (rpcsec2_check_stat(status1, "freeing inquiry context",
+                                err_stats, &nerr_stats, debug, 0))
+         {
+            rpcsec2_kill_threads(thread_ids[RPCSEC2_MAIN_THD]);
+            exit(1);
+         }
+       }
+#endif /* SNI_SVR4 */

      /*---*
       *---* we either exit the loop with rpc_s_entry_not_found or

    :         :             :                :                 :
    :         :             :                :                 :

                rpcsec2_kill_threads(thread_ids[RPCSEC2_MAIN_THD]);
                exit(3);
            }

+#ifndef SNI_SVR4    /* Move up to more appropriate place */
            /*---* free the context for the inquiry *---*/
            printf(" Server: freeing inquiry context...");
            rpc_ns_entry_object_inq_done(&inq_ctxt, &status);

            if (rpcsec2_check_stat(status, "freeing inquiry context",
                              err_stats, &nerr_stats, debug, 0))
            {
               rpcsec2_kill_threads(thread_ids[RPCSEC2_MAIN_THD]);
               exit(1);
            }
+#endif /* SNI_SVR4 */

            /*---* if repl_uuid is not set... *---*/
-----END FIX 2-------------

Solve #1: To fix the repeated invocation of the test do the following in
          the same function and file:

-----BEGIN FIX 3-------------
               obj_uuid_v.uuid[0] = uuid_v.count > 1? uuid_v.uuid[uuid_v.count]                                                   : uuid_v.uuid[0];

               /*---* if more than one uuid...  *---*/
+#ifndef SNI_SVR4
+               /*
+                * This condition should not be applied for decrementing
+                * uuid_v.count because even when it is set to 1, we are
+                * using the object uuid at uuid_v.uuid[0] that should not
+                * be freed in the later for loop and so count should be
+                * decremented to 0. - Parul 1/11/94
+                */
               if (uuid_v.count > 1)
+#endif /* SNI_SVR4 */
                  /*---*
                   *---* adjust the count to account for the uuid we will
                   *---* keep
                   *---*/
                  uuid_v.count--;

            } /*---* end of if (!repl_uuid && !use_null) *---*/
        :       :       :       :       :
        :       :       :       :       :
        :       :       :       :       :
   printf(" Server: Client principle name is %s\n", client_pname);

   /*---* if we are passing a UUID *---*/
+#ifdef SNI_SVR4
+   /*
+    * Fix a bug which causes the obj_uuid_v.uuid[0] to be overwritten by
+    * some junk in obj_uuid. -Parul 1/11/94
+    */
+   if (!use_null && repl_uuid)
+#else /* !SNI_SVR4 */
   if (!use_null || repl_uuid)
+#endif /* SNI_SVR4 */
   {
      /*---*
       *---* load the uuid_vector; we use the new value if we are replacing
       *---* the uuid, else we use the uuid we have from the namespace inquiry
       *---*/
-----BEGIN FIX 3-------------

Lines with prefix '+' shows changed code. These are generic fixes and so 
#ifdef's should be removed.

[2/17/94 public]
As the writer of this test, I felt compelled to note a few things:

 1. Since we usually ran in clean cells or against the same server, the
    uuid cleanup code was not a high priority, and the defect you found
    was missed.  I would fix this a bit differently (move the for loop in
    question into the "if (uuid_v.count > 1)" block and leave the
    conditional on the uuid_v.count decrement alone - avoids a needless
    trip into the for loop), but your fix will work.

    Note that the dce1.1 backing tree version of this program now supports
    cleanup of the namespace on server exit.

 
 2. the status-checking routine was designed to check status, and report
    anything that was not rpc_s_ok.  we just ignored the expected error
    reports.  I guess our annoyance threshold was by nature set higher :-).


 3. I am not sure how this maps to a memory leak.  The test was written
    with the intent that the server starts up and is long lived.  You are 
    right in stating that the server holds some static amount (one inquiry
    context's worth) of memory that it could possibly free, but I usually 
    associate a "leak" with the idea of a continously increasing loss of 
    memory.  If the server is re-started, the memory is released on the 
    exit.  Has this caused you problems?  I am not disputing the fixing of 
    this, I am just curious.

[2/17/94 public]

1. Sure you can fix it that way. I just wanted to avoid many line changes.
   However, the incorrect condition clause 'if (!use_null || repl_uuid)'
   v/s 'if (!use_null && repl_uuid)' would need to be applied in any case.

3. It wasn't a  serious problem. I noticed that NS handle was being freed
   at the wrong place. You're right that this chunk of memory will be freed
   when server exits. So far this hasn't caused any problems but I wouldn't
   want to wait for it.

[9/12/94 public]

Changed responsible engineer from DasSarma to Peter O'Malley.

[9/26/94 public]

The problem with the small memory leak at startup does not appear to be serious
enough to warrant a fix at this late date.



CR Number                     : 9945
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc/rpc.cds.3/rpc.cds.3_cmain.c
Short Description             : rpc.cds.3 - Client prints incorrect error for a valid status.
Reported Date                 : 2/11/94
Found in Baseline             : 1.0.3
Found Date                    : 2/11/94
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc.cds.3_cmain.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[2/11/94 public]

The rpc.cds.3 test's client reports rpc_s_no_more_binding as an ERROR eventhough
it isn't. Its an expected status when application does repeated calls to
rpc_ns_binding_import_next(). So I have moved the call to the status reporting
function 'rpcsec2_check_stat()' after the status is verified to be something
other than rpc_s_no_more_binding and rpc_s_ok.

      rpc_ns_binding_import_next(imprt_ctxt, &bndng_hndle, &ret_stat);

+#ifndef SNI_SVR4
      rpcsec2_check_stat(ret_stat, "getting next binding handle",
                                            err_stats, &nerr_stats, debug, 0);
+#endif  /* SNI_SVR4 */
      if (ret_stat == rpc_s_no_more_bindings)
         continue;
      else if (ret_stat != rpc_s_ok)
      {
+#ifdef SNI_SVR4
+         rpcsec2_check_stat(ret_stat, "getting next binding handle",
+                            err_stats, &nerr_stats, debug, 0);
+#endif  /* SNI_SVR4 */
         rpccds3_cli_kill_threads(thread_ids[RPCCDS3_MAIN_THD]);
         exit(1);
      }

The '+' prefix shows the addition. The code between first #ifndef should
actually be removed.



CR Number                     : 9666
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcerpbnk
Short Description             : dcerpbnk often fails trying to export ad_intf and tr_intf
Reported Date                 : 12/29/93
Found in Baseline             : 1.0.3
Found Date                    : 12/29/93
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/29/93 public]

The dcerpbnk system test often fails with the error:

	ERROR: /.:/ad_intf_tahiti & /.:/tr_intf_tahiti not exported
	       within ~120 seconds

The command used on tahiti was:

	run.rpc -t 84 -m "brandy dce9 tahiti" -P ncacn_ip_tcp dcerpbnk

The test failed 7 times out of 508 with this error.  I'm not sure if this
is a problem with bankd or DCE so I am assigning it to systest.

[09/12/94 public]

Priority from 1 ---> 2.



CR Number                     : 9548
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcethrpc_auth
Short Description             : dcethrpc_auth - Expects password=account name
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

DCETHRPC_AUTH requires that the user create an account where the password
is the same as the account name.  Furthermore, it requires that users
manually create local accounts (via the RGY_EDIT KTADD command) on machines
that DCETHRPC_AUTH is supposed to work with (-m option).  Use of this test
therefore not only requires manual intervention, but creates a potential
security hole as well.



CR Number                     : 9547
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcethrpc
Short Description             : dcethrpc - System Test unable to kill server
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

The DCE System Test, DCETHRPC, is, upon very rare occasion, unable to kill
the remote servers it starts up.  The kill is attempted by the script
KILLPROC.  That script not only fails to kill the server, but fails not
report that fact.  Ultimately this results in a test hang because DCETHRPC
asks interactively for permission to delete the server file, which it can't
just delete because the server is still running.



CR Number                     : 9546
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcecdsacl6
Short Description             : cds.acl.6 - Won't run with >1 CDS server
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

DCECDSACL6 must be run on the machine which is a CDS server.  Furthermore,
if there is a CDS replica, then DCECDSACL6 fails.  No work has been done
towards establishing the mechanism of the failure.  The failure is highly
reproducible in a small cell where the secondary CDS server simply backs up
the first.  It is not currently known if there were another server not
replicating the first if this would cause the failure.  Note that the
precise list of failures varies from run to run.

[03/03/94 public]

Put some modifications into DCECDSACL6.  The aforementioned problem of not
being able to run ACL6 on a machine other than the CDS server machine is no
longer a problem.  The other problem, failing when there is a replica, is
still a problem.

[03/03/94 public]

The DCE 1.1 system test HCLREL001 was based on DCECDSACL6. The same
limitations described here apply to HCLREL001. Please refer to 
OT 12488 for information on how HCLREL001 is addresssing these
limitations.



CR Number                     : 9545
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcecdsacl6 and dceseacl
Short Description             : cds.acl.6 and dceseacl - Need some output while running
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : E
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

DCECDSACL6 and DCESEACL are slow tests which produces blank or no output
under normal circumstances.  The output needs to be meaningful so that the
users can keep better track of what those test's progress.

[12/01/93 public]

As part of another CR I checked out DCECDSACL6 et al and, while I had them,
added some STDOUT message code to display progress.  This fix awaits
opening of the 1.1 tree.

[03/03/94 public]

The aforementioned DCECDSACL6 with messages to STDOUT is now in the 1.1
tree.  DCESEACL still produces no output, so this CR is only half done.



CR Number                     : 9544
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcecdsalc6 and cdsserv
Short Description             : cds.acl.6 and cdsserv - Expect CH names end with _ch
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

A number of DCE System Tests expect that existing DCE clearinghouse names
will end in "_CH" when this is not, in fact, a DCE requirement.  This
includes, but is not necessarily limited too, DCECDSACL6 and CDSSERV.



CR Number                     : 9543
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : profile.dce.tet
Short Description             : profile.dce.tet - Must not clear ENV variable
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Modify PROFILE.DCE.TET so that it does NOT clear the Korn Shell variable
ENV.  To do this makes the assumption that DCE users do not have anything
vital to proper operation of their systems tucked off in a file somewhere
(other than /.profile).  This is a VERY bad assumption to make.  It also
clobbers non-essential features that many system administrators have
created for themselves, and that's a negative for DCE customer
satisfaction.



CR Number                     : 9541
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcetest_config
Short Description             : dcetest_config - Needs to accept multiple options
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Change DCETEST_CONFIG so that in all cases where multiple options done
serially are legal, the user can enter them all at once and be done with
it.



CR Number                     : 9540
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcetest_config
Short Description             : dcetest_config - Error msgs gone before can be read
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Change DCETEST_CONFIG so that error messages don't disappear before you can
read them.  This could be done with a simple pause-for-acknowledge or
implementing (or turning on) something to inhibit clearing the screen.
(DCE_CONFIG has something like this.)

[7/7/94 public]
Actually, I think this can be cancelled.  Part of the work I did on another
defect was to remove the calls to 'clear'.



CR Number                     : 9538
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcetest_config
Short Description             : dcetest_config - Doesn't install tools by default
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Change DCETEST_CONFIG so that the tools are installed when all components
are selected (the "97" choice).  This will prevent our users from
accidentally not loading tools when they installing a new version of DCE
System Test.  In fact this REALLY needs to be changed because the default,
"no", is probably the wrong response in most cases.



CR Number                     : 9537
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : System Tests must check dir names
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : E
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Many DCE System Tests REQUIRE that $STTMPDIR and $TET_ROOT are the same
thing on all systems the test is running on, but there is no code to
enforce that.  You will see statements like

	rsh <machine_name> "mv $TET_ROOT/<something> $STTMPDIR"

Note the statement is expanded by the local machine but executed by the
remote machine.  If the local $STTMPDIR is, for example, /USR/TMP and the
remote machine has no /USR/TMP, then you will get a failure.  At minimum we
need code to sure that these places exist on all machines.  That is
probably easier than trying to get a machine to do remote name lookups.



CR Number                     : 9536
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : Can't run System Tests together
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Modify the DCE System Tests and their .DATA files so that you can always
run any combination of them anywhere in the cell without having to worry
about them interfering with each other (or themselves) and failing.

The usual problem here is the use of names that are invariant, mostly file
names and DCE object names.  For example, if you run two copies of DCETHRPC
anywhere in the cell and aim them both at one machine (-m option), then
they will each try to create a file called /TMP/THD_SERVER on that machine
and eventually delete it.  If the timing is such that one invocation
deletes the file immediately after the other has created it, then a failure
will occur.

One possible solution is to have a kind of a global naming scheme
throughout the DCE System Tests where a unique, base name is created by an
invocation of RUN_LOOPS.KSH, and that name is then used as part of all
file, directory, and DCE object names, thus preventing name collision and
the resulting failures.

If the nature of a test makes it impossible to run without regard to itself
or other DCE System Tests, then the test itself should detect that fact and
post an unambiguous error message to that effect in the TET Journal.



CR Number                     : 9535
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : System Tests use -dce- password
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

Modify PROFILE.DCE.TET so that it ASKS FOR the system administrator account
name (default: cell_admin) and its password (default: -dce-).  Export the
resulting variables.  Modify all the DCE System Tests and their .DATA files
to use these variables.  This is the first and most necessary step in being
able to run the DCE System Tests in a production DCE cell.  Without it
users are forced to create a stand-alone cell or run with a severe security
hole.

[11/23/93 public]

Changed this from a low priority defect to a higher priority enhancement.



CR Number                     : 9534
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : 
Short Description             : System Tests don't KDESTROY creds
Reported Date                 : 11/23/93
Found in Baseline             : 1.0.3
Found Date                    : 11/23/93
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/23/93 public]

We need to go through all the DCE System Tests and make sure that they all
KDESTROY during cleanup any creds they create while testing.  It has gotten
to the point where a weekend run can create so many credential files that
it will either take down DCE or take 20 minutes to delete them all.



CR Number                     : 9487
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : gds_xds_str_001
Short Description             : gds_xds_str_001 - needs to be tet-ized
Reported Date                 : 11/15/93
Found in Baseline             : 1.0.3
Found Date                    : 11/15/93
Severity                      : C
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/15/93 public]
The short description says it all.  Assigned to Peter Shaw for re-assignment.


Deferred.  Will not address in 1.1.  Assigned to Martha DasSarma to put
this on the right person's list anyway, even though we won't address it.



CR Number                     : 9135
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : systest
Subcomponent Name             : sec.rgy.7
Short Description             : sec.rgy.7 - test_drv.ksh does not support multiple machine configuration ...
Reported Date                 : 10/15/93
Found in Baseline             : 1.0.3
Found Date                    : 10/15/93
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : test_drv.ksh
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/15/93 public]

The shell script test_drv.ksh which is used to run the 
system test sec.rgy.7 does not allow a tester to configure 
more than one machine. At the present time, one can only 
run the test, server and client, on one machine. 

This script also uses the killproc procedure to bring down
the server in the cleanup function. Instead it should have
the client bring down the server. This feature is supported.



CR Number                     : 9133
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : systest
Subcomponent Name             : sec.rgy.7
Short Description             : sec.rgy.7
Reported Date                 : 10/15/93
Found in Baseline             : 1.0.3
Found Date                    : 10/15/93
Severity                      : B
Priority                      : 2
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/15/93 public]

Run sec.rgy.7 overnight on a two machine cell (both HP). After
of having run successfully for 1 hour, the client login and logout
operation run (happily) in an infinite loop.

This CR will also be used to report any enhancements made to the
test.

[11/8/93 public]

When running this test intercell, secrgy_client queries the wrong 
DCE Security server to calculate the MAX ID in the cell. It queries
the local SEC server, but instead it should query the one in the 
foreign cell where the accounts are to be added.



CR Number                     : 9116
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.runtime.1
Short Description             : rpc.runtime.1: IP address reported in journal file is wrong
Reported Date                 : 10/14/93
Found in Baseline             : 1.0.3
Found Date                    : 10/14/93
Severity                      : E
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/14/93 public]

In the TET journal file, the IP address of the client machines is reported 
incorrectly.  Example:

|Test results for client@traffic.osf.org (90.5.105.130)

The IP address should be 130.105.5.90 not 90.5.105.130.

[9/21/93 public]

Just not able to squeeze it in ... deferring.



CR Number                     : 8358
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.sec.2 and rpc.cds.3 setup scripts
Short Description             : rpc.sec.2 and rpc.cds.3 - contain limit calls for pre-osf1.1
Reported Date                 : 7/23/93
Found in Baseline             : 1.0.2
Found Date                    : 7/23/93
Severity                      : D
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : rpc.sec.2_setup.sh, rpc.sec.2_runtest.sh, rpc.cds.3_setup.sh, start_test
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/23/93 public]
While looking at the rpc.sec.2_setup.sh script for Everett Heller, I
noticed the code that special-cases remote shell calls to OSF/1 clients
because there was a problem in OSF/1 1.0.[34] is still in there.  The 
problem has been fixed in later versions of OSF/1, so the code should
be removed.  The code does not (to my knowledge) prevent the test from 
executing correctly, ergo the very low priority/severity.



CR Number                     : 8212
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : systest tools
Short Description             : there should be a repository of system test tools
Reported Date                 : 6/29/93
Found in Baseline             : 1.0.2b6
Found Date                    : 6/29/93
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : test/systest/file/conf_util.sh
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[6/29/93 public]
The script conf_util.sh is contains shell functions that are used by 
a number of system tests (rpc.sec.2, rpc.cds.3, and dfs.lock).  Currently,
this file (possibly with a different name) is located in two directories in
the source tree, and for dfs.lock, it will have to be submitted again.  

The proper solution is to submit this file and others like it that provide
useful, generic functions, to the systest/tools directory and remove the
redundant copies.

[07/21/93 public]
I submitted the Makefile to get the conf_util.sh script installed, but I 
am leaving the defect open so that this issue will get addressed sooner
or later.



CR Number                     : 8209
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dfs.lock system test
Short Description             : dfs.lock - does not save parameter info if command line args are used
Reported Date                 : 6/29/93
Found in Baseline             : 1.0.2b6
Found Date                    : 6/29/93
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : test/systes/file/dfs.lock
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[6/29/93 public]
Gail Driscoll had a big problem with the command line switches that I added
to the dfs.lock script; namely that they broke the "audit trail" that tied
a bunch of test results to a configuration file.  In other words, a test 
run should run only from a config file in order to insure that another test
run will use the same parameters, and to insure that the parameters of a 
test run are stored for inspection later.  Where the command line flags add
flexibility, they do not preserve the parameters of the test run unless the
log from the driver is saved.  So currently, if you want the command line
arguements, you have to invoke the test as dfs.lock_cl.  If you want to
save the parameters the test was run with, you have to save the driver log
(which, it occurs to me now, you probably would anyway, since the driver
log is what contains the lines like "ITERATION 43: PASSED" that tell you
if the test worked or not).

  It ocurred to me that a possible solution to this conflict between
reproducibility and flexibilty is to have dfs.lock create a new config file
that reflects the parameters under which the test will run, if any command
line parameters are specified.  This would work something like this:

    If any command line parameters are specified, then a flag is set that 
indicates a new config file is to be generated.  After all the command line
flags are processed, and the parameters of the test run are set, the flag
is checked.  If it is set, the following happens:
   - the script checks to see if a backup of the config file used by the
     test already exists (this is the file <config_file>.orig).  
   - if a backup does not exist, the config file is copied to the backup
     name.
   - the config file is copied to <config_name>.bak.
   - the current values of all the parameters are written to the config
     file in a format that is suitable for use as a config file for the 
     next test run.  A comment is placed in the file indicating that the 
     file was automatically generated, and indicating the path to the
     original and backup config files.

[9/23/93 public]
This is now to be an enhancement.

[9/21/94 public]
Nice idea ... all the dfs system tests could use this interface - but
one thing at a time, for 1.1, we updated all the automated tests to
have the same command line interface, maybe next time around we can enhance.



CR Number                     : 7995
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.cds.3 and rpc.sec.2 system tests
Short Description             : rpc.cds.3 and rpc.sec.2 - do not conform to 1.1 requirements
Reported Date                 : 5/13/93
Found in Baseline             : 1.0.2b23
Found Date                    : 5/13/93
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[5/13/93 public]
This defect is a place holder to remind us that tests, as well as "regular"
code, must conform to the 1.1 specifications for servicability, I18n and
code cleanup.  The rpc.sec.2 and rpc.cds.3 tests currently do not.



CR Number                     : 7994
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.sec.2 and rpc.cds.3 system tests
Short Description             : rpc.sec.2 and rpc.cds.3 - do not allow setup for tests to be undone.
Reported Date                 : 5/13/93
Found in Baseline             : 1.0.2b23
Found Date                    : 5/13/93
Severity                      : D
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[5/13/93 public]
The rpc.sec.2 and rpc.cds.3 system tests add principals and keys to the 
registry, and directories to the CDS namespace.  There should be a script
that removes the principals/keys and CDS directories, etc.



CR Number                     : 7992
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.sec.2 and rpc.cds.3 systests
Short Description             : rpc.sec.2 and rpc.cds.3 - do not handle exceptions.
Reported Date                 : 5/13/93
Found in Baseline             : 1.0.2b23
Found Date                    : 5/13/93
Severity                      : E
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[5/13/93 public]
Neither the client or server code for the rpc.sec.2 and rpc.cds.3 system
tests handles exceptions; ie: no TRY..CATCH wrapping of calls.

[9/23/93 public]
Changed to enhancement.



CR Number                     : 7792
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.cds.3
Short Description             : no driver for rpc.cds.3
Reported Date                 : 4/23/93
Found in Baseline             : 1.0.2b23
Found Date                    : 4/23/93
Severity                      : C
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[4/23/93 public]
There is no driver for the rpc.cds.3 system test.  This should be cloned
from the rpc.sec.2_runtest.sh script.

[9/23/93 public]
Re-assign to Cindy Mckeen as per Peter Shaw.

[10/15/92]

rpc.cds.3 can be run manually.  Writing a test driver to automate running
the test is more of an enhancement than a defect.  This CR is being
reclassified to an enhancement for 1.1.



CR Number                     : 7783
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : systest
Subcomponent Name             : rpc.sec.2 and rpc.cds.3 system tests
Short Description             : rpc.sec.2 and rpc.cds.3 - Are not portable to systems that do not have the getclock() library call.
Reported Date                 : 4/22/93
Found in Baseline             : 1.0.2b23
Found Date                    : 4/22/93
Severity                      : A
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : src/test/systest/rpc/rpc.cds.3/{rpc.cds.3_defs.h, rpc.cds.3_cmain.c,maintain_id.c, rep_timer.c}, src/test/systest/rpc/rpc.sec.2/{rpc.sec.2_cmain.c, rpc.sec.2_defs.h}
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[4/22/93 public]
The header files and source files noted above do sub-second timing using
the OSF AES specified library call getclock().  These files should be
changed so that a compiler switch can be used to make them use the
gettimeofday() library call instead, given it's wide use.

[9/23/93 public]
Marked as an enhancement as per Peter Shaw.



CR Number                     : 7686
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : dcetest_config
Short Description             : dcetest_config should have a setup phase for 102 tests and dcegdshd
Reported Date                 : 4/12/93
Found in Baseline             : 1.0.2b23
Found Date                    : 4/12/93
Severity                      : C
Priority                      : 3
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : src/test/systest/dcetest_config
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[4/12/93 public]
Many of the new system tests developed for dce1.0.2 and dcegdshd (from the dce
1.0.1 system test suite) need to have some sort of setup done between 
installation of the test and execution of the test.  The dcetest_config
script should provide a menu that allows the user to do this setup in 
automatic manner.

[08/11/93 public]
Changed owner to Cindy since she is working on dcetest_config.



CR Number                     : 7569
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : rpc.sec.2
Short Description             : rpc.sec.2 - needs to handle conn_closed and auth_tckt_expired in call loop
Reported Date                 : 3/23/93
Found in Baseline             : 1.0.2b19
Found Date                    : 3/23/93
Severity                      : C
Priority                      : 1
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : test/systest/rpc/rpc.sec.2/rpc.sec.2_cmain.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[3/23/93 public]
The rpc.sec.2_cmain.c file needs the following changes in the call loop
to handle the occurance of auth ticket expired and connection closed errors
in when making an rpc to the server (especially for TCP clients):

  1) if an auth ticket error is returned, then at most one message about it
     should be printed until the lat_id_refr value changes.  The client
     should probably delay until the next refresh.

  2) if a connetion closed is received, the client must rebind.

[08/23/93 public]
This defct was opened against the wrong component.  Changed the component
to the correct "dce".

[9/23/93 public]
Changed to enhancement as per Peter Shaw.



CR Number                     : 7019
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : test
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : systest
Subcomponent Name             : systest
Short Description             : rpc.sec.2,rpc.runtime.1,etc unportable filenames
Reported Date                 : 1/26/93
Found in Baseline             : 1.0.1
Found Date                    : 1/26/93
Severity                      : E
Priority                      : 4
Status                        : open
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[1/26/93 public]
There are a handful of files (rpc.sec.2,rpc.runtime.1,etc) in the
src/test/systest/rpc directory that have two periods in the directory
or filename.  This isn't maximally portable and should be renamed to
things like rpcsec2, runtime, etc.  I think one period in filenames
and no periods in directory names is best.

A cleanup/portability issue for 1.1

[5/13/94 public]
Since this is a system test bug, I am assigning it to Paul Ellis.
Personally, I don't think this is a useful thing to do, but
I will leave the final call up to the systest people.



