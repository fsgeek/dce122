CR Number                     : 13652
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dcecp
Subcomponent Name             : libdcecp
Short Description             : libdcecp has references to code that is not avaiable in libdce
Reported Date                 : 10/7/96
Found in Baseline             : 1.2.2
Found Date                    : 10/7/96
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/7/96 public]

1.2 has a libdcecp.a. I take it that the puspose of it is for people to 
extend dcecp without needing to have the dcecp source code.

I am doing a project that I need to add new functions to dcecp. I took
the approach of getting some code from OSF code base (main.c, commands.c,
rpccp.c), and linking them with my new code and libdcecp. I don't know
why I have to compile rpccp.c, but if I don't do it, I got lots of unresolved
functions from rpccp.o.

Anyway, I got the following unresovled functions:

.cdsImport_FullName
.cdsImport_SimpleName
.RPTowerUnpack
.cadump

They are used in cdscp_cache.c. Since I did not compile this code, it must be
in the libdcecp, but these code are not the libdce.a (they were in 
libcdscache.a and libcdsutil.a).

Without getting rid of these symbols, or having a library that can resolve
them, libdcecp is useless.

[10/7/96 public]
libdcecp contains the dcecp control code in a library. To create dcecp (the
control program), several other libraries are required, namely:

AT386_LIBS		= -lmach
HP800_LIBS      	= -lM
RIOS_LIBS		= -lkrb5 -lcfg -lodm -lm
SVR4_LIBS		= -lelf_r
dcecp_LIBS		= -ldcecp -lcdscache -lcdsutil -laudit -ltcl
-ldcedpvt -ldce ${${TARGET_MACHINE}_LIBS}

libdcecp isn't useless. It's just not everything you need to create a
functioning dcecp.

[10/7/96 public]

Maybe I was not clear. I was talking about using libdcecp as a dce user
(who does not have the complete dce source code and sandbox to access
unexported libraries and headers).

Last time I checked, libcdscache andlibcdsutil are not exported. Someone
with just a dce installation will not have access to them.

[10/22/96 public]

> 1.2 has a libdcecp.a. I take it that the puspose of it is for people to
> extend dcecp without needing to have the dcecp source code.

   No.  The reason HP split dcecp into a binary and a library was so we
   could *internally* compile the dcecp code into a number of admin tools
   that were under development at the time.  For example, the (or should
   I say HP's) cdsbrowser links with libdcecp and uses the dcpAppInit()
   function to initialize and set up the things the way main() does for
   dcecp.

   Never did we create libdcecp for the purpose of giving an HP *user*
   of dcecp the ability to extend dcecp in that way.  If you, as a user,
   wish to extend dcecp, write tcl scripts and stick them in a tclindex
   file.  That is the publicized and supported way to extend dcecp.



CR Number                     : 13589
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfam
Subcomponent Name             : 
Short Description             : distribution test of dfam OT
Reported Date                 : 8/12/96
Found in Baseline             : 1.1
Found Date                    : 8/12/96
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : none
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/12/96 public]

just a test to see how ditribution of DFAM OTs work....



CR Number                     : 13557
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : registry designate doesn't reserve new_master/self
Reported Date                 : 7/1/96
Found in Baseline             : 1.1
Found Date                    : 7/1/96
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/1/96 public]
The dcecp registry designate command does not take the old_master/self 
principal and mark it unreserved nor does it mark the new_master/self
as reserved. This makes it difficult to remove the old master from the
cell and provides no protection against deletion of the new_master/self
principal.

[7/3/96 public]
Changed CR in Code, Doc, or Test? from `doc' to `code' 
Changed Subcomponent Name from `tech_supp' to `'

[7/16/96 public]
Reassigned to Jim Truitt at HP per his advice.

[10/22/96 public]

>    Could you give me some status on this OT?  My customer is
>  querying me .....

   When I started to investigate this problem using hp dce, I found
   that in our implementation, the 'self' principal is never marked
   reserved in the first place, so the bug doesn't exist.  I asked
   our security people about it and received this reply:

      Ok, the wrap-up on this is that pre-OSFDCE1.1, you couldn't do a
      "registry designate" at all because the self principal was marked
      reserved.  So someone else fixed that problem by making it not
      reserved, locally.  IBM wouldn't have received that fix until
      OSFDCE1.2.1.

   So the fix for this problem is to not make the 'self' principal
   reserved in the first place, which effectively cancels this bug.



CR Number                     : 13407
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : cell show subcommand
Short Description             : The way "cell show" finds dtsserver is not right
Reported Date                 : 3/26/96
Found in Baseline             : 1.1
Found Date                    : 3/26/96
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : cell.dcp
Sensitivity                   : public

[3/26/96 public]

In a cell where there are dts servers and clerks, "cell show" will give
you a long list of dtsservers, including all the clerks.

The reason is: "cell show" finds the dtsservers by finding all cds entries
that end with "dts-entity". It does not further check if ther are really
dts servers, insteadof clerks.

"cell ping" does a better job by further doing a "dts show" on each of the
entries and then checking the type field. This works fine with all 1.1
environment.

In a mixed env (1.1 and 1.0.3), I have seen :"cell ping" fails becasue
some 1.0.3 dts clerk does not respond to dts show command. The reason is
(this is for DEC's 1.0.3 dce, I could not find an OSF 1.0.3 machien to test
yet): DEC's 1.0.3 dts clerk only exports acl interface to the dts-entity
entry. So the command "dts show /.:/hosts/$hostname/dts-entity" will return
"no more bindings" instead of something meaningful.

[3/26/96 public]

CANCELLED.

I have already asked that any "bug" found at OSF in pre-1.2 code be
checked to see if has ALREADY BEEN FIXED in the 1.2 code that HP dropped
to OSF in October '95.  It wastes your time to file them and my time to
reply.

This is already fixed, and you have the code.  But just to stress the point
the 1.1 stuff looked like this...

    _dcp_cell_debug "Show dts servers"
    set dtsservers [_dcp_list_find $namespace *dts-entity]
    if { [llength $dtsservers] > 0 } {
        set _dcp_cell_info "$_dcp_cell_info\{dtsservers "
        set host_name ""
        foreach element $dtsservers {
                      :
                      :

while the 1.2 stuff does this...

    _dcp_cell_debug "Show dts servers"

    _dcp_cell_debug "Looking up lan-profiles in cell-profile"
    set lan_profs [rpcprofile show $cell_name/cell-profile \
            -interface {6f264242-b9f8-11c9-ad31-08002b0dc035 1.0}]

    _dcp_cell_debug "lan_profs is $lan_profs"

    set got_dts_server 0
    set result "\{dtsservers "
    foreach lp $lan_profs {
        _dcp_cell_debug "Working on $lp..."
        foreach line [rpcprofile show [lindex $lp 1] \
                      :
                      :



CR Number                     : 13406
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : Unexpected behavior of "stat" against an LFS file
Reported Date                 : 3/25/96
Found in Baseline             : 1.2.1
Found Date                    : 3/25/96
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/25/96 public]
(for Hitachi...)
 
               The DFAM engineer who has investigated the DFAM failure in
        48 CHO (i.e., DFAM can run only 9 hours) reported that he found a 
        possible cause which logically explains the DFAM failure.
 
               He looked into the DFAM trace file to find that an unexpected
        behavior of the stat system call seems to have triggered the DFAM
        failure.  The DFAM trace file showed that the stat system call was
        issued to a DFS (LFS) file (not a UNIX file), and the issued system
        call sometimes waited for 2 hours before it stopped and reported a 
        connection time out error.  The previous spec of the stat system 
        call, however, was that it waits only for 5 minutes, then issues a 
        connection time out error.
 
               DFAM generates a process in every 2 to 3 seconds.  If the 
        stat system call waits for 2 hours, the number of the generated 
        process goes up to 3,000, and this can easily cause the shortage 
        of memory, which stops the DFAM 48 CHO.

[3/27/96 public]
I wanted to fill this in with some additional e-mail traffic.
 
What I sent to the pm list:
  
The ``dfstrace'' output from the DFS cache manager would be useful in
determining just what was going on here.  Without that I can only
speculate as to the possible causes.
 
The DFS CM sets a 10-minute timeout for each RPC that it makes to the
file server, so that if a call does not complete in that interval, the
calling thread will continue with the timeout signal.  Furthermore, if
the CM does not receive a response from the dfsbind helper process
within three minutes, the CM thread will continue with an error
indication.  If a second client holds conflicting tokens but is
unreachable due to a network partition, after two minutes the tokens
will be preemptively revoked and our client will be able to continue.
 
However, there are several circumstances that will cause a thread to
retry an operation for an unbounded interval; these are in general
controlled by the result of the cm_Analyze() routine in
src/file/cm/cm_rrequest.c.  The usual causes of these long (but
interruptible) retry sequences are that the fileset on which the
operation is being performed is involved in some long-lived
administrative activity.  It is conceivable, for instance, that moving a
very large, actively-updated fileset from server to server across a slow
link might delay a client this much.  Initial replica propagation might
conceivably take this long, as well.  Of course, these delays and
retries should have resulted in the eventual success of the call, not in
a connection timeout.
 
In any case, I am unaware of any specification for the stat() system
call that claims it will wait for only five minutes before declaring a
failure.  If there was a two-hour delay, it is worth trying to
understand why that delay was occurring, particularly if it ultimately
fails.  I would recommend the output of dfstrace and the console log as
being relevant to this further diagnosis.
  
>             DFAM generates a process in every 2 to 3 seconds.  If the
>      stat system call waits for 2 hours, the number of the generated
>      process goes up to 3,000, and this can easily cause the shortage
>      of memory, which stops the DFAM 48 CHO.
>             The questions we would like to ask the DFS engineers are:
>      Q1: Has the spec of the stat system call issued against DFS files
>          been changed so that the system call waits for 2 hours ?
 
As above: I am unaware of any such specification.  However, the RPCs
that the DFS CM generates are made with two timeouts:
	- the comm_timeout of (default+2), or about 2.5 minutes
	- the call_timeout of ten minutes
Either of these could result in an ETIMEDOUT value in errno.
 
>      Q2: If yes, Why ?
 
>      Q3: If no, could you please check the system call ?
 
I would be happy to investigate the trace and console output....
 
There was then some follow-up on getting dfstrace to generate correct output
(finding its message catalog files, I presume).  I then recommended:
 
Ideally, the result log would show how an error condition would evolve,
ultimately seeing both the beginning of the CM's vnode operation to the
end where it returns the error code that is passed to your test as an
errno value that you do not expect.
Tsuneo Yamaura then replied:
             Thank you very much for your quick suggestions.
     Now the trace command works.  We are trying to reproduce
     the memory shortage.  We will send you the trace file 
     when we catch the problem.
 
This is the up-to-date story as I understand it.

[3/28/96 public]
For the record, here is the Hitachi test program that they believe may
be able to reproduce the problem.
 /*
 * Test program for stat()
 * Repeatedly fork and have child processes issue stat().
 * Get dfstrace if child process didn't return in TIMEOUT seconds.
 * Target files must be prepared in the place name defined in STATFILE
 * before this program can be executed.  Number of the target files should
 * be same as* SETITER.
 */
#include <sys/stat.h>
#include <signal.h>
#include <sys/wait.h>
#include <syslog.h>
#include <errno.h>
#include <unistd.h>
#include <math.h>
#include <time.h>
 
#ifdef DEBUG
#define	SETITER		3000			/* number of spawn child in one set */
#define	DFSTRACE	"/bin/echo"
#define	STATFILE	"/tmp/stattest/statfile%04d"
#define	TIMEOUT		1
#else
#define	SETITER		3000			/* number of spawn child in one set */
#define	DFSTRACE	"/bin/dfstrace"
#define	STATFILE	"/:/stattest/statfile%04d"	/* target file on DFS */
#define	TIMEOUT		600				/* seconds to wait child to die */
#endif
 
#define	LOGFILE1	"/tmp/statlog1"	/* when stat() blocked */
#define	LOGFILE2	"/tmp/statlog2"	/* when blocked stat() returned */
 
char	statfile[1024];
int		alarm_flag, iteration;
extern int	errno;
 
void sig_alrm();
void child_stat();
 
main()
{
	pid_t pid;
	int status;
 
	alarm_flag = 0;
	openlog("STATTEST",(LOG_PID|LOG_CONS|LOG_NDELAY|LOG_NOWAIT),LOG_USER);
	syslog(LOG_ERR,"***STATTEST START***");
	if (signal(SIGALRM,sig_alrm) == -1){
		syslog(LOG_ERR,"***signal system call error***\n");
		exit(0);
	}
 
	while(1)
	{
		sprintf(statfile, STATFILE, iteration);
		if (iteration == SETITER){
			syslog(LOG_ERR,"***STATTEST PATH:%ld***\n",iteration);
			iteration = 0;
		} 
		if ((pid = fork()) < 0){
			syslog(LOG_ERR,"***fork failed***\n");
			exit(1);
		}
		else if (pid == 0){		/* child */
			signal(SIGALRM,SIG_IGN);
		 	child_stat();
		}
		/* parent */
		alarm(TIMEOUT);	
		
do_wait:
		if (wait(&status) != pid){
			switch(errno){
				case EINTR:
					goto do_wait;
				default:
					syslog(LOG_ERR,"***wait system call failed:%d***\n",errno);
					exit(1);
			}
		}
 
		alarm(0);
 
		if (alarm_flag == 1){
			if (execl(DFSTRACE,"dfstrace","dump","-set","cm","-file",LOGFILE2,0) == -1){
				syslog(LOG_ERR,"***execl error:%d***\n",errno);
				exit(1);
			}
		}
		iteration++;
	}		
}
void child_stat()
{
	struct stat buf;
 
#ifdef DEBUG
	printf("%s\n", statfile);
	if (iteration == 3) {
		sleep(TIMEOUT + 1);
	} else {
		stat(statfile,&buf);
	}
#else
	stat(statfile,&buf);
#endif
	exit(0);
}
 
void sig_alrm()
{
	pid_t pid;
	int status;
 
	if ((pid = fork()) < 0){
		syslog(LOG_ERR,"***fork system call error:%d***\n",errno);
	}
	else if (pid == 0){			/* child */
		if (execl(DFSTRACE,"dfstrace","dump","-set","cm","-file",LOGFILE1,0) == -1){
			syslog(LOG_ERR,"***execl system call error:%d***\n",errno);
		}
	}
	
	syslog(LOG_ERR,"***sig_alrm PATH***");
	if (wait(&status) != pid){
		syslog(LOG_ERR,"***wait system call error:%d***\n",errno);
		exit(0);
	}
 
	alarm_flag = 1;
	alarm(0);
	signal(SIGALRM,sig_alrm);
} 
 
I (CFE) have been running three copies of this for several hours on my test
machine, but have seen no failures.  I will update this OT (or try to) if
any failures occur.

[4/1/96 public]
Over the weekend, Hitachi was able to reproduce the problem and obtain
good dfstrace results, which were sent to Vikram and Susan as well as
to me.  Both sets arrived in good order.
 
They represent almost a continuous log.  The thread (pid 14551) that
first returned ETIMEDOUT after about two hours had in fact been
suspended from 3:39:28am (all times Monday 1 April 1996 JST) until
5:19:28am in a call to rpc_binding_set_auth_info(); the call was necessary
because a fresh PAG had apparently just been allocated and authenticated,
e.g. with dce_login.  When rpc_binding_set_auth_info() returned, it then
made an AFS_SetContext call to the file server (since it was a new
connection), which timed out after 600 seconds.  Since no authenticated
call to the file server had completed correctly in the previous few
minutes, the CM declared that the FX was ``down'' and returned ETIMEDOUT
to the application making the stat() call.
 
In looking at other activity to the same server, though, it seems that the
FX (the file server) started having trouble responding to RPCs after about
3:44:05am, when it responded to an unauthenticated call.  After that, calls
either to the file server itself or to the security service would hang or
fail, until about 5:19:27am, when one of the many pending AFS_SetContext
calls received a response indicating that the file server had crashed
and was returning to service, as normal, with new token grants temporarily
disabled until post-crash TSR should complete.  Various threads started
being unblocked for about eight more seconds, after which the server again
failed to respond to RPCs--before the CM had recovered completely.  At about
5:22:42am, the server started to accept RPCs again, and the CM threads started
to make progress again, but only for another 15 seconds.  Finally, at
5:30:53am, the server returned to service and stayed up.  After each of
these three suspensions in service, the server told the CM to re-negotiate
its token state because the file server was in its post-crash token
recovery phase.
 
Since the first two server up-times were so short and the CM so heavily
loaded, the CM was apparently unable to recover its state fully.  The actual
error returned to the application doing the stat() system call was due to
the ten-minute call timeout applied to an RPC call made to a server that
was down for the last several minutes of that interval.  The initial long
delay was entirely within the rpc_binding_set_auth_info() call, and I cannot
speak for why that call's behavior, why it would delay for an hour and forty
minutes and eventually succeed. 
 
There was some anomalous-seeming behavior on the part of the file server,
where it may not have been running reference-platform 1.2.1 file exporter
code.  Might this have been the case?
 
In any case, the delays and anomalous behavior are apparently due to server
crashes and reboots.  I do not know why rpc_binding_set_auth_info() might or
might not wait for the recorded hour and forty minutes before succeeding,
rather than failing earlier.  And the final failure is due to a ten-minute
timeout on the AFS_SetContext RPC call made to a server that apparently was
in the process of crashing when the call was made.

[4/26/96 public]
Cancelling.  It should have been handled by Mike Burati's code drop of
April 16 (or so).  I couldn't determine whether that drop was done under
an OT, so I didn't know if this should simply be dup'ed to that.



CR Number                     : 13403
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : clearinghouse subcommand
Short Description             : The -attribute option of the clearinghouse show command does not work
Reported Date                 : 3/22/96
Found in Baseline             : 1.1
Found Date                    : 3/22/96
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/22/96 public]

Customer reported:

"         Although the R1.1 Command Reference for the clearinghouse show
  command does not describe the -attribute option, but the help message
  for the command does as follows:
  
         dcecp> clearinghouse help show
                -all           Returns both attributes and counters.
                -attribute     Returns only attribute information.
                -counters      Returns only the clearinghouse counters.
                -schema        Returns if attributes are single or multi-valued.
         dcecp> 
  
  According to the manual, the -attribute option should display only the
  designated attribute value, however it makes an error return if an actual
  attribute value is set as follows:
  
       dcecp> clearinghouse show /.:/dcecx_ch -attribute CDS_ReplicaVersion
       Error: Unrecognized argument 'CDS_ReplicaVersion'.
       dcecp> 
  
  We request that the -attribute option display only the designated
  attribute as follows:
  
       dcecp> clearinghouse show /.:/dcecx_ch -attribute CDS_ReplicaVersion
       {CDS_ReplicaVersion 3.0}
       dcecp>
  
  We suspect that the -attribute option was created to show a specific
  attribute value as shown below (which is extracted from the Chapter 17.3 
  of "Administration Guide - Core Components"):
  
       dcecp> clearinghouse show  /.:/Chicago2_CH CDS_CHDirectories  -clear
  
  However, the above example makes an error return as follows:
  
       dcecp> clearinghouse show  /.:/Chicago2_CH CDS_CHDirectories  -clear
       Error: Unrecognized argument 'CDS_CHDirectories'.
       dcecp> 
  
  The attrlist command can get a specific value from the command output
  attribute list.  However, the "cdscp show clearinghouse" command, which
  is a counterpart of the "clearinghouse show" command, can display a
  designated attribute value, the "clearinghouse show" command also should
  support the -attribute option to do the same thing.
  
"

[3/22/96 public]
This bug should be cancelled and it seems a doc bug opened against
parts of the admin guide.  The online help is correct:

  dcecp> clearinghouse help show
         -all           Returns both attributes and counters.
         -attribute     Returns only attribute information.
         -counters      Returns only the clearinghouse counters.
         -schema        Returns if attributes are single or multi-valued.
  dcecp> 

With the -attribute option ALL attributes are returned, but not
counters or schema info.  There is no way to have the command return
just one attribute as was available in cdscp.  If you want to see just
one value, e.g., if you are writing a script use the "attrlist
getvalue" command.

Here's how do it in a script:

  set tmp [clearinghouse show /.:/Chicago2_CH]
  attrlist getvalue $tmp -type CDS_CHDirectories

How do this online?

  dcecp> clearinghouse show /.:/Chicago2_CH
  ...output here...

  # and since the output is saved in the _r variable, and using abbreviations:

  dcecp> attr get $_r -type CDS_CHDirectories
  ...value of the one attribute output...

And, no there should not be an enhancement request for dcecp to be able
to return one attribute.  Use the Tcl language to script it as above.

I could believe that the admin guide made some mistakes in translating
the examples from cdscp to dcecp.  These should be check, the CR above
doesn't give a specific reference.

[3/22/96 public]

Rats, Howard, you beat me to it.  There are many places in dcecp
where the 'new' command that replaced the old control program command
does not allow individual control over an attribute directly, where
the old control program command may have.  But dcecp supports this
functionality for all commands using 'attrlist'.

The '-attribute' option wasn't meant for individual attribute control,
but to indicate that the clearinghouse attributes should be returned.

So, as far as a code defect/enhancement goes, this bug is cancelled.

However, please identify the places in the admin guide where the
'clearinghouse show' command is used incorrectly and open another
doc/admin_guide bug for them.



CR Number                     : 13396
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : cdsclient object
Short Description             : cdsclient misnamed?
Reported Date                 : 3/19/96
Found in Baseline             : 1.2.1
Found Date                    : 3/19/96
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/19/96 public]

The dcecp cdsclient object operates on the CDS-clerk process. The
documentation distinguishes between CDS clerks and clients - CDS clients
are applications that request binding information from the CDS clerk on
the local host.

Should this dcecp object be renamed to "cdsclerk" ?

[3/19/96 public]

No.  Before the 'cds' and 'cdsclient' objects were added, we
thrashed it out with the CDS engineers here, and with other
interested dcecp parties.  The distinction dcecp is trying
to make is between a CDS server and a CDS client.  That's
all we recognize (and the updated cdsadv no longer works
with clerk processes anyway).  The only thing that is still
unfortunate is that CDS still calls the client process
'cds-clerk' in the namespace, which it should not.  That's
the real bug.



CR Number                     : 13384
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfam
Subcomponent Name             : 
Short Description             : ENDGAME:error in dfamagt/agt_login.c
Reported Date                 : 3/7/96
Found in Baseline             : 1.2.1
Found Date                    : 3/7/96
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/7/96 public]

The file src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c cannot be
compiled. The errors are:

relative path: ./file/dfam/agent
cd ../../../../obj/rios/file/dfam/agent
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /file/dfam/agent/RIOS ]
makepath RIOS/. && cd RIOS &&  exec make MAKEFILE_PASS=BASIC     build_all
[ /file/dfam/agent/RIOS/riosww ]
makepath riosww/. && cd riosww &&  exec make MAKEFILE_PASS=BASIC     build_all
[ /file/dfam/agent/RIOS/riosww/dfamagt ]
makepath dfamagt/. && cd dfamagt &&  exec make MAKEFILE_PASS=BASIC     build_all
xlc -c     -O  -D_FRAGWRITE -D_ALL_SOURCE -Drios -D_IBMR2 -DAIX_PROD -D_THREAD_SAFE -qchars=signed   -I. -I/u6/qlong/transarcdrp/src/file/dfam/agent/RIOS/riosww/dfamagt -I/project/dce/build/dce1.2/src/file/dfam/agent/RIOS/riosww/dfamagt  -I../h -I/u6/qlong/transarcdrp/src/file/dfam/agent/RIOS/riosww/h -I/project/dce/build/dce1.2/src/file/dfam/agent/RIOS/riosww/h -I/u6/qlong/transarcdrp/export/rios/usr/include -I/project/dce/build/dce1.2/export/rios/usr/include -I/project/dce/build/dce1.2/external/rios/usr/include  ../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1908.1: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1967.1: 1506-045 (S) Undeclared identifier sec_login_handle_t.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1967.21: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1968.8: 1506-007 (S) Struct or union d_login_info is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1969.8: 1506-007 (S) Struct or union d_crypt_info is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1970.8: 1506-007 (S) Struct or union agt_timer is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.15: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.45: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.55: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.65: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.69: 1506-131 (S) Explicit extent specification or initializer required for an auto or static array.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.79: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1988.86: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 1991.8: 1506-007 (S) Struct or union d_crypt_tbl is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2028.9: 1506-007 (S) Struct or union hostent is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2034.19: 1506-045 (S) Undeclared identifier sck.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2045.25: 1506-045 (S) Undeclared identifier sck.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2046.9: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2051.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2051.47: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2052.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2053.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2053.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2053.137: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2056.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2056.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2056.139: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2058.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2063.20: 1506-045 (S) Undeclared identifier hst.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2063.49: 1506-043 (S) Sizeof operator cannot be used with functions, void, bit-fields, incomplete types, or arrays of unknown size.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2103.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2104.18: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2104.45: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2105.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2105.34: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2105.126: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2107.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2107.34: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2107.128: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2108.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2149.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2150.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2150.43: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2151.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2151.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2151.124: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2153.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2153.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2153.126: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2154.14: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2163: 1506-006 (S) Label err_rtn is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2194.11: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2195.2: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2195.9: 1506-045 (S) Undeclared identifier timeval.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2195.19: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2196.2: 1506-046 (S) Syntax error.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2196.9: 1506-045 (S) Undeclared identifier interval.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2236.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2237.18: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2237.45: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2238.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2238.34: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2238.126: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2240.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2240.34: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2240.128: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2241.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2246.22: 1506-045 (S) Undeclared identifier ts.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2252.6: 1506-045 (S) Undeclared identifier oft.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2264.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2264.35: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2266.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2277.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2277.48: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2278.17: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2279.25: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2279.42: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2279.138: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2282.25: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2282.42: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2282.140: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2284.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2300.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2301.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2301.43: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2302.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2302.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2302.124: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2304.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2304.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2304.126: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2305.14: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2349.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2350.17: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2350.44: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2351.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2351.33: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2351.125: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2353.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2353.33: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2353.127: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2354.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2368.31: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2373.17: 1506-045 (S) Undeclared identifier sck.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2374.7: 1506-045 (S) Undeclared identifier sck.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2374.21: 1506-045 (S) Undeclared identifier sck.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2375.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2375.47: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2376.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2377.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2377.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2377.137: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2380.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2380.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2380.139: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2382.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2390.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2391.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2391.43: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2392.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2392.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2392.124: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2394.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2394.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2394.126: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2395.14: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2434.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2435.17: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2435.44: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2436.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2436.33: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2436.125: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2438.17: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2438.33: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2438.127: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2439.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2451.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2452.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2452.43: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2453.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2453.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2453.124: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2455.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2455.32: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2455.126: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2456.14: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2483.9: 1506-007 (S) Struct or union timeval is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2488.19: 1506-045 (S) Undeclared identifier ts.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2489.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2489.46: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2490.15: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2491.23: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2491.40: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2491.136: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2494.23: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2494.40: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2494.138: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2496.15: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2543.9: 1506-007 (S) Struct or union flock is undefined.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2546.64: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2548.13: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2553.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2554.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2554.33: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2554.160: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2554.176: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2555.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2556.18: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2563.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2563.47: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2564.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2565.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2565.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2565.137: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2567.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2567.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2567.139: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2568.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2575.2: 1506-045 (S) Undeclared identifier flk.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2576.2: 1506-045 (S) Undeclared identifier flk.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2577.2: 1506-045 (S) Undeclared identifier flk.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2578.2: 1506-045 (S) Undeclared identifier flk.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2581.26: 1506-045 (S) Undeclared identifier flk.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2582.13: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2584.4: 1506-057 (S) Continue cannot be placed outside a while, do, or for statement.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2586.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2586.47: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2587.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2587.33: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2587.161: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2587.177: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2588.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2589.18: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2592.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2592.47: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2593.16: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2594.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2594.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2594.137: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2596.24: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2596.41: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2596.139: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2597.16: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2609.14: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2613.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2613.49: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2614.18: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2615.26: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2615.43: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2615.139: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2617.26: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2617.43: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2617.141: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2618.18: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2638.16: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2642.19: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2642.50: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2643.19: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2644.27: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2644.44: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2644.140: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2646.27: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2646.44: 1506-045 (S) Undeclared identifier agt.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2646.142: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2647.19: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2660.16: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2664.19: 1506-045 (S) Undeclared identifier msg.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c", line 2664.50: 1506-018 (S) Operand of indirection operator must be a pointer expression.
"../../../../../../../../src/file/dfam/agent/RIOS/riosww/dfamagt/agt_login.c"[qlong 3/11/96 public]

The problem is due to a bug in my build environment. Cancel the
hotline.



CR Number                     : 13372
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : 
Short Description             : ENDGAME: LIBDCEDFS_LIBRARY_MAKEFILE not set
Reported Date                 : 2/25/96
Found in Baseline             : 1.2.1
Found Date                    : 2/25/96
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.1
Fixed In Baseline             : 
Affected File(s)              : src/file/fsint/Makefile
Sensitivity                   : public

[2/25/96 public]
LIBDCEDFS_LIBRARY_MAKEFILE not set

[2/26/96 public]
The build needed an export of afs4int_s2c.h

[3/6/96 public]
This change was backed out in ot 13380. See this ot for details.



CR Number                     : 13369
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9245
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : security/server/client/rca
Short Description             : Credential name cache file
created with user's default permissions
Reported Date                 : 2/24/96
Found in Baseline             : 1.1
Found Date                    : 2/24/96
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/24/96 public]

A support customer reported the following problem:
-------------------------------------------------

< This problem is fixed in 1.2.1 - OT 9245 >

Component (Module):     security/server/client/rca/secidmap.c

One Line Description:

Credential name cache file created with user's default permissions.

Full Description:

The name cache files /opt/dcelocal/var/security/creds/*.nc are created
in the add_namecache() function and the code looks like:

    outfile = fopen (filename, "a");

No attempt is made to change the file permission bits after the file is
created so the file is given the user's default file permissions.  For
example, if root has default permissions of 666, the following name
cache file is created during initial cell configuration.

-rw-rw-rw-   1 root     bin          413 Jan  9 10:54 dcecred_ffffffff.nc

Also note that name cache files may be created in function
sec_login_pvt_set_context() in file security/client/login/sec_login_pvt.c.
In that case care is take to set the file permissions.

     ncfd=open(lcp->namecache_name, O_CREAT | O_TRUNC , 0600);

Repeat By:

Configure a node with root's umask of 0666.

[2/26/96 public]
There's no reason for this...  You state yourself, above that it's already
fixed in the release that these OTs are now being accounted for, and that
there's already an OT for it.  If you want to add 1.1 info, either add it
to the OT that already exists, or open one against dcemaint.

[2/27/96 public]
Agreed ... so I'm cancelling this.



CR Number                     : 13313
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 13292
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : 
Short Description             : dce1.2 code does not build on rios
Reported Date                 : 2/8/96
Found in Baseline             : 1.2.1
Found Date                    : 2/8/96
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/8/96 public]

[shoul dhave opened this one earlier.]

DCE 1.2.1 code, as it is now with HP's early Dec 95 drop, does not build
on a rios machine. I should point it out that since we don't have CSet
C++ compiler, I was using gcc. Although I know the potential problem
with using gcc as a C++ compiler, I expect the code to build.

The build stops as follows (I have the complete build log):

for y in krb5_cksumarray krb5_cc_default krb5_unparse_name  krb5_get_default_realm krb5_build_principal  krb5_read_password krb5_decode_generic  krb5_rd_req_decoded krb5_free_ap_req krb5_mk_safe  krb5_rd_priv krb5_free_address krb5_free_cred_contents  krb5_free_tkt_authent krb5_init_ets krb5_parse_name  AP_REQ_dec AP_REQ2krb5_ap_req AP_REQ_free error_message;  do  echo $y >> libdce.syms;  done;
for y in afs_syscall;  do  echo $y >> libdce.syms;  done;
ld -o shr.o *.o -bloadmap:shr.o.map -bM:sre -bE:libdce.syms -bI:/lib/syscalls.exp -bI:/project/dce/build/dce1.2/src/libdce/RIOS/syms.imp -L/u1/wwang/sandbox/12/export/rios/usr/lib     -L/project/dce/build/dce1.2/export/rios/usr/lib -T512 -H512 -lbsd -lc -lm -lcurses -lkrb5 -liconv  2> shr.o.error
dtstime
*** Error code 8
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.

I have not had time to investigate further.

[2/8/96 public]

The above build already had the temp fix for OT 13292.

[2/8/96 public]

The build described above was performed on alphaville which
was running AIX ">3250", which is not exactly up to snuff with
respect to DCE 1.2.1's AIX OS platform requirements. Also, the
machine lacks the IBM CSet++ compiler. Either of the above 
are likely to cause build problems (although maybe not the one
that was encountered).

[2/9/96 public]

canceled until machine config issues are resolved. If build problems
persist, this OT should be reopened.



CR Number                     : 13310
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10632
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : acl
Short Description             : dce_rdacl_replace() should check for illegal entries
Reported Date                 : 2/7/96
Found in Baseline             : 1.1
Found Date                    : 2/7/96
Severity                      : B
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : dce/utils/acldb/aclimpl.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[2/7/96 public]
This parallels OT#10632. There are two independent paths to ACL storage.
One is through the dce_acl_obj_add_XXX() routines, the other is through
dce_rdacl_replace(). They should both check for illegal entries before writing
the ACL out. It might be better to reimplement dce_rdacl_replace() using the
dce_acl_obj_add_XXX() routines and do the check in one place.

[7/25/96 public]
With Nick's concent, I'm cancelling this OT.



CR Number                     : 13298
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce.rm
Short Description             : dce.rm does not clean up svc area
Reported Date                 : 2/5/96
Found in Baseline             : 1.1, 1.2
Found Date                    : 2/5/96
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : config/dce.rm
Sensitivity                   : public

[2/5/96 public]

Answering "y" to the question wehther you want to remvoe the old dce
configuration data does not remove the old *.log files under the 
svc area: /opt/dcelocal/var/svc/*.log.

Here is a suggested fix:

*** /project/dce/build/dce1.1-maint/src/config/dce.rm	Wed Aug 17 09:32:24 1994
--- dce.rm	Mon Feb  5 15:59:52 1996
***************
*** 366,371 ****
--- 366,377 ----
  
  	fi
  
+ 	# SVC
+ 	log_msg DETAIL "dce.rm: Executing: rm -f $DCELOCAL/var/svc/*.log"
+ 	rm -f $DCELOCAL/var/svc/error.log
+ 	rm -f $DCELOCAL/var/svc/fatal.log
+ 	rm -f $DCELOCAL/var/svc/warning.log
+ 
  	# AUD
  	log_msg DETAIL "dce.rm: Executing: rm -f $DCELOCAL/var/audit/adm/acl"
  	rm -f $DCELOCAL/var/audit/adm/acl

[2/6/96 public]
This is not a defect. dce.rm should remove things necessary for configuring
a cell and not svc logs.

The /opt/dcelocal/var/svc/*.log should be kept around for someone to look at
and manually remove if desired.



CR Number                     : 13279
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : acldb/acl evaluation
Short Description             : ACLDB acl evaluation group checks semi-broken
Reported Date                 : 1/10/96
Found in Baseline             : 1.1
Found Date                    : 1/10/96
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : dce/utils/acldb/acleval.c
Sensitivity                   : public

[1/10/96 public]

While inspecting the ACLDB code a little more thoroughly after being
told about a foreign_group ACL problem (another OT), I discovered that
the regular group access checks look partly broken too.

This code was generated using the security server (and example)'s ACL
access checks as a starting point/guideline, but was changed so
drastically (for unknown reasons) that it can no longer be put to a
side by side comparison anymore.  But, on first glance, it appears that
during the conversion, they inadvertently lost the functionality that
provides the *union* of group access, if more than one group matched
the identity.  In fact, the comment in dce_acl__permset_alg() implies
that this functionality is there, but the group_access assignments
in the above loop lose any previous access value each time through the
loop (compare it to the loop in security/server/rsdb/rsdb_daclmgr.c ).

I don't have a good way of verifying it at the moment (obviously the
test doesn't check for group union access or somebody would have found this
by now), but I still believe that it's broken and should be fixed asap
(this the A1 sev/pri).

[2/12/96 public]
Ugh, I was seeing things...
It actually is accumulating group access throughout multiple iterations
of the group loop (just differently than the code that it was based on).
JohnR just tested that it isn't broken, and we both re-reviewed the code
to make sure I was seeing things above, so I'm cancelling this defect.



CR Number                     : 13222
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : libaudit
Short Description             : Event Description enhancement
Reported Date                 : 12/7/95
Found in Baseline             : 1.1
Found Date                    : 12/7/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/7/95 public]
This OT is opened to support the event description that will comply
with NLS (refer to 12554).  We will support the enhancement once
DCE1.2.1 came out.

[7/18/96 public]
Not needed.



CR Number                     : 13172
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : cs_remote.c
Short Description             : The VTS remote process hangs occasionally
Reported Date                 : 10/28/95
Found in Baseline             : 1.0.2
Found Date                    : 10/28/95
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/28/95 public]

Component (Module):     cs_remote.c 

One Line Description:
  	The VTS remote process hangs occasionally.


Related-file:::: Problem
 DESCRIPTION:
 
 The remote process isn't behaving properly sometimes when the connection 
 with local process is no longer alive.  The process gets hung.  The remote 
 process needs to continue to accept new connections and remove the old 
 file descriptor from the select() i/o descriptor set.  The remote also
 isn't cleaning up after the remote child process goes away.
 
 REPRODUCIBLE:
 
 Yes.
 
 
 TEST SOFTWARE DESCRIPTION:
 
 VTS 
 
 DESCRIPTION OF HARDWARE WHERE BUG OCCURRED:
 
 VM
 
 DESCRIPTION OF WHERE TEST SUCCESSFULLY RAN:
 
Related-file::Added 950919 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/cs/./cs_remote.c,v 8.4
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/cs/./cs_remote.c,v 8.4
 warnick 1995/09/19 18:33:03 +10 -18
 Reason:  OSDqa12426 The VTS remote process hangs occasionally.
 Fix for OSDqa12426.
 
     *** /tmp/ci.27828..cs_remote.c.27869.1	Tue Sep 19 14:33:06 1995
     --- /tmp/cs_remote.c.27869.2	Tue Sep 19 14:33:06 1995
     ***************
     *** 247,256 ****
     --- 247,257 ----
       
       	    if (num < 0)
       	    {
       		ERROR_MSG("select returned < 0");
       		perror("CSR: ");
     + 		connection_alive = 0;
       		continue;
       	    }
       	    else
       	    {
       #ifdef DEBUG
     ***************
     *** 281,305 ****
       #ifdef DEBUG
       		    printf("local packet fd is set\n");
       #endif
       		    if ((process_local_packet(g_in_conn_sock)) != SUCCESS)
       		    {
     - #ifdef hitm
       			ERROR_MSG("process_local_packet failed\n");
       		    	FD_CLR(g_in_conn_sock, &all_rfds);
       		    	FD_CLR(g_in_conn_sock, &all_wfds);
       		    	FD_CLR(g_in_conn_sock, &all_xfds);
       			close(g_in_conn_sock);
     ! #else
     ! #ifdef XDEBUG
     ! 			ERROR_MSG("process_local_packet failed\n");
     ! 		    	/* FD_CLR(g_in_conn_sock, &all_rfds);
     ! 		    	FD_CLR(g_in_conn_sock, &all_wfds);
     ! 		    	FD_CLR(g_in_conn_sock, &all_xfds);
     ! 			close(g_in_conn_sock); */
     ! #endif
     ! #endif
       		    }
       		}
       
       		/*
       		 * The process_local_packet could call routine "stop"
     --- 282,297 ----
       #ifdef DEBUG
       		    printf("local packet fd is set\n");
       #endif
       		    if ((process_local_packet(g_in_conn_sock)) != SUCCESS)
       		    {
       			ERROR_MSG("process_local_packet failed\n");
       		    	FD_CLR(g_in_conn_sock, &all_rfds);
       		    	FD_CLR(g_in_conn_sock, &all_wfds);
       		    	FD_CLR(g_in_conn_sock, &all_xfds);
       			close(g_in_conn_sock);
     ! 			connection_alive = 0;
       		    }
       		}
       
       		/*
       		 * The process_local_packet could call routine "stop"
     ***************
     *** 322,335 ****
       		    if ((process_vta_ctl(g_from_child_ctl_sock)) != SUCCESS)
       		    {
       #ifdef DEBUG
       			ERROR_MSG("process_vta_ctl can not read\n");
       #endif
     ! 		        /* FD_CLR(g_from_child_ctl_sock, &all_rfds);
       		        FD_CLR(g_from_child_ctl_sock, &all_wfds);
       		        FD_CLR(g_from_child_ctl_sock, &all_xfds);
     ! 			close(g_from_child_ctl_sock); */
       		    }
       		}
       
       		if ( g_conn_oriented && remote_server == TRUE &&
       		    FD_ISSET(g_child_data_sock, &rfds) )
     --- 314,327 ----
       		    if ((process_vta_ctl(g_from_child_ctl_sock)) != SUCCESS)
       		    {
       #ifdef DEBUG
       			ERROR_MSG("process_vta_ctl can not read\n");
       #endif
     ! 		        FD_CLR(g_from_child_ctl_sock, &all_rfds);
       		        FD_CLR(g_from_child_ctl_sock, &all_wfds);
       		        FD_CLR(g_from_child_ctl_sock, &all_xfds);
     ! 			close(g_from_child_ctl_sock);
       		    }
       		}
       
       		if ( g_conn_oriented && remote_server == TRUE &&
       		    FD_ISSET(g_child_data_sock, &rfds) )
     ***************
     *** 358,371 ****
       			 * Forward the data (packet) to the local side.
       			 */
       			if ((rc = forward_data(vta_assoc[cnt].sock, cnt)) == (-1))
       			{
       			    fprintf(stderr, "forward_data FAILED for cnt %d\n", cnt);
     ! 			    /* FD_CLR(vta_assoc[cnt].sock, &all_rfds);
       			    FD_CLR(vta_assoc[cnt].sock, &all_wfds);
       			    FD_CLR(vta_assoc[cnt].sock, &all_xfds);
     ! 			    close(vta_assoc[cnt].sock); */
       			}
       		    }
       		}
       
       		if (FD_ISSET(g_child_stdout_sock, &rfds))
     --- 350,363 ----
       			 * Forward the data (packet) to the local side.
       			 */
       			if ((rc = forward_data(vta_assoc[cnt].sock, cnt)) == (-1))
       			{
       			    fprintf(stderr, "forward_data FAILED for cnt %d\n", cnt);
     ! 			    FD_CLR(vta_assoc[cnt].sock, &all_rfds);
       			    FD_CLR(vta_assoc[cnt].sock, &all_wfds);
       			    FD_CLR(vta_assoc[cnt].sock, &all_xfds);
     ! 			    close(vta_assoc[cnt].sock);
       			}
       		    }
       		}
       
       		if (FD_ISSET(g_child_stdout_sock, &rfds))
     ***************
     *** 376,389 ****
       		    if ((forward_stdout(g_child_stdout_sock)) != SUCCESS)
                           {
       #ifdef DEBUG
                               ERROR_MSG("forward_stdout: can not read (socket may be closed)\n");
       #endif
     !                         /* FD_CLR(g_child_stdout_sock, &all_rfds);
                               FD_CLR(g_child_stdout_sock, &all_wfds);
                               FD_CLR(g_child_stdout_sock, &all_xfds);
     ! 			close(g_child_stdout_sock); */
                           }
       
       		}
       	    }
       	}
     --- 368,381 ----
       		    if ((forward_stdout(g_child_stdout_sock)) != SUCCESS)
                           {
       #ifdef DEBUG
                               ERROR_MSG("forward_stdout: can not read (socket may be closed)\n");
       #endif
     !                         FD_CLR(g_child_stdout_sock, &all_rfds);
                               FD_CLR(g_child_stdout_sock, &all_wfds);
                               FD_CLR(g_child_stdout_sock, &all_xfds);
     ! 			close(g_child_stdout_sock);
                           }
       
       		}
       	    }
       	}
 
Related-file:::: Resolution 
 DESCRIPTION OF BUG FIX:
 
 Added back in code that OSF commented out for removing the file
 descriptor from the select() i/o descriptor set and closing the
 socket.  Also set the connection to nolonger alive so we will start 
 accepting new connections from the local process.

[11/01/95 public]

Removed extraneous header info in previous notes.
Cancelling this CR, opening new CR in dce_vts project.



CR Number                     : 13171
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : vts
Short Description             : Remote process dies from SIGPIPE
Reported Date                 : 10/28/95
Found in Baseline             : 1.1
Found Date                    : 10/28/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/28/95 public]

Component (Module):     cs_remote.c, .. 

Description:
  	Remote process dies prematurely from SIGPIPE.

Full Description:

Related-file:::: Problem
 DESCRIPTION:
 
 The child process of the remote sometimes exits before the remote
 has a chance to shut it down.  The remote tries to write to
 the pipe and dies from a SIGPIPE.
 
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/cs/./cs_remote.c,v 8.5
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/cs/./cs_remote.c,v 8.5
 warnick 1995/09/20 14:57:24 +14 -2
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.28725..cs_remote.c.28765.1	Wed Sep 20 10:57:26 1995
     --- /tmp/cs_remote.c.28765.2	Wed Sep 20 10:57:26 1995
     ***************
     *** 145,154 ****
     --- 145,157 ----
           int s, af, type, protocol;
           struct sockaddr_in	addr, 
       			bind_addr;
           int addrlen;
           struct timeval timv = { 2, 0 };	/* initialize to 2.000000 seconds */
     + #ifdef hitm
     +     struct sigaction sigactn;
     + #endif
       
           if (argc == 2)
           {
       	g_portnr = atoi(argv[1]);
       	if (g_portnr == 0)
     ***************
     *** 156,165 ****
     --- 159,177 ----
       	    fprintf(stderr, 
       		"Usage: %s\n -OR- %s portnumber\n", argv[0], argv[0]);
       	    exit(-1);
       	}
           }
     + #ifdef hitm
     +     /*
     +      * Make sure broken pipes don't cause us to crash
     +      */
     +     sigactn.sa_handler = SIG_IGN;
     +     sigemptyset(&sigactn.sa_mask);
     +     sigactn.sa_flags   = 0;
     +     sigaction(SIGPIPE, &sigactn, NULL);
     + #endif
       
           memset((void *) vta_addrs, 0, sizeof(vta_addrs));
           memset((void *) vta_assoc, 0, sizeof(vta_assoc));
           top_assoc = 0;
       
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-cl/csar/./rtc2.c,v 8.3
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-cl/csar/./rtc2.c,v 8.3
 warnick 1995/09/20 14:59:20 +4 -4
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.28801..rtc2.c.28843.1	Wed Sep 20 10:59:22 1995
     --- /tmp/rtc2.c.28843.2	Wed Sep 20 10:59:22 1995
     ***************
     *** 509,521 ****
       
       #ifdef DEBUG
           er_msg( "CL RPC SAR client completing.\n" );
       #endif
       
     ! #ifdef SNI_SVR4
           /* wait for CSR to terminate this process */
     !     sleep (120);
       #endif
       
           return ( 0 );
       }
       
     --- 509,521 ----
       
       #ifdef DEBUG
           er_msg( "CL RPC SAR client completing.\n" );
       #endif
       
     ! #if defined(SNI_SVR4) || defined(hitm)
           /* wait for CSR to terminate this process */
     !     sleep (180);
       #endif
       
           return ( 0 );
       }
       
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-cl/server/./rtc1.c,v 8.2
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-cl/server/./rtc1.c,v 8.2
 warnick 1995/09/20 15:01:52 +4 -4
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.28894..rtc1.c.28934.1	Wed Sep 20 11:01:54 1995
     --- /tmp/rtc1.c.28934.2	Wed Sep 20 11:01:54 1995
     ***************
     *** 405,417 ****
       
       #ifdef DEBUG
         er_msg( "CL RPC server completing.\n" );
       #endif
       
     ! #ifdef SNI_SVR4
           /* wait for CSR to terminate this process */
     !     sleep (120);
       #endif
       
         /* Free up all resources */
         
         return 0;
     --- 405,417 ----
       
       #ifdef DEBUG
         er_msg( "CL RPC server completing.\n" );
       #endif
       
     ! #if defined(SNI_SVR4) || defined(hitm)
           /* wait for CSR to terminate this process */
     !     sleep (180);
       #endif
       
         /* Free up all resources */
         
         return 0;
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-co/client/./rtc4.c,v 8.3
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-co/client/./rtc4.c,v 8.3
 warnick 1995/09/20 15:04:00 +4 -4
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.28967..rtc4.c.29007.1	Wed Sep 20 11:04:02 1995
     --- /tmp/rtc4.c.29007.2	Wed Sep 20 11:04:02 1995
     ***************
     *** 308,320 ****
       
       #ifdef DEBUG
           er_msg( "CO RPC client completing.\n" );
       #endif
       
     ! #ifdef SNI_SVR4
           /* wait for CSR to terminate this process */
     !     sleep (120);
       #endif
       
           return ( 0 );
       }
       
     --- 308,320 ----
       
       #ifdef DEBUG
           er_msg( "CO RPC client completing.\n" );
       #endif
       
     ! #if defined(SNI_SVR4) || defined(hitm)
           /* wait for CSR to terminate this process */
     !     sleep (180);
       #endif
       
           return ( 0 );
       }
       
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-co/server/./rtc3.c,v 8.2
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-co/server/./rtc3.c,v 8.2
 warnick 1995/09/20 15:06:11 +4 -4
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.29057..rtc3.c.29098.1	Wed Sep 20 11:06:12 1995
     --- /tmp/rtc3.c.29098.2	Wed Sep 20 11:06:12 1995
     ***************
     *** 413,425 ****
       
       #ifdef DEBUG
         er_msg( "CO RPC server completing.\n" );
       #endif
       
     ! #ifdef SNI_SVR4
           /* wait for CSR to terminate this process */
     !     sleep (120);
       #endif
       
         /* Free up all resources */
         
         return 0;
     --- 413,425 ----
       
       #ifdef DEBUG
         er_msg( "CO RPC server completing.\n" );
       #endif
       
     ! #if defined(SNI_SVR4) || defined(hitm)
           /* wait for CSR to terminate this process */
     !     sleep (180);
       #endif
       
         /* Free up all resources */
         
         return 0;
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-ts/ndr_client/./ndr_r.c,v 8.2
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-ts/ndr_client/./ndr_r.c,v 8.2
 warnick 1995/09/20 15:11:09 +4 -4
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.29154..ndr_r.c.29195.1	Wed Sep 20 11:11:11 1995
     --- /tmp/ndr_r.c.29195.2	Wed Sep 20 11:11:11 1995
     ***************
     *** 283,295 ****
       
       #ifdef DEBUG
           er_msg( "CL RPC client completing.\n" );
       #endif
       
     ! #ifdef SNI_SVR4
           /* wait for CSR to terminate this process */
     !     sleep (120);
       #endif
       
           return ( SUCCESS );
       }
       
     --- 283,295 ----
       
       #ifdef DEBUG
           er_msg( "CL RPC client completing.\n" );
       #endif
       
     ! #if defined(SNI_SVR4) || defined(hitm)
           /* wait for CSR to terminate this process */
     !     sleep (180);
       #endif
       
           return ( SUCCESS );
       }
       
 
Related-file::Added 950920 by warnick:: /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-ts/ndr_server/./rndr_server.c,v 8.2
 /build/hiosfm/RCS/dce1.1/src/test/dvs/rpc/protocol/remote/vta-ts/ndr_server/./rndr_server.c,v 8.2
 warnick 1995/09/20 15:15:27 +4 -4
 Reason:  OSDqa12428 Remote process dies prematurely from SIGPIPE.
 Fix for OSDqa12428.
 
     *** /tmp/ci.29298..rndr_server.c.29338.1	Wed Sep 20 11:15:28 1995
     --- /tmp/rndr_server.c.29338.2	Wed Sep 20 11:15:28 1995
     ***************
     *** 622,634 ****
       
       #ifdef DEBUG
           er_msg( "TS/NDR server completing.\n" );
       #endif
       
     ! #ifdef SNI_SVR4
           /* wait for CSR to terminate this process */
     !     sleep (120);
       #endif
       
           /* 
            * Free up all resources
            */
     --- 622,634 ----
       
       #ifdef DEBUG
           er_msg( "TS/NDR server completing.\n" );
       #endif
       
     ! #if defined(SNI_SVR4) || defined(hitm)
           /* wait for CSR to terminate this process */
     !     sleep (180);
       #endif
       
           /* 
            * Free up all resources
            */
 
Related-file:::: Resolution 
 DESCRIPTION OF BUG FIX:
 
 SNI added a sleep() to the remote child processes to try to compensate
 for the child process exiting to early.  This solution is timing dependent.  
 So besides adding the sleep() for synchronization also ignore the SIGPIPE 
 signal in the remote so the broken pipe doesn't cause the remote process
 to crash.
  
  
 REGRESSION TEST SCENARIO:
 
 Run the protocol portion of the VTS.
  
  
 RCSDIFFS (either inserted manually or via Fci):

[11/01/95]

Removed extraneous header info from previous notes.
Cancelling this CR, opening new CR under dce_vts project.



CR Number                     : 13149
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : fshs
Short Description             : fshs_InqContext() has old redundant cruft hanging around
Reported Date                 : 10/10/95
Found in Baseline             : 1.1
Found Date                    : 10/10/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : file/fshost/fshs_prutils.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/25/96 public]
Not reproducible by R1.2.2.  No part of dfs testing has encountered this
problem.

[10/10/95 public]
 
Bill just noticed that fshs_InqContext() calls both rpc_binding_inq_auth_client
and rpc_binding_inq_auth_caller() (the latter obsoletes the former in 1.1).
 
I took a look at the source and sure enough, it looks like the old code was
copied and pasted into the same routine and the function name changed, but
the old code never removed when the new code was finished.  The result is
that it does the same thing twice for no good reason.

[10/16/95 public]
Carl Burnett noticed the same thing.  I named the resulting Transarc delta in
his honor: cburnett-db7000-clean-up-delegation .



CR Number                     : 13145
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfs_server.ext
Short Description             : Improper parameter passing in
px_invokeserver()
Reported Date                 : 10/5/95
Found in Baseline             : 1.1
Found Date                    : 10/5/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : px_init.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]
HP platform specific.  Hasn't been seen in R1.2.

[10/5/95 public]
It appears that fxd makes
an afs_syscall() as (in file/pxd/pxd.c),

       error=afs_syscall(AFSCALL_PX, PXOP_RPCDAEMON, Flags, mainprocs,
                   tokenprocs, (int)&ioBuf);

and ioBuf is a stack variable.  Its address is passed in as above
through (in file/sys/HPUX/lclcalls_hpux.c)

        errcode = syscall(hpux_dfs_syscall, asyscall,
                          parm1, parm2, parm3, parm4, parm5);

and (in file/kutils/HPUX/syscall_hpux.c)

    osi_setuerror((*fun)(uap->parm1, uap->parm2,
                         uap->parm3, uap->parm4,
                         uap->parm5, retval));

It ends up (in file/px/px_init.c)

int afscall_exporter(parm, parm2, parm3, parm4, parm5, retvalP)
    long parm, parm2, parm3, parm4, parm5;
    int * retvalP;

calling (in file/px/px_init.c)

static px_invokeserver(maxCalls, tknCalls, parm5)
    long maxCalls, tknCalls, parm5;

in which parm5 is handled by

        struct afs_ioctl *ioctlPtr = (struct afs_ioctl *) parm5;

This is no good, since parm5 is on the user stack, and cannot be
dereferenced.  Indeed, the panic occurs later when

            if ( bufSize > ioctlPtr->out_size )  {

Osi_copyin() should be used to copy parm5 to ioctlPtr.

Following is a diff of our change:
********************************
<<< file 1: /vob/dce.src.file/src/file/px/px_init.c@@/main/HPDCE02/3
>>> file 2: px_init.c
********************************
-----[after 10 inserted 11-13]-----
>  * Revision /main/HPDCE02/4  1995/10/04  20:55 UTC  mort
>  * 	CHFts16484: Fxd causes panic.
>  * 
-----[83 changed to 86]-----
< RCSID("$Header: /vob/dce.src.file/src/file/px/px_init.c,v /main/HPDCE02/3
1995/08/12 22:46 UTC kissel Exp $")
---
> RCSID("$Header: /vob/dce.src.file/src/file/px/px_init.c,v /main/HPDCE02/4
1995/10/04 20:55 UTC mort Exp $")
-----[after 90 inserted 94]-----
> struct afs_ioctl ioctl;
-----[deleted 109 after 112]-----
< 	struct afs_ioctl *ioctlPtr = (struct afs_ioctl *) parm5;
-----[215 changed to 218-225]-----
< 	if (ioctlPtr)  { 
---
> 	if (parm5)  { 
> 	    /* Copyin parm5 */
> 	    if (code = osi_copyin((char *) parm5, (char *) &ioctl,
> 				  sizeof(struct afs_ioctl))) {
> 		uprintf("fx: can't copyin ioctl (code %d)\n", code);
> 		goto cleanup_server;
> 	    }
> 
-----[221 changed to 231]-----
< 	    if ( bufSize > ioctlPtr->out_size )  {
---
> 	    if ( bufSize > ioctl.out_size )  {
-----[226-227 changed to 236-237]-----
< 	    ioctlPtr->out_size = bufSize;
< 	    if (code = osi_copyout(lp->rpcStringBuf, ioctlPtr->out,
bufSize)) {
---
> 	    ioctl.out_size = bufSize;
> 	    if (code = osi_copyout(lp->rpcStringBuf, ioctl.out, bufSize)) {
-----[231 changed to 241]-----
< 	    if (code = osi_copyin(ioctlPtr->in, (char *) lp->principalName,
---
> 	    if (code = osi_copyin(ioctl.in, (char *) lp->principalName,



CR Number                     : 13025
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : rs
Short Description             : Mem leak in rs_main.c
Reported Date                 : 8/7/95
Found in Baseline             : 1.1wp
Found Date                    : 6/15/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
security/server/rs/rs_main.c
Sensitivity                   : public

[8/7/95 public]

The dce_svc_register function returns a pointer to a malloced 
dce_svc_handle_t which must later be freed.  The component_name
member of this pointed to structure must also be freed as it is
malloced via the strdup function.

src/security/server/rs/rs_main.c	Revision /main/DCE1_1_WP/1
***************
*** 325,330 ****
--- 325,332 ----
  {
      error_status_t   st ;

+     dce_svc_handle_t svc_handle;
+
      setlocale(LC_ALL, "");

      dce_svc_set_progname("secd", &st);
***************
*** 336,343 ****
       *  In all SVC calls, the handle sec_svc_handle ( defined
       *  statically elsewhere in the code) is used.
       */
!     (void ) dce_svc_register(sec_svc_table, (idl_char *) "sec" ,
!                              &st);

      TRY
      {
--- 338,350 ----
       *  In all SVC calls, the handle sec_svc_handle ( defined
       *  statically elsewhere in the code) is used.
       */
!     if((svc_handle=dce_svc_register(sec_svc_table, (idl_char *) "sec" , &st))
!         != NULL) {      /* free contents of handle and then handle */
!             if(svc_handle->component_name != NULL)
!                 free(svc_handle->component_name);
!             free(svc_handle);
!             svc_handle=NULL;
!     }

      TRY
      {
***************
*** 362,367 ****
--- 369,376 ----
      ENDTRY
  }

+ extern dce_svc_handle_t aud_svc_handle;
+
  /*
   * The *real* main program..
   */
***************
*** 710,715 ****
--- 719,731 ----
      }

      ENDTRY;
+
+     if(aud_svc_handle != NULL) {
+         if (aud_svc_handle->component_name != NULL)
+             free(aud_svc_handle->component_name);
+         free(aud_svc_handle);
+         aud_svc_handle = NULL;
+     }

      exit(0);
  }

[9/12/95 public]

Tom from Gradient reports that following is not working out on his SVR4 
platform:

	"OT 13025 is another bad fix.

	First of all, you don't need to free stuff right before you exit.
	Second of all, the serviceability code registers a shutdown
	routine with atexit() and this routine core dumps (on my platform)
	if you free the serviceability handle and its contents."

[12/8/95 public]
I agree with Tom, there's no use freeing something immediately before exit,
and if there's a shutdown routine that free's the handle anyway, freeing
twice is bad.  I'm cancelling this defect.



CR Number                     : 13004
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsalias create vs uppercase chars
Reported Date                 : 8/2/95
Found in Baseline             : 1.1, 1.2
Found Date                    : 8/2/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/2/95 public]

dcecp -c cdsalias create /.:/aaBB results in the creation of
Alias /.../cellname /aaBB, which can be viewed with dcecp -c cdsalias catalog. 
dcecp -c cdsalias create /.../aaCC results in the creation of
Alias /.../cellname/aacc, which can be viewed with dcecp -c cdsalias catalog.
Summary: Uppercase characters are converted to lowercase characters if /... is
used when creating the alias.  This can create a problem if the user's program
expects to see the uppercase characters using catalog or if it tries to delete
/.../aaCC.  It can only be deleted using /.:/aaCC. /.../cellname/aaBB, which can be viewed with dcecp -c cdsalias catalog.  `

[8/2/95 public]
My suspicion is that dcecp is not really doing this.  It is calling
rpc_ns_expand_name()  (or whatever the real name of that routine is)
which expands the DCE name into it's canonical form.  That is, /.: is
expanded to the cell name, etc.  One of those rules is to look at the
name, if it begins with /... it is a full DCE name, what follows is a
slash and then the name of a cell.  If the next portion of the name
(RDN in X.500 parlance) contains an = then it's an X.500 cellname,
otherwise it's a DNS cellname.  Why is this important?  DNS names are
case INsensitive.  So /.../aaCC is a name of a DCE cell registered in
DNS and is equivalent to /.../aacc.

I recommend cancelling this defect and renaming the cell with a valid
DNS name (that is, one that could actually be registered).

[8/2/95 public]
Here is some more information from AES/DS Rev B Page A-10, table A-4:

Characteristics          CDS               GDS                DNS
------------------------------------------------------------------------------
Char set           a-z, A-Z, 0-9...       a-z, A-Z, 0-9...    a-z, A-Z, 0-9,...
------------------------------------------------------------------------------
.....
------------------------------------------------------------------------------
Case-matching       Case exact            Attr name case      Case insensitive
rule                                      insensitive, value
                                          either...
------------------------------------------------------------------------------
Internal            Case exact            Depends on case     Alphabets conv
Representation                            matching rule at    to all lower case
                                          DSA..
------------------------------------------------------------------------------
......

This does not however imply that rpc_ns_expand_name should convert cell name
(which could very well be CDS only), to all lower case. This defect probably
stay open. Comments?

[2/26/96 public]

As Howard stated (months ago), dcecp uses rpc_ns_expand_name() when
playing with cell names and aliases.  It is a *feature*, correct or
otherwise, that rpc_ns_expand_name() will force the 'global name' part
of the DCE pathname to lowercase, something to do with DNS-style names
being case-insensitive.

Currently, dcecp operates on a consistent basis...  If you create
/.../newNAME, you get /.../newname.  If you delete /.../newNAME,
you delete /.../newname.  Changing dcecp's behavior (to ignore,
or somehow force changes to the output of rpc_ns_expand_name())
is incorrect, as it could break existing sites which utilize the
uppercase-to-lowercase functionality as it exists.

I'm going to forward this OT to CDS for a discussion on whether
rpc_ns_expand_name() works correctly.  The CDS people can then
make a decision on closing this bug.

[08/20/96 public]

I'm cancelling this OT; Howard is correct.  A cell name cannot be
CDS-only.  In the chart that Parul mentions, "CDS" refers to the
local or cell-relative part of a global compound name.  In fact,
the Directory Services AES (section 1.3.3 Global Namespace Name
Syntax) states that:

"Names that are not indentified as being either X.500 or DNS are
not specified (BNF element <GlobalCompositeName>).  Implementations
may reject these as unsupported."

So a compliant DCE implementation could reject a cell name of
/.../foo_cell since "foo_cell" is neither an X.500 nor a DNS name.
Isn't it nice that we don't? ;^)



CR Number                     : 12999
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : episode
Short Description             : Panic in reservation doing truncation
Reported Date                 : 8/2/95
Found in Baseline             : 1.0.3
Found Date                    : 8/2/95
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/2/95 public]
We encountered a panic running the fx stress tests on a pair of
machines, asserting that there should never be a reservation after
vnvm_truncate has executed.  Apparently, though, Solaris can allow a
pvn_vpzero() call that will start asynchronous activity, which can
change the reservation.
More....
Delta: dimitris-db4870-fix-reservation-in-vnm_Truncate
The idea here is to (a) remove the assertion that there is no
reservation and simply re-try the truncation to assure that it
happened, as well as to call vnvm_purgereserved after calling
vnvm_truncate.
More....
Regression test information:
- backed by build: 09.030
- tests passed: all kinds of functional tests and system tests;
                in particular, the fx stress tests now pass.
- test configuration
        Solaris 2.3, both UFS and LFS, many of each

[8/3/95 public]
Delta: dimitris-db4870-fix-reservation-in-vnm_Truncate
Change: file/episode/vnops/efs_misc.c from 4.410 to 4.422
*** file/episode/vnops/efs_misc.c
--- 4.422	1994/01/19 21:46:15
***************
*** 76,82 ****
  
  #define DEBUG_THIS_FILE EFS_DEBUG_MISC
  
! RCSID ("$Header: /project/ot/dce/d01/d29/RCS/c012999,v 1.3 95/12/21 11:03:33 root Exp $")
  
  /* Flags to pass to epia_Truncate */
  #if	defined(AFS_SUNOS5_ENV) || defined(AFS_AIX31_VM)
--- 76,82 ----
  
  #define DEBUG_THIS_FILE EFS_DEBUG_MISC
  
! RCSID ("$Header: /project/ot/dce/d01/d29/RCS/c012999,v 1.3 95/12/21 11:03:33 root Exp $")
  
  /* Flags to pass to epia_Truncate */
  #if	defined(AFS_SUNOS5_ENV) || defined(AFS_AIX31_VM)
***************
*** 424,444 ****
      }
  
      /* Flush VM */
      code = vnvm_truncate (EVTOV (evp), len, credp);
      MBZ(code);
! 
      /*
       * vnvm_truncate may have dropped the vnode lock and re-obtained it.
       * So we must re-check that there is still no reservation.
       */
       if ((evp->vd_flags & VD_RWAITERS) || EV_HAS_RESERVED (evp)) {
- #ifdef AFS_SUNOS5_ENV
- 	/* we should never get here because in Solaris vnvm_truncate doesn't
- 	 * drop the vnode lock */
- 	osi_assert(0);
- #endif
  	goto loop;
      }
  #endif	/* AFS_AIX31_ENV, AFS_SUNOS5_ENV */
  
      /* Really truncate (calling the anode layer) */
--- 424,453 ----
      }
  
      /* Flush VM */
+ 
      code = vnvm_truncate (EVTOV (evp), len, credp);
      MBZ(code);
! #ifdef AFS_SUNOS5_ENV
!     /* 
!      * Although vnvm_trucate will not drop the lock in Solaris it
!      * might cause a pvn_vpzero() which does the putpage in async
!      * mode so we can't assert that the reservation is still 0
!      * So we call vnvm_purgereserved() which on Solaris will ensure
!      * that the reservation is 0 by the time it comes back
!      */
!     vnvm_purgereserved (EVTOV (evp),
! 			evp->vd_reservation.firstReserved,
! 			evp->vd_reservation.lastReserved,
! 			credp);
! #else /*AFS_SUNOS5_ENV*/
      /*
       * vnvm_truncate may have dropped the vnode lock and re-obtained it.
       * So we must re-check that there is still no reservation.
       */
       if ((evp->vd_flags & VD_RWAITERS) || EV_HAS_RESERVED (evp)) {
  	goto loop;
      }
+ #endif /*AFS_SUNOS5_ENV*/
  #endif	/* AFS_AIX31_ENV, AFS_SUNOS5_ENV */
  
      /* Really truncate (calling the anode layer) */

[12/21/95 public]
This is a Solaris-only bug.  The fix is contained in this report, but
it doesn't make sense to include it separately in the code base at the
OSF (until the big submission).



CR Number                     : 12993
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfsbind
Short Description             : undo fopen()/fclose() libc.so.1 work around
Reported Date                 : 8/2/95
Found in Baseline             : 1.0.3
Found Date                    : 8/2/95
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/2/95 public]
From Transarc:
SYNOPSIS: undo fopen()/fclose() libc.so.1 work around
  The delta srinivas-4647-dfsbind_core_dump removes fcalls.o from list of
object files used to build dfsbind. fcalls.o had fopen()/fclose() wrapper for
libc.so.1

[8/3/95 public]
Delta: srinivas-4647-dfsbind_core_dump
Change: file/dfsbind/SUNOS5/machdep.mk from 1.3 to 1.4
*** file/dfsbind/SUNOS5/machdep.mk
--- 1.4	1993/11/09 15:09:37
***************
*** 1,6 ****
  VPATH				= ./${TARGET_OS}
  .if !defined(NO_LICENSE_MANAGEMENT)
! dfsbind_OFILES     	+= license.o fcalls.o 
  LIC_CFLAGS		= -D_EPISODE_LIC_MGMT_ 
  LIC_LIBS        	= -llic -lnetls -ldl
  main_helper.o_CFLAGS	+=  ${CFLAGS} ${LIC_CFLAGS}
--- 1,6 ----
  VPATH				= ./${TARGET_OS}
  .if !defined(NO_LICENSE_MANAGEMENT)
! dfsbind_OFILES     	+= license.o 
  LIC_CFLAGS		= -D_EPISODE_LIC_MGMT_ 
  LIC_LIBS        	= -llic -lnetls -ldl
  main_helper.o_CFLAGS	+=  ${CFLAGS} ${LIC_CFLAGS}

[12/8/95 public]
Applies ONLY to the Solaris port of DCE.  The OSF doesn't support that
port, or even have the files to which this port applies.



CR Number                     : 12985
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : idl_compiler
Short Description             : patch-8
Reported Date                 : 8/1/95
Found in Baseline             : 1.0.3
Found Date                    : 8/1/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/1/95 public]

[2/6/96 public]
Who would maintain OT's like this? Cancelled.



CR Number                     : 12984
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10359
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : idl compiler
Short Description             : idl compiler -no_header
Reported Date                 : 8/1/95
Found in Baseline             : 1.0.3
Found Date                    : 8/1/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/1/95 public]

From yas@tyrolia.yk.fujitsu.co.jp  Thu Jul 13 08:15:30 1995
Received: from postman.osf.org by osf.osf.org (5.65/OSF 1.0)
	id AA16785; Thu, 13 Jul 1995 08:15:30 -0400
Received: from fgwmail.fujitsu.co.jp (fgwmail.fujitsu.co.jp [164.71.1.133]) by postman.osf.org (8.6.9/8.6.x) with ESMTP
	id IAA20480 for <dce-defect@osf.org>; Thu, 13 Jul 1995 08:15:15 -0400
Received: from fdmmail.fujitsu.co.jp by fgwmail.fujitsu.co.jp (8.6.12+2.5Wb4/3.3W5-MX950612-Fujitsu Mail Gateway)
	id VAA19522; Thu, 13 Jul 1995 21:15:04 +0900
Received: from ace.yk.fujitsu.co.jp by fdmmail.fujitsu.co.jp (8.6.12+2.5Wb4/3.3W5-MX950612-Fujitsu Domain Mail Master)
	id VAA28740; Thu, 13 Jul 1995 21:14:33 +0900
Received: from tyrolia.yk.fujitsu.co.jp (tyrolia.yk.fujitsu.co.jp [133.162.42.77]) by ace.yk.fujitsu.co.jp (8.6.12+2.5Wb7/3.3W9-95030309) with SMTP id VAA11844; Thu, 13 Jul 1995 21:15:17 +0900
Received: by tyrolia.yk.fujitsu.co.jp (4.1/6.4J.5)
	id AA21392; Thu, 13 Jul 95 12:14:18 GMT
Message-Id: <9507131214.AA21392@tyrolia.yk.fujitsu.co.jp>
To: dce-defect@osf.org
Reply-To: yas@ace.yk.fujitsu.co.jp
Subject: idl compiler -no_header
Date: Thu, 13 Jul 1995 21:14:17 +0900
From: Yasushi Watanabe <yas@tyrolia.yk.fujitsu.co.jp>

Hello , I'm Yasushi Watanabe one of the member of Fujitsu DCE porting group.

Now,we check the defect report and patch for DCE 1.0.3 to reflect.

We are checking CR No.10359 "idl -no_header option is broken."
Actually we can reappear this problem on DCE 1.0.3, but we cannot on DCE 1.1 .
Surely source is changed, but I cannot understand what should I do for 
DCE 1.0.3 source (idl_compiler/command.c) to run correctly.

Could you give me patch for command.c or show me the repair points?

Thanks and Regards.

----------------------------------------------------------------------------
  Fujitsu Limited              OPEN SOFTWARE DIVISION 5th DEVELOPMENT DEPT.
  Yasushi Watanabe             TEL:+81-45-474-1926  FAX:+81-45-473-3709
  NIFTY-Serve ID:HHA02574      E-mail:yas@ace.yk.fujitsu.co.jp
----------------------------------------------------------------------------

[9/11/95]

As stated above OT 10359 was created to address this problem.



CR Number                     : 12961
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : "dir list" output not in TCL list form
Reported Date                 : 7/20/95
Found in Baseline             : 1.1
Found Date                    : 7/20/95
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/20/95 public]

The output of the "dir list" command is not in Tcl list form.  For the
reason explained in 12958 it is probably a good idea to recommend to 1.1
licensees to fix this problem in their product. It would also be a good
idea to check dcecp systematically for this problem. (Sorry but I don't
have time to this right now ;-) ).

[7/20/95 public]

The output of all dcecp commands are valid Tcl lists. Braces "{}" are
required when multiple lists or sublists need to be displayed. The output
of the "dir list" command is a single valid list of directories.

Try the following:

dcecp> set x [dir list /.:]
dcecp> llength $x

Tcl is quite happy with this as a list. An extra set of braces around the
list would be redundant and wrong.

Cancelled.

[7/20/95 public]

Oops! Shows you how much I know about Tcl! Apologies.



CR Number                     : 12948
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : rgy_edit: FAULT 0x17083008 at line 8571 of file ek_db.c
Reported Date                 : 7/11/95
Found in Baseline             : 1.1
Found Date                    : 7/11/95
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/19/96]

ADDRESSED IN DCE1.2.2.

[7/11/95 public]

Component (Module):     tty_acct.c 
Client Hardware:        see below 
Client Software:        see below 
Server Hardware:        see below 
Server Software:        see below 
Compiler:               n/a

Problem Description
--------------------

Sverity Level: Severe

Date of First Occurrence: 06/20/95

One Line Description:
   OSDqa11847 rgy_edit: FAULT 0x17083008 at line 8571 of file ek_db.c

Full Description:

Related-file:::: Problem
 DESCRIPTION:
 In rgy_edit, when attempting to change a non-existing account after inputting
 no info for the initial 3 questions on the first attempt of the change 
 sequence, rgy_edit dies with the following error information:
 
 ?(rgy_edit) Unable to change account "none" - Account does not exist (Registry Edit Kernel) (dce / sad)
 FAULT 0x17083008 at line 8571 of file ek_db.c
 
 REPRODUCIBLE: Yes
 
 TEST SOFTWARE DESCRIPTION: See below:
 # rgy_edit
 Current site is: registry server at /.../oz/subsys/dce/sec/master 
 rgy_edit=> do a
 Domain changed to: account
 rgy_edit=> c
 Change Account=> Enter account id [pname]:         	<- Return here
 Enter account group [gname]:         			<- Return here
 Enter account organization [oname]:         		<- Return here
 Change Account=> Enter account id [pname]: jkl	  <- Enter non-existent account
 Enter account group [gname]: none
 Enter account organization [oname]: none
 ?(rgy_edit) Unable to change account "none" - Account does not exist (Registry Edit Kernel) (dce / sad)
 FAULT 0x17083008 at line 8571 of file ek_db.c
 #
 
 DESCRIPTION OF HARDWARE WHERE BUG OCCURRED: Hitachi Mainframe VM - sybil
 
 DESCRIPTION OF WHERE TEST SUCCESSFULLY RAN: n/a
Related-file::Added 950621 by wright:: /build/hiosfm/RCS/dce1.1/src/security/client/admin/rgy_edit/./tty_acct.c,v 8.2
 /build/hiosfm/RCS/dce1.1/src/security/client/admin/rgy_edit/./tty_acct.c,v 8.2
 wright 1995/06/21 17:28:45 +11 -3
 Reason:  OSDqa11847 rgy_edit: FAULT 0x17083008 at line 8571 of file ek_db.c
 Change or's to and's in computing whether a set of flags are all set
 on.
 
     *** /tmp/ci.7420..tty_acct.c.7456.1	Wed Jun 21 13:28:48 1995
     --- /tmp/tty_acct.c.7456.2	Wed Jun 21 13:28:48 1995
     ***************
     *** 1059,1069 ****
     --- 1059,1073 ----
           st = ek_init_op(chg_handle);
       
               /* If all three keys specified, then changing only one account */
           verify = opt_no_query ? false : eif_verify;
       
     + #ifdef hitm
     +     if (!(arg_pname_key && arg_gname_key && arg_oname_key)) {
     + #else
           if (!(arg_pname_key || arg_gname_key || arg_oname_key)) {
     + #endif
               tty_show_prompt(Acct_chg_prompts[tty_acct_pname_prompt]);
               arg_pname_key = tty_get_arg(pkey, sizeof(pkey), &st);
               tty_show_prompt(Acct_chg_prompts[tty_acct_gname_prompt]);
               arg_gname_key = tty_get_arg(gkey, sizeof(gkey), &st);
               tty_show_prompt(Acct_chg_prompts[tty_acct_oname_prompt]);
     ***************
     *** 1094,1104 ****
     --- 1098,1112 ----
       
           if (do_interactive) {
               do_update = false;  /* assume something will go wrong on the 1st try */
               do {
                   CLEAR_STATUS(&st);
     + #ifdef hitm
     +             if (!(arg_pname_key && arg_gname_key && arg_oname_key)) {
     + #else
                   if (!(arg_pname_key || arg_gname_key || arg_oname_key)) {
     + #endif
                           /* get the acct key interactively */
                       st = tty_get_field_arg(chg_handle, ekn_acct_pname_key,
                                              &tty_null_conv_table, false,
                                              (char *) NULL, pkey, sizeof(pkey),
                                              Acct_chg_prompts[tty_acct_pname_prompt],
     ***************
     *** 2260,2270 ****
       
               /* Don't do anything if cmd line args were bad */
           if (GOOD_STATUS(&st)) {
               st = ek_init_op(op_handle);
           } else {
     !         return;
           }
       
           if (GOOD_STATUS(&st)) {
               while (GOOD_STATUS(&st)) {
                   st = ek_do_op(op_handle);
     --- 2268,2278 ----
       
               /* Don't do anything if cmd line args were bad */
           if (GOOD_STATUS(&st)) {
               st = ek_init_op(op_handle);
           } else {
     !         return st;      /* hitm -- this is NOT a void function */
           }
       
           if (GOOD_STATUS(&st)) {
               while (GOOD_STATUS(&st)) {
                   st = ek_do_op(op_handle);
 
Related-file::Added 950624 by wright:: diffs
 *** tty_acct.c	Sat Jun 24 12:22:22 1995
 --- tty_acct.c.new	Sat Jun 24 12:22:11 1995
 ***************
 *** 1,9 ****
   #if !defined(lint) && !defined(_NOIDENT) && !defined(rcsid_uQ4_NcSqn)
 ! static char rcsid_uQ4_NcSqn[]="@(#)$RCSfile: c012948,v $ $Revision: 1.3 $";
   #define rcsid_uQ4_NcSqn 1
   #endif
   /*
 ! $Id: c012948,v 1.3 96/03/19 15:52:02 root Exp $
   
   ----------------------------------------------------------------
    Copyright 1993 Hitachi, Ltd.
 --- 1,9 ----
   #if !defined(lint) && !defined(_NOIDENT) && !defined(rcsid_uQ4_NcSqn)
 ! static char rcsid_uQ4_NcSqn[]="@(#)$RCSfile: c012948,v $ $Revision: 1.3 $";
   #define rcsid_uQ4_NcSqn 1
   #endif
   /*
 ! $Id: c012948,v 1.3 96/03/19 15:52:02 root Exp $
   
   ----------------------------------------------------------------
    Copyright 1993 Hitachi, Ltd.
 ***************
 *** 995,1001 ****
 --- 995,1005 ----
           /* If all three keys specified, then changing only one account */
       verify = opt_no_query ? false : eif_verify;
   
 + #ifdef hitm
 +     if (!(arg_pname_key && arg_gname_key && arg_oname_key)) {
 + #else
       if (!(arg_pname_key || arg_gname_key || arg_oname_key)) {
 + #endif
           tty_show_prompt(Acct_chg_prompts[tty_acct_pname_prompt]);
           arg_pname_key = tty_get_arg(pkey, sizeof(pkey), &st);
           tty_show_prompt(Acct_chg_prompts[tty_acct_gname_prompt]);
 ***************
 *** 1030,1036 ****
 --- 1034,1044 ----
           do_update = false;  /* assume something will go wrong on the 1st try */
           do {
               CLEAR_STATUS(&st);
 + #ifdef hitm
 +             if (!(arg_pname_key && arg_gname_key && arg_oname_key)) {
 + #else
               if (!(arg_pname_key || arg_gname_key || arg_oname_key)) {
 + #endif
                       /* get the acct key interactively */
                   st = tty_get_field_arg(chg_handle, ekn_acct_pname_key,
                                          &tty_null_conv_table, false,
Related-file:::: Resolution 
 DESCRIPTION OF BUG FIX:  When testing a set of flags to see if all of
 them are on, you have to 'and' them together, not 'or' them.
  
  
 REGRESSION TEST SCENARIO:  As in first enclosure.
  
  
 RCSDIFFS (either inserted manually or via Fci):  Manually in previous
 enclosure.



CR Number                     : 12939
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_login_set_context() of delegated ctxt may have a bug.
Reported Date                 : 6/27/95
Found in Baseline             : 1.1
Found Date                    : 6/27/95
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/27/95 public]

I've sent this to dce-tech but have been told that opening an OT is the
right way to do this:

I can not find in the documentation an answer to the question that follows.
 
A DCE remote access server (e.g. a DCE-ized rshd) receives a call and needs
to spawn a process with some local uid (somehow derived from the client
credentials) and with the delegated network credentials of the client. How
is that done? The obvious (mistaken?) way (in the server):
 
 	rpc_binding_inq_auth_caller()
 	delegated_ctx = sec_login_become_impersonator()
 	fork
 	/* in child */
 	setuid(regular_user)
 	sec_login_set_context(delegated_ctx)

does not work. Should it work? It seems that the problem is in part caused
by the fact that the implementation keeps login context information in
files (i.e. subject to file sytem access mechanism) vs. in memory data that
could be shared between parent/child processes.
 
I've looked at the sec_login_* implementation and have found some chown
magic (read: undocumented) on the various credentials files (e.g. in
sec_login_valid_and_cert_ident) to support related uses of the API (e.g.
integrated system login). Is support for the situation outlined above
buried somewhere in there?

[7/12/95 public]

Hello there, I would very much appreciate some help with this. Thanks.

[7/13/95 public]

A little clarification: in DCE-RFC 3.0 section 7 ("Full Identity
Forwarding (Impersonation) For Remote System Login") begins:

"Impersonation is often useful for implementing remote system login
utilities. The mechanism for accomplishing this are present in Kerberos V5
and can be found in extended versions of telnet and rlogin."

I took this to mean that somehow there is support to transform on the
remote system the client delegation token into a login context
(corresponding to the client's identity) usable as if it had been obtained
by doing a "dce login" on the remote system (with the substantial benefit
of not requiring the client to do a "dce login" on the remote system).

My question is simply how is this done?

[7/14/95 public]

I've worked on this some more. Interim findings coming up...

[7/17/95 public]

Hello there,

1) The code described above almost works when the child doesn't setuid:

 	rpc_binding_inq_auth_caller()
 	delegated_ctx = sec_login_become_impersonator()
 	fork
 	/* in child */
 	sec_login_set_context(delegated_ctx)

in the manager code yields almost usable delegated NC (corresponding to the
client id). There are some problems with the id info contained in the NC. 
For example klist yields:

DCE Identity Information:
        Global Principal: <NIL>/<NIL>
        Cell:      00000000-0000-0000-0000-000000000000 <NIL>
        Principal: 00000000-0000-0000-0000-000000000000 <NIL>
        Group:     00000000-0000-0000-0000-000000000000 <NIL>

Identity Info Expires: 95/07/17:20:33:00
Account Expires:       never
Passwd Expires:        never

Kerberos Ticket Information:
Ticket cache: /opt/dcelocal/var/security/creds/dcecred_13eab200
Default principal: junk@alphaville.cell.osf.org
Server: krbtgt/alphaville.cell.osf.org@alphaville.cell.osf.org
        valid 95/07/17:10:33:00 to 95/07/17:20:33:00
Server: dce-ptgt@alphaville.cell.osf.org
        valid 95/07/17:10:33:05 to 95/07/17:12:33:05
Client: dce-ptgt@alphaville.cell.osf.org        Server:
krbtgt/alphaville.cell.osf.org@alphaville.cell.osf.org
        valid 95/07/17:10:33:06 to 95/07/17:12:32:57
Client: dce-ptgt@alphaville.cell.osf.org        Server:
dce-rgy@alphaville.cell.osf.org
        valid 95/07/17:10:33:45 to 95/07/17:12:32:57

and dcecp fails with the error "Error in getting initial login context."
from a failure of sec_id_gen_name returning the error code 387064021 ("Cell
UUID does not correspond to a valid cell name (dce / sec)"). But rgy_edit
does not complain and sure enough authorizes access to the registry as the
client identity.
 
2) With that in hand the following hack in the manager code even works:

void bar(handle_t h, idl_long_int uid)
{
  pid = fork();

  if (pid == 0) {		/* child */
    setuid(uid);
    sec_login_setup_identity("junk", &login_context);
    sec_login_validate_identity();
    sec_login_certify_identity();
    rpc_binding_inq_auth_caller(&privs);
    delegated_context = sec_login_become_impersonator(privs, login_context);
    sec_login_set_context(delegated_context, &status);

again yielding almost usable NC but this time sucessfully crossing the "uid
barrier." The trick here was to use the binding handle (deeply contained
in memory) in the child (after the setuid) vs. a login context (which has a
part in the file system and is thereby subject to access restrictions).
Also, this required the principal "junk" (with a well known password!) to
setup the login context required in sec_login_become_impersonator.

Questions: shouldn't the code be fixed so that the delegated NC be fully
usable? Shouldn't there be a better way to do (2)?

[2/2/96 public]
The above have been mostly questions (some of which were answered via email)
so this OT hasn't been addressed as a bug in the past.  Rather than close it
as an incorrect use of OT (questions should go to dce-tech), I'm altering it
to report one possible problem that I've noticed from the above questions,
coupled with a very similar problem reported by Scott McKinley of Oracle on
the sig-dce mailing list.  It's not a p0 because this is not the normal use
of the APIs, but I'll leave it as a B1 since it is a potential problem for
those trying to use it in this particular way.

The problem seems to be that in the above case, you get a cred cache with
a bad EPAC in it after a sec_login_become_delegate().   The problem that
Scott reported is that after a sec_login_become_impersonator(), his call
to sec_login_set_context() returned sec_login_s_default_use (387064048).
This needs to be reproduced and looked into.

[5/16/96 public]
I have modified the security delegation tests to call
sec_login_set_context() after sec_login_become_impersonator() in an attempt
to reproduce this problem. It works fine. I guess I'm going to need some
more info to continue debugging this problem.

[5/20/96 public]
The code that Scot McKinley from Oracle wrote had several problems. All
have been worked out. The delegation now is working for him. Cancelled.



CR Number                     : 12933
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpcd
Short Description             : cleanup in dsm.c:grow_file()  may leave dangling ptrs
Reported Date                 : 6/25/95
Found in Baseline             : 1.0.3
Found Date                    : 6/25/95
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/25/95 public]
 Several issues are raised in the customer report.

   - Cleanup in dsm.c:grow_file() leaves dangling pointers. 
	I believe, from looking at dsm.c in 1.0.3, this is a bug 
	that could potentially cause other symptoms described here.

  - rpcd deadlock
	If a SEGV or SIGILL is raised while the db lock is held
	it is implementation dependent whether only the thread
	is terminated or the entire process is aborted with 
	a core dump. On rs6k reference this should be latter, as
	_CMA_SYNC_KILL_ flag is enabled.

  - rpcd spinning on mutex locks
	This is perhaps  property of the underlying threads
	implementation and perhaps a multi-processor issue.
	Unless _CMA_SPIN_LOOP_ is enabled at compile time
	the lock operations should block and not consume
	significant cpu.

 The cleanup should  be fixed in 1.1 as well as 1.0.3. I believe it
 would also be helpful to retry write(2) in grow_file() on EINTR
 and if write(2) returned fewer than the number of bytes presented.

 I am not sure if this is an issue for  dce 1.1.

-------------  Customer report -----

                          DCE Problem Report
                  =================================


Submitter Information 
- ----------------------

Submitter Name:           wright
Organization:             Hitachi Computer Products (America), Inc. 
Email Address:            osd.dce@hi.com wright@hi.com 
Phone:                    617-890-0444 
DCE License Number:       1616-MDCE-92
Licensee's Defect Number: OSDqa11561


Hardware/Software Configuration
- --------------------------------

Offering and Version:   DCEunknown 
Component (Module):     dsm.c et al 
Client Hardware:        see below 
Client Software:        see below 
Server Hardware:        see below 
Server Software:        see below 
Compiler:               n/a

Problem Description
- --------------------

Severity Level: Critical

Date of First Occurrence: 05/16/95

One Line Description:
   OSDqa11561 rpcd caught in a deadlock

Full Description:

Related-file:::: Problem
 DESCRIPTION:
 
 It appears that 1 rpcd thread exited while holding a mutex lock
 and caused a deadlock because the remaining threads were waiting for
 that particular lock. 
 
 [Cpu0] (Dot is "0")  cda: 6>  $PS
   N SW   PID     USER   %CPU    WCHAN(WMESG)    COMD/ARGS
   0 U=     0   <root>   0.00         (clock)    kernel idle 
 * 1 U=     0   <root>   0.00         (malloc)   kmem 
 * 2 U=     0   <root>   0.00         (netisr)   netisr 
 * 3 U=     0   <root>   0.00         (netisr)   netisr 
 * 4 U=     0   <root>   0.00         (netisr)   netisr 
 * 5 U=     0   <root>   0.00         (netisr)   netisr 
 * 6 U=     0   <root>   0.00         (netisr)   netisr 
 * 7 U=     0   <root>   0.00         (netisr)   netisr 
 * 8 U=     0   <root>   0.00         (netisr)   netisr 
 * 9 U=     0   <root>   0.00         (netisr)   netisr 
 * a U=     0   <root>   0.00         (netisr)   netisr 
 * b U=     0   <root>   0.00         (netisr)   netisr 
 * c R      0   <root>   0.00         (idlework) idle0 
 * d R      0   <root>   0.00         (idlework) idle1 
 * e U=     0   <root>   0.00   60bd78(callwork) callthrd 
 * f U=     0   <root>   0.00   621f18(pagework) pageout 
 *10 U=     0   <root>   0.00   621dc8(objuncac) objcache 
 *11 U=     0   <root>   0.00   625970(reaper)   reaper 
 *12 U=     0   <root>   0.00   625c38(thswpin)  thrdswapin 
 *13 U=     0   <root>   0.00   4977d8(thswpout) thrdswapout 
 *14 U=     0   <root>   0.00   623490(swapwork) tskswapper 
 *15 U=     0   <root>   0.00   623498(swapout)  tskswapthrd 
 *16 U      0   <root>   0.00   623660(actqueue) doaction 
 *17 U=     0   <root>   0.00         (sched)    scheduler 
 *18 U=     0   <root>   0.00   5afdd8(dequeue)  psignal 
 *19 U=     0   <root>   0.00    32fd8(acctwtch) acct 
 *1a U      0   <root>   0.00   60bec0(async_q)  async 
 *1b U      0   <root>   0.00   60bec0(async_q)  async 
 *1c U      0   <root>   0.00   60bec0(async_q)  async 
 *1d U      0   <root>   0.00   60bec0(async_q)  async 
 *1e U      0   <root>   0.00   60bec0(async_q)  async 
 *1f U      0   <root>   0.00   60bec0(async_q)  async 
 *20 U      0   <root>   0.00   60bec0(async_q)  async 
 *21 U      0   <root>   0.00   60bec0(async_q)  async 
 *22 U      0   <root>   0.00   60bec0(async_q)  async 
 *23 U      0   <root>   0.00   60bec0(async_q)  async 
 *24 S      0   <root>   0.00         (tapScann) tapScanner 
   1 s      1   <root>   0.00   5a6b98(pause)    init               <args N/A>
   2 S=     2   <root>   0.00         (msgdeque) vnode_pager 
 * 1 S=     2   <root>   0.00         (msgdeque) vnpager 
 * 2 S=     2   <root>   0.00         (msgdeque) vnpager 
 * 3 S=     2   <root>   0.00         (msgdeque) vnpager 
 * 4 S=     2   <root>   0.00         (msgdeque) vnpager 
 * 5 U=     2   <root>   0.00   60b800(vpasync)  vnpager 
   3 S=     3   <root>   0.00         (msgdeque) device pager 
   4 s      4   <root>   0.00         (msgdeque) exception hdlr 
   c S     12   <root>   0.00   5a6ba8(pause)    /sbin/update 
  14 s  12020     root   0.00  2385b30(wait)     ksh                <args N/A>
  17 s   3023   <root>   0.00  2373770(event)    rlogind            <args N/A>
  19 s   3025   <root>   0.00  22e6618(event)    rlogind            <args N/A>
  1a s   3026     root   0.00  22f96a8(wait)     ksh                <args N/A>
  1b s   3027   <root>   0.00  22e6be0(event)    rlogind            <args N/A>
  1c s   3028     root   0.00  2323b30(wait)     ksh                <args N/A>
  1e s   3030     root   0.00   4b433c(ttyin)    ksh                <args N/A>
  3b s   9059     root   0.00         (msgdeque) r_server.exe       <args N/A>
 * 1 S   9059     root   0.00         (msgdeque) 
 * 2 s   9059     root   0.00  2330178(event)    
 * 3 s   9059     root   0.00         (msgdeque) 
 * 4 s   9059     root   0.00         (msgdeque) 
 * 5 s   9059     root   0.00         (msgdeque) 
 * 6 s   9059     root   0.00         (msgdeque) 
 * 7 s   9059     root   0.00         (msgdeque) 
 * 8 s   9059     root   0.00         (msgdeque) 
 * 9 s   9059     root   0.00         (msgdeque) 
 * a s   9059     root   0.00         (msgdeque) 
 * b s   9059     root   0.00         (msgdeque) 
 * c s   9059     root   0.00         (msgdeque) 
 * d s   9059     root   0.00         (msgdeque) 
 * e s   9059     root   0.00         (msgdeque) 
 * f s   9059     root   0.00         (msgdeque) 
 *10 s   9059     root   0.00         (msgdeque) 
  65 U=   101   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  66 U=   102   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  67 U=   103   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  68 U=   104   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  69 U=   105   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  6a U=   106   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  6b U=   107   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  6c U=   108   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  6d U=   109   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  6e U=   110   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  6f U=   111   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  71 U=   113   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  72 U=   114   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  73 S=   115   <root>   0.00  6181740(socket)   nfsfsd             <args N/A>
  74 U=   116   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  75 U=   117   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  76 U=   118   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  77 U=   119   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  78 U=   120   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  79 U=   121   <root>   0.00   5fd7b0(lockwrit) nfsfsd             <args N/A>
  7e S    126   <root>   0.00  21b8d70(event)    /usr/sbin/routed 
  87 S    135   <root>   0.00  21b8b20(event)    /usr/sbin/portmap 
  91 S    145   <root>   0.00  21b88d0(event)    /sbin/syslogd 
  93 S    147            0.00   5e65a4(klg_get)  errord             <args N/A>
  9d S    157   <root>   0.00  21b87a8(event)    /usr/sbin/mountd -n 
  9f S=   159   <root>   0.00  626ed40(socket)   nfsd               <args N/A>
  a0 S=   160   <root>   0.00  626ed40(socket)   nfsd               <args N/A>
  a1 S=   161   <root>   0.00  626ed40(socket)   nfsd               <args N/A>
  a2 S=   162   <root>   0.00  626ed40(socket)   nfsd               <args N/A>
  a4 S=   164   <root>   0.00   5f8e98(nfs biod) nfsiod             <args N/A>
  a5 S=   165   <root>   0.00   5f8e98(nfs biod) nfsiod             <args N/A>
  a6 S=   166   <root>   0.00   5f8e98(nfs biod) nfsiod             <args N/A>
  a7 S=   167   <root>   0.00   5f8e98(nfs biod) nfsiod             <args N/A>
  b7 S    183   <root>   0.00  6289640(fifo)     /usr/sbin/cron 
  cf S    207   <root>   0.00  6288130(socket)   -accepting connections          
  d2 s    210   <root>   0.00  222dd38(event)    inetd              <args N/A>
  db S    219   <root>   0.00   5a6ba8(pause)    /usr/sbin/chpidd 
  e5 s    229   <root>   0.00  222d520(event)    lpd                <args N/A>
  e7 s    231     root   0.00  618847c(tty)      ksh                <args N/A>
  f0 s    240   <root>   0.00  222d898(event)    rpc.statd          <args N/A>
  f2 s    242   <root>   0.00  222d3f8(event)    rpc.lockd          <args N/A>
 12e s    302   <root>   0.00         (msgdeque) sec_clientd        <args N/A>
 * 1 S    302   <root>   0.00         (msgdeque) 
 * 2 s    302   <root>   0.00  222aa58(event)    
 * 3 s    302   <root>   0.00         (msgdeque) 
 * 4 s    302   <root>   0.00         (msgdeque) 
 * 5 s    302   <root>   0.00         (msgdeque) 
 * 6 s    302   <root>   0.00         (msgdeque) 
 * 7 s    302   <root>   0.00         (msgdeque) 
 * 8 s    302   <root>   0.00         (msgdeque) 
 * 9 s    302   <root>   0.00         (msgdeque) 
 * a s    302   <root>   0.00         (msgdeque) 
 * b s    302   <root>   0.00         (msgdeque) 
 * c s    302   <root>   0.00         (msgdeque) 
 * d s    302   <root>   0.00         (msgdeque) 
 * e s    302   <root>   0.00         (msgdeque) 
 * f s    302   <root>   0.00         (msgdeque) 
 *10 s    302   <root>   0.00         (msgdeque) 
 *11 s    302   <root>   0.00         (msgdeque) 
 *12 s    302   <root>   0.00         (msgdeque) 
 132 S    306   <root>   0.00  2229a28(event)    /opt/dcelocal/bin/cdsadv 
 * 1 S    306   <root>   0.00         (msgdeque) 
 * 2 s    306   <root>   0.00         (msgdeque) 
 * 3 s    306   <root>   0.00         (msgdeque) 
 * 4 s    306   <root>   0.00  2229210(event)    
 * 5 S    306   <root>   0.00         (msgdeque) 
 * 6 S    306   <root>   0.00         (msgdeque) 
 * 7 s    306   <root>   0.00         (msgdeque) 
 * 8 s    306   <root>   0.00         (msgdeque) 
 * 9 s    306   <root>   0.00         (msgdeque) 
 * a s    306   <root>   0.00         (msgdeque) 
 * b s    306   <root>   0.00         (msgdeque) 
 * c s    306   <root>   0.00         (msgdeque) 
 * d s    306   <root>   0.00         (msgdeque) 
 * e s    306   <root>   0.00         (msgdeque) 
 * f s    306   <root>   0.00         (msgdeque) 
 *10 s    306   <root>   0.00         (msgdeque) 
 *11 s    306   <root>   0.00         (msgdeque) 
 *12 s    306   <root>   0.00         (msgdeque) 
 *13 s    306   <root>   0.00         (msgdeque) 
 *14 s    306   <root>   0.00         (msgdeque) 
 136 s    310   <root>   0.00         (msgdeque) cdsd               <args N/A>
 * 1 S    310   <root>   0.00         (msgdeque) 
 * 2 s    310   <root>   0.00         (msgdeque) 
 * 3 s    310   <root>   0.00         (msgdeque) 
 * 4 S    310   <root>   0.00  226d9c0(event)    
 * 5 s    310   <root>   0.00         (msgdeque) 
 * 6 s    310   <root>   0.00         (msgdeque) 
 * 7 s    310   <root>   0.00         (msgdeque) 
 * 8 s    310   <root>   0.00         (msgdeque) 
 * 9 s    310   <root>   0.00         (msgdeque) 
 * a s    310   <root>   0.00         (msgdeque) 
 * b s    310   <root>   0.00         (msgdeque) 
 * c s    310   <root>   0.00         (msgdeque) 
 * d s    310   <root>   0.00         (msgdeque) 
 * e s    310   <root>   0.00         (msgdeque) 
 * f s    310   <root>   0.00         (msgdeque) 
 *10 S    310   <root>   0.00         (msgdeque) 
 *11 s    310   <root>   0.00         (msgdeque) 
 *12 s    310   <root>   0.00         (msgdeque) 
 *13 s    310   <root>   0.00         (msgdeque) 
 *14 S    310   <root>   0.00         (msgdeque) 
 *15 s    310   <root>   0.00         (msgdeque) 
 *16 s    310   <root>   0.00         (msgdeque) 
 *17 s    310   <root>   0.00         (msgdeque) 
 *18 s    310   <root>   0.00  62d2130(socket)   
 *19 s    310   <root>   0.00         (msgdeque) 
 *1a s    310   <root>   0.00         (msgdeque) 
 *1b s    310   <root>   0.00         (msgdeque) 
 *1c s    310   <root>   0.00         (msgdeque) 
 *1d s    310   <root>   0.00         (msgdeque) 
 *1e s    310   <root>   0.00         (msgdeque) 
 *1f s    310   <root>   0.00         (msgdeque) 
 *20 S    310   <root>   0.00         (msgdeque) 
 *21 s    310   <root>   0.00         (msgdeque) 
 *22 s    310   <root>   0.00         (msgdeque) 
 *23 s    310   <root>   0.00         (msgdeque) 
 *24 s    310   <root>   0.00         (msgdeque) 
 *25 s    310   <root>   0.00         (msgdeque) 
 *26 s    310   <root>   0.00         (msgdeque) 
 *27 s    310   <root>   0.00         (msgdeque) 
 *28 s    310   <root>   0.00  62d3740(socket)   
 13d s    317   <root>   0.00         (msgdeque) dts_null_provide   <args N/A>
 * 1 S    317   <root>   0.00         (msgdeque) 
 * 2 s    317   <root>   0.00  22b2178(event)    
 * 3 s    317   <root>   0.00         (msgdeque) 
 * 4 s    317   <root>   0.00         (msgdeque) 
 * 5 s    317   <root>   0.00         (msgdeque) 
 * 6 s    317   <root>   0.00         (msgdeque) 
 191 s   9401    atlas   0.00         (msgdeque) rpcd               <args N/A>
 * 1 S   9401    atlas   0.00         (msgdeque) 
 * 2 R   9401    atlas  42.89                    
 * 3 R   9401    atlas  35.03                    
 * 4 R   9401    atlas  43.11                    
 * 5 R   9401    atlas  33.79                    
 * 6 R   9401    atlas  37.32                    
 * 7 R   9401    atlas  38.02                    
 * 8 R   9401    atlas  43.41                    
 * 9 s   9401    atlas   0.00         (msgdeque) 
 * a s   9401    atlas   0.00         (msgdeque) 
 * b s   9401    atlas   0.00         (msgdeque) 
 * c s   9401    atlas   0.00         (msgdeque) 
 * d s   9401    atlas   0.00         (msgdeque) 
 * e s   9401    atlas   0.00         (msgdeque) 
 * f s   9401    atlas   0.00         (msgdeque) 
 *10 s   9401    atlas   0.00         (msgdeque) 
 *11 s   9401    atlas   0.00         (msgdeque) 
 *12 s   9401    atlas   0.00         (msgdeque) 
 *13 s   9401    atlas   0.00         (msgdeque) 
 *14 s   9401    atlas   0.00         (msgdeque) 
 *15 s   9401    atlas   0.00         (msgdeque) 
 *16 s   9401    atlas   0.00         (msgdeque) 
 *17 s   9401    atlas   0.00         (msgdeque) 
 *18 s   9401    atlas   0.00         (msgdeque) 
 *19 s   9401    atlas   0.00         (msgdeque) 
 *1a s   9401    atlas   0.00         (msgdeque) 
 *1b s   9401    atlas   0.00         (msgdeque) 
 *1c s   9401    atlas   0.00         (msgdeque) 
 *1d s   9401    atlas   0.00         (msgdeque) 
 *1e s   9401    atlas   0.00         (msgdeque) 
 *1f s   9401    atlas   0.00         (msgdeque) 
 *20 s   9401    atlas   0.00         (msgdeque) 
 *21 s   9401    atlas   0.00         (msgdeque) 
 *22 s   9401    atlas   0.00         (msgdeque) 
 *23 s   9401    atlas   0.00         (msgdeque) 
 *24 s   9401    atlas   0.00         (msgdeque) 
 *25 s   9401    atlas   0.00         (msgdeque) 
 *26 s   9401    atlas   0.00         (msgdeque) 
 *27 s   9401    atlas   0.00         (msgdeque) 
 *28 s   9401    atlas   0.00         (msgdeque) 
 *29 s   9401    atlas   0.00         (msgdeque) 
 *2a s   9401    atlas   0.00         (msgdeque) 
 *2b s   9401    atlas   0.00         (msgdeque) 
 *2c s   9401    atlas   0.00         (msgdeque) 
 *2d s   9401    atlas   0.00         (msgdeque) 
 *2e s   9401    atlas   0.00         (msgdeque) 
 *2f s   9401    atlas   0.00         (msgdeque) 
 *30 s   9401    atlas   0.00         (msgdeque) 
 *31 s   9401    atlas   0.00         (msgdeque) 
 *32 s   9401    atlas   0.00         (msgdeque) 
 19c S    412   <root>   0.00  22971a8(event)    rlogind            <args N/A>
 19d s    413    atlas   0.00  21d98ec(wait)     ksh                <args N/A>
 30a S    778   <root>   0.00         (msgdeque) /opt/dcelocal/bin/cdsclerk -U ro
 * 1 s    778   <root>   0.00         (msgdeque) 
 * 2 s    778   <root>   0.00         (msgdeque) 
 * 3 s    778   <root>   0.00  6784f30(socket)   
 * 4 s    778   <root>   0.00         (msgdeque) 
 * 5 s    778   <root>   0.00         (msgdeque) 
 * 6 S    778   <root>   0.00         (msgdeque) 
 * 7 s    778   <root>   0.00         (msgdeque) 
 * 8 s    778   <root>   0.00  617de40(socket)   
 * 9 s    778   <root>   0.00  675ea40(socket)   
 * a s    778   <root>   0.00  676bc40(socket)   
 * b s    778   <root>   0.00         (msgdeque) 
 * c s    778   <root>   0.00  222c618(event)    
 * d s    778   <root>   0.00         (msgdeque) 
 * e s    778   <root>   0.00         (msgdeque) 
 * f s    778   <root>   0.00         (msgdeque) 
 *10 s    778   <root>   0.00         (msgdeque) 
 *11 s    778   <root>   0.00         (msgdeque) 
 *12 s    778   <root>   0.00         (msgdeque) 
 *13 s    778   <root>   0.00         (msgdeque) 
 *14 s    778   <root>   0.00         (msgdeque) 
 *15 s    778   <root>   0.00         (msgdeque) 
 365 s  12869     root   0.00  23dd3f8(event)    telnet             <args N/A>
 36f s   9879     root   0.00         (msgdeque) secd               <args N/A>
 * 1 S   9879     root   0.00         (msgdeque) 
 * 2 s   9879     root   0.00         (msgdeque) 
 * 3 S   9879     root   0.00         (msgdeque) 
 * 4 S   9879     root   0.00         (msgdeque) 
 * 5 S   9879     root   0.00  2373f88(event)    
 * 6 s   9879     root   0.00         (msgdeque) 
 * 7 s   9879     root   0.00         (msgdeque) 
 * 8 S   9879     root   0.00         (msgdeque) 
 * 9 s   9879     root   0.00         (msgdeque) 
 * a s   9879     root   0.00         (msgdeque) 
 * b s   9879     root   0.00         (msgdeque) 
 * c s   9879     root   0.00  676a940(socket)   
 * d s   9879     root   0.00         (msgdeque) 
 * e s   9879     root   0.00         (msgdeque) 
 * f s   9879     root   0.00         (msgdeque) 
 *10 s   9879     root   0.00         (msgdeque) 
 *11 s   9879     root   0.00         (msgdeque) 
 *12 s   9879     root   0.00         (msgdeque) 
 *13 s   9879     root   0.00         (msgdeque) 
 *14 s   9879     root   0.00         (msgdeque) 
 *15 s   9879     root   0.00         (msgdeque) 
 *16 s   9879     root   0.00         (msgdeque) 
 44f s  13103     root   0.00         (msgdeque) t_server.exe       <args N/A>
 * 1 S  13103     root   0.00         (msgdeque) 
 * 2 s  13103     root   0.00  2399648(event)    
 * 3 s  13103     root   0.00         (msgdeque) 
 * 4 s  13103     root   0.00         (msgdeque) 
 * 5 s  13103     root   0.00         (msgdeque) 
 * 6 s  13103     root   0.00         (msgdeque) 
 * 7 s  13103     root   0.00         (msgdeque) 
 * 8 s  13103     root   0.00         (msgdeque) 
 * 9 s  13103     root   0.00         (msgdeque) 
 * a s  13103     root   0.00         (msgdeque) 
 * b s  13103     root   0.00         (msgdeque) 
 * c s  13103     root   0.00         (msgdeque) 
 * d s  13103     root   0.00         (msgdeque) 
 * e s  13103     root   0.00         (msgdeque) 
 * f s  13103     root   0.00         (msgdeque) 
 *10 s  13103     root   0.00         (msgdeque) 
 45b s  22115     root   0.00  222c990(event)    telnet             <args N/A>
 4f4 s  13268     root   0.00  23dd520(event)    telnet             <args N/A>
 521 s  13313     root   0.00  21d86cc(wait)     ksh                <args N/A>
 540 S   1344   <root>   0.00  22e72d0(event)    rlogind            <args N/A>
 541 s   1345     root   0.00  22f8fdc(wait)     ksh                <args N/A>
 544 s  13348   <root>   0.00  22e6990(event)    rlogind            <args N/A>
 7b4 S   4972    atlas   0.00   5a6b98(pause)    swap_stats 
 7f4 S   5036    atlas   0.00  2384910(wait)     su 
 871 s   8161     root   0.00         (msgdeque) t_server.exe       <args N/A>
 * 1 S   8161     root   0.00         (msgdeque) 
 * 2 s   8161     root   0.00  2330868(event)    
 * 3 s   8161     root   0.00         (msgdeque) 
 * 4 s   8161     root   0.00         (msgdeque) 
 * 5 s   8161     root   0.00         (msgdeque) 
 * 6 s   8161     root   0.00         (msgdeque) 
 * 7 s   8161     root   0.00         (msgdeque) 
 * 8 s   8161     root   0.00         (msgdeque) 
 * 9 s   8161     root   0.00         (msgdeque) 
 * a s   8161     root   0.00         (msgdeque) 
 * b s   8161     root   0.00         (msgdeque) 
 * c s   8161     root   0.00         (msgdeque) 
 * d s   8161     root   0.00         (msgdeque) 
 8be s   5238   <root>   0.00  23dc4f0(event)    rlogind            <args N/A>
 8d2 S   5258   <root>   0.00         (msgdeque) /opt/dcelocal/bin/cdsclerk -U DN
 * 1 s   5258   <root>   0.00         (msgdeque) 
 * 2 s   5258   <root>   0.00  6545530(socket)   
 * 3 s   5258   <root>   0.00         (msgdeque) 
 * 4 s   5258   <root>   0.00  6352140(socket)   
 * 5 s   5258   <root>   0.00         (msgdeque) 
 * 6 S   5258   <root>   0.00         (msgdeque) 
 * 7 s   5258   <root>   0.00  6785a40(socket)   
 922 R   5338    atlas  93.22                    cda 
 963 S   5403     root   0.00  23f6618(event)    telnet doolie 
 96a s   5410   jsivak   0.00   5a6ba8(pause)    csh                <args N/A>
 97a s   5426   jsivak   0.00   4b3bdc(ttyin)    tset               <args N/A>
 9c9 s  11505     root   0.00  2373898(event)    telnet             <args N/A>
 a37 S   2615    atlas   0.00  21d8000(wait)     su 
 a50 S   2640   <root>   0.00  22b2868(event)    rlogind            <args N/A>
 a51 s   2641    atlas   0.00  23236a8(wait)     ksh                <args N/A>
 af5 s  11805   <root>   0.00  22e79c0(event)    rlogind            <args N/A>
 
 [Cpu0] (Dot is "0")  cda: 9>  $<swap
 Num         Swapfile  -  Free   Max
 [ 0]     /dev/ckd0-2  -   71M  128M
 
 [Cpu0] (Dot is "1")  cda:10>  $<vmstat
 Virtual Memory Statistics: (pagesize = 8192)
        1107   active pages
        2283   inactive pages
         227   free pages
        4575   wired pages
    42566029   virtual memory page faults
     9766315   copy-on-write page faults
     7670108   zero fill page faults
     3035702   reattaches from reclaim list
      989804   pages paged in
      339548   pages paged out
      989804   # of faults resulting in pageins
      339548   # of pageout operations (cluster)
      591616   number of object cache lookups
      586634   number of object cache hits
   172530753   thread context switches
    45204261   task context switches
    18921386   device interrupts
 [Cpu0] (Dot is "1000000")  cda: 1>  $<runq
 [  6220d0] Priority level:  0
 [  6220d8] Priority level:  1
 [  6220e0] Priority level:  2
 [  6220e8] Priority level:  3
 [  6220f0] Priority level:  4
 [  6220f8] Priority level:  5
 [  622100] Priority level:  6
 [  622108] Priority level:  7
 [  622110] Priority level:  8
 [  622118] Priority level:  9
 [  622120] Priority level: 10
 [  622128] Priority level: 11
 [  622130] Priority level: 12
 [  622138] Priority level: 13
 [  622140] Priority level: 14
 [  622148] Priority level: 15
 [  622150] Priority level: 16
 [  622158] Priority level: 17
 [  622160] Priority level: 18
 [  622168] Priority level: 19
 [  622170] Priority level: 20
 [  622178] Priority level: 21
 [  622180] Priority level: 22
 [  622188] Priority level: 23
 [  622190] Priority level: 24
 [  622198] Priority level: 25
 [  6221a0] Priority level: 26
 [  6221a8] Priority level: 27
 [  6221b0] Priority level: 28
 [  6221b8] Priority level: 29
 [  6221c0] Priority level: 30
 [  6221c8] Priority level: 31
 
 REPRODUCIBLE:
 unknown
 
 TEST SOFTWARE DESCRIPTION:
 The deadlock occurred while executing the baseunit named rpcd_epoint.
 It creates 20 pthreads and each one attempts to add 1000 endpoint map
 entries to the end point map database. The database had grown to
 ~12 meg at the time of the failure.
 
 DESCRIPTION OF HARDWARE WHERE BUG OCCURRED:
 sybil 2 processors
 
 DESCRIPTION OF WHERE TEST SUCCESSFULLY RAN:
 
Related-file::Retitled 950516 by wright:: some problem analysis
 The rpcd was spinning, with multiple threads in db_lock() attempting to
 lock the same mutex.  These were all cthread_call_executor threads.
 
 The owner of the mutex was yet another cthread_call_executor thread,
 but it was idle.
 
 My guess is that one of the executor threads got into an epdb_xxx
 routine and took a SIGSEGV due to some sort of corruption, while
 holding the db_lock.  Since the executor threads always set a
 TRY/CATCH_ALL before invoking the service routine (in opX_ssr), the
 exception would not cause the rpcd to die, but the lock would not be
 unlocked.  Even if the lock were unlocked, it may not be much of a
 solution, if memory corruption has already occurred.
 
 If this problem can be reproduced, I'd very much like to try it with
 rpcd running under sdb.
 
Related-file::Added 950606 by wright:: /build/hiosfm/RCS/dce/src/rpc/rpcd/./rpcddb.h,v 7.2
 /build/hiosfm/RCS/dce/src/rpc/rpcd/./rpcddb.h,v 7.2
 wright 1995/06/06 16:41:20 +8 -2
 Reason:  OSDqa11561 rpcd caught in a deadlock
 Replace single lock with a set of locks to avoid spinning during
 blocking system calls.
 
     *** /tmp/ci.19448..rpcddb.h.19485.1	Tue Jun  6 12:41:22 1995
     --- /tmp/rpcddb.h.19485.2	Tue Jun  6 12:41:22 1995
     ***************
     *** 111,121 ****
     --- 111,127 ----
        */
       struct db {
           dsm_handle_t        dsh;
           uuid_t              object;
           db_lists_mgmt_t     lists_mgmt;         /* entry, object, interface lists mgmt */
     + #ifdef hitm
     +     pthread_mutex_t     lock_m;             /* Database mutex lock */
     +     pthread_mutex_t     lock_a;             /* Database acquisition lock */
     +     pthread_cond_t      sleep;              /* sleep if lock busy */
     + #else
           pthread_mutex_t     lock;               /* Database mutex lock */
     + #endif
           pthread_t           sliv_task1_h;       /* Server liveness task 1 handle */
           pthread_t           sliv_task2_h;       /* Server liveness task 2 handle */
           pthread_cond_t      sliv_task2_cv;      /* Server liveness condition variable used by
                                                      sliv_task1 to send an event to sliv_task2 */
       };
 
Related-file::Added 950606 by wright:: /build/hiosfm/RCS/dce/src/rpc/rpcd/./rpcddb.c,v 7.2
 /build/hiosfm/RCS/dce/src/rpc/rpcd/./rpcddb.c,v 7.2
 wright 1995/06/06 16:45:31 +49 -2
 Reason:  OSDqa11561 rpcd caught in a deadlock
 Enhance db_lock/unlock to avoid having multiple threads spinning for
 long periods (these threads do stuff like fsync while holding the
 lock, and a mutex isn't a good choice for that).
 
     *** /tmp/ci.19523..rpcddb.c.19557.1	Tue Jun  6 12:45:33 1995
     --- /tmp/rpcddb.c.19557.2	Tue Jun  6 12:45:33 1995
     ***************
     *** 667,691 ****
     --- 667,738 ----
        */
       
       PRIVATE void db_lock(h)
       struct db *h;
       {
     + #ifdef hitm
     +     pthread_mutex_lock(&h->lock_a);
     +     while (pthread_mutex_trylock(&h->lock_m) == 0) {
     +         int prev;
     + 
     +         /* callers don't expect that they can be cancelled in here! */
     + 
     +         prev = pthread_setcancel (CANCEL_OFF);
     +         pthread_cond_wait(&h->sleep, &h->lock_a);
     +         (void) pthread_setcancel (prev);
     +     }
     +     pthread_mutex_unlock(&h->lock_a);
     + #else
           pthread_mutex_lock(&h->lock);
     + #endif
       }
       
       PRIVATE void db_unlock(h)
       struct db *h;
       {
     + #ifdef hitm
     +     pthread_mutex_lock(&h->lock_a);
     +     (void)pthread_mutex_unlock(&h->lock_m);
     +     (void)pthread_cond_signal(&h->sleep);
     +     pthread_mutex_unlock(&h->lock_a);
     + #else
           pthread_mutex_unlock(&h->lock);
     + #endif
       }
       
       PRIVATE void db_init_lock(h)
       struct db *h;
       {
     + #ifdef hitm
     +     pthread_mutex_init(&h->lock_a, pthread_mutexattr_default);
     +     pthread_mutex_init(&h->lock_m, pthread_mutexattr_default);
     +     pthread_cond_init(&h->sleep, pthread_condattr_default);
     + #else
           pthread_mutex_init(&h->lock, pthread_mutexattr_default);
     + #endif
     + }
     + #ifdef hitm
     + void
     + db_timedwait(pthread_cond_t *c, struct db *h, struct timespec *waketime)
     + {
     +     pthread_mutex_lock(&h->lock_a);
     +     pthread_mutex_unlock(&h->lock_m);
     +     pthread_cond_signal(&h->sleep);
     +     pthread_cond_timedwait(c, &h->lock_a, waketime);
     + 
     +     pthread_mutex_unlock(&h->lock_a);
     +     db_lock(h);
       }
       
     + void
     + db_cond_signal(pthread_cond_t *c, struct db *h)
     + {
     +     pthread_mutex_lock(&h->lock_a);
     +     pthread_cond_signal(c);
     +     pthread_mutex_unlock(&h->lock_a);
     + }
     + #endif
       
       /*  Map dsm error codes to ept error codes
        */
       PRIVATE void db_to_ept_ecode(status)
       error_status_t  *status;
 
Related-file::Added 950606 by wright:: /build/hiosfm/RCS/dce/src/rpc/rpcd/./rpcdsliv.c,v 7.3
 /build/hiosfm/RCS/dce/src/rpc/rpcd/./rpcdsliv.c,v 7.3
 wright 1995/06/06 16:46:45 +10 -3
 Reason:  OSDqa11561 rpcd caught in a deadlock
 Use new db_cond_signal and db_timedwait procedures, to integrate
 with revised db_lock functionality.
 
     *** /tmp/ci.19578..rpcdsliv.c.19613.1	Tue Jun  6 12:46:46 1995
     --- /tmp/rpcdsliv.c.19613.2	Tue Jun  6 12:46:46 1995
     ***************
     *** 259,269 ****
     --- 259,273 ----
       #endif
       
                       if (!server_listening)
                       {
                           entp->ncomm_fails++;
     + #ifdef hitm
     +                     db_cond_signal(&h->sliv_task2_cv, h);
     + #else
                           pthread_cond_signal(&h->sliv_task2_cv);
     + #endif
                       }
                   }
       
               }   /* end entry list loop */
       
     ***************
     *** 307,318 ****
                   waketime.tv_sec = now.tv_sec + waitsecs + 1;
                   waketime.tv_nsec = 0;
           
                   /*  release lock and wait for task2 event or timeout or cancel
                    */
                   pthread_cond_timedwait(&h->sliv_task2_cv, &h->lock, &waketime);
     !     
                   /*  have lock now
                    */
           
       #ifdef SNI_SVR4
                   gettimeofday(&now);
     --- 311,325 ----
                   waketime.tv_sec = now.tv_sec + waitsecs + 1;
                   waketime.tv_nsec = 0;
           
                   /*  release lock and wait for task2 event or timeout or cancel
                    */
     + #ifdef hitm
     +             db_timedwait(&h->sliv_task2_cv, h, &waketime);
     + #else
                   pthread_cond_timedwait(&h->sliv_task2_cv, &h->lock, &waketime);
     ! #endif    
                   /*  have lock now
                    */
           
       #ifdef SNI_SVR4
                   gettimeofday(&now);
 
Related-file::Added 950606 by wright:: /build/hiosfm/RCS/dce/src/rpc/rpcd/./dsm.c,v 7.2
 /build/hiosfm/RCS/dce/src/rpc/rpcd/./dsm.c,v 7.2
 wright 1995/06/06 16:48:27 +13 -5
 Reason:  OSDqa11561 rpcd caught in a deadlock
 In grow_file, if write fails, be sure to clean up dangling pointer
 at end of map chain.
 
     *** /tmp/ci.19634..dsm.c.19669.1	Tue Jun  6 12:48:29 1995
     --- /tmp/dsm.c.19669.2	Tue Jun  6 12:48:29 1995
     ***************
     *** 1098,1112 ****
       {
           unsigned long       grow_pages,grow_bytes;  /* number of pages, bytes to grow */
           block_t            *p = NULL;               /* new header */
           file_map_t         *map = NULL;             /* file map entry */
           long                flen;[tatsu_s 2/5/96 public]

I'm cancelling this because rpcd is not supported any more. Also, dce1.2.1
dced can be started as "rpcd".



CR Number                     : 12920
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : unix utils
Short Description             : su exits when dce is unavailable
Reported Date                 : 6/15/95
Found in Baseline             : 1.1
Found Date                    : 6/15/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/15/95 public]

 The su utility exits when DCE security services are unavailable. Any
 exceptions raised by sec_login calls are not caught resulting in
 a core dump. A more desirable behavior would be to continue allowing 
 standalone access if any, and unauthenticated DCE access.
 
 Customer report included below.

>From osd.dce@hi.com Thu Jun  8 09:24:20 1995
Received: from loki.hi.com (loki.Hi.COM [140.243.30.55]) by postman.osf.org (8.6.9/8.6.x) with SMTP
	id JAA01549 for <dce-defect@osf.org>; Thu, 8 Jun 1995 09:24:16 -0400
Received: from OSDpts.hi.com by loki.hi.com (4.1/SMI-4.1.hi-2)
	id AA17364; Thu, 8 Jun 95 09:28:10 EDT
From: osd.dce@hi.com (DCE Defect)
Received: by OSDpts.hi.com (1.38.193.4/Spike-2.0)
	id AA01326; Thu, 8 Jun 1995 09:31:22 -0400
Date: Thu, 8 Jun 1995 09:31:22 -0400
Message-Id: <9506081331.AA01326@OSDpts.hi.com>
To: dce-defect@osf.org

                          DCE Problem Report
                  =================================


Submitter Information 
- ----------------------

Submitter Name:           wright
Organization:             Hitachi Computer Products (America), Inc. 
Email Address:            osd.dce@hi.com wright@hi.com 
Phone:                    617-890-0444 
DCE License Number:       1616-MDCE-92
Licensee's Defect Number: OSDqa11704


Hardware/Software Configuration
- --------------------------------

Offering and Version:   DCER1.0 
Component (Module):     su.c 
Client Hardware:        see below 
Client Software:        see below 
Server Hardware:        see below 
Server Software:        see below 
Compiler:               n/a

Problem Description
- --------------------

Severity Level: Severe

Date of First Occurrence: 05/31/95

One Line Description:
   OSDqa11704 su gets unhandled exception when DCE services are unavailable

Full Description:

Related-file:::: Problem
 DESCRIPTION:
 The DCE integrated version of su gets an unhandled exception when DCE
 services are unavailable.
 
 REPRODUCIBLE: Yes
 
 TEST SOFTWARE DESCRIPTION: 
 # su
 DCE services appear unavailable. Reverting to underlying system. 
 Unhandled exception; exiting!
 
 DESCRIPTION OF HARDWARE WHERE BUG OCCURRED: Hitachi Mainframe VM - sybil (DCE Central Master)
 
 DESCRIPTION OF WHERE TEST SUCCESSFULLY RAN: 
 					Same, when DCE services are available
Related-file::Added 950602 by wright:: /build/hiosfm/RCS/dce/src/security/client/unix_utils/su/./su.c,v 7.13
 /build/hiosfm/RCS/dce/src/security/client/unix_utils/su/./su.c,v 7.13
 wright 1995/06/02 18:38:14 +18 -3
 Reason:  OSDqa11704 su gets unhandled exception when DCE services are unavailable
 Copied changes from similar bug fix to login -- set TRY clause around
 calls to catch any exceptions.
 
     *** /tmp/ci.16800..su.c.16834.1	Fri Jun  2 14:38:16 1995
     --- /tmp/su.c.16834.2	Fri Jun  2 14:38:16 1995
     ***************
     *** 139,162 ****
       		    SEC_LOGIN_VALID_AND_CERT_IDENT};
       
       void setup_identity(void *arg)
       {
       
     ! 	 sec_login_setup_identity((uchar *)user, sec_login_no_flags,
       					&sec_login_handle, &st); 
       	pthread_cond_signal(&dce_cv);
       }
       void get_pwent(void *arg)
       {
       	sec_login_get_pwent(sec_login_handle, (sec_login_passwd_t *)&pwd, &st);
       	pthread_cond_signal(&dce_cv);
       }
       void valid_and_cert_ident(void *arg)
       {
               rval = !sec_login_valid_and_cert_ident(sec_login_handle,
                              &prec, &reset_passwd, &auth_src, &st);
       	pthread_cond_signal(&dce_cv);
       }
       
       void
       call_dce_routine(unsigned long routine_id, int care)
       {
     --- 139,177 ----
       		    SEC_LOGIN_VALID_AND_CERT_IDENT};
       
       void setup_identity(void *arg)
       {
       
     !     TRY {
     ! 	sec_login_setup_identity((uchar *)user, sec_login_no_flags,
       					&sec_login_handle, &st); 
       	pthread_cond_signal(&dce_cv);
     +     } CATCH_ALL  {
     + 	pthread_cond_signal(&dce_cv);
     +     }
     +     ENDTRY
       }
       void get_pwent(void *arg)
       {
     +     TRY {
       	sec_login_get_pwent(sec_login_handle, (sec_login_passwd_t *)&pwd, &st);
       	pthread_cond_signal(&dce_cv);
     +     } CATCH_ALL {
     + 	pthread_cond_signal(&dce_cv);
     +     }
     +     ENDTRY
       }
       void valid_and_cert_ident(void *arg)
       {
     +     TRY {
               rval = !sec_login_valid_and_cert_ident(sec_login_handle,
                              &prec, &reset_passwd, &auth_src, &st);
       	pthread_cond_signal(&dce_cv);
     +     } CATCH_ALL {
     + 	pthread_cond_signal(&dce_cv);
     +     }
     +     ENDTRY
       }
       
       void
       call_dce_routine(unsigned long routine_id, int care)
       {
 
Related-file:::: Resolution 
 DESCRIPTION OF BUG FIX:  Copied a fix from login.c for the same
 symptoms; surround sec_login_* routines with TRY/CATCH_ALL.
  
  
 REGRESSION TEST SCENARIO:
  
  
 RCSDIFFS (either inserted manually or via Fci):
 


------- End of Forwarded Message

[6/16/95 public]
This is not a problem on HPUX, RIOS, OSF/1.  The sec_login calls should not
be raising exceptions on error, they should just be returning errors (and
they do, on the reference platforms).  Hitachi should investigate why they
are getting an exception in this case, not just trap it and ignore it...

[3/11/96 public]
Hmm, no reply to the above from the OSF or Hitachi in 9 months now...
The sec_login calls do not raise exceptions when secd is unavailable on the
reference platforms.  To top that off, 'su' is not a supported component of
the OSF DCE reference platform (it's example code, never built, never tested).
Given these facts, I'm cancelling this defect as not a problem with the
reference source.  It looks like it's a Hitachi platform problem.



CR Number                     : 12913
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : 
Short Description             : testing ot reporting
Reported Date                 : 
Found in Baseline             : 1.0
Found Date                    : 
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/14/95 public]
just a quick test -- please ignore



CR Number                     : 12906
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dced dcdre1003 test and creating security replications only fails on IBM platform with all of DCE 1.1 including WP.  the command is:  dcecp /tet/dced/ts/dcdre1003/dcdre1003_acl.tcl /.:/hosts/ibm13/tmp/dcdrelacl.i .  Tests runs fine on local test sources on the igm in a cell with another IBM.  Since the dcecp is takingf the sam tcl via an rshsp just as before, I don't see how this could be a test problem
Reported Date                 : 06/06/96
Found in Baseline             : 1.1
Found Date                    : 06/06/96
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[01/01/93 public]
[Shirley Conley 6/7/95 public]

[2/2/96 public]

   From the submitter:

        Hi Jim, Shirley:

        The security replication testing succeeded on the last run - with the Mothra
        merge in of security, dcecp, etc.

        So, this should be closed.

        -D

   Once the full software set was installed, the tests passed.



CR Number                     : 12905
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : memory leak from not freeing data buffer
Reported Date                 : 6/6/95
Found in Baseline             : 1.1
Found Date                    : 6/6/95
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[01/01/93 public]
[David Stephenson 6/7/95 public]

[2/5/96 public]

I'm cancelling this because it's empty. Please resubmit it if necessary.



CR Number                     : 12870
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : test
Short Description             : testing create
Reported Date                 : 
Found in Baseline             : 1.1
Found Date                    : 
Severity                      : B
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/16/95 public]
this is a silly little test



CR Number                     : 12869
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : test
Short Description             : testing create
Reported Date                 : 
Found in Baseline             : 1.1
Found Date                    : 
Severity                      : B
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/16/95 public]
this is a silly little test

[05/15/95 public]
testing www create interface; cancelled.



CR Number                     : 12839
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : acl
Short Description             : inconsistant acl include files
Reported Date                 : 4/11/95
Found in Baseline             : 1.1
Found Date                    : 4/11/95
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/25/96 public]

Cannot reproduce this problem with R1.2.2.  Not part of dfs testing has
encountered this problem.


Transarc Deltas                      [text]: 
Transarc Status                      [text]:

[4/11/95 public]
Report from cutosmer:
     1. symptom of bug
            EINVAL is returned when afs_syscall(AFSCALL_VNODE_OPS,
     VNX_OPCODE_GETACL,...) is called.
     2. cause
            In the application world, afs_syscall() refers to 
     dce/aclbase.h, while it refers to dcedfs/dacl.h in the processing
     world of the DFS kernel.  Since the actual values of (A) and (B)
     shown below do not match, EINVAL is returned to the processing for
     the ACL entry in (A).
     (1) contents of dce/aclbase.h (a header referred by an application)
	     typedef enum {sec_acl_e_type_user_obj,  /*  0 */
	     sec_acl_e_type_group_obj,               /*  1 */ 
	     sec_acl_e_type_other_obj,               /*  2 */
	     sec_acl_e_type_user,                    /*  3 */
	     sec_acl_e_type_group,                   /*  4 */
	     sec_acl_e_type_mask_obj,                /*  5 */
	     sec_acl_e_type_foreign_user,            /*  6 */   ------
	     sec_acl_e_type_foreign_group,           /*  7 */        |
	     sec_acl_e_type_foreign_other,           /*  8 */        | (A)
	     sec_acl_e_type_unauthenticated,         /*  9 */        |
	     sec_acl_e_type_extended,                /* 10 */        |
	     sec_acl_e_type_any_other                /* 11 */   ------
		     :
	     } sec_acl_entry_type_t;
     (2) contents of "dcedfs/dacl.h" (a header referred by the DFS kernel)
	     typedef u_int32 dacl_entry_type_t;
	     #define dacl_entry_type_user_obj        0
	     #define dacl_entry_type_group_obj       1
	     #define dacl_entry_type_other_obj       2
	     #define dacl_entry_type_user            3
	     #define dacl_entry_type_group           4
	     #define dacl_entry_type_mask_obj        5
	     /*                                             -------
	     #define dacl_entry_type_class_group     5            |
	     #define dacl_entry_type_class_owner     6            |
	     #define dacl_entry_type_class_other     7            |
	     */                                                   |
	     #define dacl_entry_type_foreign_user    8            | (B)
	     #define dacl_entry_type_foreign_group   9            |
	     #define dacl_entry_type_foreign_other   10           |
	     #define dacl_entry_type_unauth          11           |
	     #define dacl_entry_type_extended        12           |
	     #define dacl_entry_type_anyother        13     -------

[1/24/96 public]
The cause described above has no relation to the symptom you are
seeing.  Nowhere in the getacl syscall, do you indicated type of entry
you are desiring to look at. What you do specify is
which ACL you want object or IO or IC acl.  For the afs syscall, you
need to use one of the following defined in src/file/sysacl/aclint.h:
#define VNX_ACL_REGULAR_ACL	0	/* regular */
#define VNX_ACL_DEFAULT_ACL	1	/* default for (sub)directories */
#define VNX_ACL_INITIAL_ACL	2	/* default for (sub)files */
You get the whole acl in *DFS ACL format*, not in the DCE security ACL
format.  Why, You do not want to do ACL format conversions in kernel
space.
You do not make it clear the end objective you are seeking. Taking a
reasonable guess, if you desire to use the system call to get the DFS
acl and use it in application program that understands the DCE
security acl format, you need to convert the DFS acl to the DCE acl
format on the getacl and viceversa on the setacl. There are two
functions in the src/file/security/dacl/dacl_sec_acl.c that will do
this for you sec_acl_ParseAcl to convert DFS acl to DCE acl and
sec_acl_FlattenAcl for the reverse.
Hope this helps
Added field Transarc Deltas with value `' 
Added field Transarc Status with value `'



CR Number                     : 12829
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : 
Short Description             : Testing
Reported Date                 : 3/29/95
Found in Baseline             : 1.1
Found Date                    : 3/29/95
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/29/95 public]
Testing.



CR Number                     : 12824
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : sec_acl_get_manager_types
Short Description             : sec_acl_get_manager_types fails with status sec_acl_object_not_found
Reported Date                 : 3/27/95
Found in Baseline             : 1.1
Found Date                    : 3/27/95
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/27/95 public]

Customer submitted following bug report:
---------------------------------------
  Problem 	: sec_acl_get_manager_types() fails with status
  "sec_acl_object_not_found" on the entry /.:/subsys/dce/sec/master/principal/flintstone.
  Status	: Open
  Reported date	: 3/20/95
  Reported by	: Ash Nangia, Tandem, Austin
  Problem area	: DCE1.1 Security
  Environment   : SVR4
  Description 	:
  
  	The call sec_acl_get_manager_types() fails on the entry 
  /.:/subsys/dce/sec/master/principal/flintstone with the status
  sec_acl_object_not_found. But the call sec_acl_bind() made previous
  to this call passes successfully (i.e doesn't report object not
  found). The routine sec_acl_get_manager_types() calls
  rdacl_get_manager_types() which returns the above status.
  
  	I started secd in debug and tried to break at
  rdacl_get_manager_types but secd didn't stop at the call. 
  
  	Probable cause of the problem:
  	The other sec_acl calls which are tested, get their acl_handles
  from sec_acl_bind_to_addr() which uses string bindings. On the other
  hand sec_acl_bind uses name space calls to obtain the bindings for
  security service (site name etc). 
  
  Test Case     : Security ACL API tests.

[3/11/96 public]
sec_acl_bind() just gives you a binding to the server where an object is
located, so it is possible for it to return a good status (because it got
a binding) but for subsequent calls to fail (because there was no such obj
available at the bound to server.

It is easy to mess up the flintstone ACL within the secd database, by
prematurely stopping the security tests while they're messing with the
ACLs on the flintstone object (in fact, I've even done it many times in
past years, by mistake), and that would cause the above behavior.

Since these tests run fine on the reference platforms (ie, not reproducable)
and since there's an explanation for all of the behavior described above,
I'm cancelling this defect.



CR Number                     : 12818
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpc/runtime/dds.c
Short Description             : rpc_s_no_memory is returned for getsockname() failure
Reported Date                 : 3/16/95
Found in Baseline             : 1.1
Found Date                    : 3/16/95
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/16/95 public]

In rpc/runtime/dds.c, rpc_s_no_memory is returned when getsockname() fails 
in function desc_inq_addr():

    if (getsockname((int) desc, &dds_addr->sa, &len) < 0)
    {
        RPC_MEM_FREE(dds_addr, rpc_c_mem_rpc_addr);
        RPC_MEM_FREE(vector, rpc_c_mem_rpc_addr_vec);
        *st = rpc_s_no_memory;
        return;
    }

Looks like a cut-and-paste was done and the author forgot to change the error
code.

[2/7/96 public]

Cancelled. dds.c has never be supported.



CR Number                     : 12803
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : 
Short Description             : dce_svc__debug doesn't check for NULL pointers.
Reported Date                 : 2/23/95
Found in Baseline             : 1.1
Found Date                    : 2/23/95
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dce/utils/svc/svcprintf.c
Sensitivity                   : public

[2/23/95 public]

The dce_svc_printf, dce_svc__debug, and dce_svc_bin_log functions do not
check the "handle" parameter to see if it's NULL. SIGSEGV results from this
non-checking if a null pointer is passed.

[02/24/95 public]
That's right.  Neither does fopen, strcpy, etc.  DCE should not be spending
its time looking for NULL pointers -- better to get a quick coredump and
fix the programming error.

[levy 2/25/95 public] 

This problem was actually detected in a core dump of one of the DCE
daemons. The person who reported the problem can not remember which one,
but I am re-opening the OT at least as a record of the problem (there are a
number of open OTs in that category). Besides, there is a long standing
debate about whether or not functions should do argument validation. If you
don't think this is a defect then please leave it as an enhancement.

[02/26/95 public]
Sorry, Marc, but no.

We had this discussion shortly after I joined OSF.  After about a year,
it was decided:  DCE should not waste time or codespace checking for
things like NULL pointers.  I explained how it can actually HURT debugging,
letting a program try to proceed when malloc failed, or an earlier
return code was not checked, or what-have-you.

If you want to open an OT that says little more then "a DCE daemon died"
I suppose you could. :-)



CR Number                     : 12737
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : thr
Subcomponent Name             : 
Short Description             : dce1.1 Unintegrated - pointer_t and byte redefined
Reported Date                 : 10/27/94
Found in Baseline             : 1.1
Found Date                    : 10/27/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/27/94 public]

platform AT486

extract from  file tests.log.10-26-94 in directory
/u1/RAT_tools/1_1unintegratedlogs/nb_unintegrated_486 
on vertigo


/project/dce/build/unintegrated-snap/tools/at386/macho/gcc -B/project/dce/build/
unintegrated-snap/tools/at386/macho/  -c    -D_SHARED_LIBRARIES   -D_BSD     -I.
 -I/u2/devobj/sb/nb_unintegrated_486/src/test/rpc/rtandidl/moretests -I/project/
dce/build/unintegrated-snap/src/test/rpc/rtandidl/moretests   -I/u2/devobj/sb/nb
_unintegrated_486/export/at386/usr/include -I/project/dce/build/unintegrated-sna
p/export/at386/usr/include   -pic-lib   -L/u2/devobj/sb/nb_unintegrated_486/expo
rt/at386/usr/shlib -L/project/dce/build/unintegrated-snap/export/at386/usr/shlib
 -L/usr/shlib -L/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/lib     -L/pr
oject/dce/build/unintegrated-snap/export/at386/usr/lib    -ldce -lm -lbsd   /pro
ject/dce/build/unintegrated-snap/src/test/rpc/rtandidl/moretests/binding_copy.c

/project/dce/build/unintegrated-snap/src/test/rpc/rtandidl/moretests/bindtest.h:
55: redefinition of `pointer_t'
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/dce/dce.h:105: `point
er_t' previously declared here
*** Error code 1

......
......

/project/dce/build/unintegrated-snap/tools/at386/macho/gcc -B/project/dce/build/
unintegrated-snap/tools/at386/macho/  -c    -D_SHARED_LIBRARIES   -D_BSD    -I.
-I/u2/devobj/sb/nb_unintegrated_486/src/test/rpc/idl/cover1 -I/project/dce/build
/unintegrated-snap/src/test/rpc/idl/cover1  -I.. -I/u2/devobj/sb/nb_unintegrated
_486/src/test/rpc/idl -I/project/dce/build/unintegrated-snap/src/test/rpc/idl -I
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include -I/project/dce/build/
unintegrated-snap/export/at386/usr/include   -pic-lib  -L.. -L/u2/devobj/sb/nb_u
nintegrated_486/src/test/rpc/idl -L/project/dce/build/unintegrated-snap/src/test
/rpc/idl -L/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/shlib -L/project/d
ce/build/unintegrated-snap/export/at386/usr/shlib -L/usr/shlib -L/u2/devobj/sb/n
b_unintegrated_486/export/at386/usr/lib     -L/project/dce/build/unintegrated-sn
ap/export/at386/usr/lib    -lidltest -ldce -lm -lbsd   /project/dce/build/uninte
grated-snap/src/test/rpc/idl/cover1/manager.c

/project/dce/build/unintegrated-snap/src/test/rpc/idl/cover1/manager.c:41: redef
inition of `byte'
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/dce/dce.h:151: `byte'
 previously declared here

[10/27/94 public]
I assume this is a result of the threads code submitted.
Reassigning to John and Threads.



CR Number                     : 12728
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : thr
Subcomponent Name             : libdce_1.o
Short Description             : UHYPE:undefined symbols
Reported Date                 : 10/26/94
Found in Baseline             : 1.1
Found Date                    : 10/26/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : threads/Makefile
Sensitivity                   : public

[10/26/94 public]

/project/dce/build/unintegrated-snap/tools/at386/macho/ld -R -export_default libdce:          -L/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/shlib -L/project/dce/build/unintegrated-snap/export/at386/usr/shlib -L/usr/shlib -L/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/lib     -L/project/dce/build/unintegrated-snap/export/at386/usr/lib   -o libdce.so.X libdce_1.o libdce_2.o libdce_3.o libdce_4.o  -lc -lbsd -liconv /project/dce/build/unintegrated-snap/tools/at386/macho/gnulib  
libdce_1.o: Undefined symbol "_cma_send_error" referenced
libdce_1.o: Undefined symbol "_cma_send_errno" referenced
libdce_1.o: Undefined symbol "_cma_send_exception" referenced
libdce_1.o: Undefined symbol "_cma_send_fatal" referenced
libdce_1.o: Undefined symbol "_cma__init_dce_errors" referenced

[10/26/94 public]
Maryanne approved UHYPE status. About to do the submit.

[10/26/94 public]
Submitted the Makefile.

[10/26/94 pubic]
This should have been against threads. It was fixed yesterday.



CR Number                     : 12726
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : krb5/mvr/krb5-glue.h - error 1000: Unexpected symbol: "DcePAKeys"
Reported Date                 : 10/26/94
Found in Baseline             : 1.1
Found Date                    : 10/26/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/26/94 public]
The following build error was found in Unintegrated tree on HP and OSF
platforms. (RIOS build is in progress).

 header file krb5/mvr/krb5-glue.h - error 1000: Unexpected symbol: "DcePAKeys"


on HPUX
extract from file build.log.10-25-94
dirrectory /u1/RAT_tools/1_1unintegratedlogs/nb_unintegrated_ux on vertigo

unset _MAKECONF _MAKEIOD _MAKECWD _MAKEPSD MAKEDIR;  cd /u2/devobj/sb/nb_uninteg
rated_ux/src/security/utils && exec build -r -k -r -r -r  MAKEFILE_PASS=THIRD ex
port_all_EXPSHLIB
relative path: ./security/utils
mkdir ../../../obj/hp800/security/utils
cd ../../../obj/hp800/security/utils

......
.....

c89 -c    -D_SHARED_LIBRARIES  +z  -DOSF_DCE -DDCESHARED_PATH=\"/opt/dce\" -DDCE
LOCAL_PATH=\"/opt/dcelocal\" -D_BSD -DBSD -DPOSIX_FILE_LOCKS -DPOSIX_TERMIOS -D_
_hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -D
unix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/devobj/sb/nb_unintegrated_ux/src/securit
y/utils -I/project/dce/build/unintegrated-snap/src/security/utils  -I../h -I/u2/
devobj/sb/nb_unintegrated_ux/src/security/h -I/project/dce/build/unintegrated-sn
ap/src/security/h -I../idl -I/u2/devobj/sb/nb_unintegrated_ux/src/security/idl -
I/project/dce/build/unintegrated-snap/src/security/idl -I/u2/devobj/sb/nb_uninte
grated_ux/export/hp800/usr/include -I/project/dce/build/unintegrated-snap/export
/hp800/usr/include    /project/dce/build/unintegrated-snap/src/security/utils/pr
iv_krb_util.c
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 157: error 1000: Unexpected symbol: "DcePAKeys".
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 157: error 1573: Type of "m" is undefined.
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 158: error 1000: Unexpected symbol: "*".
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 158: error 1573: Type of "m" is undefined.
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 159: error 1000: Unexpected symbol: "DcePAErrInfo".
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 159: error 1677: Invalid storage class specifier "auto".
"today_bug" 84 lines, 4444 characters
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 159: error 1677: Invalid storage class specifier "auto".
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 159: error 1677: Invalid storage class specifier "auto".
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 160: error 1000: Unexpected symbol: "*".
cc: "/u2/devobj/sb/nb_unintegrated_ux/export/hp800/usr/include/krb5/mvr/krb5-glu
e.h", line 160: error 1573: Type of "m" is undefined.
*** Error code 1


---------------------------------------------------------------------


AT486

extract from file build.log.10-25-94
dirrectory /u1/RAT_tools/1_1unintegratedlogs/nb_unintegrated_486 on vertigo

/project/dce/build/unintegrated-snap/tools/at386/macho/gcc -B/project/dce/build/
unintegrated-snap/tools/at386/macho/  -c    -D_SHARED_LIBRARIES   -DOSF_DCE -DDC
ESHARED_PATH=\"/opt/dce\" -DDCELOCAL_PATH=\"/opt/dcelocal\" -D_BSD -DBSD -DOSF -
DHAS_STDLIB_H -DBERKELEY    -I. -I/u2/devobj/sb/nb_unintegrated_486/src/security
/utils -I/project/dce/build/unintegrated-snap/src/security/utils  -I../h -I/u2/d
evobj/sb/nb_unintegrated_486/src/security/h -I/project/dce/build/unintegrated-sn
ap/src/security/h -I../idl -I/u2/devobj/sb/nb_unintegrated_486/src/security/idl
-I/project/dce/build/unintegrated-snap/src/security/idl -I/u2/devobj/sb/nb_unint
egrated_486/export/at386/usr/include -I/project/dce/build/unintegrated-snap/expo
rt/at386/usr/include   -pic-lib   -L/u2/devobj/sb/nb_unintegrated_486/export/at3
86/usr/shlib -L/project/dce/build/unintegrated-snap/export/at386/usr/shlib -L/us
r/shlib -L/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/lib     -L/project/
dce/build/unintegrated-snap/export/at386/usr/lib       /project/dce/build/uninte
grated-snap/src/security/utils/priv_krb_util.c
In file included from /u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include
/krb5/asn1.h:43, from /project/dce/build/unintegrated-snap/src/security/utils/pr
iv_krb_util.c:52:
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/krb5/mvr/krb5-glue.h:

iv_krb_util.c:52:
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/krb5/mvr/krb5-glue.h:
157: parse error before `DcePAKeys'
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/krb5/mvr/krb5-glue.h:
158: parse error before `*'
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/krb5/mvr/krb5-glue.h:
159: parse error before `DcePAErrInfo'
/u2/devobj/sb/nb_unintegrated_486/export/at386/usr/include/krb5/mvr/krb5-glue.h:
160: parse error before `*'
*** Error code 1

[10/26/94 public]

This is because the build started before my submission was complete, so the build
was done on a partial submission. ;-(

Please try rebuilding security/krb5 and security/utils to see if the errors go away.



CR Number                     : 12715
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : srvrexec
Short Description             : All dced FVT's relating to srvrexec are failing with BL-23
Reported Date                 : 10/24/94
Found in Baseline             : 1.1b23
Found Date                    : 10/24/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/24/94 public]

Not sure if test problem or dced code, needs more investigation.  All
tests passed against NB several weeks ago.  This needs more investigation.
The failing tests include:

  entry_get_next_2
  object_read_2
  object_read_all_2
  server_start_1
  server_disable_if_1

All complaining about the srvrexec object not existing.  Simple hand test
using dcecp shows basic server create/stop/show operations work OK.

[10/25/94 public]
While reproducing problem with all related exe's built with symbols and in
the debugger, my OSF/1 crashed (twice).  Now the problem does not occur
anymore.  So apparently the solution to the problem is to crash your
machine and restart.

I cannot explain why this is the case.  I was thinking we were looking at a
test bug, but there is nothing in the tests which is persistant enough
that a reboot/restart DCE would make a difference.  Also, in the short
debug period before the crash, noticed a number of 'Comm failure' returns
to the tests.

Anyway, I will cancel this for now as it can no longer be reproduced.



CR Number                     : 12706
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : 
Short Description             : dce1.1-Unintegrated - Could not find osf.rules.mk
Reported Date                 : 10/22/94
Found in Baseline             : 1.1
Found Date                    : 10/22/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/22/94 public]

Platform AT486 
Nightly build failed with following errors:

Extract from build.log.10-21-94

[ /security/audit at 20:01 (PM) Friday ]
makepath audit/. && cd audit &&  exec make MAKEFILE_PASS=FIRST     build_all
"/project/dce/build/unintegrated-snap/src/security/audit/Makefile", line 48: Cou
l
d not find osf.rules.mk
Fatal errors encountered -- cannot continue
*** Error code 1

[10/22/94 public]
Yesterday, this problem was seen even though no new files were submitted.
Today the build is clean.  I am cancelling this OT.



CR Number                     : 12705
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : dce1.1-Unintegrated rpc.mk - Malformed conditional (${TARGET_OS} == "HPUX")
Reported Date                 : 10/22/94
Found in Baseline             : 1.1
Found Date                    : 10/22/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/22/94 public]


Platform - HPUX - dce1.1 unintegrated
Nightly build failed with following error:

Extracted from

[ /rpc/kdes at 20:05 (PM) Friday ]
makepath kdes/. && cd kdes &&  exec make MAKEFILE_PASS=THIRD     build_all
kdes: created directory
"/project/dce/build/unintegrated-snap/src/rpc/rpc.mk", line 352: Malformed condi
tional (${TARGET_OS} == "OSF1")
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 660: Malforme
d conditional (${TARGET_OS} == "HPUX")
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 1246: if-less
 endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 1246: ".endif
" unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.lib.mk", line 91: Malformed
 conditional (${TARGET_OS} != "HPUX")
sh: HPUX: not found
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.lib.mk", line 91: ""HPUX""
returned non-zero
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.lib.mk", line 92: Unassocia
ted shell command "${_RANLIB_} ${.TARGE"
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.obj.mk", line 136: Malforme
d conditional (${TARGET_OS} == "HPUX")
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 57: if-less
 endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 57: ".endif
" unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 70: if-less
 endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 70: ".endif
" unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 72: if-less
 endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 72: ".endif
" unrecognized input
Fatal errors encountered -- cannot continue
*** Error code 1
`build_all' not remade because of errors.
*** Error code 1
[ /dce/utils/svc at 20:05 (PM) Friday ]
makepath dce/utils/svc/. && cd dce/utils/svc &&  exec make MAKEFILE_PASS=THIRD
   build_all
make: don't know how to make build_all (continuing)
[ /dce/utils/dcecf at 20:05 (PM) Friday ]
makepath dce/utils/dcecf/. && cd dce/utils/dcecf &&  exec make MAKEFILE_PASS=THI
RD     build_all
make: don't know how to make build_all (continuing)
[ /config at 20:05 (PM) Friday ]
makepath config/. && cd config &&  exec make MAKEFILE_PASS=THIRD     build_all
make: don't know how to make build_all (continuing)
[ /time at 20:05 (PM) Friday ]
makepath time/. && cd time &&  exec make MAKEFILE_PASS=THIRD     build_all
"/project/dce/build/unintegrated-snap/src/time/time.mk", line 198: Malformed con
ditional (${TARGET_OS}=="OSF1")
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.dce.mk", line 348: Malforme
d conditional (${TARGET_OS} != "HPUX")
sh: HPUX: not found
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.dce.mk", line 348: ""HPUX""
 returned non-zero
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 660: Malforme
d conditional (${TARGET_OS} == "HPUX")
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 662: if-less
else
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 662: ".else"
unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 666: if-less
endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 666: ".endif"
 unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 666: if-less
endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 666: ".endif"
 unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 1246: if-less
 endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.std.mk", line 1246: ".endif
" unrecognized input
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 72: if-less
 endif
"/project/dce/build/unintegrated-snap/src/lbe/mk/osf.rules.mk", line 72: ".endif
" unrecognized input
Fatal errors encountered -- cannot continue
*** Error code 1

[10/22/94 public]
Yesterday the problem had shown even though no new files were submitted.
The build is clean today.  I am cancelling the OT.



CR Number                     : 12703
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : passwd_export does not open /etc/ptmp correctly
Reported Date                 : 10/21/94
Found in Baseline             : 1.1b22
Found Date                    : 10/21/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : src/security/client/admin/passwd_export/passwd_export.c
Sensitivity                   : public

[10/21/94 public]

According to the X/Open standards when the O_CREAT and O_EXCL flags are set
an open is unsuccesful when the file exists. When I was running the
group override test on AIX this error was occuring when passwd_export was
trying to open /etc/ptmp. This is occuring in the function make_files.

Why is this only occuring on AIX?

[01/30/95 public]
Correct, that's why it tries to open it this way, to make sure that no
other passwd_export or vipw or whatever is updating the passwd and/or
group files at the moment.  You must have had an old ptmp file hanging
around from something else going away...  I'm cancelling this because
it's working as intended.  Note there is another defect open against
the group override stuff because there's a bug in dced.



CR Number                     : 12696
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 12061
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp server test fails
Reported Date                 : 10/21/94
Found in Baseline             : 1.1b22, 1.2
Found Date                    : 10/21/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/21/94 public]

The following errors were found in the journal file:

...
520|0 1 14481 1 55|server_disable_7_N: Check that wrong interface id are returne
d as not found.
520|0 1 14481 1 56|==== Contents of test case:
520|0 1 14481 1 57|{         list [catch {server disable tserver -interface {002
972f0-44f7-1de6-817f-0000c0ba4944,1.0}} msg] $msg     }
520|0 1 14481 1 58|Test completed successfully.
520|0 1 14481 1 59|== Test output was:
520|0 1 14481 1 60|{1 {Cannot find a matching object.}}
520|0 1 14481 1 61|== Expected output was:
520|0 1 14481 1 62|{1 {not found interface id}}
520|0 1 14481 1 63|Test Failed.
220|0 1 1 18:38:33|FAIL
...
520|0 1 9715 1 55|server_enable_7_N: Check that wrong interface id are returned
as not found.
520|0 1 9715 1 56|==== Contents of test case:
520|0 1 9715 1 57|{     list [catch {server enable tserver -interface {002972f0-
44f7-1de6-817f-0000c0ba4944,1.0}} msg] $msg     }
520|0 1 9715 1 58|Test completed successfully.
520|0 1 9715 1 59|== Test output was:
520|0 1 9715 1 60|{1 {Cannot find a matching object.}}
520|0 1 9715 1 61|== Expected output was:
520|0 1 9715 1 62|{1 {not found interface id}}
520|0 1 9715 1 63|Test Failed.
220|0 1 1 18:39:54|FAIL
...
520|0 1 14534 1 1|server_disable_8_P: Check to see that we can disable server in
terfacces.
520|0 1 14534 1 2|==== Contents of test case:
520|0 1 14534 1 3|{     list [catch {server disable tserver -interface {008bebed
-c7c1-1ddc-9cb3-0000c0ba4944,1.0}} msg] $msg     }
520|0 1 14534 1 4|Test completed successfully.
520|0 1 14534 1 5|== Test output was:
520|0 1 14534 1 6|{0 {}}
520|0 1 14534 1 7|== Expected output was:
520|0 1 14534 1 8|{0 {}}
520|0 1 14534 1 9|Test Passed.
520|0 1 14534 1 10|==== Contents of test case:
520|0 1 14534 1 11|{    list [catch {server ping $DCP_SR_ENTRYNAME} msg] $msg
  }
520|0 1 14534 1 12|Test completed successfully.
520|0 1 14534 1 13|== Test output was:
520|0 1 14534 1 14|{0 1}
520|0 1 14534 1 15|== Expected output was:
520|0 1 14534 1 16|{0 0}
520|0 1 14534 1 17|Test Failed.
220|0 1 1 18:44:33|FAIL
...
520|0 1 9726 1 1|server_enable_8_P: Check to see that we can enable server inter
facces.
520|0 1 9726 1 2|==== Contents of test case:
520|0 1 9726 1 3|{         list [catch {server ping $DCP_SR_ENTRYNAME} msg] $msg
     }
520|0 1 9726 1 4|Test completed successfully.
520|0 1 9726 1 5|== Test output was:
520|0 1 9726 1 6|{0 1}
520|0 1 9726 1 7|== Expected output was:
520|0 1 9726 1 8|{0 0}
520|0 1 9726 1 9|Test Failed.
520|0 1 9726 1 10|==== Contents of test case:
520|0 1 9726 1 11|{     list [catch {server enable tserver -interface {008bebed-
c7c1-1ddc-9cb3-0000c0ba4944,1.0}} msg] $msg     }
520|0 1 9726 1 12|Test completed successfully.
520|0 1 9726 1 13|== Test output was:
520|0 1 9726 1 14|{0 {}}
520|0 1 9726 1 15|== Expected output was:
520|0 1 9726 1 16|{0 {}}
520|0 1 9726 1 17|Test Passed.
520|0 1 9726 1 18|==== Contents of test case:
520|0 1 9726 1 19|{         list [catch {server ping $DCP_SR_ENTRYNAME} msg] $ms
g     }
520|0 1 9726 1 20|Test completed successfully.
520|0 1 9726 1 21|== Test output was:
520|0 1 9726 1 22|{0 1}
520|0 1 9726 1 23|== Expected output was:
520|0 1 9726 1 24|{0 1}
520|0 1 9726 1 25|Test Passed.
220|0 1 1 18:44:57|FAIL
...
520|0 1 14466 1 28|server_ping_8_P: Check to see that we cannot ping a server wh
o is not listening by its string binding.
520|0 1 14466 1 29|==== Contents of test case:
520|0 1 14466 1 30|{    list [catch "server ping 0073f23a-2e1a-1ddd-b73a-0000c0b
a4944@$DCP_SR_PROTSEQ:$DCP_SR_IP_ADDR" msg] $msg     }
520|0 1 14466 1 31|Test completed successfully.
520|0 1 14466 1 32|== Test output was:
520|0 1 14466 1 33|{0 1}
520|0 1 14466 1 34|== Expected output was:
520|0 1 14466 1 35|{0 0}
520|0 1 14466 1 36|Test Failed.
220|0 1 1 18:46:10|FAIL
...
520|0 1 18248 1 1|server_stop_7_P: Check to see that we can stop server by metho
d rpc
520|0 1 18248 1 2|==== Contents of test case:
520|0 1 18248 1 3|{     list [catch {server stop tserver -method rpc} msg] $msg
    }
520|0 1 18248 1 4|Test completed successfully.
520|0 1 18248 1 5|== Test output was:
520|0 1 18248 1 6|{0 {}}
520|0 1 18248 1 7|== Expected output was:
520|0 1 18248 1 8|{0 {}}
520|0 1 18248 1 9|Test Passed.
520|0 1 18248 1 10|==== Contents of test case:
520|0 1 18248 1 11|{    list [catch {server ping 0073f23a-2e1a-1ddd-b73a-0000c0b
a4944@$DCP_SR_PROTSEQ:$DCP_SR_IP_ADDR} msg] $msg     }
520|0 1 18248 1 12|Test completed successfully.
520|0 1 18248 1 13|== Test output was:
520|0 1 18248 1 14|{0 1}
520|0 1 18248 1 15|== Expected output was:
520|0 1 18248 1 16|{0 0}
520|0 1 18248 1 17|Test Failed.
220|0 1 1 18:47:33|FAIL

[10/21/94 public]
Okay, all these failures are known and expected. The blocking ot 
is CR12061.

[04/26/95 public]
The problem of getting "Cannot find a matching object." instead of
"not found interface id" has nothing to do with CR12061.  In fact, there
is no error message with the text "not found interface id" in dhd.sams,
or in ANY sams file in the source tree.  dced (in sxops.c) explicitly returns
dced_s_not_found when it fails to find the specified interface.
	So, this is either a problem with just the test (for expecting
"not found interface id") or a problem with both the code (dhd.sams) and the
documentation (Problem Determination Guide) for not providing and documenting
the more appropriate error message (personally, I would prefer the message
"Cannot find a matching interface", which would make this a problem with
all three).

[04/26/95 public]

The failure of server_stop_7_P is due to incompletenesses in the tests and
in tserver.c.  To wit; tserver must log in before the security code on the
server side will honor an rpc_mgmt_stop_server_listening() RPC call; and
tserver.c does not log in.  Of course, the Tcl scripts must also change --
in order for tserver to log in, the Tcl scripts have to create the principal,
add it to the none group and org, create the account, and add a keytab entry
for it -- and of course to remove all these things when cleaning up.  Diffs
for tserver.c and server_stop_P.tcl follow; these other Tcl files are also
affected, because once tserver.c has the login code, the account creation
etc. must be done by ANY Tcl script that tries to start tserver;

        server_enable_N.tcl
	server_start_P.tcl
	server_enable_P.tcl
	server_stop_N.tcl
	server_catalog_P.tcl
	server_ping_P.tcl
	server_disable_N.tcl
	server_show_P.tcl
	server_disable_P.tcl
	server_start_N.tcl

--------------------- Begin Diffs for tserver.c -----------------------------

40a41,42
> #include <dce/sec_login.h>
> #include <dce/keymgmt.h>
60a63,71
> boolean32    our_auth_fn(
>               rpc_binding_handle_t client_binding,           /* in  */
>               unsigned32           requested_mgmt_operation, /* in  */
>               unsigned32           *status                   /* out */
> ) {
>       *status = rpc_s_ok;
>       return( TRUE );         /* allow anyone to call any mgmt function */
> }
>
70a82,85
>       sec_login_handle_t              context;
>       sec_passwd_rec_t                *mypasswd;
>       boolean32                       expired;
>       sec_login_auth_src_t            auth_src;
116a132,192
>        * Set up our security context.
>        */
>       sec_login_setup_identity(
>           SERVER_PRINC_NAME,
>           sec_login_no_flags,
>           &context,
>           &status
>       );
>       if (status != rpc_s_ok) {
>               print_error("sec_login_setup_identity()", status);
>               exit(1);
>       }
>
>       sec_key_mgmt_get_key(
>           rpc_c_authn_dce_secret,
>           NULL,
>           SERVER_PRINC_NAME,
>           sec_c_key_version_none,
>           &mypasswd,
>           &status
>       );
>       if (status != rpc_s_ok) {
>               print_error("sec_key_mgmt_get_key()", status);
>               exit(1);
>       }
>
>       sec_login_validate_identity(
>           context,
>           mypasswd,
>           &expired,
>           &auth_src,
>           &status
>       );
>       if (status != rpc_s_ok) {
>               print_error("sec_login_validate_identity()", status);
>               exit(1);
>       }
>       if (expired) {
>               print_error("password expired", status);
>               exit(1);
>       }
>
>       sec_login_certify_identity(
>           context,
>           &status
>       );
>       if (status != rpc_s_ok) {
>               print_error("sec_login_certify_identity()", status);
>               exit(1);
>       }
>
>       sec_login_set_context(
>           context,
>           &status
>       );
>       if (status != rpc_s_ok) {
>               print_error("sec_login_set_context()", status);
>               exit(1);
>       }
>
>       /*
117a194
>        */
127d203
<        */
141a218,219
>       /* We don't need to export binding info -- dced has done it for us! */
>
143c221,228
<        * Export binding info to the namespace
---
>        * Set up authorizing function so that dced may use
>        * rpc_mgmt_stop_server_listening() to stop this server
>        * (see rpc_mgmt_set_authorization_fn(3rpc) and
>        * rpc_mgmt_stop_server_listening(3rpc) -- note that
>        * a server MUST call rpc_mgmt_set_authorization_fn()
>        * to get behaviour other than the default, and that the
>        * default behaviour is to disallow rpc_mgmt_stop_server_listen()
>        * from ANY client).
145,150c230,233
<       rpc_ns_binding_export(rpc_c_ns_syntax_dce,
<                             (unsigned_char_t *) argv[1],
<                             tserver_v1_0_s_ifspec,
<                             bind_vector_p,
<                             (uuid_vector_t *) &obj_uuid_vec,
<                             &status);
---
>       rpc_mgmt_set_authorization_fn(
>           our_auth_fn,
>           &status
>       );
152c235
<               print_error("rpc_ns_binding_export()", status);
---
>               print_error("rpc_mgmt_set_authorization_fn()", status);

--------------------- End   Diffs for tserver.c -----------------------------

--------------------- Begin Diffs for server_stop_P.tcl ---------------------

49c49
<            DCP_SR_PROTSEQ DCP_SR_IP_ADDR
---
>            DCP_SR_PROTSEQ DCP_SR_IP_ADDR DCP_HOSTNAME_ONE
52a53,57
>     if {[dcp_wrap {principal create tserver}] != 0} {return;}
>     if {[dcp_wrap {group add none -member tserver}] != 0} {return;}
>     if {[dcp_wrap {organization add none -member tserver}] != 0} {return;}
>     if {[dcp_wrap "account create tserver -group none -organization none -mypw
d $DCP_CLIENT_PW -password foobar"] != 0} {return;}
>     if {[dcp_wrap "keytab add /.:/hosts/$DCP_HOSTNAME_ONE/config/keytab/self -
member tserver -version 1 -key foobar"] != 0} {return;}
57a63,64
>     global DCP_HOSTNAME_ONE
>
58a66,70
>     if {[dcp_wrap "keytab remove /.:/hosts/$DCP_HOSTNAME_ONE/config/keytab/sel
f -member tserver"] != 0} {return;}
>     if {[dcp_wrap "account delete tserver"] != 0} {return;}
>     if {[dcp_wrap {organization remove none -member tserver}] != 0} {return;}
>     if {[dcp_wrap {group remove none -member tserver}] != 0} {return;}
>     if {[dcp_wrap {principal delete tserver}] != 0} {return;}
71a84
>     exec sleep 20
83c96
<     if {[dcp_wrap {server stop tserver -method hard}] != 0} {return;}
---
>     catch {server stop tserver -method hard} dontcare

--------------------- End   Diffs for server_stop_P.tcl ---------------------

	Note that .../config/keytab/self can be used because tserver is run
non-SUID as a child of dced, which runs as root, and hence tserver can read
the system default keytable.  Also note the last change to server_stop_P.tcl;
since (if it works) the test has already stopped tserver via rpc, the
server stop in the cleanup code should be allowed to fail.

[04/26/95 public]

Oops.  I guess tserver does have to export its bindings to the namespace
after all -- I had thought that dced would do this for it.  The register
and export have to be done BEFORE the login, while the server is still running
as root; after the login, it won't have permission for namespace operations.
So here are some diffs on top of the last set; the line numbers are a little
off, but close enough.

--------------------- Begin Diffs for tserver.c -----------------------------

139a140,166
>        * Register binding info with endpoint map
>        */
>       rpc_ep_register(tserver_v1_0_s_ifspec,
>                       bind_vector_p,
>                       (uuid_vector_t *) &obj_uuid_vec,
>                       (unsigned_char_t *) "test  server of dcecp server obj",
>                       &status);
>       if (status != rpc_s_ok) {
>               print_error("rpc_ep_register()", status);
>               exit(1);
>       }
>
>       /*
>        * Export binding info to the namespace.
>        */
>       rpc_ns_binding_export(rpc_c_ns_syntax_dce,
>                             (unsigned_char_t *) argv[1],
>                             tserver_v1_0_s_ifspec,
>                             bind_vector_p,
>                             (uuid_vector_t *) &obj_uuid_vec,
>                             &status);
>       if (status != rpc_s_ok) {
>               print_error("rpc_ns_binding_export()", status);
>               exit(1);
>       }
>
>       /*
214,228d240
<        * Register binding info with endpoint map
<        */
<       rpc_ep_register(tserver_v1_0_s_ifspec,
<                       bind_vector_p,
<                       (uuid_vector_t *) &obj_uuid_vec,
<                       (unsigned_char_t *) "test  server of dcecp server obj",
<                       &status);
<       if (status != rpc_s_ok) {
<               print_error("rpc_ep_register()", status);
<               exit(1);
<       }
<
<       /* We don't need to export binding info -- dced has done it for us! */
<
<       /*
317d328
<

--------------------- End   Diffs for tserver.c -----------------------------

[2/2/96 public]

   Re-open for another look.  The changes in dced
for localization, partial service mode, etc, made
the starting of a server difficult, so this should
be checked again.



CR Number                     : 12692
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : under very heavy load DG leaks memory.
Reported Date                 : 10/20/94
Found in Baseline             : 1.1b16
Found Date                    : 10/20/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/20/94 public]

I ran a server supporting a very simple interface (a single operation with
the manager code returning immediately). I then simultaneously started four
tight loops from the shell each executing a client program calling the
server over ncadg_ip_udp at each iteration.  The four loops ran for 1000
iterations each. I noticed at the end of the run that the memory use of the
server had increased by a little over a meg. I also collected pkt
information from the server and at the end of the run pkts (as reported by
pkt_alloc()) is 99738. With a start value of 100000 minus the 32 pkts
allocated initially it seems that during the run the server allocated
another 230 pkts at 4472 bytes a piece for roughly my missing meg. It also
seems that pkts are never deallocated. If this is indeed the case why is
it? This does not seem to be a problem under "normal" conditions but the
leak is relatively severe under heavy load (as described here).

By the way this is as much a "bug" report as it is a question so I would
very much appreciate an (even brief) explanation as soon as any of the
RPC/DG people finds a second (or two ;)).

(By the way I ran this with 1.1b1? on both an hp and a rios).

Thanks!

[10/20/94 public]

Without knowing how the memory (VM or in-core?) use is measured, it's hard
to answer. However, DG runtime never free() packet buffers, instead they
are kept in rpc_g_dg_pkt_pool.free_list . At the startup, 48 (32 for
pre-dce1.1) pkt buffers are allocated and linked to
rpc_g_dg_pkt_pool.free_list . rpc_g_dg_pkt_pool.free_count and
rpc_g_dg_pkt_pool.pkt_count are set to 48 and 1000000-48 respectively.
rpc_g_dg_pkt_pool.free_count+rpc_g_dg_pkt_pool.pkt_count never exceeds
100000. If you saw "(pkt_alloc) pkts 99738", that means 100000-99738 pkts
were in use. Those 262 pkts would probably been returned to free_list, if
you had waited long enough to see "(pkt_free) pkts 1000000".

[10/20/94 public]

(Thanks)

I meant in-core memory. My question, may be a little unclear, was exactly
for an explanation of why the DG runtime never free() packet buffers. Is
there, for example, a high probability that the pool never gets too large?
For example, I noticed that in one of my test the number of packets in use
seem to stabilize even under heavy load. On the other hand, I am running
another test right now where I've loaded the server even more and the
packet buffer usage has yet to stabilize.

[10/21/94 public]

I'm closing the ticket. Even under sustained very heavy load the buffer
usage eventually stabilizes (e.g. ~300 receive buffers for a sustained
average rate of 8 rpc/sec (I guess roughly corresponding to the peak
receive rate)). Thanks for the help.



CR Number                     : 12691
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : gdssysadm
Short Description             : gdssysadm says the directory system isn't active while it is.
Reported Date                 : 10/20/94
Found in Baseline             : 1.1b23
Found Date                    : 10/20/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/20/94 public]

        In gdssysadm, when I use "f" then "i" to look at the directory system
        status, it tells us that the directory system not active while I can
        use "ps awux |grep gds" to see all those processes there.

        What is more, when I tried to deactivate the system, it says "Error:
        The directory system isn't active !"; Then I tried to activate the
        system, it again gave me error: "Error: The directory system is active"

        To me, the internal state is totaly messed up.

[10/20/94 public]
I can't reproduce this on either 486 or UX.  Can you provide more details
of your configuration, what baseline of code you are using, what you have
been doing with the system, et cetera.

[10/20/94 public]
I took a look at Weidong's machine.  It turns out that his machine did not
have the en_US.ISO8859-1 locale file built.  After making this there was no
problem.

# cd /usr/lib/nls/loc
# ls
Mkf.native  charmaps    iconv       iconvTable  methods     src
# make -f Mkf.native en_US.ISO8859-1
/usr/bin/localedef -c -f charmaps/ISO8859-1.cm -i src/en_US.src en_US.ISO8859-1
localedef [WARNING]: FILE: src/en_US.src, LINE: 455, CHAR: 1
There are characters in the codeset which are unspecified in the collation order.

*** Error code 1 (ignored)
# gdsdirinfo
#       PROCTYPE    PID    DIRID    IPCID    STATE
#
        Monitor     356      -        5        -        
        C-Stub      362      1        2        W1       
        S-Stub      364      1        11       W1       
        DSA         366      1        31       W3       
        DSA         369      1        31       W3       
        DUA-Cache   360      -        1        -        
        DSA         374      2        32       -        
        S-Stub      372      2        12       -



CR Number                     : 12689
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : libaudit
Short Description             : ev_info byte should be array, not NULL terminatedstring
Reported Date                 : 10/20/94
Found in Baseline             : 1.1
Found Date                    : 10/20/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/20/94 public]
ev_info byte, should be represented as an array with length and data
fields, not as NULL terminated string.

[7/26/95 public]

This OT will take some time to fix, and I'm not sure why this fix needs
to happen.  I will contact Robert Weisz to find out why he thought it
was important.  Bordering on design change...

[8/1/96 public]
Per agreement with Robert, this is currently not needed.



CR Number                     : 12687
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd core dumps while
configuring additionial cdsd server
Reported Date                 : 10/20/94
Found in Baseline             : 1.1b23
Found Date                    : 10/20/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/20/94 public]

I am using BL-23. I configured a cell of 5 machines.
While on 4 machines system tests were running, I tried to 
configure a CDS replica on the 5th machine. I got the following
errors and the cdsd master did a coredump.

ERRORS where the CDS master was running are: 

root@dce3> 1994-10-20-12:48:53.510-04:00I0.706 cdsd(1047) FATAL cds adver
dceassert.c 63 0x006547c0
Assertion "((rd_p->rec_offset+rd_p->rec_length) <=
(newbkt_p->node_blocks*BLOCK_SIZE))" failed in "/project
/dce/build/dce1.1-snap/src/directory/cds/server/db_btree.c"file> line <637
1994-10-20-12:50:48.470-04:00I0.821 dtsd WARNING dts events
logevent_v_ultrix.c 373 0xa44de9fc
Time provider timeout detected
1994-10-20-12:53:17.960-04:00I0.970 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0xa44de9fc
Failed to retrieve server binding from the namespace: Requested operation
would result in lost connectivity
 to root directory (dce / cds)
1994-10-20-12:56:09.220-04:00I1.142 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0xa44de9fc
Failed to retrieve server binding from the namespace: Requested operation
would result in lost connectivity
 to root directory (dce / cds)
1994-10-20-12:58:57.015-04:00I0.732 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0xa44de9fc
Failed to retrieve server binding from the namespace: Requested operation
would result in lost connectivity
 to root directory (dce / cds)

ERRORS during the additions CDS master config:

        selection:  1
S:****** Configuring additional CDS Server...
S:****** Checking for active sec_client service...
        A CDS server must have already been configured.
        What is the name of a CDS server in this cell
        (if there is more than one, enter the name of
        the server to be cached if necessary)? dce3

        Create LAN profile so clients and servers can be divided
        into profile groups for higher performance in a multi-lan cell ?
(n) 
S:****** Starting cdsd...
S:****** Waiting for registry propogation...
S:****** Initializing the name space for additional CDS server...
        Modifying acls on /.:/hosts/needle/cds-server
        Modifying acls on /.:/hosts/needle/cds-gda
        What is the name for this clearinghouse?  needle
1994-10-20-12:51:57.236-04:00I1.674 dtsd ERROR dts dtserror
dtss_service_global_set.c 692 0x7aff92e8
Failed to retrieve server binding from the namespace: Connection request
rejected (dce / rpc)
        Modifying acls on /.:/needle
ERROR: Requested operation would result in lost connectivity to root
directory (dce / cds)
Unable to bind to object /.:/needle
ERROR: Requested operation would result in lost connectivity to root
directory (dce / cds)
Unable to bind to object /.:/needle
        Should more directories be replicated? (n)

CORE INFO:


Core info:

root@dce3> ls -l ./var/directory/cds/adm/cdsd/core
-rw-r--r--   1 root     bin             45840844 Oct 20 12:50
./var/directory/cds/adm/cdsd/core
root@dce3> gdb /opt/dcelocal/bin/cdsd ./var/directory/cds/adm/cdsd/core
GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.5, Copyright 1992 Free Software Foundation, Inc.

OSF version 1.0 created Mon Dec  7 14:40:14 1992

..(no debugging symbols found)...
Core was generated by `cdsd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0xa403fea4 in bkgdskulkhalf ()
(gdb) where
#0  0xa403fea4 in bkgdskulkhalf ()
Cannot access memory at address 0xc6037d40.
(gdb)

[10/20/94 public]
I configured two machines 
486 initial cds server
hp secondary cds server
and ran killer on the secondary.  No problem.

I then reversed them
hp initial cds server
486 secondary cds server
and ran killer on the secondary again. No problem.

I had dts local servers on both machines fo reach configuration.

I'll talk to Martha in the morning to find out what she had running.

[10/21/94 public]
It would help if you have servicability events (level 5) on 
for the cds subcomponent "database" while trying to reproduce 
this problem.  Since the core isn't telling use much, we may 
need the trace.

[10/21/94 public]
Yep. The problem is making it happen. It may not be very reproducable but I
haven't talked to Martha yet. I'll assign this to me until we can get more
data.

[10/24/94 public]
This isn't reproducable under *normal* circumstances. Martha will try
again under the same conditions but can;t do it now. I'm dropping this
to a 1.

[07/25/96 public]
I'm cancelling this OT since we don't know how to reproduce this and
a large database fix (OT 12879) is now in R1.1-maint and R1.2.2, which
hanges the above server database condition.



CR Number                     : 12686
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : osi
Short Description             : Remove superfluous dacl i/f's from libdce
Reported Date                 : 10/20/94
Found in Baseline             : 1.1
Found Date                    : 10/20/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]
HP platform specific.  Hasn't been seen in R1.2.

[10/20/94 public]

dce1.1 libdce.sl has the unresolved symbol:

$ show_remaining_imports /opt/dcelocal/bin/dced
- --------- Imports That Must Be Resolved Elsewhere
      osi_GetNGroups     Code /usr/lib/libdce.sl

This is coming from file/security/dacl/dacl_pac.c and the following objects
have the reference to osi_GetNGroups .

  ./security/dacl2acl/dacl_pac.o
  ./security/dacl_lfs/dacl_pac.o
  ./security/dacl_lfs.klib/dacl_pac.o

I think that this is caused by the wrong version of osi_cred_mach.h
exported by file/osi/Makefile. There are HP800/osi_cred_mach.h and
HPUX/osi_cred_mach.h and HPUX/osi_cred_mach.h gets exported to the export
tree because of VPATH=${TARGET_OS} in HPUX/Makefile .

BTW, both HPUX and HP800 directories have:
  osi_buf_mach.h
  osi_cred_mach.h
  osi_net_mach.h
  osi_port_mach.h
  osi_uio_mach.h
One of them must be wrong.

[10/24/94 public]
Yes, there are two copies of those files and you might be
able to delete the HP800 version (I don't know, I haven't
done an exhaustive search).

However, I think the real problem is that the functions 
dacl_PacFromUcred and dacl_PacListFromUcred are being
included in libdce.  These functions in turn call
osi_GetNGroups() which is undefined in libdce.  These 
functions should only called from within the kernel, and 
in certain user level test environments.  They are not
referenced anywhere in libdce and they have no business 
being included there.  So, I think the solution is to
put a #if !defined(DACL2ACL) around those two functions
to remove them from dacl_pac.o when built in the dacl2acl
directory since the version in this directory is solely
for libdce consumption.  This is low priority since it
causes no test failures and only serves to increase the
size of libdce slightly, so I'm deferring it to 1.2.

[10/24/94 public]

Just FYI: You are so lucky that the unresolved symbol doesn't prevent the
process startup. :-) The -Bnonfatal ld option used for the DCE build allows
it. (But, I don't think that this option is necessary anymore. It's there
for a historical reason...) I wonder what happens if linking with the
archived library, libdce.a ...



CR Number                     : 12668
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : Password Validation Failure.
Reported Date                 : 10/19/94
Found in Baseline             : 1.1
Found Date                    : 10/19/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/19/94 public]


S:****** Initializing dced...
login failure.
  message from login:
  
  Sorry. Password Validation Failure. - Invalid password (dce / sec)
Failed to log in to DCE.
        Press <RETURN> to continue, CTRL-C to exit: 

         DCE Main Menu ( on orange )


         1. INSTALL     -install dce software
         2. CONFIGURE   -configure and start DCE daemons
         3. START       -re-start DCE daemons
         4. STOP        -stop DCE daemons
         5. UNCONFIGURE -remove a host from CDS and SEC databases
         6. REMOVE      -stop DCE daemons and remove data files
                         created by DCE daemons


        99. EXIT


        selection:  WARNING: get_option() read has reached EOF, exiting
S:****** Exiting from dce_config.
+ cd /u1/RAT_tools




Output from orange:/tmp/dce_config.log

V:         Executing: dce_login_noexec cell_admin <password not shown> 2>/tmp/lo
gin12904
DEBUG:     Executing: x_exit(login failure.
  message from login:
 
  Sorry. Password Validation Failure. - Invalid password (dce / sec)
Failed to log in to DCE.)
V:         User query: Press <RETURN> to continue, CTRL-C to exit:
V:         User entry:
V:         User query: DCE Main Menu
WARNING: get_option() read has reached EOF, exiting
V:         User entry: 99
DEBUG:     Executing: menu99()
S:****** Exiting from dce_config.

[10/20/94 public]
Assigning to security.

[10/21/94 public]
It turned out that clocks were off by 8 minutes. Cancelling this CR.



CR Number                     : 12657
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : acldb
Short Description             : dbopen.c missing casts
Reported Date                 : 10/18/94
Found in Baseline             : 1.1
Found Date                    : 10/18/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dbopen.c
Sensitivity                   : public

[10/18/94 public]

From dbimpl.h:

> struct db_info_s_t {
>     unsigned32		index_type;	/* index_type from dce_db_handle_s_t */
>     dce_db_header_type_t header_type;	/* standard, ACL, or no header? */
>     utc_t		created;	/* date db created */
>     utc_t		modified;	/* date db last modified */
> };
> typedef struct db_info_s_t db_info_t;
> 
> struct dce_db_handle_s_t {
>     DB			*db;		/* dbm handle */
>     unsigned32		iter_state;	/* iteration state */
>     unsigned32		index_type;	/* by uuid or name */
>     boolean		readonly;	/* opened database read-only? */
>     db_info_t		*info;		/* database info */
>     dce_db_convert_func_t	convert;
>     pthread_mutex_t	mutex;		/* for lower-level db i/o */
>     pthread_mutex_t	app_mutex;	/* for dce_db_lock/unlock */
>     uuid_t		uuidkey;	/* for dce_db_iter_next{_by_uuid} */
>     char		*namekey;	/* for dce_db_iter_next{_by_name} */
> };
  
From dbopen.c:
  
>     (*h) = (dce_db_handle_t)malloc(sizeof(struct dce_db_handle_s_t));
>     memset(*h, 0, sizeof(struct dce_db_handle_s_t));

OK so far.  h->info later gets initialized, but the void pointer returned by
malloc and calloc is never cast to be a pointer to a db_info_t struct.  Here
are the diffs to fix it:


*** dbopen.c	Tue Oct 18 15:42:29 1994
--- dbopen.c.fix	Tue Oct 18 15:47:58 1994
***************
*** 286,292 ****
      utc_t		now;
  
      *st = error_status_ok;
!     h->info = calloc(1, sizeof(db_info_t));
      utc_gettime(&now);
      h->info->created	= now;
      h->info->modified	= now;
--- 286,292 ----
      utc_t		now;
  
      *st = error_status_ok;
!     h->info = (db_info_t *)calloc(1, sizeof(db_info_t));
      utc_gettime(&now);
      h->info->created	= now;
      h->info->modified	= now;
***************
*** 313,319 ****
  	return;
      }
      if (!h->info) {
! 	h->info = malloc(sizeof(db_info_t));
      }
      memcpy(h->info, content.data, sizeof(db_info_t));
      pthread_mutex_unlock(&h->mutex);
--- 313,319 ----
  	return;
      }
      if (!h->info) {
! 	h->info = (db_info_t *)malloc(sizeof(db_info_t));
      }
      memcpy(h->info, content.data, sizeof(db_info_t));
      pthread_mutex_unlock(&h->mutex);

[1/18/94 public]
With ANSI C say you never need to cast a function that returns (void *),
like malloc and friends, when doing such an assignment.  If your compiler
does not like this, then it is not ANSI C-compliant.
I'll consult Rich S, and probably cancel this.

[10/18/94 public]

You're quite right.  I was a bit confused by this line in dbopen.c:

>     (*h) = (dce_db_handle_t)malloc(sizeof(struct dce_db_handle_s_t));

but I will have to assume that opaque datatypes require special treatment.
db_info_t is not opaque, so no need for the cast.

And I'll ask the customer about their stdlib.h.

[10/19/94 public]
If properly declared, the return value of malloc never needs to be cast.
Our source has an extra cast in it, it seems; oh well.  Cancel this.

(PS:  calloc?  ick.)

[1/2/94 public]
Yes, calloc, and yes, ick.

Even if the customer's (Hitachi's) stdlib.h is right, their compiler
may be wrong...



CR Number                     : 12636
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : secd
Short Description             : secd core dump on RIOS
Reported Date                 : 10/17/94
Found in Baseline             : 1.1b21
Found Date                    : 10/17/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/17/94 public]
I took a secd core dump on RIOS Friday night.  The cell was
basically idle (2 machine, 1.0.3a client).  I had run DFS fts
tests on Friday before leaving.

The core file is apparently unusable, unless I'm missing some
piece of dbx magic:

> # dbx /opt/dcelocal/bin/secd ./core
> dbx version 3.1 for AIX.
> Type 'help' for help.
> ./core does not contain a stack (core ignored)
> reading symbolic information ...warning: no source compiled with -g
> 
> 
> illegal instruction (reserved addressing fault) in . at 0x0
> 0x0 //.dbxinit: 2: Unreadable instruction at address 0x0
> (dbx) where
> warning: could not locate trace table from starting address 0x0
> Could not determine current function

Contents of secd.log are:

1994-10-14-22:41:53.761-04:00I28.038 secd ERROR sec rs_loginthr rs_login.c 204 0
x20302f88
Registry server unavailable
1994-10-14-22:41:53.936-04:00I28.038 secd WARNING sec rs_loginthr rs_login.c 208
 0x20302f88
Unable to refresh hosts/singsing/self identity . Will idle and retry
1994-10-14-22:41:55.775-04:00I28.040 secd ERROR sec rs_loginthr rs_login.c 204 0
x2030f2c8
Registry server unavailable
1994-10-14-22:41:55.790-04:00I28.040 secd WARNING sec rs_loginthr rs_login.c 208
 0x2030f2c8
Unable to refresh dce-rgy identity . Will idle and retry

What else can I do?

[10/21/94 public]

This is believed to be a dup.  Lowering to P1.

[2/2/96 public]
This OT has become useless.  There is no information above that would lead
us to a problem; The core file was useless, and it was believed to be a dup
at the time, but no information and no reproduction of the problem has occurred
in well over a year.  I'm cancelling this OT because it can be of no help
anymore and is not reproducible.



CR Number                     : 12621
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : gateway
Short Description             : functional tests fail
Reported Date                 : 10/13/94
Found in Baseline             : 1.1b21
Found Date                    : 10/13/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]
HP platform specific.  Hasn't been seen in R1.2.

[10/13/94 public]

 The functional tests in .../file/gateway/dfs_login/test3 fail although
the same commands succede when entered individually at the command line.



CR Number                     : 12620
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : gateway
Short Description             : bad dfs_logout exit value
Reported Date                 : 10/13/94
Found in Baseline             : 1.1b21
Found Date                    : 10/13/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]

HP platform specific.  Hasn't been seen in R1.2.

[10/13/94 public]

 the command line

 > dfs_logout

 gives an error of

  dfs_logout: cannot determine default host

 but returns an exit value of 0 to the shell. This causes a failure in
 .../test/file/gateway/dfs_login/test2



CR Number                     : 12607
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : svc
Short Description             : variables uninited in svc
Reported Date                 : 10/12/94
Found in Baseline             : 1.1b21
Found Date                    : 10/12/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/12/94 public]

          (IBM svc defect 10728):

          dce_svc_g_map and dce_svc_g_map_size uninitialized


          The variables dce_svc_g_map and dce_svc_g_map_size
          are uninitialized, causing the shutdown routine
          to process invalid addresses in the map table in some cases.
          Initializing the variables to 0 in svcreg.c ensures that
           the table is always valid during dce_svc__shutdown.

          If you have any explicit questions contact Gerry at
          gthome@dss1.austin.ibm.com, (512)838-2256.

[10/13/94 public]
No, they are implicitly initialized to zero by defining them as global
variables in svcreg.c.  Buggy C compiler?  I think this should be cancelled.

[1/13/94 public]
What Rich says is true.  These are defined in svcreg.c by:
    dce_svc_handle_t        *dce_svc_g_map;
    int                     dce_svc_g_map_size;
which initialized them to nulls.  Canceling.



CR Number                     : 12576
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv core dump
Reported Date                 : 10/11/94
Found in Baseline             : 1.1b21
Found Date                    : 10/11/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/11/94 public]

In a 5 machine, split sec and cds server idle DFS cell, at about
the 35 hour mark:

m1 (sec server):
1994-10-09-04:00:17.853-04:00I0.450 secd ERROR rpc auth cnsassm.c 4028 0x401fe39
8 RPC_CN_AUTH_VFY_CLIENT_REQ on server failed: Ticket expired (dce / krb)

m2 (cds server):
1994-10-09-04:00:18.173-04:00I0.560 cdsclerk(2598) ERROR cds general clerk_bind.c 627 0x40188128 Rou
tine sec_rgy_pgo_is_member(3sec) failed : status = 382312679.
then many:
1994-10-09-04:07:36.657-04:00I0.973 cdsclerk(2598) ERROR cds general clerk_bind.c 627 0x40188128 Routine sec_rgy_pgo_is_member(3sec) failed : status = 382312543.

where:

root@dce8> stcode_hp 382312679
382312679 (decimal), 16c9a0e7 (hex): Authentication ticket expired (dce / rpc)
root@dce8> stcode_hp 382312543
382312543 (decimal), 16c9a05f (hex): Who are you failed (dce / rpc)

The Assertion failure was:
Assertion failed: (scte)->refcnt < 255, file
/project/dce/build/dce1.1-snap/src/rpc/runtime/dgscall.c, line 1144

The trace was:
 0 _kill@libc + 0x00000008 (hp-ux export stub)
 1 _raise@libc + 0x00000024 (0x7aff7504, 0x405e4090, 0x400e5a0c, 0)
 2 _abort@libc + 0x00000078 (0x405e3fb0, 0x3, 0, 0)
 3 _assert@libc + 0x00000128 (0x400a496c, 0x400a3750, 0x405e2ca0, 0)
 4 rpc__dg_scall_alloc@libdce + 0x0000012c (0x400a4968, 0x400a3750,
0x405e2ca0, 0x1dc)
 5 rpc__dg_sct_new_call@libdce + 0x0000032c (0x400a4968, 0x400a3750,
0x405e2ca0, 0x400e582c)
 6 rpc__dg_do_request@libdce + 0x000002c4 (0x400a3750, 0x405e2ca0, 0x2, 0x400e5788)
 7 recv_dispatch@libdce + 0x00000f78 (0x400a3750, 0x405e2ca0, 0x400e5680, 0)
 8 rpc__dg_network_select_dispatc + 0x00000648 (0x6, 0x400a3750, 0x1, 0x400e5680)

The self credentials on all machines are still good and the cell appears
healthy* other than the cdsadv coredump and it's effects on all processes
on m2 (ie. Name service unavailable). Note that this was probably prompted
by the DFS bosserver that tries to restart itself and a number of DFS user
space daemons at 4am on Sunday mornings ... these processes all reported
"Who are you failed" on m2 before reporting Name service unavailable.

NOTE: one machine, m3, that was to be a security replica and cds replica,
hung during configuration on the command:

rpccp export -i 4ea31de8-9a94-11c9-bb60-08002b0f79aa,0003.0000                  -b ncadg_ip_udp: -o faf2e540-58b8-11ca-a04a-08002b12a70d -s dce                  /.:/hosts/rum/cds-server > /dev/null

I believe this is a separate unrelated problem and have just added
it here for completeness.

[07/25/96 public]
I'm cancelling this OT for the following reasons:

1) None of the above helps debug a cdsadv core dump.

2) I don't see any evidence that the above notes indicate why CDS owns
   this OT (more like RPC with the assertion failure).  A cdsadv core
   dump does not mean that node cannot access the namespace.  Existing
   processes with their corresponding cdsclerk process will still be
   able access the namespace.  If the cdsadv process goes away,
   losing accessibility to the namespace occurs if you get back a Socket
   Error.  "name service unavailable" implies either a connectivity
   problem to the CDS server (RPC), or the remote cdsd may be down.

3) We don't have the system resources to begin to try and reproduce
   whatever happened above (and that's a lot).



CR Number                     : 12571
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : dce_config of sec relica hangs
Reported Date                 : 10/10/94
Found in Baseline             : 1.1b21
Found Date                    : 10/10/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/10/94 public]

In the function "config_secreplica" the following code currently will
loop forever:

        not_uptodate=`dcecp -c registry verify`
        while [ ! -z "$not_uptodate" ]
        do
                sleep 5
                log_msg DETAIL "Executing: dcecp -c registry verify"
                not_uptodate=`dcecp -c registry verify`
        done

When I executed "dcecp -c registry verify" on the command line, the
following error is returned:

Error: invalid command name "_dcp_registry_verify"

I assume that something in dcecp is not implemented or this code is
incorrect.

[10/11/94 public]
We configure security replicas every day on both the HP and RIOS
machines for smoketest.

It appears that you do not have the auxillary script 'registry_verify'
installed on the system you are configuring.
Please check the file 
	/opt/dcelocal/dcecp/registry.dcp
which is where this script lives (and gets installed by dce_config).



CR Number                     : 12537
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : don't build with -g by default
Reported Date                 : 10/6/94
Found in Baseline             : 1.1b20
Found Date                    : 10/6/94
Severity                      : E
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : src/admin/dcecp/Makefile
Sensitivity                   : public

[10/6/94 public]
Remove the -g from CFLAGS and LDFLAGS so that we build without it by
default.  People who want to build should be able to set OPT_LEVEL to -g
and get everything they need.

[10/6/94 public]
Nevermind.  Why change compiler options at this point.  Other things are
shipping with -g by default.



CR Number                     : 12514
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : dg
Short Description             : problems with who_are_you2()
Reported Date                 : 10/5/94
Found in Baseline             : 1.1b20
Found Date                    : 10/5/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/5/94 public]

VTS has couple of tests which are getting into problem
with who_are_you2().

Summary:
	Always remote comm failure Fault PDU is received.


scenario 1:
	VTS acts as a CL client and RPC acts as CL server.

	VTS sends an idemp request to runtime. [seqnum=0;boottime=0];

	VTS receives a call back2 request from callback thread.
	VTS sends the callback response to callback thread with 
	status=0; seqnum=0; client actid.

	VTS receives a fault PDU immediately from the main thread.

scenario 2:
	VTS acts as a CL client and RPC acts as CL server.

	VTS sends an non-idemp request to runtime. [seqnum=0;boottime=0];

	VTS receives a call back request from callback thread.
	VTS sends the callback response to callback thread with 
	status=0; seqnum=0;

	VTS receives a call back2 request from callback thread.
	VTS sends the callback2 response to callback thread with 
	status=0; seqnum=0; client actid.

	VTS receives a fault PDU immediately from the main thread.

These tests used to work fine with 1.0.3; but now these tests fail.
Anybody know of any undocumented protocol features added to conv_mgr
protocol?

[10/5/94 public]
We need to look at this ASAP.  
We have been seeing mysterious comm failures and this may be the cause.
See OT 12315 for details on them.

Raising to an A0 and assigning to HP.
Please respond with an ACK that someone is working on this.

[10/6/94 public]

I don't understand the justification for making this an A0 bug, since it's
never been seen by anything other than the VTS tests.  (In particular, all
of the context handle tests run fine when run on a real client and server.)

Also, WAY2 calls are only made in support of context handles, and there are
no context handles being used in the failed calls described in OT 12315, so
I don't see any connection.

Either there's a bug in the VTS client, or there's a bug in the runtime that
doesn't manifest itself during calls between clients and servers built on top
of the reference implementation.  Either way, it's not an A0.

Is it possible to build the DCE client side of the test that's failing?  If
so, it would be interesting to see if it can talk to the DCE server.  If it
can't, then there's a bug in the runtime.  If it can, then compare what's
being sent from the VTS and DCE clients, and see where they differ.

We'll be happy to help out with this problem, but for the moment we're 
assuming that Tom is driving.

[10/6/94 public]
Lowering this to a B1, we can invetigate if we have time, but it
does not appear that this is causing 12315 (see Marks comments).

It is still a VTS failure, however, and should not be ignored.
Assigning to Prassad to investigate further next week as he
is the VTS expert.

[10/6/94 public]
I'm not familiar with the code - is it possible that this error is
affecting DFS to cause:

AFS_SetContext(sarpa.osf.org) fails: Communications failure (dce / rpc)

[10/6/94 public]

No. rpc_s_comm_failure is different from rpc_s_fault_remote_comm_failure.

This OT should be re-assigned to VTS because it is caused by the
programming error in VTS. VTS as a DG client is trying to use a
non-existing context. Also, probably the server manager routine is
returning the NULL context. If this was working at 1.0.3, then libidl was
broken.

[10/6/94 public]
I think I found the problem:

previously in the tests, the context handle was created using
an input/output parameter with NULL value. [See the Application
Development Guide 17.14.9.3 'Creating New Context'].

I changed the tests to use an extra operation with an output parameter
to get the context and then use the context obtained from the operation
in the later operations. In this way I could get rid of the original problem. 

So now should I cancel this OT? Is the Application Dev Guide wrong?

[10/18/94 public]

When using [in,out,context_handle], does the server manager routine returns
the non-NULL context? To create the context using [in,out,context_handle],
the client must make an RPC with a NULL context and the server manager
routine must return the non-NULL context for the subsequent use of it. To
destroy the context, the client must make an RPC with the existing
(non-NULL) context and the server manager routine must return the NULL
context. The non-NULL in/out means updating the existing context. Lastly
the NULL in/out is valid only when the client created the NULL context
(nil-UUID) before with [out,context_handle] which is not the case with VTS.

[2/5/96 public]

I'm cancelling this because it's a VTS bug which might be fixed already
given the above comment. Please resubmit it against VTS if necessary.



CR Number                     : 12499
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : 
Short Description             : dce.clean/ce_shutdown should
clean old audit trail files.
Reported Date                 : 10/4/94
Found in Baseline             : 1.1b20
Found Date                    : 10/4/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/4/94 public]

dce.clean/dce_shutdown does not clean, between re-starts, the files 
with names

	sec_audit_trail.1994-09-29-21-32-02
	sec_audit_trail.1994-09-29-21-32-02.md_index

created in /opt/dcelocal/var/security. 

The accumulation of these files in this directory eats the
resources needed by DCE.

[10/4/94 public]

Mike Burati says this is not a good thing to do...

He wrote....

 		....             it's not a good idea for dce.clean 
to remove these files.  They are not current state files, they are 
persistent state files.  The whole purpose of the files is for an 
administrator to be able to go back and figure out who broke something 
or who broke into what account at what time... any time in the future.  
People may use dce.clean to stop daemons before rebooting their machine, 
just to be safe.  You don't want to wipe out their audit trails when 
doing that.  It must be an explicit action on the administrator's 
behalf that removes an audit trail.



CR Number                     : 12483
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd fatal error - cdsclerk(752) ERROR cds general clerk_bind.c
Reported Date                 : 10/4/94
Found in Baseline             : 1.1
Found Date                    : 10/4/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/4/94 public]

Core smoketest failed on AT486; passed on HPUX and RIOS

Platform - AT486
Machine name - sif

Extract from /u1/RAT_tools/do_automatic_test.log


S:****** Configuring CDS Server...
S:****** Checking for active sec_client service...
S:****** Starting cdsadv...
S:****** Starting cdsd...
1994-10-04-08:36:20.813+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e6768
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:22.713+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e6768
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:23.693+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e5078
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:24.593+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x0078d5a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:25.273+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e5078
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:24.593+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x0078d5a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:36:25.273+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x004e5078
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:37:03.770+00:00I----- cdsclerk(752) ERROR cds general clerk_bind.c
 490 0x0078d5a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-10-04-08:37:04.810+00:00I----- cdsd(756) ERROR cds general unix_cds_net.c 8
04 0xa449e9fc
Routine rpc_ns_binding_export(3rpc) failed: status = 382312662.
1994-10-04-08:37:04.910+00:00I----- cdsd(756) ERROR cds general unix_cds_net.c 8
14 0xa449e9fc
Routine rpc_ns_binding_export(3rpc) failed: status = 382312662.
1994-10-04-08:37:04.910+00:00I----- cdsd(756) FATAL cds server dns_service_ncl.c
 325 0xa449e9fc
Cannot export bindings to clearinghouse.
ERROR:   cdsd failed to start

[10/4/94 public]
We believe this is likely a different problem that the one in 11566. Reopening
it. Also making it a P1 because its not readily reproducable. I'll leave
this one with cds because if we see it again I'm going to spend more time 
fishing around the cell and the net its attached to.

[10/5/94 public]
The same problem was observed today on sif (AT486).  The config failed
last night during the scheduled core smoketest.  When I reconfigured in
the morning, the cell configured OK.

[10/5/94 public]
I talked to Avi this morning asking him to come and get me if this happens
again tomorrow. Don't reconfigure it. Got to admit its beginning to look 
more like some sort of configuration problem. I'll recheck the uptime on 
the smoke test machines again. If it happens tomorrow maybe we can get a
handle on it. I'm going to leave this at a P1 untill we acertain wether its
a configuration problem or not. Still assigned to me.

[10/5/94 public]
We just rebooted all three smoke test machines and configured the machine that 
hits the problem. It worked fine. Sooooo.....

Mike and Rob were appear to be right. It certainly does appear to be a 
configuration problem of some sort. One of the other two machines is getting
itself into a state that is causing a problem for the 486. One possibility
is one of them kicking off the multi machine test pre-maturely. Don't know,
but assuming we hit the problem tomorrow I'll see if I can get a handle on
it.

[10/6/94 public]
The smoke test did not hit the failure this morning but the multi machine
test did not run for reasons unrelated to this problem. If the failure
is due to some kind of problem in the timeing of the multi machine test
kick off we would not have seen the failure this morning. We'll continue 
monitoring the tests.

[10/12/94 public]
The smoke test hit this problem on 'sif' today morning and failed.

[07/09/96 public]
Since:

1. It hasn't been determined where the problem lies, let alone assigning
   this to CDS.
2. It is unlikely to get attention unless it happens on the latest
   reference platform.

I am canceling this OT.  Fee free to re-open it if further evidence
is found.

--Roger

[8/15/96 public]
The fix for this requires a change in two files, adver_main.c and
adver_cds_event.c.

The advertiser is only supposed to cache server/clearinghouse information
from servers within the local cell (by default).

In the cases when the clerk is reporting rpc_set_auth_info failures, we
noticed that non-local clearinghouses were cached.  It also turns out that
these clearinghouses were from machines which had a "dying" clearinghouse.

Because these bogus clearinghouses were cached, rpc would return the wrong
information on a rpc_mgmt_inq_server_princ_name call.  This caused the
clerk to attempt to bind to the wrong server.

The fix we made is to correct the way the cell matching works to not
look at the UUID, but rather just to look at the cell name.

Changes to the files are as follows:

adver_main.c:

define a variable of type character, all_cells, and set it to FALSE:
char all_cells = FALSE;

adver_cds_event.c:

in routine cds_advertisement_cellmatch()

static int
cds_advertisement_cellmatch (
    cds_FullName_t *cellname_p,
    uuid_t      *cell_diruid_p)
{
    DEB_ASCII_BUF_cds_FullName(cellnameBuf)
    DEB_ASCII_BUF_ObjUID(diruidBuf)

    register int cell_name_match = FALSE; /* Cell matching flags */
    register int cell_uuid_match = FALSE;
    register int cell_match = FALSE;

    DCE_SVC_DEBUG((cds__svc_handle, cds_svc_adver,  svc_c_debug7,
                   " >cds_Advertise_cellmatch(%s,%s)",
                   deb_ascii_cds_FullName(cellnameBuf,cellname_p),
                   deb_ascii_ObjUID(diruidBuf,cell_diruid_p)));



    /*
     *  Rules for accepting an advertisement:
     *
     *    If the cell name matches, accept.  (On the side, grab it's uuid).
     *    Else see if the uuid advertised matches the configured cell's
     *        uuid.  If it does, accept (this is a cell alias).
     */

    cell_name_match =
     (adv_cache_cellname_p
      && (cellname_p->fn_length == adv_cache_cellname_len)
      && EQ_bytes(cellname_p->fn_name, adv_cache_cellname_p,
                                         adv_cache_cellname_len));

    if (!cell_name_match) {
     cell_uuid_match = EQ_ObjUID(cell_diruid_p, &adv_cache_cell_diruid);
    } else if (ObjUID_is_nil(&adv_cache_cell_diruid)) {
     cell_uuid_match = FALSE;
     COPY_ObjUID(cell_diruid_p, &adv_cache_cell_diruid);
    }

   extern char all_cells;
   cell_match = (cell_name_match || cell_uuid_match || all_cells);
    if (!stand_alone && cell_match) {
   DCE_SVC_DEBUG((cds__svc_handle, cds_svc_adver, svc_c_debug7,
                     " >cds_Advertise_cellmatch(%s,%s) return(TRUE)",
                     deb_ascii_cds_FullName(cellnameBuf,cellname_p),
                     deb_ascii_ObjUID(diruidBuf,cell_diruid_p)));
   return (TRUE);
    } else {
   DCE_SVC_DEBUG((cds__svc_handle, cds_svc_adver, svc_c_debug7,
                     " >cds_Advertise_cellmatch(%s,%s) return(FALSE)",
                     deb_ascii_cds_FullName(cellnameBuf,cellname_p),
                     deb_ascii_ObjUID(diruidBuf,cell_diruid_p)));
   return (FALSE);
    }
}



CR Number                     : 12475
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : era
Short Description             : dcecp -c prin modify -remove core dumps
Reported Date                 : 10/3/94
Found in Baseline             : 1.1b20
Found Date                    : 10/3/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/3/94 public]

While I remembered part-way through this that you're supposed
to use the non-abbreviated object (eg. principal vs. prin) it
still doesn't seem like coredumping is the appropriate behavior
since it's VERY easy to use the shorthand and sometimes it works
for some operations

root@yosemite> dcecp -c xattr show /.:/sec/xattrschema/mytestattr
{aclmgr
 {{principal {{query r} {update rfu} {test r} {delete rDm}}}
  {group {{query r} {update rm} {test rt} {delete rDm}}}
  {organization {{query r} {update rm} {test rt} {delete rDm}}}}}
{annotation {}}
{applydefs no}
{encoding printstring}
{intercell reject}
{multivalued yes}
{reserved no}
{scope {}}
{trigbind {none {}}}
{trigtype none}
{unique no}
{uuid 0c9a0288-deda-11cd-99d0-0000c0dade56}
root@yosemite> dcecp -c prin modify foo -add {mytestattr val1}

root@yosemite> dcecp -c prin show foo -xattr
{mytestattr val1}
root@yosemite> dcecp -c prin modify foo -remove mytestattr
Memory fault(coredump)
root@yosemite> dcecp -c acl show /.:/sec/xattrschema
{unauthenticated r----}
{user 00000000-0000-0000-0000-000000000000 rcidm}
{other_obj r----}
{any_other r----}


 0 strlen@libc + 0x00000008 (hp-ux export stub)
 1 rpc_ss_build_bounds_list@libdc + 0x000004e8 (0x7b0388ec, 0x2d6f626a, 0, 0)
 2 rpc_ss_pointee_desc_from_data@ + 0x00000550 (0x7af98b40, 0x2d6f626a, 0, 0)
 3 rpc_ss_ndr_marsh_union_ptees@l + 0x000005b0 (0x7af987ac, 0x3, 0x7b0367bc, 0x7b037f88)
 4 rpc_ss_ndr_m_enc_union_or_ptee + 0x00000190 (0x7b0367b8, 0x828, 0x1, 0x7b037f88)
 5 rpc_ss_ndr_m_struct_pointees@l + 0x000012cc (0x7b03800f, 0x804, 0x7b0367a8, 0x7b037f88)
 6 rpc_ss_ndr_m_f_or_c_arr_ptees@ + 0x0000028c (0x7b0367a8, 0x1, 0x40116ba8, 0x7af98470)
 7 rpc_ss_ndr_m_dfc_arr_ptees@lib + 0x00000140 (0x4df, 0x7b0367a8, 0, 0)
 8 rpc_ss_ndr_marsh_interp@libdce + 0x00002108 (0x1, 0x158, 0x7b0381f8, 0x7b037f88)
 9 op1_csr@libdce + 0x00000260 (0x40116420, 0x7b037944, 0x401121f0, 0x1)
10 sec_rgy_attr_lookup_by_id@libd + 0x00000250 (0x400c4610, 0, 0x7b0360f4, 0x7b037598)
11 check_era_info (interp = 0x400be6b8, domain = 0, name = 0x7b0360f4, in_attrs = 0x7b0367a8, attr_info = 0x7b036770, out_attrs = 0x7b036a78, del_attrs = 0x7b036d48)    [/project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c: 1812]
12 principal_modify (clientData =   00000000, interp = 0x400be6b8, argc = 2, argv = 0x7b035708)    [/project/dce/build/dce1.1-snap/src/admin/dcecp/rgy.c: 1210]
13 dcp_principal (clientData =   00000000, interp = 0x400be6b8, argc = 4, argv = 0x7b035798)    [/project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c: 1164]
14 Tcl_Eval + 0x000009f0 (0x400be6b8, 0x7b0353b0, 0x7b035588, 0x7b035548)
15 Tcl_UplevelCmd + 0x0000023c (0, 0x400be6b8, 0x1, 0x7b03548c)
16 Tcl_Eval + 0x000009f0 (0x400be6b8, 0x7b034f0e, 0, 0x40)
17 TclParseNestedCmd + 0x0000005c (0x400be6b8, 0x7b034f0e, 0, 0x7b035250)
18 TclParseWords + 0x000002ac (0x400be6b8, 0x7b034f06, 0, 0x8)
19 Tcl_Eval + 0x000003a4 (0x400be6b8, 0x7b034f00, 0x7b0350c8, 0x7b034fb0)
20 Tcl_IfCmd + 0x000003d8 (0, 0x400be6b8, 0x3, 0x7b034fc8)
21 Tcl_Eval + 0x000009f0 (0x400be6b8, 0x4010c6ec, 0x7b034e88, 0x7b034d70)
22 Tcl_IfCmd + 0x000003d8 (0, 0x400be6b8, 0x3, 0x7b034d88)
23 Tcl_Eval + 0x000009f0 (0x400be6b8, 0x400c33e0, 0x4010c1b0, 0)
24 InterpProc + 0x00000530 (0x400c33c8, 0x400be6b8, 0, 0x7b034a88)
25 Tcl_Eval + 0x000009f0 (0x400be6b8, 0x40107680, 0x40002664, 0x40002664)
26 Tcl_AppInit (interp = 0x400be6b8)    [/project/dce/build/dce1.1-snap/src/admin/dcecp/main.c: 673]
27 main (argc = 7, argv = 0x7b0337a0)    [/project/dce/build/dce1.1-snap/src/admin/dcecp/main.c: 351]

[10/3/94 public]
In an attempt to get cell_admin back on /.:/sec/xattrschema, I 
thought I'd make my own admin and then adjust the acl - didn't
need the last step...  is this normal??

dcecp> acl show /.../bl20_sec_cell.osf.org/sec/xattrschema
{unauthenticated r----}
{user 00000000-0000-0000-0000-000000000000 rcidm}
{other_obj r----}
{any_other r----}
dcecp> help prin create
-alias              Add principal named as an alias of specified uid
-attribute          Attribute list to be assigned to the principal to be added
-fullname           Fullname of the principal to be added
-quota              Quota of the principal to be added
-uid                User Identifier of the principal to be added
-uuid               Orphaned UUID to be adopted by the specified principal
dcecp> prin create myadmin -uuid 00000000-0000-0000-0000-000000000000
dcecp> acl show /.../bl20_sec_cell.osf.org/sec/xattrschema
{unauthenticated r----}
{user cell_admin rcidm}
{other_obj r----}
{any_other r----}

[10/3/94 public]
More strangeness between 'principal' and 'prin' and ACLs...:
dcecp> acl show /.../bl20_sec_cell.osf.org/sec/xattrschema
{unauthenticated r----}
{user 00000000-0000-0000-0000-000000000000 rcidm}
{other_obj r----}
{any_other r----}
dcecp> prin create aaadmin  -uuid 00000000-0000-0000-0000-000000000000
dcecp> acl show /.../bl20_sec_cell.osf.org/sec/xattrschema
{unauthenticated r----}
{user 00000000-0000-0000-0000-000000000000 rcidm}
{other_obj r----}
{any_other r----}
dcecp> principal create bbadmin -uuid 00000000-0000-0000-0000-000000000000
dcecp> acl show /.../bl20_sec_cell.osf.org/sec/xattrschema
{unauthenticated r----}
{user cell_admin rcidm}
{other_obj r----}
{any_other r----}
dcecp> prin show bbadmin -all
{fullname {}}
{uid 1735}
{uuid 000006c7-deec-21cd-9900-0000c0dade56}
{alias no}
{quota unlimited}

[10/3/94 public]
Many (not all) of the problems Martha is seeing have been fixed in a 
later dcecp. I have given her a bleeding edge copy (built 10/3 @ 1500).
Hand tests show that the handling of principal mod -remove works fine.

She will be using the new dcecp for her tests for now.

The sypmtoms of the acl not being updated with the new principal information
are consistent with writing to the master (princ create) and reading from
a replica (acl show). Due to the fact that acl show handles its own 
binding, there is no way for dcecp to cache a handle to the master. The
workaround for this is to 

a) set _s(sec) subsys/dce/sec/master

... This will force all reads and writes to go to the master.

b) wait for registry propogation from master to replica.


There are other problems in dealing with using the nil uuid. This seems
to be a bug. I'm investigating.

[10/4/94 public]
Nope. The nil UUID action is expected. I believe that we have covered all 
of the issues raised here with a new binary. Cancelled.



CR Number                     : 12443
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : cfg
Short Description             : configuration error
Reported Date                 : 9/30/94
Found in Baseline             : 1.1
Found Date                    : 9/30/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[9/30/94 public]
During the following configuration

 1. Configure a 486 as a security master
 2. Configure an hp as a the initial cds server
 3. Configure the 486 as either a cds client or a secondary cds server
 4. Configure the hp as a secondary security replica

Step four results in the error 'Can't bind to /.:/sec/relist'

This has the feel of a sequenceing problem in dce_config. I'll give this
to security but assign it to myself. I'll spend some time seeing if I can
figure out what's out of sync. If I can't come up with anything I'll let
Rajendra know.

[10/14/94 public]
John did you ever find out anything more about this one?

[3/1/96 public]
Ugh, looks like I never updated this one either (along with jd and Rajendra).
A year and a half ago (Oct94), I asked Mary to update this because we could not
reproduce it here.  It appears that John never reproduced it for Rajendra
either.  It's conceivable that you could cause the above to occur by doing
step 4 within a minute of when step 3 finished.  Because secd comes up before
CDS, it only tries once a minute to export information to the namespace.  So,
it would have taken one minute plus the amount of time to register all the
information that it dumps in CDS, before step 4 could possibly work.
I'm cancelling this as not reproducable.  If somebody does find a way to
reproduce it, open a defect with detailed information on what you did to get
it to happen.  Doing step 4 too soon after step 3 would just be pilot error,
not a bug.

[3/1/96 public]
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'



CR Number                     : 12420
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_login_setup_identity() coredump in simple hand-test
Reported Date                 : 9/29/94
Found in Baseline             : 1.1b19
Found Date                    : 9/29/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/29/94 public]
The hand-test below dumps core (usually) on the HP in
sec_login_setup_identity().  Last tried on BL-20.

 - - - - - - - - - - - - - - - - - - - -
/*
    Dumps core in sec_login_setup_identity() on HP
	create prin "prin1" with passwd "prin1"
	c89 -g -o zzz zzz.c -ldce
	run zzz
*/

#include <stdio.h>
#include <dce/dce.h>
#include <dce/sec_login.h>
#include <dce/passwd.h>
#include <string.h>

#define PRIN "prin1"
main()
{
    char	user[100], password[2000];
    error_status_t	st;
    sec_login_handle_t  lcontext;
    sec_login_auth_src_t auth_src;
    sec_passwd_rec_t    prec;
    static sec_passwd_rec_t    nil_prec;
    boolean32           reset_passwd;

    strcpy(user, PRIN);
    strcpy(password, PRIN);

    if (sec_login_setup_identity((unsigned_char_p_t) user,
                                    sec_login_no_flags, &lcontext, &st)) {
	printf("sec_login_setup_identity returned true\n");

	prec = nil_prec;
	prec.key.key_type = sec_passwd_plain;
	prec.key.tagged_union.plain = (unsigned char *)password;
	prec.pepper = NULL;
	prec.version_number = sec_passwd_c_version_none;

	if (sec_login_validate_identity(lcontext, &prec, &reset_passwd,
			&auth_src, &st)) {
	    printf("sec_login_validate_identity valid = 1\n");
	}
	else printf("sec_login_validate_identity valid = 0\n");
    }
    else printf("sec_login_setup_identity returned false\n");

    if (st) dce_pgm_printf(st);

    puts("OK");
    exit(0);
}

[9/29/94 public]
Well?  The suspense is killing me.  What does the core dump say?

[9/29/94 public]
Using latest bits I was able to run the above program successfully without
error on HP/UX. Ran for 10 times.

spring : ./zz
sec_login_setup_identity returned true
sec_login_validate_identity valid = 1
OK

[9/29/94 public]
I get the core dumps on my HP.

when dce_login cell_admin -dce-, zzz core dumps after printing 
out success from first API (setup_identity)

[crown]:/tmp> ./zzz
sec_login_setup_identity returned true

XDB trace:

Core file from:  zzz
Child died due to: segmentation violation
Program died in unknown location, pc = 0x3
Stack trace will not be possible (UE463)
.Procedures:      1
Files: 1
Stack isn't that deep (UE311)
>trace
 0 (address 0)

When not dce logged in, no message from setup_identity and stack is thus:

Core file from:  zzz
Child died due to: segmentation violation
Procedures:      1
Files: 1
>trace
 0 ep_get_endpoint@libdce + 0x00000810 (0x7af6a5e0, 0x1, 0x3429ec,
0x81393871)
 1 rpc_ep_resolve_binding@libdce + 0x000001d4 (0x7b0353b4, 0x7, 0xa07,
0x7b0094e6)
 2 _SYSTEM_ID@libdce + 0x4645f060 (Address not found (UE302)

[9/29/94 public]
It looks like you didn't build with (at least some of) the following
switches (look at how anything else is built with libdce on HPUX):
-z -Wl,-Bimmediate,-Bnonfatal,-a,default,+b,/lib:/usr/lib
(need at least the -Wl,-Bimmediate,-Bnonfatal I'm not sure, but you may need
all of the above switches).  Since this works for Rajendra when built
correctly and since the test code above is basically a stripped down
dce_login which has been working for many other people all day, I'm not
going to bother looking into this any further until you try the above
switches.  Please cancel this CR if that fixes the problem.

[9/29/94 public]
Does not core dump on crown when built properly.  

John B. created this stripped down program (and this CR) to illustrate a core 
dump occuring in a set of functional tests which are doing the same
sequence of calls to log themselves in (trying to make things easier to
reproduce, you know TET...)  John, maybe open one with the exact info from 
the FVT cores?

Cancelled.



CR Number                     : 12412
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : loops don't print result
Reported Date                 : 9/29/94
Found in Baseline             : 1.1b19
Found Date                    : 9/29/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/29/94 public]
We broke something recently....

The following command produces no output
dcecp> foreach i [group list subsys/dce/dts-servers] {
> princ show $i
> }

But this does.
dcecp> foreach i [group list subsys/dce/dts-servers] {
> puts $i
> }
/.../dcecp_cell.osf.org/hosts/frick/self
/.../dcecp_cell.osf.org/hosts/ice/self

This looks bad.

[9/29/94 public]
After some thought, this is not a bug. The foreach command is the one 
that is setting the result (to nothing). This is the correct behavior.



CR Number                     : 12410
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : gds_sec
Short Description             : Where did the DSAs go?
Reported Date                 : 9/29/94
Found in Baseline             : 1.1
Found Date                    : 9/29/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/29/94 public]

Using BL20, I ran the gds_sec test.  It passed.  However, this is what GDS
looked like afterwards:

#       PROCTYPE    PID    DIRID    IPCID    STATE
#
        Monitor     477      -        5        -        
        DUA-Cache   496      -        1        -        
        C-Stub      438      -        2        -        

No core files found.

In the gds_sec.log file there are many messages "The requestor does not
have permission to perform the operation."  Here's an example:

  ---> Start of  dap_b1.log
  
  TEST : sec_dap_b1
  EXPECTED : anonymous bind ok
  The requestor does not have permission to perform the operation.
  EXPECTED : show protected attr failed
  EXPECTED : simple bind ok
   1) /C=re/O=sni/OU=buba/CN=one
      User-Password : \x73\x65\x63\x72\x65\x74\x31
  EXPECTED : show protected attr succeeded
  Some part of the Directory Service is not willing to perform the operation.
  EXPECTED : DCE bind failed
    
Are these errors or part of the expected results?

Note that we ran into problems with CDS early in the test:

  TET - Test Environment Toolkit for testing GDS/Admin on a local machine
  TestSuite = gds_sec

  Configure DCE using cell_name:  C=ie/O=digital
  1994-09-29-11:03:51.687-04:00I----- cdsclerk(28769) ERROR cds general clerk_bind
  .c 490 0x007139d8
  Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
  1994-09-29-11:03:52.417-04:00I----- cdsclerk(28769) ERROR cds general clerk_bind
  .c 490 0x007139d8
  Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
  Login to DCE ...
    
Which may be related.  Defect 10566 (CDS) has been updated and upgraded to
priority 1.

So, would you consider this a passing test?

[09/29/94 public]
First: I consider gds_sec tests as passed if the journal.log file
says: 0 FAILED. I think it's possible that gds_sec tests work even if
you get these "Routine rpc_binding_set_auth_info(3rpc) failed " problem.
(We get it here too ...)
Second: These are expected results. If there is any error or unexpected
thing you'll see UNEXPECTED or ERROR.
Third: There are no DSA's because:
gds_sec tests configure dir. id 1 as client system.
Then they configure dir. id 11 and 12 and perform the tests.
Finally they remove dir. id 11 and 12.
So only dir. id 1 is there in the end - and this client system has no DSA's.
So: cancelled.



CR Number                     : 12382
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdsalias
Short Description             : cdsalias create always forces name to lowercase.
Reported Date                 : 9/28/94
Found in Baseline             : 1.1
Found Date                    : 9/28/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/28/94 public]

The 'cdsalias' commands force the alias name supplied to lower case 
before performing operation. 

   dcecp> cdsalias create /.../FOO
   dcecp> cdsalias cat
   {CDS_CellAliases 
    {Primary /.../drkstr}
    {Alias /.../foo}}
   dcecp> cdsalias create /.../SHIRT
   dcecp> cdsalias cat              
   {CDS_CellAliases 
    {Primary /.../drkstr}
    {Alias /.../foo}
    {Alias /.../shirt}}
   dcecp> cdsalias delete /.../SHIRT
   dcecp> cdsalias cat              
   {CDS_CellAliases 
    {Primary /.../drkstr}
    {Alias /.../foo}}

[9/28/94 public]
According to the AES object names and directory names in CDS are case 
exact. I can create objects /.:/Foo and /.:/foO as well as directories 
/.:/Users and /.:/userS and show them all. I verified that this works.

Also according to the AES names in the global namespaces gds and dns are
case insensitive. This means that cell names themselves in either of these
spaces must be case insensitive. What the AES doesn't say but seems to be
true is that cell names that are niether gds not dns are also case 
insensitive. At least I verified this in a single machine cell. I created
a cell as  /.../JOHN and can show it as either /.../JOHN or /.../john.
This all seems ok to me. It also makes sense, at least to me,  given the case 
insensitivity of cell names that aliases be cas insenitive. Other may disagree
with the later.

What I'm puzzled by and I want to know the answer to before I cancel this
is that when I do a show dir /.: on on the cell /.../JOHN it emits the cellname
in lower case /.../john. From the above the alias are also mapped to lower
case on output as well even though either case is taken as input. This
does have the potential of breaking shell scripts that create things
and then look for them. 

Another data point. /opt/dcelocal/dce_cf.db contains the cellname /.../JOHN
but getcellname emits /.../john.

[9/28/94 public]
Executive summary: This should be cancelled.

There are only three types of cellnames: GDS, DNS, CDS.  To be CDS it must
have more than one RDN.  So the examples above are either GDS or DNS.
Since there is no = in the first RDN it's a DNS name.  It might not be a
good name to put in a DNS service but it's a DNS name.

DNS names are case insensitive.  DCE outputs names in a canonicalized form.
For case insensitive names that form is in lowercase.  All of this should
be happening in rpc_ns_expand_name().

FYI: GDS names can be case exact or case inexact based on the syntax of the
particular attribute.  There are no attribute types defined by the standard
that are caseExact but that doesn't prevent someone from defining their
own.  There are additional rules in GDS strings though involving spaces.
leading and trailing spaces are not significant AND multiple consecutive
spaces are compressed to one space (believe it or not).  Fortunately this
stuff isn't used much :-)

[07/09/96 public]
Gee, it takes 22 months to clean this one up 8^(  As per Howard's research
and executive order, I'm canceling this OT.



CR Number                     : 12369
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : DFS leaving cred files behind
Reported Date                 : 9/27/94
Found in Baseline             : 1.1b18
Found Date                    : 9/27/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/27/94 public]

After running for several days it becomes apparent that DFS is leaving
expired credential files in the /opt/dcelocal/var/security/creds
directory.  I am not sure which DFS server is causing this, but by
using strings on the .data files it can be seen that the dfs-server
principal is responsible.

If left alone this causes the partition that
/opt/dcelocal/var/security/creds is on to run out of space and then
all of DCE will start having problems.

[9/27/94 public]
Assigned to me.  Mike, this looks related to OT12179.  Do you agree?

[10/3/94 public]
No, I don't think it's related.  I have no idea why it would be doing this.
Are you sure it's DFS leaving them behind, or is it tests running on that
system leaving them behind?

[10/24/94 public]
It serves no useful purpose to leave this open for 1.2, so it is
cancelled.  The problem may have been related to test programs leaving
creds behind, or maybe there simply wasn't enough room allocated for
creds.  In any case more data needs to be collected next time it
occurs for useful progress to be made (data on usage history, number
of cred files, size of cred files, total space used, etc.).



CR Number                     : 12358
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 12315
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : systest
Short Description             : dfs.read_write_all test fails w/ Conn timeouts
Reported Date                 : 9/27/94
Found in Baseline             : 1.1b18
Found Date                    : 9/27/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/27/94 public]

BUILD:	18.2
CONFIG:DFS on, AUDITING off - 9 hour dfs.read_write_all FAILED 
	plus DTS COMM FAILURES - unclear if any correlation exists
dce11 (h):	sec dts flserver (dfs)
dce8 (h):	cds dts flserver (dfs)
wolfboy (r):	dts flserver (dfs)

Attempted to run dfs.read_write_all.main w/ 3 users for 9 hours
overnight, only 1 user (on dce8) completed successfully. The
wolfboy user only lasted 6 hours, the dce11 user 8 hours.

wolfboy user:
tar: etc/zoneinfo/SystemV/AST4ADT: Cannot write extracted data: Connection timed out
check_CR[11]: dfs_1.tmplog: cannot create
tar_and_compress[27]: /:/dfsusers/dfs_1/utils/etc: bad directory
check_CR[11]: dfs_1.tmplog: cannot create
dfs_1 on wolfboy: FAILED - check the logs. Exiting ...

dce11 user:
check_CR[11]: dfs_2.tmplog: cannot create
dfs.test.Z: Connection timed out
tar: cannot open dfs.test
check_CR[11]: dfs_2.tmplog: cannot create
tar_and_compress[27]: /:/dfsusers/dfs_2/utils/etc: bad directory
dfs_2 on dce11: FAILED - check the logs. Exiting ...

DTS ERRORS:
dce11
1994-09-26-22:19:00.771-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x
401bf508 RPC call ClerkRequstTime() to remote server failed: Communications fail
ure (dce / rpc)
1994-09-26-22:19:09.427-04:00I----- dtsd ERROR dts dtserror dtss_service_global_
set.c 478 0x7aff8388 Couldn't get remote server's principal name: Communications
 failure (dce / rpc)
1994-09-27-07:54:04.016-04:00I----- dtsd ERROR dts dtserror dtss_service_global_
set.c 478 0x7aff8388 Couldn't get remote server's principal name: Communications
 failure (dce / rpc)

dce8
1994-09-26-20:13:09.010-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x
401bd458 RPC call ClerkRequstTime() to remote server failed: Communications fail
ure (dce / rpc)
1994-09-27-00:11:28.605-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x
401bf158 RPC call ClerkRequstTime() to remote server failed: Communications fail
ure (dce / rpc)
1994-09-27-00:22:05.964-04:00I----- dtsd ERROR dts dtserror dtss_service_global_
set.c 478 0x7aff8388 Couldn't get remote server's principal name: Communications
 failure (dce / rpc)
(next 2 AFTER the test completed)
1994-09-27-05:52:27.982-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x
401bf158 RPC call ClerkRequstTime() to remote server failed: Communications fail
ure (dce / rpc)
1994-09-27-05:52:34.633-04:00I----- dtsd ERROR dts dtserror dtss_service_global_
set.c 478 0x7aff8388 Couldn't get remote server's principal name: Communications
 failure (dce / rpc)

wolfboy
NO DTS ERRORS DURING OR AFTER TEST

Assigning to myself so I can rerun this (I had not rebooted/restarted
since a successful 48 hour cthon run so memory leaks may be involved)
in this cell AND in an HP-only cell.

[9/27/94 public]
Noticed that the dfsbind processes had clocked a lot of time so this
may be just another instance of the performance problems blocking
the fts tests, causing dfsbind to spin etc. Queueing this behind
verification of the 10766 fix.

[9/30/94 public]
All 3 users are still running after 15 hours on BL-20! There have only
been warnings during the test, no DTS errors! Test needs to make the
48 hour mark to PASS but it's well on its way. The dfsbind process
on all machines is not clocking anywhere near the amount of time it
had been.

[10/3/94 public]
Test ran successfully for 42.5 hours - at which point 1 of the users
got a Conn timeout failure - the other users completed with no problems ...
pretty darn close eh? Investigating to see if I can find out what
happened during hour # 42 ...

[10/4/94 public]
Because it made it beyond the 40 hour mark, lowering priority to 1.
If Gail Marie gets more data on the failure, there is always the
potential for bumping this up again.

[10/4/94 public]
Whoops.  Really update the priority.

[4/24/96 public]
This defect is no longer reproducible, so I am cancelling the ot.
In any case, I have recently made changes to this test that enable
it to run smoothly on IBM and Solaris platforms. In particular, I
have run 48 hour CHO (including this test) on IBM platform. The
revised test code will be included in 1.2.2.



CR Number                     : 12350
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : acl
Short Description             : acl bind's don't require res. name
Reported Date                 : 9/27/94
Found in Baseline             : 1.1b18
Found Date                    : 9/27/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/27/94 public]
I'm not sure about this one, maybe I'm crazy.  On absolut I did:

  dcecp> acl show  {14083b2e-d936-11cd-ab43-080009251352 ncacn_ip_tcp \
  > 130.105.5.93 principal/melman}
  {unauthenticated r-------g}
  {user_obj r---f--ug}
  {user cell_admin rcDnfmaug}
  {group acct-admin rcDnfmaug}
  {other_obj r-------g}
  {any_other r--------}
  dcecp> acl show  {14083b2e-d936-11cd-ab43-080009251352 ncacn_ip_tcp \
  > 130.105.5.45 principal/melman} 
  Error: Not registered in endpoint map

  dcecp> acl show {019ee420-682d-11c9-a607-08002b0dea7a ncacn_ip_tcp \
  > 130.105.5.45 principal/jas}
  {unauthenticated r--}
  {user 000030a7-d948-21cd-bf00-0800092734a4 rwc}
  {group 00000067-d946-21cd-bf01-0800092734a4 rwc}
  {any_other r--}
  dcecp>  acl show {019ee420-682d-11c9-a607-08002b0dea7a ncacn_ip_tcp \
  > 130.105.5.45 principal/melman}
  {unauthenticated r--}
  {user 000030a7-d948-21cd-bf00-0800092734a4 rwc}
  {group 00000067-d946-21cd-bf01-0800092734a4 rwc}
  {any_other r--}

The first one works great.  Then I changed the ip address to ice and got
an error, great.  I took a command line from CR 11635 and tried that and it
worked.   It also points to ice.  Then I tried the same binding but changed
the name to melman and still saw the same information.  But there is no
melman in the registry on ice.  To be clear, I did this all on absolut
which was a single machine cell and had not established intercell with
anyone, particularly ice.

[9/29/94 public]
You're not crazy. But it drove me crazy for a few minutes.

On absolut, we have:
{{object 019ee420-682d-11c9-a607-08002b0dea7a}
 {interface {000cf72e-0688-1acb-97ad-08002b12b8f8 1.0}}
 {binding {ncacn_ip_tcp 130.105.5.93 3605}}
 {annotation {Time SVC}}}

{{object 3442e97a-db84-11cd-b811-080009251352}
 {interface {b62dc198-dfd4-11ca-948f-08001e02594c 2.0}}
 {binding {ncacn_ip_tcp 130.105.5.93 3357}}
 {annotation {DCE user registry}}}

On ice, we have:
{{object 019ee420-682d-11c9-a607-08002b0dea7a}
 {interface {000cf72e-0688-1acb-97ad-08002b12b8f8 1.0}}
 {binding {ncacn_ip_tcp 130.105.5.45 2282}}
 {annotation {Time SVC}}}

{{object 693f2c16-db8d-11cd-82a1-0800092734a4}
 {interface {4c878280-5000-0000-0d00-028714000000 1.0}}
 {binding {ncacn_ip_tcp 130.105.5.45 2314}}
 {annotation {DCE user registry}}}

Notice that the Object UUID for the dts server is the same on both
machines.  In CR11635, I meant to use the OBJECT UUID of the 
security server and not the dts server.

So when you did:
dcecp> acl show {019ee420-682d-11c9-a607-08002b0dea7a ncacn_ip_tcp 130.105.5.45 principal/jas}
{unauthenticated r--}
{user 000030a8-db93-21cd-a300-0800092734a4 rwc}
{group 00000067-db8d-21cd-a301-0800092734a4 rwc}
{any_other r--}

In the above case, you are actually getting the dts server ACL object 
from ice. And since ice is the default cell on this ACL and there is 
no intercell connection to ice and ice is not in the 
/.../absolut_cell.osf.org, the keys for users and groups are displayed 
as UUIDs.

dcecp> acl sh {019ee420-682d-11c9-a607-08002b0dea7a ncacn_ip_tcp 130.105.5.93 x}
{unauthenticated r--}
{user hosts/absolut/self rwc}
{group subsys/dce/dts-admin rwc}
{any_other r--}

In the above, you are actually getting the dts server ACL
object from absolut.

*******
Also note that "acl_edit" and "dcecp acl" both expect a residual
name when performing ACL operations using string bindings. If a 
particular ACL manager does not require a residual name, then the
residual name is ignored. As is the case above. Notice:

dcecp> acl sh {019ee420-682d-11c9-a607-08002b0dea7a ncacn_ip_tcp 130.105.5.93}
Error: invalid acl handle

Should this be documented somewhere, Howard?  If not, I'll cancel
this defect.
*******

Here are some examples obtaining ACL objects from the registry:

dcecp> acl sh {3442e97a-db84-11cd-b811-080009251352 ncacn_ip_tcp 130.105.5.93 group/none}
{unauthenticated r-t-----}
{user cell_admin rctDnfmM}
{group_obj r-t-----}
{group acct-admin rctDnfmM}
{other_obj r-t-----}
{any_other r-t-----}
dcecp> acl sh {3442e97a-db84-11cd-b811-080009251352 ncacn_ip_tcp 130.105.5.93 org/none}
{unauthenticated r-t-----}
{user cell_admin rctDnfmM}
{group acct-admin rctDnfmM}
{other_obj r-t-----}
{any_other r-t-----}
dcecp> acl sh {3442e97a-db84-11cd-b811-080009251352 ncacn_ip_tcp 130.105.5.93 principal/cell_admin}
{unauthenticated r--------}
{user_obj rcDnfmaug}
{user cell_admin rcDnfmaug}
{other_obj r-------g}
{any_other r--------}

[3/28/95 public]
I'm trying to understand what the work item is here. Is this a doc change,
or should the code be changed to require residual names in certain instances?



CR Number                     : 12348
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp login bus error
Reported Date                 : 9/26/94
Found in Baseline             : 1.1b18
Found Date                    : 9/26/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/26/94 public]

I setup a cellalias using the "dcecp cellalias" command on node
A, then entered the alias into DNS and restarted gdad on node B
(both nodes are in separate cells). I tried to login from node
B to /.../<alias name of A>/cell_admin, which failed with 
"User Identification Failure. - Registry object not found."

The I started dcecp on node B and called a procedure which
simply executed "login cell_admin -password -dce-". Before
returning or outputting any message this crashed with the
output "Bus error(coredump)". 

The backtrace under xdb simply shows the stack as 
>t
 0 free@libc + 0x00000008 (hp-ux export stub)


I tried running dcecp again with the same result. 

This is using last night's build.

[9/26/94 public]
Kevin, you seem like the right person to start (and maybe finish :-) this
one...

[9/29/94 public]
The only part of this CR is a bus error that occurs on an HP.  The other
login problems mentioned here are handled by other CR's.  John has had
problems reproducing the bus error.  Will try again.

[9/29/94 public]
Maybe memory overwrites found in other OT's will fix...

[9/30/94 public]
I think that the memory fixes from yesterday worked. I have set up an
HP single machine cell (merckx.cell.osf.org) and a 486 single machine 
cell (rescue.cell.osf.org). I have aliased rescue.cell.osf.org to
search.cell.osf.org . I then register all of the above (merckx, rescue
and search) in DNS. Finally I aliased the krbtgt from rescue.cell.osf.org
to search.cell.osf.org on merckx. When trying to log into 
/.../search.cell.osf.org/cell_admin, it fails with "registry server 
unavailable" (as expected... there is a bug on this). From then on, this 
is where I saw the bug on Rick's machine. After about an hour of testing,
I can't reporduce the problem. Downgrading. Hope to cancel next week.

[10/3/94 public]
Cancel. Unable to reproduce.



CR Number                     : 12340
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dts
Subcomponent Name             : dtsd
Short Description             : dts stop makes dtsd spin
Reported Date                 : 9/26/94
Found in Baseline             : 1.1b19
Found Date                    : 9/26/94
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/26/94 public]
dcecp> dts stop 

...never returns. dtsd is now spinning on my machine.

% ps axu
USER       PID %CPU %MEM   VSZ  RSS TTY      STAT STARTED         TIME COMMAND
root      7131 56.8 10.4 16.1M 3.75 ??       R    12:09:18     2:23.28 dtsd -s
[[rousseau 9/26/94 public]
A regular 'kill' of the dtsd process (SIGTERM) made the process go away 
nicely (it cleaned up and all), so it wasn't in a very tight loop.

[9/26/94 public]
I can't reproduce this on my bl19 486 or HP.

Starting and stopping dtsd works fine.
Note that it take a while for dtsd to exit (5-10 seconds) after
receiving the stop command.

root@tsunami % dtsd -s
root@tsunami % dcecp -c dts stop

root@tsunami % ps -ef | grep dts 
    root 19366     1  0 11:59:05 ?        0:00 /opt/dcelocal/bin/dtstimed
    root 19370     1  0 11:59:06 ?        0:00 /opt/dcelocal/bin/dts_ntp_provider -h server4 -p 600 -i 30
    root 19496 16045  3 12:42:11 ttyp0    0:00 grep dts
ro

[9/26/94 public]
Pilot error on my part. Cancel. Sorry for the fire drill.



CR Number                     : 12335
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp principal show does not show ERAs
Reported Date                 : 9/26/94
Found in Baseline             : 1.1b18
Found Date                    : 9/26/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/26/94 public]

With bl-18.2 I tried to modify some principals after setting up the test environment
by hand. Running under root and dce_logged in as cell_admin I did:
 # dcecp
dcecp> princ show gds_invalid
{fullname {}}
{uid 354}
{uuid 00000162-d6b2-21cd-ae00-080009419c99}
{alias no}
{quota unlimited}
{groups gds_sec_grp}
dcecp> principal modify gds_invalid -add {X500_DSA_Admin {testvalue} \
  {/C=re/O=sni/OU=buba/CN=dsa/CN=dsa1}}
dcecp> show principal gds_invalid
{fullname {}}
{uid 354}
{uuid 00000162-d6b2-21cd-ae00-080009419c99}
{alias no}
{quota unlimited}
{groups gds_sec_grp}
dcecp> q

Testprograms verify, that the ERA value actually is present in the rgy
and assigned to that principal.

[9/26/94 public]
As of somewhere in bl18, there were two new switches added
to the pgo show command.  The '-all' switch is used to show
both regular and extended attribute data, so the command is...

dcecp> principal show -all gds_invalid
{fullname {}}
{uid 354}
{uuid 00000162-d6b2-21cd-ae00-080009419c99}
{alias no}
{quota unlimited}
{groups gds_sec_grp}
{X500_DSA_Admin {value}}
dcecp>

And the '-xattrs' switch is used to just show extended
attributes, so the command is...

dcecp> principal show -xattrs gds_invalid
{X500_DSA_Admin {value}}
dcecp>

And no switch shows just regular attribute, so the command is...

dcecp> principal show gds_invalid
{fullname {}}
{uid 354}
{uuid 00000162-d6b2-21cd-ae00-080009419c99}
{alias no}
{quota unlimited}
{groups gds_sec_grp}
dcecp>



CR Number                     : 12314
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : schema aclmgr
Short Description             : Can't manipulate ACLs on rgy schema objects
Reported Date                 : 9/23/94
Found in Baseline             : 1.1b18
Found Date                    : 9/23/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/23/94 public]

After creating rgy schema objects you can't look at or modify its
ACLs.  This was found by (and is blocking) systest eraobj001.
Simple example follows:
	dcecp> xattr show /.:/sec/xattrschema/fooattr
	{aclmgr {group {{query r} {update r} {test r} {delete r}}}}
	{annotation {}}
	{applydefs no}
	{encoding integer}
	{intercell reject}
	{multivalued yes}
	{reserved no}
	{scope {}}
	{trigbind {none {}}}
	{trigtype none}
	{unique no}
	{uuid 0d26c134-d64f-11cd-aa6d-0000c0b7df56}

	dcecp> acl show /.:/sec/xattrschema 
	{unauthenticated r----}
	{user cell_admin rcidm}
	{user 00002861-d619-21cd-aa00-0000c0b7df56 r-i--}
	{user 00002862-d619-21cd-aa00-0000c0b7df56 -c---}
	{user 00002864-d64f-21cd-aa00-0000c0b7df56 rc---}
	{user 00002867-d650-21cd-aa00-0000c0b7df56 rc---}
	{user seacladpomerolp rc---}
	{user foo rc---}
	{other_obj r----}
	{any_other r----}

	dcecp> acl show /.:/sec/xattrschema/fooattr
	Error: acl object not found

I've been told this DOES work with dced ERAs.

[9/23/94 public]
The security attrschema acl_mgr supports an acl on the 
/.:/sec/xattrschema object.  Security does not support ACLs
on schema entry objects.  It has a schema acl_mgr but not
a schema_entry acl_mgr. Evidently, dced does have an aclmgr 
for schema entry acls.  (inconsistent ACL models for attribute
schema objects...oh well)



CR Number                     : 12308
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : 
Short Description             : server started by "server start" doesn't always show up
Reported Date                 : 9/22/94
Found in Baseline             : 1.1b18
Found Date                    : 9/22/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/22/94 public]

I'm seeing something very odd when I start servers via "server start".
Most of them behave properly, but "cdsadv" doesn't appear in
config/srvrexec -- at least, "server cat -ex" doesn't show it. cdsadv
*does* start, and continue running. See sample dcecp session below.

The server shouldn't need to do anything to get recorded as executing,
should it? (Clearly it doesn't: the "dummy" server started below
executes a simple csh script that sleeps in a loop.)

I assume this is dced's problem.

dcecp> server show /.:/hosts/citron/config/srvrconf/cdsadv
{uuid a4954c08-d57c-11cd-9c34-0000c08de054}
{program /opt/dcelocal/bin/cdsadv}
{arguments {}}
{prerequisites {}}
{keytabs {}}
{entryname {}}
{services {}}
{principals {}}
{starton explicit}
{uid 0}
{gid 0}
{dir {}}
dcecp> server start /.:/hosts/citron/config/srvrconf/cdsadv
f72fbc7a-d642-11cd-9cc1-0000c055df56
dcecp> server cat hosts/citron -ex
                                                   <<< no server
dcecp> server start /.:/hosts/citron/config/srvrconf/dtsd   
1f121594-d643-11cd-9cc1-0000c055df56
dcecp> server cat hosts/citron -ex                        
/.../speed_cell/hosts/citron/config/srvrexec/dtsd  <<< no cdsadv
dcecp> server start /.:/hosts/citron/config/srvrconf/dummy
cbb4c4b8-d643-11cd-9cc1-0000c055df56
dcecp> server cat hosts/citron -ex
/.../speed_cell/hosts/citron/config/srvrexec/dtsd
/.../speed_cell/hosts/citron/config/srvrexec/dummy  <<< no cdsadv
dcecp> server show /.:/hosts/citron/config/srvrexec/cdsadv -ex
Error: Cannot find a matching object.

[citron]

% ps -e | grep cdsadv
14012 ??       S        0:02.53 /opt/dcelocal/bin/cdsadv
13600 pts/5    S  +     0:00.03 grep cdsadv

[9/22/94 public]
Guessing aloud here....

Does cdsadv daemonize itself? (ie, among other stuff, fork/exec with parent
exiting?)  If so, then dced may be getting teh SIGCHILD from the cdsadv
it spawned (exited parent) and correctly reaping it from its list of
running children.

[9/22/94 public]

Looks like you're right. 'ps -ef' shows that cdsadv's parent is init.
The dtsd I'm starting is a clerk, and its parent is dced. I guess dced
is doing the "right" thing (what else could it do?), but it's sort of
a pain.

[9/22/94 public]
As far as I know, "dtsd" figures out if it was started by dce, then does the
right thing in terms of daemonizing.  I'm sure cdsd and friends fork, the
parent exits, and dced thinks it's done.

If we all agree, this should be canced, I guess.

Or, Robert, do cdsadv and friends have a flag that says to run in the forground?
(dced had "-f").  If so, you could specify that flag on the cmd line in the
srvrconf object and try that way.

[9/22/94 public]
Cancelled.  But, I want to throw out a warning of potential bootstrapping
problems when starting dced daemons with dced.  There is a required ordering 
and prior to starting cdsd/dtsd process, a need to do a "dcecp -c secval
activate" to wait for secval to setup the machine principal environment on
the machine.

See the /etc/rc.dce on a host and server to see what needs to be done.



CR Number                     : 12303
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : secd core dump in idle cell w/ open dcecp session
Reported Date                 : 9/22/94
Found in Baseline             : 1.1b18
Found Date                    : 9/22/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/22/94 public]

Yesterday I configged a single node cell w/ bl 18 on an HP.
Left last night in a dce_login and dcecp session.  This a.m.
secd had coredumped.  No svc errors recorded; empty secd.log.

> t
 0 free@libc + 0x00000008 (hp-ux export stub)
 1 cma_lib_malloc@libdce + 0x00000288 (0x7aff0740, 0, 0, 0)
 2 malloc@libc + 0x000004a8 (0x401280b8, 0x404440b8, 0x6e, 0)
 3 krb5_rc_dfl_expunge@libdce + 0x00000048 (0x401280b8, 0x4029e2d8, 0, 0)
 4 krb5_rc_dfl_store@libdce + 0x000000e8 (0x401280b8, 0x4029e2d8, 0x1, 0x1)
 5 krb5_rd_req_decoded@libdce + 0x000004dc (0x40196920, 0x403cfc68, 0x4029db50, 0)
 6 kdc_process_tgs_req + 0x0000050c (0x40442aa8, 0x4029db48, 0x4029db60, 0x4029e124)
 7 process_tgs_req + 0x000000f0 (0x40442aa8, 0x4029db48, 0x4029db60, 0x4029db68)
 8 dispatch + 0x000002a0 (0x4029db60, 0x4029db48, 0x4029db68, 0x4043bb2c)
 9 rsec_krb5rpc_sendto_kdc + 0x00000100 (0x40442310, 0x3b4, 0x404459c0, 0x1000)
10 op0_ssr + 0x00000244 (0x40442310, 0x40442188, 0x4029d53c, 0x4029d520)
11 rpc__dg_execute_call@libdce + 0x00001dd8 (0x40442188, 0, 0, 0)
12 cthread_call_executor@libdce + 0x000002d4 (0x40196658, 0x7af511d8, 0x401ff5a8, 0xf)
13 cma__thread_base@libdce + 0x0000021c (0x401ff5a8, 0, 0, 0)
14 cma__thread_start1@libdce + 0x0000004c (0x401ff5a8, 0, 0, 0)
15 cma__thread_start0@libdce + 0x00000008 (0x401ff5a8, 0, 0, 0)
16 cma__thread_start0@libdce + 0x00000008 (0x401ff5a8, 0, 0, 0)
...

[9/22/94 public]
How big is the core file???  If it's huge (or at least big enough to use
up most of the swap space that other processes and DCE daemons aren't using)
then it's a memory leak dup of 10924.  Any build on or after 9/22 should
be much better...

[9/22/94 public]
Not very big:

yosemite /opt/dcelocal/var/security K# ls -l core
-rw-rw-rw-   1 root     sys      5739356 Sep 22 09:16 core
yosemite /opt/dcelocal/var/security K# ls -s core
11232 core

[9/22/94 public]
My feeling is that the fix I just submitted for ot12106 will fix this one also. 
Would you please check this one out tomorrow after the new build is done. 
Thanks.

[9/23/94 public]
While testing again can never hurt, I see no reason why ot12106 would have
any affect on this problem.  That CR had to do with creating a schema entry
corrupting memory, while this one is in an idle cell (ie: no test that would
be creating schema entries).  I agree with the assessment above that it's
not a memory leak problem given the relatively small size of the core file.

NOTE!!! That traceback looks kind of strange (malloc@libc calling cma_malloc
calling free@libc ???).   I haven't checked yet, but I have no idea why
cma_malloc would want to call free and it doesn't seem possible for the real
malloc to be calling cma_malloc() (it should be the other  way around).
BUT!  Also note that 
 4 krb5_rc_dfl_store@libdce + 0x000000e8 (0x401280b8, 0x4029e2d8, 0x1, 0x1)
is where one of the last remaining memory leaks that Sentinel is complaining
about is coming from.  We had dismissed it for not because it was basically
storing things in a krb5 replay cache that had to stay around for a while
and I couldn't figure out how to get it to purge the cache (like it was when
it core dumped in 
 3 krb5_rc_dfl_expunge@libdce + 0x00000048 (0x401280b8, 0x4029e2d8, 0, 0)
above.  So, this bad free could be why there's a memory leak (not freeing
the correct pointer which usually just leaks memory, but can cause the above
problem occasionally).

[11/21/94 public]

I'm cancelling this OT.  This problem was never seen again at OSF and I am
unable to reproduce it here at HP.  If anyone else stumbles across this, please
open an new OT with additional info.



CR Number                     : 12302
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10703
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : audit
Short Description             : Add command to allow audit trail file size to be changed
Reported Date                 : 9/22/94
Found in Baseline             : 1.1b18, 1.2
Found Date                    : 9/22/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/22/94 public]
When CR 10703 was fixed, the ability to create an audit trail with
a given limit (auditrailfilesize) was added.  An api for this was
created at that time as well as an environment variable.

It would be nice if auditd and dcecp were enhanced to allow the trailfilesize
of the central audit trail to be changed.

[9/25/95 public]
Currently, DCE Administrator can use -s option, i.e auditd -s <trail_file_limit>to change the size. Do you really want dcecp to support the same option, too???

[9/28/95 public]
After reviewed the Audit Spec, I think this may be a good idea.  Once, the size
is set from either environment variable DCEAUDITTRAILSIZE or from -s option,
we should let DCE user change it by using dcecp.  My suggestion would be:

   dcecp -c aud change -size <newtrailsize>

The <newtrailsize> will be passed to dce_aud_set_trail_size_limit() to set the
new size for the trail file.

[10/31/95 public]
I'm not convinced that this would be very useful. I would like to vote for
cancelling this. I think there are enough avenues to change the trail size
without resorting to another. This would only allow changing the central
trail file and not any random trail file. If I lose this vote, than the
dcecp syntax should be:

dcecp> aud modify {trailsize <new_size>}
and
dcecp> aud modify -trailsize <new_size>

There is no need to create a new aud operation for this.

Just to reiterate, this should be cancelled.

[10/22/96 public]
Cancel, for the reasons John mentions above.



CR Number                     : 12295
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : server conf
Short Description             : fopen() in dced failing on server start
Reported Date                 : 9/21/94
Found in Baseline             : 1.1b18
Found Date                    : 9/21/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/21/94 public]

Put serverexec FVT into infinite loop.  After a few minutes, the dced began
reporting this message:

  1994-09-21-17:42:45.082-04:00I----- dced ERROR dhd srvrconf scops.c 442
  0x005cbe98
  The fopen() call failed during svrvconf_start

run out of file descriptors in the dced??  Plenty of disk space, not too
many files in /tmp.

[09/21/94 public]
Gaak, did we really forget to record errno in the message?
Mistake.  Look at all svcprintf calls and make sure to print errno
where appropriate.  will make debugging much easier.

[9/22/94 public]
Cancelled.  Can not reproduce, ran srvrexec FVT in loop for ~1 hour
on both platforms.  It is possible that there was some
environment thing (swap, disk space, humidity) that was transient.
Also, the problem was seen while running in the debugger, possible
that the debugger session was affecting?

errno being put in SVC messages by JB....



CR Number                     : 12281
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : Something is slowing down DFS...
Reported Date                 : 9/21/94
Found in Baseline             : 1.1b18
Found Date                    : 9/21/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/21/94 public]

This is a place holder.

We are seeing severe slow downs of DFS functional and system tests.
I am investigating.....



CR Number                     : 12274
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : rgy_edit cell failure
Reported Date                 : 9/20/94
Found in Baseline             : 1.1b18
Found Date                    : 9/20/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/20/94 public]

Several times today I have attempted to establish intercell
authentication between 2 OSF/1 systems using DNS. Each time I have
reinstalled and configured the cells from scratch, and each time
I get the following :

rgy_edit=> cell /.../meadows.qadce.osf.org  
Enter group name of the local account for the foreign cell: none
Enter group name of the foreign account for the local cell: none
Enter org name of the local account for the foreign cell: none
Enter org name of the foreign account for the local cell: none
Enter your password:    (enter -dce-)
Enter account id to log into foreign cell with: cell_admin
Enter password for foreign account:  (enter -dce-)
Enter expiration date [yy/mm/dd or 'none']: (none) 
?(rgy_edit) Incomplete cell add - Invalid password (Registry Edit
Kernel) (dce / sad)

I've successfully setup intercell communication using BL18
earlier.

[9/21/94 public]
Using the latest bits from Nightly (9/21), the following worked successfully:
1. Configured a single machine cell on HP/UX.
2. Configured a single machine cell on 486.
3. Ran cdscp defined cached server command on both machines.
4. Ran rg_edit cell command on both machines.
5. Logged in from one cell to the other as cell_admin.

Everything worked ok.
spring : dce_login cell_admin -dce-
Password must be changed!
spring : cdscp define cached server sunrise tower ncacn_ip_tcp:130.105.4.197
spring : rgy_edit
Current site is: registry server at /.../hp_cell/subsys/dce/sec/master 
rgy_edit=> cell /.../486_cell
Enter group name of the local account for the foreign cell: none
Enter group name of the foreign account for the local cell: none
Enter org name of the local account for the foreign cell: none
Enter org name of the foreign account for the local cell: none
Enter your password:   
Enter account id to log into foreign cell with: cell_admin
Enter password for foreign account: 
Enter expiration date [yy/mm/dd or 'none']: (none) 
  Principals and Accounts have been created
rgy_edit=> quit
bye.
spring : exit
spring : klist
No DCE identity available: No currently established network identity for
which context exists (dce / sec)

Kerberos Ticket Information:
Ticket cache: /tmp/krb5cc_1359
Default principal: tester@hp_cell
spring : dce_login /.../486_cell/cell_admin -dce-
Password must be changed!
spring : klist
DCE Identity Information:
        Warning: Identity information is not certified
        Global Principal: /.../486_cell/cell_admin
        Cell:      0d2e5c3e-d54e-11cd-960a-0000c04fd04c /.../486_cell
        Principal: 00000064-d54e-21cd-9600-0000c04fd04c cell_admin
        Group:     0000000c-d54e-21cd-9601-0000c04fd04c none
        Local Groups:
                0000000c-d54e-21cd-9601-0000c04fd04c none
                00000064-d54e-21cd-8b01-0000c04fd04c acct-admin
                00000065-d54e-21cd-8b01-0000c04fd04c subsys/dce/sec-admin
                00000066-d54e-21cd-8b01-0000c04fd04c subsys/dce/cds-admin
                00000067-d54e-21cd-8b01-0000c04fd04c subsys/dce/dts-admin
                0000006a-d54e-21cd-8b01-0000c04fd04c subsys/dce/audit-admin

Identity Info Expires: 94/09/21:20:27:07
Account Expires:       never
Passwd Expires:        never

Kerberos Ticket Information:
Ticket cache: /opt/dcelocal/var/security/creds/dcecred_1e94e300
Default principal: cell_admin@486_cell
Server: krbtgt/486_cell@486_cell
        valid 94/09/21:10:27:07 to 94/09/21:20:27:07
Server: dce-rgy@486_cell
        valid 94/09/21:10:27:08 to 94/09/21:20:27:07
Server: krbtgt/hp_cell@486_cell
        valid 94/09/21:10:27:09 to 94/09/21:20:27:07
Server: dce-rgy@hp_cell
        valid 94/09/21:10:27:47 to 94/09/21:20:27:07
Server: dce-ptgt@486_cell
        valid 94/09/21:10:33:56 to 94/09/21:12:33:56
Client: dce-ptgt@486_cell       Server: krbtgt/486_cell@486_cell
        valid 94/09/21:10:33:57 to 94/09/21:12:33:56
Server: dce-ptgt@hp_cell
        valid 94/09/21:10:34:37 to 94/09/21:12:34:37
Client: dce-ptgt@486_cell       Server: krbtgt/hp_cell@486_cell
        valid 94/09/21:10:34:00 to 94/09/21:12:33:56
Client: dce-ptgt@486_cell       Server: dce-ptgt@hp_cell
        valid 94/09/21:10:34:38 to 94/09/21:12:33:56
Client: dce-ptgt@hp_cell        Server: krbtgt/hp_cell@hp_cell
        valid 94/09/21:10:34:39 to 94/09/21:12:33:56
Client: dce-ptgt@hp_cell        Server: dce-rgy@hp_cell
        valid 94/09/21:10:34:39 to 94/09/21:12:33:56
Client: dce-ptgt@486_cell       Server: dce-rgy@486_cell
        valid 94/09/21:10:34:02 to 94/09/21:12:33:56

Rick, could you plaese clean-up, re-install and see if yoy can re-produce
the rgy_edit cell failure problem. If not, please cancel this CR.

[ sekhar 9/21/94 public ]

Rick, could you please double check to make sure that the 
cell_admin password for the cell /.../meadows.qadce.osf.org 
is indeed -dce- . If not, you would get the error "Invalid password" .

[9/21/94 public]

Yes, the password is -dce- on both sides. I rebooted both systems
since they'd been up a couple of months, then setup serviceability
started dce, and tried rgy_edit cell again. Same result. I'll try
installing bl18.1 on both nodes.

[9/21/94 public]
We (Rick and I) used the NB to isolate the problem further and here are the
findings. (HP-HP configuration is not tested yet)

1. HP - 486 rgy_edit cell command works both ways using cdscp define cached 
            server instead of gdad/DNS.
2. 486 - 486 rgy_edit cell command fails with the error as indicated by
   Rick above using cdscp define cached server as well as gdad/DNS.

Here is the output when cell command fails:

rgy_edit=> cell /.../woodlands.qadce.osf.org
(rca_lock_handle) locking 442de0
(rca_unlock_handle) unlocking 4c5740
(rca_lock_handle) locking 442de0
(rca_check_binding) checking 4c5740
(rca_unlock_handle) unlocking 4c5740
Enter group name of the local account for the foreign cell: none
Enter group name of the foreign account for the local cell: none
Enter org name of the local account for the foreign cell: none
Enter org name of the foreign account for the local cell: none
(rca_lock_handle) locking 442de0
(rca_check_binding) checking 4c5740
(rca_unlock_handle) unlocking 4c5740
(rca_lock_handle) locking 442de0
(rca_check_binding) checking 4c5740
(rca_unlock_handle) unlocking 4c5740
Enter your password:   
Enter account id to log into foreign cell with: cell_admin
Enter password for foreign account: 
Enter expiration date [yy/mm/dd or 'none']: (none) 
(binding_cache_lookup) Looking for site /.../woodlands.qadce.osf.org, cell
, princ dce-rgy, type 0
(binding_cache_lookup) Looking at 4c5740: site
`/.../486_cell/subsys/dce/sec/master' cell `/.../486_cell' princ
`dce-rgy@486_cell' 1
Site mismatch
(binding_cache_lookup) Looking at 4c5c40: site
`/.../486_cell/subsys/dce/sec/master' cell `/.../486_cell' princ `(null)' 0
Site mismatch
(binding_cache_lookup) Cache miss
(rca_site_bind_nsi) Attempting to bind to site /.../woodlands.qadce.osf.org
(rca_site_bind_nsi) import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Attempting to bind to cell
/.../woodlands.qadce.osf.org
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==4c6240
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../woodlands.qadce.osf.org, status 0
(rca_setup_handle) Replace entry name with
/.../woodlands.qadce.osf.org/subsys/dce/sec/master
(rca_site_bind) Bound to Cell '/.../woodlands.qadce.osf.org'
(rca_site_bind) Bound to Site
'/.../woodlands.qadce.osf.org/subsys/dce/sec/master'
(rca_lock_handle) locking 4438b0
(rca_unlock_handle) unlocking 4c5f40
(rca_site_bind) String Binding
'b5c34960-d565-11cd-a32a-0000c06ad04c@ncacn_ip_tcp:130.105.5.138[1475]'
Purging binding cache
(binding_cache_enter) Adding 4c5f40 to binding cache: site
/.../woodlands.qadce.osf.org/subsys/dce/sec/master cell
/.../woodlands.qadce.osf.org princ (null) type 0
(rca_lock_handle) locking 4438b0
(rca_unlock_handle) unlocking 4c5f40
(rca_lock_handle) locking 4438b0
4c5f40: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 4c5f40
(rca_lock_handle) locking 5f45e0
(rca_check_binding) checking 4c6140
(rca_unlock_handle) unlocking 4c6140
(rca_lock_handle) locking 442de0
(rca_check_binding) checking 4c5740
(rca_unlock_handle) unlocking 4c5740
(rca_lock_handle) locking 5f45e0
4c6140: Dropping site refcount from 1 to 0
(rca_unlock_handle) unlocking 4c6140
(binding_cache_lookup) Looking for site /.../486_cell, cell , princ
dce-rgy, type 0
(binding_cache_lookup) Looking at 4c5f40: site
`/.../woodlands.qadce.osf.org/subsys/dce/sec/master' cell
`/.../woodlands.qadce.osf.org' princ `(null)' 0
Site mismatch
(binding_cache_lookup) Looking at 4c5740: site
`/.../486_cell/subsys/dce/sec/master' cell `/.../486_cell' princ
`dce-rgy@486_cell' 1
info_type mismatch, none expected
(binding_cache_lookup) Looking at 4c5c40: site
`/.../486_cell/subsys/dce/sec/master' cell `/.../486_cell' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 4c5c40
returning cached context 4c5c40
(rca_lock_handle) locking 443a60
(rca_check_binding) checking 4c5c40
(rca_unlock_handle) unlocking 4c5c40
(binding_cache_lookup) Looking for site /.../woodlands.qadce.osf.org, cell
/.../woodlands.qadce.osf.org, princ dce-rgy, type 0
(binding_cache_lookup) Looking at 4c5f40: site
`/.../woodlands.qadce.osf.org/subsys/dce/sec/master' cell
`/.../woodlands.qadce.osf.org' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 4c5f40
returning cached context 4c5f40
(rca_lock_handle) locking 4438b0
(rca_check_binding) checking 4c5f40
(rca_unlock_handle) unlocking 4c5f40
(rca_lock_handle) locking 4438b0
4c5f40: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 4c5f40
(rca_lock_handle) locking 443a60
4c5c40: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 4c5c40
(binding_cache_lookup) Looking for site /.../woodlands.qadce.osf.org, cell
/.../woodlands.qadce.osf.org, princ (null), type 0
(binding_cache_lookup) Looking at 4c5f40: site
`/.../woodlands.qadce.osf.org/subsys/dce/sec/master' cell
`/.../woodlands.qadce.osf.org' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 4c5f40
returning cached context 4c5f40
(rca_lock_handle) locking 4438b0
(rca_check_binding) checking 4c5f40
(rca_unlock_handle) unlocking 4c5f40
(rca_lock_handle) locking 4438b0
4c5f40: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 4c5f40
?(rgy_edit) Incomplete cell add - Invalid password (Registry Edit Kernel)
(dce / sad)

[ sekhar 9/21/94 public ]

Turning on DEBUG_SEC will not really help in this case 
since DEBUG_SEC is turning on debugging in registry binding code
and there are no problems here ( as also indicated by the trace above ).

There are only a handful of places where this error code "Invalid passwd"
is generated (and where the real error is being mapped to this error). So 
I will instrument the code to dump the real error code and we should 
try to reproduce the problem with the instrumented version. This won't
fix the problem but hopefully yield more information.

[9/21/94 public]

Some more data points. Using gdad/DNS, HP-HP works, HP to OSF
works, OSF to HP works, but OSF to OSF doesn't work.

[09/21/94 public]

This could be a bug in the login preauthentication code.

Please try the following to isolate the problem further:

1) kill sec_clientd or turn off the secval portion of dced (not sure how to do this)
2) dce_login (intercell)

If it works, it's a good bet it is a problem in the preauth code.

[ sekhar 9/21/94 public ]

Checked in sec_login_pvt.c . Please rebuild libdce with 
sec_login_pvt.c version 1.1.35.2 .

Then before invoking rgy_edit turn on debug 

   export SVC_SEC_DBG=sec:*.1:STDERR:--

[ sekhar 9/23/94 public ] 

Reproduced the problem locally here with HP-OSF cell. Both HP and OSF
are running bl-18 . And the problem appears to be occuring only when
gdad is configured.  I will start debugging and update this OT when
I have more information.

[9/28/94 public]
Adding some information.  Configuration is two single-machine cells running
binaries from nightly build of 9/27 (BL19.1+)  Cells are configured with
X.500 names, are running GDS, and GDS intercell has been set up -- thus,
gdad is running.  

rgy_edit=> cell /.../c=us/o=osf/ou=dce/cn=haven
Enter group name of the local account for the foreign cell: none
Enter group name of the foreign account for the local cell: none
Enter org name of the local account for the foreign cell: none
Enter org name of the foreign account for the local cell: none
Enter your password:   
Enter account id to log into foreign cell with: cell_admin
Enter password for foreign account: 
Enter expiration date [yy/mm/dd or 'none']: (none) 
?(rgy_edit) Incomplete cell add - Invalid password (Registry Edit Kernel) (dce / sad)
rgy_edit=> quit
bye.

Note that UX->486 and 486->UX GDS intercell work fine.  I haven't tried
UX->UX yet.

[9/29/94 public]
Found the problem with rgy_edit cell command giving Invalid password error.
The clocks on these machines were off by more than 7 minutes. After
bringing both clocks to the same time, rgy_edit cell command worked
successfully. dce_login to the foreign cell also worked. These are the
machines we were having problems running rgy_edit cell command for last two
days. That is the reason why some people saw this problem intermittently.
We will cancel this CR once Bill or Mike confirms what is mentioned here.
CR 12278 still needs further investigation.

[9/29/94 public]
Confirmed:  You can get invalid password errors if the clocks are skewed.
If you no longer see the problem with the fixed clocks, then this should
be cancelled.  If it really bothers you that this was so hard to find, open
an enhancement request, asking for improved error message (or if that's not
possible because of compatibility reasons, then at least serviceability
points that would've shown us the clock skew message) when this happens...



CR Number                     : 12269
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : general
Short Description             : dcp_id_parse_name should be in general location
Reported Date                 : 9/20/94
Found in Baseline             : 1.1
Found Date                    : 9/20/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : util_general.c util_general.h rgy.h rgy_utils.c
Sensitivity                   : public

[9/20/94 public]

The function dcp_id_parse_name should be in a general location.

[9/21/94 public]

Basicly not worth the trouble. At best the prototype should be moved to 
a general location.



CR Number                     : 12266
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : dts
Short Description             : dts show produces Memory fault.
Reported Date                 : 9/20/94
Found in Baseline             : 1.1
Found Date                    : 9/20/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/20/94 public]

Executing a 'dts show' produces a memory fault. 
Here is the sequence I used.

dcecp> lca
Password must be changed!
dcecp> dts mod -minserver 1
dcecp> dts show
Memory fault


gdb did not give me much:

Starting program: /bin/dcecp 
dcecp> dts show

Program received signal 11, Segmentation fault
0xa400db88 in _doprnt ()
-> bt
#0  0xa400db88 in _doprnt ()
#1  0xa403f4b4 in vsprintf ()
Cannot access memory at address 0x2.

[9/20/94 public]
I can't reproduce this on any machine, including yours. I'll leave this
open for a while in case one of us can come up with more info.

[9/22/94 public]
Downgraded in preparation for a cancel.



CR Number                     : 12251
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dts
Subcomponent Name             : 
Short Description             : dtsd core dumps after ~6hrs
Reported Date                 : 9/19/94
Found in Baseline             : 1.1b18
Found Date                    : 9/19/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/19/94 public]
CONFIG:
  osf/1   sec master, dtsd local server
  hpux    cds server, dtsd local server
  osf/1   client, dtsd local server

Dtsd core dumped after 6hrs of running security system tests.  Not
sure if this core info is helpful:
Core was generated by `dtsd'.
Program terminated with signal 10, Bus error.
#0  0xa4224936 in sdb ()
(gdb) break main
Breakpoint 1 at 0x4024ea
(gdb) run
Starting program: /opt/dcelocal/bin/dtsd 

Breakpoint 1, 0x4024ea in main ()
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0xa4224936 in recv_pkt (Cannot access memory at address 0xa4224924.
(gdb) where
#0  0xa4224936 in recv_pkt (Cannot access memory at address 0xa4224924.
(gdb)

[9/28/94 public]
I have a 3 server, 1 clerk cell running bl-19, and I have not
seen any dtsd problems.  Has any system testing seen this again?
The backtrace above isn't helpful.
Possible security defect that got fixed?

[9/28/94 public]
Haven't seen it in a while so we'll cancel and can re-open if it 
pops back up.



CR Number                     : 12239
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : cm fvt test3 fails to set cache size
Reported Date                 : 9/19/94
Found in Baseline             : 1.1b18
Found Date                    : 9/19/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/19/94 public]

The following failures occur when running the cm fvt tests as root/cell_admin

cm setcachesize 12345
cm: Invalid argument.
- failed (test3 E13)

cm getcachesize | grep 12345
- failed to set cachesize properly (test3 E14)

cm setcachesize 0
cm: Invalid argument.
- failed to set cachesize properly (test3 E15)

cm setcachesize 1
cm: Invalid argument.
- failed (test3 E19)

cm setcachesize -reset
cm: Invalid argument.
- failed (test3 E22)

[9/27/94 public]

Canceled.  My mistake.  I was trying to run the tests against a memory
cache.  These operations are only valid for disk caches.



CR Number                     : 12238
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dced
Subcomponent Name             : 
Short Description             : dced seg violation
Reported Date                 : 9/19/94
Found in Baseline             : 1.1b18
Found Date                    : 9/19/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/19/94 public]

DFS CHO cell config'd with bl-18
secd on RIOS (m1) died w/in 6 hours of config (CR 12236)

root@cobbler> ls -l /opt/dcelocal/dce_cf.db
-rw-r--r--   1 root     bin           60 Sep 16 18:21 /opt/dcelocal/dce_cf.db

root@cobbler> ls -l /opt/dcelocal/var/security/core
-rw-rw-rw-   1 root     bin      5189323 Sep 17 00:16 /opt/dcelocal/var/security/core

dced died on HP (m3) 4 hours after that.

root@dce11> ls -l  /opt/dcelocal/./var/dced/core                              
-rw-rw-rw-   1 root     sys      6501212 Sep 18 04:32 /opt/dcelocal/./var/dced/core

No tests had been or were running at the time.

Copyright Hewlett-Packard Co. 1985,1987-1992. All Rights Reserved.
<<<< XDB Version A.09.01 HP-UX >>>>
Core file from:  dced
Child died due to: segmentation violation
Warning:  "/project/dce/build/dce1.1-snap/src/admin/dced/server/main.c" is younger than "/opt/dcelocal/bin/dced" (UE86).
Procedures:    332
Files: 33

 0 memcpy@libc + 0x00000008 (hp-ux export stub)
 1 rpc__naf_tower_flrs_to_addr@li + 0x00000050 (0xd2010006, 0x400f4560, 0x400f44ac, 0x40307070)
 2 rpc_tower_to_binding@libdce + 0x00000088 (0xd2010006, 0x400f44e0, 0x400f44ac, 0)
 3 ping_server (ep = 0x403f0390, timeout = 3, status = 0x400f44ac)    [/project/dce/build/dce1.1-snap/src/admin/dced/server/oeops.c: 339]
 4 ep_sliv_task1 (arg = 0x40013840)    [/project/dce/build/dce1.1-snap/src/admin/dced/server/oeops.c: 398]
 5 cma__thread_base@libdce + 0x0000021c (0x40031a10, 0, 0, 0)

DFS CHO config:
1 RIOS X 3 HP
 m1 (R) = security server, dts server, flserver, fileserver (native and lfs)
 m2 (H) = cds server, dts server, flserver, fileserver (native and lfs)
 m3 (H) = dts server, flserver, fileserver (native and lfs)
 m4 (H) = client-only

[9/21/94 public]
I can't make this happen.  I'm running nightly bld of last night.  Of course
this is hard to reproduce.  If dced is dying because secd died, it took 4
hours to affect dced.  (If that's the case, doesn't this bring it down to
something less than A0?)

Does it still do it?  Rich made a handful of changes to oeops.c this weekend
(post-bl18), one of which had to do with cleaning up dead endpoints.

[9/21/94 public]
You're right - it actually took 1 day PLUS 4 hours (oops!) for this to
happen after the secd core dump and it's unclear what behavior is expected
after the 1 and only secd in the cell dies ... dced dying is nasty too, 
but since the data in this CR isn't very useful, and it hasn't been seen
again, downgrading in preparation of a cancel.

[10/03/94 public]
Gail and I talked about this (over tea and crumpets) and we decided it's
time to pass this OT on to its great reward, under the guise of "machine
resources" a/k/a "out of swap for some reason."  Cancel.



CR Number                     : 12230
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : dce_login
Short Description             : dce_login hangs after setting up intercell authentication
Reported Date                 : 9/16/94
Found in Baseline             : 1.1b17
Found Date                    : 9/16/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/16/94 public]

While trying to perform a network login to a remote cell using a 
single-line command ( dce_login <cell/principal> passwd ),
my process hangs after echoing the message "Password must
be changed!" 

If I instead (in a new process) perform the dce_login with interactive
prompting, it works fine.

[9/16/94 public]

Oops, no, in today's case interactive use of dce_login doesn't work
either.

Also, the same problem recurs in BL18 (from HP to OSF/1). 
Is it actually the same problem as was reported in CR 12178?

[9/22/94 public]

Using BL18.2, I establish intercell authentication from an HP
system to an OSF system using gdad/DNS. I then try to authenticate
locally using "dce_login cell_admin -dce-". The message "Password
must be changed!" is displayed and then the process hangs.

I can perform the same login from within dcecp at this point 
successfully.

I can also use the back door "dce_login_noexec" to login 
successfully.

[9/27/94 public]

Using 9/26 nightly build bits did the follwing:
1. Configured a single machine cell on HP/UX.
2. Configured a single machine cell on 486/OSF1.
3. Ran cdscp define cached server on HP/UX.
4. Ran rgy_edit cell to add account in foreign cell (486).
5. Logged into foreign cell as cell_admin with no problem; i.e. it comes
   back with promnpt and is not hung as above comment indicates.

# dce_login cell_admin -dce-
Password must be changed!
# rgy_edit
Current site is: registry server at /.../hp_cell/subsys/dce/sec/master 
rgy_edit=> exit
bye.
# cdscp define cached server sunrise tower ncacn_ip_tcp:130.105.4.197
# rgy_edit
Current site is: registry server at /.../hp_cell/subsys/dce/sec/master 
rgy_edit=> cell /.../486_cell
Enter group name of the local account for the foreign cell: none
Enter group name of the foreign account for the local cell: none
Enter org name of the local account for the foreign cell: none
Enter org name of the foreign account for the local cell: none
Enter your password:   
Enter account id to log into foreign cell with: cell_admin
Enter password for foreign account: 
Enter expiration date [yy/mm/dd or 'none']: (none) 
  Principals and Accounts have been created
spring : dce_login /.../486_cell/cell_admin -dce-
Password must be changed!
spring : 

Rick, could you do the similar steps as above (configure two cells, add
account for foreign cell and log into foreign cell and see if you can
re-create the above hang problem. If not, please cancel this CR. Thanks.

[9/28/94 public]

We've been doing a great deal of intercell testing recently
against BL19 and haven't seen this problem recur, so it's
cancelled.



CR Number                     : 12229
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : server
Short Description             : server_stop() does not delete
the server entry information from the srvrexec database.
Reported Date                 : 9/16/94
Found in Baseline             : 1.1b18
Found Date                    : 9/16/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/16/94 public]

A test server is started with dced_server_start(). 
When terminated with dced_server_stop() [with method hard],
the test server is killed. But the server entry information [exec]
is still available. This info can be accessed from dced_object_read() API
or dcecp server cata -exec commands.

[9/22/94 public]
Cancelled.  No longer occurs.  Saw this myself last week so possibly
fixed by reparations made to scops.c/sxops.c in past few days.



CR Number                     : 12208
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : intercell
Short Description             : Intercell doesn't work when the target is an HP/UX machine via DNS.
Reported Date                 : 9/15/94
Found in Baseline             : 1.1
Found Date                    : 9/15/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/15/94 public]

As per Rob's request (CR 11623), opening a new CR for the HP-HP intercell
problem.

Here are the deatils from CR 11623:

[9/14/94 public]
This thing doesn't seem to want to die. Rick fadden opened 12007 basically
stateing that teh rgy_edit cell command doesn't workbetween two hps. Ihave
tested
intercell several times during the past few days between an hp and a 486
but
not hp to hp. I check this morning and rick was correct. Its a bit
different
than before though. I set up the dns data base brought up gdad and checked
unauthenticated access to the other cell. It worked. I then ran the
rgy_edit
cell command. It hung forever. At least I waited about 15 or 20 minutes. No
message it just hung after asking all of its questions. I sigterm'd it and
edited the pe_site file. The rgy_edit cell command then worked. I only
tried
once and only thought dns. I will tray again in the morning and do it
through
define cache server.

[9/15/94 public]
As Rob mentioned in the CR he closed again yesterday (where this problem
was reported and then asked to be moved), telling us that it's hung does
nothing to help us narrow down the problem.  When you're reporting a hung
process, please send it a signal to coredump (ctrl-\ is the easiest way)
and let us know what the traceback is.  If it's a rgy_edit command or
anything that's likely to be hung binding to a registry server, please
rerun it with the environment variable DEBUG_SEC set (Rob likes 3, I prefer
all the output and just set it to 10) so we can see what it was doing when
it hung.  NOTE:  Unless it's stuck in an infinite loop (in which case you'll
see the DEBUG_SEC input continue forever, and top will show lots of CPU
usage), then about the only place it can hang is within CDS (RPC times out,
CDS can hang you because it uses UDS to communicate between your process
and the clerk).

[9/19/94 public]

Continuing the saga... With bl18 installed, I find the same
behavior from an OSF/1 machine to an HP/UX as I'd noted earlier
between two HP/UX machines. I don't encounter the hanging
situation that John mentions, but get back a quick registry
server unavailable error:

?(rgy_edit) Incomplete cell add - Registry server unavailable
(Registry Edit Kernel) (dce / sad)

As before, after I edit the pe_site files between the two machines
the rgy_edit cell command works.

[9/19/94 public]
We have changed dce_config such that in order to run gdad you must go
through the additional server configuration option. You can no longer
just type gdad & to bring it up. I suspect Rick was doing the later.
I ran intercell between a 486 and an hp after doing define cached server
to inform one machine about the other's name space. This worked fine. I'll
check to make sure it also works after configuring gdad but even if that
doesn't work its not security's problem. If it works after define cached
server security is off the hook. Note - we still believe the hp - hp 
connection is broken.  I will however do a check on this shortly. You 
never know it may work.

[9/19/94 public]
And in fact the 486-hp intercell works both through define cached server and
gdad. I haven't been able to corner an hp to check out hp-hp. I'll recheck
that as soon as I can get my hands on one.

[9/19/94 public]
OK. Intercell seems to be working hp-hp now. Go figure.
I'll drop the priority on this and check it once or twice over the next 
couple of days. If it works ok I'll cancel this in a day or two.

[9/23/94 public]
Well, it's been a day or two?  Has anybody been able to reproduce this lately?

[9/23/94 public]
Using BL18.2, HP-HP and OSF to HP both work using gdad/DNS.
Cancelled.



CR Number                     : 12180
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : client
Short Description             : cdsadv and cdsclerk coredumps
Reported Date                 : 9/14/94
Found in Baseline             : 1.1b17
Found Date                    : 9/14/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/14/94 public]

hp800 config'd as a dts local server in a dfs cell (1 day later
than rest of nodes in cell)

cdsadv and cdsclerk core dumps 1 minute apart:

-rw-rw-rw-   1 root     sys      5260156 Sep 13 18:23 cdsadv/core
-rw-rw-rw-   1 root     sys      5886844 Sep 13 18:24 cdsclerk/core

which was 2-3 hours after config of this machine

no tests were running on or to this machine (tests were running on
2 of the other machines in the cell, cell contains 3 cds servers,
2 on RIOS, 1 on another HP)

cdsadv:
Core file from:  cdsadv
Child died due to: segmentation violation
Procedures:      0
Files: 0
 0 CA_FreeListRemove + 0x00000078 (0x807a33bc, 0x4, 0x8, 0x4001211c)
 1 CA_FreeListFree + 0x00000378 (0x807a31a8, 0x80799b28, 0x6, 0x400106d0)
 2 CA_InsertCle + 0x00000aac (0x40365740, 0x40153434, 0x40364bc0, 0)
 3 CAInsertClearinghouse + 0x000001cc (0x40363a79, 0x40153434, 0x40364bc0, 0)
 4 adver_cache_add_cle + 0x000000fc (0x400a32c0, 0x40363a79, 0x40153434, 0x403639b5)
 5 cds_advertisement + 0x00000350 (0x4036290c, 0x40362f28, 0x400deea8, 0)
 6 cds_Advertise_s + 0x00000124 (0x400e38e8, 0x4036290c, 0x40362f28, 0x400deea8)
 7 op1_ssr + 0x00000180 (0x400e38e8, 0x4014d850, 0x4036253c, 0x40362520)
 8 rpc__dg_execute_call@libdce + 0x00001dd8 (0x4014d850, 0, 0, 0)
 9 cthread_call_executor@libdce + 0x000002d4 (0x4014d3a0, 0x7af4e478,
  0x401668f8, 0x16)
10 cma__thread_base@libdce + 0x0000021c (0x401668f8, 0, 0, 0)
11 cma__thread_start1@libdce + 0x0000004c (0x401668f8, 0, 0, 0)
12 cma__thread_start0@libdce + 0x00000008 (0x401668f8, 0, 0, 0)
13 CA_FreeListRemove + 0x00000078 (0, 0, 0, 0)
14 rpc_x_call_id_not_found@libdce + 0xc51629f8 (Address not found (UE302)

cdsclerk:
Core file from:  cdsclerk
Child died due to: segmentation violation
Procedures:      0
Files: 0
 0 CA_FreeListRemove + 0x00000078 (0x807a33bc, 0x4, 0x8, 0x40017024)
 1 CA_FreeListAlloc + 0x000000e4 (0x210, 0x2, 0x8, 0x40016e6c)
 2 CA_GlobalAlloc + 0x0000008c (0x210, 0x2, 0x6, 0x400154b8)
 3 CA_InsertCle + 0x0000046c (0x402b298c, 0x40484e50, 0x402b2584, 0x1)
 4 CAClearinghousesUsed + 0x000001a4 (0x40484e48, 0x1, 0x3, 0x40003c88)
 5 clerk_request + 0x00000940 (0x4023c4d8, 0x4023c6d0, 0x9, 0x40018d88)
 6 th_start + 0x000000cc (0x4023c6d0, 0x7af4e478, 0x4017b978, 0x3c)
 7 cma__thread_base@libdce + 0x0000021c (0x4017b978, 0, 0, 0)
 8 cma__thread_start1@libdce + 0x0000004c (0x4017b978, 0, 0, 0)
 9 cma__thread_start0@libdce + 0x00000008 (0x4017b978, 0, 0, 0)
10 CA_FreeListRemove + 0x00000078 (0, 0, 0, 0)
11 _end + 0x0015b248 (Address not found (UE302)

[9/21/94 public]
Dropping to a 1 as this is NOT blocking system test ... cache corruption
seems like a REALLY bad thing however, especially since there was
no activity on the machine and the only unique thing was that it was
added into the cell late ... I'm doing this "late addition" again today -
with bl-18 - will update if seen again.

[9/26/94 public]
Really dropped ot to a 1.

[10/12/94 public]
We have some code for that fixes a window of vulnerability in th ecache code.
Its for 1.0.3 and Janet is looking at it to see if it applies to 1.1; the
code has changed somewhat between the two releases. Up'ing this to a 0
and susan will mark it as UHYPE. If it doesn't apply to 1.1 we will drop it.

[10/19/94 public]
The code from hp really does some thingsappropriate fo r1.0.3 only. Janet 
doesn;t think the window that the code addresses is an open one in the current
code. This hasn't happened since this occurrence. Droping to a 1. It may be
an open window but its a very small one. Hp is running with code much closer to
1.0.3.

[07/09/96 public]
I'm canceling this OT since the above indicates that it occurred with
1.0.3-based code.  Feel free to re-open if it occurs again against R1.1
or R1.2-based code.



CR Number                     : 12178
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : intercell login failure
Reported Date                 : 9/14/94
Found in Baseline             : 1.1b17
Found Date                    : 9/14/94
Severity                      : B
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/14/94 public]

I have an intercell configuration with cells /.../dcecp_cell.osf.org and
/.../rescue_cell.osf.org. Use the following script, INTERCELL_SCRIPT,
to reproduce this problem since it's intermittent.

-----CUT HERE----------

proc intercell_prin {} {
    
    set DCP_CLIENT cell_admin
    set DCP_CLIENT_PW dcecp
    set DCP_CELLNAME_TWO /.../rescue_cell.osf.org
    set i 0


    for {set i 0} {$i < 50} {incr i} {
        login $DCP_CELLNAME_TWO/$DCP_CLIENT -password $DCP_CLIENT_PW
	set rc [catch "principal create $DCP_CELLNAME_TWO/prin$i" create_result]
        logout
	puts $create_result
        login $DCP_CELLNAME_TWO/$DCP_CLIENT -password $DCP_CLIENT_PW
	set rc [catch "principal delete $DCP_CELLNAME_TWO/prin$i" delete_result]
        logout
	puts $delete_result
    }

}

-----CUT HERE----------

Under gdb:
dcecp> source INTERCELL_SCRIPT
dcecp> intercell_prin

Program received signal 11, Segmentation fault
0xa4003548 in malloc ()
(gdb) bt
#0  0xa4003548 in malloc ()
#1  0xa40034a8 in malloc ()
#2  0xa41cdd95 in rpc__mem_alloc (12, 63, 0)
#3  0xa41e23fe in rpc__tower_ref_alloc
    (7703236, 5, 1, -1073758680, -1073755928)
#4  0xa41dbd84 in rpc__naf_tower_flrs_to_addr
    (7703236, -1073758640, -1073755928)
#5  0xa41e158b in rpc_tower_to_binding (7703236, 7598632, -1073755928)
#6  0xa431874d in rca_rebind_tower (7598616, -1073755928)
#7  0xa431a726 in rca_site_bind_from_tower_vec
    (8360704, 7445336, 7444504, -1073755956, -1073755960, -1073755928)
#8  0xa431b875 in rca_site_resolve_update
    (-1073755956, 7941856, -1073755960, -1073755928)
#9  0xa42f7bbc in sec_rgy_site_bind_update
    (5307456, -1073755956, -1073755960, -1073755928)
#10 0x41411c in open_site_by_access (site=0x50fc40 "/.../rescue_cell.osf.org", 
    access=0xbfffcd30)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c:831
#11 0x413d64 in open_rgy_site (interp=0x5830b0, 
    name=0xbfffd9c0 "/.../rescue_cell.osf.org", access=site_update)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c:720
#12 0x410c4a in principal_create (clientData=0x0, interp=0x5830b0, argc=2, 
    argv=0xbfffe3fc)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy.c:650
#13 0x4028d5 in dcp_principal (clientData=0x0, interp=0x5830b0, argc=2, 
    argv=0xbfffe3fc)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:1113
#14 0x4b6c79 in Tcl_Eval (5779632, -1073748330)
#15 0x4b7b11 in Tcl_CatchCmd (0, 5779632, 3, -1073748400)
#16 0x4b6c79 in Tcl_Eval (5779632, 6510914)
#17 0x4cbbd0 in TclParseNestedCmd
    (5779632, 6510914, 0, -1073747672, -1073747592)
#18 0x4cc0c5 in TclParseWords
    (5779632, 6510906, 0, 8, -1073747672, -1073747692, -1073747636, -1073747592)
#19 0x4b664c in Tcl_Eval (5779632, 6510835)
#20 0x4b83b1 in Tcl_ForCmd (0, 5779632, 5, -1073746916)
#21 0x4b6c79 in Tcl_Eval (5779632, 6520584)
#22 0x4cdd2b in InterpProc (6537352, 5779632, 0, -1073745988)
#23 0x4b6c79 in Tcl_Eval (5779632, -1073744088)
#24 0x4c925b in Tcl_RecordAndEval (5779632, -1073744088, 0)
#25 0x4007ff in main (argc=1, argv=0xbffff824)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:445


Also, note that the following FVT intercell cells tests are core
dumping:
acl_modify_051_P
acl_modify_054_P
acl_modify_061_P
acl_modify_071_P
acl_modify_091_P
acl_modify_101_P
acl_modify_134_P

[9/14/94 public]

/.../dcecp_cell.osf.org has the master security replica on a HP-UX
platform.  /.../rescue_cell.osf.org has the master security replica 
on an OSF/1 platform.

I've modified the above script to narrow down the problem. It's
still intermittent. But it seems to be a problem with logging into
a foreign cell.

----CUT HERE----------------------------

proc intercell_login {} {
    
    set DCP_CLIENT cell_admin
    set DCP_CLIENT_PW dcecp
    set DCP_CELLNAME_TWO /.../rescue_cell.osf.org
    set i 0


    for {set i 0} {$i < 50} {incr i} {
	set rc [catch "login $DCP_CELLNAME_TWO/$DCP_CLIENT -password $DCP_CLIENT_PW" create_result]
	puts $create_result
	set rc [catch "logout" delete_result]
	puts $delete_result
    }

}

----CUT HERE----------------------------


Under gdb:
dcecp> source INTERCELL_SCRIPT2
dcecp> intercell_login

Program received signal 11, Segmentation fault
0xa4003548 in malloc ()
(gdb) bt
#0  0xa4003548 in malloc ()
#1  0xa40034a8 in malloc ()
#2  0xa438b55f in asn1_alloc_malloc (20, 0)
#3  0xa447382d in krb5_timestamp2asn1_field (-1073760544, 8740400)
#4  0xa44716bb in krb5_authenticator2Authenticator (-1073760556, 8740368)
#5  0xa446ff6e in krb5_encode_generic
    (-1073760556, -1073760560, -1538904040, 52, -1538904248,
    -1538845096, -1538905288)
#6  0xa447f799 in krb5_mk_req_extended
    (0, -1073760388, 0, 0, 0, 0, -1073760040, 0, -1073760400)
#7  0xa44835b9 in krb5_send_tgs
    (0, 8713212, 1, 2, 8761160, 8710944, 0, 0, 0, -1073760040,
    -1073760224)
#8  0xa447cb65 in krb5_get_cred_via_tgt (-1073760040, 0, 1, 2,
    8713192)
#9  0xa447c9d2 in krb5_get_cred_from_kdc (8770328, 8713192,
    -1073759868)
#10 0xa447d48c in krb5_get_credentials (16, 8770328, 8713192)
#11 0xa4346f6a in sec_krb_get_cred
    (8787392, 8673656, 5, 1, 8735324, -1073759756)
#12 0xa423d760 in rpc__krb_get_tkt (8735240)
#13 0xa423ddf7 in rpc__krb_bnd_set_auth
    (8740624, 5, 8787392, 1, 8738568, -1073759656, -1073749868)
#14 0xa41d20f1 in rpc_binding_set_auth_info
    (8738568, 8740624, 5, 1, 8787392, 1, -1073749868)
#15 0xa431850a in rca_setup_handle (8738312, -1073749868)
#16 0xa4319a45 in rca_site_bind_nsi_cell_if
    (8738312, 8741584, -1538564748, -1073749868)
#17 0xa4319c31 in rca_site_bind_nsi_cell (8738312, 8741584,
    -1073749868)
#18 0xa4317cd7 in rca_nsi_binding_import (8738312, -1073749868)
#19 0xa431acb4 in rca_site_bind
    (-1073756836, -1073755764, 2, -1538547864, -1540001130, 8787392,
    -1073750048, -1073749868)
#20 0xa4357327 in bind_to_rgy
    (8787392, 1, 1, 8787392, -1073750048, -1073749868,
    -1073755184)
#21 0xa4359fe9 in sec_login_pvt_get_login_info
    (0, 8787392, -1073750012, -1073749868)
#22 0xa43507af in sec_login_validate_identity
    (8787392, -1073749856, -1073749308, -1073749316, -1073749868)
#23 0x405d09 in dcp_login (clientData=0x0, interp=0x5830b0, argc=2, 
    argv=0xbfffe3fc)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:3036
#24 0x4b6c79 in Tcl_Eval (5779632, -1073748330)
#25 0x4b7b11 in Tcl_CatchCmd (0, 5779632, 3, -1073748400)
#26 0x4b6c79 in Tcl_Eval (5779632, 7366405)
#27 0x4cbbd0 in TclParseNestedCmd
    (5779632, 7366405, 0, -1073747672, -1073747592)
#28 0x4cc0c5 in TclParseWords
    (5779632, 7366397, 0, 8, -1073747672, -1073747692,
    -1073747636, -1073747592)
#29 0x4b664c in Tcl_Eval (5779632, 7366395)
#30 0x4b83b1 in Tcl_ForCmd (0, 5779632, 5, -1073746916)
#31 0x4b6c79 in Tcl_Eval (5779632, 7364832)
#32 0x4cdd2b in InterpProc (6683360, 5779632, 0, -1073745988)
#33 0x4b6c79 in Tcl_Eval (5779632, -1073744088)
#34 0x4c925b in Tcl_RecordAndEval (5779632, -1073744088, 0)
#35 0x4007ff in main (argc=1, argv=0xbffff824)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:445


Now, I'll attempt to recreate this using "dce_login" and update this CR.

[9/15/94 public]

FYI, I modified the above script to do local cell logins and
everything works fine.  Something like:

----CUT HERE----------------------------

proc local_login {} {
    
    set DCP_CLIENT cell_admin
    set DCP_CLIENT_PW dcecp
    set i 0


    for {set i 0} {$i < 50} {incr i} {
	set rc [catch "login $DCP_CLIENT -password $DCP_CLIENT_PW" create_result]
	puts $create_result
	set rc [catch "logout" delete_result]
	puts $delete_result
    }

}

----CUT HERE----------------------------

[9/19/94 public]
FYI, a fix to sec_login_..._pvt when into the build right after bl18.  This
could be fix already, it needs to be tested to see if it's recreatable.

[ sekhar 9/20/94 public ]

Julie, can you please see if this problem is still reproducable 
with the latest build ?

[9/20/94 public]

I have bl18 right now. I'm installing and re-configuring our intercell
configuration with last night's build. I will try to re-create this 
defect - keep you posted.

[ sekhar 9/20/94 public ]

I could not reproduce this problem locally here using a HP-HP 
intercell , with bl-17 + internal_binding.c (with my SVC changes)
using either of the scripts i.e. intercell_login() or intercell_princ()

[9/14/94 public]

I have re-installed with bl18.2 and configured the same intercell 
configuration with cells /.../dcecp_cell.osf.org and /.../rescue_cell.osf.org. 
/.../dcecp_cell.osf.org has the master security replica on a HP-UX platform.  
/.../rescue_cell.osf.org has the master security replica on an OSF/1 platform.

Using the same procedure above, intercell_login, there is still an
intermittent problem with logging into a foreign cell.

Program received signal 11, Segmentation fault
0xa4003548 in malloc ()
(gdb) bt
#0  0xa4003548 in malloc ()
#1  0xa40034a8 in malloc ()
#2  0xa438b2e7 in asn1_alloc_malloc (19, 0)
#3  0xa447afbe in krb5_data2asn1_field (7329112, 7341940)
#4  0xa447b26f in krb5_principal2PrincipalRealm (7254056, 7341948, 7341940)
#5  0xa447942f in krb5_ticket2Ticket (7254056, 7341936)
#6  0xa447782e in krb5_encode_generic
    (7254056, -1073753248, -1538880648, 40, -1538880856, -1538812920, -153888133
#7  0xa4485929 in krb5_cache_as_reply (7342256, 7293708, 7329752)
#8  0xa435ffa7 in sec_login_pvt_get_and_process_krb_tgt
    (7359176, -1073750864, 0, -1073750940)
#9  0xa435056e in sec_login_validate_identity
    (7359176, -1073750864, -1073750948, -1073750952, -1073750940)
#10 0x404f32 in dcp_login (clientData=0x0, interp=0x5630b0, argc=2, argv=0xbfffdff0)
    at /project/dce/build/dce1.1/src/admin/dcecp/commands.c:3067
#11 0x497549 in Tcl_Eval (5648560, -1073749366)
#12 0x4983e1 in Tcl_CatchCmd (0, 5648560, 3, -1073749436)
#13 0x497549 in Tcl_Eval (5648560, 6379773)
#14 0x4ac4a0 in TclParseNestedCmd
    (5648560, 6379773, 0, -1073748708, -1073748628)
#15 0x4ac995 in TclParseWords
    (5648560, 6379765, 0, 8, -1073748708, -1073748728, -1073748672, -1073748628)
#16 0x496f1c in Tcl_Eval (5648560, 6379763)
#17 0x498c81 in Tcl_ForCmd (0, 5648560, 5, -1073747952)
#18 0x497549 in Tcl_Eval (5648560, 6456472)
#19 0x4ae5fb in InterpProc (6406280, 5648560, 0, -1073747024)
#20 0x497549 in Tcl_Eval (5648560, -1073744092)
#21 0x4a9b2b in Tcl_RecordAndEval (5648560, -1073744092, 0)
#22 0x4007db in main (argc=5648560, argv=0xbffff81c)
    at /project/dce/build/dce1.1/src/admin/dcecp/main.c:498

[9/27/94 public]

I have re-installed with bl19 and configured the same intercell 
configuration with cells /.../dcecp_cell.osf.org and 
/.../rescue_cell.osf.org. 
/.../dcecp_cell.osf.org is a 3 machine cell and has the master security replica on a HP-UX platform.  
/.../rescue_cell.osf.org is a 1 machine cell and has the master security replica on an OSF/1 platform.

Other notes:
Using DNS, gdad is running on the master security server in each
cell.

Using the same procedure above, intercell_login, there is still an
intermittent problem with logging into a foreign cell.

Program received signal 11, Segmentation fault
0xa4003548 in malloc ()
(gdb) bt
#0  0xa4003548 in malloc ()
#1  0xa40003f4 in calloc ()
#2  0xa448048a in krb5_copy_principal (8158016, 8011532)
#3  0xa44828c1 in krb5_get_cred_via_tgt (-1073759764, 0, 1, 2, 8011528)
#4  0xa4482362 in krb5_get_cred_from_kdc (8146848, 8011528, -1073759592)
#5  0xa4482e1c in krb5_get_credentials (16, 8146848, 8011528)
#6  0xa43490d2 in sec_krb_get_cred (8206008, 8156384, 5, 1, 7971700, 
    -1073759480)
#7  0xa423d950 in rpc__krb_get_tkt (7971616)
#8  0xa423dfe7 in rpc__krb_bnd_set_auth (8016080, 5, 8206008, 1, 
    6807864, -1073759380, -1073749592)
#9  0xa41d20f1 in rpc_binding_set_auth_info (6807864, 8016080, 5, 1, 
    8206008, 1, -1073749592)
#10 0xa431a282 in rca_setup_handle (8045472, -1073749592)
#11 0xa431b7bd in rca_site_bind_nsi_cell_if
    (8045472, 8105056, -1538539708, -1073749592)
#12 0xa431b9a9 in rca_site_bind_nsi_cell (8045472, 8105056, -1073749592)
#13 0xa4319a4f in rca_nsi_binding_import (8045472, -1073749592)
#14 0xa431ca2c in rca_site_bind (-1073756560, -1073755488, 2, 
    -1538522716, -1539992402, 8206008, -1073749772, -1073749592)
#15 0xa435953f in bind_to_rgy (8206008, 1, 1, 8206008, -1073749772, 
    -1073749592, -1073754908)
#16 0xa435c221 in sec_login_pvt_get_login_info (0, 8206008, 
    -1073749736, -1073749592)
#17 0xa43529c7 in sec_login_validate_identity (8206008, -1073749580, 
    -1073749032, -1073749040, -1073749592)
#18 0x405f11 in dcp_login (clientData=0x0, interp=0x58c0b0, argc=2, 
    argv=0xbfffe510)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:3067
#19 0x4bf9d9 in Tcl_Eval (5816496, -1073747909)
#20 0x4c10f1 in Tcl_ForCmd (0, 5816496, 5, -1073748000)
#21 0x4bf9d9 in Tcl_Eval (5816496, 6547672)
#22 0x4d6a2b in InterpProc (6735696, 5816496, 0, -1073747072)
#23 0x4bf9d9 in Tcl_Eval (5816496, -1073744116)
#24 0x4d1f5b in Tcl_RecordAndEval (5816496, -1073744116, 0)
#25 0x40094f in main (argc=1, argv=0xbffff808)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:498

[9/30/94 public]
In doing 12150 work & encountering a similar traceback/memory problem, using
Sentinel points out some instances of unchecked allocations in the sec server:

rs/rpriv_util.c:	krb5_copy_principal(req_info->authent->ticket->server,
rs/rs_rep_auth.c:	krb5_copy_principal(creds->client, &creds->server);
rs/rs_rep_auth.c:	krb5_copy_keyblock_contents(tkt->enc_part2->session,
rsdb/kdb_rsdb.c:	krb5_copy_principal(princ, &entry->principal);

The latter is being tripped over due to a bogus-length principal string;
it may not be directly relevant to this problem, but all are worth fixing...

[10/2/94 public]
This CR is being assigned to dcecp. On Friday the tests were ran by Julie
and John and there was no core dump as in the previous test runs. Also in
parallel set-up Sekhar and Sean also ran Julie's test script and got
successful results. John Rousseau mentioned that there were few memory
related fixes submitted in the dcecp since last time this tests were
executed. At this point it is assigned to dcecp for further testing and
if no errors are found again this CR should be cancelled.

Thanks to Sekhar, Sean, Julie and John for providing the needed support
to isolate and analyze the problem.

[10/3/94 public]
Downgraded. This problem is no longer reproducable. Julie is retesting now,
if the problem still doesn't present itself. This will be canceled.

[10/3/94 public]
Julie just ran a loop of 100 intercell login and logouts without
failure. Cencel.



CR Number                     : 12171
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : keytab
Short Description             : dcecp> key show /krb5/v5srvtab -local dumps core
Reported Date                 : 9/13/94
Found in Baseline             : 1.1b17
Found Date                    : 9/13/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/13/94 public]

This is bad:
dcecp> key show /krb5/v5srvtab -local

(gdb) where
#0  0xa42b128d in dced_binding_set_auth_info (h=0x0, protect_level=6, 
    authn_svc=4294967295, authn_identity=0x62b2f0, authz_svc=2, st=0xbfffdbcc)
    at /project/dce/build/dce1.1-snap/src/admin/dced/api/dced_binding.c:346
#1  0x487cb3 in dcp_kt_show (clientData=0x0, interp=0x5830b0, argc=2, 
    argv=0xbfffde24)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_keytab.c:1446
#2  0x403895 in dcp_keytab (clientData=0x0, interp=0x5830b0, argc=3, 
    argv=0xbfffde24)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:1660
#3  0x4b6c79 in Tcl_Eval (5779632, -1073749748)
#4  0x4cd726 in Tcl_UplevelCmd (0, 5779632, 1, -1073749816)
#5  0x4b6c79 in Tcl_Eval (5779632, -1073748350)
#6  0x4cbbd0 in TclParseNestedCmd
    (5779632, -1073748350, 0, -1073749092, -1073749012)
#7  0x4cc0c5 in TclParseWords
    (5779632, -1073748358, 0, 8, -1073749092, -1073749112, -1073749056, -1073749012)
#8  0x4b664c in Tcl_Eval (5779632, -1073748364)
#9  0x4b951f in Tcl_IfCmd (0, 5779632, 3, -1073748452)
#10 0x4b6c79 in Tcl_Eval (5779632, 6723580)
#11 0x4b951f in Tcl_IfCmd (0, 5779632, 3, -1073747848)
#12 0x4b6c79 in Tcl_Eval (5779632, 5867840)
#13 0x4cdd2b in InterpProc (6460296, 5779632, 0, -1073746920)
#14 0x4b6c79 in Tcl_Eval (5779632, -1073745020)
#15 0x4c925b in Tcl_RecordAndEval (5779632, -1073745020, 0)
#16 0x4007ff in main (argc=1, argv=0xbffff480)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:445

[9/13/94 public]
The problem was introduced around bl-17 in dced_binding.c and was
fixed [by accident] in latest build. Please try the NB's dcecp and 
cancel this OT if it works, Thanks.

"key show /krb5/v5srvtab -local" will not work, "key show self"
is right one. "-local" is a special option which allows you to
bypass dced but everything is kept in core only. You may want to
see OT#11280 for the details.



CR Number                     : 12170
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : keytab
Short Description             : keytab cata -local dumps core
Reported Date                 : 9/13/94
Found in Baseline             : 1.1b17
Found Date                    : 9/13/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/13/94 public]

This is bad:
dcecp> keytab cata -local
Segmentation fault (core dumped)


Running straight b17.

Back trace:
(gdb) bt
#0  0xa41d302f in rpc_binding_free (4199856, -1073747504)
#1  0xa42b146e in dced_binding_free (h=0x4015a8, st=0xbfffe9d0)
    at /project/dce/build/dce1.1-snap/src/admin/dced/api/dced_binding.c:443
#2  0x48521a in dcp_kt_catalog (clientData=0x0, interp=0x5830b0, argc=1, 
    argv=0xbfffec18)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_keytab.c:309
#3  0x403895 in dcp_keytab (clientData=0x0, interp=0x5830b0, argc=2, 
    argv=0xbfffec18)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:1660
#4  0x4b6c79 in Tcl_Eval (5779632, -1073745020)
#5  0x4c925b in Tcl_RecordAndEval (5779632, -1073745020, 0)
#6  0x4007ff in main (argc=1, argv=0xbffff480)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:445

[9/13/94 public]
The problem was introduced around bl-17 in dced_binding.c and was
fixed [by accident] in latest build. Please try the NB's dcecp and 
cancel this OT if it works, Thanks.

[9/19/94 public]
Yep, fixed:

  root@absolut /$ dcecp -s                                                
  dcecp> key cat -local
  dcecp>



CR Number                     : 12165
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : gdad
Short Description             : gdad default principal isn't correct
Reported Date                 : 9/13/94
Found in Baseline             : 1.1
Found Date                    : 9/13/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/13/94 public]

HP reports that the default principal that gdad uses when it
doesn't find anything in the cds.conf file is incorrect.

[9/13/94 public]
turns out the gda and cdsd call dce_cf_get_host_name which returns
hosts as part of the string so this works as is.
HP was looking at code, didn't actually try it.



CR Number                     : 12156
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : xattrschema
Short Description             : dcecp xattrschema does't verify the input xattrschema object
Reported Date                 : 9/13/94
Found in Baseline             : 1.1b17
Found Date                    : 9/13/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/13/94 public]

xattrschema should verify the attr schema object name which should
contain "xattrschema" as leading part, and if it's not presented,
xattrschema object should attach it to the object name,  otherwise 
the rpc_ns_entry_expand_name gives you wrong fullnames. For example, 
/.:/sec, after parsed, the schema server name is "/.:/sec", and schema 
object name is NULL, if you don't attach "xattrschema" to the schema
object name, the one of output from "xattrschema  cata /.:/sec" will
be "/.../foster_cell/sec/pre_auth_req", the correct one should be
"/.../foster_cell/sec/xattrschema/pre_auth_req". 

Currently the schema object name is ignored on both sec schema and 
dced schema implementations because they assume only one schema object
is being used (i.e. xattrschema). I'm also going to add some logic into 
generic schema i/f to check "xattrschema" and reject if a wrong schema object
name is found. But I know that dcecp xattrschema doesn't use the generic 
schema i/f for security (i.e /.:/sec), the check logic need also to be 
implemented in dcecp as well.

dcecp> xattrschema  cata /.:/sec
/.../foster_cell/sec/pre_auth_req
/.../foster_cell/sec/pwd_val_type
/.../foster_cell/sec/pwd_mgmt_binding
/.../foster_cell/sec/X500_DN
/.../foster_cell/sec/X500_DSA_Admin
/.../foster_cell/sec/disable_time_interval
/.../foster_cell/sec/max_invalid_attempts
/.../foster_cell/sec/test_any
/.../foster_cell/sec/test_void
/.../foster_cell/sec/test_printstring
/.../foster_cell/sec/test_printstring_array
/.../foster_cell/sec/test_integer
/.../foster_cell/sec/test_bytes
/.../foster_cell/sec/test_confidential_bytes
/.../foster_cell/sec/test_i18n_data
/.../foster_cell/sec/test_uuid
/.../foster_cell/sec/test_attr_set
/.../foster_cell/sec/test_binding
/.../foster_cell/sec/authzp
dcecp> xattrschema  cata /.:/sec/xxxx
/.../foster_cell/sec/xxxx/pre_auth_req
/.../foster_cell/sec/xxxx/pwd_val_type
/.../foster_cell/sec/xxxx/pwd_mgmt_binding
/.../foster_cell/sec/xxxx/X500_DN
/.../foster_cell/sec/xxxx/X500_DSA_Admin
/.../foster_cell/sec/xxxx/disable_time_interval
/.../foster_cell/sec/xxxx/max_invalid_attempts
/.../foster_cell/sec/xxxx/test_any
/.../foster_cell/sec/xxxx/test_void
/.../foster_cell/sec/xxxx/test_printstring
/.../foster_cell/sec/xxxx/test_printstring_array
/.../foster_cell/sec/xxxx/test_integer
/.../foster_cell/sec/xxxx/test_bytes
/.../foster_cell/sec/xxxx/test_confidential_bytes
/.../foster_cell/sec/xxxx/test_i18n_data
/.../foster_cell/sec/xxxx/test_uuid
/.../foster_cell/sec/xxxx/test_attr_set
/.../foster_cell/sec/xxxx/test_binding
/.../foster_cell/sec/xxxx/authzp
dcecp> xattrschema  cata /.:/hosts/foster/config
/.../foster_cell/hosts/foster/config/hostdata/data
/.../foster_cell/hosts/foster/config/testint1
/.../foster_cell/hosts/foster/config/hostdata/bindata
/.../foster_cell/hosts/foster/config/xattrschema/dtsconfig
/.../foster_cell/hosts/foster/config/xattrschema/additional_environ
dcecp> xattrschema  cata /.:/hosts/foster/config/xattrschema/hostdata
/.../foster_cell/hosts/foster/config/xattrschema/hostdata/hostdata/data
/.../foster_cell/hosts/foster/config/xattrschema/hostdata/testint1
/.../foster_cell/hosts/foster/config/xattrschema/hostdata/hostdata/bindata
/.../foster_cell/hosts/foster/config/xattrschema/hostdata/xattrschema/dtsconfig
/.../foster_cell/hosts/foster/config/xattrschema/hostdata/xattrschema/additional_environ

[9/14/94 public]

The dcecp code currently makes a call to 
dce_attr_sch_bind(), with the user supplied
schema name. This function currently returns
an 'ok' status for invalid schema names, for
e.g. /.:/sec/junk,  causing
dcecp to proceed without generating an error.
The relevant dcecp code is in 
schema_ops.c:set_attr_schema_binding().
I think the checks for invalid schema names
should be done in the lib calls above and
not the dcecp code.

[9/19/94 public]

The dcecp code uses the sec_rgy_attr_sch_* calls
if and only if the supplied schema name matches 
"/.:/sec/xattrschema". So schema names like 
"/.:/sec/xattrschema/junk" and "/.:/sec/junk" do
end up getting passed to dce_attr_sch_bind().
After Ping's fix to dce_attr_sch_bind(), dcecp should
exhibit the correct behavior.

[9/21/94 public]

You're right. This problem is going away after I fixed the
lib functions.



CR Number                     : 12142
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : user
Short Description             : user show output needs work
Reported Date                 : 9/12/94
Found in Baseline             : 1.1b17
Found Date                    : 9/12/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/12/94 public]
dcecp> user show cell_admin
{ {}}
{ 100}
{ 00000064-cbe6-21cd-bc00-0800092734a4}
{ }
{ }
{ none acct-admin subsys/dce/sec-admin subsys/dce/cds-admin subsys/dce/dts-admin subsys/dce/audit-admin}
{ }
{ }
{ /.../dcecp_cell.osf.org/cell_admin 1994-09-09-11:00:59.000-04:00I-----}
{ {}}
{ }
{ {}}
{ }
{ 1994-09-09-11:00:59.000-04:00I-----}
{ none}
{ /}
{ /.../dcecp_cell.osf.org/cell_admin 1994-09-12-13:32:09.000-04:00I-----}
{ none}
{ }
{ }
{ }
{ }
{ }
{ {}}
{ }

[9/12/94 public]

I can only reporduce this on ninja with SVC_NOXPGCAT set to 1. When 
SVC_NOXPGCAT is set to 0 the problem goes away. This does not occur on 
other machines. I do not know why this is.

[9/12/94 public]
It's because, when you set SVC_NOXPGCAT to 1, all message catalog lookups
fail. Only messages compiled in can be seen. I don't know why these
dcecp messages don't show up, but it's not dcecp's problem.



CR Number                     : 12138
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : acl
Short Description             : no error message returned
Reported Date                 : 9/12/94
Found in Baseline             : 1.1b17
Found Date                    : 9/12/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/12/94 public]
The following command returns no error message in our currently
broken cell...

dcecp> acl show -e /.:
Error: 
dcecp>

There are several cases where dcp_acl_bind_named_object() 
(used in this case at acl_tclif.c:1350) does not set an error message
in the result upon failure. Either dcp_acl_show must be changed to
add an error if there isn't one, or dce_acl_bind_named_object() must
be changed to always return an error message upon failure.

[9/12/94 public]

dce_acl_bind_named_object() sets error messages upon failure. Once
back in acl_tclif.c, the code just returns TCL_OK or TCL_ERROR.

I invoked the following commands on our intercell configuration, is
there something else I need to know because it works below?

On rescue:
[rescue]:/am/ice/usr/users/salamone> dce_login cell_admin dcecp
[rescue]:/am/ice/usr/users/salamone> dcecp
dcecp> acl show -e /.:
Error: invalid acl handle
dcecp> acl show /.: -e
Error: invalid acl handle

On fricK:
dcecp> acl show -e /.:
Error: invalid acl handle
dcecp> acl show /.: -e
Error: invalid acl handle

[9/12/94 public]
dcp_acl_bind_named_object() does not always set an error message upon
failure.

This is on ninja (a 486)

(gdb) r
dcecp> acl show -e /.:
[of stepping deleted]
(in dcp_acl_bind_named_object())
dcp_acl_bind_named_object (interp=0x55f0b0, dcp_acl_info_p=0x4e40b0, bind_to_entry=1)
    at /project/dce/build/dce1.1/src/admin/dcecp/acl_edit.c:293
293         char                        *residual_name = (char *)NULL;
(gdb) n
296         CLEAR_STATUS(&status);
(gdb) 
302         if (Tcl_SplitList(interp, dcp_acl_info_p->sec_acl_named_object,
(gdb) 
306         if (name_argc > 1) {
(gdb) 
326         free((char *) name_argv);
(gdb) 
331         CLEAR_STATUS(&status);
(gdb) 
332         if (residual_name == NULL) {
(gdb) 
333             sec_acl_bind((unsigned char *)dcp_acl_info_p->sec_acl_named_object, 
(gdb) 
337         } else {
(gdb) 
348         if (STATUS_EQUAL(&status, rpc_s_not_rpc_entry)) {
(gdb) 
357         rc = dcp__acl_get_all_managers(try_nmgrs, 
(gdb) 
360         if ((rc == TCL_OK) && (dcp_acl_info_p->num_acl_mgrs > try_nmgrs)) {
(gdb) 
385         return(rc);
(gdb) p rc
$1 = 1
(gdb) p interp->result
$2 = 0x61a478 ""
(gdb) c
Continuing.
Error:

[9/16/94 public]

Environment variable, SVC_NOXPGCAT, was set to 1 to force "dcecp" to
access messages from the in-core table.  As a result, messages that
come from DCE core(calling APIs within dcecp) are null.



CR Number                     : 12137
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : acl
Short Description             : unable to bind to /.:
Reported Date                 : 9/12/94
Found in Baseline             : 1.1b17
Found Date                    : 9/12/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/12/94 public]
This is from bl17...

dcecp> ca
You are 'cell_admin' logged into '/.../dcecp_cell.osf.org'.
dcecp> acl show -e /.:
Error: 

(as cell_admin)
[rescue]:/am/ninja/usr/users/rousseau> acl_edit /.: -e
ERROR:  (dce / sec)
Unable to bind to object /.:

[9/13/94 public]
You don't need the -e switch to edit a directory.  The directory is
the target object.  The -e means edit the child pointer of
the directory.  In you case, the root doesn't have a child pointer
so the error is correct.



CR Number                     : 12135
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_com_utils
Short Description             : function chk_rpccp() does not detect all rpccp errors.
Reported Date                 : 9/12/94
Found in Baseline             : 1.1b16
Found Date                    : 9/12/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dce_config
Sensitivity                   : public

[9/12/94 public]
Function chk_rpccp() in dce_com_utils is used by all dce_config scripts
to check for errors in a call to rpccp.  Due to changes in the wording
of errors since dce1.0.3, this function no longer detects all rpccp
errors, which can lead to erroneous dce_config execution.

Change needed: in dce_com_utils function "chk_rpccp()", change string
being tested from "error:" to "^>>> ".

[9/12/94 public]
More complicated change really needed: there are no invariant patterns
that distinguish error output from normal output in rpccp; both errors
and normal completion reports can begin with ">>>".

What is invariant is that all error reports go to stderr, and all
normal completion reports go to stdout.  All scripts that plan to use
chk_rpccp should pipe stdout to /dev/null and stderr to rpccp_out$$.
Then chk_rpccp() should test for "^>>> " as suggested above.

[9/12/94 public]
After looking this over with Tom Jordahl, we decided that the existing
test in chk_rpccp() is adequate for the existing uses of it in all the
dce_config scripts: rpccp errors that do not contain the string "error:"
are all either errors in command-line syntax or are failures to find
an object in response to a query.  chk_rpccp is currently called only
to check output of update commands, and from scripts errors in command
line syntax are not a big issue.



CR Number                     : 12128
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : code clean
Short Description             : no prototype for sec_rgy_attr_lookup_by_name
Reported Date                 : 9/12/94
Found in Baseline             : 1.1
Found Date                    : 9/12/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/12/94 public]

gds calls sec_rgy_attr_lookup_by_name (in gds/gds_sec/gds_sec_rgy.c).
There is no prototyping for this function in any security
include file - so we get a warning when compiling gds/gds_sec/gds_sec_rgy.c.

[09/12/94 public]
Sorry - it's in dce/sec_rgy_attr.h. Cancelled.



CR Number                     : 12118
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : secval status
Short Description             : secval status fvt failed
Reported Date                 : 9/8/94
Found in Baseline             : 1.1b16
Found Date                    : 9/8/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : ts/secval/Makefile
Sensitivity                   : public

[9/8/94 public]

70||"Starting positive secval status tests"
10|8 /ts/secval/secval_status_P.tcl 16:59:47|TC Start, scenario ref 921-1
15|0 1.10 5|TCM Start
400|0 1 1 17:00:08|IC Start
200|0 1 17:00:09|TP Start
520|0 1 16326 1 1|secval_status_3_P: check to see that we can check status of secval.
520|0 1 16326 1 2|==== Contents of test case:
520|0 1 16326 1 3|{     	list [catch {secval status} msg] $msg     }
520|0 1 16326 1 4|Test completed successfully.
520|0 1 16326 1 5|== Test output was:
520|0 1 16326 1 6|{1 {}}
520|0 1 16326 1 7|== Expected output was:
520|0 1 16326 1 8|{0 1}
520|0 1 16326 1 9|Test Failed.
220|0 1 1 17:00:10|FAIL
410|0 1 1 17:00:10|IC End
400|0 2 1 17:00:11|IC Start
200|0 1 17:00:12|TP Start
520|0 1 16326 1 10|secval_status_4_P: check to see that we can check status of secval by hostname.
520|0 1 16326 1 11|==== Contents of test case:
520|0 1 16326 1 12|{     	list [catch {secval status $DCP_HOSTNAME_THREE} msg] $msg     }
520|0 1 16326 1 13|Test completed successfully.
520|0 1 16326 1 14|== Test output was:
520|0 1 16326 1 15|{1 {Entry not found}}
520|0 1 16326 1 16|== Expected output was:
520|0 1 16326 1 17|{0 1}
520|0 1 16326 1 18|Test Failed.
220|0 1 1 17:00:12|FAIL
410|0 2 1 17:00:12|IC End
400|0 3 1 17:00:13|IC Start
200|0 1 17:00:13|TP Start
520|0 1 16326 1 19|secval_status_5_P: check to see that we can check status of secval by string binding.
520|0 1 16326 1 20|==== Contents of test case:
520|0 1 16326 1 21|{     	list [catch {secval status $DCP_SR_PROTSEQ:$DCP_SR_IP_ADDR} msg] $msg     }
520|0 1 16326 1 22|Test completed successfully.
520|0 1 16326 1 23|== Test output was:
520|0 1 16326 1 24|{1 {}}
520|0 1 16326 1 25|== Expected output was:
520|0 1 16326 1 26|{0 1}
520|0 1 16326 1 27|Test Failed.
220|0 1 1 17:00:14|FAIL
410|0 3 1 17:00:15|IC End
400|0 4 1 17:00:16|IC Start
200|0 1 17:00:16|TP Start
520|0 1 16326 1 28|secval_status_6_P: check to see that we can check status of secval by tcl binding.
520|0 1 16326 1 29|==== Contents of test case:
520|0 1 16326 1 30|{     	list [catch {secval status {$DCP_SR_PROTSEQ $DCP_SR_IP_ADDR}} msg] $msg     }
520|0 1 16326 1 31|Test completed successfully.
520|0 1 16326 1 32|== Test output was:
520|0 1 16326 1 33|{1 {Bad or wrong arguments}}
520|0 1 16326 1 34|== Expected output was:
520|0 1 16326 1 35|{0 1}
520|0 1 16326 1 36|Test Failed.
220|0 1 1 17:00:17|FAIL
410|0 4 1 17:00:18|IC End
400|0 5 1 17:00:18|IC Start
200|0 1 17:00:18|TP Start
520|0 1 16326 1 37|secval_status_7_P: check to see that secval status return 0 if the secval is not up.
520|0 1 16326 1 38|==== Contents of test case:
520|0 1 16326 1 39|{     	list [catch {secval status} msg] $msg     }
520|0 1 16326 1 40|Test completed successfully.
520|0 1 16326 1 41|== Test output was:
520|0 1 16326 1 42|{1 {}}
520|0 1 16326 1 43|== Expected output was:
520|0 1 16326 1 44|{0 0}
520|0 1 16326 1 45|Test Failed.
220|0 1 1 17:00:19|FAIL
410|0 5 1 17:00:20|IC End
80|8 0 17:00:22|TC End
70||"Finished positive secval status tests"

[9/15/94 public]
Ran secval tests against NB from 9/15/94.  100% pass (excepting the
negative tests that expect to fail due to ACL's.  The dced ACL's are
still open to all for development purposes).  Cancelled OT.

Found bug in install phase of secval Makefile, will submit change under
this OT #.



CR Number                     : 12115
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : secd replica core dumps at restart
with "cthread create failed..."
Reported Date                 : 9/8/94
Found in Baseline             : 1.1b16
Found Date                    : 9/8/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/8/94 public]

I created a big registry database successfully - 10,000 principals.
I brought down the cell and re-started it.  The secd replica,
running on an OSF1 machines, dumped core and left the following
message in secd.log

root@barbados> cat secd.log
cthread create failed
rpc__list_element_alloc/(*list_desc->alloc_rtn)(element): call failed

Using gdb and the usual command - a la Tom J.- failed to add any
useful information.

The reason why I am filing a separate CR, to the ones already filed, is
because the current ones are attributed to memory leaks. But this seems
to be a different problem. Also, the message left by secd in new. If this
is a variation, please feel free to dup it.

This can be reproduced everytime.

[ sekhar 9/21/94 public ]

Those error messages are generated by the RPC runtime . I believe 
that the sams entries (from rpc.sams) for the messages are :

cthread create failed : sams entry rpc_s_cthread_create_failed
rpc__list_element_alloc/(*list_desc->alloc_rtn)(element): call failed
   : sams entry rpc_m_call_failed_no_status

Is this an internal error ? ( The "explanation" field for 
rpc_s_cthread_create_failed says so ). 

Added dce-ot-rpc to the interest list - can someone can provide
more info on what may be causing these errors ?

[9/21/94 public]

I believe that the error from rpc__list_element_alloc() is caused by the
malloc() or pthread_create() failure. rpc_s_cthread_create_failed is caused
by the pthread_create() failure, which is probably caused by the malloc()
failure in CMA. I suggest checking the swap space and the process's size.

[9/21/94 public]

The failure occurs when the secd replica is starting up. I believe at that
point the secd replica is being updated by the master with all the
accounts, etc. The swap space at that time is about 130 Mb. I did not
check the processes size since DCE was just staring up. I did not think 
secd had had time to belly itself so fast. If knowing the size of the DCE
processes at startup, under these circunstances, is an imperative in making
progress on a fix, I will try to recreate the problem to find out.

[ sekhar 9/21/94 public ]

This problem does need to be reproduced ( making sure that datasize 
is not set to a small value ) with a baselevel which is more recent baselevel
(e.g. bl18 ) than bl16 which is old .  There have been several memory 
leak fixes since then ( although I can't say with certainity whether 
they could be the cause of the problem).  Thanks.

[9/21/94 public]

Although I'm not sure if this is related to this problem, the bulk data
transfer over the CN protocol can cause the receiver's process size growth.
(See OT 9336.) Does the secd-replica-update send the large data?

[9/23/94 public]

I tried reproducing this problem with the LGB (9/21/94) and 
did not happen.
 
Due to time, I only created 80000. Since it used to die very soon 
after restart and now it completes successfully, I am canceling this CR.



CR Number                     : 12114
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dced
Subcomponent Name             : secval
Short Description             : Node self identity fails to refresh
Reported Date                 : 9/8/94
Found in Baseline             : 1.1b16
Found Date                    : 9/8/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/8/94 public]

I have a two node cell, both HP machines, both running 16.3.  One is a
DCE client and the other has all the core servers on it.  During the
course of doing some testing I reduced the default ticket lifetime
down to 5m.  After running for around 3-4 hours the client machine's
self identity failed to refresh.  This results in the cell being very
unhappy.

Some of the noticable errors that come to the console are:

Failed to retrieve server binding from the namespace: status 0x10d0a7ce (dce / cds)
LAN profile not found
Can't retrieve DCE cell name from configuration DB: status 0x10d0a7ce (dce / cds)
Too few servers (0), need 1 servers
dfs: ticket has expired; running unauthenticated.
Failed to retrieve server binding from the namespace: status 0x10d0a7ce (dce / cds)
LAN profile not found
Can't retrieve DCE cell name from configuration DB: status 0x10d0a7ce (dce / cds)
Too few servers (0), need 1 servers
dfs: ticket has expired; running unauthenticated.

A klist results in:

# klist
DCE Identity Information:
        Global Principal: /.../booboo_cell/hosts/lstarr/self
        Cell:      281aa1d2-c681-11cd-b270-08000932c179 /.../booboo_cell
        Principal: 000030a1-ca56-21cd-bf00-08000932c179 hosts/lstarr/self
        Group:     0000000c-c681-21cd-b201-08000932c179 <group name unknown>
        Local Groups:
                0000000c-c681-21cd-b201-08000932c179 <group name unknown>

Identity Info Expires: 94/09/08:14:23:55
Account Expires:       never
Passwd Expires:        never

Kerberos Ticket Information:
Ticket cache: /opt/dcelocal/var/security/creds/dcecred_ffffffff
Default principal: hosts/lstarr/self@booboo_cell


There is plenty of disk space:

# bdf /opt
Filesystem           kbytes    used   avail capacity Mounted on
/dev/dsk/c201d6s0    320406  263714   24651    91%   /

I am only using HP machines in this cell so I do not know if this
problem exists on the other platforms.

[9/8/94 public]
Andy, is sec_clientd running or secval?  I assume secval since that is the
default.  Are all DCE servers still running?  (no core dumps)

Can you do this: 

  dcecp -c secval deactivate
  dcecp -c secval activate

and let me know what happens.

[9/8/94 public]

I ran the above commands and the node's self identity came back....

The are no core dumps under /opt/dcelocal

[9/8/94 public]
Can you re-config with sec_clientd instead of secval and tell me if the
same thing happens. 

  setenv SEC_CLIENT sec_clientd & re-dce_config
 OR
  Carefull edit /etc/rc.dce so that "dced -s" is in, comment "activate_secval"
    is gone and the sec_clientd wait for creds loop from dce_config is
    edited in place.

If you don't have the time to do this let me know.

[9/9/94 public]

The problem did not show up when running sec_clientd instead of secval.

[9/11/94 public]
Cannot reproduce on my machine.  I am running a dced from my sandbox
which contains changes to the secval code to fix OT #11940 & 7370.
These will be checked in for Mondays NB.   Outside chance that these 
changes addressed the problem you are seeing.  More likely, I am not 
doing whatever it is that causes the problem to show itself in your cell.  

Andy, can you take a moment to assist me to reproduce on my machine and/or try
again on Tuesday with NB?

[9/23/94 public]
We've all tried to reproduce this.  We can't.  We all feel that this was
resolved by other fixes (hopefully, not covered by them...)  Canceling.



CR Number                     : 12112
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Access to CDS directories only cause acl_modify_P FVT tests to fail.
Reported Date                 : 9/8/94
Found in Baseline             : 1.1b16
Found Date                    : 9/8/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/8/94 public]

Create a directory and then use "dcecp" or "acl_edit" to view it
unauthenticated.  dcecp returns "Error: invalid acl handle". And
"acl_edit" returns "ERROR: acl object not found".

The sec_acl_bind() API returns a good status code but a null security
handle.

Note that I have seen this same behavior authenticated also.
It happens only on the HP_UX platform using dcecp and logging in via
dcecp.  (Note that _u is the current login context.)

ON HP_UX:
dcecp> set _u
dcecp> acl sh /.:/JAS_DIR_34
Error: invalid acl handle
dcecp> login cell_admin -p dcecp
dcecp> acl sh /.:/JAS_DIR_34
Error: invalid acl handle

ON OSF/1:
dcecp> set _u
dcecp> acl sh /.:/JAS_DIR_34
Error: invalid acl handle
dcecp> login cell_admin -p dcecp
dcecp> acl sh /.:/JAS_DIR_34
{user cell_admin rwdtcia}
{user hosts/frick/cds-server rwdtcia}
{group subsys/dce/cds-admin rwdtcia}
{group subsys/dce/cds-server rwdtcia}
{any_other r--t---}


Note that I've tested this using security objects such as principals and 
other CDS objects like clearinghouses and everything works as expected.
This behavior seems to occur on CDS directories only.


In src/test/admin/dcecp/ts/acl/acl_modify_P.tcl, these are some of the
tests that are failing under HP_UX only.
acl_modify_046_P
acl_modify_048_P
acl_modify_057_P

[9/8/94 public]
I tried acl_edit and dcecp acl show on a newly created direftory and
it worked fine. I am running last nights build + the fix for the 
strdup/strcpy problem in cds_dacl.c. Its possible that fix may have 
an impact. Julie will try it again in the morning to see if its working
any better for her.

[10/3/94 public]
Seems to work now as of 1.1b20.



CR Number                     : 12078
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : tcl
Short Description             : regexp stuff not threadsafe
Reported Date                 : 9/7/94
Found in Baseline             : 1.1b16, 1.2
Found Date                    : 9/7/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[9/7/94 public]
The regexp stuff in Tcl uses global data and is not threadsafe.  This isn't
really a problem in dcecp for 1.1 since we can only have one thread that
would ever invoke the Tcl regexp commands (we only have one thread for the
interpreter). 

This should be fixed in 1.2, particularly if anyone wants to implement a
"background" command that would spawn a thread and run something in the
background, something like "&" means to the shell.

[6/5/96 public]
Cancelled.  No thread safety work is being done directly for
dcecp.  Will rely on new tcl to provide what we need.



CR Number                     : 12070
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : systest
Short Description             : Credentials cache I/O operation failed
Reported Date                 : 9/7/94
Found in Baseline             : 1.1b17
Found Date                    : 9/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/7/94 public]
Using bl-16.3, dfs.read_write_all.main in a 3 HP fldb cell with
3 users and 1 aggregate, 1 user failed immediately with:

Sorry.
User Identification Failure. - status 0x141290bd (dce / krb)
	where:
336761021 (decimal), 141290bd (hex): Credentials cache I/O operation failed XXX (dce / krb)

Assigning to Rick to rerun and add info or cancel.

[9/7/94 public]
In a run of security systest dcesepol, I got this error.  It only occurred
once in a 48hour run, about 3/4 through, on an attempted login.  That's
1 out of ~4500 logins.  No supporting/correlating data.  The previous
and subsequent logins worked fine for the same principal.

[9/15/94 public]
 
Two of 9 test clients failed with error  0x141290bd
 Credentials cache I/O operation failed XXX (dce / krb)
running rpc.sec.2 tests for about 7 hours.
 
The test clients were both on OSF/1 using tcp protocol.  The third client
on the machine, also running tcp didn't fail.  
 
 NB: baseline 17
 
 Cell:
 
 HPUX: cdsd secd dtsd
 OSF1: client dtsd
 OSF1; client dtsd ntp provider

[9/15/94 public]
Change component to sec so some of the right people start seeing
this.  Change title to better reflect symptom.  Rajendra, to whom
should this be assigned?

[9/15/94 public]

The fact that this failure apparently occurs during a dce_login
leads me to believe that

A) some process on the machine is leaking file descriptors, causing
   the attempted creation of the krb5 credential cache during
   dce_login to fail because some limit on the number file
   descriptors has been reached.

or

B) There is no file descriptor leak, just too many simultaneous
   processes with open file descriptors running.  Same result as
   (A).

or

(C) The disk partition holding credential cache files
    (/opt/dcelocal/var/security/creds) is full.  Perhaps
    some tests are not using kdestroy to flush credentials 
    created by test login?

Could someone who can weave the necessary OSF/1 spells
check out the limits on the machines in question.  Also, 
check the available disk space the next time you see this
failure.

Thanks.

[9/15/94 public]
Thanks for the update Greg - at least in the 1st case... there
was no OSF/1 machine involved - I'm quite sure option C was not
the case (because I've been bitten by that one before and know
to look for it :-) The dfs.read_write_all.main test does NOT do
a lot of dce_logins, each user (there were 3) logs in once and
goes .... option B is still a possibility though - this was an
all HP test - how do I find out the process limit (process
table size limit?) built into my dfs-supporting HPUX?

[9/15/94 public]
On hpucks, as root, run sam, select "Kernel Configuration", then
"Configurable Parameters".  Here's some things to look for:
maxfiles, maxfiles_lim, nfile.  These are probably set up low, as if the
workstation was going to be used by 1 or 2 people at a time, not by DCE svrs
and lots of tests simulating lots of users, so it's possible  that they may
need to be increased (you can do this through sam too, select the item you
want to change, then select the "Actions" menu?  When you're done modifying
parameters, tell it to rebuild the kernel and reboot).

[9/15/94 public]
Gail, Andy can rebuild custom kernels that include the 
necessary DFS support.

[9/23/94 public]
Any news on this one?  Is it reproducible with bl18+?   If so, is that with
a DFS kernel that already has the increased maxfiles limit?   If it is
reproducible, then this is one that I'll have to come down and look at
down there, since I don't have the setup here to reproduce it...

[9/28/94 public]
Is this one still reproduceable?

[9/29/94 public]
Sorry for the lack of updates here - DFS testing was pretty blocked
by other CRs so bl-20 will be the first chance we get to run a lot
of tests and see what we see ... I don't believe Peter O has seen
this problem since updating to the new kernel - if dfs.read_write_all.main and 
rpc.sec.2 run (hopefully a couple of times) w/o turning this one up,
we can cancel.

[10/3/94 public]
Cancelling - hasn't been seen and we've been able to do a lot of testing
in the last week.



CR Number                     : 12054
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 12009, 11925
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : krb5
Short Description             : dtsd core dumps in krb5_free_authdata
Reported Date                 : 9/6/94
Found in Baseline             : 1.1b16
Found Date                    : 9/6/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/6/94 public]

In Build bl16.3 dts core dumped (bus error)
 0 free@libc + 0x00000008 (hp-ux export stub)
 1 cma_lib_free@libdce + 0x00000284 (0x6, 0x401c32e8, 0x7af30270, 0x802e338b)
 2 free@libc + 0x00000224 (0x406c2745, 0x40096730, 0x4049de5c, 0x2000000)
 3 krb5_free_authdata@libdce + 0x0000004c (0x406c2728, 0x3, 0x4049de20, 0x401c32e8)
 4 krb5_free_cred_contents@libdce + 0x000001ac (0x406c2550, 0x6, 0x1, 0x406c2728)
 5 krb5_free_creds@libdce + 0x00000030 (0x406c2550, 0x406c2728, 0x406c2290, 0x406bb910)
 6 krb5_free_tgt_creds@libdce + 0x0000003c (0x406bce48, 0x406c2550, 0x4049dd20, 0x40656438)
 7 krb5_get_credentials@libdce + 0x00000220 (0x10, 0x400966b0, 0x40656438, 0x4049dca0)
 8 sec_krb_get_cred@libdce + 0x00000268 (0x40095d60, 0x400d9d88, 0x5, 0x2)
 9 rpc__krb_get_tkt@libdce + 0x000003d8 (0x400dcf08, 0x7af3736a, 0x406c2850, 0x5)
10 rpc__krb_dg_pre_call@libdce + 0x000002ec (0x406b51a8, 0x406c41c0, 0x4049db20, 0x1)
11 rpc__dg_call_start@libdce + 0x000008c0 (0x406c41c0, 0, 0x40001300, 0x1)
12 rpc_call_start@libdce + 0x0000025c (0x406c41c0, 0, 0x40001300, 0x1)
13 ServerRequestTime + 0x00000144 (0x406c41c0, 0x406c2780, 0x4049d49c, 0x4049d4a0)

This happened on one of four dts servers (the other three are fine), after
running for about three days.

Activity in the cell were 3 dfs tests, no stress on dts.

[9/7/94 public]

I browsed through the kerberos library code, and the only time a process
should end up in krb5_free_tgt_creds is after the acquisition of
an intercell ticket-granting ticket.  In that case, there are known
memory corruption problems involving the authdata field of TGT
credentials that are (hopefully) fixed by the fix for OT 11925 that
was submitted on 9/6.

If this cannot be reproduced on a build including that fix, it
should be cancelled.

[9/6/94 public]

No longer seen on builds with fix.  Canceled.



CR Number                     : 12052
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : cdsd
Short Description             : cdsd dumps core running rpc.cds.3 tests
Reported Date                 : 9/6/94
Found in Baseline             : 1.1b16
Found Date                    : 9/6/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/6/94 public]

cdsd dump core this weekend after running the rpc.cds.3 tests for 7-8 hours.
Have shown this to jd and Rajendra, it's most likely a security problem, but
I'll let John make the handoff.

NB0830 (secd rebuild in afternoon 8/31)

Cell config:

HPUX: secd,cdsd,dtsd 
OSF1: client,dtsd
OSF1: client,dtsd,ntp provider
OSF1: client,dts clerk

core trace

 0 Checksum2krb5_checksum@libdce + 0x00000008 (hp-ux export stub)
 1 asn1_field2krb5_data@libdce + 0x00000094 (0x4128dc38, 0, 0x403a7b7c, 0x403a7bbc)
 2 opt_Checksum2krb5_checksum@lib + 0x0000006c (0x4128dc38, 0x4128fc14, 0x4128efb0, 0x8)
 3 Authenticator2krb5_authenticat + 0x000000a8 (0x4128fc10, 0x4128efb0, 0x4128fc10, 0)
 4 krb5_decode_generic@libdce + 0x00000140 (0x407538d4, 0x407538c0, 0x7af3867a, 0x34)
 5 decrypt_authenticator@libdce + 0x000002f0 (0x4128f430, 0x4128fb84, 0x1, 0x2)
 6 krb5_rd_req_decoded@libdce + 0x00000328 (0x4128f430, 0, 0, 0)
 7 krb5_rd_req@libdce + 0x0000011c (0x40753658, 0, 0, 0)
 8 sec_krb_decode_msg_common_frag + 0x00000214 (0x407534a4, 0x2, 0x405cd990, 0x405cd99c)
 9 sec_krb_decode_message_common@ + 0x0000007c (0x407534a4, 0x2, 0x405cd990, 0x405cd99c)
10 sec_krb_cn_decode_message@libd + 0x0000007c (0x407534a4, 0x2, 0x405cd99c, 0x405cd9a0)
11 rpc__krb_cn_vfy_client_req@lib + 0x00000318 (0x404a3058, 0x40f98d70, 0x411cb6b8, 0x420)
12 rpc__cn_assoc_process_auth_tlr + 0x00000514 (0x404a2f78, 0x411cb668, 0x470, 0x411cff08)
13 do_assoc_req_action_rtn@libdce + 0x00000684 (0x404a2f78, 0x411cb648, 0x404a2f80, 0)
14 do_assoc_action_rtn@libdce + 0x000001a0 (0x404a2f78, 0x411cb648, 0x404a2f80, 0x411cb6b0)
15 rpc__cn_sm_eval_event@libdce + 0x000000e4 (0x64, 0x411cb648, 0x404a2f78, 0x404a2f80)
16 receive_dispatch@libdce + 0x00002824 (0x404a2f78, 0x7aff92c0, 0x40752ce8, 0x134)
17 rpc__cn_network_receiver@libdc + 0x00000a98 (0x404a2f78, 0x7af4f1b0, 0x4041c878, 0x38)
18 cma__thread_base@libdce + 0x0000021c (0x4041c878, 0, 0, 0)
19 cma__thread_start1@libdce + 0x0000004c (0x4041c878, 0, 0, 0)
.
.
.

>lr $r
$r0       = 0
$r1       = 0x4128dc38
$r2       = 0x81ff5c67
$r3       = 0
$r4       = 0
$r5       = 0
$r6       = 0
$r7       = 0
$r8       = 0
$r9       = 0
$r10      = 0
$r11      = 0
$r12      = 0
$r13      = 0
$r14      = 0
$r15      = 0
$r16      = 0
$r17      = 0
$r18      = 0
$r19      = 0x7af30270
$r20      = 0x8002
$r21      = 0
$r22      = 0x1
$r23      = 0x3544e4
$r24      = 0x7ffe6000
$r25      = 0
$r26      = 0x4128dc38
$r27      = 0x4002bb90
$r28      = 0
$r29      = 0x1
$r30      = 0x40753a20
$r31      = 0x8002
$ret0     = 0
$ret1     = 0x1

>lr $a
$arg0     = 0x4128dc38
$arg1     = 0
$arg2     = 0x7ffe6000
$arg3     = 0x3544e4

>p *($pc - 16)\20i
0x81ff5c54  MTSP        1,0
0x81ff5c58  BE,N        0(0,2)
0x81ff5c5c  BL  collect+077c,2
0x81ff5c60  OR  0,0,0
0x81ff5c64  LDW -24(0,30),2
0x81ff5c68  LDSID       (0,2),1
0x81ff5c6c  MTSP        1,0
0x81ff5c70  BE,N        0(0,2)
0x81ff5c74  BL  __text_start+3f74,2
0x81ff5c78  OR  0,0,0
0x81ff5c7c  LDW -24(0,30),2
0x81ff5c80  LDSID       (0,2),1
0x81ff5c84  MTSP        1,0
0x81ff5c88  BE,N        0(0,2)
0x81ff5c8c  BL  gather_updates+059c,2
0x81ff5c90  OR  0,0,0
0x81ff5c94  LDW -24(0,30),2
0x81ff5c98  LDSID       (0,2),1
0x81ff5c9c  MTSP        1,0
0x81ff5ca0  BE,N        0(0,2)

[9/6/94 public]
I glanced at the trace before Peter opened this and it didn't look 
like cds was at fault but I told him to open it against cds and I'd
have a closer look. Now that I've looked I'm even less inclined to
believe cds is at fault. There doesn't appear to be a single cds frame 
on the stack. I'm no sure if its security or if bad information is being
given to security from rpc but since it seems to be landing in security
I'll assigne it there.

[9/6/94 public]
Although this is different from the defect that Greg just fixed (11925), it
is in code called from priv/auth code that he had changed recently and there's
a *slight* chance that the fix he made today might also fix this problem.
While there's no guarantees at this time that it's fixed, it would be very
helpful if you could run this test tomorrow or some time soon after that with
a build that has the fix that was just submitted for 11925.  Also, the rtns
that it was in before and during when it died mostly do lots of allocs and
memcpy()'s, so it would help to check the resource usage when it died (free
swap space, core file size, size of secd in case it's using up all the swap
space...).

[9/21/94 public]

I haven't been able to re-create this problem in over a week, so I'm
assuming one of the security fixes made this go away.



CR Number                     : 12024
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : signal processing
Short Description             : <CTL> C turns off "echo" of tty characters.
Reported Date                 : 9/2/94
Found in Baseline             : 1.1b16
Found Date                    : 9/2/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/2/94 public]

Try this:

dcecp> <CTL> C
dcecp> quit
Must invoke "stty sane" to turn on "echo" again.

Note that under "tcsh" this does not occur.

[9/2/94 public]

I'm having trouble reproducing this (possibly because my shell is tcsh
by default). Can you give me a more complete scenario (what shell,
what does "stty -a" say before and after)?

[9/2/94 public]

Invoke "ksh" or "csh". Then invoke "stty all" before and after 
dcecp, <CTL>C, quit. Notice that "echo" has been turned off:
"-echo".

ksh
$ stty all
speed 9600 baud; 25 rows; 80 columns; 
erase = ^H; werase = ^W; kill = ^U; intr = ^C; quit = ^\; susp = ^Z
dsusp = ^Y; eof = ^D; eol <undef>; eol2 <undef>; stop = ^S; start = ^Q
lnext = ^V; discard = ^O; reprint = ^R; status <undef>; time = 0
min = 1
parenb -parodd cs7 -cstopb -hupcl -cread -clocal -crtscts 
-ignbrk brkint ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl -iuclc 
ixon -ixany ixoff imaxbel 
isig icanon -xcase echo echoe echok -echonl -noflsh -mdmbuf -nohang 
-tostop echoctl -echoprt echoke -altwerase iexten -nokerninfo 
opost -olcuc onlcr -ocrnl -onocr -onlret -ofill -ofdel tabs -onoeot
$ dcecp
dcecp> <CTL> C
dcecp> quit
$
speed 9600 baud; 25 rows; 80 columns; 
erase = ^H; werase = ^W; kill = ^U; intr = ^C; quit = ^\; susp = ^Z
dsusp = ^Y; eof = ^D; eol <undef>; eol2 <undef>; stop = ^S; start = ^Q
lnext = ^V; discard = ^O; reprint = ^R; status <undef>; time = 0
min = 1
parenb -parodd cs7 -cstopb -hupcl -cread -clocal -crtscts 
-ignbrk brkint ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl -iuclc 
ixon -ixany ixoff imaxbel 
isig icanon -xcase -echo echoe echok -echonl -noflsh -mdmbuf -nohang 
-tostop echoctl -echoprt echoke -altwerase iexten -nokerninfo 
opost -olcuc onlcr -ocrnl -onocr -onlret -ofill -ofdel tabs -onoeot

[9/2/94 public]
Mea culpa.
I re-installed "utils" library and everything works fine.



CR Number                     : 12021
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11850
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp needs kitchen_sink object
Reported Date                 : 9/2/94
Found in Baseline             : 1.1
Found Date                    : 9/2/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/2/94 public]

I've found what I believe to be a significant lack in dcecp:  the absence
of the kitchen_sink object.

I believe the operations should be:

create              Create the kitchen sink
delete              Delete the kitchen sink
modify              Add, remove or change things in the kitchen sink
show                Show the things in the kitchen sink
help                Print summary of command-line options and abort.
operations          Return valid operations for command.

[9/2/94 public]
Ahhhh! I finally understand what Howard's mumblings about container
objects mean!

Now are the dishes multi-valued or multi-instanced?????

[9/2/94 public]
It is way too late in the cycle to think of adding new functionality.  The
DRB overhead alone would push us past our bit freeze.  See CR 11850.



CR Number                     : 12015
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : cds
Short Description             : couldn't remove CDS_UpgradeTo
Reported Date                 : 9/1/94
Found in Baseline             : 1.1b16
Found Date                    : 9/1/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/1/94 public]
I could add an attribute of tyep CDS_UpgradeTo, but I could not remove it
afterwards.  Note that it is should be a single valued attribute.

dcecp> dir mod /.: -add {CDS_UpgradeTo 3.1}      
dcecp> dir mod /.: -r {CDS_UpgradeTo}  
Error: The attribute list syntax is invalid.
dcecp> dir mod /.: -r {CDS_UpgradeTo 3.1}
Error: The attribute '1.3.22.1.3.25' should be a multi-valued attribute type.
dcecp> dir he mod
-add                Add an attribute to the named directory
-change             Change an attribute in the named link
-remove             Remove an attribute if possible from the named 
-single             Add a single valued attribute to a directory.
-types              Remove a single value from a multi-valued attribute list.
dcecp> dir mod /.: -r {CDS_UpgradeTo 3.1} -si 
Error: The '-single' option can only be used with the '-add' option.
dcecp> dir mod /.: -r {CDS_UpgradeTo} -si     
Error: The '-single' option can only be used with the '-add' option.

[9/2/94 public]

The messages in the 'dir he mod' are wrong I will fix them. But the 
spec is correct the correct command to remove an entire attribute 
is 

dcecp> dir mod /.: -r {CDS_UpgradeTo}  -types

I am canceling this and opening yet another ot for the messages.



CR Number                     : 12014
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : serverexec
Short Description             : server show -exec fails
Reported Date                 : 9/1/94
Found in Baseline             : 1.1b16
Found Date                    : 9/1/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/1/94 public]
dcecp> server create audit-server -arguments "-a" -program "/opt/dcelocal/bin/auditd" -directory "/opt/dcelocal/var/audit"
dcecp> server start audit-server
dcecp> server show audit-server -exec
Error: Cannot find a matching object.

I can create the serverconf entry and start it, but it doesn't show
up in server show -exec

[9/1/94 public]
Yes, both serv create and serv start are srvrconf operations. However
everthing with -exec means srvrexec operation. In this case, I bet you
would see nothing if you did "server cata -exec". I'll try this with
tomorrow dced and see if the dced operation is completed. In terms of 
dcecp server object commands, the codes are same for srvrconf and 
srvrexec.

[9/2/94 public]
I don't know if Ping has tried this yet, but I'm trying similar
operations using last night's build, and I get this:

dcecp> server cr /.:/hosts/speed/config/srvrconf/dummy -pro /usr/users/coren/tmp/dummy -arg /.:/hosts/speed/foo -uid 0 -gid 0 -starton explicit
dcecp> server start dummy
458a45d0-c67f-11cd-b2ca-0000c08de054
dcecp> server cat -ex
/.../speed_cell/hosts/speed/config/srvrexec/dummy
dcecp> server show dummy -exec
Error: permission not valid for this acl
dcecp> server stop dummy
Error: permission not valid for this acl

I can't tell what acl; I had supposed it was the one on
/.../speed_cell/hosts/speed/config/srvrexec/dummy, but I can't find
out:

dcecp> acl show /.:/hosts/speed/config/srvrexec/dummy 
Error: Key not found in database

John: are you sure your server started? I notice you didn't give it a
value for the "starton" attribute.

[9/2/94 public]
There is not acl yet. Please refer to OT12027. At this point (without
acl), you cannot do show, enable and disable operations. (OT12027
rated as A1)

[9/7/94 public]
"server show -exec" works fine now (after OT12027 fixed the acl problem).



CR Number                     : 11999
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : rgy_edit 'good since date'
Reported Date                 : 9/1/94
Found in Baseline             : 1.1
Found Date                    : 9/1/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
			src/security/client/admin/rgy_edit/tty_conf.c
			src/security/h/sad_err.et
Sensitivity                   : public

[01/01/93 public]
[domian 3/19]



CR Number                     : 11995
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dced
Subcomponent Name             : keytab
Short Description             : keytab create command disregards keytype "plain"
Reported Date                 : 9/1/94
Found in Baseline             : 1.1
Found Date                    : 9/1/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/1/94 public]

Regardless which keytype is  specified in the data option ,"keytab show" 
always displays "des" , e.g.
dcecp> keytab create /.../c=ie/o=digital/hosts/sniosf2/config/keytab/gds \

> -attr  {
> {storage /opt/dcelocal/keys/gds2 }
> {data {helmut plain 1 helmut}}}
dcecp> keytab show  /.../c=ie/o=digital/hosts/sniosf2/config/keytab/gds
{uuid f840e260-c580-11cd-9401-08002b0f59bb}
{annotation  {}}
{storage /opt/dcelocal/keys/gds2}
{/.../c=ie/o=digital/helmut des 1}

[9/1/94 public]

The sec_key_mgmt i/f only supports "des" key now. You input the "plain" key
and then it's stored as "des" key. This is why it shows "des" key.

Rich, should we cancel it?

[09/01/94 public]
No -- it sounds like the server should reject "plain" as an unsupported
keytype.

[9/1/94 public]
It's just doing what sec_key_mgmt_set_key() does.  If you specify "plain" or
"des" as the passwd param, then read it with sec_key_mgmt_get_key(), it will
say type="des".  Always.  If the goal of rkeytab is to provide remote access
to sec_key_mgmt_XXX() functions, dced is doing the right thing.

If you reject "plain" in the server, and the passwd in the registry for
a prin is, say, "my-pass", there would be no way to set that passwd in
the local keytab file to "my-pass".  Here's a reasonable scenario:
    You write a new service that will run on several machines.
    You get your cell admin to create a prin for your server, and tell
	him to make the password "my-pass".
    Problem: How do you write that passwd to the key file on those
	server machines.

[9/1/94 public]
I talked Rich and some others about this. Agreement on the
above points. Canceling.



CR Number                     : 11965
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : 
Short Description             : auditing code results in
bus error in dtsd on hpux
Reported Date                 : 8/30/94
Found in Baseline             : 1.1b16
Found Date                    : 8/30/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/30/94 public]

When calls to the auditing service are included in the dtsd, the
program core dumps with a bus error. The latest backtrace (on the HP)
looks like this: 

0 idl_es_before_interp_call@libd + 0x00000078 (0x40209ed0, 0x40009da0, 0x400094d0, 0)
 1 audit_pickle_dencode_ev_info (h = 0x40209ed0, header = 0x40208c58, info = 0x40208c90, st = 0x40357490)    [audit_pickle_cstub.c: 962]
 2 dce_aud_commit (at = 0x4009bd78, ard = 0x40208c58, options = 0, format = 0, outcome = 2, status = 0x40357490)    [/project/dce/build/dce1.1-snap/src/security/audit/libaudit/evt_write.c: 684]
 3 GetTimeFromProvider (argPtr = 0x40205a38)    [../../../../src/time/service/provider_interface.c: 728]
 4 cma__thread_base@libdce + 0x0000021c (0x400329b0, 0, 0, 0)
 5 cma__thread_start1@libdce + 0x0000004c (0x400329b0, 0, 0, 0)
 6 cma__thread_start0@libdce + 0x00000008 (0x400329b0, 0, 0, 0)
 7 idl_es_before_interp_call@libd + 0x00000078 (0, 0, 0, 0)

This is a block bug, since it prevents auditing calls from being
compiled into the dtsd.

[8/31/94 public]
Rico, this is happening inside the stub: is the problem in the way audit calls
audit_pickle_dencode_ev_info, or is it internal?  Need help here.

[9/8/94 public]
Just a shot in the (nearly) dark here: in my past experience with dealing
with calling ES code directly from the main thread (ie, not in a server
stub), I've had similar feeling coredumps.  Calling rpc_sm_enable_allocate()
fixed it for me, tho I don't really understand why, or in what cases this
would be necessary. Rico has sent mail about this.  (I haven't followed all
the DTS code to see if it applies there, but it's a mindless thing to try
out...)

[09/08/94 public]
I ran on HP through the described path and I am not getting the bus error.
So I can't even try mindless things...

[09/09/94 public]
I tried this on prague here in Cambridge and was unable to reproduce the
bus error.  I am cancelling.



CR Number                     : 11958
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : Missing EXPDIR from admin/tcl_dce/Makefile
Reported Date                 : 8/30/94
Found in Baseline             : 1.1
Found Date                    : 8/30/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/30/94 public]

Howard,

   The file admin/tcl_dce/Makefile is trying to export a library, yet
it does not have the variable EXPDIR set.  The result is that this library
is placed in an area that is inaccessable to your build.  Please look into
this ASAP.

[ /admin/tcl_dce ]
*** makefile error: Can't export tcl.h because EXPDIR is not defined in the Makefile.
*** makefile error: Can't export dcetclmsg.h because EXPDIR is not defined in the Makefile.
*** makefile error: Can't export libtcl.a because EXPDIR is not defined in the Makefile.

[8/30/94 public]
I don't understand.  It seems to build in the nightly builds so I assume
that the warnings were from running build in some kind of lint mode?

The Makefile says:

  LIBRARIES        = libtcl.a
  INCLUDES         = tcl.h dcetclmsg.h
  libtcl.a_EXPDIR  = /usr/lib/
  tcl.h_EXPDIR     = /usr/include/dce/
  dcetclmsg.h_EXPDIR     = /usr/include/dce/

So there are EXPDIR's for each of the things we export, and looking at the
builds, things really do make it into the export tree.  I suppose it would
shorter to code:

  LIBRARIES        = libtcl.a
  INCLUDES         = tcl.h dcetclmsg.h
  EXPDIR           = /usr/include/dce/
  libtcl.a_EXPDIR  = /usr/lib/

But this is prone to adding new things to be exported and having them go
into /usr/include/dce by default, which might not be what we want.

[8/31/94 public]
Cancelled, a problem with the warning generating tool, not the code.



CR Number                     : 11957
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : EXPDIR not defined in rpc/kdes/Makefile for export pass.
Reported Date                 : 8/30/94
Found in Baseline             : 1.1
Found Date                    : 8/30/94
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/30/94 public]

Tom,
   Please check the file /rpc/kdes/Makefile.  It is trying to export some 
files while not definine EXPDIR in the Makefile.  The result is that they are 
put in a place that is inaccessable to your builds.


[ /rpc/kdes/Makefile ]
*** makefile error: :Can't export libkdes.a because EXPDIR is not defined in the Makefile.

[8/31/94 public]
Double checked Makefile, libkdes.a_EXPDIR is defined.
Canceled.



CR Number                     : 11955
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9748
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : 
Short Description             : Missing EXPDIR in GDS Makefiles
Reported Date                 : 8/30/94
Found in Baseline             : 1.1
Found Date                    : 8/30/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/30/94 public]

Rich,
Below is a list of GDS Makefiles that do not have EXPDIR defined
(yet they are trying to export something).  Currently, these targets
are ending up in the install tree and are not used as part of the build.
We need you to look into this ASAP.  

[ /directory/gds/ASN1/Makefile ]
*** makefile error: Can't export asn1.h because EXPDIR is not defined in the Makefile.
[ /directory/gds/rtros/ros/roliby/Makefile ]
*** makefile error: Can't export librosx.a because EXPDIR is not defined in the Makefile.
*** makefile error: Can't export librosstep.a because EXPDIR is not defined in the Makefile.
*** makefile error: Can't export libdriv25.a because EXPDIR is not defined in the Makefile.
[ /directory/gds/rtros/com/roliby/Makefile ]
*** makefile error: Can't export libcomstep.a because EXPDIR is not defined in the Makefile.
*** makefile error: Can't export librtrosasn1.a because EXPDIR is not defined in the Makefile.
*** makefile error: Can't export libcom.a because EXPDIR is not defined in the Makefile.
[ /directory/gds/rtros/tpdu/Makefile ]
*** makefile error: Can't export libtpdu.a because EXPDIR is not defined in the Makefile.
[ /directory/gds/osiadr/Makefile ]
*** makefile error: Can't export libosiaddr.a because EXPDIR is not defined in the Makefile.
[ /directory/gds/asn1/DUA/Makefile ]
*** makefile error: Can't export libDUA.a because EXPDIR is not defined in the Makefile.
[ /directory/gds/cisam/isam/Makefile ]
*** makefile error: Can't export libisam.a because EXPDIR is not defined in the Makefile.
[ /directory/gds/nds/Makefile ]
*** makefile error: Can't export libNDS.sl because EXPDIR is not defined in the Makefile.

[9/1/94 public]
I don't understand this defect.  This doesn't happen in the nightly build.
Under what circumstances did you find this?

[9/1/94 public]
As per your request (CR # 9748) to insure that missing EXPDIR from a Makefile
does not default to using IDIR; I did a build of DCE with a modified
version of osf.std.mk to weed out Makefiles that may have this problem.
You recieved a list of gds makefiles that need to be checked (and possibly
fixed).  This check in osf.std.mk has not been (and probably won't be) 
submitted to the tree, so, you won't see these error messages in the
nightly build logs.

[9/1/94 public]
It turns out that all the makefiles listed above have target specific
EXPDIR values (e.g., libxxx.a_EXPDIR).  Therefore, no fix is necessary.
Cancelled.



CR Number                     : 11952
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : bad malloc/free usage in
security API
Reported Date                 : 8/30/94
Found in Baseline             : 1.1b16
Found Date                    : 8/30/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/30/94 public]

When running the a debugging malloc library on the HP, the following 
security API calls generate errors:

	sec_id_parse_name	pointer within malloc arean but
				outside of data bounds 

	sec_rgy_pgo_name_to_id() MALLOC Warning from free():
				Malloc region does not have valid 
				magic number in header


The first is probably OK (although still wrong); the 2nd implies that 
memory is being free'd (fried?) that has never been malloc'ed ... a 
bad idea.

[8/31/94 public]
Neither of those routines are doing malloc/free/memcpy/strcpy themselves,
they basically just make RPC calls...  I suspect that you're using the
PD malloc tool that you link with the binary (as opposed to building everything
with it) and that it's really a lower level security call being made from
beneath the RPC layer that's performing the mischief...  Is there any way
to get more detail from this tool?

[8/31/94 public]

Yes, you can get more detail, but it means that you must recompile
using the specialized malloc header (renames all your
malloc/memXXX/strXXX functions). However, this would probably conflict
with using pthreads.h, that already renames a bunch of these functions
to make them thread-safe.

Not much help, I'm afraid.

[8/31/94 public]
Since the info reported in this CR can't possibly happen in those routines,
and since we can't get more info from this debug malloc because of a conflict
with pthread/cma malloc, and since we other CRs open for memory leak and
for mem corruption problems, I'm going to cancel this one.  When we get
real info from one of the other mem tracking packages (Bill had one for
cma_malloc and Sentinel is a possibility), we'll open CRs pointing to the
real problems...  Thanks for trying...



CR Number                     : 11939
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : 
Short Description             : dtsd core dumping on RIOS
Reported Date                 : 8/29/94
Found in Baseline             : 1.1b16
Found Date                    : 8/29/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/29/94 public]
Using bl-16, dtsd config'd as a local server on a RIOS core dumped:

root@cobbler> dbx /opt/dcelocal/bin/dtsd ./var/adm/time/core
dbx version 3.1 for AIX.
Type 'help' for help.
reading symbolic information ...
[memory image in ./var/adm/time/core]

segmentation violation in rpc_ns_binding_select at 0xd047e590
0xd047e590 (rpc_ns_binding_select+0x88) 80630004          l   r3,0x4(r3)
(dbx) where
rpc_ns_binding_select(0x2016b1f8, 0x2ff7e0d4, 0x2ff7e0cc) at 0xd047e590
rpc_ns_binding_import_next(0x2016b008, 0x2ff7e0d4, 0x2ff7e0cc) at 0xd047cf50
PopulateCacheFromRPCprofile(0x1, 0x200cbd10, 0x200cbd34) at 0x10025ac4
PopulateLocalCache(0x1002836c) at 0x100257f8
Synchronize(0x4, 0x2016af98) at 0x1002836c
ProcessEvent(0x2016af98) at 0x100005d4
main(0x2, 0x2ff7f994) at 0x100004bc

The cell had been up a little bit over 2 days at the time of the
core dump. Cell config is:

 1 RIOS X 3 HP
 m1 (R) = security server, dts server, flserver, fileserver (native and lfs)
 m2 (H) = cds server, dts server, flserver, fileserver (native and lfs)
 m3 (H) = dts server, flserver, fileserver (native and lfs)
 m4 (H) = client-only

ie. 3 local dts servers, 1 clerk - local dts server on m1 (and m3) core dumped
(different traces - HP dts core dump = CR 11912)

[9/12/94 public]
Haven't seen this - have config'd 3 RIOS's w/ bl-17 as dts local
servers successfully. George will exercise this along with config'ing
cds replicas repeatedly to give us confidence in downgrading/canceling
this CR and CR 11574.

[9/12/94 public]
I have a 3 machine cell and I have attached to the dtsd process
on each machine. We have been trying to get dtsd to core dump while
attached to it but so far that has not occured. We have been doing this
for over a week with BL16 and we are now running BL17. I am also
investigating how to get a core file that will contain the heap.
We have one machine here that dumps the heap with the core. This
would have been very useful for the core file reported for CR 11544,
which is similar to this CR.

[9/14/94 public]
George got dts to core dump this morning BUT ... the core dump looks
less useful than usual ... He is working on a script to loop stopping
and restarting dce core services and dbx attaching to the dtsd process.

[9/22/94 public]
Dropping to a 1 for the time being, hasn't been seen so may be canceled -

[9/22/94 public]
Could this problem be about the same as OT 12065?

[9/22/94 public]
It would be unlikeley since the backtrace above has no relation
to the shared memory segment.  Looking at rpc_ns_binding_select,
there are very few places to generate a seg-fault.  The only
pointer referenced is binding_vector, and from the arg list
it doesn't look to be trashed.  We might have to consider this
backtrace garbage and cancel this defect as unreproducable.
If during debugging SVC was turned on (for rpc for instance)
OT 12065 would occur andit might look like this was being duplicated.

[10/3/94 public]
Since I don't believe this is still being seen on the RIOS.
It could be related to 12065.
I am going to cancel this defect.  
Please re-open if someone with a RIOS has seen dtsd core dump with 
recent (bl-20 or later) builds.



CR Number                     : 11920
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : srvrconf
Short Description             : srvrconf_start dumps core
Reported Date                 : 8/26/94
Found in Baseline             : 1.1b16
Found Date                    : 8/26/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/26/94 public]

Found in 8/25 NB -):

server start dumps core. Here is the server and trace,

dcecp> server show tserver1
{uuid def0f86c-c108-11cd-a947-0000c010df56}
{program tserver}
{arguments /.:/hosts/foster/test_server}
{prerequisites {}}
{keytabs {}}
{entryname /.:/hosts/foster/test_server}
{services
 {{ifname {test server}}
  {annotation {dcecp server test program}}
  {interface {008bebed-c7c1-1ddc-9cb3-0000c0ba4944 1.0}}
  {bindings {ncadg_ip_udp 130.105.5.50}}
  {objects 0073f23a-2e1a-1ddd-b73a-0000c0ba4944}
  {flags {}}
  {entryname /.:/hosts/foster/test_server}}}
{principals /.../foster_cell/tserver}
{starton explicit}
{uid 0}
{gid 0}
{dir /project/dce/build/nb_486/install/at386/dcetest/dce1.1/test/tet/functional/admin/dcecp/ts/server}
dcecp> server start tserver1
Error: Communications failure

========
(gdb) r -d
Starting program: /usr/bin/dced -d
DEBUG: register_servers
DEBUG: dced_wait_for_register
DEBUG: dced_wait_for_sec
DEBUG: acl_patcher
DEBUG:sec_clientd_setup_first_context
DEBUG:setup first succeeds
DEBUG:Exiting sec_clientd_setup_1rst_context:0
DEBUG: dced_wait_for_secval
DEBUG:maintain_machine_context

Program received signal 11, Segmentation fault
0xa41b55a7 in cma__reinit_thread_io (0)
(gdb) bt
#0  0xa41b55a7 in cma__reinit_thread_io (0)
#1  0xa41c3af3 in cma_fork ()
#2  0x40cbca in srvrconf_start (h=0x592798, id_uuid=0x616aec, fixed=0x0, 
    attributes=0x0, instance=0x5971c0, st=0x616adc)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/scops.c:562
#3  0x424ded in op6_ssr (h=0x592798, IDL_call_h=0x572a70, IDL_elt_p=0x616e38, 
    IDL_drep_p=0x616e68, IDL_transfer_syntax_p=0xa4498120, 
    IDL_mgr_epv=0x431bac, IDL_status_p=0x616e60) at srvrconf_sstub.c:2443
#4  0xa421eb7e in rpc__dg_execute_call (5712496, 0)
#5  0xa41d3fdc in cthread_call_executor (5710880)
#6  0xa41abb77 in cma__thread_base ()
#7  0xa41b0f69 in cma__create_thread ()
#8  0xa41d3e2c in cthread_call_executor ()
#9  0x5fc3f8 in acl_db ()
Cannot access memory at address 0x2.
(gdb)

[8/31/94 public]
Ping, can you repeat this?  This worked fine for me (486) with
last night's bld:

    dcecp> server create  -prog /tmp/test1 -gid 0 -uid 0 -dir /tmp \
      -prin test1 -entryname /.:/hosts/acme/test1  test1
    dcecp> server cat  -prog /tmp/test1 -gid 0 -uid 0 -dir /tmp \
    /.../bigred/hosts/acme/config/srvrconf/ep-compat
    /.../bigred/hosts/acme/config/srvrconf/test1
    dcecp> server sh test1
    {uuid e68b9438-c50e-11cd-9b60-0000c09ce054}
    {program /tmp/test1}
    {arguments {}}
    {prerequisites {}}
    {keytabs {}}
    {entryname /.:/hosts/acme/test1}
    {services {}}
    {principals /.../bigred/test1}
    {starton {}}
    {uid 0}
    {gid 0}
    {dir /tmp}
    dcecp> ser start test1
    ee21e0f8-c50e-11cd-8b8e-0000c09ce054

And the program started and ran.  (I did not try defining "services" yet.)

Lowered priority, since it worked for me...

[9/1/94 public]
I tried last NB, it works fine. It could be some changes checked in during
this week fixed tis problem as side effect. So I'm cancelling this OT.



CR Number                     : 11914
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : backwards compat broken by show mapping format chg
Reported Date                 : 8/26/94
Found in Baseline             : 1.1
Found Date                    : 8/26/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/26/94 public]
I'm unable to configure a 1.0.3a security client to a 1.1 
security server.  The problem appears to lie in a format 
change in the output from rpccp show mapping.  103a 
dce_config awks through this output to populate the pe_site 
file with the address of the security server.  Since the 
format has changed, 103a dce_config can't find the interface 
id for the security server.  Here's the old and new output:

NEW:
  <object>         371f8d5e-c02e-11cd-8d58-080009247863
  <interface id>   4c878280-5000-0000-0d00-028714000000,1.0
  <string binding> ncacn_ip_tcp:130.105.4.201[1046]
  <annotation>     DCE user registry

OLD:
  <object>         0080852c-ef9e-1c7c-9169-08005a0d4582
  <interface id>   4c8782805000.0d.00.02.87.14.00.00.00,1.0
  <string binding> ncacn_ip_tcp:130.105.4.200[1039]
  <annotation>     DCE user registry

Notice the new display uses dashes while the old uses dots
in the interface id.  Looks like the new display has extra
zeroes in the interface id display as well.  Someone changed 
1.1 dce_config to look for dashes now which is why it works 
using the 1.1 dce_config.

[08/26/94 public]
I believe Tom chainged uuid_to_string.

[8/26/94 public]
Why, yes I did. From a defect (10052) filed by one of our chief
architects, Walt Tuvell, who should now defend my action
as being the right way because he said so...

[08/26/94 public]
I just thought of something -- are you using new rpccp and old dce_config?
If so, cancel this.

[8/26/94 public]

You must be using the 1.0.3 rpccp with the 1.1 shared libdce or the 1.1
rpccp with the 1.1 shared libdce since the uuid_to_string change is in the
library. Here is the example diff from "rpccp show mapping ip:dce_rpc":
(dce_rpc is at 1.1, the line "-" on 1.0.3 client and the "+" on 1.1)

   <object>         1340c542-c047-11cd-92a8-08000912c4f1
-  <interface id>   4c8782805000.0d.00.02.87.14.00.00.00,1.0
+  <interface id>   4c878280-5000-0000-0d00-028714000000,1.0
   <string binding> ncacn_ip_tcp:15.22.50.65[1061]
   <annotation>     DCE user registry

[8/26/94 public]
It's not what I intended, but I had old dce_config and new rpccp.
Looks like my /opt/dce symlink was never updated during dce_config
install.  It continues to point to /opt/dce1.1 which points to a 
1.1 install tree.  So my 1.0.3a dce_config session setup 
/opt/dce1.0 which points to a 1.0.3a install tree, but then 
proceeded to reference binaries through /opt/dce.  The result was 
I got 1.1 binaries while using a 1.0.3a dce_config and specifying 
a 1.0.3a install tree.  Looks like there's code in 1.0.3a 
dce_config to handle updating the /opt/dce symlink, but it didn't 
work for me.. Do we care?

[8/26/94 public]
OK, I tracked it down to the exact line with the problem
in dce_config.  Tom already fixed it in 1.1 dce_config.  
Since we don't expect customers to be installing 1.0.x over 
1.1 (at least we hope), this is not really important enough 
to care about.  Cancelled.  What a colossal waste of time...



CR Number                     : 11913
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11423,11708
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : another "who are you" failure
Reported Date                 : 8/26/94
Found in Baseline             : 1.1b16
Found Date                    : 8/26/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/26/94 public]

Running the fts tests 12 and 14 on bl-16, hit (among other things -
see CR 11708 if interested):

Removing filesets...
Fileset 0,,123 on aggregate m3.aggr2 server /.:/hosts/dce11 deleted
AFS_SetContext(cobbler.osf.org) fails: who are you failed (dce / rpc)
Error in delete: who are you failed (dce / rpc)
AFS_SetContext(cobbler.osf.org) fails: who are you failed (dce / rpc)
Error in delete: who are you failed (dce / rpc)
Fileset 0,,134 on aggregate m3.aggr2 server /.:/hosts/dce11 deleted
fts delmount: error removing mount point for /.../cho_cell.qadce.osf.org/fs/test/ft4.5377: Connection timed out

I'm wondering if the fix for 11423 was only done in user space and not
kernel space (maybe?). Unfortunately, this problem is not AS easily
reproducable as 11423 - I have successfully removed filesets and not
seen these messages. Any ideas?

[8/26/94 public]
In addition, a subsequent run of the fts tests resulted in a ftserver
core dump - trace contains "localauth" routines - see CR 11708 for
details. (Recall the "-localauth" switch was the easiest way to
produce "who are you" problems, CR 11423, since this switch caused
an immediate ticket refresh).

[8/29/94 public]
Can you reproduce the who_are_you error while running the auth helper in
debug mode (ie: restart dfsbind with -debug) and see if we get any error
messages from it)?  If running this across multiple machines then run the
dfsbind on the server side in debug mode at least, and then if you have time
and it's not a hassle, try it on the client side too.  I believe the fix
for 11423 was in common code, so that shouldn't be the problem. 
Can you try to reproduce this problem with something later than 8/25
when I submitted a fix to sec_authn.c, sec_authn_krpc.c and auth_helper.c?

[8/29/94 public]
Thanks for the suggestion - reinstalling with LGB 16.2 (binaries dated 8/24 and
8/25) - will let you know.

[8/30/94 public]
Didn't reproduce "who are you" error with 16.2 - but dfsbind core dumped
early on (another instance of CR 11925). Dropping the priority until I
can reproduce/cancel.

[9/6/94 public]
Darn - reproduced ...  with bl-16.3 - but not much more info:
Removing filesets...
AFS_SetContext(dce11.osf.org) fails: Who are you failed (dce / rpc)
Error in delete: Who are you failed (dce / rpc)

Error occured only once - at about the 21 hour mark.
Rerunning tonight with dfsbind -debug.

[9/6/94 public]
Bummer ... starting up dfsbind -debug slows things down so much
you can't do anything - (dfsbind -debug on 3 servers seems to 
prevent quorum) - stopping and restarting some w/o debug didn't
seem to be enough to recover - other ideas?

[9/14/94 public]
Reproduced with bl-17 - (This portion of the fts tests is testing
quotas so "disk quota exceeded" messages are GOOD :-)

dfs: rpc errors (code 382312711) from the fx server 130.105.5.22 in cell cobbler_cell.qadce.osf.org
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: rpc errors (code 382312543) from the fx server 130.105.202.28 in cell cobbler_cell.qadce.osf.org
dfs: server disk quota exceeded
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.202.28 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.202.28 in cell cobbler_cell.qadce.osf.org back up!
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: rpc errors (code 382312543) from the fx server 130.105.201.7 in cell cobbler_cell.qadce.osf.org
dfs: set auth binding failed (code 382312711); running unauthenticated.
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.201.7 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.201.7 in cell cobbler_cell.qadce.osf.org back up!
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded

where:
stcode_hp 382312711
382312711 (decimal), 16c9a107 (hex): Helper process catatonic (dce / rpc)

stcode_hp 691089613
691089613 (decimal), 293130cd (hex): status 0x293130cd (dfs / xvl)

stcode_hp 382312543
382312543 (decimal), 16c9a05f (hex): Who are you failed (dce / rpc)

Still investigating ... any input welcome ...

[9/14/94 public]
Well - dfsbind is awful busy on dce8 - using top, it showed it was using
CPU constantly, sometimes as much as 80% and had logged 408 minutes of
time since the cell was started 48 hours ago).

TTY   PID USERNAME  PRI   NI  SIZE  RES  STATE   TIME   %WCPU  %CPU  COMMAND
?     8187 root    241   20 10428K  352K  wait  409:39  85.01  84.86/opt/dcelocal/bin/dfsbind


I used xdb to attach to it to see if I could tell what was going on - can't set any breakpoints (not built
correctly?) but I can send SEGV signals get a trace and continue! Can
we trust any of this?! Second 2 traces are the same anyway ...

 0 _doprnt@libc + 0x0000019c (0x4001bec8, 0x400da138, 0, 0)
 1 vsprintf@libc + 0x00000040 (0x4001bec8, 0x7aff1388, 0, 0)
 2 cma_sprintf@libdce + 0x000001c4 (0x409a64b0, 0x7afb3110, 0x13, 0x40149c24)
 3 asn1_text_time@libdce + 0x0000031c (0x409a64b0, 0x40149a20, 0x1, 0)
 4 asn1_gen_time@libdce + 0x0000003c (0x409a64b0, 0x40149a20, 0, 0)
 5 krb5_timestamp2asn1_field@libd + 0x00000084 (0x4014989c, 0x409a4624, 0x409a460c, 0)
 6 krb5_kdc_req2KDC_REQ_BODY@libd + 0x00000108 (0x40149884, 0x409a4600, 0xb, 0xa)
 7 krb5_encode_generic@libdce + 0x0000008c (0x40149884, 0x401498d4, 0x7af387ea, 0x48)
 8 krb5_send_tgs@libdce + 0x000006ac (0, 0x409a3664, 0x40140001, 0x40140002)
 9 krb5_get_cred_via_tgt@libdce + 0x000001b0 (0x401496f0, 0, 0x40140001, 0x40140002)
 10 krb5_get_cred_from_kdc@libdce + 0x00000984 (0x40277420, 0x409a3650, 0x40149660, 0x409a3650)
 11 krb5_get_credentials@libdce + 0x00000178 (0x10, 0x40277420, 0x409a3650, 0x401495e0)
 12 sec_krb_get_cred@libdce + 0x00000268 (0x409a37b0, 0x4099a610, 0x5, 0x2)
 13 rpc__krb_get_tkt@libdce + 0x000003d8 (0x409a34e8, 0x5, 0x4099eb60, 0x409a3538)
 14 rpc__krb_bnd_set_auth@libdce + 0x00000670 (0x4099eb60, 0x5, 0x409a37b0, 0x2)
 15 rpc_binding_set_auth_info@libd + 0x00000448 (0x4054e0e8, 0x4099eb60, 0x5, 0x1)
 16 rca_setup_handle@libdce + 0x000005e0 (0x4099fc98, 0x401482d4, 0x401482d4, 0)
 17 rca_site_bind_nsi_cell_if@libd + 0x000001dc (0x4099fc98, 0x40999a70, 0x7afa7920, 0x401482d4)
 18 rca_site_bind_nsi_cell@libdce + 0x000000d0 (0x4099fc98, 0x40999a70, 0x401482d4, 0)
 19 rca_nsi_binding_import@libdce + 0x000001ec (0x4099fc98, 0x401482d4, 0x401487a8, 0x401482d4)
 20 rca_site_bind@libdce + 0x0000059c (0x401483a0, 0x401476b0, 0x3, 0)
 21 sec_rgy_site_bind@libdce + 0x00000068 (0x40147ed0, 0x401476b0, 0x401476c4, 0x401482d4)
 22 sec_rgy_site_bind_query@libdce + 0x00000048 (0x40147ed0, 0x401476b0, 0x401476c4, 0x401482d4)
 23 sec_krb_sec_parse_name@libdce + 0x0000013c (0, 0x5, 0x4013d0b4, 0x40147650)
 24 cred_from_cred_rep (credrep = 0x4014757c, cred = 0x40147540, cred_context = 0x4014753c, cache_slot = 0x40147594)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 686]
 25 handle_sec_krb_dg_build_message (inptr = 0x4013d0ed, inlen = 133, outbuf = 0x4013e090)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 807]
 26 do_auth_request (inptr = 0x4013d094, inlen = 133, outbuf = 0x4013e090, outsize = 0x4013d080)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 1183]
 27 ProcessRequest + 0x000000f4 (0x4013d078, 0x29c6b013, 0x1000000, 0x4ac)
 28 service_thread + 0x00000128 (0x4001af88, 0x7af51478, 0x400da138, 0x5)
 29 cma__thread_base@libdce + 0x0000021c (0x400da138, 0, 0, 0)
 30 cma__thread_start1@libdce + 0x0000004c (0x400da138, 0, 0, 0)
 31 cma__thread_start0@libdce + 0x00000008 (0x400da138, 0, 0, 0)
 32 _rpc_createerr@libc + 0x0000031c (Bad access to child process (UE308)
-------------------------------------------------------------------------
 0 read@libc + 0x00000008 (hp-ux export stub)
 1 cma_read@libdce + 0x000009a4 (0xa, 0x4099e3a0, 0x4, 0)
 2 krb5_fcc_read@libdce + 0x00000048 (0x408c7ab8, 0x4099e3a0, 0x4, 0x401c3ba4)
 3 krb5_fcc_read_int32@libdce + 0x0000003c (0x408c7ab8, 0x4099e3a0, 0x1a, 0x401c38f4)
 4 krb5_fcc_read_data@libdce + 0x00000040 (0x408c7ab8, 0x4099e3a0, 0x2, 0)
 5 krb5_fcc_read_principal@libdce + 0x000001c0 (0x408c7ab8, 0x401c37ac, 0x1, 0)
 6 krb5_fcc_next_cred@libdce + 0x000001cc (0x408c7ab8, 0x401c37a0, 0x401c37a8, 0x401c37a8)
 7 krb5_fcc_retrieve@libdce + 0x000001c0 (0x408c7ab8, 0x21, 0x401c3724, 0x40998a20)
 8 krb5_get_credentials@libdce + 0x000000f8 (0x10, 0x408c7ab8, 0x40998a20, 0x401c36a0)
 9 sec_krb_get_cred@libdce + 0x00000268 (0x409b6078, 0x409850c0, 0x4, 0x2)
 10 cred_from_cred_rep (credrep = 0x401c354c, cred = 0x401c3548, cred_context = 0x401c3564, cache_slot = 0x401c3568)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 690]
 11 handle_sec_krb_get_cred (inptr = 0x4013f0f5, inlen = 81, outbuf = 0x401400a4)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 755]
 12 do_auth_request (inptr = 0x4013f0a8, inlen = 81, outbuf = 0x401400a4, outsize = 0x4013f094)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 1183]
 13 ProcessRequest + 0x000000f4 (0x4013f08c, 0x29c6b013, 0x1000000, 0xffffffff)
 14 service_thread + 0x00000128 (0x4001afa0, 0x7af51478, 0x400ddb38, 0x9)
--------------------------------------------------------------------------
 0 read@libc + 0x00000008 (hp-ux export stub)
 1 cma_read@libdce + 0x000009a4 (0xa, 0x409aacac, 0x4, 0)
 2 krb5_fcc_read@libdce + 0x00000048 (0x409850c0, 0x409aacac, 0x4, 0x401aa934)
 3 krb5_fcc_read_int@libdce + 0x0000003c (0x409850c0, 0x409aacac, 0x4, 0)
 4 krb5_fcc_read_authdatum@libdce + 0x0000007c (0x409850c0, 0x409aaca8, 0x4, 0)
 5 krb5_fcc_read_authdata@libdce + 0x00000170 (0x409850c0, 0x401aa828, 0x1, 0)
 6 krb5_fcc_next_cred@libdce + 0x00000334 (0x409850c0, 0x401aa7e0, 0x401aa7e8, 0x401aa7e8)
 7 krb5_fcc_retrieve@libdce + 0x000001c0 (0x409850c0, 0x21, 0x401aa764, 0x409a5bc8)
 8 krb5_get_credentials@libdce + 0x000000f8 (0x10, 0x409850c0, 0x409a5bc8, 0x401aa6e0)
 9 sec_krb_get_cred@libdce + 0x00000268 (0x409be648, 0x409940f0, 0x4, 0x2)
 10 cred_from_cred_rep (credrep = 0x401aa57c, cred = 0x401aa540, cred_context = 0x401aa53c, cache_slot = 0x401aa594)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 690]
 11 handle_sec_krb_dg_build_message (inptr = 0x40141115, inlen = 133, outbuf = 0x401420b8)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 807]
 12 do_auth_request (inptr = 0x401410bc, inlen = 133, outbuf = 0x401420b8, outsize = 0x401410a8)    [/project/dce/build/dce1.1-snap/src/security/helper/auth_helper.c: 1183]
 13 ProcessRequest + 0x000000f4 (0x401410a0, 0x29c6b013, 0x1000000, 0x4a4)
 14 service_thread + 0x00000128 (0x4001af88, 0x7af51478, 0x400dccb8, 0x8)

[9/14/94 public]
How about shooting dfsbind with SIGUSR1 when it gets in this mode
to get the ICL log?

[9/16/94 public]
Yup - I could do the USR1 thing too - but I think I'm going to hand this
off to Andy McKeen to pursue further if I don't have anything useful on
Monday for this one - all this data collection is getting me nowhere. Here's
today's:

again - helper catatonic messages, set context errors and lost contact
messages :
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.201.7 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.201.7 in cell cobbler_cell.qadce.osf.org back up!
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.201.7 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.201.7 in cell cobbler_cell.qadce.osf.org back up!
dfs: server disk quota exceeded
dfs: server disk quota exceeded
dfs: set auth binding failed (code 382312711); running unauthenticated.
dfs: set auth binding failed (code 382312711); running unauthenticated.
dfs: set auth binding failed (code 382312711); running unauthenticated.
dfs: comm failure/set context: code 382312543
dfs: lost contact with the fx server 130.105.5.22 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.5.22 in cell cobbler_cell.qadce.osf.org back up!
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.201.7 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.201.7 in cell cobbler_cell.qadce.osf.org back up!
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.202.28 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.202.28 in cell cobbler_cell.qadce.osf.org back up!
dfs: server disk quota exceeded
dfs: set context failed: code 691089613
dfs: lost contact with the fx server 130.105.5.22 in cell cobbler_cell.qadce.osf.org
dfs: file server 130.105.5.22 in cell cobbler_cell.qadce.osf.org back up!
dfs: set context failed: code 691089613

root@dce11> stcode_hp 382312543
382312543 (decimal), 16c9a05f (hex): Who are you failed (dce / rpc)
root@dce11> stcode_hp 691089613
691089613 (decimal), 293130cd (hex): status 0x293130cd (dfs / xvl)
root@dce11> stcode_hp 382312711
382312711 (decimal), 16c9a107 (hex): Helper process catatonic (dce / rpc)

the dfsbind -debug output doesn't contain anything interesting EXCEPT
tid(11):Importing pag ffffffff, `FILE:/opt/dcelocal/var/security/creds/dcecred_ffffffff'
makes me think of the current cds-security bug with the updated credentials
in the same name credentials file problem ... could there be a relation? these
dfs messages aren't timestamped but they do take "awhile" to show up - maybe
I am hitting the ticket expiration ...

ps -efl output to give you an idea of dfsbind's growth and time allotment:

DATE_PS: Thu Sep 15 18:56:21 EDT 1994

  1 S    root  1654  1623  1 154 20  259d7c0 1026   23b180 18:52:32 ttys1    0:06 dfsbind -debug
  1 S    root  1371  1367 -65 154 20  20f9dc0 1956   23b180 18:42:01 ?        2:10 /opt/dcelocal/bin/cdsclerk


DATE_PS: Fri Sep 16 17:05:54 EDT 1994

  1 S    root  1654  1623  0 154 20  259d7c0 2023   23b180 18:52:32 ttys1   286:36 dfsbind -debug
  1 S    root  1371  1367 38 154 20  20f9dc0 2066   23b180 18:42:01 ?       240:09 /opt/dcelocal/bin/cdsclerk

Note that cds was right up there with dfsbind ...

[9/21/94 public]
Okay - another tidbit - adding Tom to the interest list since dts
reported the "who are you" failure this time:

1994-09-20-13:44:08.249-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x401bff28 RPC call ClerkRequstTime() to remote server failed: Communications failure (dce / rpc)
1994-09-20-13:47:16.665-04:00I----- dtsd ERROR dts dtserror dtss_service_global_
set.c 478 0x7aff8550 Couldn't get remote server's principal name: Communications
failure (dce / rpc)
1994-09-20-17:54:38.502-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x
401bf0a8 RPC call ClerkRequstTime() to remote server failed: Communications failure (dce / rpc)
1994-09-21-11:25:36.172-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x401bf0a8 RPC call ClerkRequstTime() to remote server failed: Communications failure (dce / rpc)
1994-09-21-11:25:43.036-04:00I----- dtsd ERROR dts dtserror dtss_service_global_set.c 478 0x7aff8550 Couldn't get remote server's principal name: Communicationsfailure (dce / rpc)
1994-09-21-13:25:09.584-04:00I----- dtsd ERROR dts dtsdate time_request.c 685 0x401bff28 RPC call ClerkRequstTime() to remote server failed: Who are you failed (dce / rpc)

This output from serviceabilty ERROR file on an hp (m2) running bl-18, config
of cell is:
 1 RIOS X 3 HP
 m1 (R) = security server, dts server, flserver, fileserver (native and lfs)
 m2 (H) = cds server, dts server, flserver, fileserver (native and lfs)
 m3 (H) = dts server, flserver, fileserver (native and lfs)
 m4 (H) = client-only

 DFS functional acl tests were running on m2, keeping dfsbind busy
 to the point that some "helper catatonic" messages were being output. A
 single dfs.repfs test was also being run between m1 and m3 with some
 "helper catatonic" messages as well - are dtsd servers being starved
 somehow?

[9/22/94 public]

Priority upped to '0' because it's on the "blocking system test
execution" list.

[9/22/94 public]
This bug has gotten too convoluted (even for me :-)
Opening 3 separate CRs for:
	rpc failures (comm failures and who are you seen with dts and dfs)
	(12315)
	set context failed (12313)
	dfsbind spins (12311)
and cancelling this one.

[9/23/94 public]
:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(
I had so much mail to go through this morning that I missed commenting on
this before you cancelled it :-(:-(:-(:-(:-(

For the record, I don't agree with the cancellation of this one and the
opening of 3 more.  The DTS problem may have been different because it
shouldn't be using the kernel version of the who are you decoding routines,
BUT:  The AFS set context failed (12313) because the who are you failure
(12315), which I believe is usually caused by a spinning dfsbind (12311).
:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(:-(

[9/23/94 public]
Hmm ... how 'bout if I cancel the set context one and combine it with
the spinning dfsbind one - then there's just 2, the dts one and the
spinning dfsbind one? The dts problem is definitely not related to
any kernel version of who are you decoding routines since I don't
install DTS kernel extensions (and even if I did, I don't believe
those are contained in them).

[ dassarma 0/28/94 public]

I do not want to re-open this CR, but I do want to record that
after 40 CHO,  the "Who are you error" is being reported. 
The cell in general is very  slow at this point.

The exact error reported reads:

root@west> 1994-09-28-13:07:52.574-04:00I0.974 cdsclerk(7345) ERROR cds
general clerk_bind.c 627 0x40568bf8
Routine sec_rgy_pgo_is_member(3sec) failed : status = 382312543.

root@bronze> stcode 382312543 
Tech = 1 = 01 = 0x1 = dce
Comp = 27802 = 066232 = 0x6c9a = rpc
Mesg = 95 = 0137 = 0x5f = who are you failed

[9/29/94 public]

I don't want to re-open this either, but I'm seeing this message 
after configuring a BL-20 cell.

The cell is configured as follows:

HP-UX: secd dtsd
OSF1:  cdsd dtsd
OSF1:  client dtsd ntp_provider

The OSF/1 machines are reporting RPC_CN_AUTH_VFY_CLIENT_REQ errors 
(see CR 11009), and the HP-UX is reporting:

1994-09-29-16:09:33.389-04:00I116.524 dtsd WARNING dts config logevent_v_ultrix.
c 269 0x7affa020
Too few servers (2), need 3 servers
1994-09-29-16:11:28.806-04:00I116.639 dtsd ERROR dts dtsdate time_request.c 689
0x401bb6d8
RPC call ClerkRequstTime() to remote server failed: Who are you failed (dce / rp
c)

[9/29/94 public]
This was not cancelled because we thought the problem went away.
If you read the above comment where gmd cancelled it, you'll see that she
felt that this CR had too much junk in it describing multiple problems, so
she was opening more CRs to describe the problems here.  The problems you're
still seeing are the ones that she describes in CR12315 (noted above when
she cancelled this) and any more info you find should be added there.
I'm re-cancelling this one.



CR Number                     : 11899
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : multi-machine smoketest on mudslide
Reported Date                 : 8/25/94
Found in Baseline             : 1.1
Found Date                    : 8/25/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/25/94 public]

S:****** Check for active sec_client service
valid 1rst:387063936
ERROR:   rgy_edit - creating ktab entry in registry database.
  Message from rgy_edit:
  Current site is: registry server at /.../sif_cell/subsys/dce/sec/master 
Domain changed to: principal
?(rgy_edit) Unable to add principal "hosts/mudslide/self" - Principal already ex
ists (Registry Edit Kernel)
 (dce / sad)
Domain changed to: account
?(rgy_edit) Unable to add "hosts/mudslide/self" - Specified object already exist
s (Registry Edit Kernel)
 (dce / sad)
Domain changed to: account
?(rgy_edit) Unable to add "hosts/mudslide/self" - Specified object already exist
s (Registry Edit Kernel)
 (dce / sad)
?(rgy_edit) Unable to add key - Requested key is unavailable (dce / sec)
bye.
        Press <RETURN> to continue, CTRL-C to exit: Setup 1rst: Could not get cu
rrent contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044
Setup 1rst: Could not get current contxt:387064044

[8/25/94 public]

This error appears if a machine principal already exists in the
registry and an attempt to add the same machine principal (w/ a
different uuid) is made. This happens when you attempt
to reconfigure without unconfiguring. I looked at the
registry and there was already a hosts/mudslide/self machine
principal there so I unconfigured and reran the smoketest to
see if dce_config was trying to add the machine principal
twice in 1 config. I successfully passed this "registry
update" portion of the smoketest AND I discovered that
dfs daemons were already running on the machine (more
evidence that a previous attempt at the multi-machine
config was interfering with this run).

NOTE: I DID see 2 consecutive messages:

S:****** Starting sec_client service...
S:****** Starting sec_client service

(yes, one with 3 .'s and one without) - I'll let Rob Baum
decide if this indicates a problem with the recently
updated dce_config ...



CR Number                     : 11898
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : era
Short Description             : better 'not found' message
Reported Date                 : 8/25/94
Found in Baseline             : 1.1b15
Found Date                    : 8/25/94
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/25/94 public]
dcecp> x show /.:/sec/xattrschema/foo
Error: Key not found in database

I guess that this is the error message returned by the API.  dcecp should
trap the error code and produce something like: "Schema object 'foo' not found"

[9/19/94 public]

Schema names other than "/.:/sec/xattrschema" are passed
to dce_attr_sch_bind(). So, this should get fixed with
OT 12156.



CR Number                     : 11892
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : can't change princ quota to unlimited via rgy_edit non-interactive mode
Reported Date                 : 8/25/94
Found in Baseline             : 1.0.3
Found Date                    : 8/25/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancelled - addressed in 1.2.2.

[8/25/94 public]

Customer reported:

"I'm using DCE 103. Sorry for not giving enough information. I'll try to
be more explicit in my bug reporting in the future.

We're using DCE 103, the module I changed to get around the bug is
security/client/admin/rgy_edit/tty_pgo.c. It is RCS version 1.1.6.1.

The section of code I focused on is from the routine tty_do_change_pgo:

        } else if (match_command("-q", c->args[cur_arg], 2)) {
            if (domain == eif_domain_person) {
                if ((cur_arg+1) < c->num_args) {
                    cur_arg++;
>                   if (eku_chk_integer32(c->args[cur_arg],
>                                           strlen(c->args[cur_arg]),
>                                           &quota) == error_status_ok){
>                       quota_str = c->args[cur_arg];
>                       opt_quota = true;
>                   } else {
>                       INVALID_ARG(c->args[cur_arg], &st);
>                   }
                } else {
                    OPT_REQUIRES_ARG(c->args[cur_arg], &st);
                }
            } else {
                INVALID_OPT_DOMAIN(c->args[cur_arg], domain, &st);
            }
        }...

The area highlighted with ">" seems to be the problem. If I pass in the
string "unlimited", it gets verified as a 32 bit integer, failing that
it returns an error.

My modified code looks like this:

        } else if (match_command("-q", c->args[cur_arg], 2)) {
            if (domain == eif_domain_person) {
                if ((cur_arg+1) < c->num_args) {
                    cur_arg++;
                    if (eku_chk_integer32(c->args[cur_arg],
                                            strlen(c->args[cur_arg]),
                                            &quota) == error_status_ok){
                        quota_str = c->args[cur_arg];
                        opt_quota = true;
                    } else {
/* VS0300 */            if (strcmp(c->args[cur_arg], "unlimited")) {
                                INVALID_ARG(c->args[cur_arg], &st);
/* VS0300 */            } else {
/* VS0300 */                    quota_str = eif_get_default(eif_def_pgo_quota);
/* VS0300 */                    opt_quota = true;
/* VS0300 */            }
                    }
                } else {
                    OPT_REQUIRES_ARG(c->args[cur_arg], &st);
                }
        }...

The way I found this bug was to take an existing principal (say cell_admin)
and change the quota to 0. I then tried to change it back and get the error.
The transcript of my rgy_edit session follows:

# rgy_edit
...
rgy_edit=> do p
Domain changed to: principal
rgy_edit=> v cell_admin -f
cell_admin                                   100
  Full name:  cell administrator
  Uuid:       00000064-e049-2e58-b100-0000c080f55a
  Primary:  pr   Reserved:   --
  Quota: unlimited
rgy_edit=> c cell_admin -q 0
rgy_edit=> v cell_admin -f
cell_admin                                   100
  Full name:  cell administrator
  Uuid:       00000064-e049-2e58-b100-0000c080f55a
  Primary:  pr   Reserved:   --
  Quota: 0
rgy_edit=> c cell_admin -q unlimited
?(rgy_edit) "unlimited" - Unknown or redundant keyword (Registry Editor/TTY Inte
rface) (dce / sad)
rgy_edit=>
"

Doing it interactively worked fine. But it does not work with th e"-q".

[8/29/94 public]
Downgraded to E4 as all rgy_edit CRs are because dcecp is replacing rgy_edit
so we're not fixing minor problems with it.  Since this works ok in
interactive mode, it's very minor and won't be allowed into DCE1.1.  Given
that means that it can never be fixed, we may decide to cancel this CR.



CR Number                     : 11858
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : rpc_string_binding_parse core dumps
Reported Date                 : 8/24/94
Found in Baseline             : 1.1
Found Date                    : 8/24/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/24/94 public]

Starting today I am periodicly getting a core dump from 
rpc_string_binding_parse. I am on a 486 running last nights build.
I am calling this with a pathname not a string binding. In this
particular instance I am passing in the fullpath to the security 
registry site. (/.../mpt/subsys/dce/sec/master)

Here is the gdb backtrace. 
#0  0xa40037c8 in malloc (1)
#1  0xa417ea94 in cma_lib_malloc (1)
#2  0xa41cca29 in rpc__mem_alloc (1, 52, 0)
#3  0xa41d3356 in rpc_string_binding_parse
    (5289540, -1073757944, -1073757948, -1073757952, -1073757956, -1073757960, -1073757912)
#4  0x493a09 in dcp_binding_string_to_tcl (
    str=0x50b644 "/.../mpt/subsys/dce/sec/master", rpc_status=0xbfffc128)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/util_binding.c:67
#5  0x422c7c in open_rgy_site (interp=0x57e0b0, name=0x432b54 "/.:", 
    access=site_update)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c:706
#6  0x43309b in dcp_rgy_sa_connect (clientData=0x0, interp=0x57e0b0, argc=2, 
    argv=0x57df28)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_sa_tclif.c:384
#7  0x4030d5 in dcp_registry (clientData=0x0, interp=0x57e0b0, argc=16, 
    argv=0x57df28)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:1397
#8  0x4b264d in Tcl_Eval (5759152, -1073743584)
#9  0x4c4c2f in Tcl_RecordAndEval (5759152, -1073743584, 0)
#10 0x40079f in main (argc=1, argv=0xbffffa1c)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:421

[8/24/94 public]

This has actually started to move around. Something somewhere else
is apparently stompping on memory...



CR Number                     : 11850
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp is not a complete replacement for cdscp
Reported Date                 : 8/24/94
Found in Baseline             : 1.1b16
Found Date                    : 8/24/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/24/94 public]

Dcecp is not a complete replacement for cdscp.
In particular, according to the specification,
there are no dcecp equivalents for eight cdscp
commands:

   set directory to new epoch
   disable clerk
   disable server
   show cell
   show clerk
   show server
   set cdscp confidence
   show cdscp confidence

If dcecp commands for this functionality are not
added, vendors may have to ship both dcecp and
cdscp, even though cdscp is no longer fully supported
with respect to new functionality and bug fixes.
Or, if vendors choose to independently implement
this functionality, dcecp will have incompatible
syntax and semantics among vendors for these commands.
This problem apparently also applies to the other
component control programs, several of which have
a few commands with no dcecp equivalents.

Failing an osf implementation of this functionality
in the short time remaining for dce1.1, these commands
should at least be syntactically and semantically
specified in the dcecp rfc so that independent
implementations by vendor have a chance of being
compatible.

[8/24/94 public]
Sorry you mentioned a sore point.  
What follows is admittedly a rant:

Please see RFC 30.0 January 1993 goals (c) and (e):

                     DCE 1.1 ADMINISTRATIVE IMPROVEMENTS:
                          REQUIREMENTS FOR DCE SHELL

      The following are goals and guidelines for the DCE shell.

        (c) Emphasis in scheduling development resources must be placed on
            common everyday administrative duties rather than more esoteric
            configuration management.  Administrators will get more use
            from a simpler way to add a new user or to modify a CDS entry
            and its ACL, rather than a new way to create a registry or to
            initialize a new CDS namespace.

        (e) The DCE shell will augment use of existing control programs, it
            will not replace them.  Existing control programs will continue
            to be installed with DCE, and their use will probably remain
            required for some administrative operations.

Due to resource constraints that were anticipated at the start of the
project, it has never been the goal of dcecp to completely replace any of
the control programs.  As it turns out dcecp functionality more than met
it's goals.  It does completely replace: rpccp, dtscp, acl_edit, and now
sec_admin.  It also handles ALL the admin requirements for all new
components: auditing, serviceability, and dced.  I'll note also that it
managed to incorporate many of the late breaking new functionality in 1.1
such as password generation and ERA, do mostly to the hard work from folks
at HP.

As a note: the latest version of dcecp does implement two of the commands
you mentioned:

   set cdscp confidence
   show cdscp confidence

And RFC 42.3 when published (as well as the DCE 1.1 documentation) will
described them.

I'm particularly proud of all the work that everyone involved on dcecp has
done so far as most of the providers had little or no interest in dcecp
until about 6 months ago.

The fact that dcecp far exceeded its design goals is hardly a defect.  It
should be an enhancement since it is asking for more functionality than the
specifications call for.  I'm cancelling this as opposed to deferring it to
1.2 since I know that the PSC is already considering completing dcecp and
deprecating the other control programs, so this issue will be tracked in
another venue.



CR Number                     : 11849
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : xt_test
Short Description             : xt_test core dump after 12 hours
Reported Date                 : 8/24/94
Found in Baseline             : 1.1b16
Found Date                    : 8/24/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/24/94 public]

xt_test core dump after running gds_xds_str_001 tests for about 12 hours.

trace:

 0 cma_fgetc@libdce + 0x00000174 (0, 0xff, 0x400d8804, 0x400d8858)
 1 xt_read_string + 0x00000128 (0x400d88f0, 0x400d882c, 0x400d88f0, 0x400d8894)
 2 xt_read_object + 0x00000028 (0, 0x400d8888, 0x400d8820, 0x400d883c)
 3 xt_ds_read + 0x000000d8 (0x40019fe0, 0x40019ef0, 0, 0x2)
 4 xt_run + 0x00000124 (0x40029540, 0, 0, 0)
 5 xt_thread_function + 0x00000248 (0x4002908a, 0x7af53230, 0x400b8f28, 0x5)
 6 cma__thread_base@libdce + 0x0000021c (0x400b8f28, 0, 0, 0)
 7 cma__thread_start1@libdce + 0x0000004c (0x400b8f28, 0, 0, 0)
 8 cma__thread_start0@libdce + 0x00000008 (0x400b8f28, 0, 0, 0)
 9 cma_fgetc@libdce + 0x00000174 (0, 0, 0, 0)
10 end + 0x0008f8b4 (Address not found (UE302)

>lr $a
$arg0     = 0x400297c0
$arg1     = 0x400d8a28
$arg2     = 0
$arg3     = 0x400d883c

>lr $r
$r0       = 0
$r1       = 0x24b5
$r2       = 0x81c2f9e3
$r3       = 0x5
$r4       = 0
$r5       = 0
$r6       = 0
$r7       = 0
$r8       = 0
$r9       = 0
$r10      = 0
$r11      = 0
$r12      = 0
$r13      = 0
$r14      = 0
$r15      = 0
$r16      = 0
$r17      = 0
$r18      = 0
$r19      = 0x7af3425c
$r20      = 0x400b8f28
$r21      = 0x177dc000
$r22      = 0x177db009
$r23      = 0x400d883c
$r24      = 0
$r25      = 0x400d8a28
$r26      = 0x400297c0
$r27      = 0x400290b8
$r28      = 0x177db009
$r29      = 0x50004
$r30      = 0x400d8a20
$r31      = 0
$ret0     = 0x177db009
$ret1     = 0x50004

>p *($pc - 16)\20i
0x81c2f9d0  LDSID       (0,1),31
0x81c2f9d4  MTSP        31,0
0x81c2f9d8  BLE 0(0,1)
0x81c2f9dc  OR  31,0,2
0x81c2f9e0  LDW -32(0,30),19
0x81c2f9e4  LDW -100(0,30),31
0x81c2f9e8  LDW 0(0,31),20
0x81c2f9ec  LDO -1(20),21
0x81c2f9f0  STWS        21,0(0,31)
0x81c2f9f4  COMICLR,<=  0,21,22
0x81c2f9f8  LDO 1(0),22
0x81c2f9fc  ZDEP        22,31,1,1
0x81c2fa00  COMIBT,=,N  0,1,_fp_status+0030
0x81c2fa04  LDW -100(0,30),26
0x81c2fa08  BL  _fp_status+0008,2
0x81c2fa0c  ADDIL       0xfffe5800,2
0x81c2fa10  LDO 72(1),1
0x81c2fa14  LDSID       (0,1),31
0x81c2fa18  MTSP        31,0
0x81c2fa1c  BLE 0(0,1)

[08/26/94 public]
I wonder how the gds_xds_str_001 tests can run more than 12 hours when
(see OT 11847) already the setup doesn't work correctly.
And: I don't see any chance for me to fix a core dump
in fgetc if I don't get more information.

[public]

The tests were set to run for 15 hours in the gds_xds_str_001.data file.  
As described in OT 11847, they began failing after an hour, but were still 
being run overnight.  After 12 hours, xt_test core dumped.  

The tests were being run from an HP with an OSF1 shadow.  

I'll run the tests again this weekend against BL-16.

[08/29/94 public]

I didn't see the core dump this weekend, running against BL-16.2/lgb.
So, I'll cancel this one.

The tests are still failing after a few iterations, however (CR 11847).



CR Number                     : 11821
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : SVC
Short Description             : cds should provide a new function initializing SVC
Reported Date                 : 8/23/94
Found in Baseline             : 1.1
Found Date                    : 8/23/94
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/23/94 public]

A XDS application using CDS dumps core if CDS calls the first time
a SVC function. To reproduce:
Run an arbitrary invalid gds_switch testcase.

The reason is that XDS calls cds functions (i.e.
cdsGetHandle, cdsEnumAttr, cdsFreeHandle) which do SVC calls.
But SVC isn't initialized - means dce_svc_register isn't called.
So cds__svc_handle isn't initialized.

[08/23/94 public]
I'm confused.  Since cds/library/library_svc.c uses DCE_SVC_DEFINE_HANDLE
then the handle should exist and be non-NULL.  If there is code
that explicitly calls dce_svc_register() with cds__svc_handle, then *that*
is the bug and the dce_svc_register calls should be removed.

[08/23/94 public]
OK - cds/library/library_svc.c is in libdce and sets cds__svc_handle.
You (Rich Salz?) can cancel this OT - I'll check why my
XDS application is dumping core in CDS and will open a new OT for that.



CR Number                     : 11819
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : attr
Short Description             : A xattrschema rpc_if_handle should be used to import a binding
Reported Date                 : 8/22/94
Found in Baseline             : 1.1
Found Date                    : 8/22/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/22/94 public]
Nav at Hp caught the problem when a wrong name was supplied to
dce_attr_sch_bind(). The dce_attr_sch_bind() should have retruned a
error in that case, but it returned ok instead, so of course the following
rpc call was rejected by "unknown interface". The reason is that a NULL
rpc_if_handle is used while importing a binding and the wrong name can
be partial resolved and there also happens to be a bining exported to the 
resolved name (entry). The dced binding code has the same problem and need 
be fixed too.

[08/23/94 public]
Not so fast.  I assume you're importing with a NULL if_handle right now.
That is really the right thing to do for "generic" interfaces like
rdacl, svc, and xattr.  Putting the if_handle there requires everyone to
export the interface into the namespace which should not be necessary.
(Try acl_edit /.:/hosts/HOSTNAME/self)

[08/23/94 public]
But what if it binds to a "wrong" server which doesn't provide the i/f
at all? Is that a reasonable scenario?

[08/23/94 public]
Yes, it's a trade-off.  Try my acl_edit experiment.

[08/23/94 public]
Cancelled by the reason Rich gives.



CR Number                     : 11807
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : 
Short Description             : dced crashes on srvconf create command
Reported Date                 : 8/22/94
Found in Baseline             : 1.1b15
Found Date                    : 8/22/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/22/94 public]

DCDREL002 fails in a single pass on the at486 nodes. The following
dcecp command is executed:

server create /.:/hosts/maui/config/srvrconf/dcdrel002_server.1063-req 
	-attribute { 
	{program /u1/opt/dcetest/test/tet/system/dced/ts/rel/dcdrel002_server}
	{arguments /.:/hosts/maui/systest/dcdrel002_server.1063-req}
	{starton request } 
	{ services 
	  { {entryname /.:/hosts/maui/systest/dcdrel002_server.1063-req} 
	    {interface 00032b04-f3f0-1e0e-9ea7-0000c0dc0d4b,1.0} } } }

On maui this returns "connection closed", and the equivalent command
on node jamaica returns "communications failure". On both systems
dced has crashed, and the stack trace for the two is the same:

Core was generated by `dced'.
Program terminated with signal 11, Segmentation fault.
#0  0x40676b in srvr_hash_table_add (ht=0x432668, up=0x67a2 58, value=0x5de7dc,
                                     st=0x5deaf4)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/misc.c:533

(gdb) bt
#0  0x40676b in srvr_hash_table_add (ht=0x432668, up=0x67a258, value=0x5de7dc, 
    st=0x5deaf4)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/misc.c:533
#1  0x4068cf in srvr_hash_build (t=0x432cc0, ht=0x432668, st=0x5deaf4)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/misc.c:579
#2  0x405fae in srvr_add_to_table (t=0x432cc0, new=0x5de858, st=0x5deaf4)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/misc.c:313
#3  0x40b5cb in srvrconf_create (h=0x671038, server=0x5deaf8, st=0x5deaf4)
    at /project/dce/build/dce1.1-snap/src/admin/dced/server/scops.c:151
#4  0x4229d2 in op2_ssr (h=0x671038, IDL_call_h=0x4d3ae0, IDL_elt_p=0x5dee4c, 
    IDL_drep_p=0x4fe7c8, IDL_transfer_syntax_p=0x4d3cdc, IDL_mgr_epv=0x430990, 
    IDL_status_p=0x5dee28) at srvrconf_sstub.c:1980
#5  0xa41fdd64 in acl_db ()
#6  0xa41d476c in acl_db ()
#7  0xa41ac3db in acl_db ()
#8  0xa41b17cd in acl_db ()
#9  0xa41d45bc in acl_db ()
#10 0x5ebc48 in acl_db ()
Cannot access memory at address 0x2.

(Note that core was generated from BL15 while the source is pointing to 
the nightly build. I'll rerun to verify that the stack trace as printed
here is meaningful, or to correct it.)

[08/26/94 public]
I believe this is essentially a dup of 11809 (same bug) which was fixed
under yet a third OT#.  Cancel this?

[9/1/94 public]
Just checking...  This worked for me (essentially the same as what rick
did above):

    server create test2 \
	-attribute { \
	{program /tmp/test1}\
	{arguments /.:/hosts/acme/systest/dcdrel002_server.1063-req}\
	{starton request } \
	{ services \
	{ {entryname /.:/hosts/acme/systest/dcdrel002_server.1063-req} \
	    {interface 00032b04-f3f0-1e0e-9ea7-0000c0dc0d4b,1.0} } } }

[9/8/94 public]
Reran the tests against BL16.3 and this problem has been fixed as
Rich stated above.



CR Number                     : 11800
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : "find" error message in dce_shutdown and rc.dce
Reported Date                 : 8/22/94
Found in Baseline             : 1.1b14
Found Date                    : 8/22/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/22/94 public]
I get this message at the end of /etc/dce_shutdown and the beginning
of /etc/rc.dce:
    find: Cannot get the name of the current directory.
Doesn't hurt anything, tho it is disturbing.

The code is something like this:
    find $DCELOCAL/var/security/creds -type f -print | xargs rm -f
It should be surrounded by an "if [ -d ... ]".

[8/22/94 public]
I goofed.  I did this:
	cd /opt/dcelocal
	/etc/dce_config    - re-installed dce
	/etc/rc.dce

Re-installing blew away /opt/dcelocal/, which caused "find" to
give that message.  (osf1's find must be brain-damaged...)



CR Number                     : 11798
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11805
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : libdce
Short Description             : sec_priv_get_eptgt() core dump after 36 hours
Reported Date                 : 8/22/94
Found in Baseline             : 1.1b15
Found Date                    : 8/22/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/22/94 public]

sec_clientd core dumped over the weekend.  The cell had been active for
about 36 hours.  There were a number of system tests running over the weekend, 
but none were active at the time of the core.

Build: 1.1b15 (NB0818)

Cell:
HPUX: cdsd, secd, dtsd
OSF1: client, dtsd
OSF1: client, dtsd, ntp provider

>t
 0 priv_krb_util_gen_v1_1_ccache_ + 0x00000144 (0x7af3dc2a, 0x7af37ba2, 0x402628
9c, 0x1)
 1 sec_priv_get_eptgt_internal@li + 0x000028a8 (0x403b1d68, 0x403b1d68, 0x1, 0x2
)
 2 sec_priv_get_eptgt@libdce + 0x00000060 (0x403b1d68, 0x403b1d68, 0x1, 0x2)
 3 sec_login_util_get_krb_ptgt@li + 0x000000c0 (0x403b1d68, 0x403b1d68, 0x1, 0x2
)
 4 sec_login_pvt_inq_pac@libdce + 0x000000a4 (0x403b1d68, 0x402624d4, 0x40262460
, 0)
 5 sec_login_inquire_net_info@lib + 0x00000110 (0x403b1d68, 0x402624d4, 0x402624
60, 0x402624c4)
 6 sec_key_mgmt_manage_key@libdce + 0x00000104 (0x1, 0, 0x4009dfb8, 0x40262460)
 7 keymgmt + 0x00000040 (0, 0x7af551c0, 0x4001a160, 0x12)
 8 cma__thread_base@libdce + 0x0000021c (0x4001a160, 0, 0, 0)
 9 cma__thread_start1@libdce + 0x0000004c (0x4001a160, 0, 0, 0)
10 cma__thread_start0@libdce + 0x00000008 (0x4001a160, 0, 0, 0)
11 priv_krb_util_gen_v1_1_ccache_ + 0x00000144 (0, 0, 0, 0)

>lr $r
$r0       = 0
$r1       = 0
$r2       = 0x81514c57
$r3       = 0
$r4       = 0
$r5       = 0
$r6       = 0
$r7       = 0
$r8       = 0
$r9       = 0
$r10      = 0
$r11      = 0
$r12      = 0
$r13      = 0
$r14      = 0
$r15      = 0
$r16      = 0
$r17      = 0
$r18      = 0
$r19      = 0x7af36248
$r20      = 0xfffffff4
$r21      = 0
$r22      = 0xffffffff
$r23      = 0
$r24      = 0x403ba795
$r25      = 0x7af37ba2
$r26      = 0x7af3dc2a
$r27      = 0x40002fe0
$r28      = 0x177db009
$r29      = 0x403ba795
$r30      = 0x40262d20
$r31      = 0xfffffffd
$ret0     = 0x177db009
$ret1     = 0x403ba795

>lr $a
$arg0     = 0x7af3dc2a
$arg1     = 0x7af37ba2
$arg2     = 0x403ba795
$arg3     = 0

>p *($pc - 16)\20i
0x81514c44  LDSID       (0,1),31
0x81514c48  MTSP        31,0
0x81514c4c  BLE 0(0,1)
0x81514c50  OR  31,0,2
0x81514c54  LDW -32(0,30),19
0x81514c58  LDW -636(0,30),1
0x81514c5c  COMBT,=,N   1,0,_fp_status+0010
0x81514c60  LDW -636(0,30),31
0x81514c64  LDW 0(0,31),20
0x81514c68  COMIBF,=,N  0,20,_fp_status+0070
0x81514c6c  LDW -612(0,30),26
0x81514c70  LDW -616(0,30),25
0x81514c74  LDW -544(0,30),21
0x81514c78  LDO -1(21),22
0x81514c7c  LDW -540(0,30),1
0x81514c80  SH1ADD      22,22,31
0x81514c84  SH2ADD      31,0,20
0x81514c88  LDWX        20(0,1),24
0x81514c8c  LDW -544(0,30),21
0x81514c90  LDO -1(21),22

[8/22/94 public]

Please turn on sec_val and see if the problem still exists. Note,
we no longer fix bugs in sec_clientd.

[8/22/94 public]
This is not a bug in sec_clientd.  sec_clientd calls sec_key_mgmt_manage_key()
once and that call loops internally forever managing the host's key.  secval
must call this same routine with the exact same parameters, thus the problem
can't be any better in secval.  I've bumped this back up to p1 because if you
can't manage the host's key for more than 36hrs, you won't be able to get to
a reasonable CHO number at all...

Peter, was this using Friday's rebuild of Thursday night's build (after Greg
submitted the fix that broke Thurs night's build?)?

[8/22/94 public]

Yes, it was using Friday afternoon's re-build with Greg's fix.

[8/29/94 public]
Note: There's more info on an almost identical core dump (but in dtsd) in
CR11805, which is now a dup of this one.  This is not a sec_clientd problem,
but shows up in libdce in multiple servers, so I've taken sec_clientd out
of the description above to make sure the issue doesn't get dropped because
of sec_clientd becoming obsolete...

[9/6/94 public]
I know it was a while ago, but do you remember if secd was still up and
running after sec_clientd (and dtsd from CR11805) died?  This info would
help us track down the problem a lot easier...

[9/6/94 public]

Mike, secd was up and running after sec_clientd died.  I remember that
sec_clientd was the only core dump.  Just don't ask me what day it is..

[9/6/94 public]
Although this is different from the defect that Greg just fixed (11925), it
is in code called from priv/auth code that he had changed recently and there's
a *slight* chance that the fix he made today might also fix this problem.
While there's no guarantees at this time that it's fixed, it would be very
helpful if you could run this test tomorrow or some time soon after that with
a build that has the fix that was just submitted for 11925.  Also, the rtns
that it was in before and during when it died mostly do lots of allocs and
memcpy()'s, so it would help to check the resource usage when it died (free
swap space, core file size, size of secd in case it's using up all the swap
space...).  Also, the next time this happens, could you see if anything
(eg: rgy_edit or dcecp) can talk to secd?  It's mysterious that both dtsd
(CR11805) and sec_clientd both died at about 36hrs with the same traceback,
and the only thing we could think of that would cause this is if secd was
unavailable but the client side libdce security code in these two cases
thought they had received authdata from secd but didn't...

[9/23/94 public]
We've fixed lots of memory leak and corruption problems in the last couple
of weeks, but we don't know if we've fixed this specific problem.  We need
you to try and reproduce this, so we'll know if it is indeed fixed...

[9/27/94 public]
Ditto (the above comment).

[9/27/94 public]

Sorry for the delay in cancelling this one.  We haven't seen it for a while
now, and we've been running tests over 36 hours.



CR Number                     : 11785
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : clearinghouse verify cores cdsd
Reported Date                 : 8/19/94
Found in Baseline             : 1.1b14
Found Date                    : 8/19/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/94 public]
Running DCE Nightly Build started 8/11/94 on an HP

I was trying to test cdsalias create.  I had to upgrade the directory to
3.1.  So I:

 dcecp> cdscp set directory /.: CDS_UpgradeTo = 3.1
 dcecp> directory synch /.:
 dcecp> clearinghouse verify /.:/absolut_ch

It ran for a short while and then cdsd core dumped.
Here's the traceback:

 0 db_checkpoint + 0x000005f0 (0x4013f2a0, 0x7, 0x2, 0x40009354)
 1 db_checkpoint_memory + 0x00000068 (0x4013f2a0, 0x400d57d8, 0x9, 0x40027da8)
 2 th_start + 0x000000cc (0x400d57d8, 0x7af53108, 0x403eb708, 0xae)
 3 TMEM@libdce + 0x000d28cc (0x403eb708, 0, 0, 0)
 4 TMEM@libdce + 0x000dbc54 (0x403eb708, 0, 0, 0)
 5 TMEM@libdce + 0x000db894 (0x403eb708, 0, 0, 0)
 6 db_checkpoint + 0x000005f0 (0, 0, 0, 0)

I have the core file around if anyone wants it.

[8/19/94 public]
I restarted cdsd but it doesn't seem to be happy:

  dcecp> dir show /.:
  Error: Implementation specific error
  dcecp> dir show /.:/hosts
  Error: Implementation specific error
  dcecp> dir li /.:/hosts  
  Error: Implementation specific error
  
  root@absolut cds/server$ cdsd_diag
  CDS Server Diagnostics - Version V2.019   (Aug 18 1994)
  
  diag> ex fib
  ___ File Info Block: 0x0 __________________________________
  ** Invalid file information block referenced
  diag>  

I'll be reinstalling in a minute...

[9/1/94]
I tried to recreate the problem on the hp with 1.1bl16 to no avail.
The dcecp clearinghouse verify command just sets off the background thread
of cdsd to run.  This is unrelated to checkpointing the clearinghouse to
disk.  My hypothesis is the clearinghouse got corrupted somehow in memory
or on disk (and then read in), and the verify command happened to be
running at the same time the clearinghouse was checkpointing.  I haven't
been able to get a good dce1.1 build, so I'll refrain from marking this
"fixed" until I (or someone) can verify this with a more recent baselevel.

--Roger

[9/1/94 public]
Well I just tried it with the nightly started evening of 8/31/94.

dcecp> dir mod /.: -ch {CDS_UpgradeTo 3.1}
dcecp> dir show /.:
{RPC_ClassVersion {01 00}}
{CDS_CTS 23831-02-28-15:27:09.175-05:00I0.000/08-00-09-25-13-52}
{CDS_UTS -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_ObjectUUID 616f6834-c58f-11cd-98f3-080009251352}
{CDS_Replicas
 {{CH_UUID 60458db2-c58f-11cd-98f3-080009251352}
  {CH_Name /.../absolut_cell/absolut_ch}
  {Replica_Type Master}  
  {Tower {ncacn_ip_tcp 130.105.5.93}}
  {Tower {ncadg_ip_udp 130.105.5.93}}}}
{CDS_AllUpTo 0}
{CDS_Convergence medium}
{CDS_InCHName new_dir}
{CDS_DirectoryVersion 4.0}
{CDS_UpgradeTo 3.1}
{CDS_ReplicaState on}
{CDS_ReplicaType Master}
{CDS_LastSkulk 23831-02-28-15:27:09.175-05:00I0.000/08-00-09-25-13-52}
{CDS_LastUpdate -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_Epoch 616f5ad8-c58f-11cd-98f3-080009251352}
{CDS_ReplicaVersion 4.0}
dcecp> dir synch /.:
dcecp> clearinghouse verify /.:/absolut_ch
dcecp> dir show /.:
{RPC_ClassVersion {01 00}}
{CDS_CTS 23831-02-28-15:27:09.175-05:00I0.000/08-00-09-25-13-52}
{CDS_UTS -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_ObjectUUID 616f6834-c58f-11cd-98f3-080009251352}
{CDS_Replicas
 {{CH_UUID 60458db2-c58f-11cd-98f3-080009251352}
  {CH_Name /.../absolut_cell/absolut_ch}
  {Replica_Type Master}  
  {Tower {ncacn_ip_tcp 130.105.5.93}}
  {Tower {ncadg_ip_udp 130.105.5.93}}}}
{CDS_AllUpTo -19299-10-11-07:46:54.798-05:00I0.000/08-00-09-25-13-52}
{CDS_Convergence medium}
{CDS_InCHName new_dir}
{CDS_DirectoryVersion 4.0}
{CDS_UpgradeTo 3.1}
{CDS_ReplicaState on}
{CDS_ReplicaType Master}
{CDS_LastSkulk -19299-10-11-07:46:54.798-05:00I0.000/08-00-09-25-13-52}
{CDS_LastUpdate -21016-09-26-02:07:41.406-05:00I0.000/08-00-09-25-13-52}
{CDS_Epoch 616f5ad8-c58f-11cd-98f3-080009251352}
{CDS_ReplicaVersion 4.0}

The clearinghouse verify command returned basically immediately.  The cdsd
is still running.  BUT I noticed that the directory level was 4.0 and I set
UpgradeTo to 3.1.  All I had done was configure this cell and stop and
restart it once.  Is the default now version 4.0 directories?  Is version
4.0 indeed the new name for version 3.1?

[9/2/94]
Yes, starting with the code I checked in on 8/26, A DirectoryVersion of
3.1 ceases to have real meaning.  The default
DirectoryVersion is 4.0.  This is also the version that is minimally
needed for Hcells and cell aliasing.  So, if you create a new cell with
V1.1, you no longer need to update the directory version.  However, if
you install a V1.1 server in a pre-V1.1 cell and replicate an old
directory (CDS_DirectoryVersion = 3.0), once you replace all of the
pre-V1.1 servers with V1.1 servers and you wish to use Hcells, then
you would want to set CDS_UpgradeTo = 4.0.

The only normal time you will use "clearinghouse verify" is for upgrading
directories.  Its other uses would be for troubleshooting and doing
certain cleanup-type operations on the clearinghouse.

The command may indeed return rather quickly for a small clearinghouse
at an unloaded server.

--Roger

[9/7/94  public]
Howard says its a cancel.



CR Number                     : 11779
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : /file/ftutil
Short Description             : don't know how to make ftu_errs.ms
Reported Date                 : 8/19/94
Found in Baseline             : 1.1
Found Date                    : 8/19/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/94 public]

[ /file/ftutil at 12:24 (PM) Friday ]
makepath ftutil/. && cd ftutil &&  exec make MAKEFILE_PASS=AUTOGEN     build_all
make: don't know how to make ftu_errs.msf (continuing)
[ /file/ncscompat at 12:24 (PM) Friday ]

[8/19/94 public]
DFS is not supported on the OSF/1 platform.  Cancel.



CR Number                     : 11777
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : era
Short Description             : core dump during gds_sec fvt
Reported Date                 : 8/19/94
Found in Baseline             : 1.1
Found Date                    : 8/19/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/94 public]
dcecp dumped core during the gds_sec functional test.  Here's the stack:

#0  0xa43419d2 in dcp_svc_handle ()
#1  0x4250cb in check_era_info (attr_info=0x410690, domain=-1073753332, in_attrs=0x424dfc, 
    interp=0xbfffd5dc, name=0xbfffc9e4 "\225L", out_attrs=0x0)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c:2887
#2  0x4250cb in check_era_info (attr_info=0xbfffd8b8, domain=0, in_attrs=0xbfffd5dc, interp=0x5670b0, 
    name=0xbfffdb4c "gds_invalid", out_attrs=0xbfffd30c)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c:2887
#3  0x410fe7 in principal_modify (clientData=0x0, interp=0x5670b0, argc=2, argv=0xbfffe950)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/rgy.c:931
#4  0x402665 in dcp_principal (clientData=0x0, interp=0x5670b0, argc=4, argv=0xbfffe950)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:1065
#5  0x4a5ded in Tcl_Eval (5664944, 6031160)
#6  0x4c4375 in Tcl_EvalFile (5664944, -1073744858)
#7  0x4003d8 in main (argc=1, argv=0xbffff2ec) at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:314

dcecp was processing the file

	src/test/functional/directory/gds/ts/config/dcecp_add.tcl

binaries are from nightly build of 8/16.

[8/19/94 public]
ERA code is you Jim.  Ping I know that you are looking at this routine,
feel free to jump in.  :-)

[8/19/94 public]
I fixed some problems, so I hope it can be tested against the new code
see if the problem is still there. My changes are in 
snoopy:/u3/users/notuser/pwang/dcecp/{rgy.h, rgy_utils.c}

[8/19/94 public]
Just reproduced the problem by hand.  The command was:

principal modify gds_invalid -add {X500_DN {/C=re/O=sni/CN=invalid}}

[8/19/94 public]
The dce installed on my machine is called bl-14.3, and the binaries
and libraries are dated 8/15, around 22:00, so they were built and
put into the install tree last monday night.  I think this is the
version that does not have the bug fix for the sec_attr_util_alloc_copy()
function.  Therefore, if I do

   principal modify gds_invalid -add {X500_DN {/C=re/O=sni/CN=invalid}}

I get a core dump (seg violation in sec_attr_util_alloc_copy)
Even if I do this

   principal modify foo -add {test_integer 101}

I get the same core dump.  With the version of secd/libdce.sl I have
installed, any time I touch sec_attr_util_alloc_copy(), dcecp dumps core.

This bug is reported on the nightly build of 8/16.  I don't know what's in
that build.  Can somebody verify that the needed bug fix is there?

[8/22/94 public]
Rich Z was using a build from 8/16.  We believed this was fixed in the secd
from 8/18's nightly build.  Rich will retry tomorrow.

[8/24/94 public]
Using an install of bl16, I cannot reproduce the problem.  All
pgo modify commands seem to work as expected.  When someone else
can verify the tests work at OSF, we can mark the bug accordingly.

[8/26/94 public]
Spoke with Rich, he can't reproduce either.  Cancelled, probably fixed via
one of the sec fixes.



CR Number                     : 11768
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : _h not read-only
Reported Date                 : 8/18/94
Found in Baseline             : 1.1b14
Found Date                    : 8/18/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/18/94 public]
The _h convenience variable should be read-only as the others are:

  dcecp> echo $_h
  hosts/absolut
  dcecp> set $_h foo
  foo
  dcecp> set _u foo
  Error: can't set "_u": dcecp convenience variable is read-only
  dcecp>

[8/19/94 public]
Not to beat you into a pulp, but you have it coming :-)

dcecp> set _h
hosts/frick
dcecp> set _h foo
Error: can't set "_h": dcecp convenience variable is read-only

You created your own nifty variable $_h. 

dcecp> set $_h foo
foo
dcecp> set $_h
foo
dcecp> set _h
hosts/frick

Cancelled.



CR Number                     : 11737
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdsclerk
Short Description             : cdsclerk spins and hangs while
running the sanity tests
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b14
Found Date                    : 8/17/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/17/94 public]

A 4 machine cell, where the sanity tests were running, hung.
cdscp or rgy_edit could not get any response, on any of the
machines. The only unsual thing was that the cdsclerk process
was spinning, on 3 of the 4 machines (all OSF1).

John Dugas took a SVC log, from one of the machines, and will 
try to find more information. 

The machine, where cdsd was running, was returned to a workable
state after having killed the clerk and the advertiser and 
re-started the advertiser again. The CDS clients machines had not 
remedy.

[08/17/94 public]

Whatever happened in the cell that left the cdsclerk spinning 
and/or hung, left the cell also in a state that cannot be 
restarted. So, the only solution, at this point, is to 
re-configured or a super-duper-clever-dce-guru to unhang it.
Guess which one I did?

[08/17/94 public]

I'm running the NB from Sunday, (08/14), in a cell where there is no
current test activity, and I have a spinning cdsd on my HP server after
re-starting the cell this afternoon.  

John D. believes this is a related problem.  I'll let it go overnight and see 
what happens.

[07/09/96 public]

Since:

1. There is no update as to what occurred next.
2. We don't have that many reference platform machines to even begin
   to try and reproduce this problem (and don't know the cell
   configuration).
3. No evidence as to where the cdsclerk process may be spinning.

I am canceling this OT.  Feel free to re-open it if there is further
evidence to help debug the situation.

--Roger



CR Number                     : 11736
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : utils
Subcomponent Name             : svc
Short Description             : Serviceability debug
routine corrupts global memory
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b14
Found Date                    : 8/17/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/17/94 public]

In dtsd, a call to the DCE_SVC_DEBUG() macro (dce_svc__debug) function
corrupts global memory. A (file static) global pointer is overwritten
such that uninitialized data is used in utc_adjtime(), which results
in a floating-point violation and a core dump.

The call is at line 838 in time/service/dtss_service_main.c If this
call is removed, subsequent calls to the serviceability debug code
don't seem to manifest this problem. 

Further info: doesn't seem to be happening on the AT386.

[8/18/94 public]
Not this time. Cancelled. This looks to be an initialization shoot-out
between two DTS functions.



CR Number                     : 11734
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : cdsd core dump while processing
a BIND packet
Reported Date                 : 8/17/94
Found in Baseline             : 1.1b14
Found Date                    : 8/17/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/17/94 public]

cdsd core dumped while running system tests (dcecdsacl6, dcerpbnk_auth, 
dcethrpc_auth) after 12-13 hours.  The server appears to be processing a
BIND packet.

Build: NB0814

Cell:
HPUX: cdsd,secd,dtsd
OSF1: client,secd (replica),dtsd
OSF1: client,dtsd

>t

 0 MD5Update@libdce + 0x000001c8 (0x40087540, 0x40a20001, 0xfff89117, 0)
 1 sec_md_update@libdce + 0x00000040 (0x40087540, 0x409a95e0, 0xfffffb38, 0)
 2 rpc__krb_cn_compute_md5_cksm@l + 0x00000068 (0x409a95e0, 0xfffffb38, 0x4019f8
f0, 0x400d0ca0)
 3 rpc__krb_cn_recv_check@libdce + 0x00000dbc (0x400d0ca0, 0x409a3448, 0x409a95e
0, 0x70)
 4 rpc__cn_assoc_process_auth_tlr + 0x00000684 (0x400d0bc0, 0x40886e60, 0x590, 0
x40916f70)
 5 do_assoc_req_action_rtn@libdce + 0x00000684 (0x400d0bc0, 0x40886e40, 0x400d0b
c8, 0)
 6 do_assoc_action_rtn@libdce + 0x000001a0 (0x400d0bc0, 0x40886e40, 0x400d0bc8,
0x40934930)
 7 rpc__cn_sm_eval_event@libdce + 0x000000e4 (0x64, 0x40886e40, 0x400d0bc0, 0x40
0d0bc8)
 8 receive_dispatch@libdce + 0x000025b8 (0x400d0bc0, 0x7aff8b78, 0, 0)
 9 rpc__cn_network_receiver@libdc + 0x00000a98 (0x400d0bc0, 0x7af52118, 0x400400
78, 0x4)
10 cma__thread_base@libdce + 0x0000021c (0x40040078, 0, 0, 0)
11 cma__thread_start1@libdce + 0x0000004c (0x40040078, 0, 0, 0)
12 cma__thread_start0@libdce + 0x00000008 (0x40040078, 0, 0, 0)
13 MD5Update@libdce + 0x000001c8 (0, 0, 0, 0)

>lr $a
$arg0     = 0x40087548
$arg1     = 0x40087620
$arg2     = 0xfffffb38
$arg3     = 0x400d0ca0

>lr $r
$r0       = 0
$r1       = 0x1
$r2       = 0x8172663f
$r3       = 0
$r4       = 0
$r5       = 0
$r6       = 0
$r7       = 0
$r8       = 0
$r9       = 0
$r10      = 0
$r11      = 0
$r12      = 0
$r13      = 0
$r14      = 0
$r15      = 0
$r16      = 0
$r17      = 0
$r18      = 0
$r19      = 0x7af33238
$r20      = 0x20
$r21      = 0x40a20000
$r22      = 0x40a20001
$r23      = 0x400d0ca0
$r24      = 0xfffffb38
$r25      = 0x40087620
$r26      = 0x40087548
$r27      = 0x4002b010
$r28      = 0
$r29      = 0x1
$r30      = 0x400876a0
$r31      = 0x40087577
$ret0     = 0
$ret1     = 0x1

>p *($pc -16)\20i
0x8172662c  LDSID       (0,1),31
0x81726630  MTSP        31,0
0x81726634  BLE 0(0,1)
0x81726638  OR  31,0,2
0x8172663c  LDW -32(0,30),19
0x81726640  STW 0,-64(0,30)
0x81726644  LDW -172(0,30),21
0x81726648  LDO -1(21),22
0x8172664c  STW 22,-172(0,30)
0x81726650  COMIBF,=    0,21,0xfffffecc
0x81726654  OR  0,0,0
0x81726658  LDW -148(0,30),2
0x8172665c  BV  0(2)
0x81726660  LDO -128(30),30
0x81726664  STW 2,-20(0,30)
0x81726668  LDO 128(30),30
0x8172666c  STW 19,-32(0,30)
0x81726670  STW 26,-164(0,30)
0x81726674  LDW -164(0,30),1
0x81726678  LDW 0(0,1),31

[8/22/94 public ]

Is this problem still reproduceable since last Wenesday's submit
by Greg?

[8/22/94 public]
I've asked PeterO to run the cds tests with the latest build to see if he
can reproduce this problem. He will run the tests overnight so that we will
have results tomorrow morning (assuming no other core dump happens).

[8/23/94 public]

Good news.  Tests ran successfully overnight on Sunday night's build (8/22).
Cancelling this one.



CR Number                     : 11722
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : secd (replica)
Short Description             : secd (replica) dies on RIOS
soon after start up.
Reported Date                 : 8/16/94
Found in Baseline             : 1.1b14
Found Date                    : 8/16/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/16/94 public]

Using NB from 08/13/94, on RIOS, a security replica dies soon after 
it has started up. The debugger prints the following information:
(it always prints the same thing)

root@soldier> dbx /opt/dcelocal/bin/secd core
dbx version 3.1 for AIX.
Type 'help' for help.
reading symbolic information ...
[memory image in core]

abort process in raise at 0xd00c793c
0xd00c793c (raise+0x24) 80410014          l   r2,0x14(r1)
(dbx) where
raise(0x0) at 0xd00c793c
abort(0x0) at 0xd00c784c
dce_svc_printf_withfile(0x20094f88, 0x200bdef8, 0x1c5, 0x200bdf38, 0x7,
0x1010, 
0x171220b8, 0xdeadbeef) at 0xd0368780
rgy_main(0x1, 0x2ff7fc94) at 0x100009d0
rs_main.main(0x1, 0x2ff7fc94) at 0x10000500
(dbx)

[8/16/94 public]
If it's calling abort from a dce_svc routine, that should mean that it's
hit a fatal error and it has probably logged that error just prior to calling
abort.  Could you find out what error it's logging for us and add that to this
CR?  Thanks...

[8/16/94 public]

There was no error printed by secd on the screen. I did not redirect 
the SVC output to a log. As I understand SVC takes stdout as the default, 
so I expect to see fatal errors and warnings printed on the screen 
where I started the server.  At least, this is true with dtsd and 
cdsd. Is secd different? If so, should I set a SVC level different from 
the default to get secd's fatal errors and warnings?

[ sekhar 8/16/94 public ]

Can you check /opt/dcelocal/var/security/secd.log to see
if there are any messages ? 

On 8/12 (date?) I submitted a change so that stdout/stderr
is redirected to /opt/dcelocal/var/security/secd.log when
secd is running in the background .

[8/16/94 public]

Here is the error:

root@soldier> cat /opt/dcelocal/var/security/secd.log
1994-08-16-18:48:37.312-04:00I1.990 secd FATAL sec rs_mainthr rs_main.c 522
0x200aeeb0 database locked

I found the core in

	 /opt/dcelocal/var/security/core

but had not useful info this time. Not always one gets a good core.
Hope this helps.

[ sekhar 8/17/94 public ]

One possibility could be that secd was already running on the machine
where the replica was being configured. 

Can you try to configure a replica after making sure that secd
is not running and see if the problem occurs again ?

[8/17/94 public]

I am sure there was only one secd running at the time
because I was typing repeatedly

	root@soldier> ps -ef | grep secd

and was only showing on secd and the grep.

I still have on my screen the commands:

root@soldier> pwd
/opt/dcelocal/etc
root@soldier> ps -ef | grep secd
    root  8255  8745   5 19:12:19  pts/2  0:00 grep secd 
    root 23008     1  15 18:48:22  pts/2  1:09 secd 
root@soldier> ps -ef | grep secd
    root  8257  8745   4 19:16:19  pts/2  0:00 grep secd 
root@soldier> pwd

At the moment I am working on another problem. If I have time
later I will try it again.

[8/16/94 public]
Hmm, bummer...  It looks like the first time it coredumped it left the database
locked, so every subsequent time fails (it coredumps on purpose when it gets a
fatal error like this) you would get this message.  Try the following to unlock
The database and then try restarting secd and see what message it dies with
when the database isn't locked (when you have time):

cd /opt/dcelocal/var/security/rgy_data
cp rgy_state xx
mv xx rgy_state

(note: a reboot should also fix the locked problem, but the above is easier)
If you can't get to this before you leave on vacation, could you let someone
else down there know which machine this is happening on so that they might
be able to get us some more info?

[ sekhar 8/17/94 public ]

I fail to see  how the above suggestion would help.

The status code corresponding to the error message "database locked" 
sec_rgy_rep_db_locked which as far as I can tell is only issued 
when secd fails to apply a write lock to a file using fcntl() 
or flock() ( depending on how the code is compiled ). Morover,
(when fcntl() is used ) sec_rgy_rep_db_locked is set only when
EACCESS is obtained from the fcntl() call which implies that another
process has the file in question locked. This must be secd ( assuming
that secd is the only locking these files ).

If secd had exited , then the locks should have been released on 
process exit.

To configure a replica , there must be no secd running on the 
machine - not one secd running.

[8/17/94 public]
No, that error message is also issued if secd died and left the database in
a locked state.  The 'one secd' is the one that Martha is running that dies
after a short time (ie: after being slow starting up, or after minutes...).
In her words: "The steps are: 
- I start secd on the RIOS 
- Go to another window, and start a script that 
  does dce_login or a security system test.
- Back to the first window to do the ps -ef and 
  wait till it dies. Last night it took about 10 
  minutes to die, sometimes is sooner."
The "suggestion" that I gave above will help this particular problem (the lock)
and in fact I've been using it in a script called unlock_db for 4 years now.
The copy preserves the state in the rgy_state file.  The move recreates the
rgy_state file with the correct information in it, but with the fcntl locks
released.  I think there's multiple things causing these failures, one of
which (the one that causes it to die at or just after startup) is the database
locked message, and the other (10 or so minutes after startup) is something
else that we'll need to find after getting around the database locked problem.

[ dassarma 08/17/94 public]

We can afford to wait till next week to pick this one up. I lowered
the priority till then. Maybe be it will be gone by then.

[08/25/94 public]

I am using BL16 and this still is happening. Maybe someone at IBM could
help reproduce this and identify the cause. I am unable to get a good core 
and also there is no error left in the svc log file by secd. This time, 
the secd replica took almost a day before it died. There is definetely 
a problem with secd (only tried replica) on AIX.

[8/25/94 public]
If this is still a problem, then it's at least a p1 that must be fixed.

[9/01/94 public]
Is someone at IBM looking into this one?  If so, could you please assign
the bug to yourself?

[9/01/94 public]
We have been working on several other problems. I will investigate.
Assigning to myself.

[9/06/94 public]
We have a 3 machine cell with two security replicas. I have been
running the following shell script for over an hour:

   #!/bin/ksh

   count=0
   while:; do
         dce_login cell_admin -dce- <<i-LOGIN_EOF
                klist >/dev/null 2>&1
         LOGIN_EOF
         ((count += 1))
         echo "dce_login #$count"
   done

The security replica on the machine has been up and running for 5 days.
How can I recreate the problem? I will continue to monitor the shell
script to see if secd has a problem.

[9/06/94 public]

The last time I used my RIOS for 1.1 testing (now is a 1.0.3 client), 
the replica took about a day to die. During this time, I was running
system tests. I usually run dcesestr or dcesepol. They are a good
exercise on the registry replicas.

[9/12/94 public]
Any update on the IBM side for this one? I currently have a cell
set up with BOTH a RIOS security master and a RIOS security replica.
I plan to exercise it starting tomorrow with one of the security
system tests mentioned above. Note that this will not be sufficient
to close this bug since this is a homogeneous configuration but it
will be a datapoint for whether IBM should be able to reproduce it
at home.

[9/12/94 public]
I plan to configure the RIOS as a 1.1 secd replica in the CHO cell
tonight to see if we can reproduce this while we have someone onsite
to help.

[10/3/94 public]
I was unable to reproduce this.  secd replica on rios stayed up and
running for 48 CHO.  Unless Martha D has seen it since she came
back, I think we can cancel it.

[10/3/94 public]
At this point this is safe to cancel.



CR Number                     : 11721
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : Cannot connect to replica with rgy_edit from remote node when master has been stopped.
Reported Date                 : 8/16/94
Found in Baseline             : 1.1b14
Found Date                    : 8/16/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/16/94 public]

rgy_edit is unable to connect to a replica from another node in the cell
once the master secd has been stopped.

dce_login is successful, but invoking rgy_edit returns

?(rgy_edit) Unable to contact the registry - Registry server unavailable (Regist
ry Edit Kernel)
 (dce / sad)

dce_login and rgy_edit are successfully invoked on the node where the replica 
resides.

[8/16/94 public]
Here is more info: Using the weekend build of 8/14, configured a Master HP
and replica on 486. Using sec_admin stoppped the Master. Then did dce_login
which worked ok. rgy_edit timed on Master timed out with server unavilable 
message.

sec_admin> lrep -all
Default replica:  /.../hp_cell/subsys/dce/sec/sunrise
Default cell:     /.../hp_cell
WARNING: The default replica is not the master registry.
         Propagation information will not be displayed


subsys/dce/sec/sunrise
          Instance id:             63cbd449-b92b-11cd-87cf-0000c04fd04c
          Addresses:               ncacn_ip_tcp:130.105.4.197[]
                                   ncadg_ip_udp:130.105.4.197[]
          State:                   in service - slave
          Last update received at: Tue Aug 16 14:53:23 1994
          Last update's seqno:     0.1724

subsys/dce/sec/master (master)
          Instance id:             dd5d1cc8-b83a-11cd-8035-080009251539
          Addresses:               ncacn_ip_tcp:130.105.4.208[]
                                   ncadg_ip_udp:130.105.4.208[]
          State:                   unavailable - no more profile elements
(dce / rpc)


Performed rgy_edit on Master replica gives:

spring : rgy_edit
(binding_cache_lookup) Looking for site /.../hp_cell, cell , princ dce-rgy,
type 1
(binding_cache_lookup) Cache miss
_ip_tcp:130.105.4.208[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_get_site_bindings) Got binding
de1179de-b83a-11cd-8035-080009251539@ncadg_ip_udp:130.105.4.208[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_site_bind_pe_site) returned successfully from rca_get_site_bindings
(rca_rebind) Took alt_handle 0 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site
== /.../hp_cell
(rca_setup_handle) Auth DCE, principal 'dce-ptgt@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fa930
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_site_bind) Bound to Cell '/.../hp_cell'
(rca_site_bind) Bound to Site '/.../hp_cell'
(rca_lock_handle) locking 7b036458
(rca_unlock_handle) unlocking 400f9868
(rca_site_bind) String Binding
'de1179de-b83a-11cd-8035-080009251539@ncacn_ip_tcp:130.105.4.208[]'
(binding_cache_enter) Adding 400f9868 to binding cache: site /.../hp_cell
cell /.../hp_cell princ dce-ptgt@hp_cell type 1
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Took alt_handle 1 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site
== /.../hp_cell
(rca_setup_handle) Auth DCE, principal 'dce-ptgt@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fa9e8
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9bd8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400f9bd8
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9cb8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/sunrise
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400f9cb8
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9af8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400f9af8
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9478
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400f9478
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9398
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) failed, status 16c9a0b5
(rca_nsi_binding_import) attempting to re-import
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../hp_cell
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400fb220
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/sunrise
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fb220
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9520
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400f9520
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400fb2b8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/sunrise
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fb2b8
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400f9268
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400f9268
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400fcbb8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fcbb8
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) about to call rca_setup_handle;
rpc_handle==400fcae8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 0
(rca_setup_handle) Replace entry name with
/.../hp_cell/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fcae8
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035a18
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035a58
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) failed, status 16c9a0b5
(rca_site_bind_pe_site) calling get_site_bindings
(rca_get_site_bindings) about to open config file
(rca_get_site_bindings) Got binding
de1179de-b83a-11cd-8035-080009251539@ncacn_ip_tcp:130.105.4.208[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_get_site_bindings) Got binding
de1179de-b83a-11cd-8035-080009251539@ncadg_ip_udp:130.105.4.208[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_site_bind_pe_site) returned successfully from rca_get_site_bindings
(rca_rebind) Took alt_handle 0 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_lock_handle) locking 7b035998
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_rebind) Took alt_handle 1 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../hp_cell, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site
== /.../hp_cell
(rca_setup_handle) Auth DCE, principal 'dce-rgy@hp_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 400e21e0, handle
400fc970
(binding_cache_lookup) Looking for site /.../hp_cell, cell /.../hp_cell,
princ dce-ptgt, type 1
(binding_cache_lookup) Looking at 400f9868: site `/.../hp_cell' cell
`/.../hp_cell' princ `dce-ptgt@hp_cell' 1
(binding_cache_lookup) Cache hit: returning 400f9868
returning cached context 400f9868
(rca_lock_handle) locking 7b035958
(rca_check_binding) checking 400f9868
(rca_check_binding) checking 400f9868
(rca_rebind) Non-nsi rebind failed
(rca_unlock_handle) unlocking 400f9868
(rca_lock_handle) locking 7b035998
400f9868: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 400f9868
(rca_setup_handle) end set_auth_info identity 400e21e0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1712207b
(rca_rebind) Non-nsi rebind failed
(rca_site_bind_pe_site) assuming /.../hp_cell is string binding
(rca_lock_handle) locking 7b034d18
400e3c50: Dropping site refcount from 1 to 0
Drop ref to identity 400e21e0 from binding cache
(rca_unlock_handle) unlocking 400e3c50
?(rgy_edit) Unable to contact the registry - Registry server unavailable
(Registry Edit Kernel)
 (dce / sad)

[08/19/94 public]

I have reproduced this locally and will be working on it.

[09/09/94 public]
No longer reproducible in bl16.3.  (I'd thought this would have been
the same fix as 11623, but that was in my bl16+ sandbox before...)

[09/14/94 public]
Rajendra observed the same working behavior with HP & 486 last week; canceling.



CR Number                     : 11704
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdsd
Short Description             : cdsd core dumps while running
system tests
Reported Date                 : 8/15/94
Found in Baseline             : 1.1b14
Found Date                    : 8/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/15/94 public]

BUILD: NB from Friday 08/13/94

I am opening this bug because I had the exact same problem on two
different cells where I was running system tests this weekend. 
On both cells cdsd was running on an OSF1 machine; one cell was all 
1.1 server and clients. The other had 1.1 servers and 1.0.3 clients.

There were not CDS replicas configured on either cell.

On cell 1 (all 1.1. cell)
=========

1. Core size

root@dce3> ls -l ./var/directory/cds/adm/cdsd/core                     
-rw-r--r--   1 root     bin             24117184 Aug 14 05:11 ./var/directory/cds/adm/cdsd/core


2. gbd info ( I tried what Tom told me to do to get more info but did not
   anu more info) 


..(no debugging symbols found)...
Core was generated by `cdsd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0xa403fea4 in bkgdskulkhalf ()
(gdb) where


On cell 2
=========

1. Core size (1.1 servers and 1.0.3 clients)

root@raven> ls -l ./var/directory/cds/adm/cdsd/core                     
-rw-r--r--   1 root     bin             13939824 Aug 14 05:09
./var/directory/cds/adm/cdsd/core

2. gdb info ( could not get more out gbd)

..(no debugging symbols found)...
Core was generated by `cdsd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0xa403fea4 in bkgdskulkhalf ()
(gdb) break main
Breakpoint 1 at 0x447b98
(gdb) run
Starting program: /opt/dcelocal/bin/cdsd 

Breakpoint 1, 0x447b98 in main ()
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0xa403fea4 in kill ()
(gdb) bt
#0  0xa403fea4 in kill ()
Cannot access memory at address 0xc6051d44.
(gdb) quit

[8/15/94 public]
I don't know what's going on with the first one but the second one left 
a cma_dump.log in the same directory as the core file. This means it
failed a cma bugcheck. The log give as cause 

% Reason: cma__ts_open:  fd is too large

Some one isn't closing files. On the 486 the maximum number of open 
files allowed is 256.

[8/15/94 public]
I won't take more than a couple of hours for me to add some code
conditional on DEBUG that keeps the name of the file in the cma
descriptor table for all open files. The bug check code can then
dump the list of open files at the time of the hit. I'll assign
this to myself and as soon as the dust clears on the other ots
tommorrow I'll add the code to the cma library.

[8/18/94 public]
Not holding anyone up, lowered to P1.
John will add some debug code to CMA to record names of files opened to try
and help get more info if this reoccurs.

[07/09/96 public]
Since:

1. There is no way to reproduce this reliably.
2. The original problem hints at the problem possibly being in CMA, but
   we don't know its status.
3. No direct evidence indicating that the problem is in cdsd (no call context
   for that matter).

For the above reasons, I am canceling this OT.  If any of the above
changes, feel free to re-open this.

--Roger



CR Number                     : 11697
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : rpc/runtime/i18n_api/ts/cs_eval/cs_byte/method_fixed.c
Short Description             : loc_string' undeclared
Reported Date                 : 8/15/94
Found in Baseline             : 1.1
Found Date                    : 8/15/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/15/94 public]

/project/dce/build/dce1.1-snap/src/test/functional/rpc/runtime/i18n_api/ts/cs_eval/cs_byte/method_fixed.c:190: `net_string' undeclared (first use this function)
/project/dce/build/dce1.1-snap/src/test/functional/rpc/runtime/i18n_api/ts/cs_eval/cs_byte/method_fixed.c:191: `loc_string' undeclared (first use this function)
*** Error code 1

[8/15/94 public]
Unable to reproduce, probably a result of disk space problems.



CR Number                     : 11688
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_rgy_acct_passwd accepts passwd < min policy length
Reported Date                 : 8/15/94
Found in Baseline             : 1.1
Found Date                    : 8/15/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/15/94 public]

scenario: min length specified in registry server policy is 10 characters
        : pass in a new password with a length of 1 character, and API
		still works

[8/15/94 public]

This problem is fixed in DCE 1.1. secd now rejects passwords which do
not abide by the registry policy for passwords. I just verified that
it is working properly.

What baselevel are you using?

[8/15/94 public]

We just tested this on 1.13 and did work. The people who reported this
problem to me did not test it against the 1.1 code.
I will cancel this defcet.



CR Number                     : 11681
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : odd error message
Reported Date                 : 8/12/94
Found in Baseline             : 1.1b14
Found Date                    : 8/12/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/12/94 public]
When issuing 'principal create', without first authenticating as
cell_admin, dcecp responds with:

	Principal quota exhausted

Which is a tad confusing.

After dce_logging in, principal create worked correctly.

[8/12/94 public]
Sorry to cancel, but here's why.  That's the message that's returned by the
sec API.  There is no way for dcecp to know if your quota is exhausted or
if you are not logged in sec will return the same error.  And to some
extent it is correct.  Why can't an unauth user create a princ, the user
doesn't have a quota to decrement.

If you want to continue this, open an enh against security to change the
error message to be fixed in 1.2.  There might be backward compat problems
with clients getting back a different error message, but probably not.



CR Number                     : 11675
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp "logout" problem
Reported Date                 : 8/12/94
Found in Baseline             : 1.1
Found Date                    : 8/12/94
Severity                      : B
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/12/94 public]

	It happened with 1.1 BL 12. I don't have the screen output anymore.

	I was root when I entered dcecp. "klist" inside dcecp shows the right
	information about the machine principal. I then did a "login" as
	someone else. I left it there for over night. The next day when I came
	in, I typed "klist". It showed my principal name but could not show the
	group names since the credential has expired. So far so good. I then
	did a "logout". This should get my context back to the machine
	principal. I did a "klist", it showed the machine principal name,
	but it could not resolve the group names either, even though the 
	"Identity expiration" field showed the time in the future. I then got
	out of dcecp, then did a "klist". Everything showed fine.

[8/22/94 public]
I ran a dcecp session over the weekend. The output of klist was the same on
Friday as it was this morning. I was lokked in a root, and this morning I
still could perform operations as the machine principal.

Weidong, I can't seem to reproduce this. HP says that it should work, and
it does for me. If you can't make this happen again, please cancel this.

[8/26/94 public]
Couldn't reproduce.  Haven't heard in a week.  Cancelled.  If re-occurs can
always be re-opened.



CR Number                     : 11668
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11488
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dced
Subcomponent Name             : secval
Short Description             : sec_clientd dumps core on RIOS
Reported Date                 : 8/12/94
Found in Baseline             : 1.1b14
Found Date                    : 8/12/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/12/94 public]

NB: 08/11/94
Cell Configuration;

HPUX: Core Server (No dtsd)
RIOS: client/SEC replica (No dtsd)
OSF1: client/SEC replica (No dtsd)

The sec_clientd running on the RIOS did a core dump; there was no
problem with the replica.

This is the size of the coredump:

root@soldier> ls -l /opt/dcelocal/etc/core*
-rw-rw-rw-   1 root     bin      117925591 Aug 11 20:31 /opt/dcelocal/etc/core

and this is the info given by the where command in dbx:

root@soldier> dbx /opt/dcelocal/bin/sec_clientd core
dbx version 3.1 for AIX.
Type 'help' for help.
reading symbolic information ...
[memory image in core]

segmentation violation in leftmost at 0xd00c6bc0
0xd00c6bc0 (leftmost+0x10) 81050004          l   r8,0x4(r5)
(dbx) where
leftmost(0xd0) at 0xd00c6bc0
malloc_y(0xd0) at 0xd00c5468
malloc(0xd0) at 0xd00c40f0
cma_lib_malloc(0xbc) at 0xd035741c
rpc__mem_alloc(0xbc, 0x50, 0x0) at 0xd036d2d4
rpc__krb_cn_create_info(0x5, 0x20269a70, 0x20139198) at 0xd049b6dc
rpc__cn_assoc_process_auth_tlr(0x20139168, 0x2018c038, 0x670, 0x20288048,
0x20269c64, 0x20269c78, 0x20139258, 0x0) at 0xd04c0fd4
do_alter_cont_req_action_rtn(0x20139168, 0x2018c018, 0x20139170) at
0xd04bdca4
incr_do_alter_action_rtn(0x20139168, 0x2018c018, 0x20139170) at 0xd04c0514
rpc__cn_sm_eval_event(0x67, 0x2018c018, 0x20139168, 0x20139170) at
0xd04b5b6c
receive_dispatch(0x20139168) at 0xd04c4754
rpc__cn_network_receiver(0x20139168) at 0xd04c2660
cma__thread_base(0x20235158) at 0xd034eb04
(dbx) 

I must add that on the core server, I had the usual "mismatch seal 0"
messages. I am saving the core, in case someone requests more information.
System tests were running at the time this happened.

[8/15/94 public]
Yikes, a 117Mb coredump for sec_clientd?  It's no wonder that RPC couldn't
malloc any more memory...  We're counting on Greg's upcoming fixes resolving
the mismatch seal problem, but this seems like there's also a huge memory
leak...  I'm adding dce-team@osf.org to the CC list.  If anybody is seeing
abnormal growth of sec_clientd, could you please update this CR? (unless
everybody is seeing it, in which case send email to me and I'll forward it
to whoever ends up looking into this, so we don't wind up rereading this
CR every couple of minutes as it gets updated).

[8/15/94 public]
How about trying dced's "secval" instead.  To use it:

    1. edit /etc/rc.dce to
	start dced with with a "-s" flag
	comment out starting sec_clientd
    2. restart dce on your machine

I'm working on getting sec_clientd out of dce_config so dced/secval will
be config'ed by default.  (It's more of a pain than it looks.)
sec_clientd will be going away - moving to nosupport [CR 11488] - so it's
probably best to not spend too much (or any?) time on this.

[8/15/94 public]
While I agree that memory leaks are not as bad as coredumps (thus the p1
instead of p0 I presume), and that sec_clientd is going away, I think this
needs to be looked into...  sec_clientd does practically nothing that would
cause this 117MB leak within itself and the code within this prog hasn't been
changing either, only the library APIs that it relies on, so this problem
should be seen with dced/secval too if it's really a problem with sec_clientd.
Since sec_clientd is what is still being used by most people, we would like
them to let us know if they see the memory leak problem and any info assoc
with it (ie: how big, how long had it been up, what activity had the cell seen)
rather than wait until people start using secval and start looking for the
problem with even less time to fix it.

[8/15/94 public]
I have had a cell up since Aug 11 (from 8/10 nightly) and my sec_clientd
is doing fine (OSF/1):

USER    PID %CPU %MEM   VSZ  RSS TTY      STAT STARTED         TIME COMMAND
root  16026  0.0  6.4 10.2M 2.32 ??       S      Aug 11     1:49.50 sec_clientd

surf>ls -l /opt/dcelocal/bin/sec_clientd
-rwxr-xr-x   1 bin      bin               64083 Aug 10 23:46 /opt/dcelocal/bin/sec_clientd

[08/15/94 public]

I made this a P1 until we get the fixes from Bill and Greg to some P0s.
Then, we can run the system tests again and try to recreate the security
problems reported here and elsewhere (i.e. hangs, core dumps, leaks). 
security is having the most problems on RIOS.

[08/15/94 public]
Note that "ls -l" doesn't always tell you a file's size; it could have
holes in it.  Core files on some architectures are particularly capable
of this.  What does "ls -s" say?

dced's integration of sec_clientd is slowly becoming a complete rewrite
so while we should try to identify the bug, we shouldn't fix it
in sec_clientd.

[8/23/94 public]
I believe that the fixes we were waiting for have all arrived.  Can we
retest this one and see where we are now?  Thanks.

[8/24/04 public]

System test core testing is no longer using sec_clientd. We have 
started to use "dced -s". As a result, we won't be following the 
state of sec_clientd from now on. I will lower the priority of this 
CR to indicate this.

[8/24/94 public]
Note that as of the next successful nightly build, the dced will have
secval on by default.  The meaning of the "-s" flag will be reversed in
that it will turn secval OFF.  Though the dce_config sscript will still 
start up sec_clientd by default.  To have dce_config configure dced as 
the secval service,  do:
		   setenv SEC_CLIENT dced
before starting dce_config.

To set back to sec_clientd if problems with secval:
		   setenv SEC_CLIENT sec_clientd
and re-config.

Mary, what were the changes that were supposed to address the sec_clientd
core dump?

[08/26/94 public]
The secval codebase is pretty much the same as sec_clientd's.  If HP thinks
they fixed this bug and Martha can't get it to show up, let's cancel this.

[08/18/94 public]

I am no longer using sec_clientd- I am using secval and this problem
has not happened after a long weekend of testing. I am canceling this.



CR Number                     : 11662
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : run_commands.dfs
Short Description             : cd /: FAILED!
Reported Date                 : 8/12/94
Found in Baseline             : 1.1
Found Date                    : 8/12/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/12/94 public]

fts lsfldb
+ /u1/opt/dcelocal/bin/fts lsfldb 

root.dfs  
        readWrite   ID 0,,1  valid
        readOnly    ID 0,,2  invalid
        backup      ID 0,,3  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner               budapest.osf.org    RW       lfs_aggr1 0:00:00 hosts/budapest <nil>               
----------------------
Total FLDB entries that were successfully enumerated: 1 (0 failed; 0 wrong aggr type)
+ [ 0 != 0 ] 
+ sleep 180 
+ echo cd /: 
cd /:
+ cd /: 
/u1/RAT_tools/run_commands.dfs: /:: bad directory

[8/12/94 public]
I couldn't reproduce this problem on the smoketest platform.
I've suggested the RATs modify thier script to sleep 240
seconds rather than 180 since the TSR interval is really 
3 minutes 20 seconds.  Peter is attempting to reproduce now
on the smoketest platform.

[8/12/94 public]
Peter ran the smoketest again with the larger TSR sleep time and 
couldn't reproduce the problem (the smoke was successful).  I'm 
taking the drastic step of cancelling this bug.  If it occurs 
again, Peter can re-open this.

[8/15/94 public]

This error complains about servers not being up 
but upon checking budapest and sif, secd, dced, cdsd
were all running with the exception of dcecp

fts lsfldb
+ /u1/opt/dcelocal/bin/fts lsfldb 
Could not access the FLDB for attributes
Error: no servers appear to be up (dfs / ubk)
+ [ 1 != 0 ] 
+ echo fts lsfldb FAILED! 
fts lsfldb FAILED!
+ sleep 240 
+ echo cd /: 
cd /:
+ cd /: 
/u1/RAT_tools/run_commands.dfs: /:: bad directory

[8/15/94 public]
Peter, a change was made to the dfs_config script last week.  Have
your scripts been updated to deal with this?  Talk to Andy McKeen
for details.

[8/15/94 public]

Yes!  All scripts have been updated last week.



CR Number                     : 11643
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : pgo show
Short Description             : multiple uuids for attr_set not created/shown properly
Reported Date                 : 8/10/94
Found in Baseline             : 1.1b14
Found Date                    : 8/10/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/10/94 public]

When multiple uuid strings are specified as arguments to an era of type
attr_set, the corresponding show command shows the last uuid wrong. It is
either a problem in create or show. 

The following test shows the problem:
520|0 1 4127 1 37|principal_create_era_attr_set_5_P: An attr_set attribute accepts a multiple Tcl listed UUIDs
520|0 1 4127 1 38|==== Contents of test case:
520|0 1 4127 1 39|{principal create foob -attribute {test_attr_set {291e5274-7887-11cd-98a5-0800092464af} {291e5274-7887-11cd-98a5
-0800092464ag} }      dcp_attrlist getval [principal show foob] test_attr_set }
520|0 1 4127 1 40|Test completed successfully.
520|0 1 4127 1 41|== Test output was:
520|0 1 4127 1 42|{291e5274-7887-11cd-98a5-0800092464af  291e5274-7887-11cd-98a5-08000924640a}
520|0 1 4127 1 43|== Expected output was:
520|0 1 4127 1 44|{291e5274-7887-11cd-98a5-0800092464af 291e5274-7887-11cd-98a5-0800092464ag}
520|0 1 4127 1 45|Test Failed.
220|0 1 1 16:51:41|FAIL

Another way to reproduce the problem:

dcecp> principal create foob -attribute {test_attr_set "291e5274-7887-11cd-98a5-0800092464af" "291e5274-7887-11cd-98a5-0800092464a g"}
dcecp> principal show foob
{fullname {}}
{uid 397}
{uuid 0000018d-b485-21cd-9400-08000927ee90}
{alias no}
{quota unlimited}
{test_attr_set
 291e5274-7887-11cd-98a5-0800092464af
 291e5274-7887-11cd-98a5-08000924640a}
dcecp>

It seems there is a problem in either showing or creating the last two characters of the last uuid.

[8/16/94 public]

The era code processes uuid's the same way as the rest of the dcecp code.
The incomming uuid is read and stored with uuid_from_string(), and the
existing uuid is displayed with string_to_uuid().

The problem above is the uuid string itself, not the position of the
uuid string, nor the era code.  The uuid "291e5274-7887-11cd-98a5-0800092464ag"
contains an illegal or incorrect character, the last one -> "g".

I don't know if the above uuid is technically invalid or not.  If so, then
there is a bug in uuid_from_string(), which should catch the illegal
character.  If it's ok, then there is no bug and the above behavior is
expected.  Either way, the era code is ok, so this bug is being cancelled.
I will change the test to pass a correct uuid string.



CR Number                     : 11630
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dts
Subcomponent Name             : dtsd
Short Description             : ERROR: time service in wrong state (dce / dts)
Reported Date                 : 8/9/94
Found in Baseline             : 1.1b14
Found Date                    : 8/9/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/9/94 public]

I am entering this bug so this behavior gets recorded. I am not
sure if this is a serious error or an informative message. It 
happens often, so that if it is an error something is not working
a lot of the time.

Using dcecp or dtscp, several dts commands return:

dtscp example
------------
dtscp> sync
error executing command:
        time service in wrong state (dce / dts)

dcecp example
------------

dcecp> dts sync
Error: time service in wrong state

NOTE: it is not specific to the sync subcommand, other commands
      return the same error when it happens.

[8/19/94 public]
The dtsd will return a "wrong state" error if the time service
is not in the "on" state. This will be true, for example, if the 
time service is attempting to synchronize, or if the service has been
disabled. For example, a sync command issued while the daemon is 
synchronizing would generate this message. 

I'm cancelling this bug, since there are no code changes to be made
here.



CR Number                     : 11629
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : dtsd
Short Description             : dtsd dumps core on RIOS 
after a few sync commands using dcecp or dtscp.
Reported Date                 : 8/9/94
Found in Baseline             : 1.1b14
Found Date                    : 8/9/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/9/94 public]

Build: NB 08/08 (BL14.?)
Configurations:
OSF1: secd, dtsdm ntp provider
HPUX: cdsd, dtsd, 
RIOS: DCE client, dtsd 

dtsd on the RIOS dumps core after a few sync commands using dtscp or 
dcecp. I tried looking at the core but dbx prints 

"core does not contain a stack (core ignored)"

[08/09/94 public]

I want to add a couple of things:

1. dtsd just dies after having been runnig for a few minutes,
   eventhough no dtscp commands are executed.

2. There is another dtsd core dump CR that could be 
   related to this. That is CR 11590.

[8/10/94 public]

I'm including some comments from an email from Gail about another RIOS
crash that may shed some light on the problem. Also see 11590 for a 
backtrace on the HP. 

>But after awhile ... 

>1994-08-09-17:15:33.927-04:00I----- dtsd ERROR dts dtserror
>dtss_service_global_set.c 418 0x200abde8
>Couldn't get remote server entry name: no entry name (dce / rpc)
>The assert subroutine failed: (*((rpc_binding_rep_p_t *)
>binding_h))->refcnt > 0, file
>/project/dce/build/dce1.1-snap/src/rpc/runtime/combind.c, line 322

>Hmm - what d'ya think? Anyone else seen this? This happens to be
>on a rios so maybe it's not getting exercised as much there? No CR
>logged yet ... just hunting for ideas - thanks -

OK. This happens when we've ostensibly retrieved a binding handle from 
the namespace, and we want to know what the real entry was (since  we
might have been originally searching a group or profile). This says
that the binding handle wasn't retrieved from the namespace(!?), according
to my handy application development reference ... and, shortly thereafter,
we get an assertion failure when we do an rpc_binding_free. (I've included
the core dump from your other email)

(dbx) where
raise(0x0) at 0xd00c793c
abort(0x0) at 0xd00c784c
_assert(0x0, 0xdeadbeef, 0xdeadbeef) at 0xd011f3bc
rpc_binding_free(0x2ff7e61c, 0x2ff7e614) at 0xd035c6b4
PopulateCacheFromRPCprofile(0x1, 0x200c6a30, 0x200c6a54) at 0x100251a4
PopulateLocalCache(0x1002727c) at 0x100247f4
Synchronize(0x4, 0x2015b2f8) at 0x1002727c
ProcessEvent(0x2015b2f8) at 0x100005d0
main(0x2, 0x2ff7f9b8) at 0x100004b8

The symptom is certainly that of a corrupted binding handle returned 
from an rpc_ns_xxx call. Why it was corrupted is another story.

[8/11/94 public]

This is believed to be a RIOS specific problem. Re-assigning to IBM.

[8/12/94 public]

I installed the NB. I configured a dts clerk on the RIOS which
did a core dump about 20 minutes after configuration. At this 
point, we do not have a working dtsd, server or clerk, on RIOS.

Using dbx, the core says:

root@soldier> dbx /opt/dcelocal/bin/dtsd core
dbx version 3.1 for AIX.
Type 'help' for help.
reading symbolic information ...
[memory image in core]

segmentation violation in ProcessTimeResponseRPC at 0x1001a858
0x1001a858 (ProcessTimeResponseRPC+0x24) 80640004          l   r3,0x4(r4)
(dbx) where
ProcessTimeResponseRPC(0x20163f98) at 0x1001a858
ProcessTimeResponse(0x20163f98) at 0x1001a79c
Synchronize(0x0, 0x20163f98) at 0x10027ae0
ProcessEvent(0x20163f98) at 0x10000684
main(0x2, 0x2ff7f738) at 0x100004b8

Should I save the core?

[8/15/94 public]

There certainly seems to be something amuck in dts on the RIOS.  
I have not seen dts dump core (yet) but am having all sorts of problems
trying to configure it.  Stay tuned...

[8/16/94 public]
Hit this again (I'm using baseline 14) restarting dce on the RIOS
after having rebooted the machine. I waited quite awhile for 
/etc/dce_shutdown -f to work but finally gave up and rebooted
before it finished so perhaps there is corrupt data around? In any
event, DCE should be robust enough to handle a machine rebooting ...

I get the same core dump I did before:

root@cobbler> dbx /opt/dcelocal/bin/dtsd /opt/dcelocal/var/adm/time/core
dbx version 3.1 for AIX.
Type 'help' for help.
reading symbolic information ...
[memory image in /opt/dcelocal/var/adm/time/core]

abort process in raise at 0xd00c793c
0xd00c793c (raise+0x24) 80410014          l   r2,0x14(r1)
(dbx) where
raise(0x0) at 0xd00c793c
abort(0x0) at 0xd00c784c
_assert(0x0, 0xdeadbeef, 0xdeadbeef) at 0xd011f3bc
rpc_binding_free(0x2ff7e61c, 0x2ff7e614) at 0xd035c6b4
PopulateCacheFromRPCprofile(0x1, 0x200c6a30, 0x200c6a54) at 0x100251a4
PopulateLocalCache(0x1002727c) at 0x100247f4
Synchronize(0x4, 0x2015b2f8) at 0x1002727c
ProcessEvent(0x2015b2f8) at 0x100005d0
main(0x2, 0x2ff7f9b8) at 0x100004b

but the assert routine worked this time,the following messages
appeared MANY times:

%Internal DCE Threads problem (version CMA BL10+), terminating execution.
% Reason: assertion failure:  cma__Queue_next: Q corruption
	at line 1743 in /project/dce/build/dce1.1-snap/src/threads/cma_debugger.c, pid = 13750
% See 'cma_dump.log' for state information.

The cma_dump.log file was empty :-(

[8/17/94 public]

I was able to get dts configured as above here in Austin and it has been
running for over 24 hours, no problems.  Go figure.  I'm still on BL13.

How long did the RIOS run above before you decided to shut it down?  Is
there  some bad data in the files in /opt/dcelocal/var/adm/time?

[8/17/94 public]

Could you please rev up to BL14... it has been out since Aug 4th and it 
is now Aug 17th.

[gthome 8/18/94 public]  

Fine.  We'll move up.  Has any analysis been done to the changes that
occurred from BL13 to BL14 to see why a problem like this (and any others)
have occurred?

[8/19/94 public]

No, no extensive analysis has been done to the changes between bl13
and bl14. There were a lot of changes to all components in that time 
frame, any one of which could be causing problems in the dtsd. 

As indicated previously, I suspect a corrupted binding handle returned
from the namespace. Not clear what is corrupting it. And we don't see 
this same behavior on other platforms.

[8/24/94 public]
I configured a 2 machine cell with 2 6000s with both machines configured
as a DTS local server. When configuring the first machine, dtsd would
always report the following error and exit:

> dtsd ERROR dts dtserror 
> transport_rpc.c 1121 0x200a28d8
> Failed to add Time Service entry to LAN profile /.../knout.cell/lan-profile:
> no permission for name service operation (dce / rpc)

However, when I ran dce_shutdown and then brought the cell back up
using rc.dce, dtsd is running. The second machine had no problem
configuring the loacl dts server (I did this before the shutdown on
the first machine). I then tried to reproduce this problem by setting
up a shell script to continually run "dtscp sync". It has been running
for over an hour without any problems occuring.

[08/25/94 public]

I run the sanity tests last night using BL-16 and dtsd did not
core dump on the RIOS. Therefore, I am canceling this bug.



CR Number                     : 11614
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8157
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : login
Short Description             : cdsd core dumps after dced does.
Reported Date                 : 8/9/94
Found in Baseline             : 1.1b14
Found Date                    : 8/9/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/9/94 public]

Running the sanity tests overnight in the following cell produced a
dced core dump (CR #8157) and four hours later a cdsd core dump.

HPUX: dced, cdsd, secd
OSF1: dce client
OSF1: dce client, ntp provider

The trace is as follows:

>t
 0 _kill@libc + 0x00000008 (hp-ux export stub)
 1 _raise@libc + 0x00000024 (0x40033748, 0x404539b8, 0, 0)
 2 _abort@libc + 0x00000078 (0x25, 0x404539b8, 0, 0)
 3 _assert@libc + 0x00000128 (0x7afed8e0, 0x3, 0x403f9be0, 0)
 4 cache_sanity_check@libdce + 0x00000380 (0x40668050, 0, 0, 0)
 5 sec_login_pvt_release_context@ + 0x00000090 (0x40668050, 0x403f94e8, 0, 0)
 6 sec_login_pvt_purge_refresh_co + 0x000000a4 (0x40668050, 0x403f9b18, 0x403f94
e8, 0)
 7 sec_login_pvt_setup_refresh_co + 0x0000058c (0x403b9d18, 0x403f94e8, 0x403f94
e8, 0x403f94e8)
 8 sec_login_validate_identity@li + 0x000001f8 (0x403b9d18, 0x40645ff8, 0x403f95
98, 0x403f959c)
 9 sec_login_valid_from_keytable@ + 0x00000374 (0x403b9d18, 0x1, 0, 0)
10 get_key_and_validate_id + 0x00000160 (0x403b9d18, 0x4003136c, 0x40032404, 0x4
03f94e8)
11 refresh_server_identity + 0x00000288 (0x40031368, 0x4013a7f8, 0x9, 0x40027da8
)
12 th_start + 0x000000cc (0x4013a7f8, 0x7af56088, 0x404539b8, 0x1a)
13 cma__thread_base@libdce + 0x0000021c (0x404539b8, 0, 0, 0)
14 cma__thread_start1@libdce + 0x0000004c (0x404539b8, 0, 0, 0)
15 cma__thread_start0@libdce + 0x00000008 (0x404539b8, 0, 0, 0)
.
.

>lr $a
$arg0     = 0x7afa9280
$arg1     = 0x7ffe6000
$arg2     = 0x46000000
$arg3     = 0x20f7c
>

$r0       = 0
$r1       = 0x24b5
$r2       = 0x800a664b
$r3       = 0x7b00dc58
$r4       = 0
$r5       = 0xa6
$r6       = 0x7b00dc5f
$r7       = 0x7afa9280
$r8       = 0x7afa9294
$r9       = 0x7b009928
$r10      = 0
$r11      = 0
$r12      = 0
$r13      = 0
$r14      = 0
$r15      = 0
$r16      = 0
$r17      = 0
$r18      = 0
$r19      = 0x7b007948
$r20      = 0x24b5
$r21      = 0x800bb820
$r22      = 0
$r23      = 0x20f7c
$r24      = 0x46000000
$r25      = 0x7ffe6000
$r26      = 0x7afa9280
$r27      = 0x4002b010
$r28      = 0
$r29      = 0x1
$r30      = 0x403f9d60
$r31      = 0x800a667b
$ret0     = 0
$ret1     = 0x1

>p *($pc - 16)\20i
0x800a6638  MTSP        1,0
0x800a663c  BE,N        0(0,2)
0x800a6640  BL  _fp_status+0028,2
0x800a6644  OR  0,0,0
0x800a6648  LDW -24(0,30),2
0x800a664c  LDSID       (0,2),1
0x800a6650  MTSP        1,0
0x800a6654  BE,N        0(0,2)
0x800a6658  BL  _fp_status+0008,1
0x800a665c  ADDIL       0xfff90000,1
0x800a6660  LDO 948(1),1
0x800a6664  BV,N        0(1)
0x800a6668  STW 19,-28(0,30)
0x800a666c  LDIL        0xc0000000,1
0x800a6670  BLE 4(7,1)
0x800a6674  LDO 37(0),22
0x800a6678  OR,=        0,22,0
0x800a667c  B   0xffffffdc
0x800a6680  LDW -28(0,30),19
0x800a6684  BV,N        0(2)

[8/9/94 public]
This is probably a result of a problem in the security refresh code
that occurs when dced isn't present. This should not cause the server
to crash with a core dump thus the ot. The priority reflects the fact that
the problem will only be seen if dced has previously died. It should 
probably also be against security but we'll leave it here since its
posible cds is has set something up incorrecly in the first place and
security already has more bugs than thay can handle anyway........

[9/14/94 public]
I am raising this to A0 and assigning to security.  I don't think dced
crashing has anything to do with it.  If you set the registry
so that creds expire in 5 minutes CDS will die in the refresh_identity
thread.  Since this thread doesn't do much but call sec_* I don't think
CDS is the problem.

[9/15/94 public]

I'm betting this is another of those cases where a login context
that has never been entered in the cache is being purged from the
cache, which causes the cache code to commit the entire process
to the nearest Asylum For The Contextually Deranged.

Since I'm going to be spelunking in the sec_login code for
other reasons, I'll see if I can fix this while I'm below ground.

[9/15/94 public]
Looks like it has already been fixed by security.  Verified in bl17.



CR Number                     : 11612
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : ntp provider
Short Description             : dts_ntp_provider fails to
start on a RIOS which is not running YP.
Reported Date                 : 8/9/94
Found in Baseline             : 1.1b14
Found Date                    : 8/9/94
Severity                      : C
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/9/94 public]


The following error is displayed during the configuration of
the NTP provider on a RIOS machine. 


        Enter the hostname where the NTP server is running: pooch
 S:****** Starting dts_ntp_provider...
 dtsprovider: UDP/NTP: service unknown
 S:****** This node now has an NTP time provider running.

If the RIOS machine is running YP, then the problem goes away.

[8/9/94 public]
This is not a DCE bug and should be canceled.  

If the machine does not have the
ntp service in its /etc/service file, it is not DCE's fault
that it cannot run an ntp based service.

Yp has nothing to do with it, its just that on our network,
the YP /etc/service database contains the correct ntp entries.

[8/9/94 public]

To shed some more light on this subject. 

The problem on the RIOS is that there _is_ an entry in the
/etc/services file for the ntp service. However, this file is never
being consulted by the getservbyname() call (the call returns a null
pointer) However, when YP is enabled on that machine, the call
succeeds.  I infer from this that the software believes (somehow) that
the machine is configured to run NIS (YP), althought 1) the NIS domain
name has never been set, and ypbind isn't running. 

So: no, this isn't a DTS bug: it's more properly a host configuration
error. I had hoped to find out what files an NIS compatible
getxxxbyxxx() checks to see if it should use the NIS services, but 
couldn't find it yet. 

Moral: if your dtsprovider fails with the above mesage, check your NIS
maps or /etc/services file.



CR Number                     : 11607
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : tcl
Short Description             : VARARGS not set to ANSI value
Reported Date                 : 8/8/94
Found in Baseline             : 1.1b14
Found Date                    : 8/8/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/8/94 public]
When compiling on the 486:

/project/dce/build/dce1.1/export/at386/usr/include/dce/tcl.h:515: warning: function declaration isn't a prototype
/project/dce/build/dce1.1/export/at386/usr/include/dce/tcl.h:630: warning: function declaration isn't a prototype
/project/dce/build/dce1.1/export/at386/usr/include/dce/tcl.h:666: warning: function declaration isn't a prototype

This looks to come from src/admin/tcl_dce/tcl.h:

  #   if defined(__cplusplus)
  #       define VARARGS ...
  #   else
  #       define VARARGS 	/* as nothing */
  #   endif

Seems like it should be 

  #   if defined(__STDC__) || defined(__cplusplus)

(Note: This is Tcl code and the DCE coding style guide doesn't 
 *necessarily* apply.)

[8/24/94 public]
Changed to E4.  This is Tcl's use of VARARGS instead of std args.
Technically a bad thing to do via the coding style guide, but Tcl is exempt
from the coding style guide (as is kerberos code) and the code works.  The
changes aren't hard, but aren't trivial either.

[9/19/94 public]
Deferred to 1.2.  There will probably be a new version of Tcl by then
anyway.

[2/14/96 public]
Cancel and hang on for new tcl.



CR Number                     : 11605
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : dce_config
Short Description             : interactive dce_config asks
for "Cell Administrator" on OSF1 but not on HPUX.
Reported Date                 : 8/8/94
Found in Baseline             : 1.1b14
Found Date                    : 8/8/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/8/94 public]

Using NB -

On an HPUX, runing dce_config interactively it asks:


        Enter desired principal name for the Cell Administrator:
(cell_admin) 
        Enter desired password for the Cell Administrator: 
        Re-enter desired password: 

on an OSF1, dce_config leaves these out. I have not tried on
RIOS.

Example:

On OSF1:
========

        Enter the name of your cell (without /.../): test1
S:****** Starting dced...
WARNING: If "dced" was recently running, and was using the TCP protocol
sequence to listen for calls to the server, then a TCP shutdown period of
up to 4 minutes is required before restarting "dced" in order to avoid
"cannot bind socket" errors.
        Press <RETURN> to continue, CTRL-C to exit: 
S:****** Initializing dced...
DCED listening...
        Enter keyseed for initial database master key: 

S:****** The current highest UNIX ID for persons on this node is 1417.
        Enter the starting point to be used for UNIX ID's that
        are automatically generated by the Security Service
        when a principal is added using "rgy_edit": (1517) 
S:****** The current highest UNIX ID for groups is 1000.
        Enter the starting point to be used for UNIX ID's that
        are automatically generated by the Security Service
        when a group is added using "rgy_edit": (1100) 

On HPUX:
========

        Enter the name of your cell (without /.../): test2
S:****** Starting dced...
WARNING: If "dced" was recently running, and was using the TCP protocol 
         sequence to listen for calls to the server, then a TCP shutdown
period
         of up to 4 minutes is required before restarting "dced" in order
to 
         avoid "cannot bind socket" errors.
        Press <RETURN> to continue, CTRL-C to exit: 
S:****** Initializing dced...
DCED listening...
        Enter keyseed for initial database master key: 


        Enter desired principal name for the Cell Administrator:
(cell_admin) 
        Enter desired password for the Cell Administrator: 
        Re-enter desired password: 

S:****** The current highest UNIX ID for persons on this node is 12338.
        Enter the starting point to be used for UNIX ID's that
        are automatically generated by the Security Service
        when a principal is added using "rgy_edit": (12438) 
S:****** The current highest UNIX ID for groups is 5000.
        Enter the starting point to be used for UNIX ID's that
        are automatically generated by the Security Service
        when a group is added using "rgy_edit": (5100) 
S:****** Starting secd...

[8/8/94 public]
This is not a bug, you probably have your CELL_ADMIN and CELL_ADMIN_PW
environment variables set on the OSF/1 machine.

[8/8/94 public]

Tom, you are right. The .profile in my home machine is not exactly 
the same as on the test machines. Sorry about that. I'll cancell this.



CR Number                     : 11590
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11629
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dts
Subcomponent Name             : dtsd
Short Description             : dtsd core dump caused by bad free()
Reported Date                 : 8/8/94
Found in Baseline             : 1.1b14
Found Date                    : 8/8/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/8/94 public]

dtsd dumped core on 3 of the six machines I was running tests on this
weekend.  Of the 3 machines, one was HP-UX, the other two were OSF/1.
The HP-UX yields a core that seems to point to a bad free().  

One of the OSF/1 core dumps was unusable, the other looked to be a dup,
but I'll include it here, just to be sure.

I know this probably isn't a dtsd problem, but I don't want to break
with tradition, so I'll open it under dtsd.

The HP core dump:

>t
0 free@libc + 0x00000008 (hp-ux export stub)
1 dce_svc__vfprintf@libdce + 0x00000364 (0x40010440, 0x1, 0x1, 0x7b03537c)
2 cma_lib_free@libdce + 0x00000148 (0x409f70c0, 0x3, 0x7b034efc, 0x2)
3 rpc__mem_free@libdce + 0x00000224 (0x409f70c0, 0x34, 0x7b0353c0, 0)
4 rpc_string_free@libdce + 0x0000004c (0x7b034f14, 0x7b034ef8, 0x1cb, 0x4000496c
)
5 PopulateCacheFromRPCprofile + 0x00000a08 (0x1, 0x4000f4c0, 0x4000f4e4, 0)
6 PopulateLocalCache + 0x00000028 (0x4000f4e4, 0x7b034808, 0x4000d4e8, 0x7b034d3
8)
7 Synchronize + 0x00001970 (0x4, 0x4095b070, 0x1000c, 0x210000)
8 ProcessEvent + 0x0000007c (0x4095b070, 0x400019f4, 0x19b, 0x40001a38)
9 main + 0x00000284 (0x2, 0x7b033ea0, 0, 0)
>

>lr $a
$arg0     = 0x409f70c0
$arg1     = 0x1
$arg2     = 0x40a0264c
$arg3     = 0x7b01278c
$arg3     = 0x7b01278c
>

>lr $r
$r0       = 0
$r1       = 0x24b5
$r2       = 0x800b27c3
$r3       = 0x7b0127b0
$r4       = 0x2
$r5       = 0x65722770
$r6       = 0
$r7       = 0x20707268
$r8       = 0xffffffd0
$r9       = 0
$r10      = 0
$r11      = 0
$r12      = 0x40003d38
$r13      = 0x1
$r14      = 0x2
$r15      = 0
$r16      = 0x402
$r17      = 0x40095cbc
$r18      = 0x400
$r19      = 0x7b007948
$r20      = 0x177dc000
$r21      = 0x800b27b8
$r22      = 0x7afebfd8
$r23      = 0x7b01278c
$r24      = 0x40a0264c
$r25      = 0x1
$r26      = 0x409f70c0
$r27      = 0x4000d320
$r28      = 0x177db009
$r29      = 0x409f70b8
$r30      = 0x7b035538
$r31      = 0x65722770
$ret0     = 0x177db009
$ret1     = 0x409f70b8

>p *($pc - 16)\20i
0x800b27b0  BV  0(2)
0x800b27b4  LDWM        -192(0,30),3
0x800b27b8  BL  _fp_status+0018,2
0x800b27bc  OR  0,0,0
0x800b27c0  LDW -24(0,30),2
0x800b27c4  LDSID       (0,2),1
0x800b27c8  MTSP        1,0
0x800b27cc  BE,N        0(0,2)
0x800b27d0  STW 2,-20(0,30)
0x800b27d4  STWM        3,192(0,30)
0x800b27d8  STW 4,-188(0,30)
0x800b27dc  STW 5,-184(0,30)
0x800b27e0  STW 6,-180(0,30)
0x800b27e4  STW 7,-176(0,30)
0x800b27e8  STW 8,-172(0,30)
0x800b27ec  STW 9,-168(0,30)
0x800b27f0  OR  26,0,4
0x800b27f4  STW 19,-32(0,30)
0x800b27f8  COMIBT,=    0,26,_fp_status+026c
0x800b27fc  OR  0,0,6

The OSF/1 core:

(gdb) where
#0  0xa434018a in sec_krb_decode_message_common
    (8194388, 2, 16292240, 16292252, 16292256, 16292336, 8194384, 8194248, 81942
84, 16292184)
#1  0xa436264a in sec_krb_cn_decode_message
    (8194388, 2, 16292252, 16292256, 16292336, 16292240, 16292184, 8194368, 8194
384, 16291908, 16291912)
#2  0xa4243bde in rpc__krb_cn_vfy_client_req
    (8329984, 4901688, 8364032, 1400, 0, 8194476)
#3  0xa420b25f in rpc__cn_assoc_process_auth_tlr
    (8329760, 5070880, 168, 5115936, 8194600, 8194592, 8330000, 0, 8329808)
#4  0xa4208cf1 in do_assoc_req_action_rtn (8329760, 5070848, 8329768)
#5  0xa420f255 in rpc__cn_sm_eval_event (100, 5070848, 8329760, 8329768)
#6  0xa4205927 in receive_dispatch (8329760)
#7  0xa4203484 in rpc__cn_network_receiver (8329760)
#8  0xa41ac3db in cma__thread_base ()
#9  0xa41b17cd in cma__create_thread ()
#10 0xa4202dd8 in rpc__cn_network_receiver ()
#11 0xa44bf998 in rpc_g_cn_assoc_lookaside_list ()
#12 0xa44bf998 in rpc_g_cn_assoc_lookaside_list ()
#13 0xb7c850 in sdb ()
#14 0x4b2f50 in sdb ()

[8/10/94 public]

Peter has told me that this occurred during a weekend series of tests,
where at least one machine ran out of swap space. For this reason, I'm
downgrading this to 1 priority 1 until we can reproduce this.

The HP core dump is suspiciously similar to a core dump obtained on
the RIOS (see CR 11629).

[8/16/94 public]

Peter can't reproduce this problem. With his agreement, I'm cancelling
this CR.



CR Number                     : 11589
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : server time checking is broken in dce_config
Reported Date                 : 8/8/94
Found in Baseline             : 1.1
Found Date                    : 8/8/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/8/94 public]


when configuring a client, dce_config tries to get the server's time. This
is done in function checktime. It telnets to the server for daytime. There
are a couple of places broken in the code:

1. dce_config checks client's local host's /etc/services to determine whether
the server machine have 'daytime/tcp" line in /etc/services file. If the local
/etc/services does not have daytime/tcp there, dce_config skips the time
check, even though the server may well be supporting daytime/tcp. For the same
reason, even though the client has daytime/tcp in its /etc/services, it does 
not mean that the server supports it.

2. dce_config builds command "telnet server_name daytime" to get the server
time. The standard "telnet" interface expects a port number, not a string name
for the service, though some OS (like AIX) does allow you to day the service
in name. To try out, do "telnet machine daytime" on an OSF/1 machine, you will
get "bad port number" error. But if you do it on AIX box, it will succeed 
(provided that the server you specify does support daytime/tcp).

3. Assuming you get the server time and local time, next is to get the time
difference in get_time_diff(). The array month[] in the awk script used to 
determine the number of days in any particular month is subscripted with 
abbreviated month names, but is called with numeric values. This results in 
all months having 0 days when adjusting negative times.
        ...
        diff_time_val=`echo $check_val | awk '\
                BEGIN \
                      { month["Jan"]=31; \
                        month["Feb"]=28; \
                        month["Mar"]=31; \
                        month["Apr"]=30; \
                        month["May"]=31; \
                        month["Jun"]=30; \
                        month["Jul"]=31; \
                        month["Aug"]=31; \
                        month["Sep"]=30; \
                        month["Oct"]=31; \
                        month["Nov"]=30; \
                        month["Dec"]=31; \
                      } \
        ...
                   if ( daydiff < 0 ) { \
                         daydiff += month[$8]; \
                         if ( ($7%4)==0 && $8==2 ) \
                                daydiff++; \
                         mondiff -= 1; \
                   }\
        ...


4. $mytimei and $svrtimei are built with leading zeros. If both systems
don't add leading zeros, incorrect conversion is done.

Say system A has time Thu Aug 04 13:48:36 1994 (one example is SCO UNIX. It
displays the date with a leading zero), which is converted to 1994804135604, 
and system B has time Thu Aug 4 13:48:39 1994, which is converted to 
199484134839. System B is the server and system A is the client being 
configured into the cell. The test

                if test $mytimei -lt $svrtimei
                then
                        sign="-1"
                        check_val=`echo $svrtimestr $mytimestr`
                        mesg="Time on $host is backward by "
                else
                        check_val=`echo $mytimestr $svrtimestr`
                        mesg="Time on $host is forward by "
                fi

does the wrong thing and you get output like:

                -1 years 11 months 30 days 23 hours 59 minutes 57 seconds

even though they are only 3 seconds off.

[8/8/94 public]

OK, I think I got confused a little bit. Checking local /etc/services is to
make sure that the string "daytime" in telnet command can be converted to
a port number. But since this port number is a well known one, why not just
use "13" instead? This way it will work for OSF/1 which does not have a
"daytime tcp" line in /etc/services. Then just check the return from telnet.
If the server machine does not support tcp daytime, you are out of luck
any way.

[8/8/94 public]
There are plenty of problems with this checktime stuff.
It is all going to be removed and replaced with a call to dts-time,
a dts based query of the security servers dtsd time server.

Canceled.



CR Number                     : 11574
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cdsd
Short Description             : cdsd fails to configure on AIX
Reported Date                 : 8/5/94
Found in Baseline             : 1.1b14
Found Date                    : 8/5/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/5/94 public]

During the multi-machine smoketest config, the cdsd on mudslide core
dumps silently such that the first command to try to use cds:

	cdscp create clearinghouse /.:/mudslide_ch

gets:

	connection closed (dce/rpc)

Core dump is not usable at all.

This has been reproduced twice - HOWEVER, the identical configuration
of cobbler, another rios, into the multi-machine smoketest cell
succeeded WITHOUT a cdsd coredump. Unconfig'ing, turning on svc and
reconfig'ing - then this one's yours John.

[8/5/94 public]
On the 3rd attempt to reproduce, blocked by:

S:****** Starting cdsadv...
**** Assertion warning. attempt to release mutex owned by another thread
     at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
  at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
  at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
  at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
 at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
    at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
 at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706
**** Assertion warning. attempt to release mutex owned by another thread
at line 2406 in /project/dce/build/dce1.1-snap/src/threads/cma_pthread.c pid = 12706

arrggh ...

[8/5/94 public]
4th attempt - still blocked by cdsadv assertion above - assigning to you
John - you'll probably want to open a separate bug for the cdsadv assertion
that may have something to do having serviceabilty on - routing file contains:

VERBOSE:FILE:/opt/dcelocal/var/svc/verbose
NOTICE:FILE:/opt/dcelocal/var/svc/notice
WARNING:FILE:/opt/dcelocal/var/svc/warning
ERROR:FILE:/opt/dcelocal/var/svc/error
FATAL:FILE:/opt/dcelocal/var/svc/fatal
cds:*.9:FILE:/opt/dcelocal/var/svc/debug

[8/8/94 public]
The problem here is that the smoke test was inadvertantly putting the
secondary machine in a bad state and dce_config was allowing it to 
happen. The unconfig option in dce_config only unconfigures the client,
it does nothing to the secondary server. We know that during configuration
a host must be configured as a client prior to being configured as a 
server. During unconfig the server should be unconfigured prior to
unconfiging the client entries. dce_config does do a check to make sure
the that there isn't a server on the machine its running on but that's
not the correct check. It should check the host that's being unconfig'd.
If a server exists on that host it should not proceed. 

I'll leave this open until I get a chance to fix the check in dce_config
but it won't be until I finish the threads serviceability at least. I'll
down grade it to an A1.

I'll talk to Gail to see if we can make the automated smoke test work 
given the limitation of unconfig on a secondary server host.

[8/9/94 public]

OT 11566 should not have been assigned to yesterdays DFS
Smoketest, OT 11574 (this one) should have.
So I am clarifiying that this ot 11574 should have been applied to 
yesterdays 8-8-94 DFS Smoketest on mudslide not ot11566. I am lowering
ot11566 to 1 and reassigning to baum.

[8/9/94 public]

Multi-machine smoke test failed to configure on the RIOS.
The test is a three machines cell with the at386 as the server
and the RIOS and the HP800 as the client.  

Configuration and testing were o.k. on both the AT386 and HP800 
platforms. 
On the RIOS platform, we got the following ERROR during configuration:

S:****** Configuring additional CDS Server...
S:****** Starting cdsd...
ERROR:   cdscp - creating clearinghouse /.:/mudslide_CH.
  Message from cdscp:
  connection closed (dce / rpc)
	Press <RETURN> to continue, CTRL-C to exit: 	Initializing the name space for additional CDS server...

>>> binding information and objects exported


>>> binding information and objects exported

	Modifying acls on /.:/mudslide_CH
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/mudslide_CH
	Modifying acls on /.:/hosts/mudslide/cds-server
	Modifying acls on /.:/hosts/mudslide/cds-gda
...

The smoke test never got to the DFS one hour read-write 
test because it did not configure successfully.  

An additional note is that initial configuraion i.e. the 
core smoke test was successful.

[8/9/94]

Using yesterday's NB, DCE fails to configure a one machine cell because
cdsd core dumps and prints the following errors. (this is related to the
errors Annie reported in the previous entry, but those were from the
replica).  So at this point, we are unable to configure a one machine
cell on a RIOS because of this problem.


        selection:  2
S:****** Configuring initial CDS Server...
S:****** Please wait for user authentication and authorization...



        Create LAN profile so clients and servers can be divided
        into profile groups for higher performance in a multi-lan cell ? (n) 
S:****** Starting cdsadv...
S:****** Starting cdsd...
1994-08-09-15:32:04.932-04:00I----- cdsd(9005) ERROR rpc recv cnrcvr.c 895 0x20129120
RPC_CN_AUTH_RECV_CHECK on server failed: received packet has an invalid checksum (dce / rpc)
1994-08-09-15:32:04.958-04:00I----- cdsd(9005) ERROR rpc auth cnassoc.c 2079 0x20129120
RPC_CN_AUTH_PRE_SEND on server failed: requested protection level is not supported (dce / rpc)
ERROR:   acl_edit - setting ACLs on /.:
  Message from acl_edit:
  ERROR: connection closed (dce / rpc)
Unable to bind to object /.:

[8/9/94 public]

To verify this problem, I started all over and re-configured. The problem 
is definitely there but the error reported had was slightly different.

        Create LAN profile so clients and servers can be divided
        into profile groups for higher performance in a multi-lan cell ? (n) 
S:****** Starting cdsadv...
S:****** Starting cdsd...
S:****** Setting ACLs for all new namespace entries...
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/sec-v1
ERROR:   acl_edit - setting ACLs on new namespace entries.
  Message from acl_edit:
  ERROR: connection closed (dce / rpc)
Unable to bind to object /.:/subsys/dce/sec
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/cell-profile

....
.....

[8/10/94 public]

PROBLEM MACHINE: Problem occured on RIOS system mudslide  rs6000/aix

CURRENT STATUS:	 This error is still blocking the multicell test

TYPE OF TEST:	 Multi cell test

CORE FILES ON: mudslide:./dcelocal/var/directory/cds/adm/cdsd/core

Configuration:	sif = sec and cds master, dts server
		budapest = sec replica, cds replica, dts server, dfs server
		mudslide = sec replica, cds replica, dfs client

Failed IN: 	dce_config

Output from log file /tmp/dce_config.log

S:****** Starting cdsd...
D:         Executing: cdsd
DEBUG:     Executing: modify_rcfile(cdsd)
V:         Successfully modified rcfile /etc/rc.dce for "cdsd"
DEBUG:     Executing: cds_replicate()
V:         Creating clearinghouse files and replica for root directory.
D:         Executing: cdscp create clearinghouse /.:/mudslide_CH
DEBUG:     Executing: chk_cdscp(cdscp - creating clearinghouse /.:/mudslide_C
H.)
DEBUG:     Executing: err_exit(cdscp - creating clearinghouse /.:/mudslide_CH
.
  Message from cdscp:
  connection closed (dce / rpc))
ERROR:   cdscp - creating clearinghouse /.:/mudslide_CH.
  Message from cdscp:
  connection closed (dce / rpc)
V:         User query: Press <RETURN> to continue, CTRL-C to exit:
V:         User entry:
DEBUG:     Executing: clean_and_remove(prompt)



Output from log file /usr/rrizzo/RAT_tools/do_test.dfs.log



S:****** Configuring additional CDS Server...
S:****** Starting cdsd...
ERROR:   cdscp - creating clearinghouse /.:/mudslide_CH.
  Message from cdscp:
  connection closed (dce / rpc)
        Press <RETURN> to continue, CTRL-C to exit:     Initializing the name space for add
itional CDS server...

>>> binding information and objects exported


>>> binding information and objects exported

        Modifying acls on /.:/mudslide_CH
ERROR: acl object not found (dce / sec)
Unable to bind to object /.:/mudslide_CH
        Modifying acls on /.:/hosts/mudslide/cds-server
        Modifying acls on /.:/hosts/mudslide/cds-gda
S:****** Configuring DTS Local Server...
S:****** Waiting for node self-identity to be established...
S:****** Starting dtsd...
S:****** This node is now a DTS local server.
S:****** Configuring DFS Client...
S:****** Loading kernel extensions...
SYS_KLOAD: A file or directory in the path name does not exist.
exec(): 0509-036 Cannot load program cfgdfs because of the following errors:
SYS_KLOAD: A file or directory in the path name does not exist.
exec(): 0509-036 Cannot load program cfgdfs because of the following errors:
S:****** Starting dfsbind...
dfsbind failed to start : There is a request to a device or address that does not exist.
S:****** Starting dfsd...
dfsd: failed to invoke the TKN server! (code 109)
S:****** Exiting from dce_config.

[8/11/94 public]
I was able to replicate this problem on three machine of the same flavors as
those used for the smoktest and without involvment of the smoketest shell 
scripts. I was however using the .cmd and .env files from the smoke test 
machines that get passed to dce_config. For those unfamiliar with these files
dce_config may be invoked as follows...

dce_config -c config.cmd -e config.env

config.cmd lists the installation and or configuration commands to be performed
while config.env sets all of the appropriate environment variables  that
may be needed by dce_config during the execution of those commands.

After reproducing the problem using the config scripts I attempted the same
configuration by hand. All three machines worked perfectly. I then brought in
a config.cmd and config.env from my own work station that I know work. I 
put them on all three of the test machines editing only the hostname and
ip address fields where appropriate. I set the .cmd files to do exactly the 
same configurations as the smoke test machine. It all worked.

At this point I think there is something in one of the smoketest config.env
files that's causing the rios not to configure properly. I'll retest in the
morning as a check to make sure it didn't 'just happen to work once'. If  
it still works  with my configuration files I'll track down what's wrong 
with the smoke test files.

[8/15/94 public]

I just finished the configuration of a two machine, RIOS only cell.  The
cell consists of a Cell server being the primary cdsd and secd.  The other
machine is a secrity replica and a secondary cds server.  Everything 
configured fine and is working fine.  I am using the BL13 build.

Should I try with another build?   Gerry Thome (512)838-2256

[8/15/94 public]
Yep. The bug was detected pretty much the day it was opened. The
smoke test was working prior to that. That places the problem after
8/5. BL13 was cut on 7/26. BL14 should fail. 

I was about to update this with more information. As I said above a change
to the configuration files caused the test to go from working to broken. It
wasn;t the change I was looking for however. I changed the cell name from
/.../john.qadce.osf.org to /.../john and it broke. I fipped back and forth
a few time just to be sure and its reproducable with the systems I'm
working with.  All I know is that the following messsage comes out in
the dce_config.log file on  the machine where the security replica and 
secondary cds server are being configured. cdsd then core dumps. 
The rios is wolfboy.

V:         Creating clearinghouse files and replica for root directory.
D:         Executing: cdscp create clearinghouse /.:/wolfboy_ch
DEBUG:     Executing: chk_cdscp(cdscp - creating clearinghouse
/.:/wolfboy_ch.)
DEBUG:     Executing: err_exit(cdscp - creating clearinghouse
/.:/wolfboy_ch.
  Message from cdscp:
  connection closed (dce / rpc))
ERROR:   cdscp - creating clearinghouse /.:/wolfboy_ch.
  Message from cdscp:
  connection closed (dce / rpc)
V:         User query: Press <RETURN> to continue, CTRL-C to exit:

The smoke test machines are configured is as follows.

486
comes up as a single cell machine and dts local server

HP
comes up as a security replica, secondary cds server, and a dts local
server 

RIOS
comes up as a security replica, secondary cds server, and a dts loca

I can reproduce the problem with the following.

486
comes up as a single cell machine

HP
comes up as a security replica, secondary cds server

Its not making a whole lot of sense.........

[8/15/94 public]
I was wrong about BL14. It was cut on 8/3 and probably doen't exhibit the
problem. 

I talked to Bob Whitehurst and he will put it on his list. Assigning it
to him.

[8/23/94 public]

I am on the correct build (14.3) and I cannot repro this.  Here is
what I tried.

1) create an initial cell server on a machine (cds server, sec server)
2) create a secondary cds server adn security replica on a second machine
3) create another secondary cds and security replica on a RIOS, this 
   should fail.

I only have RIOS machines and  this does not fail in a RIOS only
environment.  Any sugggestions?

[gthome public]

I noticed in the build log today that the multi-machine smoketests
passed on the RIOS.  Does this mean that this defect is fixed???

[gmd public]
Gerry - no, the config of a secondary cds server on the RIOS was
temporarily removed since it was blocking the rest of the smoketests.
There is a significant DFS submission going in today that I would
like to have smoketested but if there are no objections, I can re-enable
the secondary cds server on the RIOS for Thursday am.

[bmw public]
I just configured 16 without experiencing this problem. However, I
was not able to configure the dts local server before configuring the
cds secondary. Would this matter?

[gmd public]
No - I don't believe this is related - thanks for the detail though -
apparently some other people are seeing dts problems with 16 (although
I was able to configure 3 local servers, 1 on a RIOS, w/ 16 fine). Since
you aren't seeing the problem w/ RIOS-only cells and we were w/ hetero
cells, I can only guess this is an interop problem. Adjusting the
smoketest now - we'll see what happens.

[bmw public]
I tried to configure a cell with a long cellname as specified by John
Dugas in his comments on 8/15 and did not encounter any problems. I
normally configure a cell with a short cellname and have not encountered
this problem. If I reconfigure again I will try with a short name.

[gmd public]
I successfully configured a cds replica on a RIOS w/ bl-17 BUT you
must use the dce_config submitted 9/9 (one day AFTER bl-17 was cut)
otherwise, regardless of platform, you'll hang during the config.
George is going to repeatedly configure dts local servers (CR 11939)
and cds replicas on RIOS using bl-17 to give us confidence in downgrading
or canceling this CR.

[gmd public]
Canceling - this one just disappeared - not seen in the smoketest or
with the script George is using. Other cds problems are being seen but
they are not RIOS specific and are covered in other CRs.



CR Number                     : 11572
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : kdc or cryptosystem
Short Description             : integrity/decrypt errors on remote ptgt
Reported Date                 : 8/4/94
Found in Baseline             : 1.0.3a
Found Date                    : 8/4/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/4/94 public]
  The main motivation behind this bug report is to see if it's been seen
before. I fear that it might have to do with 1.0.2a/1.0.3a intercell
compatibility. We're looking at it here full-time; we're going to start
picking apart the server to see what exactly is failing to decrypt
properly. David VanRyzin (vanryzin@transarc.com) has been examining the
checksumming changes between the two releases and is suspicious, but
lacks hard proof at this moment. I attended IFEST and can attest that we
didn't test cross-cell authentication across the 102/103 release
pairing.
.
  We're having a boatload of odd problems with intercell security issues
here. Sporadically, two cells which are trust partners cannot access
each other; while trying to obtain the PTGT via the TGT, the Kerberos
reply is invariably that a decryption failed. The request appears to be
using the wrong key, the key appears to being misused, or the
construction of the packet is corrupting it along the way.
.
  A dbx trace (of limited info) follows. An authenticated user
(cell_admin@mandos.dce.transarc.com) attempts to bind to a registry
server within /.../systest.dce.transarc.com . Of course, this works if
it is tried from an unauthenticated process, but not when tried form
an authenticated one. It isn't gdad/BIND this time.
.
  I'd like to add (finally) that this is NOT an instance of the key
having been changed on only one host. A pair of cells can show this
problem before and after a reuse of the rgy_edit 'cell' command. Maual
setting of the accounts' keys also does not make this go away.
.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Running: /bin/rgy_edit -s /.../systest.dce.transarc.com
(binding_cache_lookup) Looking for site /.../systest.dce.transarc.com, cell , princ dce-rgy, type 1
(binding_cache_lookup) Cache miss
(rca_site_bind) bumping ref on identity 10c9b0
(rca_site_bind_nsi) Attempting to bind to site /.../systest.dce.transarc.com
(rca_site_bind_nsi) import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../systest.dce.transarc.com
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==110358
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../systest.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../systest.dce.transarc.com/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@systest.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity 10c9b0, handle 110358
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 90 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
   90       if (!krb5_principal_compare(tgt->client, cred->client))
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 93 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
   93       if (!tgt->ticket.length)
(dbx)
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 97 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
   97                                 krb5_princ_realm(cred->client), &tempprinc))
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 100 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  100       if (!krb5_principal_compare(tempprinc, tgt->server)) {
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 104 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  104       krb5_free_principal(tempprinc);
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 113 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  113                                  tgt, &tgsrep))
(dbx) list 105,125
  105
  106
  107       if (retval = krb5_send_tgs(kdcoptions, &cred->times, etype, sumtype,
  108                                  cred->server,
  109                                  tgt->addresses,
  110                                  cred->authdata,
  111                                  0,               /* no padata */
  112                                  0,               /* no second ticket */
  113                                  tgt, &tgsrep))
  114           return retval;
  115
  116   #undef cleanup
  117   #define cleanup() {(void) free(tgsrep.response.data);}
  118
  119       switch (tgsrep.message_type) {
  120       case KRB5_TGS_REP:
  121           break;
  122       case KRB5_ERROR:
  123       default:
  124           if (!krb5_is_krb_error(&tgsrep.response)) {
  125               retval = KRB5KRB_AP_ERR_MSG_TYPE;
(dbx) next
continuing l@1
(binding_cache_lookup) Looking for site /.../systest.dce.transarc.com, cell /.../systest.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Cache miss
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../systest.dce.transarc.com
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==1109b0
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../systest.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../systest.dce.transarc.com/subsys/dce/sec/master
(rca_site_bind) Bound to Cell '/.../systest.dce.transarc.com'
(rca_site_bind) Bound to Site '/.../systest.dce.transarc.com/subsys/dce/sec/master'
(rca_lock_handle) locking 112280
(rca_unlock_handle) unlocking 112280
(rca_site_bind) String Binding  '0014c954-048e-1d97-aeaa-9e620d02aa77@ncadg_ip_udp:158.98.13.2[]'
(binding_cache_enter) Adding 112280 to binding cache: site /.../systest.dce.transarc.com/subsys/dce/sec/master cell /.../systest.dce.transarc.com princ (null) type 0
(rca_lock_handle) locking 112280
(rca_check_binding) checking 112280
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking 112280
(rca_lock_handle) locking 112280
112280: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 112280
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 119 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  119       switch (tgsrep.message_type) {
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 124 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  124           if (!krb5_is_krb_error(&tgsrep.response)) {
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 127 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  127               retval = decode_krb5_error(&tgsrep.response, &err_reply);
(dbx) next
continuing l@1
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 128 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
  128           if (retval) {
(dbx) print err_reply
err_reply = 0x10fe78
(dbx) print *err_reply
*err_reply = {
    ctime  = 776034009
    cusec  = 0
    susec  = 933168
    stime  = 776034010
    error  = 31
    client = (nil)
    server = 0x113ac0
    text   = {
        length = 43
        data   = 0x110a60 "Decrypt integrity check failed (dce / krb)"
    }
    e_data = {
        length = 0
        data   = (nil)
    }
}
(dbx) cont
continuing all LWPs
(rca_setup_handle) end set_auth_info identity 10c9b0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1412901f
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==110a60
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../systest.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../systest.dce.transarc.com/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@systest.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity 10c9b0, handle 110a60
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 90 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
   90       if (!krb5_principal_compare(tgt->client, cred->client))
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in krb5_send_tgs at line 314 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/send_tgs.c"
  314                                &rep->response);
(dbx) cont
continuing all LWPs
(binding_cache_lookup) Looking for site /.../systest.dce.transarc.com, cell /.../systest.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at 112280: site `/.../systest.dce.transarc.com/subsys/dce/sec/master' cell `/.../systest.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 112280
returning cached context 112280
(rca_lock_handle) locking 112280
(rca_check_binding) checking 112280
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking 112280
(rca_lock_handle) locking 112280
112280: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 112280
(rca_setup_handle) end set_auth_info identity 10c9b0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1412901f
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) failed, status 16c9a0b5
(rca_nsi_binding_import) attempting to re-import
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../systest.dce.transarc.com
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==10ffa0
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../systest.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../systest.dce.transarc.com/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@systest.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity 10c9b0, handle 10ffa0
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/pr
oject/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/pr
oject/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
ct@1 (l@1) stopped in krb5_get_cred_via_tgt at line 90 in file "/afs/transarc.com/proj
ect/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
   90       if (!krb5_principal_compare(tgt->client, cred->client))
(dbx) ont
continuing all LWPs
t@1 (l@1) stopped in krb5_send_tgs at line 314 in file "/afs/transarc.com/proj
ect/dce/dev/rel/10.012/src/security/krb5/lib/krb/send_tgs.c"
  314                                &rep->response);
(dbx) cont
continuing all LWPs
(binding_cache_lookup) Looking for site /.../systest.dce.transarc.com, cell /...
/systest.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at 112280: site `/.../systest.dce.transarc.com/subsys/dce/sec/master' cell `/.../systest.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 112280
returning cached context 112280
(rca_lock_handle) locking 112280
(rca_check_binding) checking 112280
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking 112280
(rca_lock_handle) locking 112280
112280: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 112280
(rca_setup_handle) end set_auth_info identity 10c9b0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1412901f
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
cont(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==110870
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../systest.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../systest.dce.transarc.com/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@systest.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity 10c9b0, handle 110870
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx)
continuing all LWPs
t@1 (l@1) stopped in sec_priv_get_ptgt at line 233 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/client/rca/priv.c"
  233       unsigned_char_p_t      tcell = NULL;
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in krb5_get_cred_via_tgt at line 90 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/gc_via_tgt.c"
   90       if (!krb5_principal_compare(tgt->client, cred->client))
(dbx) cont
continuing all LWPs
t@1 (l@1) stopped in krb5_send_tgs at line 314 in file "/afs/transarc.com/project/dce/dev/rel/10.012/src/security/krb5/lib/krb/send_tgs.c"
  314                                &rep->response);
(dbx) cont
continuing all LWPs
(binding_cache_lookup) Looking for site /.../systest.dce.transarc.com, cell /.../systest.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at 112280: site `/.../systest.dce.transarc.com/subsys/dce/sec/master' cell `/.../systest.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 112280
returning cached context 112280
(rca_lock_handle) locking 112280
(rca_check_binding) checking 112280
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking 112280
(rca_lock_handle) locking 112280
112280: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 112280
(rca_setup_handle) end set_auth_info identity 10c9b0
(rca_setup_handle) rpc_binding_set_auth_info returned status 1412901f
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) failed, status 16c9a0b5
(rca_site_bind_pe_site) calling get_site_bindings
(rca_get_site_bindings) about to open config file
(rca_get_site_bindings) Trying again with canonical name /.../systest.dce.transarc.com
(rca_site_bind_pe_site) assuming /.../systest.dce.transarc.com is string binding
(rca_lock_handle) locking 10e3f0
10e3f0: Dropping site refcount from 1 to 0
Drop ref to identity 10c9b0 from binding cache
(rca_unlock_handle) unlocking 10e3f0
?(rgy_edit) Unable to open the registry at site "/.../systest.dce.transarc.com"
- Registry server unavailable (Registry Edit Kernel) (dce / sad)
execution completed, exit code is 84
program exited with 84
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

[8/9/94 public]
  rgy_edit allows the cell keys to become out of synch, and resetting
the keys by using the advised method of rerunning the cell command
simply advances the key versions on both sides of the fence without
verifying that the versions match. Local fix (in David VanRyzin's hands
now) will be to compare the obtained new key version numbers and
comaplin if they do not match. This, for us, requires a new ek_ error
code; we will add padding in hopes to avoid collisions with V1.1-added
ek_ error codes.
  There is no evident encryption skew here, so the defect (as originally
filed) is cancelled. Due to prevailing likelihood that any
rgy_edit-related defect (filed w.r.t. the problems with 'cell' not
comparing the kvno values) being closed due to the existence of dcecp,
none will be filed.
Changed Status from `open' to `cancel' 
Filled in Responsible Engr. with `travis' 
Filled in Resp. Engr's Company with `tarc'



CR Number                     : 11566
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : core smoketest
Short Description             : rpc_binding_set_auth_info() fails in cdsclerk at config time
Reported Date                 : 8/5/94
Found in Baseline             : 1.1
Found Date                    : 8/5/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/5/94 public]
iS:****** Starting secd...
1994-08-05-08:33:54.685+00:00I----- secd ERROR sec rs_ns rs_ns.c 1197 0x0070a870
name service unavailable

S:****** Starting sec_clientd...
S:****** Waiting for node self-identity to be established...
S:****** Initializing the registry database...


S:****** Configuring CDS Server...
1994-08-05-08:34:54.011+00:00I----- secd ERROR sec rs_ns rs_ns.c 1197 0x0070a870
name service unavailable
S:****** Starting cdsadv...
S:****** Starting cdsd...
1994-08-05-08:36:45.442+00:00I----- cdsclerk(727) ERROR cds general clerk_bind.c
 486 0x004e5658
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-08-05-08:36:46.252+00:00I----- cdsclerk(727) ERROR cds general clerk_bind.c
 486 0x004e5658
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-08-05-08:36:51.572+00:00I----- cdsclerk(727) ERROR cds general clerk_bind.c
 486 0x006de0f0
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-08-05-08:39:42.309+00:00I----- cdsd(726) ERROR cds general unix_cds_net.c 8
18 0xa4489cb8
Routine rpc_ns_binding_export(3rpc) failed: status = 382312662.
1994-08-05-08:39:42.319+00:00I----- cdsd(726) FATAL cds server dns_service_ncl.c
 317 0xa4489cb8
Cannot export bindings to clearinghouse.
ERROR:   cdsd failed to start

[8/8/94 public]
I asked the rats to assign this to sec because it seems to be a
failure of rpc_ rpc_binding_set_auth_info causing the problem. We've
been seeing this occassionally lately. I sometimes see it when having 
problems with intercell. The rpc status appears to be bogus. I checked 
the cds code to make sure its properly declared and it is.  Usually cdsd 
comes up fine and the rats restarted the configuration this morning and it 
worked fine. I'll talk to Rob this morning. I'd really like to know if this 
may be related to any known and existing security problems. Since it does 
not appear often and the rats don't see it on reconfig I'm not sure it
should be an A0 but we won't change it until I have a chance to talk to
Rob.  Since we have been seeing this occasionaly lately I don't believe
it related to anything that came in yeesterday.

[8/5/94 public]

I think the status codes from rpc_binding_set_auth_info() are valid:

--> dce_err 336760839
Tech = 1 = 01 = 0x1 = dce
Comp = 16681 = 040451 = 0x4129 = krb
Mesg = 7 = 07 = 0x7 = Server not found in Kerberos database

--> dce_err  382312662
Tech = 1 = 01 = 0x1 = dce
Comp = 27802 = 066232 = 0x6c9a = rpc
Mesg = 214 = 0326 = 0xd6 = not registered in endpoint map

The first one makes me feel a little uncomfortable.
Was this smoketest done with dced or rpcd?  Can we try again with
rpcd?

[8/5/94 public]
The smoke test was done with dced.  I just want to point out that
the second time we ran this we got a different, less servere failure
with secd.  Hence the smoke test was able to continue and pass.  The
error encountered was:

...
S:****** Starting secd...
1994-08-05-09:01:59.873-04:00I----- secd ERROR sec rs_ns rs_ns.c 1197 0x007
0a870
name service unavailable
S:****** Starting sec_clientd...
S:****** Waiting for node self-identity to be established...
S:****** Initializing the registry database...
1994-08-05-09:03:00.018-04:00I----- secd ERROR sec rs_ns rs_ns.c 1197 0x007
0a870
name service unavailable


S:****** Configuring CDS Server...
S:****** Starting cdsadv...
S:****** Starting cdsd...
1994-08-05-09:04:03.243-04:00I----- secd ERROR sec rs_ns rs_ns.c 1197 0x007
0a870
entry not found
S:****** Setting ACLs for all new namespace entries...
S:****** Configuring DTS Local Server...
...

thanks
annie

[8/8/94 public]
I discovered after my update that the status is in fact what Rob says.
I believe the above message from secd 'name service unavailable' is just
secd saying the name service isn't up yet which of course is true. 
I assume secd then waits until it is up. Not sure it should put out
an ERROR message in this case though.

[8/8/94 public]

Lowering the Priority to 1 from 0, since this does not happen often and r
re-configuring solves the problem.

[8/8/94 public]

I don't believe we have a handle on this problem. It again blocked the
multi-machine config smoketest today and there was no reconfiguring
mentioned. The multi-machine smoketest was passing regularly before and
is now NOT passing regularly. Can the RATs please update this bug
with all pertinent information ie. all the circumstances leading up
to the bug, the contents of /tmp/dce_config.log, pointers to all the
scripts and logs involved, info about what scripts have changed lately,
etc. Thanks.

[8/8/94 public]

Using the NB, I tried to configure DCE on OSF1 and HPUX, each one as a
core server. On both platforms, the message "name service unavailable" 
is printed every few seconds, never stopping. The error message does 
not go away after reconfiguring. (I have configured at least 3 times.) 

This CR should be an A0. The error either is  bogus and should not be
printed, or it is a serious one and should be fixed. We are reaching 
a point where there are too many new error messages being printed.
It is getting difficult to keep track of which messages we should 
ignore and which we should not.

The error on OSF1 is:

name service unavailable
1994-08-08-14:25:22.006-04:00I13.871 secd ERROR sec rs_ns rs_ns.c 1197
0x0070a5f0


On HPUX:

1994-08-08-14:26:03.020-04:00I----- secd ERROR sec rs_ns rs_ns.c 1197
0x4004ac60
name service unavailable

[8/78/94 public]
The message will appear from the secd during config until the point that
the cdsd has come up properly.  At that point, it should go away.  If the 
message continues to come out, it is a problem.  I will open a seperate OT
suggesting that the message not be output or that it be output at a level
other tham svc_c_sev_error.

The thing that defines this OT is the rpc_binding_set_auth_info() calls
in the cdsclerk failing.  I am going to run the smoktest over a number of
times in an attempt to isolate when this occurs since it is sporadic.

[8/8/94 public]

The two cells I configured have been printing this message
for over 2 hours. A message is being printed every minute.

[8/8/94 public]
As Rob mentioned above, the rs_ns name service unavailable message is not
the problem this CR is addressing, it's a side effect of some other svcability
work that has happened (which I happened to take issue with earlier here
today before even seeing this).  Please let us know if you see the
rpc_binding_set_auth_info() message and the state of the cell when that happens
(ie: Can you dce_login from another window, can you run rgy_edit -v ?, can
you see secd's endpoints with rpccp show mapping?)  Just ignore the rs_ns
name service unavailable warnings until I can convince someone here to get rid
of them.

ps: I added dce-ot-sec@apollo.hp.com to the CC list because we haven't been
getting automatic mailing of OT CRs for a few days (I found this CR by
accident while trying to figure out why we weren't getting email on CR's in
general).

[8/8/94 public]
Failed 3 times in a row for me on 'sif' twice with dced and the 3rd
time with rpcd.  Funny. because it has never occurred on my 486.  Although,
probably not  significant to this problem, the OSF/1 Kernel on 'sif' is 
REV osc1.2 b? (yes, question mark).  An odd version number.

Each time (after setting BIND_PE_SITE 1) the operations dce_login. rgy_edit
& display of SEC endpoints (macthing PE_SITE file) work OK.

What does the 'Server not found in kerberos database' message from
set_auth_info() mean anyway?  The same list of principals exists in
the RGY as on a successfully config'ed system.

[8/8/94 public]
Ran with cdsclerk which contains debug output describing 
parameters passed to rpc_binding_set_auth_info().  3 consecutive
successful configures before machine became unuseable due to
nightly build kickoff.  Will retry tomorrow.

[8/8/94 public]
Peter has not seen this problem happen in last two days. After talking with
several folks here, I'm lowering the priority to 1 for now. If this happens
again in the smoketest we will investigate further.

[8/9/94 public]
This is a good one.  I think this comes down to a configuration problem but
want to get some feedback as to how it might be happening.

The test is running on a single machine cell whose machine name is 
'sif'.  Whenever the rpc_binding_set_auth_info() fails, we display the 
principal name being passed in and it references the CDS Server principal
from another machine 'budapest', ie

    /.../sif_cell.osf.org/hosts/budapest/cds-server, NOT
    /.../sif_cell.osf.org/hosts/sif/cds-server

rgy_edit shows that this budapest principal is (correctly) not in the
registry on 'sif' so the error message we get about 'server not in kerberos 
database' is  in fact correct.  This principal name was gotten in the same 
code (cds_clerk.c) from an rpc_mgmt_inq_server_principal_name() call.  I 
haven't backtracked the code to find out how it got the RPC handle it
is passing to the _inq_() call but that binding is where the trouble must
be starting.

We're calling it a config problem because the machine 'budapest' is running
as part of a multi_machine cell on the same LAN of which 'sif' was a host.
The cell names are identical (sif_cell) and the multi-machine cell still thinks
'sif' is a member (it was not unconfig'ed).  This is bad and we need to
look at the smoketest process to understand why this happens.

A good question is how the single machine sif_cell got information about
'budapest' which it should know nothing about.  The multi-machine sif_cell must
be throwning it over the wall somehow (cdsadv?, CDS replica skulk?) and the
single machine cell is not ignoring it.  

This seems like an easy way to break someones cell.  Do we have some kind of
subtle Security gap here?

[8/24/94 public]
I've encountered this problem twice in a row now while attempting to run
the gds_sec FVT on a 486.  Here are the specifics:

- using rpcd as the endpoint mapper
- configuring a cell with an X.500 name: /c=ie/o=digital
- binaries from BL16 and NB0823

This is blocking me.

[8/24/94 public]
Forgot to add:  this is what's running on my machine:

  PID     ELAPSED        TIME  RSS   VSZ %MEM PAGEIN NSWAP COMMAND
25301        7:29     0:02.14 920K 9.29M  2.5     86     4 rpcd
25593        7:20     0:07.87 1.09 11.9M  3.0    242     4 secd
23816        6:53     0:01.43 180K 9.82M  0.5      4     3 sec_clientd
25714        6:13     0:02.00 1.64 10.6M  4.5     35     3 cdsadv
25414        6:08     0:00.20   0K 8.89M  0.0     33     0 cdsd
25876        6:07     0:02.88 1.26 11.4M  3.5     42     3 cdsd
25713        6:06     3:11.49 3.50 12.9M  9.7     60     3 cdsclerk

[9/23/94 public]

Haven't seen for along time but there is no reason to believe it 
is gone.

[9/23/94 public]
I'm not sure abotu the 9/24 entries from Rich Z., but I'm pretty sure
the initial problem with the smoketest was a setup problem (as described
in my entry from 8/9).  

The setup problem (not removing a machine from a cell and re-configing that
machine on the same LAN as a cell with the same name) triggered unusual 
behaviour which I would actually more likely attribute to CDS than SEC.

[9/23/94 public]
That's 8/24 that Rich updated this CR, not 9/24.  Has he really been blocked
by this for a month now?  If not then why is this severity A?  If it's
causing anybody problems then why haven't we heard any more on this?  If the
whole purpose of this CR is to complain about rpc_ns_ routines returning
"name service unavailable" (the other problem RobB already explained) then
why was this reassigned to security?  Enquiring minds want to know.

[9/23/94 public]
Mike, I (as well as Rob Baum) agree. Reassigned to CDS.

[9/23/94 public]
I don't disagree with any of the above but I can explain and correct one
thing: 
 * blocking someone affects priority not severity.  Sev A just says its a
   major problem without a workaround.
 * Rich has been on vacation for 2 weeks now, with another week to go.  So
   I can believe he's still blocked and is just not complaining about it.
   Now if someone is blocked but isn't here, do they still hear the tree
   fall in the forest? :-) IOW: should it be a P0?  And guess what, it's
   not anymore.

[9/23/94 public]
The original problem as Rob pointed out may have been a configuration
problem although we could not at the time understand how it was resulting in
the message. Then we didn't see it for awhile. The priority was dropped to a 
1 and the bug was left  belonging to CDS because I had put some 
instrumentation in clerk_bind.c to tell us what the principal was the next time
we saw it. I was about to cancel it a few weeks ago when sure enough
it showed up again. Since then it has shown up but only rarely. Every time 
we see it  on a machine that also has my printf the principal going
in made sense. The call just fails for some reason. We haven't seen it
in a couple of weeks but I'm  not convinced its gone. If the arguments going
into the call are valid I don't know how this can be CDS. I was with Bob
when we reassigned it to security and lowered the priority to 2. Know
one ever said it was blocking anyoone. It wasn't so it was a 1. It was an
A because the work around was to restart something. As far as I'm concerned
if we don't see this in the next week or so we'll cancel it. The problem
is that every time I talk about canceling it someone hits it so this 
conversation virtually guarentees someone will get hit by this bug within
a day or two. It could on the other hand have been the result of some generic
problem that has been fixed recently in which case the evil spirit
will have been banished and we will get rid of this bug in a few days. I'll
leave it with CDS at least until I see it again or it gets cacncelled.

[9/29/94 public]
I've received this error for the last two days. (BL19.1 and now BL20) In
both cases this has been related to configuring a cell with an X.500 name.
I'm bumping the priority because I'd really like someone to take another
look at this.


  TET - Test Environment Toolkit for testing GDS/Admin on a local machine
  TestSuite = gds_sec

Configure DCE using cell_name:  C=ie/O=digital
1994-09-29-11:03:51.687-04:00I----- cdsclerk(28769) ERROR cds general clerk_bind.c 490 0x007139d8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
1994-09-29-11:03:52.417-04:00I----- cdsclerk(28769) ERROR cds general clerk_bind.c 490 0x007139d8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 336760839.
Login to DCE ...

This can't be a "configuration problem."  This is occuring in TETized tests
which have run correctly in the past.

FYI:  could this be related to 12389 (x500_str_to_cell doesn't work.)

[09/29/94 public]
Rich Zeliff: Does this only happen with X.500 cell names? Don't you get
any error with "normal" cell names? (the switch_typeless tests)

[9/29/94 public]
I don't know.  I never configure cells with typeless names.  ;-)

[9/29/94 public]
Bumped to 0 because I've seen this a couple more times today.  This seems
to be fairly frequent.

[9/29/94 public]
Changing back to a 1, with some chagrin.  Realized that I was running two
cells with the same name, which may have contributed to problem.  (Cell
name is hardcoded in a TET test, so if you run the same test on two
machines at once ....)

I am running a script which does iterative cell configurations and I will
let this go overnight.

[9/29/94 public]
The duplicate cell name was part of what I thought to be the 'configuration
problem' attributed to the smoketest failures which started this OT.
Therefore, maybe the problem is back to a 'configuration problem pointing
out a potential security problem caused by CDS talking between cells of the
same name'

I also thought one of the machines has to have been part of the first cell
and then removed (without unconfigure'ing) it into its own cell of the
same name.  Is this the case with your machines?  If not, then the
likelihood this will affect real users is much greater than thought.

[9/29/94 public]
The GDS FVTs create single machine cells of the same name.  They never
create multi-machine cells so machines are never removed from membership in
other cells.  It is possible that, through iterative executions of the same
test, that a cell is re-configured on the same machine without properly
unconfiguring the previous cell.  (The dce_config script reports that it
successfully removed all reminants of the previous configuration, 'though.) 

This cellname duplication isn't the whole answer, however; Ron Arbo and I
encountered this problem yesterday in a cell which had the machine name as
part of the cell name, and so was unique.

[9/30/94 public]
Not being able to leave well enough alone, here's more information.
 
I have a single-machine 486 cell named /c=us/o=osf/ou=dce/cn=gemini.  I've
established GDS intercell to another single-machine 486 cell named
/c=us/o=osf/ou=dce/cn=haven.
 
Basic unauthenticated access works.  (From the gemini cell I can 'cdscp
show dir' on haven's root dir.)
 
However, attempting this as machine principal:
 
root@gemini dcelocal/bin$ cdscp show dir /.../c=us/o=osf/ou=dce/cn=haven

                        SHOW
                   DIRECTORY   /.../c=us/o=osf/ou=dce/cn=haven
                          AT   1994-09-29-20:40:07
global_server_princ_name /.../c=us/o=osf/ou=dce/cn=haven/hosts/haven/cds-server
1994-09-29-20:41:36.108-04:00I----- cdsclerk(18458) ERROR cds general clerk_bind.c 491 0x007592a8
Routine rpc_binding_set_auth_info(3rpc) failed : status = 387063931.
Error on entity: /.../c=us/o=osf/ou=dce/cn=haven
Registry server unavailable
Function: dnsEnumAttr
 
Secd is running on the haven cell. (and in the gemini cell, for that
matter.) 
 
I'm using Dugas's printf-ized cdsclerk, which has printed the name of the
principal which rpc_binding_set_auth_info was using.

[9/30/94 public]
Encountered again.  /c=us/o=osf/ou=dce/cn=gemini (486) ->
/c=us/o=osf/ou=dce/cn=falcon (HP).

gemini users/zeliff$ dce_login cell_admin dce
gemini users/zeliff$ cdscp show dir /.../c=us/o=osf/ou=dce/cn=falcon         

                        SHOW
                   DIRECTORY   /.../c=us/o=osf/ou=dce/cn=falcon
                          AT   1994-09-30-12:07:54
Error on entity: /.../c=us/o=osf/ou=dce/cn=falcon
Registry object not found
Function: dnsEnumAttr

global_server_princ_name /.../c=us/o=osf/ou=dce/cn=falcon/hosts/falcon/cds-server
1994-09-30-12:07:58.476-04:00I----- cdsclerk(19653) ERROR cds general clerk_bind.c 491 0x004e6980
Routine rpc_binding_set_auth_info(3rpc) failed : status = 387063930.
global_server_princ_name /.../c=us/o=osf/ou=dce/cn=falcon/hosts/falcon/cds-server
1994-09-30-12:07:58.756-04:00I----- cdsclerk(19653) ERROR cds general clerk_bind.c 491 0x004e6980
Routine rpc_binding_set_auth_info(3rpc) failed : status = 387063930.
global_server_princ_name /.../c=us/o=osf/ou=dce/cn=falcon/hosts/falcon/cds-server
1994-09-30-12:08:00.885-04:00I----- cdsclerk(19653) ERROR cds general clerk_bind.c 491 0x004e6980
Routine rpc_binding_set_auth_info(3rpc) failed : status = 387063930.
global_server_princ_name /.../c=us/o=osf/ou=dce/cn=falcon/hosts/falcon/cds-server
1994-09-30-12:08:01.215-04:00I----- cdsclerk(19653) ERROR cds general clerk_bind.c 491 0x004e6980
Routine rpc_binding_set_auth_info(3rpc) failed : status = 387063930.

Previously, the unauthenticated use of the 'show cell' command had worked.

gemini users/zeliff$ cdscp show dir /.../c=us/o=osf/ou=dce/cn=falcon
You do not have any network credentials. All requests will be unauthenticated.

                        SHOW
                   DIRECTORY   /.../c=us/o=osf/ou=dce/cn=falcon
                          AT   1994-09-30-12:07:31
            RPC_ClassVersion = 0100
                     CDS_CTS = 1994-09-30-15:25:19.234360100/08-00-09-24-88-59
                     CDS_UTS = 1994-09-30-15:33:08.411059100/08-00-09-24-88-59
              CDS_ObjectUUID = b904b468-dc6a-11cd-bcc8-080009248859
                CDS_Replicas = :
          Clearinghouse UUID = b82000d4-dc6a-11cd-bcc8-080009248859
                       Tower = ncacn_ip_tcp:130.105.4.217[]
                       Tower = ncadg_ip_udp:130.105.4.217[]
                Replica type = master
          Clearinghouse Name = /.../c=us/o=osf/ou=dce/cn=falcon/falcon_ch
                 CDS_AllUpTo = 0
             CDS_Convergence = medium
                CDS_InCHName = allowed
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk = 1994-09-30-15:25:19.234360100/08-00-09-24-88-59
              CDS_LastUpdate = 1994-09-30-15:33:08.411059100/08-00-09-24-88-59
                   CDS_Epoch = b904b03a-dc6a-11cd-bcc8-080009248859
          CDS_ReplicaVersion = 3.0
             CDS_GDAPointers = :
                     Timeout = :
                  Expiration = 1994-09-30-11:33:08.350
                   Extension = +1-00:00:00.000I0.000
          Clearinghouse UUID = c9172678-dc6b-11cd-946b-080009248859
                       Tower = ncacn_ip_tcp:130.105.4.217[]
                       Tower = ncadg_ip_udp:130.105.4.217[]
                Replica type = gda
          Clearinghouse Name = /.../c=us/o=osf/ou=dce/cn=falcon/falcon_gda

Minor note:  these two machines are on different subnets.

[10/4/94 public]
The smoke test hit this this morning. cdsd failed with the same error
but without my printf. I've done everything I can with this but I'm at
Rajendra's disposal if he can think of anything I can investigate from
cds's end. The smoke test generated a CR, 12483, at a priority 0 so I'm
raising this.

[10/4/94 public]
I forgot, I'm also assigning it to security. Rajendra let me know if
you want some instrumentation checked in to track this.

[10/4/94 public]
The RATS were able to re-configure the 486 single machine cell
successfully. Lowering the Priority to 1 from 0, since this does not happen
often and re-configuring solves the problem.

[10/4/94 public]
Cancelling this CR. Re-opening CR 12483 and a new CR will be created for
intercell/X.500 rpc_binding_set_auth_info failure situation.



CR Number                     : 11554
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : rgy_edit infinite loop
Reported Date                 : 8/3/94
Found in Baseline             : 1.1b13
Found Date                    : 8/3/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - adressed in DCE1.2.2.

[8/3/94 public]

rgy_edit handles some errors from password management server as
continue on error. The example is if a principal has a pwd_val_type
ERA of 1 or more but no pwd_mgmt_binding ERA. It does not treat
the error as fatal and will continue in an infinite loop prompting
for user's name, group and org.

Should be simple code fix but workaround is to use dcecp to
get generated passwords.

[8/8/94 public]
This is not a rgy_edit error.  rgy_edit intentionally loops and lets you
respecify information on error (Greg added this specifically per customer
requests...).  It cannot decide what's a warning, what's an error and what's
fatal, so it prompts you again.  If you don't want to keep going, you can
either enter an empty name field or just control-c out of the subcommand.
rgy_edit isn't going to have any real changes to it from now on (just dcecp)
and this isn't that big a problem (not a problem at all if you can control-c
out of it), so I'm cancelling this one.

[8/9/94 public]
Oops, the above didn't mention a minor detail that I was just made aware of.
rgy_edit is not displaying the error that it's getting from the passwd gen
stuff before it loops, so this CR is open again because that would be too
confusing for an admin to figure out on their own...



CR Number                     : 11544
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : server
Short Description             : Exception: status 177db035 (dce / thd)
Reported Date                 : 8/3/94
Found in Baseline             : 1.1b13
Found Date                    : 8/3/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/3/94 public]

Restarting CHO cell (split sec - cds servers) with /etc/rc.dce(.1's and .2's
to handle synchronization), I've hit the following just once:

1994-08-03-10:25:36.778-04:00I----- dtsd ERROR dts dtserror dtss_service_global_set.c 459 0x200ab8f8
Couldn't get remote server's principal name: communications failure (dce / rpc)
1994-08-03-10:25:36.913-04:00I----- dtsd WARNING dts config logevent_v_ultrix.c 259 0x200ab8f8
Too few servers (1), need 3 servers
Exception: status 177db035 (dce / thd)

Using dbx on core file:
[memory image in /opt/dcelocal/var/adm/time/core]

segmentation violation in unnamed block $b1 at line 255 in file "utc_adjtime_user.c"

(dbx) where
unnamed block $b1, line 255 in "utc_adjtime_user.c"
user_utc_adjtime(mode = endadjust, argblk = (nil)), line 255 in "utc_adjtime_user.c"
utc_adjtime(modeflag = endadjust, argblk = (nil)), line 88 in "lclcalls.c"
AdjustClkEnd(0x2ff7eedc, 0xc34) at 0x1002e6c0
Synchronize(0x2, 0x20157668) at 0x100267c8
ProcessEvent(0x20157668) at 0x100006a4
main(0x2, 0x2ff7fd14) at 0x100004b8

[8/4/94 public]

Quick preliminary investigation sez ..

177db035 ==>

Tech = 1 = 01 = 0x1 = dce
Comp = 30683 = 073733 = 0x77db = thd
Mesg = 53 = 065 = 0x35 = Object referenced does not currently exist

Call appears to be a result of the utc_writelock() call from line 255
in utc_user_adjtime(). May be calling cma_lock_global()? Otherwise,
no other calls to the threads package appears in the module; it uses
semaphore operations instead.

[8/15/94 public]

Re-assigning this one to IBM to look at.

[8/23/94 public]
I have not been able to reproduce this problem. I tried several
different methods of stopping and starting dce but I was never able
to get dtsd to dump core. These tests were done using the 16 build.

[8/29/94 public]
Exception: status 177db035 (dce / thd)

Seen again today with 16.2 - first time seen again during my last
2 weeks of testing however so not easy to reproduce on demand. New
stack trace is:

root@cobbler> dbx /opt/dcelocal/bin/dtsd core
dbx version 3.1 for AIX.
Type 'help' for help.
reading symbolic information ... 
[memory image in core]

abort process in cma__abort_process at 0xd033c0d8
0xd033c0d8 (cma__abort_process+0x4c) 80410014          l   r2,0x14(r1)
(dbx) where
cma__abort_process(0x6) at 0xd033c0d8
exc_raise(0x2ff7de10) at 0xd033ac98
exc_raise_status(0x177db035) at 0xd033ad74
cma__error(0x177db035) at 0xd0312a3c
cma__validate_handle(0x20166e80, 0x3) at 0xd0322f70
ptdexc_mutex_lock(0x20166e80) at 0xd0392254
release_cached_ccall(0x20161088) at 0xd04ebf90
rpc__dg_binding_free(0x2ff7e0b8, 0x2ff7e0b0) at 0xd04ec204
rpc__binding_free(0x2ff7e0b8, 0x2ff7e0b0) at 0xd03624fc
rpc_binding_free(0x2ff7e0b8, 0x2ff7e0b0) at 0xd0362700
PopulateCacheFromRPCprofile(0x1, 0x200c2e40, 0x200c2e64) at 0x1002613c
PopulateLocalCache(0x100282d0) at 0x100257b4
Synchronize(0x4, 0x2015ca18) at 0x100282d0
ProcessEvent(0x2015ca18) at 0x100005d8
main(0x2, 0x2ff7f98c) at 0x100004bc

[8/29/94 public]

Groan. These symptoms look familiar. There was a previous core dump
with this same signature, but the error was discovered earlier in the 
freeing sequence. We originally suspected a trashed binding handle
begin returned from the rpc_ns_binding_xxx() call. 

Sure looks like memory corruption to me. And in different places, to
boot

[8/30/94 public]
IBM getting the core file in AFS cell as soon as I'm given permission
to the directory. Note that this bug seems 
only to occur on restart and that the cell is split server. After
this failure, restarting dtsd works fine. Note that other/different
problems with dts are being seen on the HP and the audit code is
suspected there (currently). You may want to try linking with and
without audit code once you've reproduced this CR - note that audit
code IS linked in by default with bl-16.2. (If you haven't been building
that way, that may explain the difference in symbol tables).

[8/30/94 public]
Although -laudit is specified when building dtsd, the audit code 
is *not* turned on in bl16.2. This requires that the symbol
DCE_AUD_POINTS be defined as a compile time constant; this isn't done 
right now as far as I know. Am I wrong about this?

[8/30/94 public]
Probably not - guess I misunderstood - adding zeliff and rousseau
to the interest list for confirmation.

[9/01/94 public]
I have the core file and although dbx doesn't seem to give me the
proper stack traceback, I have been examining the stack by using the
stack trace listed above. Nothing conclusive yet. I am still
investigating.

[9/1/94 public]
If the audit code points aren't compiled in, then nothing should be calling
the audit API.  I don't think the problem lies in audit.

[9/12/94 public]
Apparently the core file didn't contain the heap where thread info
would be - bummer. George is going to work in a cell here to try to
reproduce - probably restarting dts w/in dbx to catch what's going
on.

[9/20/94 public]
Is this still seen?  Any status?

[9/20/94 public]
I have been running BL18 since 9/18 and it hasn't dumped core yet.
I ran BL17 on two machines for 1 week without having dtsd dump core.

[9/20/94 public]
George and I only got 1 dts core dump during on-site week.
Unclear whether it was this CR or the other dts core dump one
since the core dump was not useful.

[10/3/94 public]
I believe this was a problem with the user-mode libutc not getting
initialized correctly.  There were certain situations where someone
(in this case libaudit?) calls utc_gettime() before dtsd does,
which sets up access to the shared memory segment to be read-only.
This *could* be related, but seeing as this hasn't been seen
recently (bl-19 or later), perhaps the fix for the previous
problem helped in this case.

Canceled.  Please re-open if exception seen again.



CR Number                     : 11508
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11405
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : intermittent failure to return a binding from a group entry
Reported Date                 : 8/1/94
Found in Baseline             : 1.1b13
Found Date                    : 8/1/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[8/1/94 public]

During a 48 hour run of DCDREL001, 4 passes out of 111 failed with
one or more test servers never being accessed by the test clients.
Given the design of the test, this would appear to have been due to
the test servers successfully exporting their bindings to the
namespace and successfully adding their individual object entries
to a group entry, but then not being found on an import from the 
group entry. Since the expiration age is set to 0 for the import
context which the test clients use to import the server bindings,
I believe that proper cache operation should not be causing this
problem.

[9/14/94 public]
See response to 11405. Could be the same issue.

[08/20/96 public]
I'm cancelling this OT since Janet gave a plausible response in 11405
and no verification occurred.



CR Number                     : 11505
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : rgy_utils.c  and cdscp_utils.c need to include dce_utils.h
Reported Date                 : 8/1/94
Found in Baseline             : 1.1
Found Date                    : 8/1/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/1/94 public]

cdscp_utils.c and rgy_utils.c need to include dce_utils.h to get the
function prototype for dce_strdup().

[8/1/94 public]

OT 11500 11501 - done and submitted this morning.



CR Number                     : 11504
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : dtsd failing on a 1.0.3 client
Reported Date                 : 8/1/94
Found in Baseline             : 1.1b13
Found Date                    : 8/1/94
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/1/94 public]

I am making this an A0 because compatibility is P0 .... 

Cell Configuration:

OSF1 (raven)  : 1.1 secd, dtsd
HPUX (bronze) : 1.1 cdsd, dtsd
OSF1 (tahiti) : 1.0.3 client, dtsd, ntp_provider

Build: BL-13

The 1.0.3 client configures successfully. However, the dtsd server
on the 1.0.3 client keeps reporting the following message:

root@tahiti> (RPC_CN_AUTH_VFY_CLIENT_REQ) on server failed status =
1412901f

To which the 1.1 dtsd servers seem to reply with:

root@bronze> 1994-08-01-12:26:01.824-04:00I13.594 dtsd ERROR dts dtsdate
time_request.c 658 0x4002ed58
RPC call ClerkRequstTime() to remote server failed: decrypt integrity check
failed (dce / rpc)

Could this be related in some way to 11419?
Does the ntp provider on the 1.0.3 machine be a problem?

Needless to say that the 1.1 servers complain that there are only
2 dtsd servers in the cell. dtscp subcommands work.

[8/1/94 public]

The 1.1 server is attempting to issue a ClerkRequestTime() API call to
get the time from the (1.0.3) server, which fails with "decrypt
integrity check" error. This is a security and/or RPC problem: in any 
case, there is nothing that DTS will do differently to make this work.

Re-assigning to security.

[8/1/94 public]

I am lowering the priority of this bug to the lowest because
it appears that when the cell is re-started the problem subsides. 
I know there is something new and flaky about this mixed cell,
but before I raise the priority I need to work with the cell more 
to gather more information.

[8/22/94 public]
Martha, when you get a chance, could you try to reproduce this again now
that there's been some compatibility fixes made to 1.1 (ie: use at least bl15
for the 1.1 side).  I thought A0 was too high, but E4 seems too low for a
compatibility problem like this.

[09/02/94 public]

I had forgotten about this problem. I have not used this configuration for
CHO. I will try this again after this weekend CHO.

[10/05/94 public]
Martha, is this still a problem?  Have you had a chance to try it again?

[10/07/94 public]

I run this configuration last weekend and did not see this problem.
I am going to cancel this. Gail Marie and I are the only ones running
this configuration, so if this shows up again, we will re-open this 
CR.



CR Number                     : 11485
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dcecp: communication failure on non-centrail trail
Reported Date                 : 7/29/94
Found in Baseline             : 1.1b13
Found Date                    : 7/29/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/29/94 public]

I created a non-central trail on clam with the audit API.
Then I wanted to view the trail with the dcecp,
However I am getting a communications failure.

# dcecp -c audtrail show /tmp/auditd_trail
Error: communications failure

The audit trail is correct because if I try an auditcp
from bl-8 the trail prints out fine.

The trail is on clam in /tmp/auditd_trail

[8/2/94 public]
A communications failure message comes from the RPC runtime stating
that it could not contact the server. This would not be a dcecp bug
in itself. I beleive that if you retried the command it would
succeed. 

dcecp should be more robust in the case of network problems or
servers going away. Downgraded to a D3. dcecp should try to
rebind to a server if an RPC fails.

[8/2/94 public]

I retried the command  (dcecp -c audtrail show /tmp/auditd_trail)
and it failed again.  I don't think it is acceptable to downgrade the bug.
Put the bug back as a B1.
One of our system tests fail because of this bug (audrel001).
This test was working for many weeks with dcecp before
and now it is failing.

[8/2/94 public]
This problem is only reproducable on clam. The version of DCE running
has several known problems with cds. 

The problem is not limited to auditrail show, all audit commands fail.
dcecp is unable to contact auditd.

I cannot reproduce this on my machine. Try upgrading to the bl-12.6 lgb.

It works fine. I'll leave this CR open until you get a chance to use
more recent code.

[8/2/94 public]
This problem IS reproducable on other machines.
I just reproduced it on dce1 (an HP) running bl-13.

Do the following on dce1 (or clam for that matter).

1) As cell_admin, start auditd with auditd -a -t /tmp/auditd_trail
2) If you try dcecp -c audtrail show /tmp/auditd_trail it
   will fail with a communications error
3) If you cd /project/dce/build/dce1.1-baseline/bl-8/install/hp800/opt/dce1.1/bin and run dcecp -c audtrail show /tmp/auditd_trail it will print out the trail.

This demonstrates that I could print out the trail with dcecp on bl-8
but I cannot print out the trail now.

[8/2/94 public]
Can you do any other aud commands? Like 'aud show' or 'audevents cat'?
Do any of the server's if respond, ie. 'acl show /.:/hosts/clam/audit-server'?

[8/2/94 public]

With any baseline prior to bl-13  'aud show' or 'audevents cat' work.
However with bl-13, I am getting communications failure.
Why did this work prior to bl-13 and not work now?
This is the reason the test is failing.

root@dce1> pwd
/project/dce/build/dce1.1-baseline/bl-12/install/hp800/opt/dce1.1/bin
root@dce1> dcecp 
dcecp> audevents cat
dce_audit_filter_modify
dce_audit_filter_query
dce_dts_mgt_modify
dce_dts_mgt_query
dce_dts_synch
dce_dts_time_provider
systest
dcecp> aud show
{state enabled}
{stostrategy stop}

[8/2/94 public]
After talking to Bruce, we agree that this is not an audit or dcecp
problem. It seems to be one of the CDS problems we were seeing last week.
Bruce is upgrading to the lgb (12.6) and will retry.

[8/2/94 public]

Still fails on stcroix (486 machine) with lgb (12.6)
John is investigating.

[8/3/94 public]
This sounds like it *could* be a symptom of the endpoint map problems we've
been having with dced.  Bruce:

 * Are you using dced?
 * What build?
 * Does the problem still occur if you use rpcd as the endpoint map?

Just started catching up on bugs today and made possible connection with
other problems people are having.

[8/5/94 public]

Didn't get a chance to try this till today.

 * Are you using dced?

Yes 

 * What build?

Fails with any build bl-13 or greater
Works with any build (using dcecp or auditcp) before bl-13

 * Does the problem still occur if you use rpcd as the endpoint map?

Yes, I used rpcd as the endpoint map and the problem still occurs.

[8/10/94 public]

This problem still happens on bl-14 as well.
I have written a small testcase which reproduces the problem,
the testcase is on my machine clam in the directory ~bhaim/audit/audtry.
There is a README which goes along with the testcase.

[8/10/94 public]
This is an endpoint problem. auditd does not seem to be cleaning up
it's endpoints even when it is nicely stopped. Running rpcd (and
waiting a few minutes between restarts) clears up the problem. The
communications failures and connection request rejected messages are
caused by dcecp looking up old endpoints in the endpoint map. I'll
dup this to the correct dced bug when I get a chance to look it up, 
and open up a bug against the audit daemon when I can prove that it 
really isn't cleaning up correctly.

[8/12/94 public]
This problem is cancelled because the symptoms are covered by other
CR's. CR 11642 fixes the auditd problem.



CR Number                     : 11477
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : dced
Short Description             : server create/delete allows unauthenticated operation
Reported Date                 : 7/28/94
Found in Baseline             : 1.1
Found Date                    : 7/28/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/94 public]

The "server create/delete" commands allow an unauthenticated user to 
create and delete server entries at will. 

For "server delete" the user should have 'd' acl permission on
/.:/hosts/machine_name/config/srvrconf . This does not appear to be 
enforced.

[7/28/94 public]
The enforcement is not on the dced cmd rather than on the acl(s).
Yes, the initial acl(s) permits everything to unauthenticated user
and any_other. It's up to administrator to do whatever [s]he wants.
If you prefer other than this, please talk to Rich. I'm cancelling 
this one.



CR Number                     : 11475
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Error with socket
Reported Date                 : 7/28/94
Found in Baseline             : 1.1
Found Date                    : 7/28/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/94 public]



Output from /tmp/dce_config.log from DFS Smoketest




DEBUG:     Executing: err_exit(cdscp error while initializing the name space
           for DFS.
             Message from cdscp:
             create dir /.:/subsys/dce/dfs
           Error on entity: /.../sif_cell/subsys/dce/dfs
           Error with socket
           Function: dnsCreateDir

           add entry /.../sif_cell/subsys/dce/dfs/bak
           export -o 8ff29f40-a97f-11cd-9240-080009253315
           /.../sif_cell//dfs/bak
           quit)

[7/28/94 public]
Couldn't reproduce - error APPEARS to have been the inability
for cdsadv to recognize the existence of OR to spawn a clerk
for dfs - but cdsadv was running fine when I got to it, as were
a couple of clerks - I was able to spawn a new clerk too. Will
keep an eye out for it - lowering priority to a 1.

[8/24/94 public]
Cancelling - never seen again.



CR Number                     : 11473
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : dce_config
Short Description             : DFS Smoketest Errors in dce_config
Reported Date                 : 7/28/94
Found in Baseline             : 1.1
Found Date                    : 7/28/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/94 public]


During the DFS Smoketest the following errors
occured.

DEBUG:     Executing: chk_acl_edit(Error while modifying client ACLs in the 
DEBUG:     Executing: chk_acl_edit(Error while setting ACLs on /.:)
DEBUG:     Executing: chk_acl_edit(Error while setting ACLs on new namespace 
DEBUG:     Executing: chk_acl_edit(Error while modifying ACLs on security 
DEBUG:     Executing: chk_acl_edit(Error while modifying client ACLs in the 
           for DFS.)
DEBUG:     Executing: chk_acl_edit(Error while setting ACLs on /.:)
DEBUG:     Executing: chk_acl_edit(Error while setting ACLs on new namespace 
DEBUG:     Executing: chk_acl_edit(Error while modifying ACLs on security 
DEBUG:     Executing: chk_acl_edit(Error while modifying client ACLs in the

[7/28/94 public]
Odd ... all acl_edit commands appear to have been successful, despite
these error messages. Repeating acl_edit commands by hand succeeds and
no error codes are returned ... annoying but apparently cosmetic ... Note
that not ALL acl_edit commands are returning this, just some. The next
step is to enhance dce_config to save and report exactly what error acl_edit
THINKS it's getting.

[7/28/94 public]
Wait a minute... These are *not* errors, they are DEBUG messages
that don't come to the screen, but get written in to
the log file.  The "Error while..." message is the argument
to the chk_acl_edit() function in dce_config.  Its what it
will print out *if* there is an error.

There are no errors here, canceling this defect.



CR Number                     : 11472
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : libaudit
Short Description             : need a way to have multiple related processes share an audit trail
Reported Date                 : 7/28/94
Found in Baseline             : 1.1
Found Date                    : 7/28/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/94 public]

However, we see a need to have a way for related daemons to store their 
audit information in a common file, that isn't the central trail file.  
The central trail potentially has too many processes writing to one place 
- the signal to noise ratio would be unacceptable.  Having each process 
write to it's own individual file quickly becomes an administrative nightmare
to keep track of all of the files.

[03/06/96 public]
As discussed today at project manager meeting, we'll not support this OT
due to the design limitation of the audit function.



CR Number                     : 11430
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditcp/dcecp
Short Description             : audtrail show to a file creates an
output file with bad permisssions
Reported Date                 : 7/25/94
Found in Baseline             : 1.1
Found Date                    : 7/25/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/25/94 public]

Just wanted to enter this one so that you can make sure this doesn't
happen with dcecp...

The output file is created as:

----------   1 root     sys       410221 Jul 23 19:46 audit_trail_dump.sat

[7/25/94 public]
auditcp is dead. Long live auditcp. Cancelled.

dcecp creates the output file with read perms for the creator, thanks
to CR 11179.



CR Number                     : 11405
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : rpc_ns_group_mbr_add fails intermittently
Reported Date                 : 7/23/94
Found in Baseline             : 1.1b11
Found Date                    : 7/23/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/23/94 public]

The system test DCDREL001 fails intermittently because attempts
to add a server object to a group entry in the namespace (using the
call rpc_ns_group_mbr_add )sometimes fail. The group entry in the 
namespace is deleted at the start of the test, and the call 
rpc_ns_mgmt_set_exp_age is used to set the expiration age to 0 
before making the rpc_ns_group_mbr_add call, in case old cached 
information would otherwise interfere.

The status returned is "entry already exists (dce / rpc)". If the
group entry is examined during a failing test pass, (using the 
dcecp command "rpcgroup list <entry>") the entry that "already exists" 
is not listed. 

In the current test configuration 4 application servers are
started, each registering one unique entry name and adding that 
name to a shared group entry.  In a recent test run the error 
occurred in 1/3 of the test repetitions.

[9/14/94 public]
If you have CDS replicas of the entry it is possible that the removes
have not propagates to the server you talk to on the read.  If
the parent directory is replicated, you will have to skulk it after modifies
to ensure all replicas have the new data added or removed.

[08/20/96 public]
I'm cancelling this OT since Janet gave a plausible explanation and
no response was given.



CR Number                     : 11380
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : tcl
Short Description             : tetexec.cfg vars are not defined
Reported Date                 : 7/21/94
Found in Baseline             : 1.1b13
Found Date                    : 7/21/94
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/21/94 public]
Variables set in tetexec.cfg are no longer available in the tests.
A recent change must have broke this.

Is it Friday yet?

In the tests, in order to access global variables, you need to
put a

global VAR_NAME

statment at the top of the proc.



CR Number                     : 11367
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_rgy_site_open() does not allow unauthenticated access with string binding specification.
Reported Date                 : 7/20/94
Found in Baseline             : 1.1b12
Found Date                    : 7/20/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/20/94 public]

I'm using sec_rgy_site_bind_query() as a work around, but using 
sec_rgy_site_open() used to work also.

[8/9/94 public]
This should never have worked:  The sec_rgy_site_open*() calls use default
authentication levels which would require you to be authenticated.  The correct
thing to do to bind unauthenticated is to use the sec_rgy_site_bind* calls
(note: sec_rgy_site_bind_query() is obsolete since it is no different than
sec_rgy_site_bind() ).  Cancelled this CR.



CR Number                     : 11360
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : install_appdev
Short Description             : symlink for libdce.a is wrong on HP
Reported Date                 : 7/19/94
Found in Baseline             : 1.1
Found Date                    : 7/19/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/19/94 public]

install_appdev installs on HP-UX the static libdce.a in /opt/dcelocal/lib.
But it sets a symbolic link from /usr/lib/libdce.a to
/opt/dcelocal/usr/lib/libdce.a.

The fix is to change the lines

                log_msg DETAIL "Executing: ln -s $DCELOCAL/usr/lib/libdce.a /us
r/lib/libdce.a"
                ln -s $DCELOCAL/usr/lib/libdce.a /usr/lib/libdce.a > /dev/null
2>&1

to

                log_msg DETAIL "Executing: ln -s $DCELOCAL/lib/libdce.a /us
r/lib/libdce.a"
                ln -s $DCELOCAL/lib/libdce.a /usr/lib/libdce.a > /dev/null
2>&1

[8/24/94 public]
Since HP just submitted changes to not build libdce.a, I am going
to remove all this code that installs libdce.a.
Canceled.



CR Number                     : 11351
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11564
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cds set dir to new epoch master results in two masters
Reported Date                 : 7/18/94
Found in Baseline             : 1.1
Found Date                    : 7/18/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/18/94 public]

Invoking the cdscp command set directory to new epoch master does not
change the current master directory to the new node.

Build: BL-11

Cell: HPUX: sec server, cds server
      OSF1: client, cds replica
      OSF1: client, cds replica

On the HP server the following commands are invoked:


dce_login cell_admin -dce-

cdscp create directory /.:/admindir

cdscp set directory /.:/admindir CDS_Convergence = high

cdscp create object /.:/admindir/adminobj

cdscp create replica /.:/admindir clearinghouse /.../admin_cell/admintest2_ch

cdscp set directory /.:/admindir to new epoch master /.:/admintest2_ch exclude /.:/admintest1_ch

cdscp show replica /.:/admindir clearinghouse /.:/admintest2_ch CDS_Epoch CDS_ReplicaType
                        SHOW
                     REPLICA   /.../systest/admindir
                          AT   1994-07-18-16:41:45
                   CDS_Epoch = ad4bfa62-a26a-11cd-ab5d-0800093251fc
             CDS_ReplicaType = readonly

(The show replica command can be run on any of the cell nodes with the
same result.)

[7/19/94 publib]
I checked - this isn't blocking anyone in system testing. We will get
to it soon but not today. Its a B1.

[8/3/94 public]
Fixed.  Table size was incorrectly modified, messing up opcode.

[8/4/94 public]

The set dir to new epoch command now results in two masters.

The output after the set dir to new epoch command:

(original master)
cdscp sho replica /.:/admindir clearinghouse /.:/brandy_ch  CDS_Epoch \
CDS_ReplicaType
                        SHOW
                     REPLICA   /.../systest/admindir
                          AT   1994-08-04-10:15:27
                   CDS_Epoch = 7e705424-af92-11cd-823c-0800093251fc
             CDS_ReplicaType = master


(new epoch master)
cdscp sho replica /.:/admindir clearinghouse /.:/aruba_ch CDS_Epoch \
        CDS_ReplicaType
                        SHOW
                     REPLICA   /.../systest/admindir
                          AT   1994-08-04-10:17:12
                   CDS_Epoch = 1a1aad88-af94-11cd-b1b4-0000c07ad04c
             CDS_ReplicaType = master

[8/4/94 public]
Please cancel this.  This is how it works.  New epoch should be used to
change the master or to exclude replicas that are off-line and will most likely
not ever be back.  What you have is not a good idea.  New epoch was
mostly designed for disaster recovery.

[8/4/94 public]

More fun with masters and replicas.  An excluded master should not be 
referenced once excluded.  The cds replica checklist test will be changed
to reflect this.

CR #11564 has been created to track the changes.



CR Number                     : 11337
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : keytab
Short Description             : Import the keyfile /krb5/v5srvtab causes dced core dump
Reported Date                 : 7/17/94
Found in Baseline             : 1.1
Found Date                    : 7/17/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/17/94 public]

Dced core dumps on importing the system default keyfile 
/krb5/v5srvtab.

[7/26/94 public]
Not reproducible on 486 or HP.  Ping can't make it happen either.
Perhaps some inconsistency having to do with the security drop a week
and a half ago...
Canceling.



CR Number                     : 11336
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : api
Short Description             : dced binding need lock to ptotect its local cache
Reported Date                 : 7/16/94
Found in Baseline             : 1.1
Found Date                    : 7/16/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/16/94 public]
Dced binding need implement lock to protect its local cache 
because an application has no way to know about the local cache
kept in each of dced binding and may use the binding on
conflict operations simultaneously.

[07/18/94 public]
I thought we decided that dced bindings were not designed to be used in
multiple threads.  I believe this should be cancelled.

[08/26/94 public]
So let it be written, so let it be done.



CR Number                     : 11329
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : bad error msg when doing unauth remote rpc
Reported Date                 : 7/15/94
Found in Baseline             : 1.1b11
Found Date                    : 7/15/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/94 public]
When trying to do a remote operation on auditd without proper authentication,
the following error is returned.

dcecp> audf create {principal rousseau} -at {dce_dts_synch all all}
Error: audit daemon serving RPC number -1541818356

After authenticating properly, the operation succeeds.

[7/15/94 public]
Slap. I was picking up an old message catalog. Cancelled.



CR Number                     : 11326
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : file
Short Description             : multi-machine smoke test failed
Reported Date                 : 7/15/94
Found in Baseline             : 1.1
Found Date                    : 7/15/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/94 public]

The multi-machine smoke test failed.  The baseline used was 
DCE1.1-bl12.

The failure in the log file is:

    ... Exiting wait_and_see
    dfs.read_write_all.main FAILED
    Exiting /dcetest/dcelocal/test/systest/file/dfs.read_write_all.main with 1 - program terminated at Fri Jul 15 13:45:18 EDT 1994

The smoke machines are:
    sif, budapest and mudslide

The whole test will take ~ 3hours to recreate, we do not have
the time to recreate this again today.  So, if you want to debug
this, then be aware that the machines will be rebooted at 3 am 
daily.  

We have proven that the problem is NOT with our process.  The 
set up is:

    1) reboot sif
    2) mount bl-12 on /mnt on sif
    3) run core dce_config on sif

    4) reboot budapest
    5) mount bl-12 on /mnt on budapest
    6) run core dce_config on budapest

    7) reboot mudslide
    8) mount bl-12 on /mnt/tailor on mudslide
    9) run core dce_config on muslide

   10) run do_test.dfs on budapest

   11) run do_test.dfs on mudslide 

Let me know if you need more information.  

thanks
annie

[7/15/94 public]
Yes, I need more information. Can you please tail the /tmp/logs/*.log files
on the machine where dfs.read_write_all.main is run? Thanks.

[7/15/94 public]
I believe this may be a machine setup problem,unrelated to DCE or
DFS. I had to add each machine to each other's /.rhosts file
so that remote shells that the test relies on could work ... I'm
still having trouble doing a remote shell/dce_login -c command
from mudslide to budapest ...

[7/29/94 public]
The multi-machine smoketest passed yesterday once the workaround
for CR 11423 was done by hand. Unclear what the problem was that
caused the mult-machine smoketest to fail before 11423 was introduced
but I'm canceling this since we've had a successful run.



CR Number                     : 11324
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : undefined symbols in build
Reported Date                 : 7/15/94
Found in Baseline             : 1.1b11
Found Date                    : 7/15/94
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/94 public]
I haven't been able to build dcecp since this morning. The recent 
security drop seems to have caused this. What new code am I missing?

rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_SET_USE_DEFAULTS" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_UNSET_USE_DEFAULTS" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_SET_RESERVED" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_UNSET_RESERVED" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_UNSET_MULTI_INST" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_SET_MULTI_INST" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_SET_UNIQUE" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_UNSET_UNIQUE" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_IS_SET_USE_DEFAULTS" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_IS_SET_RESERVED" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_IS_SET_MULTI_INST" referenced
rgy_utils.o: Undefined symbol "_SA_SCH_FLAG_IS_SET_UNIQUE" referenced

[7/15/94 public]
The symbols are defined in security/h/sec_attr_tools.h . I'm trying to 
figure out who should be including this file.

[7/15/94 public]
Cancelled. export area in the backing tree was out of date.



CR Number                     : 11321
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : sec_rgy_site_open_update
Short Description             : core dump in sec_rgy_site_open_update
Reported Date                 : 7/15/94
Found in Baseline             : 1.1
Found Date                    : 7/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/94 public]

Running gds_sec tests I get the following outout on HP800:

dcecp dcecp_add.tcl
rgy_add.sh

local_start: Configure GDS

Local CACHE administration (DIR-IDs=11)
Local CACHE administration (DIR-IDs=12)
Waiting 60 sec. for coming up the DSA processes
Adding objects in DSA-11
Adding objects in DSA-12
Now, testing is going on ...
gds_sec (tp1/1): Waiting 60 sec. for coming up the DSA processes
/bin/ksh: 18373 Memory fault(coredump)
/bin/ksh: 18385 Memory fault(coredump)
gds_sec (tp1/2): Waiting 60 sec. for coming up the DSA processes
/bin/ksh: 18487 Memory fault(coredump)
gds_sec (tp1/3): Waiting 60 sec. for coming up the DSA processes
gds_sec (tp2/1): Waiting 60 sec. for coming up the DSA processes
gds_sec (tp3/1): Waiting 60 sec. for coming up the DSA processes
/bin/ksh: 18907 Memory fault(coredump)
/bin/ksh: 18920 Bus error(coredump)
gds_sec (tp4/1): Waiting 60 sec. for coming up the DSA processes
/bin/ksh: 19068 Bus error(coredump)
/bin/ksh: 19075 Memory fault(coredump)
/bin/ksh: 19084 Memory fault(coredump)
/bin/ksh: 19091 Memory fault(coredump)
/bin/ksh: 19098 Memory fault(coredump)
/bin/ksh: 19105 Memory fault(coredump)

rgy_del.sh
dcecp dcecp_del.tcl
local_clean: Deconfigure GDS

As far as I can see all cores came from gdscp.

The stack of the last core is (xdb -s -l ALL /opt/dcelocal/bin/gdscp core):

 0 free@libc + 0x00000008 (hp-ux export stub)
 1 cma_lib_free@libdce + 0x00000284 (0x400950a0, 0x3, 0, 0x100000)
 2 ptdexc_mutex_unlock@libdce + 0x00000034 (0x400950a0, 0x4, 0x15, 0x7b033eb0)
 3 rpc_ss_free@libdce + 0x000000e8 (0x4000f148, 0x9fe80800, 0x1ceb11c9, 0x8a885d04)
 4 cma_lib_free@libdce + 0x00000148 (0x400c09a0, 0x400bb490, 0x400d87f8, 0x7b03f4e8)
 5 rca_site_resolve_update@libdce + 0x000007b8 (0x7b03f4e8, 0x40098b58, 0x7b039f84, 0x7b03abb0)
 6 sec_rgy_site_bind_update@libdc + 0x00000088 (0x7b039f88, 0x7b03f4e8, 0x7b039f84, 0x7b03abb0)
 7 sec_rgy_site_open_update@libdc + 0x00000068 (0x7b039f88, 0x7b039f84, 0x7b03abb0, 0x7afd6090)
 8 gds_sec__conf_target@libdce + 0x00001c4c (0x40096b40, 0x7b037e28, 0x7b035c5c, 0)
 9 dua_sec__map_target_name@libdc + 0x00000dbc (0x7b030005, 0x7b035d0c, 0x7b03000b, 0x40096b40)
10 dua_init_sec_ctx@libdce + 0x00000e44 (0x40090005, 0x40096b40, 0x7b03000b, 0)
11 d21_bh1_exec_bind@libdce + 0x000007ac (0x7b0356d8, 0x7afc0000, 0x1aa, 0x7afc505c)
12 d21_1_bind@libdce + 0x00000b80 (0x7b0355e0, 0x7afb68b0, 0x7afb68c0, 0)
13 ds_bind@libdce + 0x00001134 (0x400969c8, 0x40095128, 0x400070ec, 0)
14 gc_t__perform_bind + 0x00000a00 (0xb, 0x40096870, 0, 0)
15 gc_t_bind + 0x00000854 (0x400966c8, 0, 0x1, 0x7b035458)
16 gc_i__x500obj_bind + 0x000000a0 (0, 0x4000a260, 0x6, 0x40096978)
17 gc_i_x500obj + 0x0000015c (0, 0x4000a260, 0x6, 0x40096978)
18 Tcl_Eval + 0x000009f0 (0x4000a260, 0x7b034fd5, 0x10050, 0x2b0000)
19 Tcl_EvalCmd + 0x000001a8 (0, 0x4000a260, 0x2, 0x7b0350b0)
20 Tcl_Eval + 0x000009f0 (0x4000a260, 0x40092238, 0x40096970, 0)
21 InterpProc + 0x00000530 (0x40092220, 0x4000a260, 0, 0x7b034db0)
22 Tcl_Eval + 0x000009f0 (0x4000a260, 0x7b034a55, 0, 0x3)
23 Tcl_EvalCmd + 0x000001a8 (0, 0x4000a260, 0x2, 0x7b034b30)
24 Tcl_Eval + 0x000009f0 (0x4000a260, 0x7b034816, 0x7b034938, 0x7b0348d8)
25 Tcl_CatchCmd + 0x000001a8 (0, 0x4000a260, 0x3, 0x7b0348f0)
26 Tcl_Eval + 0x000009f0 (0x4000a260, 0x40093bbc, 0x7b0344b8, 0)
27 ExprLex + 0x00000744 (0x4000a260, 0x7b0345d8, 0x7b0344b8, 0x7b034650)
28 ExprGetValue + 0x00000080 (0x4000a260, 0x7b0345d8, 0xffffffff, 0x7b0344b8)
29 ExprTopLevel + 0x00000158 (0x4000a260, 0x40093bbb, 0x7b0344b8, 0x7b033eb0)
30 Tcl_ExprBoolean + 0x00000040 (0x4000a260, 0x40093bbb, 0x7b034470, 0x7b034358)
31 Tcl_IfCmd + 0x000001c4 (0, 0x4000a260, 0x5, 0x7b034370)
32 Tcl_Eval + 0x000009f0 (0x4000a260, 0x40092880, 0x12cc, 0)
33 Tcl_EvalFile + 0x0000088c (0x4000a260, 0x7b033006, 0x4000128c, 0x1)
34 gc_i__check_interactive_mode + 0x00000284 (0x4000a260, 0x40000002, 0x7b033cd0, 0)
35 main + 0x000000f0 (0x2, 0x7b033cd0, 0, 0)


The first core dump has had the same stack.

Helmut Baumgaertner: Can you check if we have to assign this to sec?

[07/18/94 public]
Assigned it to sec.
What happens is that gdscp tries a bind with DCE authentication.
We do before a "dce_login cell_admin -dce-"
and a "dce_login gds_cl1 gds_cl1". This works fine.
Then we call 

gdscp 

gdscp> bind -dirid 11 -dsa /c=re/O=sni/ou=buba/cn=dsa/cn=dsa1 -authentication DCE


gdscp calls sec_rgy_site_open_update with:

sec_rgy_site_open_update("/.../c=ie/o=digital",&rgy_ctx, &dce_status );

(see : directory/gds/gds_sec/gds_sec_rgy.c, line 465.)

Is there a difference between calling sec_rgy_site_open_update
with "/.../c=ie/o=digital" and "/.:" ?

Additional info: output from gds/gds_sec:

SEC_TRACE 2 :   ENTRY dua_acquire_cred
SEC_TRACE 3 :   sec_mech:<5>
SEC_TRACE 5 :   gds_sec__test_cred: testing for <NO_MASTER_BIND> for authmech 5
SEC_TRACE 4 :   no cred stored for <NO_MASTER_BIND> for authmech 5
SEC_TRACE 2 :   dua_acquire_cred: cred_handle:<0> continue
SEC_TRACE 3 :   ENTRY dua_sec__map_client_name
SEC_TRACE 4 :    dua_sec__map_client_name uses gss_name <GSS_C_NO_NAME>
SEC_TRACE 3 :   EXIT dua_sec__map_client_name
SEC_TRACE 2 :   ENTRY gds_sec__set_ext_attr()
SEC_TRACE 3 :   got current login context handle <1074353160>
SEC_TRACE 3 :   sec_login_set_extended_attrs returned ok
SEC_TRACE 3 :   got new  context handle<1074513848>
SEC_TRACE 3 :   New login context set to the default context
SEC_TRACE 2 :   EXIT gds_sec__set_ext_attr()
SEC_TRACE 2 :   dua_acquire_cred: gds_sec__set_ext_attr() succeeded
SEC_TRACE 3 :    dua_acquire_cred uses gss_name <GSS_C_NO_NAME>
SEC_TRACE 2 :   EXIT dua_acquire_cred: cred_handle:<1>
SEC_TRACE 2 :   ENTRY dua_init_sec_ctx
SEC_TRACE 3 :   sec_mech:<5> cred_handle:<1>
SEC_TRACE 3 :   ENTRY dua_sec__map_target_name
SEC_TRACE 4 :   dsa_dn:<85.4.6re85.4.10sni85.4.11buba85.4.3dsa85.4.3dsa1> dsa_psap <>
SEC_TRACE 3 :   ENTRY dua_sec__get_dir_princ
SEC_TRACE 2 :   ENTRY dua_acquire_cred
SEC_TRACE 3 :   sec_mech:<0>
SEC_TRACE 2 :   EXIT dua_acquire_cred: cred_handle:<0>
SEC_TRACE 2 :   ENTRY dua_init_sec_ctx
SEC_TRACE 3 :   sec_mech:<0> cred_handle:<0>
SEC_TRACE 2 :   EXIT dua_init_sec_ctx: bind_id <0>
SEC_TRACE 2 :   ENTRY dua_conf_sec_ctx
SEC_TRACE 3 :   sec_mech:<0> bind_id:<0>
SEC_TRACE 3 :   return_token length <0>

SEC_TRACE 2 :   EXIT dua_conf_sec_ctx: target_dsa <>
SEC_TRACE 2 :   read from <85.4.6re85.4.10sni85.4.11buba85.4.3dsa85.4.3dsa1> PN </.../c=ie/o=digital/gds-dsa1>
SEC_TRACE 2 :   len read <28>
SEC_TRACE 3 :   EXIT dua_sec__get_dir_princ
SEC_TRACE 3 :   ENTRY gds_sec__conf_target
SEC_TRACE 4 :   retrieved from dir DN <85.4.6re85.4.10sni85.4.11buba85.4.3dsa85.4.3dsa1>
SEC_TRACE 4 :   retrieved from dir PN </.../c=ie/o=digital/gds-dsa1>
SEC_TRACE 2 :   cell name </.../c=ie/o=digital> principal name <gds-dsa1>
Memory fault(coredump)

I haven't tested it yet with the last build - I did use the build
from 7/14/94. I'll try now - I think there was a new security drop
on Friday ...

[07/18/94 public]
Same behaviour with the newest source. Still dumping core - same stack.

[07/18/94 public]
Starting gdscp from xdb:

xdb -s -l ALL /opt/dcelocal/bin/gdscp

I did in xdb:

z 20 s
z 20 r		(to skip over VTALARM)
run

got the prompt 

gdscp>

and typed

bind -dirid 11 -dsa /c=re/O=sni/ou=buba/cn=dsa/cn=dsa1 -authentication DCE

I got :

bad arg to sys call (from probe_for_kload) - I continued
bad arg to sys call (from probe_for_dfs) - I continued
bad arg to sys call (from afs_syscall) - I continued
bad arg to sys call (from afs_syscall) - I continued

(BTW: is this OK?)

Then I got segmentation violation with the following stack:

 0 free@libc + 0x00000114 (0x4000f148, 0x6170001b, 0x6369646d, 0x97365)
 1 cma_lib_free@libdce + 0x00000148 (0x400bd6d0, 0x400b9ec8, 0x400bd9a0, 0x7b03e418)
 2 rca_site_resolve_update@libdce + 0x000007b8 (0x7b03e418, 0x400bd550, 0x7b038eb4, 0x7b039ae0)
 3 sec_rgy_site_bind_update@libdc + 0x00000088 (0x7b038eb8, 0x7b03e418, 0x7b038eb4, 0x7b039ae0)
 4 sec_rgy_site_open_update@libdc + 0x00000068 (0x7b038eb8, 0x7b038eb4, 0x7b039ae0, 0x7aa24408)
 5 gds_sec__conf_target@libdce + 0x00001c4c (0x40094008, 0x7b036d58, 0x7b034b8c, 0)
 6 dua_sec__map_target_name@libdc + 0x00000dbc (0x7b030005, 0x7b034c3c, 0x7b03000b, 0x40094008)

... (same as above)

This stack seems less corrupted than the stack above.
(Ignoring that it still says that i.e. free has 4 arguments ...)
There is only one "free" called directly by rca_site_resolve_update -
may be this makes it easier to find the bug.

Please note that the core dump does not always happen: sometimes
it passes rca_site_resolve_update - we get a bus error later
($RECOVER_START from free@libc - that is the stack), sometimes
it passes also this, and we get

1994-07-18-15:44:35.827-04:00I----- PID#7534 ERROR gss authentication gssapi.c 5
215 0x7affba68
No token supplied

Does anybody have a good memory debugger which is able to debug
also cma_free stuff??

[7/19/94 public]
Just a side note to the above debug work:
You should execute the following two commands when you start xdb, or better yet,
add these two commands to your ~/.xdbrc (create it if it doesn't exist)
(you got the 20 signal correct, but you can do it in a single command.  The
continues that you had to do were because you hadn't done the same for signal12)

z 20 sr
z 12 sr

[07/20/94 public]
Is it OK to ignore signal 12?? Anyway: We have tried to figure out who
causes the memory problem - sec or gds.

So we (means Helmut Baumgaertner) wrote a dcecp script:
(/project/dce/build/dce1.1/src/test/functional/directory/gds/ts/config/dcecp_add.tcl)

#######################################################################
#    FILE : dcecp_add.tcl                                             #
#    TYPE : dcecp script                                              #
#    DESCRIPTION : used to setup the DCE  registry for gds_sec tests  #
#######################################################################


# add the principals 

puts "creating principals "

principal create { gds_zero  gds_invalid  gds_cl1 gds_cl2 gds_cl3 gds-dsa1  gds-dsa2  }

# use modify to get the ERA in the rgy

puts "assigning values for ERA X500_DN "

principal modify gds_invalid -add {X500_DN {/C=re/O=sni/CN=invalid}}
principal modify gds_cl1 -add {X500_DN {/C=re/O=sni/OU=buba/CN=one}}
principal modify gds-dsa1 -add {X500_DN {/C=re/O=sni/OU=buba/CN=dsa/CN=dsa1}}
principal modify gds_cl2 -add {X500_DN {/C=re/O=sni/OU=ap2/CN=two}}
principal modify gds_cl3 -add {X500_DN {/C=re/O=sni/OU=ap2/CN=three}}
principal modify gds-dsa2 -add {X500_DN {/C=re/O=sni/OU=buba/CN=dsa/CN=dsa2}}

# creating new group and organization

puts "creating new group gds_sec_grp"
group create gds_sec_grp 

puts "creating new organization gds_sec_org"
organization create gds_sec_org 


# adding members to group gds_sec_grp  and org gds_sec_org

puts "adding members to group and org"

group add gds_sec_grp -member { gds_zero gds_invalid gds_cl1 gds_cl2 gds_cl3 gds-dsa1 gds-dsa2 }
organization add gds_sec_org -member { gds_zero gds_invalid gds_cl1 gds_cl2 gds_cl3 gds-dsa1 gds-dsa2 }



# creating accounts 

puts "creating accounts"

account create gds_zero -group {gds_sec_grp} -organization {gds_sec_org} -password {gds_zero} -mypwd {-dce-}     
account create gds_invalid -group {gds_sec_grp} -organization {gds_sec_org} -password {gds_invalid} -mypwd {-dce-}     
account create gds_cl1 -group {gds_sec_grp} -organization {gds_sec_org} -password {gds_cl1} -mypwd {-dce-}     
account create gds_cl2 -group {gds_sec_grp} -organization {gds_sec_org} -password {gds_cl2} -mypwd {-dce-}     
account create gds_cl3 -group {gds_sec_grp} -organization {gds_sec_org} -password {gds_cl3} -mypwd {-dce-}     
account create gds-dsa1 -group {gds_sec_grp} -organization {gds_sec_org} -password {gds-dsa1} -mypwd {-dce-}     
account create gds-dsa2 -group {gds_sec_grp} -organization {gds_sec_org} -password {gds-dsa2} -mypwd {-dce-}     


# keytab entries


--------------------------------


We do dce_login as cell_admin, run this script and then run the following
C program:

/*--------------------------------------------------------------------*/
/*                                                                    */
/* Copyright (c) 1993 Siemens Nixdorf Informationssysteme AG          */
/* All Rights Reserved                                                */
/*                                                                    */
/* Project      : GDS SEC                                             */
/*                                                                    */
/* File Name    : getdsapn.c                                          */
/*                                                                    */
/* Description  : main prog : Prints the DN ERA value for a given     */
/*                dsa pr=incipal name                                 */
/*                                                                    */
/* Date         : may  31, 1994                                       */
/*                                                                    */
/* Author       : Helmut Baumgaertner SNI BA NM 123, Munich, Germany  */
/*                                                                    */
/*--------------------------------------------------------------------*/
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include <dce/rpc.h>
#include <dce/uuid.h>
#include <dce/dce_error.h>
#include <dce/rgybase.h>
#include <dce/binding.h>
#include <dce/sec_cred.h>


#define GLOBAL_DCE_NAME_PREFIX	"/.../"


/* prototypes of internal functions */


signed32  gds_sec__separate_pn (
	/*	IN	*/	unsigned_char_t *global_name,
	/*	OUt	*/	unsigned_char_t *cell_name,
	/*	OUt	*/	unsigned_char_t *princ_name);


static void gds_sec__inq_err_text(
	/*	IN	*/	unsigned long	dce_status,
	/*	IN	*/	char			*text,
	/*	OUT	*/	unsigned char	*dce_err_text);

main	(
		int argc, 
		char *argv[]
		)
	{

	unsigned char dce_e_string[dce_c_error_string_len];
	sec_rgy_handle_t rgy_ctx;
	sec_attr_t x500_attr_returned;
	sec_rgy_name_t	rgy_attr_princ_name;
	error_status_t dce_status;
	int i;
	signed32 d2_ret;
	unsigned_char_t rgy_name[100];
	unsigned_char_t cell_name[1024] , local_pname[1024];


	if (argc == 1 )  /* set default pricipal to ask for */
		{
		strcpy ( (char*) rgy_attr_princ_name, "gds-dsa1");
		strcpy ( (char*) rgy_name, "/.../c=ie/o=digital");
		}
	if ( argc == 2 )  /* use 1. argument as global principal name */
		{
		d2_ret = gds_sec__separate_pn ( (unsigned_char_t *) argv[1] ,
									cell_name , local_pname );
		if ( d2_ret != 0 )
			{
			fprintf(stderr, "Could not sepatate cell name form principal name\n");
			exit ( 101);
			}
		fprintf(stderr,"cell name <%s> principal name <%s>\n",cell_name,local_pname);
		strcpy ( (char*) rgy_attr_princ_name, (char*) local_pname);
		strcpy ( (char*) rgy_name, (char*) cell_name);
		}
	fprintf(stderr,
	"Get X500 ERAs for principal <%s> from rgy site <%s>\n"
	,rgy_attr_princ_name, rgy_name);

	sec_rgy_site_open_update (	rgy_name ,
								&rgy_ctx, &dce_status );	

	if ( dce_status != error_status_ok)
		{
		gds_sec__inq_err_text(dce_status,"sec_rgy_site_open_update",dce_e_string);
		fprintf(stderr,"sec_rgy_site_open_update: %s\n",dce_e_string);
		exit (1) ;
		}

	fprintf(stderr,"sec_rgy_site_open_update OK\n");


	sec_rgy_attr_lookup_by_name (	rgy_ctx,
								sec_rgy_domain_person ,
								rgy_attr_princ_name,
								"X500_DN" ,
								&x500_attr_returned,
								&dce_status);
	if ( dce_status != error_status_ok)
		{
		gds_sec__inq_err_text(dce_status,"sec_rgy_attr_lookup_by_name",dce_e_string);
		fprintf(stderr,"sec_rgy_attr_lookup_by_name: %s\n",dce_e_string);
		exit(4);
		}

	else
		{
		fprintf(stderr,"sec_rgy_attr_lookup_by_name OK\n");
		
		if ( x500_attr_returned.attr_value.attr_encoding  != sec_attr_enc_printstring )
			{
			fprintf(stderr,
			"sec_rgy_attr_lookup_by_name returned wrong attr encoding <%d> \n",
			x500_attr_returned.attr_value.attr_encoding);
			exit (20);
			}

		/* here we have got the DN of the specified principal */

		fprintf(stderr,"\t X500_DN :\t\t<%s>\n",
			x500_attr_returned.attr_value.tagged_union.printstring);
		
		}

	sec_rgy_attr_lookup_by_name (	rgy_ctx,
								sec_rgy_domain_person ,
								rgy_attr_princ_name,
								"X500_DSA_Admin" ,
								&x500_attr_returned,
								&dce_status);
	if ( dce_status != error_status_ok)
		{
		gds_sec__inq_err_text(dce_status,"sec_rgy_attr_lookup_by_name",dce_e_string);
		fprintf(stderr,"sec_rgy_attr_lookup_by_name: %s\n",dce_e_string);
		exit(4);
		}

	else
		{
		fprintf(stderr,"sec_rgy_attr_lookup_by_name OK\n");
		
		if ( x500_attr_returned.attr_value.attr_encoding  != sec_attr_enc_printstring_array )
			{
			fprintf(stderr,
			"sec_rgy_attr_lookup_by_name returned wrong attr encoding <%d> \n",
			x500_attr_returned.attr_value.attr_encoding);
			exit (20);
			}

		/* here we have got the DSA name list of the specified principal */

		fprintf(stderr,"\t X500_DSA_Admin : \n");

		for (i = 0 ; 
			i<x500_attr_returned.attr_value.tagged_union.string_array->num_strings; 
			i++)
				fprintf(stderr,"\t\t\t\t<%s>\n",
				x500_attr_returned.attr_value.tagged_union.string_array->strings[i]);

		}

	/* terminate the binding to the rgy server */
	sec_rgy_site_close (	rgy_ctx,
							&dce_status);

	if ( dce_status != error_status_ok)
		{
		gds_sec__inq_err_text(dce_status,"sec_rgy_site_close",dce_e_string);
		fprintf(stderr,"sec_rgy_site_close : %s\n",dce_e_string);
		fprintf(stderr,"continue anyway\n");
		}
	else
		{
		fprintf(stderr,"sec_rgy_site_close OK\n");
		}

	
	exit (0);
	}
/*--------------------------------------------------------------------*/
/*                                                                    */
/* Function Name:	gds_sec__separate_pn                              */
/*                                                                    */
/* Description	: separates the cell name and the local pricipal name */
/*                from a global DCE name                              */
/*                given in the format  as it is stored in the rgy     */
/* Date         : March    23, 1994                                   */
/* Author       : Helmut Baumgaertner SNI BA NM 123, Munich, Germany  */
/*--------------------------------------------------------------------*/
signed32 gds_sec__separate_pn ( 
	/*	IN	*/ unsigned_char_t * global_name ,
	/*	OUT	*/ unsigned_char_t * c_name ,
	/*	OUT	*/ unsigned_char_t * p_name )
	{
	unsigned char *tmp, *pslash, *pequal;
	signed16 typed_name = 1 ;
	unsigned char g_name[1024];

	strcpy ((char*) g_name, (char*) global_name);
	
	pslash  =  g_name + strlen (GLOBAL_DCE_NAME_PREFIX);
	pequal  =  g_name + strlen (GLOBAL_DCE_NAME_PREFIX);


	/* while equals are found */
	while ( typed_name == 1 )
		{
		tmp = (unsigned char *) strchr ( (char*)pequal , '=');
		if ( tmp == NULL)
			typed_name = 0 ;
		else
			pequal += (1+(tmp - pequal)) ;
		}
	pslash = (unsigned char *) strchr ( (char*)pequal , '/'); 
	if (pslash == NULL )
		return (-1);
	
	*pslash++ = 0x00 ;
	strcpy ((char*)  c_name ,(char*)  g_name);
	strcpy ((char*)  p_name ,(char*)  pslash);
	return (0);
	}

/*--------------------------------------------------------------------*/
/*                                                                    */
/* Function Name:	gds_sec__inq_err_text                             */
/*                                                                    */
/* Description	: gets the dce error text for a given dce error_status*/
/* Date         : March    23, 1994                                   */
/* Author       : Helmut Baumgaertner SNI BA NM 123, Munich, Germany  */
/*--------------------------------------------------------------------*/
static void gds_sec__inq_err_text(
	/*	IN	*/	unsigned long	dce_status,
	/*	IN	*/	char			*text,
	/*	OUT	*/	unsigned char	*dce_err_text)
	{

	int error_st;

	dce_error_inq_text ( (unsigned long) dce_status, 
						dce_err_text, &error_st);
		if ( error_st == -1 )
			{
			sprintf((char*) dce_err_text ," %s returns error <%08x>",
									text, dce_status);
			}
	}

-------------------------------------

Running this on HP in an infinite loop gives the following output:


Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
Bus error(coredump)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
Bus error(coredump)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
Bus error(coredump)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
Bus error(coredump)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
Bus error(coredump)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
	 X500_DN :		</C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>
sec_rgy_attr_lookup_by_name: attribute instance not found (dce / sec)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
Bus error(coredump)
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>

----------------------------

As you can see - sometimes sec_rgy_site_open_update works, sometimes 
it dumps core. We think that our getera.c example is OK -
so the problem should be really in sec_rgy_site_open_update.
(secd und sec_clientd are still running after our test suite.)

Hope that this information helps.

[07/20/94 public]
Changed subject field: not only gdscp is dumping core in
sec_rgy_site_open_update.

[08/10/94 public]
I haven't been able to reproduce this; the sample program runs
indefinitely.  Can OSF?

[8/11/94 public]

Attempted reproduce problem using sample program on HP and AT386 using
binaries from build of 8/10.  Program ran 1106 times on AT without problem.
On HP, secd died on first iteration of sample program.  Re-configured and
re-ran sample program ... got :

# ./getdsapn
Get X500 ERAs for principal <gds-dsa1> from rgy site </.../c=ie/o=digital>
sec_rgy_site_open_update OK
sec_rgy_attr_lookup_by_name OK
         X500_DN :              </C=re/O=sni/OU=buba/CN=dsa/CN=dsa1>

and secd commenced to spin.

Here are the configuration steps I used:

config.cmd: (comments deleted)
  config sec server		# Security Server
  config cds server		# CDS Server
  
Config.env:
  #
  # General config values
  #
  
  EXIT_ON_ERROR=n		# y/n Exit if fatal error ecountered, default n
  DO_CHECKS=n		# y/n Prompt for continue after warnings, default y
  
  CELL_ADMIN=cell_admin	# Principal name of Cell Administrator
  CELL_ADMIN_PW=-dce-	# Password for CELL_ADMIN account
  
  #TOLERANCE_SEC=120	# Number of seconds clients can differ from sec server
  check_time=y		# y/n if you want to check times, default y
  SYNC_CLOCKS=y		# y/n Sync our clock to sec servers?
  
  
  #
  # Install
  #
  REMOVE_PREV_INSTALL=y		# y/n Remove previous install before 
				  # installing anything.
  mach=`uname`
  case $mach in
	  OSF1)	machine=at386;;
	  AIX)	machine=rios;;
	  HP-UX)	machine=hp800;;
  esac
  # path to install area
  #FILESYSTEM="install/${machine}/opt/dce1.1"
  #MEDIA="<device>"			# device to read tape from
  
  CP_OR_SYMLINK=copy		# Use copy or sym-links(link) to install
  USE_DEF_MSG_PATH=y		# y/n use default message catalog path
  USE_ETHER_FILE=y		# y/n Trust /etc/ieee_802_addr file (OSF/1)
  DO_LIB_ADMIN=y			# y/n Install libdce.so on OSF/1 system
  
  #
  # DFS install
  #
  INSTALL_OPT_SERS=y		# y/n install optional servers (bak, butc, etc)
  INSTALL_OPT_CLIENT=y		# y/n install optional client binaries (cm, etc)
  
  
  #
  # General config variables
  #
  REMOVE_PREV_CONFIG=y	# y/n Remove previous config before config-ing anything
  
  CELL_NAME="c=ie/o=digital"	# Name of cell to configure
  
  #HOST_NAME_IP="<ip_address>"	# IP address of current host (if getip fails)
  
  
  #
  # DCE Client config
  #
  DTS_CONFIG=clerk		# When doing DCE client config, what should
				  # we be? clerk, local, global, none
  
  #
  # Security Config
  #
  SEC_SERVER="`hostname`"		# Hostname of security server
  #SEC_SERVER_IP="<ip-address>"	# fallback if getip program doesn't work
  KEYSEED="garBageMan"		# Keeyseed for initial database master
  
  #SEC_REPLICA="<hostname>"	# Name of the security replica database
  
  
  #
  # CDS Config
  #
  CACHE_CDS_SERVER="`hostname`"	# Name of a cds server to cache
  #CACHE_CDS_SERVER_IP="<ip_address>" # fallback if getip program doesn't work
  MULTIPLE_LAN=n			# y/n do you have multiple lans
  #LAN_NAME="<name>"		# Name of lan if MULTIPLE_LAN=y
  
  #REP_CLEARINGHOUSE="<name_ch>"	# Name for new replica clearing house
  #DIR_REPLICATE="n"		# y/n manually type in more directories 
				  # to replicate.
  
  #
  # GDA
  #
  
  #
  # DTS Config
  #
  NTP_HOST="<hostname>"		# Name of ntp server
  
  #
  # DFS Config
  #
  
  AGG_FS_TYPE=native		# native/episode aggregate fs type to export
  AGG_DEV_NAME="<device>"		# device name for the aggregate to be exported
  AGG_MOUNT_PATH="<path>"		# mount path for aggregate
  AGG_NAME="<name>"			# Name of aggregate
  AGG_ID="<number>"			# numerical id of aggregate
  
  CACHE_SIZE_RAM=10000		# number of bytes for memory cache
  CACHE_SIZE_DISK=10000		# number of bytes for disk cache
  CACHE_DIR_DISK="/opt/dcelocal/var/adm/dfs/cache" # pathname of disk cache
  CLIENT_CACHE_LOC=disk		# mem/disk where is the cache
  
  EPI_FORMAT_PART=n		# y/n format partition as episode
  EPI_FORCE_INIT=n		# y/n force initialization, even if data loss
  INIT_LFS=n			# y/n initialize the LFS (using epiinit)?
  LOAD_LFS_KEXT=n			# y/n load LFS kernel extentions
  
  ROOT_FILESET_NM="<name>"	# Root fileset name
  SCM_NAME="<hostname>"		# System Control Machine name
    
Additional files needed are:
src/test/functional/directory/gds/ts/config/(dcecp_add.tcl,rgy_add.sh}

Commands issued:
  /etc/dce_config -e config.env -c config.cmd
  dce_login cell_admin -dce-
  dcecp dcecp_add.tcl
  rgy_add.sh
  getdsapn

[8/11/94 public]
Forgot to add: I was using rpcd as the endpoint mapper.

[08/11/94 public]
No, secd crashing in this scenario is a different bug, OT 11610 -- the fix
hasn't yet migrated down to OSF but if you want to apply it temporarily,
in rsdb_attr.c:rsdb_attr_lookup_by_name()

    sec_attr_util_sch_ent_free_ptrs(&sch_entry);
==>
    if(!allocator)
    {
        sec_attr_util_sch_ent_free_ptrs(&sch_entry);
    }

[8/12/94 public]
Reran sample program on HP with rebuilt secd.  Program did 500 iterations
without a problem.  I've dropped the priority to 1 now.  I'll run the
original GDS FVT test which discovered this problem over the weekend.  If
it doesn't turn up we can close this defect.

[8/26/94 public]
Cancelled -- SNI will reopen if necessary (email from Jochen suggests
closing it, but there was no fix/confirmation cycle.)

[09/05/94 public]
Reopened. Reproducable with gds FVT.
See 11880: same stack as in this OT.

sec_rgy_site_open_update is called with:

parameter 1: "/.../c=ie/o=digital"
parameter 2: &rgy_ctx (sec_rgy_handle_t rgy_ctx;)
parameter 3: &dce_status (error_status_t dce_status;)

[09/07/94 public]
This is how to reproduce (David Truong and Rob Stenzel were requesting this):

To run the gds_sec tests:

- Install DCE 1.1, TET and the gds functional tests
(last two with dcetest_config) on your machine;

- cd /dcetest/dcelocal/test/tet/functional/directory/gds/tools

- export TET_ROOT=/dcetest/dcelocal/test/tet

- execute: ./local_TET.admin gds_sec

This script configures, activates and initializes gds,
does a dce_login as cell_admin,
adds some objects to the registry (via dcecp) and executes some 
gdscp scripts.

To do all this by hand - not by TET:

- configure a cell with cell name "/C=ie/O=digital"
				(password for cell_admin: -dce-)

- dce_login cell_admin -dce-

(- read
   /dcetest/dcelocal/test/tet/functional/directory/gds/ts/gds_sec/gds_sec_all)

- execute all in the "Startup" function - means 

/dcetest/dcelocal/test/tet/functional/directory/gds/ts/config/gds_sec_start.sh

- do all what is done in the functions tp1, tp2, tp3, tp4
	(actually: what's dumping core could be:

gdscp gds_sec/lib/sec_dsp_b1.tcl
gdscp gds_sec/lib/sec_dsp_b2.tcl)

[9/7/94 public]
Following the above TET instructions, the gds_sec test exited with:

ERROR:
No connection to DSA/DUA-Cache available !

I tried it twice.  Then I tried the "by hand" way, but never succeeded
in getting all the necessary environment variables and scripts set up.

I'm off to work on other bugs; this may have to be an OSF on-site problem.

[09/12/94 public]
More news:

1.) We have changed from calling sec_rgy_site_open_update
	to sec_rgy_site_open_query. This seems to work.

2.) Compiling binding.c and internal_binding.c with "-g"
	and linking it directly to gdscp gave the following stack
	after segmentation violation:

 0 free@libc + 0x00000114 (0x40035148, 0, 0, 0)
 1 cma_lib_free@libdce + 0x00000148 (0x40121288, 0x400e54d8, 0x4011b8f8, 0x7b03ded8)
 2 rca_site_resolve_update (auth_info = 0x7b03ded8, icontext = 0x400e53f0, ocontext = 0x7b038974, status = 0x7b0395a0)    [/project/dce/build/dce1.1/src/security/client/rca/internal_binding.c: 2520]
 3 sec_rgy_site_bind_update (site_name = 0x7b038978, auth_info = 0x7b03ded8, context = 0x7b038974, status = 0x7b0395a0)    [/project/dce/build/dce1.1/src/security/client/rca/binding.c: 201]
 4 sec_rgy_site_open_update (site_name = 0x7b038978, context = 0x7b038974, status = 0x7b0395a0)    [/project/dce/build/dce1.1/src/security/client/rca/binding.c: 420]
 5 gds_sec__conf_target@libdce + 0x00001c4c (0x400b9ae0, 0x7b036818, 0x7b03464c, 0x400b98a8)

Line 2520 in internal_binding.c is:

TOWER_VEC_FREE(rpc_ss_client_free, towerv);

So I guess somebody is wrong with the memory handling of towerv.
But gds uses sec_rgy_site_open_query now - so we don't need this fixed soon.
I just think that there is still a memory problem in rca_site_resolve_update.

[09/14/94 public]
Cancelled because we don't use sec_rgy_site_open_update any more.
If somebody else is running in a similar problem he can reopen this.



CR Number                     : 11301
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : gdsditadm
Short Description             : gdsditadm dumps core in gds_sec test setup
Reported Date                 : 7/14/94
Found in Baseline             : 1.1
Found Date                    : 7/14/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : gds/adm/admin/d20getat.c
Sensitivity                   : public

[7/14/94 public]

gdsditadm dumps core on HP if you run

gdsditadm < dsa11_init.bat.

I put the gdsditadm I used here to snihp1:/home/keutel/tmp/HP800.

(I think the gdsditadm available in predce11 will not work at all
with "Principal name" attribute because OT 11295 - type collision
for d20_dir_id.)

This gdsditadm is partly (adm/admin and adm/adm_iapl) compiled with "-g".

The core dump is in d20admin.c, line 522 (dce1.1 version).
What happens is that the DSA object re/sni/buba/dsa/dsa1 
is succesfully added to the cache.
(with ds4_b11_call_directory(1), line 515 of d20admin.c)
For an unknown reason this function call overwrites parblk - after this call
parblk = 0x0000040.
The core dump is then of course 

parblk->d20_Eenv.

If you try to read this object from the cache you get an almost
empty mask for the object name, and if you try to read it again 
gdsditadm core dumps as well.

I assume that the new attribute Principal Name is causing all the problems -
may be there is not enough memory allocated, ...

I'll send additional information via mail to Rudi and Sanjay.
I try to reproduce it on AT386. But may be it'll work - AT386
is more tolerant. (I hope it works - otherwise I couldn't understand
how it worked in Munich ...)

[07/15/94 public]
I tried to reproduce it with the last night's build - gdsditadm works
now. May be it was a link problem in my sandbox - may be it is related 
to OT 11317 (old admscheme file) -  who knows?
Anyway: gds_sec seem to work now on HP800 and AT386.

[8/2/94 public]
Can't reproduce.  Cancelled.



CR Number                     : 11291
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : nsi
Short Description             : problems re-exporting to the namespace
Reported Date                 : 7/14/94
Found in Baseline             : 1.1
Found Date                    : 7/14/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/14/94 public]

Problems re-exporting to the namespace (originally reported in
CR 11119) will be tracked here.

[7/14/94 public]
As luck (good? bad?) would have it, I am unable to reproduce this
problem with the build available today. Martha Dassarma, Rick Fadden
and I all hit problems trying to restart our cells with /etc/rc.dce
and had to resort to reconfig'ing for every cell restart. Downgrading
for the time being - this will either resurface when testing
between cell restarts is done (rather than the clean shutdown/restart
attempts used to attempt to reproduce this) or get cancelled.

[7/28/94 public]
Suspecting this was an operator error on my part - mishandling restarting
of a split server configuration such that security was not available
via the namespace when dts and dfs were trying to start up. Rick and
Martha were hitting secd core dumps that spin cds (CR 11067) which
results in similar symptoms. Cancelling ...



CR Number                     : 11289
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dcecp
Subcomponent Name             : cds
Short Description             : dcecp cannot create cds name with space(s) in it
Reported Date                 : 7/14/94
Found in Baseline             : 1.1
Found Date                    : 7/14/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/14/94 public]

	CDS allows spaces in a simple name. Section 6.3 (page 6-4) of 1.0.3
	DCE Admin Guide says that you can use single quote, or double quote, or
	back slash to escape the space.

	The above mentioned way works in cdscp. But it does not work in dcecp.

$cdscp
cdscp> crea obj /.:/' ab'
cdscp> del obj /.:/\ ab
cdscp>  

$dcecp
dcecp> obj create /.:/"a b"
Error: Unrecognized argument 'b"'.
dcecp> object create /.:/a\ b
Error: Invalid name
dcecp> obj create /.:/'a b'
Error: Unrecognized argument 'b''.
dcecp>

[7/14/94 public]
You need to follow dcecp (Tcl) quoting rules.  Please try:

  dcecp> obj create "/.:/a b"
  dcecp> obj create {/.:/a b}
  dcecp> obj create /.:/a\ b

I know you said you tried the third and that disturbs me.

The 1.0.3 admin guide you site necessarily describes cdscp and not
dcecp.  dcecp doc and updated admin guides are I believe submitted to
the doc tree.

[7/14/94 public]

Howard is a little bit off. A typical tcl list for creating a bunch of 
objects is {/.:/a /.:/b} so his examples are not exactly correct since
it will try to create two objects /.:/a and b. Try this: 

  dcecp> obj create {"/.:/a b"}
  dcecp> obj create {{/.:/a b}}

[7/14/94 public]
But Kevin is dead on!  Cancelled.  Ward has been notified about the doc
issues.  He can open a CR if he feels it's necessary to track it that way.



CR Number                     : 11283
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : 
Short Description             : dce64.h contains platform
specific code
Reported Date                 : 7/13/94
Found in Baseline             : 1.1
Found Date                    : 7/13/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/13/94 public]

The file dce/utils/misc/dce64.h contains macro definitions which are
platform specific (e.g. assumes 32 bit longs), and that really depend
on the type definitions of the unsigned64 data type, defined in
dce.h. This file should moved to a platform specific directory, or at
least a "platform-neutral" one (e.g. POSIX).

[7/29/94 public]
After discussion, we have decided that this file can remain in
utils/misc, since different architectures (i.e. those that support 
longs larger that 32 bits) can be supported using the following macro.

#if LONG_BIT >= 64. 
...
#endif

LONG_BIT is a XPG4 blessed macro, and is thus not platform dependent.



CR Number                     : 11272
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : client
Short Description             : cds client side hangs
Reported Date                 : 7/13/94
Found in Baseline             : 1.1
Found Date                    : 7/13/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/13/94 public]

Simple cdscp commands hung in the SINGLE MACHINE smoketest cells
yesterday. Buried among all the dtsd ERROR outputs were the
following cds error messages:

1994-07-12-17:28:42.098-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:29:23.023-04:00I----- cdsd(2853) ERROR cds library sec_init.c 419 0x40053330
1994-07-12-17:30:27.054-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:31:37.099-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:33:22.054-04:00I----- cdsclerk(2855) ERROR cds general clerk_bind.c 620 0x4003a7c8
1994-07-12-17:42:11.618-04:00I----- cdsd(2853) ERROR cds library sec_init.c 419 0x40053330

1994-07-12-18:20:37.628-04:00I----- cdsd(2853) ERROR cds library sec_init.c 419 0x40053330

Note that these error messages began appearing around 5:30 pm while the
cell was configured around 7:45 am ...

[8/24/94 public]
Lowering to a priority 2 since this problem, if it still exists, hasn't
seemed to have blocked anything ... Not ready to cancel this since, although
the line numbers no longer have meaning, data point may prove useful now
that (hopefully) more and longer system test runs can happen.

[08/20/96 public]
I'm cancelling this OT because it is not reproducible, the above messages
are missing status codes so we don't know what possibly happened then,
and no subsequent references were made to this OT during testing.



CR Number                     : 11264
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : server
Short Description             : server ping returns 1 too often
Reported Date                 : 7/12/94
Found in Baseline             : 1.1b11
Found Date                    : 7/12/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/12/94 public]
dcecp> server ping /.:/lan-profile
1
dcecp> server ping /.:/hosts
1
dcecp> server ping /.:/frick_ch
1

I think all of these cases should return an error (or at least a '0').

[7/12/94 public]
All these entries have binding associated with, for example,
/.:/hosts has to have a cds server or clerk server associated
with in order to keep its replica/clearhouse updated. dcecp server 
object can not distinguish if the entry has a hid server or not. 
What it does at this case is that taking a entry and inq a binding 
from the entry and ping the server on the binding.



CR Number                     : 11253
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : libraries
Short Description             : all libraries are built twice
Reported Date                 : 7/11/94
Found in Baseline             : 1.1
Found Date                    : 7/11/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/11/94 public]

On HP800, all static libraries are built twice - once
in  MAKEFILE_PASS=THIRD, once in MAKEFILE_PASS=BASIC.
Also: if you call build again it again builds this library twice -
but no file has changed since the last build.
Here is an example of a build log:

$ build
relative path: ./directory/xom
mkdir ../../../obj/hp800/directory/xom
cd ../../../obj/hp800/directory/xom
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=FIRST     build_all
h: created directory
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omAlloc.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCode.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCopy.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCopyValu.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCreate.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omDelete.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omEntry.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omGet.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omInst.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omPut.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omRead.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omRemove.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omTrace.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omVersion.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omWkspace.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omWrite.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/u2/users/keutel/sb/jk/src/directory/xom -I/u2/users/keutel/sb/jk/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/u2/users/keutel/sb/jk/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/u2/users/keutel/sb/jk/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/u2/users/keutel/sb/jk/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omXext.c
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
rm -rf /u2/users/keutel/sb/jk/export/hp800/usr/lib/libXOM.a
makepath /u2/users/keutel/sb/jk/export/hp800/usr/lib/libXOM.a
(cd .; tar cfh - libXOM.a) |  (cd /u2/users/keutel/sb/jk/export/hp800/usr/lib; tar xf -)
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=BASIC     build_all
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
milo directory/xom$ build
relative path: ./directory/xom
cd ../../../obj/hp800/directory/xom
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=FIRST     build_all
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
rm -rf /u2/users/keutel/sb/jk/export/hp800/usr/lib/libXOM.a
makepath /u2/users/keutel/sb/jk/export/hp800/usr/lib/libXOM.a
(cd .; tar cfh - libXOM.a) |  (cd /u2/users/keutel/sb/jk/export/hp800/usr/lib; tar xf -)
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=BASIC     build_all
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
milo directory/xom$ build
relative path: ./directory/xom
cd ../../../obj/hp800/directory/xom
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=FIRST     build_all
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
rm -rf /u2/users/keutel/sb/jk/export/hp800/usr/lib/libXOM.a
makepath /u2/users/keutel/sb/jk/export/hp800/usr/lib/libXOM.a
(cd .; tar cfh - libXOM.a) |  (cd /u2/users/keutel/sb/jk/export/hp800/usr/lib; tar xf -)
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=BASIC     build_all
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
milo directory/xom$

[7/13/94 public]
Assigned to Annie, lowered severity to C - since there is a workaround
i.e. it works now - albeit inefficiently.

[9/7/94 public]
I tried the above on two platforms and could not reproduce the problem.
Marked as cancel.

The command that I used on an hp800 is as followed:

workon
cd directory/xom
build > /tmp/build.log 2>&1 &

/tmp/build.log shows the following:

relative path: ./directory/xom
mkdir ../../../obj/hp800/directory/xom
cd ../../../obj/hp800/directory/xom
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=FIRST     build_all
h: created directory
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omAlloc.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCode.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCopy.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCopyValu.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omCreate.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omDelete.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omEntry.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omGet.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omInst.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omPut.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omRead.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omRemove.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omTrace.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omVersion.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omWkspace.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omWrite.c
c89 -c    -D_SHARED_LIBRARIES  +z   -DTHREADSAFE -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DHPUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I. -I/users/annie/dce11/src/directory/xom -I/project/dce/build/dce1.1/src/directory/xom  -Ih -I/users/annie/dce11/src/directory/xom/h -I/project/dce/build/dce1.1/src/directory/xom/h -I../xoms/h -I/users/annie/dce11/src/directory/xoms/h -I/project/dce/build/dce1.1/src/directory/xoms/h -I/users/annie/dce11/export/hp800/usr/include -I/project/dce/build/dce1.1/export/hp800/usr/include    /project/dce/build/dce1.1/src/directory/xom/omXext.c
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o
rm -rf /users/annie/dce11/export/hp800/usr/lib/libXOM.a
makepath /users/annie/dce11/export/hp800/usr/lib/libXOM.a
(cd .; tar cfh - libXOM.a) |  (cd /users/annie/dce11/export/hp800/usr/lib; tar xf -)
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
[ /directory/xom/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=BASIC     build_all
ar crl libXOM.a omAlloc.o omCode.o omCopy.o omCopyValu.o omCreate.o omDelete.o omEntry.o omGet.o omInst.o omPut.o omRead.o omRemove.o omTrace.o omVersion.o omWkspace.o omWrite.o omXext.o



CR Number                     : 11237
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : need a suspend command
Reported Date                 : 7/11/94
Found in Baseline             : 1.1b11, 1.2
Found Date                    : 7/11/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[7/11/94 public]
There should be a way to suspend dcecp without control-Z.  (You can
suspend it on HP, where you can on osf/1.)  A builtin "suspend" command
would do it.

[6/5/96 public]
Moved from 'defer' to 'open'.



CR Number                     : 11236
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : spurious mesage with -s option
Reported Date                 : 7/11/94
Found in Baseline             : 1.1b11
Found Date                    : 7/11/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/11/94 public]

; dcecp -s
invalid command name "-----------------------------------------------------------"
dcecp>

[7/11/94 public]
I can't reproduce this. I've tried this on my 486, my HP and your HP sulphur,
with no problems. Any help on getting this to recur?

[07/12/94 public]
errors in my .dcecprc file.  mea culpa.
Does it make sense for dcecp to print the input filename on error?

[7/1/94 public]
Well, it's Tcl generating the error.  And there is always errorInfo:

  dcecp>  cat > foo
  -----------------
  dcecp> source foo
  Error: invalid command name "-----------------"
  dcecp> echo $errorInfo
  {invalid command name "-----------------"
      while executing
  "-----------------"
      (file "foo" line 1)
      invoked from within
  "source foo"}
  dcecp>



CR Number                     : 11223
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dts
Subcomponent Name             : dtsd
Short Description             : dtsd fails to start, even after
a reboot, dtsd ERROR dts dtserror 0x7aff0340
Reported Date                 : 7/8/94
Found in Baseline             : 1.1
Found Date                    : 7/8/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : none
Sensitivity                   : public

[7/8/94 public]

NB of July 5. 

-rwxr-xr-x   1 bin      bin       348808 Jul  5 23:34 /opt/dcelocal/bin/dtsd

I am not sure if this is a duplicate of OT 11119 or related.
I did not find the message printed here by dtsd in 11119.
dtsd takes a long time to print the message. The error happens 
everytime /etc/rc.dce starts -

root@bronze> /etc/rc.dce
        /opt/dcelocal/bin/dced
No currently established network identity for which context exists
DCED listening...
        /opt/dcelocal/bin/secd
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/dtsd -s
1994-07-08-16:08:41.809-04:00I----- dtsd ERROR dts dtserror 0x7aff0340
Error in rpc_mgmt_is_server_listing() call: status 0x00000000 (? / aaa)

Fatal error at line 275 in file /project/dce/build/dce1.1-snap/src/time/service/transport_rpc.c
        /opt/dcelocal/bin/dtstimed
root@bronze> uptime
  4:10pm  up 16 mins,  9 users,  load average: 0.29, 0.30, 0.27

[07/11/94 public]

Some additional light on this problem. The error messages is generated
when the dtsd has called rpc_mgmt_is_server_listening() in a loop 
for K_MAX_LISTEN_COUNT (30) time, waiting for 5 seconds per loop. 
It exits the loop if rpc_mgmt_is_server_listening return TgRUE, or 
if the call returns an error, or if the loop count is exhausted. 

There is an outstanding bug in the code that always prints the DCE
error code regardless of the reason for failure, which is why we see 
an error status of 0.

dtsd creates a separate thread to perform initialization, and then 
issue the rpc_server_listen() call. The above tells me that the dtsd
failed to initialize properly.

[7/14/94 public]

Some further information. I configured a 2 machine cell (servers on
HP, client on 486 with bl-11), and started DCE. Both machines came up
fine. I then stopped the DCE processes on the client machine, and then
restarted. Everything worked fine. 

As stated earlier, I suspect a problem with cdsd in that cell. The
symptoms of this bug are certainly consistent with being unable to
successfully contact the namespace (although a failure would have
generated a set of different error messages). 

I will continue to check into this, but I do not believe that this is
a dts problem per se. Note that a fix for the uninformative error
message above has already been submitted.

[7/15/94]

After talking with Martha, we have agreed to cancel this CR. A more
informative error message is now generated, and the sams file will be
updated to indicate that the system administrator should investigate
whether the namespace is working properly.



CR Number                     : 11202
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : acl
Short Description             : acl show on nonexistant obj cores
Reported Date                 : 7/7/94
Found in Baseline             : 1.1b10
Found Date                    : 7/7/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/7/94 public]
When running on the 486, logged in as root, I received the following:

(gdb) r
Starting program: /bin/dcecp 
dcecp> acl show /.:/hosts/resuce/aud-acl

Program received signal 11, Segmentation fault
0xa40033e4 in dcp_svc_handle ()
(gdb) where
#0  0xa40033e4 in dcp_svc_handle ()
#1  0xa40032fc in dcp_svc_handle ()
#2  0xa40baa94 in dcp_svc_handle ()
#3  0xa4108a29 in dcp_svc_handle ()
#4  0xa411ca2a in dcp_svc_handle ()
#5  0xa41164d0 in dcp_svc_handle ()
#6  0xa411bbb7 in dcp_svc_handle ()
#7  0xa4183a14 in dcp_svc_handle ()
#8  0xa4182385 in dcp_svc_handle ()
#9  0xa4181d7c in dcp_svc_handle ()
#10 0xa417fa28 in dcp_svc_handle ()
#11 0xa4242a88 in dcp_svc_handle ()
#12 0xa424200a in dcp_svc_handle ()
#13 0x42e79e in dcp_acl_bind_named_object (interp=0x4d0008, dcp_acl_info_p=0x4cb078, 
    bind_to_entry=0) at /project/dce/build/dce1.1-snap/src/admin/dcecp/acl_edit.c:264
#14 0x42e574 in dcp_acl_show (clientData=0x0, interp=0x4d0008, argc=2, argv=0xbffff328)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/acl_tclif.c:1199
#15 0x4035c5 in dcp_acl (clientData=0x0, interp=0x4d0008, argc=2, argv=0xbffff328)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c:1616
#16 0x48c5a9 in Tcl_Eval (5046280, -1073743520)
#17 0x49c01f in Tcl_RecordAndEval (5046280, -1073743520, 0)
#18 0x4006ff in main (argc=1, argv=0xbffffa5c)
    at /project/dce/build/dce1.1-snap/src/admin/dcecp/main.c:396


Notice that the name given to aud show was invalid (typo).

[7/7/94 public]
It seems that every dcecp command dumped core. Must have been bit
rot or a configuration problem. The problem has gone away, and I
can't reproduce it again. Cancelled.



CR Number                     : 11199
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : utils
Short Description             : isllist() returns incorrect value.
Reported Date                 : 7/7/94
Found in Baseline             : 1.1b10
Found Date                    : 7/7/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/7/94 public]

The following command adds three era's to an existing principal.

dcecp> principal modify bar -add {{test_integer 101} {test_void} {test_bytes "a"}}

This command works fine, as it should.  However, if you try and add the same three
era's, but in a different order, you get an error.  The following
command does not work:

dcecp> principal modify bar -add {{test_void} {test_integer 101} {test_bytes "a"}}

The failure is in parse_attribute_list() where a determination is made
whetner or not the passed-in attribute list is a list of lists.  This is
done by the function isllist().  The isllist() function only looks at the
first element in the argument list passed to it.  If the first element is
a "tcl list", then TRUE is returned.  If the first element is not, then
FALSE is returned.

In the above example, when {test_integer 101} is the first element in
the list, isllist() returns TRUE.  When {test_void} is the first
element in the list, isllist() returns FALSE.  The return of FALSE
causes problems later during the processing of the three elements.

Somehow, isllist() must be modified to support void-type attributes.

[7/7/94 public]

It could be better to loop thr all elements of the list and return
true if one of elements has a size larger than 1. (i.e change
cmd_string to "llength [ lindex {%s} %d ]")

[kevins 7/8/94 public] 

The original intent of this function was two-fold. 
a.) verify entry was list of lists. 
b.) rough check on contents. 

I think for the most part the second intent is irrelevant. This check should 
be done for each attribute during the processing of each attribute. I have
come up with a fix that will verify list of lists regardless of the 
number of entries within each list element. So... Here are the 
expected results if I make this change. 

list                return value   reasoning
{a b c d}             0            all elements of list single 
{{a} {a b} {a b}}     1            2 elements are lists
{{a b} {a} {a b}}     1            2 elements are lists
{{a} {b} {c} {a c d}} 1            1 element is a list

If anybody has any other conditions they would like let me know.

[kevins 8/3/94 public] 

I have canceled this since changing the procedure by which isllist 
works will break a variety of things. Modifying the algorithm
according to my table above would break the following list:

{name {value with spaces}}

Clearly such a break is unacceptable. We have come up with a
workaround that is: Void type attributes are not allowed in the first 
position of an attribute list. This will documented.



CR Number                     : 11198
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpc/cn
Short Description             : cache a binding to ep map
Reported Date                 : 7/7/94
Found in Baseline             : 1.1
Found Date                    : 7/7/94
Severity                      : D
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/7/94 public]

Under some circumstances it might make sense for the client runtime
to keep a binding handle open to the EP map on a remote host.  Not sure
WHEN it would make sense to do this, other then for faster benchmarking,
but it might make sense.

[7/7/94 public]

You mean "keep an association open to the EP mapper". It's really a server
(EP mapper) runtime who decides when the association gets shutdown.
Currently, it takes at most 30 seconds (10~30) for the open association to
get closed. (So, if the client keeps calling ep_resolve() (or others) every
10 seconds, the association stays open.) Also, keeing an association open
means keeping its receiver thread around. How many receiver threads would
you like to have in the EP mapper? :-) (Of course, if CN had a listener
thread instead of receiver threads...)

[8/30/94 public]
Sounds like this would hurt more than help.
Canceled.



CR Number                     : 11196
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : rgy
Short Description             : attribute "quota" doesn't seem to work right.
Reported Date                 : 7/7/94
Found in Baseline             : 1.1b11
Found Date                    : 7/7/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rgy_utils.c
Sensitivity                   : public

[7/7/94 public]

Not long ago I used to be able to do this:

   dcecp> principal modify bar -change {quota 101}

and it would work just fine.  Now when I do this, I
get the error message

   Error: The attribute name is not a recognized attribute.

It seems the function rgy_attribute(), when passed the
attribute name "quota", returns 0 instead of whatever it used
to return.  And when 0 is returned, the encode_rgy_pgo_item_attr()
function treads the attribute name as if it were either
an extended attribute or an unknown attribute, thus the above
error message.  This happens with "fullname" as well.

Note that

   dcecp> principal modify bar -quota 101

works fine.

[7/7/94 public]

I cannot reproduce this. What is the versioon of the installation that 
you have? You may want to try reinstalling /opt/dcelocal/dcecp/* and then
running (as root) 

auto_mkindex $dcecp_library *.dcp

[kevins 7/11/94 public] 

Not reproducable.



CR Number                     : 11173
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : EP resolution
Short Description             : de-serialize
Reported Date                 : 7/5/94
Found in Baseline             : 1.1
Found Date                    : 7/5/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/5/94 public]
The EP resolution (and compatibility) code maintains the single global
lock (pthread_mutex) used by rpcd.  We could gain some speed by splitting
this into a three-level read/read-intent-to-write/write lock.

[08/26/94 public]
This turns out to be too tricky to do (the context handle needs to modify
the incore lists) and might not gain anything anyway (same comment).



CR Number                     : 11169
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : aud
Short Description             : needs paging or some other way to
manage the screen output
Reported Date                 : 7/1/94
Found in Baseline             : 1.1
Found Date                    : 7/1/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/1/94 public]

The audit trails quickly grow very large.  The existing audtrail show
command is not very useful in viewing this data.  When sending to the
screen, it would be useful to have the data displayed a screen full at
a time (like "more" or better yet like "less", so that you can navigate
the text).

Another nice improvement would be to have the ability to write to a
file completely from a command line - ie.

/opt/dcelocal/bin/auditcp audtrail show <audit trail filename>  

and the ability to redirect this to a file.

At least for security, with CR 11166 makes both audit file viewing options
unusable.  When sending to a file, we get core dumps and when sending to the
screen there is so much data it quickly exceeds the ability to scroll the
window to view it.

[7/6/94 public]
Use:

 dcecp> audtrail show <audit trail filename> -to <output filename>



CR Number                     : 11168
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : Filters have no effect on local files
Reported Date                 : 7/1/94
Found in Baseline             : 1.1
Found Date                    : 7/1/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/1/94 public]

When using local files instead of the central trail file, filters 
seem to have no effect.  auditcp allows me to add them, but I see
no difference in what is output to my local trail file when they
are in place.

[7/6/94 public]
I'm not sure whether this is in auditd or auditcp.  Do you encounter the
problem using dcecp?

[7/11/94 public]
You have to set environment variable DCEAUDITFILTERON = 1 in order for the
filters to become active.



CR Number                     : 11159
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : user ACL entry type not working with user_delegate ACL entry type
Reported Date                 : 7/1/94
Found in Baseline             : 1.1
Found Date                    : 7/1/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/1/94 public]

I ran dlg test with bl-10.4 "lastgoodbuild" on an 486 machine.
The test worked fine.

However, I tried a slight modification on the ACLs, the test failed.
After checking with a few people here, it seems to indicate a bug.

When I run dlg_acl_setup the acl for /.:/myfilesystem/mike looks as follows:

# SEC_ACL for /.:/myfilesystem/mike:
# Default cell = /.../clam_cell.osf.org
mask_obj:-rwx---
user:dlg_test:-rwx---
user_delegate:dlg_svr:-rwx---


And if I run dlg_client it passes:

root@clam {7} ==> ./dlg_client
PASSED: Delegation test


However, if I add the ACL  "user:dlg_svr:-------" :

# SEC_ACL for /.:/myfilesystem/mike:
# Default cell = /.../clam_cell.osf.org
mask_obj:-rwx---
user:dlg_test:-rwx---
user:dlg_svr:-------
user_delegate:dlg_svr:-rwx---

I would think that dlg_client would still pass
since dlg_svr is the delegate. However if I run the test it fails:

root@clam {11} ==> ./dlg_client
FAILED: Delegation test; Error from dlg_test_access

[7/1/94 public]

The delegate does a sec_acl_test_access on a CDS object.
Assigned to HP.

[7/5/94 public]
Yikes, I go away for a day and get back a half day late and my mailbox is
full of messages on who owns a non-problem (I got two of every message to top
it off because they were all sent to me and dce-ot-sec).  That'll teach me to
take a long weekend :-( :-)

This is not a bug.  I've cancelled this CR.
You explicitly denied access to the delegate (removed all permissions), so
the delegate should no longer be able to access the object, so the test to
access the object as a delegate for a user should fail.  ACL entries are
evaluated in order (order listed in the docs for the basic entries, and the
_delegate entries are inserted into that list after their corresponding
normal entries).  A delegate can match either a regular entry or an _delegate
entry.  You normally only give the delegate principal an _delegate entry
because you don't want to give it access on its own, but if you do add a
user entry for it, it will be evaluated, and as with all DCE ACLs, the first
denial off access causes the algorithm to terminate immediately.



CR Number                     : 11150
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : many debug messages in core smoketest
Reported Date                 : 6/30/94
Found in Baseline             : 1.1
Found Date                    : 6/30/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/30/94 public]

Folks,

I'm not sure who to assign this OT to.  Feel free to re-assign it.
Anyway, I'm filing it more to make known an inconvenience than to
assign a bug for immediate fixing.

The core smoketests now output to their logs thousands (from 3000+ on the
486 to 8440 on the RIOS) of the following "dts DEBUG1" messages.  Added
to the warnings from serviceability already output to the logs, it makes
examining the core smoketest logs a bit arduous:

(eg, on the RIOS mudslide:) 

....

1994-06-30-11:40:03.315+00:00I----- dtsd DEBUG1 dts threads 0x005cf300
--> Waking Main Thread

1994-06-30-11:40:03.315+00:00I----- dtsd DEBUG1 dts threads 0x005cf300
TP:  Waiting for main to process TP ctrl

1994-06-30-11:40:03.315+00:00I----- dtsd DEBUG1 dts threads 0xa4471bc4
Main:  awakened with event

1994-06-30-11:40:03.315+00:00I----- dtsd DEBUG1 dts threads 0xa4471bc4
Main:  Got ETprvdrFail event

1994-06-30-11:40:03.315+00:00I----- dtsd DEBUG1 dts states 0xa4471bc4
INrcvdTPresponse
1994-06-30-11:40:03.325+00:00I----- dtsd DEBUG1 dts states 0xa4471bc4
to state STprvdrWTMO, at 94-06-30-11:40:03.315 GMT

1994-06-30-11:40:03.325+00:00I----- dtsd DEBUG1 dts threads 0xa4471bc4
Main:  Processsing TP control message

1994-06-30-11:40:03.325+00:00I----- dtsd DEBUG1 dts states 0xa4471bc4
No response from TP on request 22447

Etc.

[6/30/94 public]

Reassigned OT - Roger Woodbury's no longer at OSF.

[6/30/94 public]

I have never seen DTS debug messages are never printed unless an
explicit routing directive exists in a routing file. This will either
be the default routing file (in /opt/dcelocal/var/svc/routing, I
believe) or a file specified by the presence of an environment
variable (DCE_SVC_ROUTING_FILE [I believe]).

The short answer is: debug messages must be turned on explicitly. Turn
them off.

[7/1/94 public]

This is not a DTS bug, but rather a "configuration/setup" problem. 
Therefore, I'm cancelling the bug, and, at Ron's suggestion, asking
Gail to look into this.

[7/1/94 public]

Sally and I spent about half an hour playing on one of the smoketest
machines (sif, a AT486 machine). When logged in as root, restarting 
dtsd via "dtsd -s" did NOT result in debug messages being sent to to 
either stdout or stderr. 

The serviceability routing file (/opt/dcelocal/var/svc/routing) has 
nothing enabled. 

The env-variable DCE_SVC_ROUTING_FILE was not set in the environment.

As a test, we uncommented the following line in .../routing 

dts:*.1,arith.d:STDERR:

When run in this fashion, we immediately saw debug messages, followed 
by the warning message: too few servers... Note that this is *not* the
case in the do_automatic_test.log, where the Warning message is seen
first, followed (1 minute later) by the debug messages.

So ... 

it doesn't appear that there are any changes in the environment that
would explain why dtsd is now printing debug messages, and it doesn't
when started by hand (with a "clean" environment). The behavior almost
looks like debugging was turned on via the serviceability RPC
interface, but that may be a red herring.

Re-open, assign to bld. This is *not* a dtsd error per se; rather, a 
mystery (for the moment).

[07/01/94 public ]
Re-assined to unknown - since it doesn't seem to be a dts problem
and it doesn't seem to be a smoketest script problem - I don't know
who to give it to.  Is there by any chance an overriding debug mechanism
in DCE that can override what debug level is set in the individual daemons?

[8/24/94 public]
Mystery solved.  The dcecp test script turns on the dtsd svc debug.
Canceled.

[8/24/94 public]
FYI, here is a patch to the smoketest script:

absolut u1/melman$ diff -c smoketest smoketest~
*** smoketest   Mon Aug 22 15:03:45 1994
--- smoketest~  Mon Aug 22 15:03:45 1994
***************
*** 122,128 ****
  log modify /.:/hosts/$hostname/dts-entity -change dts:*.5:STDOUT:
  log show /.:/hosts/$hostname/dts-entity 
  log show /.:/hosts/$hostname/dts-entity -debug
- log modify /.:/hosts/$hostname/dts-entity -change dts:*.5:DISCARD:
  #dts deactivate /.:/hosts/$hostname/dts-entity
  #dts stop /.:/hosts/$hostname/dts-entity
  #exec /opt/dcelocal/bin/dtsd -s &
--- 122,127 ----



CR Number                     : 11147
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : idl encoding services
Short Description             : wrong handle type
Reported Date                 : 6/30/94
Found in Baseline             : 1.1
Found Date                    : 6/30/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/30/94 public]

When using IDL encoding services the generated functions (as spelt into
the cstub and header file) expect a handle_t as their first parameter.
They should be expecting an idl_es_handle_t.  Right now you get compiler
warnings.

[7/7/94 public]
It would be helpful to have an example of what should
be changed (the genereated source).  I don't have the faintest idea
of where to start looking for this code in idl.

Any help from Rico would be appreciated.

[07/08/94 public]

It looks like it was user-error.  I had checked out the IDL file but
not the ACF file.  Danger, Will Robinson -- DONT DO THAT.
Cancel.



CR Number                     : 11144
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : utils
Subcomponent Name             : svc
Short Description             : can't build svcbin_cstub.c because utctypes.h is missing
Reported Date                 : 6/30/94
Found in Baseline             : 1.1
Found Date                    : 6/30/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : /dev/null
Sensitivity                   : public

[6/30/94 public]

I created a totally new sandbox  named j on AT386
(base: /tmp/jk, backed against /project/dce/build/dce1.1), did

mkdir -p dce/utils/svc
cd dce/utils/svc
build

and got:

relative path: ./dce/utils/svc
mkdir ../../../../obj/at386/dce
mkdir ../../../../obj/at386/dce/utils
mkdir ../../../../obj/at386/dce/utils/svc
cd ../../../../obj/at386/dce/utils/svc
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
/project/dce/build//dce1.1/tools/at386/bin/sams  -oh /project/dce/build/dce1.1/src/dce/utils/svc/svc.sams
/project/dce/build//dce1.1/tools/at386/bin/sams  -ot /project/dce/build/dce1.1/src/dce/utils/svc/svc.sams
/project/dce/build//dce1.1/tools/at386/bin/sams  -omc /project/dce/build/dce1.1/src/dce/utils/svc/svc.sams
rm -rf service.h
/project/dce/build//dce1.1/tools/at386/bin/idl -cpp_cmd "/project/dce/build//dce1.1/tools/at386/macho/cpp"     -no_mepv -keep c_source   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -client none -server none /project/dce/build/dce1.1/src/dce/utils/svc/service.idl
rm -rf svcbin.h
/project/dce/build//dce1.1/tools/at386/bin/idl -cpp_cmd "/project/dce/build//dce1.1/tools/at386/macho/cpp"     -no_mepv -keep c_source  -I../../../time/common -I/tmp/jk/j/src/time/common -I/tmp/jk/j/src/time/common -I/project/dce/build/dce1.1/src/time/common -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -client none -server none /project/dce/build/dce1.1/src/dce/utils/svc/svcbin.idl
rm -rf /tmp/jk/j/export/at386/usr/include/dce/service.h
makepath /tmp/jk/j/export/at386/usr/include/dce/service.h
(cd .; tar cfh - service.h) |  (cd /tmp/jk/j/export/at386/usr/include/dce; tar xf -)
rm -rf /tmp/jk/j/export/at386/usr/include/dce/svcbin.h
makepath /tmp/jk/j/export/at386/usr/include/dce/svcbin.h
(cd .; tar cfh - svcbin.h) |  (cd /tmp/jk/j/export/at386/usr/include/dce; tar xf -)
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
rm -rf /tmp/jk/j/export/at386/usr/include/dce/dcesvcmsg.h
makepath /tmp/jk/j/export/at386/usr/include/dce/dcesvcmsg.h
(cd .; tar cfh - dcesvcmsg.h) |  (cd /tmp/jk/j/export/at386/usr/include/dce; tar xf -)
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msgdeftable.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msggetdef.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msggetmsg.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msgget.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msgtable.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msgtrans.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msgxpgcat.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/msgpthread.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/rpmatch.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/dceassert.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/dceprintf.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcprintf.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcreg.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcroute.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcfilter.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svclog.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcpthread.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcremimpl.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcacl.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcaclacc.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcaclconv.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   /project/dce/build/dce1.1/src/dce/utils/svc/svcaclstore.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   dcesvcmsg.c
rm -rf service_sstub.c
/project/dce/build//dce1.1/tools/at386/bin/idl -cpp_cmd "/project/dce/build//dce1.1/tools/at386/macho/cpp"     -no_mepv -keep c_source   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -client none -header /tmp/service.h /project/dce/build/dce1.1/src/dce/utils/svc/service.idl
rm -rf /tmp/service.h
rm -rf svcbin_cstub.c
/project/dce/build//dce1.1/tools/at386/bin/idl -cpp_cmd "/project/dce/build//dce1.1/tools/at386/macho/cpp"     -no_mepv -keep c_source  -I../../../time/common -I/tmp/jk/j/src/time/common -I/tmp/jk/j/src/time/common -I/project/dce/build/dce1.1/src/time/common -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -server none -header /tmp/svcbin.h /project/dce/build/dce1.1/src/dce/utils/svc/svcbin.idl
rm -rf /tmp/svcbin.h
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc   -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   service_sstub.c
/project/dce/build//dce1.1/tools/at386/macho/gcc -B/project/dce/build//dce1.1/tools/at386/macho/  -c    -D_SHARED_LIBRARIES -O      -I. -I/tmp/jk/j/src/dce/utils/svc -I/tmp/jk/j/src/dce/utils/svc -I/project/dce/build/dce1.1/src/dce/utils/svc  -I../../../time/common -I/tmp/jk/j/src/time/common -I/tmp/jk/j/src/time/common -I/project/dce/build/dce1.1/src/time/common -I/tmp/jk/j/export/at386/usr/include -I/tmp/jk/j/export/at386/usr/include -I/project/dce/build//dce1.1/export/at386/usr/include   -pic-lib   -L/tmp/jk/j/export/at386/usr/shlib -L/tmp/jk/j/export/at386/usr/shlib -L/project/dce/build//dce1.1/export/at386/usr/shlib -L/usr/shlib -L/tmp/jk/j/export/at386/usr/lib     -L/tmp/jk/j/export/at386/usr/lib     -L/project/dce/build//dce1.1/export/at386/usr/lib    -ldce   svcbin_cstub.c
In file included from svcbin_cstub.c:5:
./svcbin.h:21: utctypes.h: No such file or directory
*** Error code 1
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.


I think utctypes.h should be included with <dce/utctypes.h>. (??)

[06/30/94 public]
OK - you have to build time/common first. Then utctypes.h is copied
to <my_sb>/obj/at386/time/common, and SVC finds it there via INCFLAGS.

I think svcbin.h should really include <dce/utctypes.h>.
It is not a good style to include header files from the object tree.

[6/3/94 public]

In general you can not create an empty sandbox, "cd" someplace, and build.
This is what makes it work for most components: "build export_all_EXPINC"
from the top of the tree in your sandbox.  (takes 15 min?)

You can't include <dce/utctypes.h>, because during the export pass, when
we're in svc, utctypes.h has not yet been exported.  The comment in
svcbin.idl says:
	/* Change back when top-level Makefile visits time (or time/common?)
	 * before dce/utils/svc in the export pass. */
	/*import "dce/utctypes.idl";*/
	import "utctypes.idl";
I am told that there are plans to fix this and a lot of similar cases (all
at the same time).  (Don't know the CR)



CR Number                     : 11139
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : 
Short Description             : Syntax error in dce_config
Reported Date                 : 6/30/94
Found in Baseline             : 1.1
Found Date                    : 6/30/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/30/94 public]
This occured while shutting down my single machine cell.  dce_config is
from NB of 6/29.

        selection:  4 
S:****** Attempting to stop all running DCE daemons...
waitfor[4]: 5160 5322: Syntax error

[8/24/94 public]
I don't think anyone has seen this since Rich has.
The problem is the awkward way in which we use 'ps' to get
the pid's of the daemons.  If you have any other processes
which have the same name as one of the daemons, the scripts
will pick up this process.

This wont happen on any system that has a POSIX compliant ps
because you can limit the output to just the actual command
that is running.

I could try to prevent the syntax error, but I can never make
the base problem go away until dced start/stops all the servers
or the daemons put their pids into a pid file.



CR Number                     : 11137
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd aborts if cdsadv dies unexpectedly
Reported Date                 : 6/29/94
Found in Baseline             : 1.0.3
Found Date                    : 6/29/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : cds/library/unix_mbx.c
Sensitivity                   : public

[6/29/94 public]
 
 DESCRIPTION: Running the SDC test suites included trying the command
 "cdscp disable clerk."  This command shuts down all clerks and the
 cdsadv on the local system.  The next time the cdsd attempted to ping
 the cdsadv, it took a SIGPIPE, because there was no process at the
 other end of its connection.  The cdsd had no handler for this
 condition and the resulting mass of circumstances caused it to abort.

 PROPOSED SOLUTION:
 Put a TRY clause around the mailbox write so that SIGPIPE errors
 can be mapped to an error status.
 
*** unix_mbx.c  Wed Jun 29 17:01:37 1994
--- unix_mbx.c.new      Wed Jun 29 17:14:08 1994
***************
*** 743,762 ****
      byte_t            *buf_p;
      int                       len;
  {
!     register int fd, status;
  
!     while (0 <= (fd = mbx_p->data_fd))
        /* CANCEL POINT */
        if (0 < (status = dthread_write(fd, (char *)buf_p, len))) {
!           buf_p = SKIP_bytes(buf_p, status);
!           if ((len -= status) == 0)
!               break;
!       } else if (status == 0)
!           return (DNS_ERROR);
!       else
!           return (DNS_UNIXERRORS + errno);
  
!     return (DNS_SUCCESS);
  }
  
  static void
--- 743,772 ----
      byte_t            *buf_p;
      int                       len;
  {
!     register int fd, status, code = DNS_SUCCESS;
  
!     TRY {
!       while (0 <= (fd = mbx_p->data_fd))
        /* CANCEL POINT */
        if (0 < (status = dthread_write(fd, (char *)buf_p, len))) {
!         buf_p = SKIP_bytes(buf_p, status);
!         if ((len -= status) == 0)
!           break;
!       } else if (status == 0) {
!         code = DNS_ERROR;
!         break;
!       } 
!       else {
!           code = DNS_UNIXERRORS + errno;
!           break;
!         }
!     }
!     CATCH (exc_e_SIGPIPE) {
!       code = DNS_UNIXERRORS + EPIPE;
!     }
!     ENDTRY;
  
!     return (code);
  }
  
  static void

[6/30/94 public]
This was fixed in 1.1 a month or two ago.  I just went through the closed bugs
and couldn't spot the ot. I'll see if I can find it today and make this a dup.

[7/5/94 public]
Cancelled.



CR Number                     : 11136
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dts
Subcomponent Name             : 
Short Description             : dtsd WARNING "Too few servers"
Reported Date                 : 6/29/94
Found in Baseline             : 1.1
Found Date                    : 6/29/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/29/94 public]


I configured a one node cell from bl-10.3 on a 486 machine.
When I choose DTS Local Server from the DTS Configuration Menu
I got the following:


        selection:  1994-06-29-17:16:15.730-04:00I----- dtsd WARNING dts config 0xa44b4acc
Too fews servers (1), need 3 servers


This looks like this might be an error.

[6/29/94 public]

And the message continues to be issued at approximately 1 minute intervals


 fews servers (1), need 3 servers
1994-06-29-17:24:28.847-04:00I----- dtsd WARNING dts config 0xa44b4acc
Too fews servers (1), need 3 servers
1994-06-29-17:26:03.300-04:00I----- dtsd WARNING dts config 0xa44b4acc
Too fews servers (1), need 3 servers

[6/29/94 public]
Not to belabor the obvious but the above are WARNINGs.
You only have 1 server, DTS wants 3.

If you don't wish to see these warnings, you should edit the
/opt/dcelocal/var/svc/routing file and direct them to a file (or /dev/null).

Or better yet, run a Time Provider on this machine.

[6/29/94 public]
This is documented behavior on the part of the dtsd. 
See section 15.4.1.1 of the OSF DCE Administration Guide on how to 
change the number of servers required.

[6/29/94 public]
I did the following:

  $ dcecp
  dcecp> login cell_admin -password -dce-
  dcecp> dts mod -minservers 1
  dcecp>



CR Number                     : 11131
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpcd
Short Description             : portability change to dsm_p.h
Reported Date                 : 6/29/94
Found in Baseline             : 1.1
Found Date                    : 6/29/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dsm_p.h
Sensitivity                   : public

[6/29/94 public]

Currently PREHEADER is defined as:

  #define PREHEADER   16                  /* length of preheader */

A more portable definition would be:

  #define PREHEADER   (sizeof(block_t)-sizeof(double)) /* length of preheader */

The above change is needed to make rpcd work on systems that have longs
greater than 32 bits.

[06/29/94 public]
dsm_p.h is part of rpcd which will be moving to nosupport for 1.1.
dced does not have this problem, it doesn't use DSM.
I think this can be cancelled.

[6/29/94 public]
Rich is correct, rpcd is no longer supported in 1.1.
But thanks for pointing this out!
Canceled.



CR Number                     : 11129
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : audf create returns "principal xx is not registered or has been removed"
Reported Date                 : 6/29/94
Found in Baseline             : 1.1b10
Found Date                    : 6/29/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/29/94 public]
This problem may be realted to CR 11128.

Attempting to create a new filter fails when auditd is in some
strange state. This normally works.

[ninja]:/usr/sandbox/dcecp/src/admin/dcecp> dcecp
You are 'cell_admin' logged into '/.../dcecp_cell.osf.org'.
dcecp> principal create at3
dcecp> audf create {principal at3} -at {dce_dts_synch all all}
Error: principal USrIrIMrI8 is not registered or has been removed
dcecp> principal show at3
{fullname {}}
{uid 12434}
{uuid 00003092-9358-21cd-8f00-0800092734a4}
{alias no}
{quota unlimited}

[8/10/94 public]
Unable to reproduce. Cancel.



CR Number                     : 11128
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : audfilter catalog returns "auth ticket expired"
Reported Date                 : 6/29/94
Found in Baseline             : 1.1b10
Found Date                    : 6/29/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/29/94 public]
I have (for the second time) put auditd in a state where it returns an
"auth ticket expired" from audit_control_list_filter(). There are about
10 filters that have already been created.

auditcp hangs for about 30 seconds, and then returns without error
(or any information).

audevents catalog and any other operation requiring authentication
works correctly.

auditcp:
[ninja]:/usr/sandbox/dcecp/src/admin/dcecp> auditcp
auditcp> audfilter catalog
auditcp> 


dcecp:
[ninja]:/usr/sandbox/dcecp/src/admin/dcecp> dcecp
You are 'cell_admin' logged into '/.../dcecp_cell.osf.org'.
dcecp> audf cat
Error: auth ticket expired

[7/18/94 public]
dcecp's login context has its ticket expired, it is not an error,
nothing to do with auditd.  cancelled.



CR Number                     : 11120
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : annoying message
Reported Date                 : 6/28/94
Found in Baseline             : 1.1
Found Date                    : 6/28/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/28/94 public]
When you invoke dcecp and you do not have HOME set in your environment, you
get:

'couldn't find HOME environment variable to expand "~/.dcecprc"'

Is it really necessary to print this?  This isn't a error; it's merely a
notice -- dcecp works find without a .dcecprc file.  Why not let it just
continue quietly and if I don't get my .dcecprc, so be it.

(The scenario in which this occured is audit FVT, which now use dcecp
instead of auditcp.  There are tens of dcecp invocations so the stdout log
file is filled with this message.  (Strangely, it seems to appear twice.
Is this printed to stdout and stderr?)

[8/16/94 public]
A few things:
 * This is reporting that $HOME is not set, not that the file was not
   found.  This environment variable is supposed to be set by login so it
   is reporting this strange occurance.
 * This is supposed to only occur if dcecp is invoked interactively.  If
   you invoke it with a filename it does not occur:
      absolut admin/dcecp$ echo $HOME
      
      absolut admin/dcecp$ dcecp ~melman/.dcecprc
      absolut admin/dcecp$ 
   So I'm curious about how the audit tests are structured.
 * The error is printed to stderr but I don't see it printed to stdout.

I'm cancelling this bug.  If it is still occuring in the audit FVT's and
this is still annoying feel free to re-open and let me know.



CR Number                     : 11119
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 11223,11272
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cds client
Short Description             : Error with socket/entry not found
Reported Date                 : 6/28/94
Found in Baseline             : 1.1b10
Found Date                    : 6/28/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/28/94 public]
I'm having problems with running dced as the endpoint mapper.

[ninja]:/usr/sandbox/opt/dcelocal/var# /etc/rc.dce
        /opt/dcelocal/bin/dced
No currently established network identity for which context exists
DCED listening...
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/auditd -a
        /opt/dcelocal/bin/dtsd -s
1994-06-28-15:31:19.914-04:00I----- dtsd ERROR dts events 0x004fb368
DCE error Couldn't export time server mgmt interface: : Error with socket (dce / cds)
1994-06-28-15:31:20.264-04:00I----- dtsd ERROR dts events 0x004fb368
DCE error Can't export time control interface: : Error with socket (dce / cds)
        /opt/dcelocal/bin/dts_ntp_provider -h pooch -p 600 -i 30
1994-06-28-15:31:25.043-04:00I----- dtsd ERROR dts events 0xa44d1acc
LAN profile not found
[ninja]:/usr/sandbox/opt/dcelocal/var# 1994-06-28-15:31:25.993-04:00I----- dtsd ERROR dts events 0xa44d1acc
DCE error Can't unexport time server mgmt interface: : Error with socket (dce / cds)
1994-06-28-15:31:26.123-04:00I----- dtsd ERROR dts events 0xa44d1acc
DCE error Failure in rpc_ep_unregister: : not registered in endpoint map (dce / rpc)
1994-06-28-15:31:26.143-04:00I----- dtsd ERROR dts events 0xa44d1acc
DCE error Failure in TService interface rpc_ns_binding_unexport: : Error with socket (dce / cds)

[6/30/94 public]
After reconfiguring my machine, auditd will come up, but if I stop auditd,
it will not restart. svc returns the following message:

[ninja]:/usr/users/rousseau# /opt/dcelocal/bin/auditd -a
[ninja]:/usr/users/rousseau# 1994-06-30-13:05:49.400-04:00I----- auditd FATAL aud general 0xa44d1acc
cannot register daemon's svc manager bindings with RPCD

[06/30/94 public]
Note that that status code -- 0xa44d1acc -- is completely bogus:
   ; showst 0xa44d1acc
   Tech = 10 = 012 = 0xa = <unknown>
   Comp = 17617 = 042321 = 0x44d1 = lar
   Mesg = 2764 = 05314 = 0xacc = ???

[7/5/94 public]

I was unable to reproduce what John got (on the 486).

Here's what happens to me:

<config, shutdown, then restart>

root@surf# /etc/rc.dce
        /opt/dcelocal/bin/dced
No currently established network identity for which context exists
DCED listening...
        /opt/dcelocal/bin/secd
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/cdsd
        /opt/dcelocal/bin/auditd -a
        /opt/dcelocal/bin/dtsd -s
1994-07-05-15:49:37.639-04:00I----- auditd FATAL aud general 0xa44b0bc4
cannot register daemon's ACL manager interface bindings
        /opt/dcelocal/bin/dts_ntp_provider -h clock -p 600 -i 30

Looks to me like Audit is having problems somewhere, not RPC.

[07/06/94 public]
John sent this email before taking some time off.  I took a quick
skim through the audit code and didn't see any obvious incorrect
calling sequences...
  What I saw on the way up was rpc_set_auth_info failure with a completly
  bogus status code. On the way down I saw rpc_ep_unregister failures.
  I configed a cell on the 486 and hp this am and did not see the problem
  on the way up. I didn't  bring the cell down so I'm not sure if those 
  messages are still there. I didn't see the error messages below about not
  being able to export a mgmt interface but it might be related

[07/06/94 public]
Upgraded to 0. I'm blocked on this. I can't start auditd to work on any
of the slew of audit bugs I just inherited.

[07/07/94 public]

Other source of "Error with socket"

The are several Error with socket errors printed when running
/etc/dce_shutdown -f:

root@west> /etc/dce_shutdown -f
1994-07-07-11:54:26.710-04:00I0.612 dtsd ERROR dts dtserror 0x7aff8340
Failed to unexport Control interface from the namespace: Error with socket
(dce / cds)
Caught signal 15.  Exiting.
WARNING: dtsd not killed
WARNING: cdsadv not killed
root@west> 1994-07-07-11:55:01.792-04:00I0.647 dtsd ERROR dts dtserror
0x7aff8340
Failed to unexport Service interface from the namespace: communications
failure (dce / rpc)
1994-07-07-11:55:01.810-04:00I0.647 dtsd ERROR dts dtserror 0x7aff8340
Failed to unexport Service interface from the namespace: Error with socket
(dce / cds)
1994-07-07-11:55:01.828-04:00I0.647 dtsd ERROR dts dtserror 0x7aff8340
Failed to remove Service interface from the profile
/.../west_cell/lan-profile: Error with socket (dce / cds)
1994-07-07-11:56:11.757-04:00I0.717 dtsd ERROR dts dtserror 0x7aff8340
Couldn't unregister the version 1.0 rdacl interface from the endpoint map:
communications failure (dce / rpc)
1994-07-07-11:56:11.766-04:00I0.717 dtsd ERROR dts dtserror 0x7aff8340
Failed to unregister dtsd ACL manager interface: communications failure
(dce / rpc)

[7/7/94 public]
You will see these errors from DTS because it now reports errors
on shutdown.  Since you sent a signal to dts and it wnt to shutdown
gracefully, it tries to do namespace things, but its too late, since
dce_shutdown has already moved on to killing CDS.  So, you get errors.
These always happened, but now with SVC, you get to see them.
I believe there is a defect against DTS saying that we should ignore
all errors on shutdown.

Anyway, I believe this problem to be with CDS, since the 
error with socket is a CDS generated status code:

start
code    CDS_SOCKET
tables  (cds_msg_table)
text    "Error with socket"
explanation     "The communications between the DCE library and the cds clerk ch
ild has failed. The connection is closed."
action  "If the problem persists, restart DCE."
end

This is probably because the clerks have died or something.  Note that
libdce does not user RPC to communicate with the clerks, but rather
a local host socket.

[7/7/94 public]
I just tried the same test in the HP server that failed on the client
486, it worked fine. This may explain why other folks could not reproduce
the problem on single machine cells.

[7/7/94 public]
I'm hitting something similar when trying to restart my cell.

1994-07-07-13:54:30.644-04:00I----- dtsd ERROR dts events 0x200dee98
DCE error Couldn't export time server mgmt interface: : entry not found (dce / rpc)
1994-07-07-13:54:30.914-04:00I----- dtsd ERROR dts events 0x200dee98
DCE error Can't export time control interface: : entry not found (dce / rpc)
root@cobbler> 1994-07-07-13:54:36.111-04:00I----- dtsd ERROR dts events 0x200aaef8
LAN profile not found
1994-07-07-13:54:36.563-04:00I----- dtsd ERROR dts events 0x200aaef8
DCE error Can't unexport time server mgmt interface: : entry not found (dce / rpc)
1994-07-07-13:54:36.686-04:00I----- dtsd ERROR dts events 0x200aaef8
DCE error Failure in rpc_ep_unregister: : not registered in endpoint map (dce / rpc)
1994-07-07-13:54:36.759-04:00I----- dtsd ERROR dts events 0x200aaef8
DCE error Failure in TService interface rpc_ns_binding_unexport: : entry not found (dce / rpc)

I am using rpcd so this is not a dced issue. I need DTS to run DFS so this is
blocking me - rebooting and reconfiguring is VERY time consuming - help!

[7/7/94 public]
It is conclusive that this is a cds client problem.  I just configured
my 486 as a client to an HP server with last night nightly build.

DTS, AUD, and DCED (it looks like)  can not use CDS.  

Here is what I did, note that the clerks are running, but I can't
talk to them.

Since John isn't here till tomorrow, can someone at DEC take a look at this?

root@surf# /etc/rc.dce
        /opt/dcelocal/bin/dced
DCED listening...
        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/auditd -a
        /opt/dcelocal/bin/dtsd -c
1994-07-07-14:28:10.845-04:00I----- dtsd ERROR dts dtserror 0x004fc368
Failed to export Time Control V2 interface to the namespace: Error with socket (dce / cds)
1994-07-07-14:28:10.975-04:00I----- dtsd ERROR dts dtserror 0x004fc368
Failed to export Time Control interface to the namespace: Error with socket (dce / cds)
1994-07-07-14:28:12.914-04:00I----- auditd FATAL aud general 0xa44b3bd4
cannot register daemon's ACL manager interface bindings
1994-07-07-14:28:15.884-04:00I----- dtsd ERROR dts dtserror 0xa44b3bd4
Failed to retrieve server binding from the namespace: Error with socket (dce / cds)
1994-07-07-14:28:15.934-04:00I----- dtsd ERROR dts events 0xa44b3bd4
LAN profile not found
1994-07-07-14:28:15.944-04:00I----- dtsd ERROR dts dtserror 0xa44b3bd4
Can't retrieve DCE cell name from configuration DB: Error with socket (dce / cds)
1994-07-07-14:28:15.954-04:00I----- dtsd WARNING dts config 0xa44b3bd4
Too fews servers (0), need 1 servers
root@surf# Can't NS export Security Certification server, Unknown message number 0x10d0a96c
Can't NS export Login Pre-Authentication server, Unknown message number 0x10d0a96c
Can't NS export Password Override server, Unknown message number 0x10d0a96c
Can't NS export Host Data server, Unknown message number 0x10d0a96c
Can't NS export Keytab Management server, Unknown message number 0x10d0a96c
Can't NS export Schema Management server, Unknown message number 0x10d0a96c
Can't NS export Server Configuration server, Unknown message number 0x10d0a96c
Can't NS export Server Execution server, Unknown message number 0x10d0a96c
Can't NS export Security Validation server, Unknown message number 0x10d0a96c

root@surf# 
root@surf# cdscp show dir /.:

                        SHOW
                   DIRECTORY   /.../tsunami_cell
                          AT   1994-07-07-14:29:49
Error on entity: /.../tsunami_cell
Error with socket
Function: dnsEnumAttr

surf>stcode -h 0x10d0a96c
Tech = 1 = 01 = 0x1 = dce
Comp = 3338 = 06412 = 0xd0a = cds
Mesg = 2412 = 04554 = 0x96c = Error with socket

surf>ps auxww | grep opt
tom      20389  2.5  1.0 7.52M 372K pts/0    S  + 14:32:28     0:00.07 grep opt
root     18478  0.0  6.3 9.15M 2.26 ??       S    14:27:58     0:01.48 /opt/dcelocal/bin/sec_clientd
root     18490  0.0  6.3 9.92M 2.29 ??       S    14:27:55     0:01.21 /opt/dcelocal/bin/dced
root     18467  0.0  6.9 9.32M 2.49 ??       S    14:28:04     0:01.55 /opt/dcelocal/bin/dtsd -c
root     18475  0.0  6.6 9.74M 2.39 ??       S    14:28:00     0:01.62 /opt/dcelocal/bin/cdsadv
root     20355  0.0  3.3 8.90M 1.18 ??       S    14:28:05     0:00.38 /opt/dcelocal/bin/cdsclerk
root     20354  0.0  7.1 9.67M 2.57 ??       S    14:28:06     0:02.45 /opt/dcelocal/bin/cdsclerk

[7/8/94 public]
Janet Mccan is unavailable this week so I'm  assigning this to myself until
I can talk to Alan Peckham. I'm back and will look into this this am.

[7/11/94 public]
The auditd problem seems to be a permission problem. auditd on either
the client or the server machine fails to export its binding through
rc.dce because as self it does not have permission to write the server
entry /.:/hosts/<host-name>/aud-acl. During initial configuration
auditd comes up as cell_admin which does have write permission.

The dtsd problem seems a bit harder to get a handle on. I've been running
with a 486 cds/secd/dtsd server, hp800 cds/secd/dtsd pair and the only 
error messages I see in response to either dce.config or dce_shutdown -f
are

On the client (hp)....
Caught signal 15.  Exiting.
Can't NSI unexport Security Validation server, Unknown message number 0x10d0a96c
Unknown message number 0x10d0a96c

On the 486 server
Caught signal 15.  Exiting.
Can't NSI unexport Security Validation server, Error with socket
Error with socket

The 'Caught signal 15' is from the clerk in response to the sig15 sent by
the advertiser. Its ok and a notice shows up in the serviceability log
saying its ok. I'm trying to find out where the other message is comming 
from. I'm also trying to find out why I'm not seeing all the other dts error
messages that others are seeing. I've brought my cell up and down several 
times and dtscp works fine.

[07/13/94 public]
Messages that look like this:
    Can't NS export Security Certification server,
	Unknown message number 0x10d0a96c
are probably dced bugs covered under OT CR 11211 (dced isn't waiting for
cdsd to come up before it registers).
Messages that look like this:
	Can't NS unexport XXXX server
can be ignored because cdsd is down before dced.

[7/13/94 public]

As Rich pointed out all messages with 'Can't NS' should be ignored.

The messages from auditd on its inability to export its ACL manager
bindings are a permission problem and a seperate ot against auditing 
has been opened.

The following two errors from cdsd during shutdown are harmless. We are
looking into it but at a lower priority than other problems. I will open
a seperate lower priority ot. Basically the rpc_ep_unregiter call is
being made with correct arguments but the call is failing. Since all
endpoints are reinitialized on the way up the fact that one doesn't get
unregistered un the way down is of little consequence.

1994-07-13-13:59:25.982-04:00I----- cdsd(18327) ERROR cds server unix_cds_net.c 1522 0x007a8440 Attempt to unregister the clerk/server RPC endpoint has failed with status = not registered in endpoint map (dce / rpc)
1994-07-13-13:59:26.432-04:00I----- cdsd(18327) ERROR cds server unix_cds_net.c 1561 0x007a8440 Attempt to unregister the dacl RPC endpoint has failed with status = not registered in endpoint map (dce / rpc)


The remaining problem is the error messages from dtsd while attempting 
export. I'm still looking at this. 


I don't believe the cds hang problem is related to anything in this ot and 
I have asked Gail to open a seperate ot. Its 11272.

[7/13/94 public]
Regarding the dts error messages, I compared what happens when you
shut the cell down with /etc/dce_shutdown vs. /etc/dce_shutdown -f.
I used the same command on both the server and client in each of 10
runs. The cell was just brought back up, not reconfigured, on each run.

/etc/dce_shutdown 5 times - no dts error messages
/etc/dce_shutdown -f 2 times - got dts error messages
/etc/dce_shutdown 2 times - no dts error messages
/etc/dce_shutdown -f 1 time - got the error messages

Says to me if you let things shut down in order useing the command
programs to shut all of the servers down things work. If you send
kills to the servers at least dts isn't finished with the namespace
and or dced when they go away. I'll see what I can do to sequence things
so the forced shutdown works a bit better but the message here is
don't use forced shutdown. The non forced shutdown attempts to bring
things down gracefully and if anything is left it then and only then
dispatches it with a signal. This takes a bit longer but it works much
better. The -f option tells shutdown to send the signals now - make
no attempt to take the servers down gracefully.

[7/13/94 public]
I'm downgrading the priority on this. The only remaining issue is
sequencing the forced shutdown a bit better. It will remain open untill
then. Tom already opened an ot on cdsd not always going away gracefully
and I'll add the unregister error messages to that. I may very well be
related.

[7/14/94 public]
This bug has gotten too confusing - cancelling and reopening 2 others:
	1 - for the sequencing of the forced shutdown (CR 11290)
	2 - for problems with re-exporting to the namespace (CR 11291)



CR Number                     : 11084
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : Syntax errors.
Reported Date                 : 6/27/94
Found in Baseline             : 1.1
Found Date                    : 6/27/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/27/94 public]

<     case sec_attr_enc_printstring_array: {
<       sec_attr_enc_str_array_t *tosa, *fromsa;
< 
<       fromsa = from->attr_value.tagged_union.string_array;
<       tosa   =   to->attr_value.tagged_union.string_array =
<           (sec_attr_enc_str_array_t *)
<               malloc(sizeof *tosa
	                     ^^^^^^^
<                   + (fromsa->num_strings - 1) * sizeof *tosa->strings);
	                                                ^^^^^^^^^^^^^^^
<       tosa->num_strings = fromsa->num_strings;
<       /* copy each string */
<       for (i = 0; i < tosa->num_strings; i++) {
<           tosa->strings[i] = malloc(strlen((char *)fromsa->strings[i]) + 1);
<           strcpy((char *)tosa->strings[i], (char *)fromsa->strings[i]);
<       }
<       break;
<     }

Note the underlined area's, missing ().

[06/27/94 public]
Did you run into a buggy compiler?  sizeof doesn't require the () unless
the you give it a typename:
	typedef int XXX;
	XXX yyy;
	sizeof yyy === sizeof (XXX)



CR Number                     : 11068
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : 
Short Description             : this is a test, disregard!
Reported Date                 : 6/24/94
Found in Baseline             : 1.1
Found Date                    : 6/24/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/24/94 public]
A test. Disregard!



CR Number                     : 11064
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDSPI - does not accept back slash in Simple Names
Reported Date                 : 6/23/94
Found in Baseline             : 1.0.3
Found Date                    : 6/23/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/23/94 public]

As per OSF DCE 1.0.3 documentation, the meta - characters ( \ * ?)
in CDS simple names can be escaped with back slash. (Appendix A-1 of
Admin Guide -- Core Comp.). This was working in OSF DCE 1.0.2. But in DCE 1.0.3
ig gives syntax error if the simple name contains a back slash
( ie it contains two back slash characters - one escape
character and other the actual back slash character in the name).

DCE 1.1's cdscp and dcecp show the same problem.

To see the problem, do the following:

	$ cdscp
	cdscp> create obj /.:/o\\b

Proposed Solution:

      If this a new restriction in DCE 1.0.3 , please update the
      DCE documentation else fix this defect.

      FYI -- in DCE 1.0.3 there was a change in the parsing logic
             in file "src/directory/cds/library/cdsstrtosimple.c"

[06/27/94 public]
I believe that the docs are misleading -- the intent was that you use
backslash to get Unix wildcard characters into a cds pathname, not
that you can have any chars in a CDS pathname.  The legal set of chars
is defined in the docs somewhere.

I think this should either be a doc defect or cancelled.

[6/27/94 public]
Indeed, the above example is not good. Try the following:

	$ cdscp create obj /.:/o\\b

In 1.0.2, this will create an object of name "o\b". in 1.0.3 and 1.1, it gives 
"syntax error".

So, either the code or the doc must be modified.

[06/27/94 public]
Sorry I was not clear enough.
The code is now right; it was wrong.
Are the docs wrong?

[6/27/94 public]
Then the doc should be changed. Here is what it says in the Appendix A of 
Admin Guide (Core Component), Section A.1 "Metachacters":

"CDS \	Used where necessary in front of a \ (backslash), an *
	(asterisk), or a ? (question mark) to escape the chacter;
	indicates that the following character is not a metacharacter.

Some metachacters are not permitted as normal characters within a name. For
example, a \ (backslash) cannot be used as anything but an escape character
in GDS. ..."

If it is also the case that \ can be used only for escape character but not
as a normal character, this section needs to be changed. Maybe other places 
too.

[6/27/94 public]
According to our Dev Guide Table 23-1:

For CDS a backslash may be used in front of a \, an *, or a ? to escape 
the character. 

For GDS a \ cannot be used as anything but an escape character.

So, it ought to work in CDS and although I don't have a 1.0.3 cell up
I seem to believe it did then. I'll  verify it though. I'll also look
at the AES.

[6/27/94 public]
The AES contains language very simmilar to the above with one notable 
exception. 

For CDS a backslash may be used in front of an *, or a ? to escape 
the character.

Note that it does not require that the backslash work when escaping
another backslash. It doesn't mean it shouldn't work - just that its
not required. We'll have to do some more digging on this one.

[6/12/94 public]
I tried creatinf foo\\bar in 1.0.3 and 1.1 and as observed above both
failed. I don't have 1.0.2 and it doesn't matter 1.1 will do what 1.0.3
did - not allow \\. I will open a doc bug. Cancelling this one.



CR Number                     : 11051
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10852
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : Auth rpc (privacy)
Short Description             : rpc runtime fails in WAY AUTH when using protection level of privacy
Reported Date                 : 6/22/94
Found in Baseline             : 1.0.3
Found Date                    : 6/22/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/22/94 public]

I'm creating a new CR because DCE 1.0.3 licensees with support contract
are entitled to bug fixes for bugs that exists in DCE 1.0.3 but being
fixed in DCE 1.1.

More information related to this bug can be found in OT #10852. A summary
of problem I am seeing is as follows derived from OT 10852:

> [parul 6/21/94 public]
> 
> I think I can tell why this problem has never showed up before despite
> being present. There are two tests that can produce a problem that I
> feel is related to this one.
> 
> 1) Functional test: run  the rpc perf test with packet privacy option
>    enabled when using DG protocol. This test fails for cases# 7
>    (Unregistered interface test) and #8 (Forwarding test). With my
>    analysis so far, I can see that when the client tries to respond
>    to a WAY AUTH it gets 'unknown reject' error:
> 
> (rpc__dg_call_start) rcvbuf 32768, ws 16
> (conv_stub_who_are_you_auth) Thinking about responding to WAYAUTH callback
> (rpc__dg_call_transceive) unblocking serialized waiters...
> (rpc__dg_do_reject) Got a live one [3947a3e0-8d0d-1d1d-bc42-0000c0ea4f78, 1.0]
> (rpc__dg_call_signal_failure) CCALL st = 0x16c9a060 (orig st = 0x0) [3947a3e0-8d0d-1d1d-bc42-0000c0ea4f78, 1.0]
> *** Unknown exception raised
> Exception: unknown reject (dce / rpc)
> 
> 2) System tests: run the rpc.cds.3 test with the protection level set to
>    privacy. It always fails trying do its fourth call.
> 
> Does OSF or anybody else run these tests with specified options? If this is
> pointing to a different problem then we should reopen this OT or create a
> new one.
> 
> Where can I find the fix that I can apply to SNI DCE 1.0.3 code?

As per HP this problem is fixed in 1.1 and we would like to have the
1.0.3 version of fix made available to us.

[6/22/94 public]

I finally got a list of bugs that I need to get fix for:

OT# 9551, 8643, 9614, 10444, and if possible 8053 & 7465.

[6/27/94 public]
OSF development does not provide back patch fixes for defects
that are fixed in the next release.  You must go through 
OSF System Engineering (assuming you have a support license) to request
these kind of fixes.  They might be able to assist you.



CR Number                     : 11046
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : gdssysadm
Short Description             : Can't invoke gdssysadm
Reported Date                 : 6/22/94
Found in Baseline             : 1.1
Found Date                    : 6/22/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/22/94 public]
When invoking gdssysadm (alone, with no arguments) I get:

  root@gemini gds/ts$ gdssysadm
  Error while reading NLS file; msg_set = 11 msg_no = 5
  
  FATAL ERROR: While accessing NLS file !!!
    
Note that this message does not exist:

  root@gemini gds/ts$ dspcat gdssysadm.cat 11 5
  dspcat: Invalid msg - msg 5 not found.

Here's a segment of the catalog:

  10 : 4 13  8 same time ? [1-256]:# @#
  10 : 5 13 29 @# @#
  11 : 1 15  8 How many server processes should be activated ? [1-256]:# @#
  11 : 2 15 65 @# @#
  11 : 3 17  8 Authentication mechanism that the DSA supports ?:# @#
  11 : 4 17 57 @# %.2=Simple Unprotected   .5=DCE Authentication   .25=Simple + DCE        .a#
  12 : 1  2  5 (confpar)# @#
  12 : 2  2 32 DIRECTORY SYSTEM# @#
  12 : 3  2 64 Configuration# @#
  13 : 1  2  5 (savepar)# @#

My LANG is set to en_US.ISO8859-1.  NLSPATH is unset.  These values worked
with the previous version of gdssysadm.  What changed?

[6/22/94 public]
I get the same message when invoking gdssysadm via the command line:

	gdssysadm -fc -d2 -m1 -c2 -C16 -s2 -A2

	Error while reading NLS file; msg_set = 11 msg_no = 5
	FATAL ERROR: While accessing NLS file !!!

[06/23/94 public]
Sorry, Rich: I can't reproduce this problem.
I logged on to gemini (OSF1 gemini 1.3 osc1.3 b? i386) as root.
LANG was not set, NLSPATH was not set.
gdssysadm worked.
I did: "su - zeliff". LANG was en_US.ISO8859-1, NLSPATH was not set.
gdssysadm worked.
I did "su". LANG was en_US.ISO8859-1, NLSPATH was not set.
gdssysadm worked.

I assume that you invoked an older gdssysadm.

[6/23/94 public]
Can't tell as someone (who, Jochen?) crashed my machine last night.  In any
case, I can't reproduce the problem, either.  Cancelled.



CR Number                     : 11013
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : Makefiles with include lines
Short Description             : Makefiles with include s lines behave funny
Reported Date                 : 6/20/94
Found in Baseline             : 1.1
Found Date                    : 6/20/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/20/94 public]
If you change a makefile such as rpc.mk that is being included
by another Makefile, ODE will NOT do the right thing unless you
have that Makefile that reference it in your sandbox.  This is
bad because it required the user to check out two files when 
changes are only being made on one of them - the "child" makefile.

[7/1/94 public]
I cancelled this bug because, ( if I understand it correctly), this
is an ODE bug and should be entered in that OT database.



CR Number                     : 10998
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : dtscp and dcecp
Short Description             : On RIOS, the user must be
cell_admin to run dtscp (or dcecp dts) successfully, but not on HP or OSF1.
Reported Date                 : 6/17/94
Found in Baseline             : 1.1
Found Date                    : 6/17/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/17/94 public]


On the RIOS only- dtscp requires that the user be cell_admin
before subcommands can be executed sucessfully. All the platforms
should behave the same.

Using dtscp:

root@soldier> dtscp
warning - DTS control program is not authenticated:
        No currently established network identity for which context exists
(dce / sec)
dtscp> sync
error executing command:
        must have write permission to the DTS entity (dce / dts)
dtscp> quit


Using dcecp:

root@soldier> dcecp
dcecp> dts sync
Error: must have write permission to the DTS entity
dcecp> quit

[6/17/94 public]

dtsd requires that one either be logged in as the machine principal,
or be a member of the dts-admin group in order to issue commands that 
modify the internal state of the daemon. The default ACL looks like
this:

unauthenticated:r--
user:hosts/falcon/self:rwc
group:subsys/dce/dts-admin:rwc
any_other:r--

Assuming that you weren't root, cell-admin, or were a member of the 
the dts-admin group, then the above behavior is exactly right. 
Exactly how did the RIOS differ from the HP/OSF1 in this regard?

[6/17/94 public]

I was root on the RIOS when I invoked dtscp. That is the confusing part.
It appears that on the RIOS, being root is not sufficient to use 
dtscp or dcecp dts successfully. On the HP and OSF1, being root is 
sufficient. I have a cell running with a RIOS, an OSF/1, and HP 
if you need check.

[6/17/94 ]

Thanks to Charlie for verifying that this is not a problem.
I always work as root on the QA machines so I did not question
I was not, for some unknown reason to me at this moment, dtscp
saw me as other user thatn root.



CR Number                     : 10992
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10985
Project Name                  : dce
H/W Ref Platform              : hppa,i486
S/W Ref Platform              : hpux,osf1
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : auditd leaves objects in
namespace after 'aud stop'
Reported Date                 : 6/17/94
Found in Baseline             : 1.1
Found Date                    : 6/17/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/17/94 public]
auditd leaves the objects aud-acl and aud-svc in the namespace after an
'aud stop' command.  This requires the administrator to manually clean up
the namespace prior to restarting the audit daemon.

This may be related to ot10985

[6/17/94 public]
On 'aud stop', auditd unexports its interfaces from the CDS space.  This 
action only removes the object UUIDs that auditd exported in the first place.
CDS does not remove the object itself, since it doesn't know if anybody else
is using the same object name, with different interfaces.
There is no need to manually clean up after an 'aud stop', since there
is no RPC object UUID left in CDS, stale entry, to confuse future accesses.



CR Number                     : 10965
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : era
Short Description             : Inefficient tracking of schema attributes
Reported Date                 : 6/15/94
Found in Baseline             : 1.1
Found Date                    : 6/15/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : rgy_utils.c
Sensitivity                   : public

[6/15/94 public]
During the display of extended attributes, the attributes for an object
are found by doing a lookup by id.  A schema lookup is done for each
attribute to get its name.  We should keep a local table of known
attribute_id:attribute_name pairs so an attribute id can be quickly
and easily lookup up without having to do the schema lookup.  If the
attribute id is not found in the local table, then do the schema lookup,
and if found, add the new pair to the local table.

This is found in the show_era() function.

[6/27/94 public]
The same problem can be found in the check_era_info() function, and
must be fixed here as well.

[9/26/94 public]
Deferred till 1.2.  This work really is just a performance improvement.  I
kept it a def and not an enh to give it a greater chance to actually get
done.

[09/13/95 public]
With the addition of trigger support within ERA's, it is no
longer desirable to hold static ERA information.  The name
and type information must be read on demand.  The code is
ok as is.



CR Number                     : 10959
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : configuring secondary cds server on 486 fails.
Reported Date                 : 6/15/94
Found in Baseline             : 1.1
Found Date                    : 6/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/15/94 public]
Configuring a secondary server from a 486 to an hp primary fails. An hp
secondary to a 486 primary seems to work ok. Sometimes the error
is 'connection closed (dce / rpc) and sometime the cdscp create clear
doesn't complain but the secondary clearing house can't be shown or
acl_edit'd. You can;t see it with show obj either. I can create 
multiple clearinghouses on a single machine 486 ok.

I've assigned this to Janet Mccann for ideas and I'm still investigating.

[jd 7/5/94 public] 
This problem like 10649 can only be replicated in my office. I've already
swapped machines, everything except the disk, to no avail. I'll move my 
machine to another office to elimenate the cables. In the meantime. since
this only affects me, I'm lowering the priority.

[7/5/94 public]
Nope I was mistaken. This one did go away with the new box.
Cancelled.



CR Number                     : 10952
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : possible runtime error
Reported Date                 : 6/15/94
Found in Baseline             : 1.1
Found Date                    : 6/15/94
Severity                      : A
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]

HP platform specific.  Hasn't been seen in R1.2.

[6/15/94 public]

While running the DFS core test on budapest, and mudslide
they both crashed during the test. It is not clear as to
what caused the crash, whether it was from the DFS test
or some other circumstance. However the following is output
from the test log which is not very helpfull. I have
also included output from the console at the time of the crash
We reran on budapest with noproblems encountered.

******************** ERROR LOG **********************************


Current site is: registry server at /.../sif_cell/subsys/dce/sec/master
Domain changed to: group
Current site is: registry server at /.../sif_cell/subsys/dce/sec/master
Domain changed to: group
S:****** Starting bosserver...
1994-06-14-12:26:28.594-04:00I----- dtsd WARNING dts config 0x7aff8460
Too fews servers (2), need 3 servers
Checking for a Ubik sync site in  hosts/budapest
Host /.:/hosts/budapest is now the sync site
*** /dev/rdsk/c201d2s0 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 81867
*** Defaulting to 818 log blocks                              (maximum of 90 con
current transactions).
Done.  /dev/rdsk/c201d2s0 is now an Episode aggregate.
/dev/rdsk/c201d2s0: Marked as not a BSD file system any more.
S:****** Partition /dev/dsk/c201d2s0 successfully initialized.
1994-06-14-12:28:56.096-04:00I----- dtsd WARNING dts config 0x7aff8460
Too fews servers (2), need 3 servers
        readWrite   ID 0,,1  valid
        readOnly    ID 0,,2  invalid
        backup      ID 0,,3  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner
budapest            RW       lfs_aggr1 0:00:00 hosts/budapest <nil>

Fileset 0,,1 created on aggregate lfs_aggr1 of budapest
S:****** Starting dfsbind...
S:****** Starting fxd...


********************** CONSOLE OUTPUT ********************************

15:43  Tue Jun 14 1994.  Reboot after panic: @(#)B2352A HP-UX (C.09.01) #1: Mon Jun 28 15:27:29 EDT 1993 with HP DFS/9000 1.0@
17:00  Tue Jun 14, 1994.  Reboot:

[6/6/94 public]

This is a long standing (and apparently infrequent) problem.  fxd creates threads
for rpc's via pthread_create().  This in turn calls newproc(), which calls
growpreg() in the child process.  The growpreg() fails for unknown reasons (we 
can't tell why without kernel source).  

Rick Kissel tells me HP is aware of this problem, but it happens so
infrequently that they haven't really adressed it.  I've lowered the
bug to B2 until we see how often it happens.

[7/13/94 public]
I just hit this, single machine HP cell.  The telltale panic message
is: "pthread_create: could not grow user stack".



CR Number                     : 10944
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : help
Short Description             : help log produces error
Reported Date                 : 6/14/94
Found in Baseline             : 1.1
Found Date                    : 6/14/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/14/94 public]

This is a problem:
dcecp> help log
Error: Object "log" is not unique: logout login log

It used to work.  (say a week or so ago).

[6/14/94 public]
I take that back, this was user error.  Should have typed 'log help'.



CR Number                     : 10937
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dfs smoketests runtime
Short Description             : DFS smoketest
Reported Date                 : 6/13/94
Found in Baseline             : 1.1
Found Date                    : 6/13/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/13/94 public]

While running the DFS smoketests on budapest
the following errors appeared. 

root@sif> 1994-06-13-14:35:02.196-04:00I----- dtsd WARNING dts config 0xa446ead0
Too fews servers (1), need 3 servers
1994-06-13-14:37:32.804-04:00I----- dtsd WARNING dts config 0xa446ead0

S:****** Starting rpcd...
S:****** Starting sec_clientd...
S:****** Waiting for node self-identity to be established...
S:****** This node is now a security client.
S:****** Starting cdsadv...
1994-06-13-14:40:07.261-04:00I----- cdsadv(3648) WARNING cds adver 0x7aff8450
No acl file, error: 2 - Creating a default ACL

[6/13/94 public]
Of course, as the messages say, these are only WARNINGs.
A result of serviceability that will go away after beta.
Bug canceled.



CR Number                     : 10927
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : cdscp "show
clearinghouse" fails as unauthenticated user
Reported Date                 : 6/10/94
Found in Baseline             : 1.1
Found Date                    : 6/10/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/10/94 public]

When run under my Unix user and group id (1549, 1000) respectively, 
with no network credentials, a "cdscp show clearinghouse" fails 
consistently with the following diagnostic. 


cbrooks> cdscp show clearinghouse /.:/falcon_ch
Warning: you have no network credentials. All requests will be unauthenticated.

                        SHOW
               CLEARINGHOUSE   /.../falcon_ch/falcon_ch
                          AT   1994-06-10-10:01:24
Error on entity: /.../falcon_ch/falcon_ch
Specified clearinghouse does not exist (dce / cds)
Function: dnsReadAttrValue

I'm running /bin/ksh, and my environment looks like the following:

EFILE=/users/cbrooks/.kshrc
MANPATH=/project/tools/man:/usr/man:/usr/local/man:/usr/local/X11R5/man:/users/cbrooks/Man
TEXFONTS=.:/project/tools/libdata/tex/fonts/
NLSPATH=/usr/lib/nls/C/%N:/usr/lib/nls/C/%N.cat
TEXFORMATS=/project/tools/libdata/tex/formats/
PAGER=less
FPATH=/users/cbrooks/funcdefs
VISUAL=emacs
PATH=/users/cbrooks/bin/scripts:/users/cbrooks/bin/9000-710:/project/tools/bin/hp9000_700:/bin:/usr/bin:/usr/contrib/bin:/usr/local/bin:/usr/local/bin:/usr/local/X11R5/bin:/usr/bin/X11:/usr/local/bin/mh:/usr/local/lib/gnu-emacs/etc-19
COLUMNS=79
WINDOWID=92274702
TeXBase=/project/tools/libdata/tex
EDITOR=emacs
LOGNAME=cbrooks
MAIL=/usr/mail/cbrooks
PRINTER=milhaus
SYSPATH=/bin:/usr/bin:/usr/contrib/bin:/usr/local/bin
USER=cbrooks
OT_PROJECT=dce
TEXPOOL=/project/tools/libdata/tex
DISPLAY=falcon:0.0
SHELL=/bin/ksh
HOME=/users/cbrooks
TEXINPUTS=.:/project/tools/libdata/tex/inputs
TERM=xterm
XAPPLRESDIR=/users/cbrooks/App-defaults
TEXEDIT=vi +%d %s
PWD=/users/cbrooks
hostname=falcon
TZ=EST5EDT
LPDEST=milhaus
ENV=/users/cbrooks/.kshrc
UI=/usr/include
DCEtype=hp800
LINES=52

Other notes: works if I run as root via a "su - root", but NOT via 
su root. Works as another logged in user.

[6/29/94 public]
I need more information here.  This command uses acl to check access so
your locol userid should not be relevant.  What does the acl look like on
the clearinghouse and server.  So you expect unauthenicated read?
When you loggin as root do you have credentials??

[9/12/94 public]
The .cdscpinit file in your home directory had a set preferred clearinghouse
line for a clearinghouse that didn't exist in cell falcon_cell,



CR Number                     : 10921
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : dts
Short Description             : show output needs blank link for multiple lists
Reported Date                 : 6/9/94
Found in Baseline             : 1.1b9
Found Date                    : 6/9/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/9/94 public]
dts and clock show should output a blank line when showing lists
from multiple servers.

[6/22/94 public]
According to the functional spec, the dts commands only accept a single
server to contact, not a list. Therefore generating lists from multiple 
servers is impossible. Cancelled.



CR Number                     : 10909
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : server/sec_clientd/roverride.c
Short Description             : parse_override_buffer() contains a benign error
Reported Date                 : 6/9/94
Found in Baseline             : 1.0.3
Found Date                    : 6/9/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/9/94 public]

Licensee reported:
"There is an errant statement in the parse_override_buffer() routine
 which increments a dereferenced pointer, rather that the pointer itself.

 As far as we can tell, the error is totally benign. We came across it
 while investigating a bug report."

The 1.1 code has the same problem.

Suggested fix: increment the pointer:

     *** /tmp/ci.2937..roverride.c.2969.1       Fri Jun  3 14:29:00 1994
     --- /tmp/roverride.c.2969.2        Fri Jun  3 14:29:00 1994
     ***************
     *** 182,192 ****
     --- 182,196 ----
                               (tmp_ovrd->overridden | sec_override_pw_shell);
                   }
               } else {
                   separators++;
                   *tmp = '\0';
     + #if defined(hitm)
     +             tmp++;
     + #else
                   *tmp++;
     + #endif
       #ifdef DEBUG
                   if (debug_mode)
                       fprintf(stdout,
                               "%s - DEBUG: found token #%d %s\n", server_name,
                               separators, token);

[06/09/94 public]
A better fix is to just comment out the increment altogether.
Cancelling this -- bug does not appear in dced secval for DCE 1.1.



CR Number                     : 10904
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : nidl_to_idl
Short Description             : couldn't install nidl_to_idl
Reported Date                 : 6/8/94
Found in Baseline             : 1.1b9
Found Date                    : 6/8/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/8/94 public]

I took the AT386 install tree from AFS (/afs/dce/project/dce/build/dce_temp)
(last night's build) and started dce_config. All worked fine except :

Optional Utilities:

2. nidl_to_idl

I got: cp: /opt/dce/bin/nidl_to_idl: No such file or directory
Can't create file /opt/dcelocal/bin/nidl_to_idl
Ensure no DCE daemons are running
        Press <RETURN> to continue, CTRL-C to exit: 

I think nidl_to_idl was not in the install tree as it should be.

[6/8/94 public]
nidl_to_idl is only built when the Makefile variable
NO_COMPAT_NCS15 is not defined.

For DCE1.1, we define this variable.

from src/rpc/idl/Makefile:
# 
# NO_COMPAT_NCS15 is set in rpc.mk which is included in RULES_MK above.
# Therefore this test must be AFTER the above include.
# NO_KRPC is meant as an environment variable so it can be above the .include
#

.ifndef NO_COMPAT_NCS15
COMPAT_SUBDIRS  = nidl_to_idl
.endif

Bug canceled.



CR Number                     : 10859
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : dce_config assumes EPMAP is
set
Reported Date                 : 6/3/94
Found in Baseline             : 1.1
Found Date                    : 6/3/94
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/3/94 public]
I encountered the follow error when configuring a cell using bl9.4.
(Occurs on both HPUX and AT386)

S:****** Configuring initial cell...






         Initial Cell Configuration ( on prague )


         1. Initial Security Server
         2. Initial CDS Server
         3. Initial DTS Server


        98. Return to previous menu
        99. Exit



        selection:  1
S:****** Configuring initial Security Server...


        Enter the name of your cell (without /.../): prague
usage:
 grep  [-E|-F] [-cbilnqsvx] [-e expression [-e expression] ... | -f file]
 [expression] [file ...]
 egrep [-cbilnqsvx] [-e expression [-e expression] ... | -f file]
 [expression] [file ...]
 fgrep [-cbilnqsvx] [-e expression [-e expression] ... | -f file]
 [expression] [file ...]
S:****** Starting ...


WARNING: If "" was recently running, and was using the TCP protocol sequence to listen for calls to the server, then a TCP shutdown period of up to 4 minutes is required before restarting "" in order to avoid "cannot bind socket" errors.
        Press <RETURN> to continue, CTRL-C to exit:   
S:****** Initializing dced...
Failed opening Hostdata.db.
Database open failure
ERROR:   dced -i failed to start.
        Press <RETURN> to continue, CTRL-C to exit: 


The problem seems to be that dce_config expects the environment variable
EPMAP to be set.  If not, the errors above occur.  

dce_config should test for the existence of the variable rather than
assuming that it exists.

[6/3/94 public]
It assumes it it set because it gets set in dce_com_env:
: ${EPMAP:=rpcd}                       # use dced not rpcd?

Did you use the -i switch when installing from a new install area?

[06/03/94 public]
No, Rich Z did not use the "-i" switch and as penance has agreed to
have your admonition tattooed on a body part of your choice.
Or not.
Cancelling.



CR Number                     : 10855
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : dme/services/sms
Short Description             : problem found in dme/services/sms
Reported Date                 : 6/3/94
Found in Baseline             : 1.0
Found Date                    : 6/3/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/3/94 public]

=========================   PROBLEM =====================================
From Mike at Mitre
==================
Robert:

    Here is the output of the SMS routine "sms_i_get_values" from file.c.  The first line prints the line that is
    passed to it extracted from the sms_subsys file.  It's the same one I emailed you a week or two ago and you said
    looked OK starting with "rpcd".

    It looks like the routine is setting elem->type to 3 or short for all cases after it finds the value 20. 
    Shouldn't the following 0 0 and 1 be identified as long values ?  Then when it finds the null after the 1 it
    indicates that it also is a short value.  Within the short processing, it ends up giving the null an
    invalid status for the whole record.  Any help would be appreciated.  Thanks.

- -- Mike

MJM - sms_i_get_values: starting temp=rpcd:::/usr/bin/rpcd:0:0:/dev/console:/dev/console:/dev/console:-O:-Q:-K:0:20:0:0:1::0::0::
MJM - sms_i_get_values:  token = rpcd elem->type = 0
MJM -sms_i_get_values: string value = rpcd
MJM - sms_i_get_values: found a null token!
MJM - sms_i_get_values:  token =  elem->type = 0
MJM -sms_i_get_values: string value = 
MJM - sms_i_get_values: found a null token!
MJM - sms_i_get_values:  token =  elem->type = 0
MJM -sms_i_get_values: string value = 
MJM - sms_i_get_values:  token = /usr/bin/rpcd elem->type = 0
MJM -sms_i_get_values: string value = /usr/bin/rpcd
MJM - sms_i_get_values:  token = 0 elem->type = 4
MJM - sms_i_get_values: long value = 0
MJM - sms_i_get_values:  token = 0 elem->type = 4
MJM - sms_i_get_values: long value = 0
MJM - sms_i_get_values:  token = /dev/console elem->type = 0
MJM -sms_i_get_values: string value = /dev/console
MJM - sms_i_get_values:  token = /dev/console elem->type = 0
MJM -sms_i_get_values: string value = /dev/console
MJM - sms_i_get_values:  token = /dev/console elem->type = 0
MJM -sms_i_get_values: string value = /dev/console
MJM - sms_i_get_values:  token = -O elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: case of short elem->type not NULL
MJM - sms_i_get_values: Flag value = 2
MJM - sms_i_get_values:  token = -Q elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: case of short elem->type not NULL
MJM - sms_i_get_values: Flag value = 0
MJM - sms_i_get_values:  token = -K elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: case of short elem->type not NULL
MJM - sms_i_get_values: Flag value = 3
MJM - sms_i_get_values:  token = 0 elem->type = 4
MJM - sms_i_get_values: long value = 0
MJM - sms_i_get_values:  token = 20 elem->type = 4
MJM - sms_i_get_values: long value = 20
MJM - sms_i_get_values:  token = 0 elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: short value = 0
MJM - sms_i_get_values:  token = 0 elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: short value = 0
MJM - sms_i_get_values:  token = 1 elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: short value = 1
MJM - sms_i_get_values: found a null token!
MJM - sms_i_get_values:  token =  elem->type = 3
MJM - sms_i_get_values: case of short elem->type
MJM - sms_i_get_values: case of short elem->type not NULL
MJM - sms_i_get_values: j=2 or flag value is equal to elem->linktype invalid record status return 
- --------------
0   rpcd:
1   ::/usr/bin/rpcd:0:0:/dev/console:/dev/console:/dev/console:-O:-Q:-K:0:20:0:0:1::0::0::

================================  COMMENTS from IBM ===========================
From Wayne at IBM
=================

The input record to sms_i_get_values looks bad.
There should be two 0's between the -K and the 20.
The field containing 20 and the following fields were not
processed correctly.
I'm sure this explains everything:-)
These two fields are not used for the -K (sockets)
case, but they need to be there.
The obj.c file in lib/libsms shows the pattern for this
type of record.
I would have expected something like this:
...-O:-Q:-K:0:0:20:0:0:-d:20::0::
as the latter part of the record.  The record was returned
as invalid because the field containing -d above was
null rather than the expected numerical value.
By that I mean the 1 would have been translated to -d
if it had been in the next field.

[6/3/94 public]

Is this a typo?  Why is an SMS bug in the DCE database?

[6/6/94 public]

cancelled - it should be in the DME database.

[6/7/94 public]
assign to known component, bld, to avoid automatic sweep
for "unknown" defects (which should check for "open" too).



CR Number                     : 10834
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce.rm
Short Description             : dce.rm doesn't remove everything
Reported Date                 : 6/2/94
Found in Baseline             : 1.1
Found Date                    : 6/2/94
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/2/94 public]
I believe I'm using the nightly of 5/23/94.

I ran dce.rm and it completed without warnings or errors.  I then did a
find under /opt/dcelocal for all files.  Many things were left that I
don't think should have been:

./bin/sec_create_db
./bin/sec_salvage_db
./bin/secd
./bin/rpcd
./bin/cdsadv
./bin/cdsclerk
./bin/dtsd
./bin/sec_clientd
./bin/auditd
./bin/dtstimed
./bin/dts_null_provider
./bin/dts_ntp_provider
./bin/rpccp
./bin/uuidgen
./bin/cdscp
./bin/getcellname
./bin/getip
./bin/acl_edit
./bin/dce_login
./bin/rgy_edit
./bin/dtscp
./bin/dcecp
./bin/sec_admin
./bin/passwd_import
./bin/passwd_export
./bin/auditcp
./bin/kinit
./bin/klist
./bin/kdestroy
./bin/cdsd
./bin/gdad
./bin/gda_child
./var/security/sec_audit_trail
./var/security/sec_audit_trail.md_index
./var/security/rcache/krb5kdc_rcache
./var/adm/time/core
./var/svc/routing
./var/rpc/rpcd.log
./var/audit/adm/acl
./var/audit/adm/central_trail
./var/audit/adm/central_trail.md_index
./var/audit/daemon_identity
./var/audit/daemon_binding
./lib/libdce.sl
./etc/audit/ec/dce_audit_filter_modify
./etc/audit/ec/dce_audit_filter_query
./etc/audit/ec/dce_dts_mgt_modify
./etc/audit/ec/dce_dts_mgt_query
./etc/audit/ec/dce_dts_synch
./etc/audit/ec/dce_dts_time_provider
./etc/cds_attributes
./etc/cds_globalnames
./etc/cdscp.bpt
./etc/dtscp.bpt
./etc/dce_com_utils
./etc/dce_com_env
./etc/dce_config_env
./etc/dce_config
./etc/dce_config_utils
./etc/dce.clean
./etc/dce.rm
./etc/dce.unconfig
./etc/dfs_config
./etc/rc.dce.template
./etc/zoneinfo/Australia/Tasmania
./etc/zoneinfo/Australia/Queensland
./etc/zoneinfo/Australia/North
./etc/zoneinfo/Australia/West
./etc/zoneinfo/Australia/South
./etc/zoneinfo/Australia/Victoria
./etc/zoneinfo/Australia/NSW
./etc/zoneinfo/Australia/Yancowinna
./etc/zoneinfo/Australia/LHI
./etc/zoneinfo/localtime
./etc/zoneinfo/posixrules
./etc/zoneinfo/Brazil/DeNoronha
./etc/zoneinfo/Brazil/East
./etc/zoneinfo/Brazil/West
./etc/zoneinfo/Brazil/Acre
./etc/zoneinfo/Canada/East-Saskatchewan
./etc/zoneinfo/Canada/Newfoundland
./etc/zoneinfo/Canada/Atlantic
./etc/zoneinfo/Canada/Eastern
./etc/zoneinfo/Canada/Central
./etc/zoneinfo/Canada/Mountain
./etc/zoneinfo/Canada/Pacific
./etc/zoneinfo/Canada/Yukon
./etc/zoneinfo/Chile/EasterIsland
./etc/zoneinfo/Chile/Continental
./etc/zoneinfo/Mexico/BajaNorte
./etc/zoneinfo/Mexico/BajaSur
./etc/zoneinfo/Mexico/General
./etc/zoneinfo/US/Mountain
./etc/zoneinfo/US/Eastern
./etc/zoneinfo/US/Central
./etc/zoneinfo/US/Michigan
./etc/zoneinfo/US/Pacific
./etc/zoneinfo/US/Alaska
./etc/zoneinfo/US/Arizona
./etc/zoneinfo/US/East-Indiana
./etc/zoneinfo/US/Aleutian
./etc/zoneinfo/US/Samoa
./etc/zoneinfo/US/Hawaii
./etc/zoneinfo/SystemV/AST4ADT
./etc/zoneinfo/SystemV/EST5EDT
./etc/zoneinfo/SystemV/CST6CDT
./etc/zoneinfo/SystemV/MST7MDT
./etc/zoneinfo/SystemV/PST8PDT
./etc/zoneinfo/SystemV/YST9YDT
./etc/zoneinfo/SystemV/AST4
./etc/zoneinfo/SystemV/EST5
./etc/zoneinfo/SystemV/CST6
./etc/zoneinfo/SystemV/MST7
./etc/zoneinfo/SystemV/PST8
./etc/zoneinfo/SystemV/YST9
./etc/zoneinfo/SystemV/HST10
./etc/zoneinfo/Hongkong
./etc/zoneinfo/Cuba
./etc/zoneinfo/Jamaica
./etc/zoneinfo/Navajo
./etc/zoneinfo/NZ
./etc/zoneinfo/Egypt
./etc/zoneinfo/Libya
./etc/zoneinfo/PRC
./etc/zoneinfo/ROC
./etc/zoneinfo/Singapore
./etc/zoneinfo/Iran
./etc/zoneinfo/Israel
./etc/zoneinfo/Japan
./etc/zoneinfo/ROK
./etc/zoneinfo/Universal
./etc/zoneinfo/GB-Eire
./etc/zoneinfo/WET
./etc/zoneinfo/Iceland
./etc/zoneinfo/MET
./etc/zoneinfo/Poland
./etc/zoneinfo/EET
./etc/zoneinfo/Turkey
./etc/zoneinfo/W-SU
./etc/zoneinfo/CET
./etc/zoneinfo/GMT
./etc/zoneinfo/GMT-12
./etc/zoneinfo/GMT-11
./etc/zoneinfo/GMT-10
./etc/zoneinfo/GMT-9
./etc/zoneinfo/GMT-8
./etc/zoneinfo/GMT-7
./etc/zoneinfo/GMT-6
./etc/zoneinfo/GMT-5
./etc/zoneinfo/GMT-4
./etc/zoneinfo/GMT-3
./etc/zoneinfo/GMT-2
./etc/zoneinfo/GMT-1
./etc/zoneinfo/GMT-0
./etc/zoneinfo/GMT+0
./etc/zoneinfo/GMT+1
./etc/zoneinfo/GMT+2
./etc/zoneinfo/GMT+3
./etc/zoneinfo/GMT+4
./etc/zoneinfo/GMT+5
./etc/zoneinfo/GMT+6
./etc/zoneinfo/GMT+7
./etc/zoneinfo/GMT+8
./etc/zoneinfo/GMT+9
./etc/zoneinfo/GMT+10
./etc/zoneinfo/GMT+11
./etc/zoneinfo/GMT+12
./etc/zoneinfo/GMT+13
./etc/zoneinfo/GMT0
./etc/zoneinfo/GMT1
./etc/zoneinfo/GMT2
./etc/zoneinfo/GMT3
./etc/zoneinfo/GMT4
./etc/zoneinfo/GMT5
./etc/zoneinfo/GMT6
./etc/zoneinfo/GMT7
./etc/zoneinfo/GMT8
./etc/zoneinfo/GMT9
./etc/zoneinfo/GMT10
./etc/zoneinfo/GMT11
./etc/zoneinfo/GMT12
./etc/zoneinfo/GMT13
./etc/zoneinfo/UTC
./etc/zoneinfo/UCT
./etc/zoneinfo/Greenwich
./etc/zoneinfo/Zulu
./etc/zoneinfo/Factory
./etc/boot_time
./nls/msg/en_US.ASCII/dceaud.cat
./nls/msg/en_US.ASCII/dcecds.cat
./nls/msg/en_US.ASCII/dcecsr.cat
./nls/msg/en_US.ASCII/dcedcp.cat
./nls/msg/en_US.ASCII/dcedhd.cat
./nls/msg/en_US.ASCII/dcedts.cat
./nls/msg/en_US.ASCII/dcegds.cat
./nls/msg/en_US.ASCII/dcegss.cat
./nls/msg/en_US.ASCII/dcekdb.cat
./nls/msg/en_US.ASCII/dcekdc.cat
./nls/msg/en_US.ASCII/dcekrb.cat
./nls/msg/en_US.ASCII/dcelib.cat
./nls/msg/en_US.ASCII/dcerpc.cat
./nls/msg/en_US.ASCII/dcesad.cat
./nls/msg/en_US.ASCII/dcesec.cat
./nls/msg/en_US.ASCII/dcesvc.cat
./nls/msg/en_US.ASCII/dcethd.cat
./nls/msg/en_US.ASCII/dceuid.cat
./nls/msg/en_US.ASCII/gdsditadm.cat
./nls/msg/en_US.ASCII/gdsdithelp.cat
./nls/msg/en_US.ASCII/gdsproc.cat
./nls/msg/en_US.ASCII/gdssysadm.cat
./nls/msg/en_US.ASCII/gdssyshelp.cat
./nls/msg/en_US.ASCII/idl.cat
./dcecp/attr_eval.tcl
./dcecp/dir_ops.dcecp
./dcecp/init.dcecp
./dcecp/verb-object.dcecp
./tcl/init.tcl
./tcl/parray.tcl
./tcl/tclIndex

[6/2/94 public]
dce.rm has two modes of operation.
Invoking it with no arguments remove all configuration files
Invoking it with the 'install' argument removes all installation files.
(This means doing the command rm -rf /opt/dcelocal)

Canceled.



CR Number                     : 10821
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10016, 10919
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : 
Short Description             : Interoperability problem
between GDS Clients and non-GDS servers.
Reported Date                 : 6/1/94
Found in Baseline             : 1.0.3
Found Date                    : 6/1/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/1/94 public]

NCR reports the following:

I am trying to connect a GDS client with a non-GDS server. I was able to
perform a bind and unbind request to the non-GDS sever. However, I having
to read the cell name from the global directory. It seemed that the server
rejected the request due to something to do with the country code value.  I
think the problem is that the non-GDS server does not like the coutnry code
value with T.61 syntax. It expects a printable string instead.

I discovered this by looking the trace from the trace log under
/opt/dcelocal/var/adm/directory/gds/dua, which provides apdu traces.The
following is part of the read request trace:

            Bind-ID : -1  :: status: 0 serv_id: 2 

         R_USER           #                                       14:54:35 

ENTRY: d23_invoke 

         R_USER           #                                       14:54:35 

ENTRY: d23_msgsnd 

         R_USER           #                                       14:54:35 

        SNDMSGTYPE: 1  DST-SID: 2  ASSOC-ID: 0/0  CALL-PID: 21356 

         R_USER           #                                       14:54:35 

        CONT-ID: 0x69  USR-ID: 0  MSGSIZE: 128  OPR-FLG: 1  OPR-ID: 1 

         R_USER           #                                       14:54:35 

     0  93 ff 06 08 01 00 00 00 10 fe 00 00 90 10 00 00     |                |
    10  00 00 ff ff ff ff 02 00 01 00 00 00 e9 fd 01 00     |                |
    20  24 00 21 00 38 35 2e 34 2e 36 03 55 53 01 38 35     |$ ! 85.4.6 US 85|
    30  2e 34 2e 31 30 03 61 74 74 01 38 35 2e 34 2e 31     |.4.10 att 85.4.1|
    40  31 03 72 62 00 00 00 00 f3 fd 00 00 01 00 02 00     |1 rb            |
    50  eb fd 00 00 0c 00 09 00 2b 0c 02 88 53 01 03 04     |        +   S   |
    60  0d 00 00 00 eb fd 00 00 0c 00 09 00 2b 0c 02 88     |            +   |
    70  53 01 03 04 0e 00 00 00 ff ff 00 00 00 00 00 00     |S               |
         R_USER           #                                       14:54:35 

EXIT: d23_msgsnd 

         R_USER           #                                       14:54:35 

ENTRY: d23_attsnd



The attribute OID, syntax and value components of the country name
is as follows: 38352e342e36035553.  The 03 between the attribute OID and
country code value is the syntax code, which indicates T.61.

I finally followed the code and discovered that the x500_cvt_name_to_iapl
routine in gda_util.c set up the syntax for all attribute values to be T.61
(0x03).  However, for country name, it should be printable string instead
(0x04) according to the X.500 standard. I put in a temporary fix in the
routine for look for the OID for country name (85.4.6) and set the syntax
code to 0x04 instead. With the fix, the read request worked fine.

[06/06/94 public]
Your analysis of the problem was excellent. I have found the same problem
in the switch to CDS (gds/dua/switch) and did an equivalent fix there
(d21_cdsmis.c) some months ago.
However - the whole gda_child is no longer used. According to CR 10016
GDA has changed from calling gda_child to using the XDS interface.
If they use it correctly (means using syntax "Printable string" for
Country at the XDS/XOM interface) your problem should be solved.
(I will remove all in gds/gda (gda_child stuff) when I got the final OK from
CDS - see 10016.)

[6/23/94 public]
Cancelled because the code to which this defect refers will be defuncted
shortly.



CR Number                     : 10815
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : rpc
Short Description             : rpcgroup add should complain when adding existing entries
Reported Date                 : 5/31/94
Found in Baseline             : 1.1b9
Found Date                    : 5/31/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/31/94 public]
dcecp> rpcgroup add /.:/rpcg_add_7_P_1 -member {/.:/foo /.:/bar}
dcecp> rpcgroup add /.:/rpcg_add_7_P_1 -member {/.:/foo /.:/bar}

This commands adds the same members to the same group, is the NSI
does not flag this as an error, the spec should be changed.

[8/15/94 public]
The word "is" in the above sentence could be interpreted as either
"if" or "as", I suppose. :-) Anyway, it's clear that the NSI
(rpc_ns_group_mbr_add, specifically) does *not* flag it as an error,
or it would not, in fact, work; the dcecp code basically does nothing
but parse arguments to pass on to RPC. So I guess the spec should be
changed.

[8/15/94 public]
The word "is" should be "if".  The spec has been changed.



CR Number                     : 10812
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : svc
Short Description             : dcesvc replaced by dcecp
Reported Date                 : 5/31/94
Found in Baseline             : 1.1
Found Date                    : 5/31/94
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/31/94 public]
If we are convinced that dcecp's log command completely replaces the
dcesvc program then we should remove dcesvc from the tree or at least
move it to nosupport.

[05/31/94 public]
I don't think dcesvc is even built any more; the svc/Makefile could be
cleaned up a bit.  Should dcecp should dumping of binary log files?
Right now we've got svcdumplog (under 200 lines of code) and if that could go
away it would be A Good Thing.

[6/1/94 public]
We could implement a "log dump" command.  We already have a "cdscache
dump" command that does what "cadump" did.  Dump info suitible for
debugging.

[6/1/94 public]

Howard, what do you mean by "Dump info suitable for debugging" ? 
Dumping of binary files is required for more than just debugging.
I will elaborate if required.

[6/3/94 public]
Yes, we are all convinced.   The src is in utils/svc/svcdumplog.c,
and is < 200 lines.

Currently, the program "svcdumplog" makes it to the install tree, but
is not installed in /usr/bin by dce_config.

[6/3/94 public]
Understood.  There will be a new dcecp command (probably "logfile show")
that will do this.  Cancelling this CR and will capture the new command
in dcecp fucntional spec.



CR Number                     : 10811
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : sec_acl API
Short Description             : Unauthenticated access to some ACL objects fail.
Reported Date                 : 5/31/94
Found in Baseline             : 1.1b9
Found Date                    : 5/31/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/31/94 public]

> acl_edit /.:/hosts/ninja/dts-entity
Warning - binding to ACL's server is unauthenticated
Warning - binding to registry is unauthenticated
ERROR: communications failure (dce / rpc)
Unable to bind to object /.:/hosts/ninja/dts-entity

> acl_edit /.:/sec/principal/jas
Warning - binding to ACL's server is unauthenticated
Warning - binding to registry is unauthenticated
ERROR: not registered in endpoint map (dce / rpc)
Unable to bind to object /.:/sec/principal/jas

It looks like you have an unauthenticated ACL server handle and an
unauthenticated binding handle to the registry, but maybe it's
a problem in sec_acl_lookup().

It seems to work on CDS objects like /.:/hosts, but acl_edit doesn't
work on principals and servers.

> acl_edit /.:/hosts -l
Warning - binding to ACL's server is unauthenticated
Warning - binding to registry is unauthenticated

# SEC_ACL for /.:/hosts:
# Default cell = /.../dcecp_cell.osf.org
unauthenticated:r--t---
user:cell_admin:rwdtcia
user:hosts/ninja/cds-server:rwdtcia
user:hosts/ninja/self:rwdtcia
group:subsys/dce/cds-admin:rwdtcia
group:subsys/dce/cds-server:rwdtcia
any_other:r--t---

[6/24/94 public]
Working in 1.1b10



CR Number                     : 10798
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : dlg_client -nbi returns Error from sec_login_become_delegate
Reported Date                 : 5/27/94
Found in Baseline             : 1.1
Found Date                    : 5/27/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/27/94 public]

I installed DCE from last night's build then
I ran the "dlg_client" test. 
[This is using the code in the AFS cell]  

./dlg_client -c PASS
./dlg_client -la PASS
./dlg_client -ra PASS


./dlg_client -nbi PASSES too

root@clam {38} ==> ./dlg_client -nbi
PASSED: Delegation disabled test

However, dlg_intermediary returns the following while the test runs:
root@clam {5} ==> ./dlg_intermediary -d
Bindings:
ncacn_ip_tcp:130.105.4.68[4658]
ncadg_ip_udp:130.105.4.68[2265]
Listening...
DEBUG: Entered dlg_test_access
Error from sec_login_become_delegate: 17122102

Here's the code in dlg_intermediary:

    dlh = sec_login_become_delegate(caller, lc, sec_id_deleg_type_traced,
                                    NULL, NULL, NULL, NULL,
                                    sec_id_compat_mode_initiator, stp);
    if (BAD_STATUS(stp)) {
        if (debug)
            fprintf(stderr, "Error from sec_login_become_delegate: %x\n",*stp);
        return test;
    }

[5/27/94 public]

Please unlock&cancel this CR. The test is now working. If you specify -d (debug)
to the dlg_intermediary then it's supposed to print out lots more information
on what's happening.  In the case mentioned it was testing what happens
when you try to use delegation, without enabling it (that's what the no-
become-initiator option does) so you should expect it to return the error
that it did.



CR Number                     : 10796
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7945
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : RPC entries created with wrong class
Reported Date                 : 5/26/94
Found in Baseline             : 1.0.3a
Found Date                    : 5/26/94
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/26/94 public]

A complaint from the RPC folks here:

  dce_config uses cdscp to create RPC namespace entries, such as /.:/cell-profile
  and /.:/sec-v1.  The object class is incorrectly being set for these objects.
  Currently, dce_config sets the object class to be RPC_Profile for RPC profile
  entries, and RPC_Group for RPC Group entries.  THIS IS WRONG.  RPC_Profile
  and RPC_Group are attribute types, not object classes.  All RPC entries
  should have an object class of RPC_Entry.

  There is an easy solution for this problem.

  dce_config should be using rpccp to create all of its RPC namespace entries.
  This way, the details of setting object classes and attribute types is
  handled internally by rpccp, and will be guaranteed to be consistent.

  Other namespace objects being created by cdscp that should be created using
  rpccp include:

  /.:/sec                      (RPC group entry)
  /.:/lan-profile              (RPC profile entry)
  /.:/hosts/$HOSTNAME/profile  (RPC profile entry)
  /.:/hosts/$HOSTNAME/self     (RPC server entry object)

  Actually, there does not need to be a dce_config step to create profile or group
  RPC objects at all.  When dce_config starts adding profile elements and group
  members, the RPC API call that is ultimately invoked to add the group members
  or profile elements will automatically create the object if it doesn't already
  exist.

Please modify dce_config (or dcecp, if it has already advanced to the point where it
handles configuration)...

[8/23/94 public]
Actually, I just fixed the rpc NSI to attach these attributes to
entries when they are created.  The assertion in *that* OT (#7945) was
dce_config was doing it corretly and the NSI wasn't.

I belive dce_config is attaching the correct attribute to the 
entries it is creating.  Note that this attribute is universally
ignored (especially since its always been 'wrong'), so this is all
just kinda of a nit.

Bug canceled.



CR Number                     : 10795
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : problem installing pthread includes
Reported Date                 : 5/26/94
Found in Baseline             : 1.1b9
Found Date                    : 5/26/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/26/94 public]


When installing bl-9 and choosing "Application Development Environment"
I got the following message:


cp: pthread_exc.h: No such file or directory
cp: pthread.h: No such file or directory


So I chose to reinstall "Application Development Environment".
Now I am constantly getting:

        selection:  7
S:****** installing DCE include files...
S:****** installing
/opt/dcelocal/share/include/dce/pthread_exc.h exists, specify -f to remove.
/opt/dcelocal/share/include/dce/pthread.h exists, specify -f to remove.
S:****** installing idl...

[5/27/94 public]

No longer happens when I try last night's build.
Could have been something weird on my machine.
If the problem reoccurs I will reopen this bug.



CR Number                     : 10790
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : intercell broken
Reported Date                 : 5/26/94
Found in Baseline             : 1.1b9
Found Date                    : 5/25/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1beta
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/26/94 public]

Unauthenticated intercell in 1.1b9 is broken. The command
"cdscp show dir /.../<cellname>" using a <cellname> registered in 
DNS returns the NAMESERVERBUG message ("Software error detected in 
server (dce/cds)").

[5/31/94 public]
What I know so far is that gdad is sending out the request, getting the
TXT string back but no addresses. It correctly forms the element structures
based oin what it did get and wakes up the requesting thread. That thread
parses what it got but throws its hands up when it becomes aware that it
got no addresses. I'm really suspecting a nameserver problem here. I'll set
up to try another today.

[5/31/94 public]
Well folks, the problem has disappeared completly. I haven't a clue as
to why. At least three people saw this problem last week and this week
we can't replicate it. I checked with our network people and nothing got
fixed over the weekend. Gdad got no changes and it doesn't depend on rpc
to do what it was failing to do - it makes straight socket calls to the
nameserver. Cancel it for now. If it reappears we will reopen it.



CR Number                     : 10789
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : rpc
Short Description             : Incorrect error messages from rpcentry
Reported Date                 : 5/26/94
Found in Baseline             : 1.1
Found Date                    : 5/26/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/26/94 public]

I changed my mind in the middle of entering this, but failed to
prevent its creation. Sorry.



CR Number                     : 10777
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv coredumps during rep rtest3
Reported Date                 : 5/25/94
Found in Baseline             : 1.1
Found Date                    : 5/25/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public
z                             : 

[5/25/94 public]

Placeholder CR while I try to gather more information. Unclear if
this is reproducable yet.

Running dfs 1.1ab5 (based on core bl-5) in the CHO cell with 
regression tests running, cdsadv coredumped on the HP apparently
during rtest3 (which, at the time, was incorrectly being run as
dce principal root instead of dce principal cell_admin).

Coredump contained no useful data.

[7/5/94 public]

Don't have time to reproduce - dropping priority.

[08/20/96 public]
I'm cancelling this OT since there is no useful information here.



CR Number                     : 10773
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : rpc
Short Description             : rpcentry import gives incorrect error message
Reported Date                 : 5/25/94
Found in Baseline             : 1.1b9
Found Date                    : 5/25/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/25/94 public]

dcecp> rpcentry import /.:/foo -obj ea65d898-6c2b-11cd-b7ca-080009251352
Error: Must use -interface or -default
>

But "rpcentry import" doesn't accept -default, nor should it.

[5/26/94 public]

"export" also produces this message if the -interface option is
omitted. "unexport" produces a slightly different message that also
implies the use of -default.

[5/26/94 public]
This was the result of message catalog version skew. Cancelled.



CR Number                     : 10769
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : auditd won't stay up
Reported Date                 : 5/25/94
Found in Baseline             : 1.1
Found Date                    : 5/25/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1beta
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/25/94 public]
auditd exits immediately after invocation.  This causes many FVT tests to
fail.  Seemingly, this occurs only after it is shutdown for the first time.

The scenario is running 'all' functional tests.  auditd_startup passes all
tests.  However, cp_filter fails all because auditd exits immediately after
being invoked by the 'startup()' function of the cp_filter testsuite.

[6/9/94 public]
Haven't been able to reproduce this for some days now; must have been
something in my environment.  Cancelled.



CR Number                     : 10768
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : login
Short Description             : dcecp login fails when dced is running instead of sec_clientd
Reported Date                 : 5/25/94
Found in Baseline             : 1.1
Found Date                    : 5/25/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/25/94 public]
During the dced secval functional test, dcecp login fails at
sec_login_certify_identity(). However, if we stop dced and restart
sec_clientd, the dcecp login succeeds.

[5/25/94 public]
Do you have any more info than this?  The returned error status would
be helpful.

Note the dced's implementation of rsec_login_validate_cert_auth() is
identical to sec_clientd's: both just set the error status to OK, then return.

[5/25/94 public]
It's easy to reproduce. kill sec_clientd and start dced, and then run dcecp
as following,
pwang@foster317 >dcecp
dcecp> login cell_admin -p -dce-
Error: connection request rejected

The error code is  0x16c9a042
pwang@foster231 >statuscode 0x16c9a042
Tech = 1 = 01 = 0x1 = dce
Comp = 27802 = 066232 = 0x6c9a = rpc
Mesg = 66 = 0102 = 0x42 = connection request rejected

start           incatalog intable
  code          rpc_s_connect_rejected
  text          "connection request rejected"
  engineer      "Wei Hu"
  explanation   "The server rejected the connection request from the client.
		This can be because the server has reached its maximum
		allowable connect requests."
   action       "Check the network connection and then retry the operation.
		If the network connection is ok, the server may be receiving
		too many simultaneous client requests. The client can retry
		the server or try contacting a different server."
end

[5/25/94 public]
Well, By the end, this problem is not anyone's problem, is a non-real-bug.
The dcecp login does a little more than dce_login to certify the sec server,
however the dced has its certification service(secval) off by default so
that everytime dcecp login failed on certifying the identity. Somehow, either
dced need to have it on by default or late dce_config need to start dced
with secval service on, or dcecp login doesn't certify the identity, one
of these need to be done. I modified my test code accordingly and activated
the secval service before running my test, all ICs passed on both 486 and HP
(although HP had dced server core dumped during acl_edit, I'll file another
bug on this core dump). Cancelled this bug by now.

[05/26/94 public]
dcecp login calls sec_login_certify?  It should not.  You should only
call certify if you are going to do Unix setuid kinds of things.
Turned this into a dcecp bug.

[6/6/94 public]
dcecp needs to call sec_login_certify_identity. In order to call 
sec_login_inquire_net_info for the principal and cell names, you
must have a certified context. Everyone is going to have to call
certify with the new pre-authn changes anyway, correct? Cancelled.



CR Number                     : 10717
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : keytab
Short Description             : rkeytab_delete_key need to check key type and reject non-des type request by now
Reported Date                 : 5/20/94
Found in Baseline             : 1.1
Found Date                    : 5/20/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/20/94 public]
sec_key_xxx interface now only support "des" type key, but this may
change in the future. by now it could be better to check the key type and
return non-support type request as error so that user (of dced/dcecp)
won't get confused.

[8/1/94 public]
If the dced keytab functions are supposed to be simply remote versions
of sec_key_mgmt_*() calls, then this should be canceled. 
sec_key_mgmt_delete_key() does not take the key type as a param, only prin
and version.  The manpage says this explicitly - "this routine deletes all
key types that have the specified key version number..." However, if this
operation is supposed to give remote access to
sec_key_mgmt_delete_key_type(), then the type should be checked.
Which do we want?

[8/1/94 public]
How about we check key type field, if the key type is specified, it means 
sec_key_mgmt_delete_key_type(), otherwise means sec_key_mgmt_delete_key()?

[9/3/94 public]
Canceling, since the dced operations are intended to be a remote interface
to sec_key_mgmt_*.  They do that correctly.



CR Number                     : 10715
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : file/ncscompat
					     /file/ncsubik
					     /file/flserver
					     /file/px
Short Description             : rpc_s_unknown_status_code" undefined
Reported Date                 : 5/20/94
Found in Baseline             : 1.1
Found Date                    : 5/20/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : file/ncscompat/compat_err.
Sensitivity                   : public

[5/20/94 public]

c89 -c    -D_SHARED_LIBRARIES  +z  -Dunix -DAFS_DEBUG -DDCESHARED_PATH=\"/opt/dce\" -DDCELOCA\
L_PATH=\"/opt/dcelocal\" -D__hppa -Dhp9000s800 -Dhp9000s700 -D__hp9000s800 -D__hp9000s700 -DH\
PUX -D__hpux -Dunix +DA1.0 -D_HPUX_SOURCE    -I- -I. -I/u3/devobj/sb/nb_ux/src/file/ncscompat\
 -I/project/dce/build/dce1.1-snap/src/file/ncscompat  -I/u3/devobj/sb/nb_ux/export/hp800/usr/\
include -I/project/dce/build/dce1.1-snap/export/hp800/usr/include    /project/dce/build/dce1.\
1-snap/src/file/ncscompat/compat_err.c
cc: "/project/dce/build/dce1.1-snap/src/file/ncscompat/compat_err.c", line 95: error 1588: "r\
pc_s_unknown_status_code" undefined
/file/ncsubik
rpc_s_mod" undefined
/file/flserver
rpc_s_mod" undefined
 /file/px
rpc_s_mod" undefined

[5/25/94 public]
This bug is garbage from the rpc drop.
Canceling.



CR Number                     : 10706
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : delete clearinghouse
Short Description             : The "object delete" command
allows a user to delete the Master clearinghouse name, or any CH, the CH name
is deleted, the CH stays and is usable.
Reported Date                 : 5/19/94
Found in Baseline             : 1.1
Found Date                    : 5/19/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/19/94 public]

"dcecp -c object delete" or "cdscp delete object" should not allow a user
remove the name of the Master clearinghouse or any clearinghouse.

The command "object delete <name>", where <name> is a clearinghouse (CH),
let's one delete the CH. Eventhough, the CH name is deleted from 
the directory entry, the MOST (not all) CH commands continue to function.  
                         

Using dcecp:

Deleting Master clearinghouse's name:

1. List your cell's /.: dir
2. find out the name of the master clearinghouseuse 
3. use "object delete", dir list /.:
4. dir list /.: and check that the CH name is gone.

In this example the Master CH name is: /.../bronze/bronze_ch

dcecp> object del /.../bronze/bronze_ch
dcecp> clearinghouse del /.../bronze/bronze_ch
Error: Directory must be empty to be deleted
dcecp> clearing creat /.../bronze/bronze_ch
Error: Specified full name already exists


2. Deleteing a secondary clearinghouse's name:

dcecp> clearinghouse create /.:/house_ch
dcecp> dir create /.:/dir1
dcecp> dir create /.:/dir1 -replica -clearinghouse /.:/house_ch
dcecp> directory synchronize /.:
dcecp> object delete /.:/house_ch
dcecp> 					<== SUCCEEDS - No Error or warning
dcecp> dir list /.:
/.../bronze/dir1 /.../bronze/hosts /.../bronze/subsys /.../bronze/bronze_ch
/.../bronze/cell-profile /.../bronze/fs /.../bronze/lan-profile
/.../bronze/sec /.../bronze/sec-v1
dcecp> 					<== /.:/house_ch not in the dir
list

dcecp> dir show /.:/dir1 -replica -clearinghouse /.:/house_ch  <= SUCCEEDS
     <<output>>

dcecp> directory synchronize /.:       
dcecp> delet dir /.../bronze/dir1                               
Error: Replica set of specified directory contains more than one replica
dcecp> dir del /.:/dir1 -replica -clearinghouse /.../bronze/house_ch

dcecp> clearinghouse show /.:/house_ch
Error: Requested entry does not exist
dcecp> clearinghouse delete /.:/house_ch                     
Error: Requested entry does not exist
dcecp> clearinghouse create /.:/house_ch
Error: Specified full name already exists

[5/20/94 public]
There are only three types of entities in cds - directories,objects, and
links. A clearinghouse is in reality an object. It contains attributes
neccesary for maintainence of replica sets but it is an object and can
therefore be removed with the delete object command. Since removing the 
object in this manner does not result in the performance of other internal
operations that would be done through use of the remove clearinghouse 
command the clearinghouse and replica sets will in all likelyhood be
left in a bad way. For this reason removing the clearinhouse object in 
this manner is a very bad thing to do. The clearinghouse is normally
a well protected entity that can be operated on by an administrator
with sufficient rights who would presumably not do this.

I suppose we could put some code in to check that the name of the object
being deleted is not also the name of a clearing house. I'll let Janet
Mccann comment on this. I'm inclined to leave it the way it is in which
case the answer is 'Don't do that'.

[5/20/94 public]
I can agree with the "don't do that" argument.  The question is can we
do anything to make "doing that" a little more difficult.  Even if it is
just a doc issue or the way we set up default ACL's (I guess it would be
the Initial Object ACL in /.: since all clearinghouse's should be in the
root directory).

[5/20/94 public]
Agreed. We'll see what Janet has to say next week.

[8/2/94 public]
I am going to cancel this cause the acl is already set up to
disallow this by a 'normal' user.  cell_admin and cds-admin are given all
access.  The server will recreate the entry if it detects it has been deleted.
This happens in the background thread.



CR Number                     : 10704
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : dce_config says opt/dce1.0 instead of opt/dce1.1
Reported Date                 : 5/19/94
Found in Baseline             : 1.1
Found Date                    : 5/19/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/19/94 public]


        Enter the full path to the DCE binary install tree.
        This will be a path that ends with the
        .../opt/dce1.0 directory: /project/dce/build/dce1.1-baseline/bl-8/install/at386/opt/dce1.1


Shouldn't this say:

        Enter the full path to the DCE binary install tree.
        This will be a path that ends with the
        .../opt/dce1.1 directory:

[5/19/94 public]
Works for me in bl-9:

        Enter the full path to the DCE binary install tree.
        This will be a path that ends with the
        .../opt/dce1.1 directory: 

When you install dce, you should be cd'ing to the install areas 'etc'
directory and running dce_config from there with the '-i' switch:

	cd <foo>/opt/dce1.1/etc
	./dce_config -i

Bug canceled.



CR Number                     : 10689
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : nsi
Short Description             : rpc_ns_binding_export should test for the object if the rpc__nsentry_create fails
Reported Date                 : 5/18/94
Found in Baseline             : 1.0.3
Found Date                    : 5/18/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/18/94 public]

Configuration:

        system 1: sec master, cds master, dts server
        system 2: sec replica, cds replica, dts server
        system 3: dce client

        Replicated directories:

                /.:/
                /.:/hosts
                all dir under the above
                /.:/subsys/dce/sec

Shutdown DCE on system 1 and restart the DCE daemons on system 3.
When dtsd is trying to configure (dtscp set type clerk), it tries
to export its ACL Mgr  binding to the namespace.  It fails because
the master CDS server is not available.  The entry is available from
the CDS replica server.

The rpc_ns_binding_export function will not fail if the entry it is trying
to create already exists in the namespace and the data is available
in some CDS replica server.  If the call to rpc__nsentry_create fails,
rpc_ns_binding_export should try to do a read on the entry to see if
it already exists.  If it does, then the function should return success;
otherwise it should return the failure status from rpc__nsentry_create.

[5/18/94 public]
Interesting situation. I am assuming that by 'return success' you mean
rpc_ns_binding_export should continue on with its job.  Can we export
things to an entry if we have only replica servers available?  We can't
assume that just because the entry exists, it contains the correct
exported bindings.  In fact, the 1.1 dtsd is very careful to unexport
its bindings on shutdown.

Assuming we *can* export bindings to a replica cds server,
a possible fix for this would be in nsbndexp.c:

old:
    /*
     * Create entry -- it's ok if it already exists.
     */
    rpc__nsentry_create (nsentry, status);
    if ((*status != rpc_s_ok) &&
        (*status != rpc_s_entry_already_exists))
    {
        rpc__nsentry_free (&nsentry, &temp_status);
        return;
    }


new:
    /*
     * Create entry -- it's ok if it already exists.
     */
    rpc__nsentry_create (nsentry, status);
    if ((*status != rpc_s_ok) &&
        (*status != rpc_s_entry_already_exists))
    {
        /*
         * Create won't return already_exists if master server is down
         * Check replica's. (probably slow)
         */
	if (!rpc__nsentry_exists(nsentry, status)
        {
            rpc__nsentry_free (&nsentry, &temp_status);
            return;
        }
    }

[5/18/94 public]
Any feedback on this would be good.

[5/18/94 public]

What you are proposing sounds ok.  I do not know if you can export 
bindings to a replica cds server (I will defer this to Janet).

[5/23/94 public]

No, you can't write on replicas.

Could it be that they are asking for the following behavior:

    try to create the directory
    it fails because the master server is down
    look for a replica of the directory
    look for the entry that you were about to write
    if the entry already contains the information you wanted to write,
          report success.

In most cases, this would do just what you want.

[5/23/94 public]

The above algorithm is what I had originally thought should be done, but
I was not sure on the exporting bindings to the CDS replica.  I should
have made the original description more clear.

[8/29/94 public]
I am going to re-classify this as an enhancement, which I feel it really is.
This, however, is only a nit since this will not make it in to DCE 1.1,
but perhaps we can get it on the list early for 1.2

[2/7/96 public]

Cancelled. Even if you follow the above algorithm, there is no guarantee
that the entry in replica is up-to-date.



CR Number                     : 10672
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : gds
Subcomponent Name             : /directory/xoms/h
Short Description             : `build_all' not remade because of errors
Reported Date                 : 5/17/94
Found in Baseline             : 1.1
Found Date                    : 5/17/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/17/94 public]

[ /directory/xoms/h at 06:38 (AM) Tuesday ]
`build_all' not remade because of errors.
*** Error code 1

[5/17/94 public]
No build error.  This is an artifact of a problem in CDS.  Build logs
messages are sometimes a bit disordered because of timing differences
between when stdout and stderr messages are actually written into the log.



CR Number                     : 10669
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : /security/gssapi
Short Description             : `build_all' not remade because of errors
Reported Date                 : 5/17/94
Found in Baseline             : 1.1
Found Date                    : 5/17/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : /security/gssapi
Sensitivity                   : public

[5/17/94 public]

[ /security/gssapi at 04:23 (AM) Tuesday ]
`build_all' not remade because of errors.
*** Error code 1

Error cancelled because error was really in previous module



CR Number                     : 10662
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa, i486, rs6000
S/W Ref Platform              : hpux, osf1, aix
Component Name                : gds
Subcomponent Name             : /directory/xds/ts/switch/lib/threads_up
Short Description             : `build_all' not remade because of errors.
Reported Date                 : 5/16/94
Found in Baseline             : 1.1
Found Date                    : 5/16/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/16/94 public]

[ /test/functional/directory/xds/ts/switch/lib/threads_up at 01:47 (AM) Sunday \
]
makepath threads_up/. && cd threads_up &&  exec make MAKEFILE_PASS=BASIC     bu\
ild_all
threads_up: created directory
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.

[5/16/94 public]
There isn't any build problem here.  This is a re-iteration of an earlier
build problem with DTS tests.

You are only seeing this because switchlib/threads_up is the very last
directory visited in the build.

Actually, nothing is built in this directory; the files are simply
installed during the install pass.



CR Number                     : 10661
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : dts
Short Description             : Change dts includes
Reported Date                 : 5/16/94
Found in Baseline             : 1.1b8
Found Date                    : 5/16/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/16/94 public]
When CR 10660 is fixed, the dts pieces of dcecp should include 
dtss_ctrl.h and possibly another header which defines constants
needed for interpreting what the dts control rpc's return.

dts_proto.h can be defuncted once this occurs, and have commands.c
include dcp_dts.h

[8/3/94 public]
changed to an enhancement as 10660 was.  The code works today, the only
reason to change is for the purists.

[9/14/96 public]
Cancelled, with the blessing of the responsible engineer. :-)



CR Number                     : 10649
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDS unusable
Reported Date                 : 5/16/94
Found in Baseline             : 1.1
Found Date                    : 5/16/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/16/94 public]

Saturday I smoked friday nights builds. More often than not, about
4 out of 5 times I got CDS unusable during configuration. I spent
some time on it but couldn't pin it down. Finally I installed 
baseline 7 and in 2 out of three attempts I got the same problem.
I think it might be a network problem but untill we know more I 
would not advise installing the latest build.

[5/16/94 public]
This is what I saw:

S:****** Configuring initial CDS Server...
S:****** Please wait for user authentication and authorization...



      Create LAN profile so clients and servers can be divided
      into profile groups for higher performance in a multi-lan cell ? (n)  
S:****** Starting cdsadv...
S:****** Starting cdsd...
(rpc) *** FATAL ERROR "(rpc__list_element_alloc) (*list_desc->alloc_rtn)
(element) call failed   at rpclist.c\355 ***
ERROR:   cdscp show dir /.: failing -- CDS not usable
        Press <RETURN> to continue, CTRL-C to exit:

[5/20/94 public]
Turns out this problem was a result of a network problem in our building
that didn't seem to affect other operations. The network problem was 
detected and fixed and the dce problem immediatly went away. This is
HOWEVER bad. I don't believe there is any reason a flaky network should cause
a single machine cell to not work and it certainly shouldn't cause cdsd
to dump core, sooooo the bug remains open. It will not affect the bata
schedule however. The priority is droped to 1 and the fixed by field is
set to 1.1. 

We can reproduce this, at least I did on my 486, by unplugging the ethernet
connection. 

This is what I have on this so far......

On the 486, gdb showed a back trace through rpc_ep_register with valid
arguments that ended up core dumping in malloc. Everyone agrees this is 
due to someone, entity unknown, stomping on malloc's data base. Arguments
to rpc_mem_alloc and presumably malloc were perfectly valid. So there
appears to be a wandering pointer somewhere. The hp didn't seem to hit 
the problem as often but when it did in the debugger it came up with things 
like invaid instruction. This again seems  to point to stomped memory. I 
didn't spend much time working this on the hp so when we get back to it I 
will get more data. 

A nightly build from the night of Monday May 9 did not have the problem 
and the nightly from Friday May 14 did. There were three drops between 
these dates - dts, security, and cds. I was not configuring dts so
its an unlikely candidate. That leaves security and cds. I performed
the following in an attempt at isolating the problem to cds or something
other than cds. I could not simply copy executables or libdce from a working
build into the broken install area since the changes that came in during 
the drops causing the problem are incompatible with the previous builds. 

baseline 8 worked and is here referred to as bl8.
The nighty of Monday May 16 didn't work and is here refered to as nb.

I copied a complete object tree from nb into a sandbox backed by 
the latest source. I then removed all cds objects and copied all cds 
objects from bl8 onto the sanbdbox. I copied all of the cds makefiles 
from the bl8 source tree into the sandbox. This was necessary because 
of some files were outdated between the two builds. I then relinked
libdce and all of the cds executables with the result. Nothing was
recompiled. After installing this libdce and executables in my install 
area which came from nb I configured. It had the cdsd problem. Now this is 
with cds objects objects from a build known not to have the problem and
everything else from a build known to have the problem. It could still be
a timing problem in cds or a changed signature on one side or the other
but at this point I believe the problem is far more likely to be in the
everything else side of the equation, probably security. 

I then reversed the process. I built an install area with nb cds objects 
and bl8 objects for everything else. This time it worked, again pointing the
finger in the direction of everything else.

That's all I have at this point. Now that I know I can reproduce the problem
I don't plan on doing anything with this for the next week or so. At that
time Rajendra and I can put our heads together to see if we can isolate it
further. 

I'll leave the bug assigned to cds and myself a responsible engineer but
I'll add security to the interest list. Anyone on either the security or 
cds side should feel free to investigate further.

[8/15/94 public]
This roblem appears to be gone. cancel.



CR Number                     : 10638
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10456
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : editline
Short Description             : ALT doesn't work in readline
Reported Date                 : 5/13/94
Found in Baseline             : 1.1
Found Date                    : 5/13/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/13/94 public]

In the dcecp command line editor, ALT+key does not act like ESC-key
(the way it does in emacs and tcsh). It would be really nice if it
did. (I could swear that it did work until fairly recently -- maybe
about bl 6 or 7.)

[05/16/94 public]
This was removed when editline was changed to support 8bit characters.
Cancelling.



CR Number                     : 10626
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : dfs should not DIE when server is not responding
Reported Date                 : 5/12/94
Found in Baseline             : 1.1a
Found Date                    : 5/12/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/12/94 public]

We have discussed this problem in the DFS meeting.  (OSF dfs engineers,
please execuse/pardon me if I am NOT using the 'correct' term to phrase
what I am trying to log here.  Feel free to change or add to this.)

Occassionally, during the complete build of DCE1.1a in a self-hosting
cell, the process dies and kills the build.  

Prior to the dead of the process, I got a bunch of messages from the
kernel (I know this is from the kernel because I have redirected both
the standard output and errors to my build log and there were NO other
processes running except mine.) as followed:

1  root@sofia $ tail /:/project/dce/build/nb1_1a_hp800/logs/build.log.full.root
2  dfs: rpc errors (code 382312711) from the fx server 130.105.4.200 in cell sisyphus.osf.org
3  tail: cannot open input
4  Memory fault
5  root@sofia $ ls
6  . not found
7  root@sofia $ rm core
8  rm: cannot stat core: Connection timed out
9  root@sofia $ ls /:/project/dce/build/nb1_1a_hp800/logs/build.log.full.root
10  /:/project/dce/build/nb1_1a_hp800/logs/build.log.full.root not found
11  root@sofia $ ls /:/project/dce
12  /:/project/dce not found
13  root@sofia $ ls /:
14  /: unreadable
15  root@sofia $ Pid 8399 killed due to text modification or page I/O error
16  dfs: file server 130.105.5.69 in cell sisyphus.osf.org back up!
17  Pid 23637 killed due to text modification or page I/O erro
18
19  root@sofia $ Pid 8441 killed due to text modification or page I/O error
20  l
21  cd, bsubmit.log, build.cache_fix.out, build.ksh, build.log,
22   Pid 8399 killed due to text modification or page I/O error
23  dfs: file server 130.105.5.69 in cell sisyphus.osf.org back up!
24  Pid 23637 killed due to text modification or page I/O error
25
26  root@sofia $ Pid 8441 killed due to text modification or page I/O error
27  l
28  cd, bsubmit.log, build.cache_fix.out, build.ksh, build.log,
29  build.new.out, build.out, build.out., build.out.home, build.out.nocache,
30  build.out.pfy, build.self_host.ksh, dfs-table.template, driver.self_host.sh,
31  driver.sh, parse, parse.ksh, path.save, test.sh
32  root@sofia $ /build/nb1_1a_hp800/logs/JOBS_DIE_05-11 
<
33  root@sofia $ jobs
34  [1] +  Running                 /:/project/dce/build/nb1_1a_hp800/scripts/driver.self_host.sh > /:/project/dce/build/nb1_1a_hp800/logs/build
35  Done                    /:/project/dce/build/nb1_1a_hp800/scripts/driver.self_host.sh > /:/project/dce/build/nb1_1a_hp800/logs/build.log.full.root 2>&1 &
36  root@sofia $ ==> cd usr/include/dce
37  ksh: ==:  not found
38  root@sofia $ tail /:/project/dce/build/nb1_1a_hp800/logs/build.log.full.root
39  + return
40  + [ true = true ]
41  + [ false = true ]
42  + build_dce
43  + date
44  + print Building DCE at Wed May 11 11:27:24 EDT 1994...
45  + 1>> /.../sisyphus.osf.org/fs/project/dce/build/nb1_1a_hp800/logs/.log.05-11-94 2>& 1
46  + cd src
47  + build BENCHMARK_BUILD=ON -sb nb1_1a_hp800 BUILD_OPT=-sb nb1_1a_hp800 -rc /.../sisyphus.osf.org/fs/project/dce/build/.sandboxrc -k build_all
48  + 1>> /.../sisyphus.osf.org/fs/project/dce/build/nb1_1a_hp800/logs/build.log.05-11-94 2>& 1
49  root@sofia $ tail /.../sisyphus.osf.org/fs/project/dce/build/nb1_1a_hp800/logs/build.log.05-11-94
50  sh: makepath: not found
51  *** Error code 1
52  `build_all' not remade because of errors.
53  *** Error code 1
54  exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
55  getwd: Connection timed out
56  *** Error code 2
57  rm: cannot stat /.../sisyphus.osf.org/fs/project/dce/build/nb1_1a_hp800/src/../obj/hp800/pe_cache: Connection timed out
58  *** Error code 2
59  `build_all' not remade because of errors.

[6/24/94 public]
Cancelled.  The error code is "helper catatonic", but this could
have been caused by a network partition.  There is not enough 
information in this bug report to pursue this problem further.  
We will continue to watch for it in self-host builds.



CR Number                     : 10587
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : 
Short Description             : auto-create install/<machine>
Reported Date                 : 5/9/94
Found in Baseline             : 1.0
Found Date                    : 5/9/94
Severity                      : D
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/9/94 public]
mksb should create ${sandbox_base}install/${target_machine} for you.

Also, build should be able to create TOSTAGE if it doesn't exist.  If you
don't have the directories in place you get an error.  Note that in DCE
the TOSTAGE variable is set to /opt/dce1.1 in the whole tree, except, the 
src/test/test.mk changes it to /dcetest/dce1.1 for all files under the
src/test/ subtree.  ODE is smart enough to create any needed IDIR's for
you, it should also create TOSTAGE for you.

[5/10/94 public]
Transferred to ODE defect #1114.



CR Number                     : 10585
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : DEFTOOLBASE assignment
Short Description             : DEFTOOLBASE assignment (re: building of setup passes in one's sandbox)
Reported Date                 : 5/9/94
Found in Baseline             : 1.1
Found Date                    : 5/9/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/9/94 public]

One cannot do the following in one's sandbox:

    build setup_all

wihtout seting the environment variable DEFTOOLBASE.

This broke one of the requirements for DCE stated in the Appendix I 
of RFC 34.

Currently DEFTOOLBASE is hard-coded and is currently incorrectly 
set.  

The search path for the tools SHOULD have been to the tools area
in one's sandbox.  If the tools are not there, then to the tools
area in the backing tree.

===============================================================
The fix is as followed:

    1) Add the following to src/lbe/mk/osf.dce.mk

       DEFTOOLBASE?=${SOURCEBASE}/../tools/${target_machine}/bin/
       BACKTOOLBASE=${SOURCEBASE}/../link/tools/${target_machine}/bin/
       ...
       .if exists(${DEFTOOLBASE}idl)
           IDL?=${DEFTOOLBASE}idl
       .else
           IDL?=${BACKTOOLBASE}idl
       .endif
       ... (all other tools in the tools area)

    2) Take out all references of DEFTOOLBASE from common Makefiles
       and Buildconf* files in src/dce.

thanks
annie

[5/9/94 public]
Current state of the world is that the above fix is not liked since
it contains no support for shared sandboxes.

There is no requirement in RFC 34, it merely documents that to build the
tools you must set DEFTOOLBASE.

The problem that this CR describes is that to build the tools you must set
DEFTOOLBASE to you sandbox's tools/bin directory.  Otherwise, since
DEFTOOLBASE is set to the tools dir in the backing tree, you get an error
when trying to write to it (it's usually mounted read-only).  

Since there is a valid work around and this only occurs if you are trying
to build tools, which most engineers do not do, this is severity D, not A.

Since this is not holding anyone up or gating Beta changed priority to 3
(low).

[5/10/94 public]
The solution (by design) is to simply uncomment the DEFTOOLSBASE line in
the Buildconf.exp file.  

A better solution would be to implement DEFTOOLSBASE as a search path,
rather than a command invocation prefix, but that's decidedly more
involved.

[7/1/94 public]
Since it works now, and users now know that it works in the convoluted
way that it does I have lowered the severity to an E.
Assigned it to Annie

[8/24/94 public]
This is a duplicate of CR # 8540.  It should be canceled along with 8540.



CR Number                     : 10574
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit=> add account
Short Description             : Data integrity error (dce /
sec) is reported when entering an incorrect password in add account.
Reported Date                 : 5/6/94
Found in Baseline             : 1.1
Found Date                    : 5/6/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/6/94 public]

The error message:

?(rgy_edit) Unable to add "pope" - Data integrity error (dce / sec)

is printed when the principal password is incorrect. A better error
message indicating a password mismatch wouldl be preferred.

Example:

rgy_edit=> do acc
Domain changed to: account
rgy_edit=> add pope -g none -o none -pw ccc -mp pen
?(rgy_edit) Unable to add "pope" - Data integrity error (dce / sec)

rgy_edit=>rgy_edit=> add pope -g none -o none -pw ccc -mp -dce-
rgy_edit=>



CR Number                     : 10567
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : security
Short Description             : trying to add an account
prints Error: Data integrity error
Reported Date                 : 5/6/94
Found in Baseline             : 1.1
Found Date                    : 5/6/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/6/94 public]

Tested on OSF/1 using BL-8
Tested on HP using the Wed's NB.

The dcecp account create command returns with a "data integrity error"

Example :

dcecp> principal create rose
dcecp> group create red  
dcecp> org create flower
dcecp> group add red -member rose
dcecp> account create rose -attribute {{group red} {organization flower}
{password -dce-} {mypwd unknown}}
Error: Data integrity error
dcecp> account create rose -group red -org flower -password -dce- -mypwd help
Error: Data integrity error
dcecp>


---------------------------------------

I am cancelling this CR because it was an operator error (mine). 
The data integrity error was telling me that it could not validate
my password. I had exchanged the value of -password and -mypwd

-password  [the principal password]

-mypwd [the password of the principal adding the account]

Here are the steps to add and account using dcecp:

1. create a principal
dcecp> principal create rose

2. create a group
dcecp> group create red

3. create an org
dcecp> org create flower

4. add the principal as a member of a group
dcecp> group add red -member rose

5. add the principal as a member of an org
dcecp> org add flower -member rose

6. then add the account 
dcecp> account create rose -attribute {{group red} {organization flower}
{password rose-pwd} {mypwd -dce-}}

or

dcecp> account create rose -group red -org flower -password rose-pwd -mypwd -dce-



CR Number                     : 10553
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : make auditd understand uuids as well as names
Reported Date                 : 5/5/94
Found in Baseline             : 1.1b8
Found Date                    : 5/5/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/5/94 public]
Modify dmn_rpc_manager.c:aud__esl_get_subject_ids() to try to do a
uuid_to_string() if the sec_rgy... or sec_id... calls fail with
sec_rgy_object_not_found. This would allow the deletion of filters that
have had their principals, groups or cells deleted.

[03/01/96 public]
John, 
Have you had any chance to revisit this ot? In dmn_rpc_manager.c, we try
to convert a name to uuid and if sec_id* or sec_rgy* failed with sec_rgy_
object_not_found, we can use uuid_from_string to get the uuid.  Is it what
you really meant ???  Not the other way around as you suggested above. 
Otherise, I would like to close out this ot.

[03/06/96 public]
I would like to close out this OT for 1.2.2 release.  And if it is really
needed later. We can open a new OT.



CR Number                     : 10545
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : remove assumption in use of time zones
Reported Date                 : 5/5/94
Found in Baseline             : 1.0.2
Found Date                    : 5/5/94
Severity                      : C
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : ek_util.c
Sensitivity                   : public

[3/26/96]
cancel - addressed in 1.2.2.

[5/5/94 public]
 If I set an account to expire at 94/12/31, and I make this setting
during Daylight Savings Time, when I (immediately) use the 'view'
command to review the change to the account, the actual date is printed
as "1993/12/30.23:00". Presumably, the hour-difference is due to the
time in the future being calculated, stored, or printed without regard
for changes in the local timezone (EDT to EST in this case) over the
interval.
.
Example:
.
rgy_edit=> change -p travis -g transarc -o none -x 94/12/31
rgy_edit=> v travis -f
travis [transarc none]:*:4728:11:Ward C. Travis:/afs/transarc.com/usr/travis:/bin/csh:
  created by: /.../k2.dce.transarc.com/cell_admin  1994/05/04.17:37
  changed by: /.../k2.dce.transarc.com/cell_admin  1994/05/04.17:39
  password is: valid, was last changed: 1994/05/04.17:37
  Account expiration date: 1994/12/30.23:00
  Account MAY be a server principal
  Account MAY be a client principal
  Account is: valid
  Account CAN NOT get post-dated certificates
  Account CAN get forwardable certificates
.
A diff is attached that corrects this. Example, after diff is applied:
.
rgy_edit=> v travis -f
travis [transarc none]:*:4728:11:Ward C. Travis:/afs/transarc.com/usr/travis:/bin/csh:
  created by: /.../k2.dce.transarc.com/cell_admin  1994/05/04.17:37
  changed by: /.../k2.dce.transarc.com/cell_admin  1994/05/04.17:40
  password is: valid, was last changed: 1994/05/04.17:37
  Account expiration date: 1994/12/30.23:00
  Account MAY be a server principal
  Account MAY be a client principal
  Account is: valid
  Account CAN NOT get post-dated certificates
  Account CAN get forwardable certificates
  Certificates to this service account MAY be issued via TGT authentication
  Account CAN get renewable certificates
  Account CAN NOT get proxiable certificates
  Account CAN NOT have duplicate session keys
  Good since date: 1994/05/04.17:37
  Max certificate lifetime: default-policy
  Max renewable lifetime: default-policy
rgy_edit=> login cell_admin
Password:
rgy_edit=> change -p travis -g transarc -o none -x 1994/12/31
rgy_edit=> v travis -f
travis [transarc none]:*:4728:11:Ward C. Travis:/afs/transarc.com/usr/travis:/bin/csh:
  created by: /.../k2.dce.transarc.com/cell_admin  1994/05/04.17:37
  changed by: /.../k2.dce.transarc.com/cell_admin  1994/05/05.10:50
  password is: valid, was last changed: 1994/05/04.17:37
  Account expiration date: 1994/12/31.00:00
  Account MAY be a server principal
  Account MAY be a client principal
  Account is: valid
  Account CAN NOT get post-dated certificates
  Account CAN get forwardable certificates
  Certificates to this service account MAY be issued via TGT authentication
  Account CAN get renewable certificates
  Account CAN NOT get proxiable certificates
  Account CAN NOT have duplicate session keys
  Good since date: 1994/05/04.17:37
  Max certificate lifetime: default-policy
  Max renewable lifetime: default-policy
rgy_edit=> quit
--------------------------------------------
-------------------------------------------- Diff
--------------------------------------------
-------------------------------------------------------------------------------
Changes to security/client/admin/rgy_edit/ek_util.c in open delta travis-tr9207-rgy_edit-bad-timezone-assumption:
===================================================================
RCS file: /afs/tr/project/dce/dev/rcs/security/client/admin/rgy_edit/RCS/ek_util.c,v
retrieving revision 10.1
diff -cbt -r10.1 security/client/admin/rgy_edit/ek_util.c
*** 10.1	1994/04/13 00:00:00
--- security/client/admin/rgy_edit/ek_util.c	1994/05/04 22:13:33
***************
*** 1,3 ****
--- 1,14 ----
+ /*-
+  * @TRANSARC_COPYRIGHT@
+  *
+  * $TALog$
+  * $EndTALog$
+  */
+ 
+ #if !defined(_NOIDENT) && !defined(lint)
+ static char *TARCSId = "$Id: c010545,v 1.6 96/03/19 15:57:38 root Exp $";
+ #endif
+ 
  /*
   * @OSF_COPYRIGHT@
   * COPYRIGHT NOTICE
***************
*** 673,679 ****
      unsigned long   days_since_1970, secs_since_1970;
      sec_timeval_t       clock;
      struct timeval  tvp;   /* ditto */
!     struct tm       tm, *ptm;
      int             year, month, day, hour, min;
      time_t          tloc;
      error_status_t  st;
--- 684,690 ----
      unsigned long   days_since_1970, secs_since_1970;
      sec_timeval_t       clock;
      struct timeval  tvp;   /* ditto */
!     struct tm       tm;
      int             year, month, day, hour, min;
      time_t          tloc;
      error_status_t  st;
***************
*** 766,775 ****
      tm.tm_sec = 0;
      tm.tm_wday = 0;
      tm.tm_yday = 0;
!     time (&tloc);
!     /* !!! assume that the time of expiration has the same timezone as us */
!     ptm = localtime(&tloc);
!     tm.tm_isdst = ptm->tm_isdst;
      *clockh = mktime (&tm);
      
      return st;
--- 777,783 ----
      tm.tm_sec = 0;
      tm.tm_wday = 0;
      tm.tm_yday = 0;
!     tm.tm_isdst = -1;           /* have the library not assume same offset */
      *clockh = mktime (&tm);
      
      return st;
-------------------------------------------------------------------------------

[5/5/94 public]
 The code reviewer made a worthwhile suggestion, resulting in a better
diff. The improvement is to replace the assignment:
.
      *clockh = mktime (&tm);
.
    .. with the lines:
.
    if (tloc == -1) {
        SET_STATUS(&st, ek_err_bad_date);
        return st;
    }
    *clockh = tloc;

[8/23/94]
Lowered priority as it is part of rgy_edit.
It does not happen in dcecp.



CR Number                     : 10543
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : security/lrb5/lib/os/an_to_ln.c
Short Description             : an_to_ln.c  memcmp call last
arg spelled wrong
Reported Date                 : 5/5/94
Found in Baseline             : 1.0.3
Found Date                    : 5/5/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/5/94 public]


The problem was reported against 1.0.3, but the current 1.1 code base 
has the same problem.

For 1.0.3 code, Line 170 of an_to_ln.c has memcmp call last arg spelled
wrong :

(memcmp(def_realm, krb5_princ_realm(aname)->data, realm_legth))) {
                                                  ^^^^^^^^^^^
It should be realm_length.

[8/23/94]

The file an_to_ln.c belongs to the kerberos distribution but is currently
not used by DCE.  See line  of /src/security/krb5/lib/krb5/Makefile
> DELETED_OFILES=an_to_ln.o kuserok.o

Will cancel tomorrow if nobody objects

[8/23/94 public]
It's a simple one character change that is currently obviously wrong.  The
file is not built so there is NO risk.  Why not just do it instead of
thinking about it?

[08/24/94 public]
Because it introduces one more thing someone has to look at and
evaluate when they upgrade the KRB code.  Max is right.



CR Number                     : 10539
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : aud
Short Description             : dcecp core dumps on short filters
Reported Date                 : 5/4/94
Found in Baseline             : 1.1b8
Found Date                    : 5/4/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1beta
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/4/94 public]
The following command causes dcecp to core.

dcecp> audf cre world -at {success log}

This is because dcp_check_multi_guides() can't handle this condition. This
function needs to me modified to check all the way up the list.

[5/5/94 public]
Blown pointer fixed in other audit submission



CR Number                     : 10538
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : dfs
Short Description             : DFS server crashes during
multi-machine smoketest
Reported Date                 : 5/4/94
Found in Baseline             : 1.1
Found Date                    : 5/4/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dce_config
Sensitivity                   : public

[5/4/94 public]

In the RaT multi-machine smoketest, when running dce_config to install
and configure the DFS server (the HP budapest) for the cell, budapest
crashes, with a damaged filesystem that requires "fsck" to be run to
repair it.

Here is the output from "dce_config" just before the machine crashes:


S:****** Loading kernel extensions...
initializing Episode:  syscall return value = 0
S:****** Modifying the registry database for DFS server operation...

>>> group member added

>>> group member added

Current site is: registry server at /.../sif_cell/subsys/dce/sec/master
Domain changed to: group
Current site is: registry server at /.../sif_cell/subsys/dce/sec/master
Domain changed to: group
S:****** Starting bosserver...
Checking for a Ubik sync site in  hosts/budapest
Host /.:/hosts/budapest is now the sync site

*** /dev/rdsk/c201d2s0 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 81867
*** Defaulting to 818 log blocks (maximum of 90 concurrent transactions).
Problem with making /dev/rdsk/c201d2s0 an Episode aggregate.

S:****** Forcing /dev/dsk/c201d2s0 to be a fresh Episode aggregate...
*** /dev/rdsk/c201d2s0 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 81867
*** Defaulting to 818 log blocks (maximum of 90 concurrent transactions).
Done.  /dev/rdsk/c201d2s0 is now an Episode aggregate.
/dev/rdsk/c201d2s0: Marked as not a BSD file system any more.
S:****** Partition /dev/dsk/c201d2s0 successfully initialized.
        readWrite   ID 0,,1  valid
        readOnly    ID 0,,2  invalid
        backup      ID 0,,3  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner
budapest.osf.org    RW       lfs_aggr1 0:00:00 hosts/budapest <nil>
Fileset 0,,1 created on aggregate lfs_aggr1 of budapest
S:****** Starting dfsbind...
S:****** Starting fxd...

[5/4/94 public]
Ron, it is unlikely this is a DFS code problem since the code
has not changed since 103a in your tree.  Can this reliably be 
reproduced?

[5/5/94 public]
Well, as luck would have it, this is not reproducible using today's
build.  It's harder to write this off to user error since the 
Rats use scripts for the smoketest that have not changed in a long 
time.  Additionally, I don't see any suspicious RPC changes going
into the build yesterday.  In any case, we've set up the HP machine 
to take a crash dump the next time it occurs.  We'll lower the 
priority on this one while we wait...

[8/10/94 public]
Haven't since this lately (or perhaps it is related to OT11070?).
In any case, there's not much value in leaving this hanging around
at this point.  Cancelling.



CR Number                     : 10525
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : utils
Subcomponent Name             : svc
Short Description             : svc_c_action_exit_bad does not exit
Reported Date                 : 5/4/94
Found in Baseline             : 1.1
Found Date                    : 5/4/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/4/94 public]

Some audit testcases (auditd_startup03) rely on the exit that 
dce_svc_printf with attribute svc_c_action_exit_bad provides,
and this ceased to work about a week or so ago.

[6/1/94 public]
In baseline9, it happens on HP only, does not happen on RIOS anymore.
To recreate, run "auditd -i".  auditd should not start.

[6/7/94 public]
Using new svc source code sent by John Bowe, the rest being still baseline 9,
the problem has disappeared on HP as well.



CR Number                     : 10491
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : parseargv
Short Description             : Commands with 1 option execute successfully with ambiguous argument '-'
Reported Date                 : 4/29/94
Found in Baseline             : 1.1
Found Date                    : 4/29/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/29/94 public]

If the dcecp command only has one option and the user specifies just "-", then
the command successfully completes as if the user specified the option
properly.
An error message should be returned.

Examples:

"acl check" has 1 option: -entry
dcecp> acl check /.:/hosts -
rwdtc

"log show" has 1 option: -debug
dcecp> log show /.:/hosts/ice/dts-entity -
{dts {{states 4} {events 5}} TEXTFILE /tmp/svc}

"acl permissions" has 3 options: -entry -ic -io
dcecp> acl permissions /.:/hosts -
Error: Ambiguous argument '-': -entry -ic -io

[5/2/94 public]
Ping's submission today to parseargv.c should have fixed this. 
Julie, try calling dcp_ParseArgv with the DCP_ARGV_NO_OPT_LEFTOVERS
flag.

[5/5/94 public]

I tested on 1.1b8 with the above suggestion and this defect still exists.

[8/24/94 public]
Any concievable fix for this problem that involves parseargv will also
have the side effect of preventing a '-' from being used as a valid 
argument.

The behavior is consistent with other commands, just a little strange
to the user. Because there is only one option in the arg_table for
these commands, parseargv is validly allowing abbreviations down
to the shortest unique string, '-'. This bug is cancelled. The current
behavior is arguably correct, and any fix will cause worse problems 
later on.



CR Number                     : 10489
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : rgy_edit doesn't parse the flags
in a change account command properly.
Reported Date                 : 4/29/94
Found in Baseline             : 1.0.3
Found Date                    : 4/29/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : .../src/security/client/admin/rgy_edit/tty_acct.c
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[4/29/94 public]

 See the example below. The first attempt to change the account's group
fails. The second attempt succedes. The customer has gone through the code
and determined that the problem lies in the code that parses the command
line. The inclusion of the flags "-pv -av" in the first line causes the
parsing failure.


rgy_edit=> do account
Domain changed to: account
rgy_edit=> view testprinc
testprinc [nogroup1 none]:*:11038:5111:not all that real:/::
rgy_edit=> change -p  testprinc -g nogroup1 -o none -ng nogroup2  -pv  -av
rgy_edit=> view testprinc
testprinc [nogroup1 none]:*:11038:5111:not all that real:/::
rgy_edit=>  change -p  testprinc -g nogroup1 -o none -ng nogroup2
rgy_edit=>  view testprinc
testprinc [nogroup2 none]:*:11038:5112:not all that real:/::

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 10477
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : utils
Subcomponent Name             : svc
Short Description             : Exporting remote interfaces in GDS?
Reported Date                 : 4/28/94
Found in Baseline             : 1.1
Found Date                    : 4/28/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/28/94 public]

Is it necessary for the GDS, to export the remote interfaces
"dce_svc_inq_components" and "dce_svc_inq_table" ?
Only one of the GDS servers (the IPC monitoring process) will
export the remote interface. As the setting of the routing
specification might be different for each of the GDS servers on
a particular machine, there is no well defined result for these
functions. To achieve this, the interface should be changed to
specify the particular server, whose setting is inquired.

[09/08/94 public]
Let me make sure that I understand.  Only one GDS program exports the
DCE serviceability interface.  You would like the IDL file changed so
that "inq_components" took in a string that could be used to identify
the actual GDS process, and similarly for inq_table?  If so, then I am
cancelling this.  It's not required and goes against the DCE philosophy:
servers should speak DCE.  Yes, GDS is different, but I think here
the philosophy is more important.  It was never a requirement that GDS
be able to change routings and such on the fly -- we were (and still
are)very pleased by the amount of SVC work SNI has done.

If you want to change the GDS DCE server sp that it returns "operation
not supported" or some such, that is fine.  (Just remember to set the count
field to zero so IDL doesn't try to marshall garbage. :-)



CR Number                     : 10451
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dcecp
Subcomponent Name             : admin/dcecp/scripts
Short Description             : compilation errors
and bad file permissions
Reported Date                 : 4/25/94
Found in Baseline             : 1.1
Found Date                    : 4/25/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : commands.c, dhd_util.c,
dhd_server.c, dhd_hostdata.c, dhd_keytab.c, cprpc_clerk_cstub.c,  
cprpc_server_cstub.c, dtss_ctrl_cstub.c
Sensitivity                   : public

[4/25/94 public]

[ /admin/dcecp/scripts at 07:07 (AM) Sunday ]

xlc -c       -g -Dunix -D_BSD -D_ALL_SOURCE -DAIX32   -I. \
 -I/u1/devobj/sb/nb_rios/src/admin/dcecp \
 -I/project/dce/build/dce1.1-snap/src/admin/dcecp \
 -I../../time/common -I/u1/devobj/sb/nb_rios/src/time/common \
 -I/project/dce/build/dce1.1-snap/src/time/common \
 -I/u1/devobj/sb/nb_rios/export/rios/usr/include \
 -I/project/dce/build/dce1.1-snap/export/rios/usr/include \
 /project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c 1501-106: \
 (S) Include file dhd.h not found.
....
"/project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c", line 2097.31: \
 1506-045 (S) Undeclared identifier dcp_sv_show. 
"/project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c", line 2099.32: \
 1506-045 (S) Undeclared identifier dcp_sv_start.
"/project/dce/build/dce1.1-snap/src/admin/dcecp/commands.c", line 2101.31: \
 1506-045 (S) Undeclared identifier dcp_sv_stop.
*** Error code 1

"audit_control_cstub.c", line 597.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.

xlc: 1501-233 Input file \
 /project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_util.c does not have \
 correct permissions
*** Error code 252
xlc: 1501-233 Input file \
 /project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_server.c does not have \
 correct permissions
*** Error code 252
xlc: 1501-233 Input file \
/project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_server.c does not have \
 correct permissions
*** Error code 252
xlc: 1501-233 Input file \
/project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_hostdata.c does not have \
 correct permissions
*** Error code 252
xlc: 1501-233 Input file \
/project/dce/build/dce1.1-snap/src/admin/dcecp/dhd_keytab.c does not have \
correct permissions
*** Error code 252

"cprpc_clerk_cstub.c", line 1050.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cprpc_server_cstub.c", line 987.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.

"dtss_ctrl_cstub.c", line 1168.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"dtss_ctrl_cstub.c", line 1244.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.

[4/25/94 public]

Corrected platform fields to "all": assumed would break 486 as well.

[4/25/94 public]

Corrected permission on dhd* files in the RCS tree to 444.

Changed platform fields to rs6000 as the HPUX platform built these files
without errors according to the build log. The -DAIX flag indicates the
RIOS platform.

It's best to wait to see what the outcome of the 486 build is first before
opening a defect. :-)

[5/2/94 public]
seems to have been fixed.



CR Number                     : 10412
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : 
Short Description             : auditd needs to unregister if's on startup
Reported Date                 : 4/20/94
Found in Baseline             : 1.1b7
Found Date                    : 4/20/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/20/94 public]
The audit daemon should clean up the registered object uuids in the
namespace when it starts up. Currently the uuids collect between
invocations of auditd.

This only occurs when auditd is stopped with a kill. Auditd cleans up after
itself when it receives an exception, or when
rpc_mgmt_stop_server_listening() is called.

[5/05/94 public]
According to Rich Salz, this is a general issue, not addressed for 1.1.
Current situation is that whoever does a "hard stop" does the cleanup too.



CR Number                     : 10396
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditd
Short Description             : auditd does not release the tty upon startup causing rsh to hang
Reported Date                 : 4/19/94
Found in Baseline             : 1.1
Found Date                    : 4/19/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/19/94 public]

The command "rsh <machine_name> auditd" hangs, my guess is that auditd does not
release the tty correctly or no signal is returned saying that auditd had suc-
cessfully started so the rsh will not terminate.

[5/13/94 public]
Auditd needs a tty in order to output the audit records in case action alarm
has been specified.
In the local case, the prompt is returned, but the tty is not closed for that
reason.  In the rsh case, the prompt cannot be returned without closing the
tty, which would prevent alarms being displayed on the console.
(to my knowledge...)



CR Number                     : 10372
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : aud
Subcomponent Name             : 
Short Description             : core dump when opening
non-native audit file
Reported Date                 : 4/15/94
Found in Baseline             : 1.1b7
Found Date                    : 4/15/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/15/94 public]
audtrail show dumps core on the rios.

[4/15/94 public]
This problem happens with autitcp too. Reassigned to audit folk.

auditcp> audtrail show
Enter trail file name: /users/rousseau/auditd_trail
Enter trail dump file name (enter for screen dump):
Segmentation fault (core dumped)

(dbx) where
memcmp._moveeq() at 0xd00cbb24
fread(0xdfe36720, 0x201c98e0, 0x1010000, 0x45d888a) at 0xd00cfbb8
cma_fread(0x0, 0x1, 0xa0000000, 0x20002078) at 0xd07e72c0
dce_aud_next(at = 0x20183128, predicate = (nil), format = 0, ard =
0x2ff7de84, status = 0x2ff7de7c), line 223 in "evt_read.c"
audtrail_show(clientData = (nil), interp = 0x200d9d48, argc = 2, argv =
0x2ff7e13c), line 1778 in "aud_ops.c"
dcp_audtrail(clientData = (nil), interp = 0x200d9d48, argc = 2, argv =
0x2ff7e13c), line 1874 in "commands.c"
Tcl_Eval(0x200d9d48, 0x2ff7e3f0) at 0x10002178
Tcl_UplevelCmd(0x0, 0x200d9d48, 0x1, 0x2ff7e3b0) at 0x1000f0a0
Tcl_Eval(0x200d9d48, 0x2ff7e8de) at 0x10002178
TclParseNestedCmd(0x200d9d48, 0x2ff7e8de, 0x0, 0x2ff7e5f0, 0x2ff7e674) at
0x1000ac44
TclParseWords(0x200d9d48, 0x2ff7e8d6, 0x0, 0x8, 0x2ff7e5f0, 0x2ff7e610,
0x2ff7e64c, 0x2ff7e674) at 0x1000b334
Tcl_Eval(0x200d9d48, 0x2ff7e8d0) at 0x10001d98
Tcl_IfCmd(0x0, 0x200d9d48, 0x3, 0x2ff7e87c) at 0x1001accc
Tcl_Eval(0x200d9d48, 0x201c5a5c) at 0x10002178
Tcl_IfCmd(0x0, 0x200d9d48, 0x3, 0x2ff7eaac) at 0x1001accc
Tcl_Eval(0x200d9d48, 0x200e1908) at 0x10002178
InterpProc(0x200e18e8, 0x200d9d48, 0x0, 0x2ff7ed9c) at 0x1000f504
Tcl_Eval(0x200d9d48, 0x2ff7f450) at 0x10002178
Tcl_RecordAndEval(0x200d9d48, 0x2ff7f450, 0x0) at 0x10018d8c
main(argc = 0, argv = (nil)) at 0x10000890

[4/14/94 public]
This was using an audit trail file built on the at386 plaform. Audit trail
files are not portable between machines. Canceled.

[4/18/94 public]
Re-opened.  Audit should handle this situation more gracefully.

[4/19/94 public]
Re-cancelled.  Dick Mackey feels that this isn't a situation which the
audit system is designed to handle.  Providing support for non-native audit
trails would be considered an enhancement.



CR Number                     : 10365
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : remove redundant tracing statements
Reported Date                 : 4/15/94
Found in Baseline             : 1.1a
Found Date                    : 4/15/94
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/15/94 public]

We are proposing to remove the dprintfs and the dmprintfs for
which there is already a corresponding calls to icl_Trace.
Seems that we don't need debugging printf's which are turned on via a compile
switch when we have icl.  With the advent of servicability, there is 
just going to be too many ways of logging information.

Scream now if it hurts.

[06/08/94 public]

I submitted this, but somebody overwrote my changes, and
now I don't have time to fix this before I leave, therefore
I'm cancelling it.



CR Number                     : 10361
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10360
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : dir create can't set CDS_ObjUUID
Reported Date                 : 4/14/94
Found in Baseline             : 1.0
Found Date                    : 4/14/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/14/94 public]

'dir create /.:/foo -attr {CDS_ObjectUUID <uuid>}' fails complaining
that the attribute is not writable. This is because directory_create,
unlike object_create, doesn't special-case the CDS_ObjectUUID
attribute so as to include it in the create call, but tries to add it
as an attribute afterwards. (See, however, CR 10360: there's a bug in
object_create's handling of this that results in it not being able to
set multiple attributes.)

[4/15/94 public]

I am informed that CDS_ObjectUUID is not intended to be writable for a
directory. Cancelled.



CR Number                     : 10358
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : 
Short Description             : can't create a new filter
Reported Date                 : 4/14/94
Found in Baseline             : 1.1b7
Found Date                    : 4/14/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1beta
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/14/94 public]
I can't seem to add new principals with auditcp anymore. I was able to add
one with dcecp this morning (principal rousseau). Now I can't add any more
with either control program.

auditcp> audfilter add
Enter
0 for principal
1 for foreign principal
2 for group
3 for foreign group
4 for cell
5 for cell overridable
6 for world
7 for world overridable
2
Enter Subject Name (press enter if no more subject): none
Enter Audit Condition (press entrer if no more condition): log
The audit condition is invalid.
Enter Audit Condition (press entrer if no more condition): success
Enter Audit Condition (press entrer if no more condition): denial
Enter Audit Condition (press entrer if no more condition): 
Enter Audit Action (press entrer if no more action): log
Enter Audit Action (press entrer if no more action): alarm
Enter Audit Action (press entrer if no more action): 
Enter Event Class (press enter if no more event classes):
dce_dts_mgt_modify
Enter Event Class (press enter if no more event classes): dce_dts_mgt_query

Enter Event Class (press enter if no more event classes): 
More Guides? (n)/y n
auditcp> audfilter catalog
principal rousseau

...the new filter isn't here...

[4/15/94 public]
Arrghh. I got bit by the "I'm not going to tell you that you failed the
permission check" problem again. There is no bug in creating a filter,
but there does seem to be a problem in the acl manager.

The cds entry gives cell_admin privledges...
dcecp> acl show /.:/hosts/ninja/aud-acl -e
{unauthenticated r--t-}
{user hosts/ninja/self rwdtc}
{user cell_admin rwdtc}
{group subsys/dce/cds-admin rwdtc}
{group subsys/dce/cds-server rwdtc}
{any_other r--t-}

This is why I originally thought that I wasn't hitting a permissions
problem, but I can't contact auditd's acl manager to change the acl there.
[ninja]:/usr/users/rousseau> acl_edit /.:/hosts/ninja/aud-acl
ERROR: communications failure (dce / rpc)
Unable to bind to object /.:/hosts/ninja/aud-acl

Should I be able to do the above?

[5/06/94 public]
This problem is caused by accumulation of entries in the CDS database, which are
caused by "hard stops" (kill) of auditd.  Same as explained in CR 10412, there is
no generic solution for cleaning up after hard stops, therefore the cleanup has
to be done manually.

[5/6/94 public]
Oops, didn't mean to re-open this.



CR Number                     : 10348
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : Registry code points not working
Reported Date                 : 4/13/94
Found in Baseline             : 1.1
Found Date                    : 4/13/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/13/94 public]


This may be a placeholder for code that hasn't been dropped
yet but I figured I would put in a CR anyway.

I just tried the registry audit code points against bl-6
and when I tried adding accounts and then logging in against them
nothing was added to the audit trail:


root@clam {3} ==> ps -aef | grep auditd
root      8183     1  0.0 17:49:30 ??           0:01.23 auditd -a
root      8204  8196  0.0 17:53:21 pts/15       0:00.04 grep auditd
root@clam {4} ==> rgy_edit
Current site is: registry server at /.../clam_cell.osf.org/subsys/dce/sec/master 
rgy_edit=> do p
Domain changed to: principal
rgy_edit=> add fubar
rgy_edit=> do a
Domain changed to: account
rgy_edit=> add fubar -g none -o none -mp -dce- -pw fubar -ena c -ena s
rgy_edit=> quit
bye.
root@clam {5} ==> dce_login fubar fubar
You have mail.
root@clam {1} ==> exit
root@clam {2} ==> root@clam {6} ==> dce_login cell_admin -dce-
Password must be changed!
You have mail.
root@clam {1} ==> auditcp
auditcp> audtrail show
Enter trail file name: /opt/dcelocal/var/audit/adm/central_trail
Enter trail dump file name (enter for screen dump):
auditcp>

[5/3/94 public]
According to Sue, this was working and was just pilot error at the time.
I'm cancelling this one.  (yes, it's true that PGO auditing isn't in yet, but
that'll be opened as an enhancement request to drop new functionality, and is
not part of the above reported non-problem anyway).



CR Number                     : 10342
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 10342
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : uuidgen
Short Description             : Enhancements in the handling of command line options.
Reported Date                 : 4/13/94
Found in Baseline             : 1.0.2
Found Date                    : 4/13/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/idl/uuidgen/uuidgen.c
Sensitivity                   : public

[4/13/94 public]
Hitachi submitted an enhancement request which would make uuidgen
deal with options more strictly ("-h" would give help but "-help"
would be illegal as would be anything else that starts with "-h").

I think the appropriate enhancement would be to a) use a standard
getopt() or b) use a modified getopt() that accepts long option
names but checks that the option is an unambiguous substring of
a standard long form. In both cases, portability would be enhanced.
Both cases however would be more appropriately dealt with as general
cleanup items and would be out of the scope of 1.1.

[05/04/94 public]
Fixed in a mad fit of hacking one night:
 *      Use SAMS and getopt; general cleanup (OT CR 10342).
Using standard getopt in the standard way.
Cancelling.



CR Number                     : 10339
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : client/admin/rgy_edit/eif_site.c
Short Description             : String comparison in eif_check_site() is opposite to what was intended.
Reported Date                 : 4/13/94
Found in Baseline             : 1.0.2
Found Date                    : 4/13/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : sec/client/admin/rgy_edit/eif_site.c
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[4/13/94 public]

 In client/admin/rgy_edit/eif_site.c, in the eif_site_check() routine,
 the decision to print the site info. is not computed correctly.
 
 This is from MJ JS10B019.
 
Related-file::Added 931122 by rusman::
/build/hiosfm/RCS/src/dce/src/security/cl
ient/admin/rgy_edit/./eif_site.c,v 7.2
 /build/hiosfm/RCS/src/dce/src/security/client/admin/rgy_edit/./eif_site.c,v 7.2
 rusman 1993/11/22 19:16:31 +6 -2
 Reason:  OSDqa06684 missing a ! in if condition
 correct check for printing site info.
 
     *** /tmp/ci.4507..eif_site.c.4534.1        Mon Nov 22 14:16:32 1993
     --- /tmp/eif_site.c.4534.2 Mon Nov 22 14:16:32 1993
     ***************
     *** 361,371 ****
     --- 361,375 ----
        }
           }
         
               /* if we were already bound, don't print new site info
unless it'
s
           really different than the one we were previously bound to */
     + #if defined(hitm)
     +     if ( (bound)  && (!strcmp((char*)prev_site, (char *)new_site)) )
     + #else
           if ( (bound)  && (strcmp((char*)prev_site, (char *)new_site)) )
     + #endif
        print_site = false;
           
           if (print_site) {
        if (bound)
            eif_print_site(eif_site_changed, new_site, new_access);



CR Number                     : 10330
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : login
Short Description             : Login randomly returns "Context has not been validated".
Reported Date                 : 4/12/94
Found in Baseline             : 1.1
Found Date                    : 4/12/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1beta
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/12/94 public]

Note on OSF platform these tests execute successfully.

Some output from acl_delete_P.tcl test suite:

200|0 1 10:05:57|TP Start
520|0 1 28481 1 24|acl_delete_018_P: Delete all ACL entries except the user_obj
entry if it
520|0 1 28481 1 25|acl_delete_018_P: exists for more than 1 ACL object, which ar
e individually
520|0 1 28481 1 26|acl_delete_018_P: enclosed in braces.
520|0 1 28481 1 27|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 28481 1 28|Command returned: {Context has not been validated}
520|0 1 28481 1 29|Test aborted.
220|0 1 2 10:06:01|UNRESOLVED
410|0 4 1 10:06:02|IC End
400|0 5 1 10:06:02|IC Start
200|0 1 10:06:03|TP Start
520|0 1 28481 1 30|acl_delete_019_P: Delete all ACL entries except the user_obj
entry if it
520|0 1 28481 1 31|acl_delete_019_P: exists for 1 ACL object.
520|0 1 28481 1 32|acl_delete_019_P: This test operates on the namespace entry A
CL of the
520|0 1 28481 1 33|acl_delete_019_P: specified object.
520|0 1 28481 1 34|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 28481 1 35|Command returned: {Context has not been validated}
520|0 1 28481 1 36|Test aborted.
220|0 1 2 10:06:07|UNRESOLVED
410|0 5 1 10:06:07|IC End

[4/12/94 public]
The problem turns out to be that one of the interal routines that get the
principal and cell named from the registry service was not returning a
TCL_OK upon successful completion. This led to spurious results in the
login code.

[5/19/94 public]
The above change did not fix the problem. The HP security drop of 
Friday 3/13/94 did. The problem can not be reproduced now. Cancelled.

[5/19/94 public]
It wasn't the HP drop of 3/13 necessarily.  I have not reinstalled DCE
since the 5/4/94 nightly build.  I have rebuilt dcecp with the latest
code (late 5/18) and I can no longer reproduce the problem.

[5/19/94 public]
Well, It does not work for me. My dce was installed from the 5/17/94 nightly
build. The following is the journal file I just ran a few of mins ago. The
error msg is not same as this one you cancelled thr. Please let me know if
you want me to open a separated OT. Thanks.

--------------

0|1.10 10:34:01 19940519|User: pwang (1294) TCC Start, Command Line: tcc -e admin/dcecp secval 
20|/work/sandboxes/dce11sb/install/at386/dcetest/dce1.1/test/admin/dcecp/tetexec.cfg 1|Config Start
30||TET_VERSION=1.10
30||TET_OUTPUT_CAPTURE=False
30||TET_RESCODES_FILE=tet_code
30||TET_EXEC_IN_PLACE=TRUE
30||TET_SIG_IGN=26
30||DCP_CLIENT=cell_admin
30||DCP_CLIENT_PW=-dce-
30||DCP_CELLNAME_ONE=/.../absolut_cell.osf.org
30||DCP_NOTROOT=notroot
30||DCP_NOTROOT_PW=-notroot-
30||DCP_CELLNAME_TWO=/.../ninja_cell.osf.org
30||DCP_HOSTNAME_ONE=absolut
30||DCP_HOSTNAME_TWO=ninja
30||DCP_HOSTNAME_THREE=hosts/foster
30||DCP_INTERCELL_AVAIL=0
30||DCP_DFS_AVAIL=0
30||OBJECT_UUID=8a2352c8-5b9e-11cd-aa03-080009251352
30||PROTSEQ=ncacn_ip_tcp
30||NETADDR=130.105.5.93
30||ENDPOINT=1701
30||VERBOSE=1
30||DCP_ACL_OBJ_MASK1=/.:/hosts/$DCP_HOSTNAME_ONE/dts-entity
30||DCP_ACL_OBJ_DELEGATION=XXX
30||DCP_ACL_OBJ_EXTENDED=XXX
30||EXTENDED_UUID=XXX
30||EXTENDED_NDR_F1=XXX
30||EXTENDED_NDR_F2=XXX
30||EXTENDED_NDR_F3=XXX
30||EXTENDED_NDR_F4=XXX
30||EXTENDED_NBR_BYTES=4
30||EXTENDED_DATA=0a0b0c0d
30||DCP_LOG_SRVR_ONE=/.:/hosts/$DCP_HOSTNAME_ONE/dts-entity
30||DCP_LOG_SRVR_TWO=/.:/hosts/$DCP_HOSTNAME_ONE/cds-clerk
30||DCP_LOG_COMP_ONE=dts
30||DCP_LOG_COMP_TWO=cds
30||DCP_AUD_CELLNAME=/.../ninja_cell.osf.org
30||DCP_AUD_TRAIL_FILE_1=/tmp/trail1
30||DCP_AUD_TRAIL_FILE_2=/tmp/trail2
30||DCP_AUD_TRAIL_OUTFILE=/tmp/trail.out
40||Config End
70||"Starting secval test suite"
70||"Starting negative secval tests"
70||"Starting negative secval activate tests"
10|0 /ts/secval/secval_activate_N.tcl 10:34:01|TC Start, scenario ref 479-1
15|0 1.10 4|TCM Start
400|0 1 1 10:34:35|IC Start
200|0 1 10:34:35|TP Start
520|0 1 11896 1 1|secval_activate_1_N: check that extra/invalid options are trapped as errors.
520|0 1 11896 1 2|==== Contents of test case:
520|0 1 11896 1 3|{         list [catch {secval activate -foo} msg] $msg     }
520|0 1 11896 1 4|Test completed successfully.
520|0 1 11896 1 5|Test Passed.
220|0 1 0 10:34:36|PASS
410|0 1 1 10:34:36|IC End
400|0 2 1 10:34:36|IC Start
200|0 1 10:34:36|TP Start
520|0 1 11896 1 6|secval_activate_2_N: check that a wrong host are returned as errors.
520|0 1 11896 1 7|==== Contents of test case:
520|0 1 11896 1 8|{         list [catch {secval activate foo} msg] $msg     }
520|0 1 11896 1 9|Test completed successfully.
520|0 1 11896 1 10|Test Passed.
220|0 1 0 10:34:37|PASS
410|0 2 1 10:34:37|IC End
400|0 3 1 10:34:38|IC Start
200|0 1 10:34:38|TP Start
520|0 1 11896 1 11|secval_activate_3_N: check that non-privileged users are handled correctly.
520|0 1 11896 1 12|Command failed: {login $DCP_NOTROOT -password $DCP_NOTROOT_PW}
520|0 1 11896 1 13|Command returned: {unknown interface}
520|0 1 11896 1 14|Test aborted.
220|0 1 2 10:34:42|UNRESOLVED
410|0 3 1 10:34:43|IC End
400|0 4 1 10:34:43|IC Start
200|0 1 10:34:43|TP Start
520|0 1 11896 1 15|secval_activate_4_N: check activate secval which is already active returning a error.
520|0 1 11896 1 16|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 11896 1 17|Command returned: {unknown interface}
520|0 1 11896 1 18|Test aborted.
220|0 1 2 10:34:46|UNRESOLVED
410|0 4 1 10:34:46|IC End
80|0 0 10:34:53|TC End
70||"Finished negative secval activate tests"
70||"Starting negative secval deactivate tests"
10|1 /ts/secval/secval_deactivate_N.tcl 10:34:53|TC Start, scenario ref 482-1
15|0 1.10 4|TCM Start
400|0 1 1 10:35:11|IC Start
200|0 1 10:35:11|TP Start
520|0 1 12048 1 1|secval_deactivate_1_N: check that extra/invalid options are trapped as errors.
520|0 1 12048 1 2|==== Contents of test case:
520|0 1 12048 1 3|{         list [catch {secval deactivate -foo} msg] $msg     }
520|0 1 12048 1 4|Test completed successfully.
520|0 1 12048 1 5|Test Passed.
220|0 1 0 10:35:12|PASS
410|0 1 1 10:35:12|IC End
400|0 2 1 10:35:12|IC Start
200|0 1 10:35:12|TP Start
520|0 1 12048 1 6|secval_deactivate_2_N: check that a wrong host are returned as invalid arg.
520|0 1 12048 1 7|==== Contents of test case:
520|0 1 12048 1 8|{         list [catch {secval deactivate foo} msg] $msg     }
520|0 1 12048 1 9|Test completed successfully.
520|0 1 12048 1 10|Test Passed.
220|0 1 0 10:35:13|PASS
410|0 2 1 10:35:13|IC End
400|0 3 1 10:35:13|IC Start
200|0 1 10:35:13|TP Start
520|0 1 12048 1 11|secval_deactivate_3_N: check that unauthenticated users are handled correctly.
520|0 1 12048 1 12|Command failed: {login $DCP_NOTROOT -password $DCP_NOTROOT_PW}
520|0 1 12048 1 13|Command returned: {unknown interface}
520|0 1 12048 1 14|Test aborted.
220|0 1 2 10:35:17|UNRESOLVED
410|0 3 1 10:35:17|IC End
400|0 4 1 10:35:17|IC Start
200|0 1 10:35:17|TP Start
520|0 1 12048 1 15|secval_deactivate_4_N: check that deactivate secval which is not active returning a error.
520|0 1 12048 1 16|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 12048 1 17|Command returned: {unknown interface}
520|0 1 12048 1 18|Test aborted.
220|0 1 2 10:35:20|UNRESOLVED
410|0 4 1 10:35:20|IC End
80|1 0 10:35:26|TC End
70||"Finished negative secval deactivate tests"
70||"Starting negative secval ping tests"
10|2 /ts/secval/secval_ping_N.tcl 10:35:26|TC Start, scenario ref 485-1
15|0 1.10 3|TCM Start
400|0 1 1 10:35:35|IC Start
200|0 1 10:35:35|TP Start
520|0 1 12184 1 1|secval_ping_1_N: check that extra/invalid options are trapped as errors.
520|0 1 12184 1 2|==== Contents of test case:
520|0 1 12184 1 3|{         list [catch {secval ping -foo} msg] $msg     }
520|0 1 12184 1 4|Test completed successfully.
520|0 1 12184 1 5|Test Passed.
220|0 1 0 10:35:36|PASS
410|0 1 1 10:35:36|IC End
400|0 2 1 10:35:37|IC Start
200|0 1 10:35:37|TP Start
520|0 1 12184 1 6|secval_ping_2_N: check that a wrong host are returned as errors.
520|0 1 12184 1 7|==== Contents of test case:
520|0 1 12184 1 8|{         list [catch {secval ping foo} msg] $msg     }
520|0 1 12184 1 9|Test completed successfully.
520|0 1 12184 1 10|Test Passed.
220|0 1 0 10:35:37|PASS
410|0 2 1 10:35:37|IC End
400|0 3 1 10:35:38|IC Start
200|0 1 10:35:38|TP Start
520|0 1 12184 1 11|secval_ping_3_N: check that a non login context's user get 0 as the result.
520|0 1 12184 1 12|==== Contents of test case:
520|0 1 12184 1 13|{     	list [catch {secval ping} msg] $msg     }
520|0 1 12184 1 14|Test completed successfully.
520|0 1 12184 1 15|Test Passed.
220|0 1 0 10:35:39|PASS
410|0 3 1 10:35:39|IC End
80|2 0 10:35:40|TC End
70||"Finished negative secval ping tests"
70||"Starting positive secval tests"
70||"Starting positive secval activate tests"
10|3 /ts/secval/secval_activate_P.tcl 10:35:40|TC Start, scenario ref 489-1
15|0 1.10 2|TCM Start
400|0 1 1 10:35:53|IC Start
200|0 1 10:35:53|TP Start
520|0 1 11842 1 1|secval_activate_5_P: check to see that we can activate secval.
520|0 1 11842 1 2|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 11842 1 3|Command returned: {unknown interface}
520|0 1 11842 1 4|Test aborted.
220|0 1 2 10:35:56|UNRESOLVED
410|0 1 1 10:35:57|IC End
400|0 2 1 10:35:57|IC Start
200|0 1 10:35:57|TP Start
520|0 1 11842 1 5|secval_activate_6_P: check to see that we can activate secval by hostname.
520|0 1 11842 1 6|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 11842 1 7|Command returned: {unknown interface}
520|0 1 11842 1 8|Test aborted.
220|0 1 2 10:36:01|UNRESOLVED
410|0 2 1 10:36:01|IC End
80|3 0 10:36:07|TC End
70||"Finished  positive secval activate tests"
70||"Starting positive secval deactivate tests"
10|4 /ts/secval/secval_deactivate_P.tcl 10:36:07|TC Start, scenario ref 492-1
15|0 1.10 2|TCM Start
400|0 1 1 10:36:19|IC Start
200|0 1 10:36:19|TP Start
520|0 1 12620 1 1|secval_deactivate_5_P: check to see that we can deactivate secval.
520|0 1 12620 1 2|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 12620 1 3|Command returned: {unknown interface}
520|0 1 12620 1 4|Test aborted.
220|0 1 2 10:36:23|UNRESOLVED
410|0 1 1 10:36:23|IC End
400|0 2 1 10:36:23|IC Start
200|0 1 10:36:23|TP Start
520|0 1 12620 1 5|secval_deactivate_6_P: check to see that we can deactivate secval by hostname.
520|0 1 12620 1 6|Command failed: {login $DCP_CLIENT -password $DCP_CLIENT_PW}
520|0 1 12620 1 7|Command returned: {unknown interface}
520|0 1 12620 1 8|Test aborted.
220|0 1 2 10:36:26|UNRESOLVED
410|0 2 1 10:36:26|IC End
80|4 0 10:36:33|TC End
70||"Finished  positive secval deactivate tests"
70||"Starting positive secval ping tests"
10|5 /ts/secval/secval_ping_P.tcl 10:36:33|TC Start, scenario ref 495-1
15|0 1.10 2|TCM Start
400|0 1 1 10:36:41|IC Start
200|0 1 10:36:41|TP Start
520|0 1 12773 1 1|secval_ping_4_P: check to see that we can ping secval.
520|0 1 12773 1 2|Command failed: {login $DCP_NOTROOT -password $DCP_NOTROOT_PW}
520|0 1 12773 1 3|Command returned: {unknown interface}
520|0 1 12773 1 4|Test aborted.
220|0 1 2 10:36:46|UNRESOLVED
410|0 1 1 10:36:47|IC End
400|0 2 1 10:36:47|IC Start
200|0 1 10:36:47|TP Start
520|0 1 12773 1 5|secval_ping_5_P: check to see that we can ping secval by hostname.
520|0 1 12773 1 6|Command failed: {login $DCP_NOTROOT -password $DCP_NOTROOT_PW}
520|0 1 12773 1 7|Command returned: {unknown interface}
520|0 1 12773 1 8|Test aborted.
220|0 1 2 10:36:50|UNRESOLVED
410|0 2 1 10:36:50|IC End
80|5 0 10:36:51|TC End
70||"Finished  positive secval ping  tests"
70||"Finished  positive secval  tests"
70||"Finished secval test suite"
900|10:36:51|TCC End
-------------------------------



CR Number                     : 10324
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : 
Short Description             : errors during SPLIT SERVER config
Reported Date                 : 4/11/94
Found in Baseline             : 1.1
Found Date                    : 4/11/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/11/94 public]

Configuring 3 machine CHO cell with dce1.1ab2 failed with the following
errors:

m2 (CDS server, DTS server, flserver and dfs client):
S:****** Modifying the registry database for DFS server operation...
ERROR:   acl_edit error while adding principal to dfs-admin group for DFS
           Message from acl_edit:
           ERROR: not RPC entry (dce / rpc)
         Unable to bind to object /.:/sec/principal/hosts/dce8/dfs-server
        Press <RETURN> to continue, CTRL-C to exit:

Apparently, dce_config does not support SPLIT CORE SERVER configurations
for cells which will also contain DFS.

[04/11/94 public]
Eh?  How do you figure?

What change has been made to dce_config that would make split servers not work?
Are you sure you dce core is fuctioning correctly?
Has /.:/sec/principal/hosts/dce8/dfs-server been created correctly?

[4/11/94 public]

Split core servers work - just not able to add my DFS servers to the cell ...
I'm looking into it now.

[04/12/94 public]
Cancelling - apparently it is required that you return and continue configuring
on the security server after configuring the cds server for the core services
setup to be complete. That is you cannot:

	- configure security server on m1
	- configure cds and a DFS flserver on m2

but must:
	- configure security server on m1
	- configure cds server on m2
	- configure xxx on m1
	- configure flserver on m2



CR Number                     : 10316
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : xds
Short Description             : xds/threads_stress fails on
486/remote
Reported Date                 : 4/8/94
Found in Baseline             : 1.1
Found Date                    : 4/8/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/8/94 public]
The test configuration is:
	
	M1 -	HP800
	M2 -	AT486/OSF1

The following tests fail:

*** threads_stress
     T10bind1s.log [Apr  7 16:53 ] 
       [4]BODYbind_1: TESTCASE [4]BODYbind_1 FAILED
       [5]BODYbind_2: TESTCASE [5]BODYbind_2 FAILED
       [6]BODYbind_3: TESTCASE [6]BODYbind_3 FAILED
       [7]BODYbind_4: TESTCASE [7]BODYbind_4 FAILED
       [8]BODYbind_5: TESTCASE [8]BODYbind_5 FAILED
     T10unbind1s.log [Apr  7 16:53 ]
       [4]BODYunbind_1: TESTCASE [4]BODYunbind_1 FAILED
       [5]BODYunbind_2: TESTCASE [5]BODYunbind_2 FAILED
       [6]BODYunbind_3: TESTCASE [6]BODYunbind_3 FAILED
       [7]BODYunbind_4: TESTCASE [7]BODYunbind_4 FAILED
       [8]BODYunbind_5: TESTCASE [8]BODYunbind_5 FAILED
     T2bind1s.log [Apr  7 16:53 ] 
       [4]BODYbind_1: TESTCASE [4]BODYbind_1 FAILED
       [5]BODYbind_2: TESTCASE [5]BODYbind_2 FAILED

Logs will be in /afs/dce/project/dce/sni/ot<whatever>

[4/8/94 public]
Just found that the Sstub had died on M1.  No core file, however.  Will try
to rerun test.

[4/11/94 public]
Cancelled.  This was a side-effect of 10321.  I have rerun test
successfully.



CR Number                     : 10313
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : rpc
Subcomponent Name             : runtime
Short Description             : auditd returns unknown reject after multiple calls
Reported Date                 : 4/7/94
Found in Baseline             : 1.1
Found Date                    : 4/7/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/7/94 public]
The audit daemon returns 'unknown reject' after 5 or so RPC's from 
the control interface. I haven't had a chance to try and track this down yet.
Repeating the same command will cause it to fail as well as different commands. 

dcecp> audf s {principal salamone}
{all all dce_audit_filter_query}
{denial all dce_dts_mgt_modify}
dcecp> audf s {principal salamone}
{all all dce_audit_filter_query}
{denial all dce_dts_mgt_modify}
dcecp> audf s {principal salamone}
{all all dce_audit_filter_query}
{denial all dce_dts_mgt_modify}
dcecp> audf s {principal salamone}
{all all dce_audit_filter_query}
{denial all dce_dts_mgt_modify}
dcecp> audf s {principal salamone}
Error: unknown reject
dcecp> audf s {principal salamone}
Error: unknown reject

Let me know what I can do to help narrow this down.

[4/14/94 public]
By caching the binding to the server I was able to work around this
problem. Previously I was binding to the server and then
rpc_binding_free()'ing the binding when I was done (after each command). I
think that this should work too. Any ideas?

[7/18/94 public]
I don't think this is an audit problem.  From the description it seems 
something to do with rpc runtime.  I think I could bypass the problem
also if I would declare the audfilter show operation as idempotent.

[7/18/94 public]

Which protocol (DG or CN) dcecp was using? Was it authenticated or not? If
it was, which level? If it was DG with pkt_privacy, it might be fixed by
CR9614.

[7/19/94 public]
Since John seems to have no way to reproduce this,
and given the high possibility that has been fixed (OT9614).
Canceled.  Please re=open if able to reproduce.



CR Number                     : 10298
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : dfsexport
Short Description             : dfsexport core dump
Reported Date                 : 4/5/94
Found in Baseline             : 1.1a
Found Date                    : 4/5/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/5/94 public]


"dfsexport -detach -all" coredumps if dfsatab does not exist. 



Child died due to: bus error
WARNING: /usr/lib/end.o was not linked with this program (UE836)
         Shared-library debugging cannot be made available (UE837)
Procedures:      0
Files: 0
>Sig  Stop    Ignore  Report  Name
 20  No      No      Yes     virtual time alarm
>Sig  Stop    Ignore  Report  Name
 20  No      No      No      virtual time alarm
>t
 0 DMEM + 0x0d27d008 (0, 0, 0, 0)
 1 ftu_AggrSyscall + 0x00000128 (0, 0, 0, 0)
>

[9/15/94 public]
Hasn't been seen in months.  Seems to work for me, both 
platforms.  Cancel.



CR Number                     : 10280
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : tar problem
Reported Date                 : 4/4/94
Found in Baseline             : 1.1a
Found Date                    : 4/4/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/4/94 public]

THIS is NOT a bug.



CR Number                     : 10265
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : cds
Short Description             : dir show cores on unknown cell.
Reported Date                 : 3/31/94
Found in Baseline             : 1.1
Found Date                    : 3/31/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/31/94 public]
The dir show command core dumps on cell names that aren't recognized.

dcecp> dir show /.../ice_cell.osf.org

Program received signal 11, Segmentation fault
0xa405ca38 in memcpy (5572018, -1073754760)
(gdb) where
#0  0xa405ca38 in memcpy (5572018, -1073754760)
#1  0x428b3c in read_attr_value (dir_name=0xbfffdcf4, 
    name=0x736c6500<Address 0x736c6500 out of bounds>, value=0xbfffd720, 
    attrvalue=0xbfffd71c, type=cdsDir, clr_name=0x0)
    at /project/dce/build/dce1.1/src/admin/dcecp/cdscp_utils.c:2624
#2  0x424671 in directory_show (clientData=0xa405ca24, interp=0x476008,
argc=2, 
    argv=0xbfffe23c) at
/project/dce/build/dce1.1/src/admin/dcecp/cdscp.c:1149
#3  0x402383 in dcp_directory (clientData=0x0, interp=0x476008, argc=2,
argv=0xbfffe23c)
    at /project/dce/build/dce1.1/src/admin/dcecp/commands.c:1166
#4  0x444d53 in Tcl_Eval (4677640, -1073748928)
#5  0x4531b9 in Tcl_UplevelCmd (0, 4677640, 2, -1073748996)
#6  0x444d53 in Tcl_Eval (4677640, -1073748066)
#7  0x451ff3 in TclParseNestedCmd (4677640, -1073748066, 0, -1073748548,
-1073748504)
#8  0x4523cd in TclParseWords
    (4677640, -1073748074, 0, 8, -1073748548, -1073748552, -1073748544,
-1073748504)
#9  0x444ab7 in Tcl_Eval ()
#10 0x44692e in Tcl_IfCmd (0, 4677640, 3, -1073748164)
#11 0x444d53 in Tcl_Eval ()
#12 0x44692e in Tcl_IfCmd (0, 4677640, 3, -1073747784)
#13 0x444d53 in Tcl_Eval (4677640, 5200152)
#14 0x453560 in InterpProc (5186600, 4677640, 3, -1073747220)
#15 0x444d53 in Tcl_Eval ()
#16 0x450616 in Tcl_RecordAndEval (4677640, -1073745660, 0)
#17 0x400575 in main (argc=0, argv=0xbffff1fc)
    at /project/dce/build/dce1.1/src/admin/dcecp/main.c:338

[4/8/94 public]
I have been unable to duplicate this problem. I think this may be a
situation of code skew.

[4/19/94 public]
I can't reproduce either.  If you can't John, please cancel this bug.

[4/22/94 public]
This only happened when Intercell was broken. I can't reproduce it anymore.
Cancelled.



CR Number                     : 10254
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : Lack of "d" access doesn't prevent deletion of CDS entries
Reported Date                 : 3/30/94
Found in Baseline             : 1.1
Found Date                    : 3/30/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/30/94 public]

Removing "d" access from the CDS entry of an object or a link doesn't
prevent it from being deleted. Thus:

dcecp> dir list /.:/temp -obj
/.:/temp/obj
dcecp> acl mod /.:/temp/obj -e -ch {user cell_admin r--t-}
dcecp> acl show /.:/temp/obj -e
{unauthenticated r--t-}
{user cell_admin r--t-}
{group subsys/dce/cds-admin rwdtc}
{group subsys/dce/cds-server rwdtc}
{any_other r--t-}
dcecp> obj del /.:/temp/obj                <---no error
dcecp> dir list /.:/temp -obj
dcecp>					   <---obj gone

Links behave similarly. Directories are OK (i.e., cannot delete a
directory without "d" access).

[3/31/94 public]
The permissions for deleting an object entry are either delete on the
entry or administer on the directory containing the object. Either will
do. Removing both does cause cdscp to deny permission to delete the
object.



CR Number                     : 10249
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : message cat vs. header installs
Reported Date                 : 3/30/94
Found in Baseline             : 1.1b5
Found Date                    : 3/30/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/30/94 public]
dce_config installs message catalogs and header files differently.
It does a "cp *" of the NLS files, but it explicitly lists which files
it copies out of the the include directory.  This is a nuisance for
people adding new facilities to DCE, converting to sams, etc.  I think
both parts should be installed the same way.  I prefer "cp *" as opposed
to explicitly listing everything.

[03/30/94 public]
Turns out that dce_config was already doing a"cp *" of the include
directory as well as the message catalog directory.
Canceled.



CR Number                     : 10242
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : missing file on cmd line gives bad message
Reported Date                 : 3/29/94
Found in Baseline             : 1.1b5
Found Date                    : 3/29/94
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/29/94 public]
You get a bad message when you specify a bogus file to execute from the
command line:

    % dcecp bogus-file
    1322151 SEC_RepUUID 1.3.22.1.5.1couldn't read file "bogus-file": \
    No such file or directory

(FYI, "dcecp /dev/null" is happy.)

[4/20/94 public]
canceled, seems to be fixed now.  Re-open if it appears.



CR Number                     : 10225
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : 
Short Description             : porting bug in HPUX igetinode (OSI)
Reported Date                 : 3/24/94
Found in Baseline             : 1.0.3a
Found Date                    : 3/24/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : osi/HPUX/osi_fio.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96  public]

HP platform specific.  Hasn't been seen in R1.2.

[3/24/94 public]
We recently stumbled upon the following bug in igetinode()
(osi/HPUX/osi_fio.c).

For HP-UX: if iget() returns a not-in-use inode with i_mode==0, it
must be returned via idrop() instead of iput().  Calling iput() in this
situation will result in a guaranteed panic.  I'm not sure why/how we hit
this error case for the first time "ever" (since the original port, at
least) ... that might be indicative of another problem somewhere else
as well.

We've changed the code to the following and are currently in the
process of testing it.  Although it seems correct, we don't have any
easy way of forcing a running system to go down this path.

	/* For hpux: not sure if we could get away with JUST checking
	 * i_mode.  To be safe, look for both.  If i_mode==0, MUST call
	 * idrop() instead of iput(). */
	if ((ip->i_nlink == 0) || (ip->i_mode == 0)) {
	    if (ip->i_mode == 0)
		idrop(ip);
	    else
		iput(ip);
	    osi_setuerror(ENOENT);
	    return;
	}

[4/20/94 public]
Daryl,  Any test results to share on this one?  We're looking
at integrating it here. Thx

[8/26/94 public]
No ... this was found by inspection.  It's a fairly obscure error case that
I wouldn't even know how to generate.



CR Number                     : 10222
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : aud
Short Description             : auditcp checks for
authentication. Should be left to the server.
Reported Date                 : 3/24/94
Found in Baseline             : 1.1
Found Date                    : 3/24/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/24/94 public]
auditcp checks to see if the user is authenticated. The cp should be
changed to let the unauthneticaed calls pass to the server. The server
should be modifed to handle unauthenticated users correctly.

[7/6/94 public]
auditcp is defuncted, so changed component to dcecp.

[7/7/94 public]
Seeing that I opened this in the first place, I made sure that 
dcecp did the right thing. Cancelled.



CR Number                     : 10213
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : directory/cds/child
Short Description             : cds_clerkserver_cstub.c compile errors
Reported Date                 : 3/23/94
Found in Baseline             : 1.1
Found Date                    : 3/23/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : cds_clearserver_cstub.c
Sensitivity                   : public

[3/23/94 public]

[ /directory/cds/child at 04:18 (AM) Wednesday ]

xlc -c -Dunix -DDNS_CMA -DDNS_CDS -DDNS_V3API -D_ALL_SOURCE -DDCE_SEC \
 -DDNS_DFS -DDEBUG  -D_ALL_SOURCE -DAIX32   -I. \
 -I/u1/devobj/sb/nb_rios/src/directory/cds/child \
 -I/project/dce/build/dce1.1-snap/src/directory/cds/child \
 -I../stubs -I/u1/devobj/sb/nb_rios/src/directory/cds/stubs \
 -I/project/dce/build/dce1.1-snap/src/directory/cds/stubs -I../includes \
 -I/u1/devobj/sb/nb_rios/src/directory/cds/includes \
 -I/project/dce/build/dce1.1-snap/src/directory/cds/includes \
 -I/u1/devobj/sb/nb_rios/export/rios/usr/include \
 -I/project/dce/build/dce1.1-snap/export/rios/usr/include dcecdsmsg.c
"cds_clerkserver_cstub.c", line 3185.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3266.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3362.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3455.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
"cds_clerkserver_cstub.c", line 3539.19: 1506-193 (E) Function call argument \
 cannot be assigned to corresponding parameter.
Etc.

[3/23/94 public]

I am cancelling this OT since the RIOS compiler messages above do not flag
problems that break anything in the build and the exact meaning of these
"(E)" is not clearly understood.



CR Number                     : 10209
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit allows "substituting" an ACL with duplicate entries.
Reported Date                 : 3/22/94
Found in Baseline             : 1.1
Found Date                    : 3/22/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[3/22/94 public]

Try this:

> acl_edit /.:/jas1
sec_acl_edit> l

# SEC_ACL for /.:/jas1:
# Default cell = /.../ice_cell.osf.org
unauthenticated:r--t---
user:cell_admin:rwdtcia
user:hosts/ice/cds-server:rwdtcia
group:subsys/dce/cds-admin:rwdtcia
group:subsys/dce/cds-server:rwdtcia
any_other:r--t---
sec_acl_edit> sub any_other:rct any_other:rwdtcia
sec_acl_edit> co
sec_acl_edit> l

# SEC_ACL for /.:/jas1:
# Default cell = /.../ice_cell.osf.org
any_other:r--tc--
any_other:rwdtcia


Note that the last entry is used for determining access rights.

[7/14/94 public]
Moved to dcecp component for Howard to look at prior to setting status
to defer to 1.2  (dcecp now performs most functions of the control programs)

[7/18/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to acl_edit and should not be changed back to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 10189
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa, i486
S/W Ref Platform              : hpux, osf1
Component Name                : dcecp
Subcomponent Name             : cds
Short Description             : the "directory show
<dir-name>" core dumps when the <dir-name> does not exit.
Reported Date                 : 3/20/94
Found in Baseline             : 1.1
Found Date                    : 3/20/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/94 public]

Using NB from 03/17/94

The dcecp command "directory show /.:/sales" core dumps if the 
directory /.:/sales does not exist.

Example:

On the 486: ( directory /.:/sales does not exits)

dcecp>  directory show /.:/sales
Memory fault(coredump)
root@barbados>

On HP:

dcecp> directory show /.:/oscar
Memory fault(coredump)
bronze dassarma$

dcecp> object show  /.:/sales/*    (directory /.:/sales does not exist)
Memory fault(coredump)

[3/23/94 public]
This is essentially a bogus failure. That is, all error conditions
encountered within the cds portion of dcecp caused indeterminate 
failures. This is because the DEC drop of the cds cleanup/I18N 
code caused the error returns from the cdspi to be broken. DEC has 
fixed the error return problem and the dcecp failures have 
been eliminated as a result.



CR Number                     : 10175
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa,rs6000
S/W Ref Platform              : hpux,aix
Component Name                : dcecp
Subcomponent Name             : admin/dcecp/scripts
Short Description             : build_all not made
Reported Date                 : 3/18/94
Found in Baseline             : 1.1
Found Date                    : 3/18/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dcecp
Sensitivity                   : public

[3/18/94 public]

Although the onlyerror message is about "build_all" failing, since
we are cleaning up to cut a baseline and other bugs that may've
caused this error as a side effect have been fixed, I'm filing an
OT now.

Here are samples of the warnings and the error message itself:

[ /admin/dcecp/scripts at 00:52 (AM) Friday ]

cc: "/project/dce/build/dce1.1-snap/src/admin/dcecp/parseargv.c", line 250: \
  warning 530: Casting from loose to strict alignment. 

cc: "/project/dce/build/dce1.1-snap/src/admin/dcecp/rpccp.c", line 148: \
  warning 700: ANSI migration: large unsuffixed integer constants will not \
  be of type long in ANSI mode.

cc: "/project/dce/build/dce1.1-snap/src/admin/dcecp/rgy.c", line 200: warning \
  509: If clause always executed.

cc: "/project/dce/build/dce1.1-snap/src/admin/dcecp/rgy_utils.c", line 1015: \
  warning 508: Statement not reached.

cc: "/project/dce/build/dce1.1-snap/src/admin/dcecp/aud_ops.c", line 856: \
  warning 604: Pointers are not assignment-compatible.

....

/usr/shlib -L/project/dce/build/dce1.1-snap/export/hp800/usr/shlib \
 -L/usr/shlib -L/u3/devobj/sb/nb_ux/export/hp800/usr/lib \
 -L/project/dce/build/dce1.1-snap export/hp800/usr/lib   -o \
 dcecp.X main.o commands.o parseargv.o dcedcpsvc.o dcedcpmsg.o  rpccp.o \
 rgy.o rgy_utils.o  acl_tclif.o acl_edit.o aud_ops.o aud_util.o \
 audit_control_cstub.o  util_general.o util_help.o util_login.o \
 util_signal.o util_var.o cdscp.o cdscp_object.o cdscp_link.o cdscp_utils.o \
 cdscp_clearinghouse.o cdscp_cache.o cprpc_clerk_cstub.o cprpc_server_cstub.o \
 dts_ops.o dts_util.o clock.o dts_arith.o dtss_ctrl_cstub.o -lcdscache \
 -laudit -ldce -ltcl -lm  -ldbm -lM
mv dcecp.X dcecp
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.

[3/18/94 public]
These are not errors in libtcl.  Note that the messages are "warnings" not
"errors" and that dcecp was built.  I'm sure the 

   `build_all' not remade because of errors.

Is a summary message from other errors in this pass (BASIC) from other
directories and that this is a summary message printed at the end of the
pass, which is admin/dcecp/scripts.  Look for other errors in the build.

[3/18/94 public]
cancelled.  this was a summary error from the rpc errors.



CR Number                     : 10174
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa,rs6000
S/W Ref Platform              : hpux,aix
Component Name                : dcecp
Subcomponent Name             : admin/tcl_dce
Short Description             : `build_all' not remade because of errors.
Reported Date                 : 3/18/94
Found in Baseline             : 1.1
Found Date                    : 3/18/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : libtcl.a
Sensitivity                   : public

[3/18/94 public]

Since we wqant to clean up the releae and cut a baseline, and since
this error no longer seems linked to bugs that have been fixed, I am
logging it with an OT.  Aside from woarnings, the only complaint is:

[ /admin/tcl_dce ]

ar crl libtcl.a panic.o regexp.o tclAsync.o tclBasic.o tclCkalloc.o \ 
 tclCmdAH.o tclCmdIL.o tclCmdMZ.o tclEnv.o tclExpr.o tclGet.o tclGlob.o \
 tclHash.o tclHistory.o tclLink.o tclMain.o tclMtherr.o tclParse.o tclProc.o \
 tclUnixAZ.o tclUnixStr.o tclUnixUtil.o tclUtil.o tclVar.o \
rm -rf /u3/devobj/sb/nb_ux/export/hp800/usr/lib/libtcl.a
makepath /u3/devobj/sb/nb_ux/export/hp800/usr/lib/libtcl.a
(cd .; tar cfh - libtcl.a) |  (cd /u3/devobj/sb/nb_ux/export/hp800/usr/lib; \
  tar xf -)
`build_all' not remade because of errors.

The warnings are of 3 kinds, nonzero loop conditions, casting and ANSI
migration.  Examples:

cc: "/project/dce/build/dce1.1-snap/src/admin/tcl7.3/tclUnixUtil.c", line \
  1331: warning 538: While loop condition is always non-zero.

cc: "/project/dce/build/dce1.1-snap/src/admin/tcl7.3/tclUtil.c", line 1082: \
  warning 530: Casting from loose to strict alignment

cc: "/project/dce/build/dce1.1-snap/src/admin/tcl7.3/tclUtil.c", line 1336: \
  warning 700: ANSI migration: large unsuffixed integer constants will not \
  be of type long in ANSI mode.

[3/18/94 public]

Corrected "responsible engineer" assignment.

[3/18/94 public]

Added RIOS to platforms affected.

[3/18/94 public]
Note that all the "errors" are in fact "warnings" and that the tcl library
was infact built.  I bet the 

  `build_all' not remade because of errors.

line refers to other errors in the pass in previous directories.  They just
should up here as a summary since tcl_dce is last directory visited in the
EXPLIB pass.

Look for other errors that were generated.

[3/18/94 public]

Corrected "subcomponent name" field.

[3/18/94 public]

Corrected "component" field by reassigning to "dcecp".

[3/18/94 public]
cancelled.  summary error from rpc errors.



CR Number                     : 10166
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : acls
Short Description             : cell_admin overpowerful?
Reported Date                 : 3/17/94
Found in Baseline             : 1.0.3a
Found Date                    : 3/17/94
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/17/94 public]
 
The self-host cell's cell_admin has more privileges than I expected -
is this correct?
 
- directory owned by hosts/barge/self (20001) who alone has c right
- log in as cell_admin
- acl_edit and "get" access rights - only have rx
- change acl and commit successfully!
 
gmd@garlic(36) dce_login cell_admin 
Password:
gmd@garlic(3) cd ..
gmd@garlic(4) acl_edit julie
sec_acl_edit> g
Granted permissions: r-x---
sec_acl_edit> m any_other:rwxi
sec_acl_edit> commit
sec_acl_edit> exit

[3/17/94 public]
It is by design that cell_admin (well, anybody who's in the group specified
by the argument to fxd at startup) can edit any ACL on that server.
Since acl_edit doesn't know about that convention, or that special group,
it can't guess what access is to be allowed.  Looks like a feature.
Filled in Interest List CC with `cfe@transarc.com'

[4/18/94 public]
This feature is intended and documented in the admin guide (and possibly
other places).  I'd like to see the ACL reflect reality though 
there doesn't seem to be an easy way to do that.  Cancel.



CR Number                     : 10154
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : common makefiles
Short Description             : Need a way to override CPFLAGS
Reported Date                 : 3/16/94
Found in Baseline             : 1.1
Found Date                    : 3/16/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : osf.std.mk
Sensitivity                   : public

[3/16/94 public]
When building using EXPORT_USING_CP in an NFS mounted sandbox I run into
the following problems:

[ /security/audit/h ]
makepath h/. && cd h &&  exec make MAKEFILE_PASS=FIRST     build_all
h: created directory
rm -f /u2/share/sb/general/export/at386/usr/include/dce/audit.h
makepath /u2/share/sb/general/export/at386/usr/include/dce/audit.h
cp -p -r /project/dce/build/dce1.1/src/security/audit/h/audit.h
/u2/share/sb/general/export/at386/usr/include/dce/audit.h
cp: /u2/share/sb/general/export/at386/usr/include/dce/audit.h: Not owner
*** Error code 1
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.
*** Error code 1
`build_all' not remade because of errors.

This is because of the '-p'.  I would like a way to override the default
CPFLAGS.

[03/16/94 public]
DEF_CPFLAGS.  Cancelling.



CR Number                     : 10148
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditcp
Short Description             : aud show should not prompt for attribute
Reported Date                 : 3/16/94
Found in Baseline             : 1.1
Found Date                    : 3/16/94
Severity                      : D
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/16/94 public]
The 'aud show' command prompts the user for which of the two states he
would like information.  This seems overkill; why not just display both the
states at the same time?

  auditcp> aud show
  Attribute Types: state (0), stostrategy (1)
  Enter a number: 0 
  Logging service is enabled 
  auditcp> aud show
  Attribute Types: state (0), stostrategy (1)
  Enter a number: 1
  stostrategy: Stop logging when trail is full
  auditcp>

[6/9/94 public]
dcecp does not have this functionality.  Cancelled.



CR Number                     : 10145
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : auditcp
Short Description             : audtrail show should default
to default audtrail file
Reported Date                 : 3/16/94
Found in Baseline             : 1.1
Found Date                    : 3/16/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/16/94 public]
When entering the 'audtrail show' command auditcp prompts for the name of
the trail file.  If nothing is entered auditcp should assume the default
trail file (/opt/dcelocal/var/audit/adm/central_trail)

  auditcp> audtrail show
  Enter trail file name: 
  Trail file name has to be entered
  command excution failed

[6/9/94 public]
Replaced by dcecp.  Defect cancelled.



CR Number                     : 10127
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : rgy
Short Description             : principal commands returned "Registry object not found" on existing principal
Reported Date                 : 3/11/94
Found in Baseline             : 1.1
Found Date                    : 3/11/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/11/94 public]


dcecp> acl sh  /.:/sec/principal/acl_modify_005_N
{unauthenticated r-------g}
{user_obj r---f--ug}
{user cell_admin rcDnfmaug}
{group acct-admin rcDnfmaug}
{other_obj r-------g}
{any_other r--------}
dcecp> prin sh /.:/sec/principal/acl_modify_005_N
Error: Registry object not found
dcecp> prin create /.:/sec/principal/acl_modify_005_N
Error: Name already exists
dcecp> prin delete  /.:/sec/principal/acl_modify_005_N
Error: Registry object not found
dcecp> rgy_edit
Current site is: registry server at /.../ice_cell.osf.org/subsys/dce/sec/master 
rgy_edit=> do p
Domain changed to: principal
rgy_edit=> v
acl_modify_005_N                           12338
rgy_edit=> del acl_modify_005_N
Please confirm delete of name "acl_modify_005_N" [y/n]? (n) y
rgy_edit=> q

[3/11/94 public]
My mistake.  I should enter the command as follows:
dcecp> prin show acl_modify_005_N
dcecp> prin delete acl_modify_005_N

[3/11/94 public]
You should still be able to delete a principal with a path. This is needed
in the intercell case.

[3/11/94 public]
I canceled this for two reasons. In one respect it is simply a duplicate 
of OT#10033. However, the principal name
/.:/sec/principal/acl_modify_005_N
is an illegal principal name.

[3/11/94 public]
I agree with the cancel, but not quite with illegal.  If you have a
principal name called /.:/sec/principal/foo, you would modify its ACL by
the name /.:/sec/principal/sec/principal/foo.



CR Number                     : 10089
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_clientd should check for instances of itself before starting
Reported Date                 : 3/8/94
Found in Baseline             : 1.0.3
Found Date                    : 3/8/94
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/8/94 public]
As is, you can start multiple sec_clientd's on a machine.

[03/08/94 public]
For 1.1 sec_clientd will be part of the dced executable so this
becomes a "can't happen."  I think this can be cancelled.

[03/08/94 public]
Happily cancelled :-).



CR Number                     : 10028
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : binding obj (auth)
Short Description             : rpc_binding_set_auth_info returns 
sec_rgy_object_not_found instead of rpc_s_no_princ_name
Reported Date                 : 2/28/94
Found in Baseline             : 1.0.3
Found Date                    : 2/28/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/28/94 public]

From the DCE Valdiation Test Suite CR #11 (use -pdce_vts):

> [rhw 12/8/93 public]
> 
> The c_auth_info assertion #23 fails with rpc_binding_set_auth_info()
> returning sec_rgy_object_not_found instead of the expected 
> KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN or the AES-specified 
> rpc_s_no_princ_name. The latter, rpc_s_no_princ_name, is not 
> provided by the implementation.
> 
> 

The code sec_rgy_object_not_found "bubbles up" from the underlying 
security service.

Also, the code rpc_s_no_princ_name is not implemented.

[9/1/94 public]

This is happenning because of a problem in VTS code [See VTS ot#36].
So cancel this bug.



CR Number                     : 10015
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : Exceptions and statuses inconsistent?
Reported Date                 : 2/24/94
Found in Baseline             : 1.0.3a
Found Date                    : 2/24/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/24/94 public]
It seems as though there are two status codes defined in dce/rpcsts.h
that are supposed to be associated with exceptions, but the corresponding
exceptions aren't declared in dce/rpcexc.h.  They are:
 
	rpc_x_cannot_set_nodelay
	rpc_x_no_ns_privilege
 
Is this an oversight, or is there something else going on here?

[05/04/94 public]
Will, could you please take a look at this while you are doing the
serviceability work on rpc.  I know you have been working with
the rpcsts* files.

[08/22/94 public]
These exceptions are declared and initialized in
src/rpc/idl/lib/sscmaset.c. (The second one is
actually #define'd to rpc_x_no_ns_permission in
rpcpvt.h, and is declared/initted using that name.)

Not a bug.



CR Number                     : 10010
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : Lists of lists parsing problem.
Reported Date                 : 2/24/94
Found in Baseline             : 1.1
Found Date                    : 2/24/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/24/94 public]

According to Functional spec, unnecessary braces should be ignored.
This should work, but doesn't:

dcecp> dir sh /.:/jastest4
{CDS_Convergence medium}
dcecp> dir mod $n -change {{{CDS_Convergence low}}}
Error: The attribute list must contain pairs of entries {attribute value}

________________________________
This works:

dcecp> dir mod $n -change {CDS_Convergence low}
dcecp> dir sh $n
{CDS_Convergence low}

[2/24/94 public]

This will require changes to dcp_parseArgv so that extraneous braces
are stripped off. This will allow the individual command code to 
be designed to just handle significant levels of braces making
parsing much easier.

[3/19/94 public]
It was decided that mucking with the user's input was a bad idea. This CR
has been cancelled, and the function spec has been changed. Creating a list
with extra levels of braces is invalid.



CR Number                     : 9990
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dts
Subcomponent Name             : 
Short Description             : secd/cdsd/dtsd Core Dumps due to NTP change
Reported Date                 : 2/22/94
Found in Baseline             : 1.1
Found Date                    : 2/22/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/22/94 public]

Paul Ellis writes:

  Using the serviceability logs on my machine I found that dts changed
my clock backwards ~18 minutes.  I guess it would be nice if dts didn't
just take the ntp provider time without a challenge, if there is a big
difference between the local clock and local time (from ntp time prov-
ider), maybe dts should consider throwing out the ntp time.  There might
be a way to configure dts to do this, I'm not sure.  Here is the inform-
ation from my serviceability logs:

ERROR:

1994-02-20-02:45:08.778-05:00I0.962 dtsd ERROR dts events 0xa442ef38 Local clock
 was not intersecting, local time = 1994-02-20-02:45:08.778-05:00I0.962, compute
d time = 1994-02-20-02:37:20.730-05:00I0.346. It has been reset.
1994-02-20-02:55:14.067-05:00I463.069 dtsd ERROR dts events 0xa442ef38 Local clo
ck was not intersecting, local time = 1994-02-20-02:55:14.067-05:00I463.069, com
puted time = 1994-02-20-02:37:20.035-05:00I0.346. It will be adjusted.

NOTICE:

1994-02-20-02:35:02.472-05:00I0.400 dtsd NOTICE dts sync 0xa442ef38 Synchronizat
ion completed, computed time = 1994-02-20-02:35:02.428-05:00I0.346, adjustment =
 -0-00:00:00.044I0.000
1994-02-20-02:45:08.818-05:00I468.404 dtsd NOTICE dts sync 0xa442ef38 Synchroniz
ation completed, computed time = 1994-02-20-02:37:20.730-05:00I0.346, adjustment
 = -0-00:07:48.048I0.000
1994-02-20-02:37:20.035-05:00I0.356 dtsd NOTICE dts sync 0xa442ef38 Synchronizat
ion completed, computed time = 1994-02-20-02:37:20.035-05:00I0.346, adjustment =
 -0-00:17:54.033I0.000
1994-02-20-02:37:20.035-05:00I0.356 dtsd NOTICE dts events 0xa442ef38 Clock was
set, old time = 1994-02-20-02:55:14.067-05:00I463.069, new time = 1994-02-20-02:
37:20.035-05:00I0.346

[02/22/94 public]

Tom Jordahl writes:

pellis@osf.org writes:
> 
> 
> Jeff,
>   Using the serviceability logs on my machine I found that dts changed
> my clock backwards ~18 minutes.  I guess it would be nice if dts didn't
> just take the ntp provider time without a challenge, if there is a big
> difference between the local clock and local time (from ntp time prov-
> ider), maybe dts should consider throwing out the ntp time.  There might
> be a way to configure dts to do this, I'm not sure.  Here is the inform-
> ation from my serviceability logs:

The concept behind a Time Provider is that is it is an acurrate source
of time.  Its NTP that is the problem here.

Also note that the other servers in the cell probably didn't
think the time provider node had the correct time and ignored
it.  (server time would not intersect computed time).

[02/22/94 public]

Paul Ellis writes:

>  
>  The concept behind a Time Provider is that is it is an acurrate source
>  of time.  Its NTP that is the problem here.
>  

You're right, the dts_ntp_provider was just passing the time along to
dtsd.  Couldn't dtsd throw out a bogus NTP time and let the local server
just sync with the other local servers in the cell?

>
>  Also note that the other servers in the cell probably didn't
>  think the time provider node had the correct time and ignored
>  it.  (server time would not intersect computed time).
>  

Actually, the whole cell stopped because once the clock was set backwards
on tahiti, which was running dts_ntp_provider, secd, cdsd and dtsd all dumped
core.  I guess what I have learned is that I should only configure the
dts_ntp_provider on a security and cds client only machine running as a
local server, that way the whole cell won't stop if the NTP server screws
the time up.

[07/19/94]

After discussion with Tom Jordahl, I've decided to cancel this bug.
The Time Provider is seen as providing an accurate source of time to
the dtsd running on that machine, and should be believed.



CR Number                     : 9988
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa,rs6000
S/W Ref Platform              : hpux,aix
Component Name                : dcecp
Subcomponent Name             : admin/dcecp/scripts
Short Description             : function call argument cannot
be assigned to corrsponding parameter.
Reported Date                 : 2/22/94
Found in Baseline             : 1.1
Found Date                    : 2/22/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : audit_control_cstub.c,dtss_ctrl_cstub.c
Sensitivity                   : public

[2/22/94 public]

Are these errors related to OT 9987 (bug in rpc/idl/klib)?

Complaint in "admin/dcecp/scripts" is:

	Function call argument cannot be assigned to corresponding parameter.

[2/22/94 public]
Huh?  Can you cut and paste the log.  There is nothing in this directory
that gets built aside from one file and it is a script that just gets
copied to the obj tree and then installed.  Here is the whole Makefile:

   IDIR            = /dcecp/
   
   SCRIPTS         = attr_eval.tcl
   
   ILIST           = ${SCRIPTS}
   
   .include <${RULES_MK}>

Was a build done with NPROC > 1?  That would explain an error showing up in
an unrelated place in the build log.

[2/22/94 public]
Cancelled.  This was just a summary error due to a failure when building
libidl.  libtcl just happens to be the last library built in this pass, so
the summary error looks like it failed in this library.  But there are no
errors in libtcl and it built fine on both HP and RIOS.



CR Number                     : 9982
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : rgy_edit exits with a FAULT
when the -ul flag is used on a cell command
Reported Date                 : 2/18/94
Found in Baseline             : 1.0.3
Found Date                    : 2/18/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[2/18/94 public]
Trying a ``cell'' command with a -ul flag causes rgy_edit to exit with

FAULT 0x17083003 at line 8439 of file
../../../../../../src/security/client/admin/rgy_edit/ek_db.c

None of the other documented flags seems to cause problems.

The problem seems to be caused by a bad initialization of the operations
table (?). The symptom is that the following code in ek_do_op() in
security/client/admin/rgy_edit/ek_db.c:

    for (cur_field = 0; cur_field < num_fields; cur_field++) {

        form_field_attributes(op->op_form, cur_field, &attributes);

        form_field_status(op->op_form, cur_field, &field_status);

        if ((attributes & attribute_required_mask) &&
            (field_status != form_field_valid_data))
            SET_STATUS(&st, ek_required_field);
    }

sets the status to ek_required_field when cur_field = 1, because the
field_status was set to form_field_no_data in the form_field_status()
call.

Related CRs are 7823, 729, 688 and 633.

[7/28/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.



CR Number                     : 9977
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9906, 9961
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : common makefiles
Short Description             : gratuitous ar invocations
Reported Date                 : 2/18/94
Found in Baseline             : 1.1
Found Date                    : 2/18/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/18/94 public]
For some reason, on the HP 'ar' is invoked even when the library has
already been built.  Also, libraries are being built in the BASIC pass. 

prague audit/libaudit$ build
relative path: ./security/audit/libaudit
cd ../../../../obj/hp800/security/audit/libaudit
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
ar crl libaudit.a audit_update_sstub.o audit_pickle_cstub.o
audit_log_cstub.o esl_in_core.o esl_file_read.o esl_sync.o evt_classes.o
trl_ops.o evt_write.o evt_read.o evt_filter.o evt_utils.o
rm -rf /u2/share/sb/commaud/export/hp800/usr/lib/libaudit.a
makepath /u2/share/sb/commaud/export/hp800/usr/lib/libaudit.a
(cd .; tar cfh - libaudit.a) |  (cd
/u2/share/sb/commaud/export/hp800/usr/lib; tar xf -)
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
ar crl libaudit.a audit_update_sstub.o audit_pickle_cstub.o
audit_log_cstub.o esl_in_core.o esl_file_read.o esl_sync.o evt_classes.o
trl_ops.o evt_write.o evt_read.o evt_filter.o evt_utils.o
prague audit/libaudit$ build
relative path: ./security/audit/libaudit
cd ../../../../obj/hp800/security/audit/libaudit
exec make MAKEFILE_PASS=AUTOGEN  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
ar crl libaudit.a audit_update_sstub.o audit_pickle_cstub.o
audit_log_cstub.o esl_in_core.o esl_file_read.o esl_sync.o evt_classes.o
trl_ops.o evt_write.o evt_read.o evt_filter.o evt_utils.o
rm -rf /u2/share/sb/commaud/export/hp800/usr/lib/libaudit.a
makepath /u2/share/sb/commaud/export/hp800/usr/lib/libaudit.a
(cd .; tar cfh - libaudit.a) |  (cd
/u2/share/sb/commaud/export/hp800/usr/lib; tar xf -)
exec make MAKEFILE_PASS=BASIC  _SUBMAKE_=_IS_SUBMAKE_  build_all
ar crl libaudit.a audit_update_sstub.o audit_pickle_cstub.o
audit_log_cstub.o esl_in_core.o esl_file_read.o esl_sync.o evt_classes.o
trl_ops.o evt_write.o evt_read.o evt_filter.o evt_utils.o

[2/6/96 public]

Since HP's build env is little different its hard to confirm or reject
the claim. However, looking at my HP build logs (clearcase+ODE combination)
I did not find such multiple instance of ar'ing of the same library. So
closing.

[2/8/96 public]
Since there is no proff of fix and also the plaforms and environment has 
changed, marking this OT cancelled.



CR Number                     : 9963
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit -update -s
Short Description             : rgy_edit -update ignored when using -s
Reported Date                 : 2/16/94
Found in Baseline             : 1.1
Found Date                    : 2/16/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[2/16/94 public]

The -update option on rgy_edit is ignored when used in conjunction with the
-s option:

root@west> rgy_edit -update -s /.../west_cell.qadce.osf.org
Current site is: registry server at /.../west_cell.qadce.osf.org/subsys/dce/sec/tahiti   (read-only)

A workaround is to use the fully qualified name of the registry when using the
-s option and to omit -update:

root@west> rgy_edit -s /.../west_cell.qadce.osf.org/subsys/dce/sec/master
Current site is: registry server at /.../west_cell.qadce.osf.org/subsys/dce/sec/master

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 9950
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : 
Short Description             : Error messages need cleanup
Reported Date                 : 2/14/94
Found in Baseline             : 1.1
Found Date                    : 2/14/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/14/94 public]

There are a number of problems with the dcp.sams file messages.  In some
cases the errors require further elaboration.  In other cases, sml coding
needs to be added in the explanation and action fields.  A complete list of
the suggested changes has been given to Howard Melman.

[3/9/94 public]
Will be addressed with individual CR's for each area:

   acl: CR 10111
   dts: CR 10112
   cds: CR 10113
   rgy: CR 10114



CR Number                     : 9936
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : non POSIX constants in lseek call
Reported Date                 : 2/10/94
Found in Baseline             : 1.0.3
Found Date                    : 2/10/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : src/rpc/runtime/uuid_15.c
Sensitivity                   : public

[2/10/94 public]

 The file .../src/rpc/runtime/uuid_15.c contains an lseek() call which
uses the symbolic value L_SET as its third parameter. L_SET is non-POSIX
compliant and should be replaced with SEEK_SET to facilitate porting. 
 Similar problems exist in other files; in fact, a quick examination seems
to show that the majority of lseek() calls use a numeric constant as the
third argument.

[02/10/94 public]
Note that uuid_15 (indeed, all the NCS1.5 code) is due to move to the
nosupport tree for dce1.1.  If you have places in other parts of the
rpc runtime that should be fixed, please list them, otherwise this CR
should be cancelled.

[05/04/94 public]
There is no support for the NCS 1.5 code in 1.1
Canceled.



CR Number                     : 9930
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : IDL files
Short Description             : Need fault_status comm_status
Reported Date                 : 2/10/94
Found in Baseline             : 1.1
Found Date                    : 2/10/94
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/10/94 public]
All IDL files that are part of libdce should be compiled with ACF files
that have the [fault_status,comm_status] attributes.  Without this, a
failing RPC could cause client code to core dump when there is a perfectly
good error_status_t parameter available.  When adding the ACF files, it is
important to make sure that no API changes.  As most routines probably
already have an "error_status_t *st" parameter this will probably not be
an issue; routines that don't will have to be handled on a case-by-case,
probably by adding a new routine that DOES have the status param and
changing our existing code to call that routine.

[02/18/94 public]
dced already has the ACF files; cancelling.



CR Number                     : 9921
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : ??
Short Description             : rios server dies during CHO
Reported Date                 : 2/9/94
Found in Baseline             : 1.1b3
Found Date                    : 2/9/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/9/94 public]


This is 1.1b3 which consists of the 1.0.3a dfs which is known
to work and the 1.1 core.  During CHO testing, after 
4 hours 20 min, the RIOS DFS crashed.  There seem to be
a number of zero'd out stacks in the crash dump, but
other than that we don't know much about it.

> proc -r
SLT ST    PID   PPID   PGRP   UID  EUID  PRI   CPU   EVENT  NAME
  2 r      202     0     0     0     0   127   120          wait
        FLAGS: swapped_in no_swap fixed_pri kproc
 14 r      eff     1   eff     0     0    60     0          errdemon
        FLAGS: swapped_in wake/sig locks
 52 r     3423  3116  3116     0     0    66    12          cdsclerk
        FLAGS: swapped_in locks
 64 r     4075     1  4075     0     0    66    12          dfsbind
        FLAGS: swapped_in locks
 67 r     437f  3f77  3025     0     0    69    18          thr"
        FLAGS: swapped_in kproc
 69 r     4581  3f77  3025     0     0    79    39          thr&
        FLAGS: swapped_in kproc
 70 r     4682  3f77  3025     0     0    68    17
        FLAGS: swapped_in kproc
 71 r     4783  3f77  3025     0     0    66    13
        FLAGS: swapped_in kproc
 72 r     4884  3f77  3025     0     0    66    12
        FLAGS: swapped_in kproc
 97 r     619f  5f73  4f63     0     0    66    12          sh
        FLAGS: swapped_in


> trace
STACK TRACE:
        00000000

>> trace 64
STACK TRACE:
        .unlockl ()
        .vm_move ()
        .readi ()
        .xix_rdwr ()
        .vno_rw ()
        .rwuio ()
        .rdwr ()
        .kreadv ()

>> trace 67
STACK TRACE:
        .e_wait ()
Frame pointer not valid.
> trace 69
STACK TRACE:
        .e_wait ()
Frame pointer not valid.
> trace 72
STACK TRACE:
        00000000

> trace 71
STACK TRACE:
        00000000

> trace 70
STACK TRACE:
        00000000

>


I'm leaving the component as 'unknown' since we don't know where
the problem is yet.

[2/24/94 public]

Of course, this happens once, but never again.  Dropping the
priority to 2, and I'm going to assume this is a dfs problem,
since I haven't seen any core problems with bl3

[03/18/94 public]

Gail is now Queen of CHO, so she's going to
veryify whether this is still a problem.

[05/03/94 public]
Haven't seen this problem yet - I only have 1 RIOS to work
with so this further reduces the chances of seeing it ...
Leaving open while working on CHO test definition.

[06/06/94 public]
Cancelling - not seen again. CHO for 1.1 has been defined to
be a less i/o stressful set of tests (low/moderate removed) but
with scheduled replication testing added (dfs.repfs). The 
dfs.read_write_all.main test is being used for i/o stress CHO
testing. Neither CHO nor dfs.read_write_all.main are crashing the
RIOS.



CR Number                     : 9901
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cfg
Short Description             : cds always defines a cached server during a split server config
Reported Date                 : 2/7/94
Found in Baseline             : 1.1
Found Date                    : 2/7/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/7/94 public]

When the CDS server resides on a separate host from the 
security server, dce_config will define a cached server
for all of the CDS clients in that cell, even if all the
same machines are on the same lan.

[8/24/94 public]
This does not belong in the config component, so I am reassigning
this to John so he can verify that this is still a problem
or close as being fixed.

[8/24/94 public]
No longer a problem. Canceled.



CR Number                     : 9899
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : dce_config continues even when
Reported Date                 : 2/7/94
Found in Baseline             : 1.1
Found Date                    : 2/7/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/7/94 public]

This is today's build.  Configuration is:

  RIOS - Security Server
  HPUX - Cds server

When trying to perform the client cds configuration on the RIOS
machine, the cdscp define cached server command fails with the
following message:


        Are you using multiple LAN's within this cell? (n) n
./dce_config: 7356 Killed
./dce_config: 7375 Killed
./dce_config: 7393 Killed
./dce_config: 7417 Killed
./dce_config: 7180 Killed
S:****** singsing cdsadv daemon has not received any responses to its broadcast
for CDS servers.  Executing a "cdscp define cached server" command...
ERROR:   cdscp error during "define cached server" command.
  Message from cdscp:
  Failure in routine: cprpc_get_binding_handle
DCE text not found, dce code = 382312699, dce status = -1
Failure in routine: cp_define_cached_server
DCE text not found, dce code = 382312699, dce status = -1
        Press <RETURN> to continue, CTRL-C to exit:

Now don't ask me why dce_config wants to define a cached server here,
because all of the machines are on the same LAN, this is simply a
split server configuration - and at any rate it does not work.

[2/7/93 public]

This turned out to be the stupid message catalog problem.
Dce_config will continue anyway, even if cdsadv exits
(which happened to scroll off of my screen so I didn't notice
what happened).

It would appear to me that the client can't find the CDS server.  (obviously?)

The reason dce_config does a 'cdscp defind cached server" is that the cdsadv
could not find the cdsd with it's broadcast, so it tries to define it so
the advertiser can access the server.  This is what would happen if you were
running on a ncacn_ip_tcp only network (cause tcp does not support broadcasts).  
A


A place to start poking around may be the new EPAC code in RPC.  When I free
up three RIOS machines I'll try this here in Austin.

I've tried this on three RIOS machines here in Austin and all is 
OK.



CR Number                     : 9891
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dcecp
Subcomponent Name             : tcl_dce
Short Description             : dcecp does not understand
command abbreviations on the rios.
Reported Date                 : 2/4/94
Found in Baseline             : 1.1
Found Date                    : 2/4/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/4/94 public]

On the RIOS, command abbreviations are not not understood.

dcecp> dir list /.:
Error: invalid command name: "dir"
dcecp> directory list /.:
/.:/hosts /.:/subsys /.:/cell-profile /.:/fs /.:/lan-profile /.:/sec
/.:/sec-v1 /.:/sif_ch

This is most likely a problem in tcl. I'm looking into it.

[2/4/94 public]

This problem was caused by tcl not being installed on mudslide. The unknown
proc is the one that allows command abbreviations. The unknown proc is
found in the init.tcl file, which was not installed.



CR Number                     : 9867
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : src/config
Short Description             : cell installation fails on AT486
Reported Date                 : 2/1/94
Found in Baseline             : 1.1
Found Date                    : 2/1/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/1/94 public]

During security server installation of a core DCE cell on the AT486 sif.osf.org
for smoketesting of the nightly build, "/sbin/lib_admin" claims it failed
to install library "libNDS.so" even when I manually install it just before
it's needed.  I've also altered "/etc/lib_admin.conf" in case there were
typos breaking its stringent format requirements.  All to no avail.  The
same error messages display no matter what I try:

S:****** Successfully removed all remnants of previous DCE installations
for all components.
                installing sec_create_db sec_salvage_db secd ...
                installing rpcd cdsadv cdsclerk dtsd sec_clientd...
                installing dts_null_provider dts_ntp_provider...
                installing rpccp uuidgen cdscp getcellname getip...
                installing acl_edit dce_login rgy_edit dtscp...
                installing sec_admin passwd_import passwd_export...
                installing kinit klist kdestroy...
                copying libdce.so to /usr/shlib...
                installing libdce.so...
                Run /sbin/lib_admin? (y)  y
error installing library: No such file or directory
installing library /usr/shlib/libNDS.so
ERROR:   /sbin/lib_admin /etc/lib_admin.conf failed

Thus when cell installation and configuration finishes, and the smoketest
proper runs, it fails completely.

[02/01/94 public]
The /etc/lib_admin.conf file had an entry for /opt/dcelocal/shlib/libNDS.so.
There was not a libNDS.so in /opt/dcelocal/shlib.

If you install GDS on a machine, it will put this entry in to lib_admin.conf.
If you then re-install this machine, you will get an error like the above.
The libdce will not be installed, and everything will fail.

This is a known problem with GDS install, and I believe there should
already be a GDS config defect on it.

I have removed the offending entry on sif.

Canceling this bug.



CR Number                     : 9863
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dcecp
Subcomponent Name             : cdscp
Short Description             : cdscp.c needs "dce/" prefix
for dnsclerk.h, dnsmessage.h and cprpc.h .
Reported Date                 : 1/31/94
Found in Baseline             : 1.1
Found Date                    : 1/31/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/31/94 public]

In order to get dcecp to build in the nightly build, cdscp.c must be
changed to reference dnsmessage.h, dnsclerk.h and cprpc.h with a "/dce"
prepended to them.

[2/3/94 public]

This turns out not to be required to get dcecp to build. Cancelled.



CR Number                     : 9861
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : rpc
Subcomponent Name             : 
Short Description             : IDL generated stubs assume 32 bit alignment of data structure.
Reported Date                 : 1/31/94
Found in Baseline             : 1.0.3
Found Date                    : 1/31/94
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/31/94 public]

----- begin licensee report -----
Full Description:

        The v1.0.3 IDL compiler generates stubs containing a data
        structure called 'IDL_type_vec'. This data structure is
        accessed using macros provided in the idlddefs.h file.
        These macros:
            IDL_GET_LONG_FROM_VECTOR
            IDL_DISCARD_LONG_FROM_VECTOR
            IDL_ALIGN_POINTER_TO_LONG
        perform bit arithmetic on the address they are given. The
        arithmetic is supposed to align the address on a 32 bit
        boundary within the data structure (to skip filler bytes
        within the structure). However, the arithmetic is done on
        the absolute address and so is dependent on the beginning
        of the data structure being aligned to a 32 bit boundary.
        Many vendors machines (and their C compilers) cannot
        guarantee this alignment which means that they cannot use
        the v1.0.3 IDL compiler.

Proposed Solution:

        The macros in idlddefs.h should perform their arithmetic on
        the offset of the address from the start of the IDL_type_vec
        data structure (and NOT on the absolute address).

        A temporary workaround is to revert to using the v1.0.2
        IDL compiler. However, there have been many defect fixes
        which have only been made in the v1.0.3 compiler (and
        its associated IDL library changes).

        It may be that this problem can be fixed just by changing
        the IDL library. However, it may require changes to
        the IDL generated stubs and the IDL library interfaces
        they invoke. This could cause serious maintenance and
        compatibility problems between v1.0.3 DCE products and
        future releases, unless this problem is fixed quickly
        and an update delivered to all v1.0.3 licensees.
----- end licensee report -----

Note, for example, the following code fragment from idl/lib/interpsh.c:

        case IDL_DT_VARYING_ARRAY:
            defn_vec_ptr += 2;      /* After properties byte */
            IDL_DISCARD_LONG_FROM_VECTOR(defn_vec_ptr);
            /* Ignore the full array definition and look at the flattened
one */
            IDL_GET_LONG_FROM_VECTOR(array_defn_index, defn_vec_ptr);
            array_defn_ptr = IDL_msp->IDL_type_vec + array_defn_index;
            dimensionality = (idl_ulong_int)*array_defn_ptr;
            array_defn_ptr++;
            array_element_count = 1;
            for (i=0; i<dimensionality; i++)
            {
                IDL_GET_LONG_FROM_VECTOR(lower_bound, array_defn_ptr);
                IDL_GET_LONG_FROM_VECTOR(upper_bound, array_defn_ptr);
                array_element_count *= (upper_bound - lower_bound + 1);
            }

The macro calls:

                IDL_GET_LONG_FROM_VECTOR(lower_bound, array_defn_ptr);
                IDL_GET_LONG_FROM_VECTOR(upper_bound, array_defn_ptr);

are aligning the "global address" (i.e. not an offset in IDL_vec_type) on a
32 bit boundary which, if IDL_vec_type is NOT aligned on a 32 bit boundary,
may not correspond to the right address within IDL_type_vec because it
is then not on a 32 bit offset boundary within IDL_vec_type.

As stated in the licensee report, this problem is critical on those
platforms which do not happen to align IDL_vec_type on a 32 bit boundary.

[2/3/94 public]

Here is the licensee response to Rico's initial suggestions (along
with the text of those suggestions):

----- begin licensee report -----
   Unfortunately, neither of the two suggested solutions work for our
architecture. Ideally, the solution should only rely on the presence of
an ANSI C compiler which would ensure its portability across all platforms.
     Cheers,
        Alan

------------   ORIGINAL ATTACHMENT   --------
SENT 02-02-94 FROM SMTPGATE (levy@osf.org)


------- Forwarded Message

Here is the developer response to the change request I filed:

- -----
We've discussed several possible fixes to this problem - I'll describe the
two simplest ones and hopefully one of those suffice.

 1) The simplest fix would be if the C compiler(s) on the failing platform
    support a pragma or language extension to specify alignment of a data
    structure.  For example, VAX C on OpenVMS has this.  Then the IDL
    compiler could emit conditional preprocessor logic into the stub.

 2) The next simplest fix would be to change the base type of IDL_type_vec
    to be a union of an array of bytes and a single long.  You could test
    the feasibility of this by munging an emitted stub slightly as follows:

     a) Add a new type declaration:

        typedef union {
            idl_byte type_vec[ <size-of-current-type-vector> ];
            idl_ulong_int align;
        } IDL_type_vec_t;

     b) Change the first line of the type vector definition from:

        static idl_byte IDL_type_vec[] = {

        to

        static IDL_type_vec_t IDL_type_vec = {

     c) If the stub references IDL_type_vec, change to
IDL_type_vec.type_vec

     d) Compile-link-run to validate correctness.

    If this works, let us know and we'll make the fixes in the IDL compiler
    and submit them.  I've tried this on DEC AXP OSF/1 and it works there.
----- end licensee report -----

[2/4/94 public]

Are you sure that your C compiler contains no way to specify alignment?
I just want to double check on that one, because that would be an
obvious and easy fix.  The platform that I'm guessing is most similar to
yours is VAX VMS - the VAX does not require natural alignment, and in
general anything can be allocated on any boundary.  But the VAX C
compiler provides both an '__align(size)' language extension and a
'#pragma member_alignment' pragma to control alignment.  I would expect
any C compiler on a "packed" platform to provide something like this.

I would like to pursue the possibility of a simple fix some more before
we go changing the macros (or pursuing a couple other possibilities we've
thought of).

 1) If your C compiler does not support any alignment, can you think of
    any trick which could be used to force alignment?  I haven't come up
    with anything yet, but suspect there might be some sort of hack.

 2) I hacked a simple stub by removing all the code, leavining in the
    declarations, and sticking in this little main program:

int main()
{
    printf("&IDL_transfer_syntaxes = %p\n", IDL_transfer_syntaxes);
    printf("sizeof(IDL_transfer_syntaxes) = %p\n",
sizeof(IDL_transfer_syntaxes)
);
    printf("&IDL_ifspec = %p\n", &IDL_ifspec);
    printf("sizeof(IDL_ifspec) = %p\n", sizeof(IDL_ifspec));
    printf("&test_v0_0_c_ifspec = %p\n", &test_v0_0_c_ifspec);
    printf("sizeof(test_v0_0_c_ifspec) = %p\n",
sizeof(test_v0_0_c_ifspec));
    printf("&IDL_offset_vec = %p\n", IDL_offset_vec);
    printf("sizeof(IDL_offset_vec) = %p\n", sizeof(IDL_offset_vec));
    printf("&IDL_rtn_vec = %p\n", IDL_rtn_vec);
    printf("sizeof(IDL_rtn_vec) = %p\n", sizeof(IDL_rtn_vec));
    printf("&IDL_type_vec = %p\n", IDL_type_vec);
    printf("sizeof(IDL_type_vec) = %p\n", sizeof(IDL_type_vec));
}

    The output I got from this, on VAX VMS, was this:

&IDL_transfer_syntaxes = 1094
sizeof(IDL_transfer_syntaxes) = 14
&IDL_ifspec = 10a8
sizeof(IDL_ifspec) = 32
&test_v0_0_c_ifspec = 1ed8
sizeof(test_v0_0_c_ifspec) = 4
&IDL_offset_vec = 10dc
sizeof(IDL_offset_vec) = 8
&IDL_rtn_vec = 10e4
sizeof(IDL_rtn_vec) = 8
&IDL_type_vec = 10ec
sizeof(IDL_type_vec) = 79

    Note that the collective size of the data leading up to IDL_type_vec
    is (2 mod 4), not (0 mod 4).  If we could assume (I have no idea if
    we can, but it's worth a check) that a particular module's contribution
    to an executable starts on a (0 mod 4) boundary, then we could
    possibly just stick in the correct number of filler bytes (2 in the
    above case) to make IDL_type_vec start on a (0 mod 4) boundary.

Rico

[2/8/94 public]

Unfortunately here is what the licensee reports:

----- begin licensee report -----
   Our C compiler does not support any way to specify alignment. It
does guarantee that the IDL_type_vec structure will be aligned on a 16
bit boundary. Our binder/linker can also only guarantee 16 bit
alignment of a particular modules global data.
----- end licensee report -----

[2/10/94 public]

As you know, we are only obligated to fix bugs/do enhancements on the
reference platforms.  This really is a porting issue.  I suggest we
proceed as follows: I'll make a couple of high-level suggestions as to
how this problem could be fixed.  You pick the one you prefer.  I give
you further technical detail on how to implement it.  You implement it.

Here are my suggestions:

 1) Modify the IDL_GET_LONG_FROM_VECTOR and related macros to take the
    original type vector alignment modulo 4 into account.  There may be
    a couple of other code sites that need to be modified as well.
    The original type vector alignment needs to be stored somewhere,
    probably in the marshalling state block.  There is a way to make this
    change compatibly, but we'll have to be careful.

 2) Under the existing Threads "once" logic (logic that gets executed
    exactly once per stub module), malloc space for the type vector,
    plus some extra to guarantee alignment, and copy the statically
    initialized type vector to the new storage.  This requires mods to
    the IDL compiler to emit an extra pointer cell and to specify it
    in place of the normal type vector address.

Incidentally, are your platforms big-endian or little-endian?

[2/18/94 public]

----- begin licensee report -----
It would appear that the first suggested solution would be the best because
it does not require any changes to the idl compiler ie. our implementation
of DCE could continue to use C stubs generated by any idl compiler.

Having investigated where the macros are called I have discovered
the following routines which do NOT have access to the marshalling
state block:
     rpc_ss_arm_switch_value ()       in interpsh.c prototyped in
idlddefs.h
     rpc_ss_find_union_arm_defn ()    in interpsh.c prototyped in
idlddefs.h
     rpc_ss_discard_allocate_ref ()   in ndrmi.c    prototyped in ndrmi.h
However all these routines are called from places where the IDL_msp is
available so it should be possible just to add this as an extra argument
to these functions.

So given that this solution may be possible I have the following questions:

1) Are these macros ALWAYS called with an absolute address, or are they
   sometimes called with an address which is a relative offset from a
   previously calculated 4 byte aligned boundary within the data structure?

2) You mentioned that "there may be a couple of other code sites that
   need to be modified as well". Can you indicate where?

3) Is there any possibility that the fix (we implement) will be integrated
   into the OSF source code?

4) Are you only unwilling to fix this problem in 1.0.3? Will you fix it
   in the 1.1 source code, which may have a wider audience than 1.0.3?

FYI, our platform is big-endian.

Thanks for your help,
----- end licensee report -----

[3/4/94 public]

Sorry about the delay in responding but things have been quite hectic.
The following set of source changes have been tested on VAX VMS which is a
little endian platform which by default "packs" data structures.  To
adequately test it I also munged the IDL compiler (not included in changes)
to emit filler byte(s) before the IDL_type_vec declaration, which forced
IDL_type_vec to be unaligned.  I realize that your platforms are big-endian
but I made the same changes in both little- and big-endian codepaths where
applicable.

I ran a complete test suite against the changes, with no observed problems,
so I have a fairly high degree of confidence that the changes really work.
Below are diff's for all the files that changed.

As to your questions:

 1) The macros are always called with an absolute address.

 2) I think I was incorrect when I said there may be additional code sites
    needing change.  I was anticipating that some 'ifdef little-endian'
    code that points directly into the data structure would no longer be
    able to do so.  Running the test suite on VAX VMS seems to have
disproved
    that, and as I think of it, as long as the platform provides unaligned
    accesses there should be no problem.

 3) OSF will have to answer as to whether the fix can be integrated into
the
    OSF source code.  At one level, the fix can be viewed as a porting
issue.
    To my knowledge, Tandem is the only licensee that has observed this
    problem.

 4) Depends on the decision for 3).

Regards,
Rico Annicchiarico
DEC/Nashua NH - IDL Project Leader


**** idlddefs.h ****


+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 307  
      1)    idl_byte *_s = (idl_byte*)(((address-(idl_byte *)0)+3) & (~3));
\

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 307  
      2)    idl_byte *_s = (idl_byte*)((((address-(idl_byte
*)0)+3-((IDL_msp->ID
L_type_vec-(idl_byte *)0)%4)) & (~3)) + ((IDL_msp->IDL_type_vec-(idl_byte
*)0)%4
)); \
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 312  
      1){   address = (idl_byte *)(((address-(idl_byte *)0)+3) & (~3)); \

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 312  
      2){   address = (idl_byte *)((((address-(idl_byte
*)0)+3-((IDL_msp->IDL_ty
pe_vec-(idl_byte *)0)%4)) & (~3)) + ((IDL_msp->IDL_type_vec-(idl_byte
*)0)%4)); 
\
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 319  
      1){   address = (idl_byte *)(((address-(idl_byte *)0)+3) & (~3)); \

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 319  
      2){   address = (idl_byte *)((((address-(idl_byte
*)0)+3-((IDL_msp->IDL_ty
pe_vec-(idl_byte *)0)%4)) & (~3)) + ((IDL_msp->IDL_type_vec-(idl_byte
*)0)%4)); 
\
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 380  
      1)    address = (idl_byte *)(((address-(idl_byte *)0)+3) & (~3));

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 380  
      2)    address = (idl_byte *)((((address-(idl_byte
*)0)+3-((IDL_msp->IDL_ty
pe_vec-(idl_byte *)0)%4)) & (~3)) + ((IDL_msp->IDL_type_vec-(idl_byte
*)0)%4));
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 428  
      1)    idl_long_int index

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 428  
      2)    idl_long_int index,
      2)    IDL_msp_t IDL_msp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 431  
      1)    rpc_ss_arm_switch_value(defn_vec_ptr, index)

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 432  
      2)    rpc_ss_arm_switch_value(defn_vec_ptr, index, IDL_msp)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 670  
      1)    idl_byte **p_arm_type_ptr

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 671  
      2)    idl_byte **p_arm_type_ptr,
      2)    IDL_msp_t IDL_msp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element IDLDDEFS.H(92) Line 770  
      1)    idl_long_int index

File RPC$:[RICO.RPC.BLD.MAIN.SYSIDL.SRC]IDLDDEFS.H;6 Line 772  
      2)    idl_long_int index,
      2)    IDL_msp_t IDL_msp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



**** interpsh.c ****

+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element INTERPSH.C(57) Line 1069 
      1)    /* [out] */ idl_byte **p_arm_type_ptr

File RPC$:[RICO.RPC.BLD.MAIN.LIBIDL.SRC]INTERPSH.C;2 Line 1069 
      2)    /* [out] */ idl_byte **p_arm_type_ptr,
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

File RPC$:[RICO.RPC.BLD.MAIN.LIBIDL.SRC]INTERPSH.C;2 Line 1071 
      2)    IDL_msp_t IDL_msp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element INTERPSH.C(57) Line 1073 
      1)( defn_vec_ptr, arm_count, switch_value, p_arm_type_ptr )

File RPC$:[RICO.RPC.BLD.MAIN.LIBIDL.SRC]INTERPSH.C;2 Line 1074 
      2)( defn_vec_ptr, arm_count, switch_value, p_arm_type_ptr, IDL_msp )
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

F-DL.SRC]INTERPSH.C;2 Line 1535 
      2)    /* [in] */ idl_long_int index,          /* Index of union arm
desc *
/
      2)    IDL_msp_t IDL_msp
- - - - - - - - - - - - - - - - - - - + + + + + + + + + + + + + + + + + + +
+ + + + *p_type_vec_ptr,
- - - _tN.LN.LIBID


+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +
                  rpc_ssent NDRMI.H(26) Line 205 -(37) Line 229  
     &arm_typ
e_ptr) )

Fi+ + ype_ptr, IDL_msp) )
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element NDRUI3.C(44) Line 367  
      1)                                                                &a
   &arm_type_ptr, ID - - - - - - - - - - - - - - - - - - - - - - - - - - -
- - - - - - - - 


**** ndrmi5.c ****


+ + + + + + + + + + +e_ref(&type_vec_ptr);

File RPC$:[RICO.RPC.BLD.MAIN.LIBIDL.SRC]NDRMI5.C;2 Line 822  
      2)                    rpc_ss_discard_allocate_ref(&type_vec_ptr,
IDL_msp);
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



**** ndrui5.c ****


+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +

Element NDRUI5.C(4) Line 603  
      1)                    rpc_ss_discard_allocate_ref(&type_vec_ptr);

File RPC$:[RICO.RPC.BLD.MAIN.LIBIDL.SRC]NDRUI5.C;2 Line 603  
      2)                    rpc_ss_discard_allocate_ref(&type_vec_ptr,
IDL_msp);
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

[03/29/94 public]
Lowering this to a C3, since we feel this is a porting issue and
may not be appropriate for the OSF source base.

[8/17/94 public]
If the vendor is satisfied with the porting changes Rico has given
them, I would like to cancel this defect.

We can look in to adding these changes to the OSF source base if
anyone feels there is sufficient benifit.

[8/23/94 public]
No interest was expressed, so we will chalk this up to a porting
specific problem and cancel this defect.
I assume system engineering will keep this on file in the unlikely
event someone else encounters this problem.



CR Number                     : 9852
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit kill cmd for groups & orgs
Reported Date                 : 1/28/94
Found in Baseline             : 1.1
Found Date                    : 1/28/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/28/94 public]

BACKGROUND:
The acl_edit kill command removes all sec_acl_entries other than the
USER_OBJ entry. This is ok for principals but what about groups and
organizations.  Currently, in acl_edit the following msg is displayed
"ERROR: bad acl syntax" if a kill cmd is issued on a group or 
organization since all the entries are removed.

NEW FUNCTIONALITY?:
For principals, we can remove all sec_acl_entries other than the
USER_OBJ entry. For organizations, we can remove all sec_acl_entries 
For groups, we can remove all sec_acl_entries other than the
GROUP_OBJ entry. For organizations, we can remove all sec_acl_entries 
other than the OTHER_OBJ entry. 
Even though we don't know if the ACL object is a principal, group, or 
organization, acl_edit can check if the user_obj exists, save it, 
otherwise if the group_obj exists save it and or if the other_obj exists 
save it.

What do you think? Maybe for dcecp this would be a good thing.

[1/31/94 public]
This is a RGY specific problem and acl_edit is supposed to be a generic
tool across all uses of DCE ACLs.  It currently is doing what the POSIX
draft says a tool should do wrt the 'kill' command.  I don't think it should
change, but since it's just an enhancement request anyway, I'll leave it
open for more opinions (and added Joe and Walt for their POSIX opinions).

[2/3/93 public]
The following is Joe's response.  Since we both agree it works as spec'd
and shouldn't change, I've cancelled this CR.

"Acl_edit is behaving correctly.  The semantics of the kill operation is to
remove all entries but the user_obj entry. This is legal for some acl managers
but not for others (but acl_edit doesn't know this). The correct response from
the manager is to yield a bad syntax error as it is currently doing. I do not
believe that this functionality should be changed (Kill is sort of a unuseful
operation except for file systems in general)"
- joe



CR Number                     : 9847
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : acl_edit cache not updated for substitute & assign file cmds
Reported Date                 : 1/28/94
Found in Baseline             : 1.1
Found Date                    : 1/28/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/28/94 public]


In module src/security/client/admin/acl_edit/deif.c routines 
deif_do_substitute() & deif_sec_acl_from_file():

If the ACL doesn't exist, these routines allocate storage
for the default cell information and store it in the global
structure sec_acl_p. However, the new data is not stored in
the cache for use by other routines:
	def_cell_name & def_cell_id

If a list operation is invoked to view the default cell and entries, there
will be no default cell info listed. It uses def_cell_name.

[5/4/94 public]
You're right, Mike! Here's your explanation:

When it binds to an ACL (deif_bind()), it calls deif_get_cache_data().
That routine sets up my_cell_id and my_cell_name.  If there is no ACL, then
def_cell_name and def_cell_id are also set to my_cell_name and my_cell_id.
When substitute occurs without an existing acl, it allocates space for the
cell name and id in sec_acl_p and copies them from my_cell*.
It doesn't need to update the cached def_cell* data because that's already
been initialized to the same thing.



CR Number                     : 9846
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit delete cmd for specifying mask_obj entry
Reported Date                 : 1/28/94
Found in Baseline             : 1.1
Found Date                    : 1/28/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[1/28/94 public]


In module src/security/client/admin/acl_edit/tty.c routine
tty_process_args():

For an acl_edit delete command if the mask_obj entry is explicitly 
specified as well as some ACl entries in the file group class, then do 
not re-calculate the mask. This is done for modify when adding and 
changing entries.

If the user intends to delete the mask_obj entry he/she doesn't want to see
it created again when the POSIX 1003.6 steps 3,4,5 and 7,8 are followed.

[7/14/94 public]
Moved to dcecp component for Howard to look at prior to setting status
to defer to 1.2  (dcecp now performs most functions of the control programs)

[7/14/94 public]
Moved back to acl_edit.  Julie found this bug in acl_edit when she was
implementing similar functionality in dcecp.  The bug is not in dcecp, it's
in acl_edit, so this should remain assigned to acl_edit.  Yes, dcecp
functionality is what we want users to use, but if we're shipping both and
dcecp works correctly while acl_edit does not, then we need to fix acl_edit
(in 1.1, please do not defer this to 1.2 unless we can't get it fixed before
the final freeze).

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 9844
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : acl_edit kill cmd removes principals
Reported Date                 : 1/28/94
Found in Baseline             : 1.1
Found Date                    : 1/28/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/28/94 public]

The following acl_edit steps were taken. I created a principal, named b,
and proceded to remove all its ACL entries except the user_obj entry.
Once the acl_edit kill operation was committed, the ACL manager deletes 
the principal and account from the registry even though there is a 1 ACL 
entry on it, user_obj.

rgy_edit=> a
Add Principal=> Enter name: b
Enter UNIX number: (auto assign) 200
Enter full name: () fake
Enter object creation quota: (unlimited) 20
Add Principal=> Enter name:
rgy_edit=> v
nobody                                        -2
root                                           0
daemon                                         1
sys                                            2
bin                                            3
uucp                                           4
who                                            5
mail                                           6
tcb                                            9
dce-ptgt                                      20
dce-rgy                                       21
cell_admin                                   100
krbtgt/absolut_cell                          101
hosts/absolut/self                           102
hosts/absolut/cds-server                     103
hosts/absolut/gda                            104
hosts/drkstr/self                            107
salamone                                     109
melman                                       110
b                                            200
rgy_edit=> exit
bye.
root@absolut /$ acl_edit /.:/sec/principal/b
sec_acl_edit> l

# SEC_ACL for /.:/sec/principal/b:
# Default cell = /.../absolut_cell
unauthenticated:r-------g
user_obj:r---f--ug
user:cell_admin:rcDnfmaug
group:acct-admin:rcDnfmaug
other_obj:r-------g
any_other:r--------
sec_acl_edit> k
sec_acl_edit> l
# SEC_ACL for /.:/sec/principal/b:
# Default cell = /.../absolut_cell
user_obj:r---f--ug
sec_acl_edit> co
ERROR: at least one control permission bit required on acl (dce / sec)
sec_acl_edit> m user_obj:rcDnfmaug
sec_acl_edit> l

# SEC_ACL for /.:/sec/principal/b:
# Default cell = /.../absolut_cell
user_obj:rcDnfmaug
sec_acl_edit> co
sec_acl_edit> exit
ERROR: acl object not found (dce / sec)
root@absolut /$ rgy_edit
Current site is: registry server at /.../absolut_cell/subsys/dce/sec/master
rgy_edit=> do prin
Domain changed to: principal
rgy_edit=> v
nobody                                        -2
root                                           0
daemon                                         1
sys                                            2
bin                                            3
uucp                                           4
who                                            5
mail                                           6
tcb                                            9
dce-ptgt                                      20
dce-rgy                                       21
cell_admin                                   100
krbtgt/absolut_cell                          101
hosts/absolut/self                           102
hosts/absolut/cds-server                     103
hosts/absolut/gda                            104
hosts/drkstr/self                            107
salamone                                     109
melman                                       110
rgy_edit=> v -u 200
?(rgy_edit) Cannot retrieve any matching entries for 200 - No more matching entr
ies (Registry Edit Kernel) (dce / sad)
rgy_edit=>

[1/28/94 public]
Nope.  You killed all entries except the user_obj, so you are no longer able
to see the entry, which is why it looks to you like it doesn't exist.  The
user_obj (the principal itself) can still see itself, so if you logged into
'b', then you'd be able to see 'b'.  It is physically impossible for acl_edit
to remove principals from the registry (it doesn't make any call that could
do that).  I've cancelled this CR.



CR Number                     : 9843
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit "newly" granted permissions determined incorrectly
Reported Date                 : 1/28/94
Found in Baseline             : 1.1
Found Date                    : 1/28/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[1/28/94 public]

In module src/security/client/admin/acl_edit/deif.c routine 
deif_do_modify(), all requests to add new entries to the ACL and 
all requests to increase the permissions of existing entries are 
used to determine the "newly" granted permissions. acl_edit follows
the POSIX 1003.6 Draft 12 - Section 3.7.2.7 STEP 6.

However, the problem is that the granted permissions should be 
calculated from the file group class entries only. acl_edit determines
the granted permissions from all entries.

[7/14/94 public]
Moved to dcecp component for Howard to look at prior to setting status
to defer to 1.2  (dcecp now performs most functions of the control programs)

[7/14/94 public]
Moved back to acl_edit.  Julie found this bug in acl_edit when she was
implementing similar functionality in dcecp.  The bug is not in dcecp, it's
in acl_edit, so this should remain assigned to acl_edit.  Yes, dcecp
functionality is what we want users to use, but if we're shipping both and
dcecp works correctly while acl_edit does not, then we need to fix acl_edit
(in 1.1, please do not defer this to 1.2 unless we can't get it fixed before
the final freeze). (Note: Howard is already on the CC list, so he can look
at it even though it's assigned to 'sec').

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 9842
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit mask calculation for substitute cmd incorrect.
Reported Date                 : 1/28/94
Found in Baseline             : 1.1
Found Date                    : 1/28/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed by DCE1.2.2.

[1/28/94 public]

BACKGROUND:
    In acl_edit "substitute" or (-i/-I), the POSIX 1003.6 steps 3, 4, 5, 7,
    and 8 for the mask calculation is followed even if the "mask_obj"
    entry was specified or not.
    There is no -n or -c switch on the substitute command. Note that if
    the ACL manager requests no POSIX "mask_obj" semantics, then no mask
    calculation will occur (-n).

PROBLEM:
    In POSIX 1003.6 page 66 line 1292 states that if replace (-i/-I) and
    the new entries do not specify a "mask_obj" entry, then the mask shall be
    set as described by -c.

SOLUTION:
    When the "substitute" command is invoked in acl_edit, a check
    must be made to see if a "mask_obj" entry was explicitly
    specified. If so, set the mask calculation type to
    CALC_MASK_OBJ_AFTER (-c).  If not, set the mask calculation type
    to NO_MASK_OBJ_CALC (-n) so that no mask calculation occurs.

    Modifications must be made in module tty.c, routine tty_process_args()
    and tty_do_substitute().
    And possibly in module deif.c, routine deif_do_substitute().
    Maybe assign file functions too.

[7/14/94 public]
Moved to dcecp component for Howard to look at prior to setting status
to defer to 1.2  (dcecp now performs most functions of the control programs)

[7/14/94 public]
Moved back to acl_edit.  Julie found this bug in acl_edit when she was
implementing similar functionality in dcecp.  The bug is not in dcecp, it's
in acl_edit, so this should remain assigned to acl_edit.  Yes, dcecp
functionality is what we want users to use, but if we're shipping both and
dcecp works correctly while acl_edit does not, then we need to fix acl_edit
(in 1.1, please do not defer this to 1.2 unless we can't get it fixed before
the final freeze). (Note: Howard is already on the CC list, so he can look at
it even though it's assigned to sec/acl_edit).

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 9808
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : sinix
Component Name                : rpc
Subcomponent Name             : idl/idl_compiler/ddspell.c
Short Description             : Stubs differ on big & little endian
Reported Date                 : 1/24/94
Found in Baseline             : 1.0.3
Found Date                    : 1/24/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/24/94 public]

The IDL generated stubs differ when generated on a big endian machine instead of
a little endian machine.

The difference is in the way bug flags in the IDL_type_vec[] are stored. The
idl/idl_compiler/ddspell.c's DDBE_spell_type_vec_addenda() function generates
this field. The following test program mimics this functions behavior and can
be used to test on little and big endian machine:

-------------test_idl.c-----------------
#include <stdio.h>

main()
{
  unsigned long x=0;
  unsigned char *p4 = (unsigned char *)&x;

  x |= (1<<4);

  printf("0x%02x,0x%02x,0x%02x,0x%02x.\n",p4[0], p4[1], p4[2], p4[3]);

}
------------- end -----------------

Following #ifdef SNI_SVR4 code shows how to fix it (+ prefix shows lines added):

FIX: file idl/idl_compiler/ddspell.c
FUNCTION: DDBE_spell_type_vec_addenda()

------------- begin fix -----------------
    boolean         spell_stg_info; /* TRUE => spell storage information list */
+#ifdef SNI_SVR4
+    boolean             big_e;
+#endif /* SNI_SVR4 */

    p4 = (byte *)&longint;

+#ifdef SNI_SVR4
+    longint = 0x01020304;
+    big_e = ((byte) (longint & 0x0ff) == p4[3]);
+#endif /* SNI_SVR4 */

    /*
     * Process bugs flags.  Bug numbers start at 1, bug 0 value is a don't-care.
     */
    do_bug = (boolean *)cmd_val[opt_do_bug];
    index  = vip->type_vec_size;
    bugnum = 0;
    for (i = 0; i <= NUM_BUGS/32; i++)
    {
        longint = 0;
        for (j = 0; j < 32 && bugnum <= NUM_BUGS; j++)
        {
            if (do_bug[bugnum])
                longint |= (1 << j);
            bugnum++;
        }
        DDBE_SPELL_INDEX(fid, index);
+#ifdef SNI_SVR4
+        if (big_e) /* ndr_c_int_big_endian */
+            fprintf(fid, "0x%02x,0x%02x,0x%02x,0x%02x,",
+                         p4[3], p4[2], p4[1], p4[0]);
+        else       /* ndr_c_int_little_endian */
+            fprintf(fid, "0x%02x,0x%02x,0x%02x,0x%02x,",
+                         p4[0], p4[1], p4[2], p4[3]);
+#else
        fprintf(fid, "0x%02x,0x%02x,0x%02x,0x%02x,",p4[0], p4[1], p4[2], p4[3]);
+#endif /* SNI_SVR4 */
------------- end fix -----------------

[05/04/94 public]
Hp is going to give us a fix for the little/big endian problems
of the 'new' idl compiler.

I'm unclear if this defect is related to this overall problem:
Certain idl structure are kept in little-endian format, as opposed
to the native machine format, penalizing performance on big-endian machines.

Rico, could you take a quick glace at this?

[05/04/94 public]

This problem is not related to the overall endian partiality Tom mentioed above.
Its just a plain bug/ coding error.

[05/10/94 public]

These endian problems are always a little more mind bending to me than
they really ought to be!

Anyway, I think parul is correct.  I just emitted a stub on AIX with
some -bug options, and the emitted bug flags had bits set in the high-
order byte of the bugs flag, rather than the low-order byte.  As Tom
points out, since the current IDL spells the type vector in little-
endian format, emitted bug flags for '-bug 1 -bug 2 -bug 3' ought to
look something like 0x0e,0x00,0x00,0x00, not 0x00,0x00,0x00,0x0e.

[08/04/94 public]

I believe this should no longer be an issue, since the
fix for OT 10103 specifies that the type vector is now
spelled in the local integer representation of the 
machine.  Thus stubs on big and little endian architecture
machines are expected to differ.

[8/16/94 public]
Luis, can you verify that this field of the type vector
is indeed read back in the local endian representation
and does not need to be spelled out differently?

I guess I don't want to close/cancel this until we are sure.

[8/16/94 public]
Got clever and figured it out on my own that indeed, with the new
HP mods this array is spelled out correctly in the native format.
This bug is canceled.



CR Number                     : 9761
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dskl
Subcomponent Name             : diskless/swap/kernel
Short Description             : ERROR during diskless/swap/kernel build
Reported Date                 : 1/17/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/17/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/17/94 public]

The errors are:

10851:0706-154 ERROR:  Error in token processing;
10853:0706-154 ERROR:  Error in token processing;
10855:0706-154 ERROR:  Error in token processing;

The first set of numbers prior to the ':' are the line number
refering the log file in:
    tinker:/u1/devobj/sb/nb103_rios/logs/build.log.01-16-94

These errors came from loading the *.o for the dswc binaries  
during the RIOS build.

[1/17/94 public]
diskless is its own component, not a subcomponent of dfs.  
lowered priority - this may be cancelled pending decision on 
future support of this component.

[1/17/94 public]
Cancelled.  Diskless is no longer supported.



CR Number                     : 9760
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : rios compiler message (E) and (W)
Short Description             : there are a bunch of compiler messages that were never logged
Reported Date                 : 1/17/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/17/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/25/96 public]
Cannot reproduce with R1.2.2.  No part of dfs testing has recognized
this problem.

[1/17/94 public]

There are a bunch of (E) and (W) that the compiler spits out
which were ignored in the log files.  These SHOULD NOT be 
ignored.  

However, it is going to be a low priority because the DCE103
was shipped with some of these (E) and (W) messages in its
log.



CR Number                     : 9756
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : rpc's build
Short Description             : we got an idl error/warning??
Reported Date                 : 1/17/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/17/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/17/94 public]

We got the message:

    /u2/devobj/sb/nb103a_ux/tools/hp800/bin/idl: File /project/dce/build/dce1.0.3a-snap/src/rpc/kruntime/ep.acf, line 32: [nocode] interface ept
    /u2/devobj/sb/nb103a_ux/tools/hp800/bin/idl: File /project/dce/build/dce1.0.3a-snap/src/rpc/kruntime/ep.acf, line 32: [nocode] interface ept

during the execution of rpc/kruntime .  

Is this an error or warning?

[1/20/94 public]

This is a warning, which is expected given the way we are using idl in this
instance.  Since we are telling idl to generate a client stub (for use in
libknck) but have labeled the interface with the nocode attribute, idl
warns us that the client stub won't be very usefull.  However, the routines
are implemented elsewere in the kernel runtime and this is the proper
behaviour.



CR Number                     : 9754
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : Signal 10 on HPUX in file/tkc's build
Reported Date                 : 1/17/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/17/94
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/17/94 public]

We got a Signal 10 in last night's DCE1.0.3a build on the HPUX platform.
Look in:
    zagreb:/u2/devobj/sb/nb103_ux/obj/hp800/file/tkc

There is a core file there.

The full log is in
    zagreb:/u2/devobj/sb/nb103_ux/logs/build.log.01-16-94

The refined log with references to line number in the above
log file is in
    zagreb:/u1/users/annie/parse/hpux/build.e

Looking at the Makefile, the build got to tkc_locks.c and died.
The next source code tkc_revoke.c did not get built.

Let me know if you have any questions.

[2/22/94 public]

Since this was assigned to the 1.1 area, I took a look at the HP build on
zagreb:/u3/devobj/sb/nb_ux/logs/build.log.02-21-94 and found no indication
of a Signal 10. This was determined by doing a grep on Signal and a visual
inspection of ./file/tkc. 
I am cancelling this defect.
If this is a problem with dce1.1a, it should be noted as
such.



CR Number                     : 9749
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9661
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dts
Subcomponent Name             : dtsd
Short Description             : dtsd should verify dts-entity
Reported Date                 : 1/17/94
Found in Baseline             : 1.1
Found Date                    : 1/17/94
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/17/94 public]

The dtsd exports it binding information to the namespace in
		/.:/hosts/<machine>/dts-entity

On startup, (or actually, when it goes to export itself to this object)
it should read back all entries and remove the ones that don't belong.

Probably the simplest way to do this would be to delete all entries
from the object before exporting the correct one.

An example of why this should be done:
	dts server running on host a
	host a crashes, dts doesn't unexport to namespace
	host a changes IP address
	dtsd come up and doesn't remove bindings, clients can't find dtsd.

[8/23/94 public]
Having examined the code, dtsd does an rpc_ns_binding_unexport() on
the interface ID and object UUID for both it's control interface, and 
for the time service interface. Based on my reading of the
documentation, this should remove all binding handles and object uuids
registered under that name service entry. 

Cancelled.



CR Number                     : 9728
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : 
Short Description             : rename 'autogen' pass to
'samidl' pass
Reported Date                 : 1/12/94
Found in Baseline             : 1.1
Found Date                    : 1/12/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : lbe/mk/osf.dce.passes.mk
Sensitivity                   : public

[1/12/94 public]
The AUTOGEN pass in the makefiles implements the "samidl" functionality.
The naming is a little screwy, however:

	SAMIDL_SUBDIRS - specifies the directories to be visited
	SAMIDL_INCLUDES
	SAMS_TARGETS
	SAMSFILES      - all specify the SAMS targets for the pass
	samidl_all	- is the build target to only invoke that pass

... and yet the pass is named autogen and so it appears in the build log.

Why confuse the issue?  Let's rename it the SAMIDL pass.

[01/12/94 public]

Well, the intent is that AUTOGEN was supposed to be a superset that
included sams, idl, and anything else that might (later) be generated
before being compiled.  Perhaps it's not worth keeping the distinction.

[1/13/94 public]

Since we've headed down the path where everything is named SAMIDL except
the pass naming process, let's just fix the name.

Assigning this to Mario Moreira.

[4/19/94 public]

Given that the AUTOGEN pass has been around awhile now so people are 
beginning to identify with it (I can relate man!) and given the
resources available, it has been decided that AUTOGEN is a rather nice
name.  Also the intent was that AUTOGEN was supposed to be a superset that
included sams, idl, and anything else that might (later) be generated
before being compiled.  With all of this on the pro side to keep AUTOGEN
as the name it is worth keeping the distinction!  The AUTOGEN info will
be sent to doc to document the AUTOGEN pass in the Porting and Testing
Guide.

[4/20/94 public]
Note: same message as 4/19/94 entry except it is more reasonable to cancel
this ot instead of close since no real work has been done.
Given that the AUTOGEN pass has been around awhile now so people are 
beginning to identify with it (I can relate man!) and given the
resources available, it has been decided that AUTOGEN is a rather nice
name.  Also the intent was that AUTOGEN was supposed to be a superset that
included sams, idl, and anything else that might (later) be generated
before being compiled.  With all of this on the pro side to keep AUTOGEN
as the name it is worth keeping the distinction!  The AUTOGEN info will
be sent to doc to document the AUTOGEN pass in the Porting and Testing
Guide.



CR Number                     : 9727
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : aud
Subcomponent Name             : 
Short Description             : All idl invocations should be
done in autogen pass
Reported Date                 : 1/12/94
Found in Baseline             : 1.1b1
Found Date                    : 1/12/94
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/12/94 public]

The 'autogen' pass is driven by the SAMIDL_SUBDIRS directives in the
makefiles.  (Yes, there should have been a common name.)  Basically, this
pass was implemented to address the problems posed by the treatment of SAMS
and IDL files in builds.  There is some discussion of this in the DCE 1.1
Coding Style Guide -- sections 5.1 (k) and (l).  [An update to these
sections will be published soon.]  The idea behind this pass is to process
all SAMS and IDL files and create all the build products (stubs, headers,
msg catalogs) at the top of the build.  This would eliminate multiple
invocations of IDL to generate Cstubs and Sstubs.

The purpose of this defect is to move all idl invocations to this pass.

[3/16/94 public]
There is some philosophical disagreement about the purpose of autogen pass.
This is being changed to an 'enhancement' because this shouldn't impact
audit defect density numbers.



CR Number                     : 9713
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : ncsubik
Short Description             : beacon thread takes too long to get ubik lock
Reported Date                 : 1/11/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/11/94
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/11/94 public]

Sometimes the beacon thread takes a long time to get the ubik
lock.  It can take more than POLLTIME seconds from the time
that the thread actually wakes up to the time it gets the lock
and actually can send beacons.  This is part of the reason why
we loose quorum .  This problem is more evident when
ubik has a lot of write activity going on to the fldb.

I put some logging in beacon.c to see how long it takes
and this is what we have:

long time to get ubik lock 36
long time to get ubik lock 70
long time to get ubik lock 38

The numbers are the difference between the time we wake up
and the time after ubik_hold completes.

We are also seeing the Beacon thread go more than POLLTIME
seconds since LastWakeupTime. 

You don't necessarily have to have a high load average on the
machine to make this happen.

[1/17/93 public]

Move to 1.1; have got a lot of info, and it might be too risky
even if we could generate a fix.

[05/03/94 public]
Diane - are you still considering this? I'm still losing quorum in CHO ...
Let me know if there is particular data you need captured - thanks.



CR Number                     : 9683
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : client side
Short Description             : HP dfs client machine crashes
Reported Date                 : 1/4/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/4/94
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/4/94 public]

Using 1.0.3ab2 (latest weekly build - contains dfsbind memory leak
fix), I set up Config G - a 13 machine (10 dfs) cell. I started
dfs.lock on one of the dfs client only HP machines, with 9 client
machines specified. Sometime in the past 3 days, one of the dfs
client only HP machines involved in the test (but not hosting the
test) crashed. Unfortunately, I did not have /tmp/syscore directories
set up on the client only machines. I hope to get a chance to rerun
this exact scenario when I can again Configure "G". In the meantime,
this CR is merely serving as a placeholder/reminder/warning that
some problem exists ...

dce2 = client only machine hosting test
dce1 = client only machine that crashed
soldier = file server exporting /:/dfs_1 for test
principal = dfs_1

[01/17/94 public]
Lowering priority since the dfs.lock test contained a tight read
loop that put excessive load on all client machines. However, since
this test has not yet been run successfully in a large cell, not
closing/cancelling yet either.

[01/31/94 public]
Cancelling - new and improved dfs.lock test ran in the identical large
cell configuration WITHOUT causing any machines to crash. (Only 10% of
the iterations passed but this was sufficient to close out this CR).



CR Number                     : 9679
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : bosserver
Short Description             : error message during auto-restart
Reported Date                 : 1/4/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/4/94
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/25/96 public]
Can't reproduce with R1.2.2.  No part of dfs testing has encountered
this problem.

[1/4/94 public]
On both the HP and RIOS, the BosLog.old resulting from the auto-restart
(Sunday 4am) contained the error message:

Sun Jan  2 04:00:00 1994: reBossvrWatchThread: no error; simple restart exit
compat_UnregisterServer: unexpected error from rpc_ep_unregister: not registered in endpoint map (dce / r
pc)
Sun Jan  2 04:00:01 1994: /opt/dcelocal/bin/bosserver: error unregistering self: not registered in endpoi
nt map (dce / rpc)
Sun Jan  2 04:00:02 1994: /opt/dcelocal/bin/bosserver: application exit

Unclear whether the error message is valid or not but I believe it is logged
regularly during these auto-restarts so it's no longer "unexpected"!

[1/6/94 public]
Consensus is that the low priority/severity appears correct so we can defer
this to 1.1.

[9/21/94 public]
Not seen during 1.1 - canceling.

[9/26/94 public]
Oops - spoke too soon - still appears to be harmless - perhaps there
are inadvertently 2 attempts to unregister self during the shutdown
so the 2nd one will always report this?

From BosLog.old:
Fri Sep 23 19:08:52 1994: /opt/dcelocal/bin/bosserver: beginning logging
Fri Sep 23 19:08:52 1994: Server directory access is okay
Sun Sep 25 04:00:00 1994: reBossvrWatchThread: no error; simple restart exit
Sun Sep 25 04:00:04 1994: /opt/dcelocal/bin/bosserver: error unregistering self:
 Not registered in endpoint map (dce / rpc)
Sun Sep 25 04:00:05 1994: /opt/dcelocal/bin/bosserver: application exit



CR Number                     : 9677
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : rc.dce should restart gdad
Reported Date                 : 1/4/94
Found in Baseline             : 1.1
Found Date                    : 1/4/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/4/94 public]
rc.dce should restart gdad

[1/4/94 public]
My mistake; it does.



CR Number                     : 9672
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : releasing page wrongly in vnvm_truncate
Reported Date                 : 1/3/94
Found in Baseline             : 1.0.3a
Found Date                    : 1/3/94
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[1/3/94 public]
The criterion for calling vm_releasep from vnvm_truncate can be "off by one".
For instance, if the file size is 4096 * 10 and we are truncating to
4096 * 9 + 1, it will release one page, which could lose data.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[1/4/94 public]
I'm sorry, this was just a hallucination.  Thanks to Blake Lewis for pointing
out the error of my arithmetic.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 9671
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : unknown
Short Description             : rios panic due to sched rep?
Reported Date                 : 12/31/93
Found in Baseline             : 1.0.3a
Found Date                    : 12/31/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[12/31/93 public]
 
Rios in Config A of system test (identical to CHO config) that is
a dts server, fldb server, file server and dfs client, was found
in a panic state (blinking 888) after dfs.read_write_all had
completed 24 hours earlier. All that was going on in the cell
was scheduled replication - the replicated fileset was NOT being
written to at or within 18 hours before the panic so scheduled
replication should have been a noop (right?). Unfortunately,
the core file in /opt/dcelocal/var/dfs/adm was empty, dbx reported
that the core.bosserver file was really from the repserver and
that the framepointer was bad, and the crashdump contained no
useful information (crash device possibly too small - size increased).
Assigning to myself - hopefully I'll be able to include debug data
when this happens again. Note that the thread-aware code for aix dbx
is not yet available to system test.

[12/31/93 public]
Even in an idle cell, the repserver will update the volume status of every
replica (on which it has a token for the R/W) every 90 seconds.
 
One thing that will happen after 18 hours of inactivity is that the ZLC
manager might finally be able to obtain the open-for-delete tokens for
replicated files, the R/W fileset could have those files deleted, and
the R/O filesets could then be updated.  Not that this should fail, but
it's something that could happen after long periods of what appears to be
inactivity.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[01/20/94 public]
Dropping to a 1 and assigning to Cindy (who is finishing off the dfs.repfs
script). Craig's input is useful in clarifying possible activity in an
"idle" cell but, in this case, the replicated fileset was NOT involved in
the dfs.read_write_all test so the ZLC would not have been blocked. I suspect
the dfs.read_write_all test more than the scheduled replication however - since
I have seen it have a mysteriously destructive effect on cells (ie. test runs
fine for 44 hours, not 48 and cell does not exhibit healthy response times
after the test). If the dfs.repfs script can run successfully on rios and
hp for 48 hours with default scheduled replication settings (or if nec. with
more frequent scheduled replication updates over a shorter period of time),
then this CR can be cancelled. Ideally we could run the scripts post-read_write_all
test and be more sure there isn't a problem.

[1/31/94 public]

I did not successfully run dfs.repfs for 48 hours on the RIOS problems
on the RIOS not related to replication.  I was able to setup a fileset
on a RIOS with scheduled replication to a HP and RIOS and let run for over
48 hours without problems.  The fileset was not being updated.  Since I did
not see any problems with the replication, I am canceling this CR.



CR Number                     : 9634
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : config
Short Description             : daemonrunning change
Reported Date                 : 12/20/93
Found in Baseline             : 1.0.3
Found Date                    : 12/20/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rc.dce
Sensitivity                   : public

[12/20/93 public]

The rc.dce file need to change in routine daemonrunning.
Every time rpcd is started, it could fail if the user did not
wait the required 4 minutes and the socket may still be busy.

If rpcd fails to start, secd may also fail to start, etc.

The proposed change follows :


daemonrunning()
{
        cmd=`basename $1`

        grep $cmd $PSFILE >/dev/null
        if [ $? -ne 0 ]
        then# just return if the daemon doesn't exist
                [ -x $1 ] || return 0
                echo "\t$*"
                if [ $cmd = "rpcd" ];then
                        for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24; do
                                $*
                                if [ $? -eq 0 ];then
                                        break
                                fi
                                sleep 10
                        done
                        if [ $i -ge 24 ];then
        			err_exit "Could not start rpcd\n"
                        fi
                else
                        $*
                fi
        fi
}

[8/24/94 public]
The rpc runtime has been fixed to allow rpcd (or dced) to reuse
the TCP socket.  So this change is no longer necessary.
Bug canceled.



CR Number                     : 9632
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : tkm
Short Description             : token leak during cho
Reported Date                 : 12/20/93
Found in Baseline             : 1.0.3a
Found Date                    : 12/20/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/25/96 public]

Cannot reproduce with 1.2.2 DFS.  This problem does NOT occur
when DFS testing is performed (CHO, Sys Test, FVTs).


Transarc Deltas                      [text]: 
Transarc Herder                      [text]: 
Transarc Status                      [text]:

[12/20/93 public]
During cho, machine 3 locks up.  This has happened
both times that I have run cho; the first time after
43 hours, and the second time it's unknown.
The difficulty of this is that for the second time,
I had machine 3 setup as a debug client during CHO,
but I was unable to get rsdbb to respond when
the server hung, so we don't have much information.

[12/20/93 public]
Please do not assign things to Transarc unless we have enough information
to make some progress on the problem.  We read the OT notices, and will
certainly take it on if we feel that we can do something.  This defect
is not detailed enough for us to make progress.
Filled in Interest List CC with `delgado@osf.org' 
Changed Responsible Engr. from `jaffe@transarc.com' to `delgado' 
Changed Resp. Engr's Company from `tarc' to `osf' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[1/27/94 public]

Here are stack traces of processes which were running at the time:

 Command:  /opt/dcelocal/bin/fxd -mainprocs 7 -admingroup subsys/dce/df
 Kernel Stack trace:

    save+0x0000    _swtch+0x0150    sema_sleep+0x00c0
    pchansync+0x0194    _sleep+0x0154    osi_SleepW+0x00bd
    fshs_StartCall+0x00a1    fshs_RevokeToken+0x0609    tkm_HostRevokeList_DoRevoke+0x03e9
    tpq_Pardo+0x0671    tkm_HostRevokeList_SendRevocationsInParallel+0x030d    tkm_FidHash_RevokeConfli
cts+0x07dd
     tkm_FidHash_AsyncRevokeFid+0x00b1    tkm_GC_TryAsyncRevokes+0x00e5    tkm_TokenFreeList_ReserveToke
ns+0x0269
     tkm_FidHash_RevokeConflicts+0x0269    tkm_GetTokenNoVolCheck+0x03cd    tkm_GetTokenLeaveOnFid+0x026
5
     tkm_GetToken+0x0c31    ObtainSet+0x02f9    tkset_AddTokenSet+0x025d
     SAFS_RemoveFile+0x0225    op8_ssr+0x01d5    rpc__dg_execute_call+0x134d
     cthread_call_executor+0x0331    pthread_create+0x02d1    cthread_create+0x00e1
     cthread_pool_start+0x01f9    rpc__cthread_start_all+0x0105    rpc_server_listen+0x0285

----

 Command:  /opt/dcelocal/bin/fxd -mainprocs 7 -admingroup subsys/dce/df


 Kernel Stack trace:

    save+0x0000    _swtch+0x0150    sema_sleep+0x00c0
    pchansync+0x0194    _sleep+0x0154    osi_SleepW+0x00bd
    fshs_StartCall+0x00a1    fshs_RevokeToken+0x0609    tkm_HostRevokeList_DoRevoke+0x03e9
    tpq_Pardo+0x0671    tkm_HostRevokeList_SendRevocationsInParallel+0x030d    tkm_FidHash_RevokeConfli
cts+0x07dd
    tkm_FidHash_AsyncRevokeFid+0x00b1    tkm_GC_TryAsyncRevokes+0x00e5    tkm_TokenFreeList_ReserveToke
ns+0x0269
    tkm_FidHash_RevokeConflicts+0x0269    tkm_GetTokenNoVolCheck+0x03cd    tkm_GetTokenLeaveOnFid+0x026
5
    tkm_GetToken+0x0c31    ObtainSet+0x02f9    tkset_AddTokenSet+0x025d
    SAFS_Lookup+0x0215    op16_ssr+0x01d5    rpc__dg_execute_call+0x134d
    cthread_call_executor+0x0331    pthread_create+0x02d1    cthread_create+0x00e1
    cthread_pool_start+0x01f9    rpc__cthread_start_all+0x0105    rpc_server_listen+0x0285

-----------------------


 Command:  /opt/dcelocal/bin/fxd -mainprocs 7 -admingroup subsys/dce/df



    icl_AppendRecord+0x00a9    icl_Event4+0x01a1    icl_Event3+0x0045
    tkm_GC_FindCandidate+0x0181    tkm_GC_FreeOldest+0x0055    tkm_TokenFreeList_ReserveTokens+0x0139
    tkm_FidHash_RevokeConflicts+0x0269    tkm_GetTokenNoVolCheck+0x03cd    tkm_GetTokenLeaveOnFid+0x026
5
    tkm_GetToken+0x0c31    ObtainSet+0x02f9    tkset_AddTokenSet+0x025d
    SAFS_GetToken+0x0955    op17_ssr+0x01b9    rpc__dg_execute_call+0x134d
    cthread_call_executor+0x0331    pthread_create+0x02d1    cthread_create+0x00e1
    cthread_pool_start+0x01f9    rpc__cthread_start_all+0x0105    rpc_server_listen+0x0285
    afscall_exporter+0x01a5    afs_syscall+0x00a5    syscall+0x01a4


-------------------------

[2/9/94 public]


We've actually seen the token manager reach the tkm_maxTokensOutstanding
limint during CHO.  This limit is hard coded at 10000; I don't think
that CHO should need 10,000 tokens outstanding at one time, so it
seems that we have some kind of token leak here.  Tokens are supposed
to be given back when a file is closed or deleted, right?

We have also gotten TKM_ERROR_NOMEM from the RIOS server during 
the last CHO run, so the problem does not now seem to be HPUX
specific; it's just that the HP might be more sensitive to running
out of kernel memory than the RIOS.  We've also monitored the
memory consumption on the RIOS server and have seen that the
token manager is by far the largest user, with
tkm_tokenFreeList_SimpleObtain being the winner by far.

Also, we've noted that we don't see a steady growth in token
memory usage.  The tkm_maxTokensOutstanding will get bumped
up sereral times and then stay steady for hours, at which time
it might grow a little and then stay steady ... etc.

[05/03/94 public]
Diane - please point me to where/how to watch for this. During CHO, I run
with the following dfstrace settings:

> dfstrace lsset
Available sets:
cm: dormant
fx: dormant
fshost: dormant
xops: dormant
episode/anode: dormant
episode/logbuf: dormant
episode/vnopsVerbose: dormant
episode/vnopsBasic: active
tkc: active
tpq: dormant
tkm: active

Please let me know if this is sufficient/unnecessary - Thanks!

[06/02/94 public]
AHA! Much easier way to reproduce than CHO! Using dfs.read_write_all.main with
the following data settings in the CHO cell, received the following errors at the
41 hour mark :
dfs: dce errors (code 663076882) from the fx server 130.105.201.7 in cell cho_cell.qadce.osf.org
(16 times on darkman, 2 times on dce11)
Then on dce11:
dfs: set auth binding failed (code 382312711); running unauthenticated.
dfs: set auth binding failed (code 382312711); running unauthenticated.
dfs: set auth binding failed (code 382312711); running unauthenticated.

where 130.105.201.7 is cobbler and the error translation is:

663076882 (decimal), 2785c012 (hex): Token manager unable to get required memory for operation (dfs / tkm)

Data settings were:
AGGR_NAMES="m1.aggr1 m1.aggr2 m2.aggr2 m3.aggr2 "
AGGR_SERVERS="cobbler cobbler dce8 dce11 "
FILESETS_PER_AGGR="1 1 2 2 "
MACHINES="darkman dce11 dce8 cobbler"
NUMBER_OF_USERS=6

The dfs.read_write_all.main test does a lot of i/o operations but there
is no file sharing and all files are created and deleted each loop of the
test script (do.ksh) by the individual test user in their own fileset. Any
ideas where the leaks are?! I'm taking a look at what dfstrace shows on
cobbler now ...

I've placed the dfstrace dump in:
	~notuser/gmd/dfstrace.dump.9632

Fortunately or unfortunately, I had more dfstracing turned on than usual.
Note that the time of the failure was about 10:55 am on Thursday June 2nd.

Lastly, symptom in the test logs is:
... cannot stat <full path to filename in dfsexported episode> : Unknown error
ie.
rm: cannot stat /:/dfsusers/dfs_1/utils/etc/zoneinfo.new/US/Arizona: Unknown error

[06/03/94 public]
I'm even more convinced that this is the same error since after leaving
the test running, cobbler "locked up" as Diane described ie. you could
ping it but that's all - current login sessions were unresponsive and
no new login sessions could be started. Rerunning with file/osi/tom
to monitor alloc's.

[06/08/94 public]
I've now also crashed an HP server by running the dfs.read_write_all test.
Console was filled with:
dfs: dce errors (code 663076882) from fx server 130.105.202.28 in cell cho_cell.qadce.osf.org

again this error code is:
663076882 (decimal), 2785c012 (hex): Token manager unable to get required memory for operation (dfs / tkm)

[06/9/94 public]

not my problem anymore :-)



CR Number                     : 9615
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : flserver
Short Description             : flserver dumps core during cho
Reported Date                 : 12/14/93
Found in Baseline             : 1.0.3a
Found Date                    : 12/14/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[12/14/93 public]


During CHO, after about 8 hours the flserver on one of the RIOS
core dumped.  We have a core file but dbx can't read it. 

We don't yet know about the frequency of the problem, so we
might have to adjust the priorities and fixby fields later.

[1/11/94 public]

[06/07/94 public]

Have not seen this in quite awhile.  Even if we have, we still
don't have any means of debugging it since core files are not
useable on the RIOS.


This problem occurs infrequently and it's difficult
to track due to the inability to read core files of
threaded applications on the RIOS.  Will defer to
1.1 when we hopefully can have the ability to 
read threaded core files.

[05/03/94 public]
We still do not have the ability to read threaded core files,
however, I have not seen this problem yet during 1.1 CHO runs.
I am still in the process of defining the CHO setup for the
1 RIOS - 3 HP cell I have available for it. I will watch
for flserver core files and cancel this if none are seen.



CR Number                     : 9576
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : cdscp list dir /.:/hosts/* fails from command line
Reported Date                 : 12/6/93
Found in Baseline             : 1.0.3
Found Date                    : 12/6/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[12/6/93 public]

After the cdscp parser change of 10/12/93 for OT3159 and
OT5925, there are some differences between the interactive
parsing of commands from within cdscp and the parsing
of cdscp commands from a single shell command line.
The differences found so far involve the * character.


This first case just doesn't work from the shell command
line.  This is a popular and frequently-used construct.
Scripts using this construct may also be broken.

$ cdscp list dir /.:/hosts/*
/.:/hosts/: No such file or directory
$ cdscp
cdscp> list dir /.:/hosts/*
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:46:53
clarity
cdscp> exit


This second case shows a difference in the interpretation
of the \* construct between command line and interactive use.

$ cdscp list dir /.:/hosts/\*
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:47:39
clarity
$ cdscp
cdscp> list dir /.:/hosts/\*
                        LIST
                   DIRECTORY   /.../hotsite/hosts/*
                          AT   1993-12-02-16:48:00
cdscp> exit


This third case works as expected, and is currently the only
way to get the desired functionality.  This should continue
to work after this bug is fixed.

$ cdscp
cdscp> list dir "/.:/hosts/*"
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:50:42
clarity
cdscp> exit
$ cdscp list dir "/.:/hosts/*"
                        LIST
                   DIRECTORY   /.../hotsite/hosts
                          AT   1993-12-02-16:47:29
clarity

[12/06/93 public]

Paul, your shell is giving you the error message because its looking
for a directory named '/.:'. The string isn't getting passed to cdscp.

Running unauthenticated on my system.....

% cdscp show dir /.:
Warning: you have no network credentials. All requests will be
unauthenticated.


                        SHOW
                   DIRECTORY   /.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx
                          AT   1993-12-06-13:16:10
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-11-15-20:14:13.199000100/08-00-09-25-e3-2c
                     CDS_UTS =
1993-11-15-20:14:37.958756100/08-00-09-25-e3-2c
              CDS_ObjectUUID = 3b178644-e1e7-11cc-8933-08000925e32c
                CDS_Replicas = :
          Clearinghouse UUID = 393dd698-e1e7-11cc-8933-08000925e32c
33-08000925e32c
          CDS_ReplicaVersion = 3.0
% cdscp show dir /.:/*
/.:/: No such file or directory

Note that the warning isn't present. This is because cdscp never gets
called by the shell. I find this only happens with the c shell. Running 
with the ksh.....

$ cdscp show dir /.:/*
Warning: you have no network credentials. All requests will be
unauthenticated.


                        SHOW
                   DIRECTORY
/.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx/hosts
                          AT   1993-12-06-13:20:27
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-11-15-20:14:50.315246100/08-00-09-25-e3-2c
                     CDS_UTS =
1993-12-04-12:33:20.043420100/08-00-09-25-e3-2c
              CDS_ObjectUUID = 5136fe50-e1e7-11cc-8933-08000925e32c
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk =
1993-12-04-10:32:53.062581100/08-00-09-25-e3-2c
              CDS_LastUpdate =
1993-12-04-12:33:20.043420100/08-00-09-25-e3-2c
             CDS_RingPointer = 393dd698-e1e7-11cc-8933-08000925e32c
                   CDS_Epoch = 515e71b0-e1e7-11cc-8933-08000925e32c
          CDS_ReplicaVersion = 3.0

                        SHOW
                   DIRECTORY
/.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx/subsys
                          AT   1993-12-06-13:22:05
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-11-15-20:14:45.420387100/08-00-09-25-e3-2c
                     CDS_UTS =
1993-12-04-12:33:19.450244100/08-00-09-25-e3-2c
me = /.../c=us/o=osf/ou=dce/cn=cell1/cn=cellx/subsys
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk =
1993-12-04-10:32:52.629330100/08-00-09-25-e3-2c
              CDS_LastUpdate =
1993-12-04-12:33:19.450244100/08-00-09-25-e3-2c
             CDS_RingPointer = 393dd698-e1e7-11cc-8933-08000925e32c
                   CDS_Epoch = 4e8a045e-e1e7-11cc-8933-08000925e32c
          CDS_ReplicaVersion = 3.0
$

I'm not a c shell user but I'm told that if one enters the following in
their .cshrc the problem is remedied.

set nonomatch

I'll cancel this a bit later if you don;t object.

[10/6/93 public]
cancelled.



CR Number                     : 9574
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dts
Subcomponent Name             : 
Short Description             : utc_asclocaltime creates a string that can't be given to utc_mkasctime
Reported Date                 : 12/3/93
Found in Baseline             : 1.0.3
Found Date                    : 12/3/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[12/3/93 public]
Calling utc_asclocaltime() to get the local time will return an
absolute DTS style timestamp that can't be handed back to
utc_mkasctime(). 

Why? Because utc_asclocaltime() returns:
1993-12-03-23:03:55.588+00:00I-----

While utc_mkasctime() wants to see something on the order of:
1993-12-03-23:03:55.588+00:00I---.--
                                 ^

utc_mkasctime should be changed to accept the syntax returned by 
utc_asclocaltime().

[7/18/94 public]

The following program, when run against the DCE1.1b11 build, passes
with no error, and prints out identical strings.

#include <stdio.h>
#include <stdlib.h>
#include <dce/utc.h>

int main(int ac, char * av[])
{
    utc_t u ;
    char localtime[ UTC_MAX_STR_LEN ] ;
    char convtime[ UTC_MAX_STR_LEN ] ;

    if (utc_asclocaltime( localtime, UTC_MAX_STR_LEN, (utc_t *)0))
    {
	fprintf(stderr, "asclocaltime blows chunks!\n") ;
	exit(1);
    }
    printf("utc_asclocaltime returns %s\n", localtime) ;

    if (utc_mkasctime( &u, localtime)) {
	fprintf(stderr, "utc_mkasctime fails!\n");
	exit(1);
    }

    if( utc_asclocaltime( convtime, UTC_MAX_STR_LEN, &u))
    {
	fprintf(stderr, "asclocaltime chokes on converted input\n");
	exit(1);
    }
  

   printf("utc_mkasctime returns %s\n", convtime) ;
    exit(0);
}

Closed. Can't duplicate.



CR Number                     : 9572
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : 
Short Description             : test, ignore this defect
Reported Date                 : 12/3/93
Found in Baseline             : 1.0.3
Found Date                    : 12/3/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : closed

[12/3/93 public]
We moved the ot tools from AFS to DFS and I'm having some
problems.  This is a test to see if open works.  I'll cancel
this defect shortly.

Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `open'

[12/3/93 public]
Filled in Interest List CC with `jean@austin.ibm.com'

[12/3/93 public]
Changed Status from `open' to `cancel' 
Filled in Responsible Engr. with `dstokes@austin.ibm.com' 
Filled in Resp. Engr's Company with `ibm' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 9569
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : config
Short Description             : menu2
Reported Date                 : 12/2/93
Found in Baseline             : 1.0.3
Found Date                    : 12/2/93
Severity                      : B
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dce_config
Sensitivity                   : public

[12/2/93 public]

Place a call to menu2 after calling config_morecds() from menu4.

This follows the change delete the menu2 call from the end of the
routine config_morecds() which breaks non-interactive mode.

[03/30/94 public]
I have remove all explicit calls to menu functions, so jumping to
menu2 after configuring an additional CDS server doesn't make
sense any more.
Canceled.



CR Number                     : 9566
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : DG runtime
Short Description             : DG client runtime drops WAY request
Reported Date                 : 12/1/93
Found in Baseline             : 1.0.3
Found Date                    : 12/1/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[12/1/93 public]

There is an intermittant failure that has been observed when running the DCE 
VTS DG Client tests. This happens only for non-idempotent RPCs. The PDU 
exchange is depicted below:

	VTS (server)			DG Client Runtime
	-----------			-----------------

			<------	request
			<------	ping
		WAY request --->
			<------ ping
			... comm failure

A real server would time out and send another WAY request (the server is 
acting as a client when doing the callback). In many cases, that might happen 
to work. Modifying the VTS to do that however, demonstrated that something 
akin to a race conditon can occur here, where the client keeps pinging and the
server keeps resending the WAY request. The RPC ends (comm failure) when 
the DG client runtime reaches the max number of pings and starts sending quits.

Apparently, the DG Client runtime either loses the WAY request or is not
checking for it properly. This happens on the OSF/1 486 reference platform
with greater frequency than it does on the HP (but it does happen on the 
HP from time to time).

At the application level, it means that any non-idempotent RPC which uses the 
DG protocol can inexplicably fail, returning comm failure, even though there 
is nothing wrong with the server.

Related CR is dce_vts CR 10.

[12/1/93 public]

I don't know what race condition you're seeing.  The client timed out
because the server failed to respond to its pings.  The fact that the
server is in the middle of a WAY has no bearing on the requirement that
it respond to pings.

And yes, VTS should be modified to retransmit WAY requests if no response
is seen.

[12/1393 public]

As it turns out, my original analysis was a little off the mark. After
consulting the AES/DC and modifying the VTS some, we have a better idea
of what we think is going on and what should be happening.

First of all, that business about resending the WAY request I mentioned 
above is plain wrong. The AES specifies that the correct response to a
ping PDU is a NOCALL PDU, with the optional body (see pg. 12-16 of the
AES/DC). But even when we do so, it can still fail.

A second point is that the CL Server CALLBACK state (see pg. 10-40) is a 
parallel state machine, executing independently of the DATA state. The 
server executes this state as if it were a DG client, and the client 
acts as a server. This means that the client (acting as server) is obliged 
to respond to the WAY request, even though it is waiting for a response 
to its original request.

Except as indicted, the PDU exchange is depicted in the order the CL 
client runtime sees the PDUs, in most of the analyses below.

When running the VTS to validate non-idempotent calls, we normally see 
something like the following (single frag request/response):

VTS (as server)			CL Client Runtime

			<-----	send request 
send WAY request	----->	
			<-----	send WAY response
send response		----->

So far, so good. Now, sometimes we get the following (running the same
test) which is still okay:

VTS (as server)			CL Client Runtime

			<-----	send request 
			<-----	ping for response
send WAY request	----->	
			<-----	send WAY response
send response		----->

One type of intermittant problem was that we were getting this:

VTS (as server)			CL Client Runtime

			<-----	send request 
			<------ ping
send WAY request	----->	
			<------ ping
			<------ ping
			<------ ping
			<------ ping
			... comm failure

As Mark pointed out, the client timed out waiting for a
response. The correct response to a ping is not for the VTS 
to re-send the WAY request, however, it is to return a NOCALL 
with the optional body in response to the PING (as stated in 
my second point, above), and, after timeout, to ping the WAY 
request.
The WAY request only gets re-sent in the event that the server
(which issued the request) receives a NOCALL in response a 
PING (which is not shown in the above example).

In this example, the CL Client runtime is acting incorrectly
in that it does not process the WAY request in parallel with 
waiting for the response to the call it issued, as evidenced 
by the comm failure behavior documented above (more about this
later).

The CL Client runtime is also incorrect in another sense, 
which requires a little more illustration.
In an atempt to fix the above problem, the VTS was modified, 
which allowed the following to take place (remember, this is 
an intermittant problem - it doesn't happen every time and it
doesn't happen in exactly the same way every time). RPC_DEBUG
produced some of the text shown on the right side, below:

VTS (as server)			CL Client Runtime

			<-----	send request, serial_lo = 0 

				(rpc__dg_xmitq_elt_xmit) request 49.0.0 len=16 frq
				(recv_state_timer) Starting to ping (rq->next_fragnum=0) [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]
			<-----	ping for response, serial_lo = 2
send WAY request	----->	
				(recv_state_timer) Re-pinging (rq->next_fragnum=0) [
send NOCALL with	----->
  optional body (ping 2)
				(rpc__dg_do_nocall) Has fack body [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]
				(do_fack-slow-q) frag 0, cws 0, bs 0, fo 0
				(stop_pinging) Next ping at: now = 4822, interval = 50 [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

			<-----	ping for response, serial_lo = 3
send NOCALL with	----->
  optional body (ping 3)
				(recv_state_timer) Starting to ping (rq->next_fragnum=0) [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]
			<-----	ping for response, serial_lo = 4
				(recv_state_timer) Re-pinging (rq->next_fragnum=0) [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

ping for WAY response	----->
			<-----	ping for response, serial_lo = 5
			<-----	NOCALL in response to WAY ping
send NOCALL with	----->
  optional body (ping 4)
				(rpc__dg_do_nocall) Transmit queue is empty [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

send NOCALL with	----->
  optional body (ping 5)
				(rpc__dg_do_nocall) Transmit queue is empty [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

resend WAY request	----->	
				(recv_state_timer) Re-pinging (rq->next_fragnum=0) [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

			<-----	ping for response, serial_lo = 6
send NOCALL with	----->
  optional body (ping 6)
				(rpc__dg_do_nocall) Transmit queue is empty [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

			<-----	ping for response, serial_lo = 7
send NOCALL with	----->
  optional body (ping 7)
				(rpc__dg_do_nocall) Transmit queue is empty [006975f8-2d23-1616-9c3b-0000c036d04c, 49.0]

			...
			<------ quit
			<------ quit
			<------ quit
			... comm failure

The odd thing is that sometimes sending the NOCALL from the VTS to
the CL Client runtime seems to work, and sometimes, like in this
example, it doesn't. 
When ping-ing the WAY request results in a NOCALL, resending the 
request doesn't work. 

The message "(rpc__dg_do_nocall) Transmit queue is empty" is generated 
at line 664 in dgclsn.c. At that place the function returns - before
it can stop pinging, as indicated in the comments. That means that 
the nocall PDU is not being interpreted correctly and that the correct
action - to stop pinging - is not happening. This may be ok but there
is still a WAY request outstanding that is not getting serviced.

Also, what happened to the PDU with serial_lo = 1?

I can provide packet dumps with lots more information, if required.

[12/21/93 public]

  >>  First of all, that business about resending the WAY request I mentioned 
  >>  above is plain wrong. The AES specifies that the correct response to a
  >>  ping PDU is a NOCALL PDU, with the optional body (see pg. 12-16 of the
  >>  AES/DC). But even when we do so, it can still fail.

No.  A 'nocall' is sent by a server when it has not received all of the
IN arguments to a call.  If the server has received *some* of the arguments,
it will send a 'nocall' with "optional body", indicating which packets it  
currently holds.  After all the arguments have been received, the correct 
response to a 'ping' is a 'working' packet.

The trace above show that the VTS server is confusing the client by saying
1) I got all the arguments to the call (via the optional body), and 2) I didn't
get all of the arguments to the call (by the fact that it's sending a 'nocall'.

[12/21/93 public]

We will try substituting a "working" for a "nocall" but I can't see how it
will correct the real problem we're seeing here: on an intermittant basis,
the CL client runtime is getting into a state where it can not respond to a 
WAY request. The first example shows that - there is no good reason why the
CL client should time out waiting for the response before it can send the 
WAY response.

[5/5/94 public]

Can we cancel this one?


[5/594 public]

The gray areas here were never clarified. Also, the VTS hasn't been run against
RPC recently (of particular interest would be any possible impact of the DG
performance enhancements). I recommend keeping this open as a place marker, at least 
until the VTS can be run against a 1.1 build.

[2/7/96 public]

Cancelled. This is a VTS bug. There is no gray area. VTS server is not
retransmitting a WAY request (often enough) when the packets get dropped.
If it happens again after fixing VTS, submit a new defect.



CR Number                     : 9565
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : ubik
Short Description             : ubik should not lose quorum because of slow beacon RPC
Reported Date                 : 12/1/93
Found in Baseline             : 1.0.3a
Found Date                    : 12/1/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[12/1/93 public]
There is a problem where, under stress, a beacon RPC can make a
connection to a remote server but the manager function on that end
takes a long time to start (O(50-100) seconds).  What then happens is
that when the manager process finally runs, it will look at its local
time and the timestamp in the RPC and think that there is a time skew.
It will then return USKEWED, which causes quorum to be immediately
lost at the sync site.  Even detecting that an RPC takes a long time
to run is not enough since the amount of time it takes the RPC to
succeed may be longer than the period the sync site is guaranteed
votes from the other servers (i.e. quorum could be lost during the
wait).  Another proposal is to increase the beacon interval.  This has
the effect of limiting the number of times the problem is seen because
there simply are fewer calls.
The proposed fix is to set a call timeout on the vote binding handles
to somewhere between RPC timeout and MAXSKEW.  A rpc_s_call_timeout
error code would then be converted into a NO vote from the slow
server.  On the slow server (the non-sync site), the beacon will
either be received, in which case, it will think there is a clock skew
and reset its state; or, it will not get the RPC.  In either case, it
should be able to properly recover.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[12/29/93 public]
Deferring this to 1.1. The ability of a multi-flserver dfs cell to
handle "stress" must be evaluated more closely - as well as the "stress"
produced by the CHO test. We have seen quorum problems in non-stress
scenarios but we can not reproduce them reliably enough to begin to
narrow down the problem.
 
Here is the result of Mark Karuzis' analysis of rpc logs produced during
quorum failures:
 
Received: from awol.ch.apollo.hp.com by amway id <AA02403@amway> Wed, 22 Dec 93 12:22:32 EST    
Received: by awol.ch.apollo.hp.com id <AA29816@awol.ch.apollo.hp.com>; Wed, 22 Dec 93 12:22:31 -0500    
From: markar@apollo.hp.com
Date: Wed, 22 Dec 93 12:22:30 EST
Subject: flserver quorum problem
To: dfs-drb@osf.org
 
I've gone through the RPC log files that were taken during a test of the
flserver quorum problem.  The logs show that several RPCs took longer than 
45 seconds to complete.  
 
There is no evidence from the log that these long-running calls were the
result of anything other than overburdened test systems (which is not
to say that there isn't some other explanation).  The logs show that 
packets are not being dropped, and the RPC queues (call and packet) are
not being overrun.  The only conclusive evidence from the logs is that,
during the periods when we see long-running calls, there are gaps in the
timestamps spit out by the runtime.  This indicates that either the 
runtime threads, or the process as a whole, is not getting an adequate
chance to run (to meet the timing constraints of the ubik vote protocol;
the calls run successfully from RPC's perspective.)
 
The following excerpt shows the sequence of events during one of the 'long
running calls'.  I've cleaned it up to make it a little more readable;  the
actual log contains [activity UUID, seq no.] information that allows the 
messages belonging to a single call to be isolated.  The time is in 1/5
seconds.
 
On the client side, the call looked like this:
 
send request
  >> [time: 112465] (rpc__dg_xmitq_elt_xmit) request 1229.0.0 len=24 frq
2 seconds later, start pinging
  >> [time: 112475] (recv_state_timer) Starting to ping (rq->next_fragnum=0) 
2 seconds later
  >> [time: 112487] (recv_state_timer) Re-pinging (rq->next_fragnum=0) 
6 seconds later
  >> [time: 112515] (recv_state_timer) Re-pinging (rq->next_fragnum=0)
4 seconds later (receives 'working' pkt for each ping))
  >> [time: 112534] (stop_pinging) Next ping at: now = 112534, interval = 50
  >> [time: 112534] (stop_pinging) Next ping at: now = 112534, interval = 50 
  >> [time: 112534] (stop_pinging) Next ping at: now = 112534, interval = 50 
13 seconds later
  >> [time: 112598] (recv_state_timer) Starting to ping (rq->next_fragnum=0) 
2 seconds later
  >> [time: 112608] (recv_state_timer) Re-pinging (rq->next_fragnum=0) 
4 seconds later
  >> [time: 112628] (recv_state_timer) Re-pinging (rq->next_fragnum=0) 
4 seconds later (receives 'working' packet for each ping)
  >> [time: 112648] (stop_pinging) Next ping at: now = 112648, interval = 150
1 second later
  >> [time: 112656] (stop_pinging) Next ping at: now = 112656, interval = 150 
  >> [time: 112656] (stop_pinging) Next ping at: now = 112656, interval = 150 
7 seconds later (receives response)
  >> [time: 112690] (rpc__dg_call_recvq_insert) recv resp 1229.0 8
Total time for the call was 45 seconds.  As far as the RPC runtime is 
concerned, this was a successful, although slow, call.  No packets were 
dropped.  
 
On the server side, things looked like this:
 
The request packet, and the first 3 pings are all queued up on the server by
the time the server reads in the request packet.  The client sent these packets
over a 10 seconds interval;  the server/node was apparently too busy for the
server to be able to read in these packets at the time they were received.
  >>  [time: 110145] (rpc__dg_call_recvq_insert) recv requ 1229.0 24
  >>  [time: 110145] (ping_common) Working
  >>  [time: 110145] (ping_common) Working
  >>  [time: 110145] (ping_common) Working
 
Inexplicably, the DG timer thread in the server is not run for 53 seconds.
There is also no evidence that *any* threads in this process ran during this
time period. (It is possible that the process was scheduled, but then, perhaps,
did some I/O, and got itself switched out again.)
 
When the server is rescheduled, the last three pings are finally read in, and
responded to.
  >>  [time: 110410] (ping_common) Working
  >>  [time: 110410] (ping_common) Working
  >>  [time: 110410] (ping_common) Working
 
And finally, the response is sent.
 
  >>  [time: 110447] (rpc__dg_xmitq_elt_xmit) response 1229.0.0 len=8 frq
 
Again, from the server's perspective, no packets were dropped, the call didn't
need to be queued (due to lack of call threads), and the call was serviced
successfully.
 
This trace was from the longest running call in the log.  There were many
other periods of time where calls took 20, 30, and 40 seconds to complete.
However, only when the call is involved in a ubik vote is the length of time
considered significant.
 
Given that we are not seeing any failures in the runtime, the question becomes
"is it reasonable to expect that the runtime can meet the timing constraints 
of the ubik protocol under the load imposed during this test?"
 
I don't know enough about the load on these machines to give an answer. 
 
    -- Mark Karuzis
       Open Systems Software Division
       Hewlett-Packard Company
       markar@apollo.hp.com

[2/19/96]
The load under which this test ran is too high for servers which depend
on RPC.



CR Number                     : 9558
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpcd
Short Description             : rpcd should return the non-zero exit status when it failed to start listening.
Reported Date                 : 11/29/93
Found in Baseline             : 1.0.3
Found Date                    : 11/29/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/rpcd/rpcd.c
Sensitivity                   : public

[11/29/93 public]

rpcd always returns the zero exit status unless -f or debug options are
specified. This behavior is unfriendly. It should return the non-zero exit
status if the child process failed to start listening so that dce_config
and rc.dce can easily determine the successful start of rpcd. (Even if this
gets fixed, rc.dce and dce_config should verify it by using rpccp.)

Also, rpcd should have an asynchronous signal handler to exit gracefully,
instead of just being killed.

Since rpcd will go away at DCE 1.1, dced should have these fixed in 1.1.

If anyone is interested, I have these fixes for rpcd.

[05/04/94 public]
The fixes Seiichi made to rpcd were passed along to the dced team.
these changes will not be made to rpcd for 1.1.
Canceled.



CR Number                     : 9532
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : cn
Short Description             : The pointer used after the deallocation
Reported Date                 : 11/22/93
Found in Baseline             : 1.0.3
Found Date                    : 11/22/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/runtime/cnassoc.c
Sensitivity                   : public

[11/22/93 public]

In rpc__cn_assoc_sec_free()::cnassoc.c, the security context element (*sec)
is dereferenced after it's free'ed. The calling sequence should be
reversed, i.e., call RPC_CN_AUTH_RELEASE_REFERENCE() before
rpc__list_element_free().

[11/22/93 public]

Again, I've already reported this in CR9328. Should check the existing
entries before opening a new one...



CR Number                     : 9530
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : common
Short Description             : Potential misuse of the pointer
Reported Date                 : 11/22/93
Found in Baseline             : 1.0.3
Found Date                    : 11/22/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/runtime/comif.c
Sensitivity                   : public

[11/22/93 public]

In unregister_if_entry()::comif.c, at line# ~908, the removed element's
next pointer is used to follow the link:

            /*
             * remove this entry from the list for this interface
             */
            RPC_LIST_REMOVE (if_entry->type_info_list, type_info);

            /*
             * save this entry and get the next one on the list
             */
            current_type_info = type_info;
            
            RPC_LIST_NEXT (type_info, type_info, rpc_if_type_info_p_t);

This works because RPC_LIST_REMOVE() macro does not destroy type_info->next
pointer. But it's not a safe way. It should use RPC_LIST_FIRST() macro
instead:

            RPC_LIST_FIRST
                (if_entry->type_info_list, type_info, rpc_if_type_info_p_t);

[11/22/93 public]

Oops, I've already reported this in CR9330.



CR Number                     : 9528
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : butc
Short Description             : butc coredumps restoring UFS fileset
Reported Date                 : 11/22/93
Found in Baseline             : 1.0.3
Found Date                    : 11/22/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[11/22/93 public]
While executing the command:
bak restoreft -server /.:/hosts/blizzard -aggregate /restore 
-fileset local.comps.dfs.dfssrc -extension .rest -tcid 1
butc coredumped with a SIGSEGV. 
The stack in dbx shows:
strlen() at 0xd00ce404
doprnt._doprnt(0x74696e2e, 0x0, 0x206f6620) at 0xd0366654
fprintf.fprintf(0x20060f28, 0x100ce203, 0x2051d860, 0x0, 0x0, 0x200a81e8, 0x200a
a0bc, 0x74696e2e) at 0xd037475c
LogTape(0x74696e2e, 0x0, 0x206f6620, 0x20060f28, 0x2014a580, 0x2051d60c, 0x69626
d2e, 0xd0368140) at 0x1000058c
Restorer(0x74696e2e) at 0x100b2734
cma__thread_base(0x74696e2e) at 0xd05d6650
I looked at the code for butc and it appears LogTape was passed the
incorrect number of parameters. Correcting this appears to fix the
problem.
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `jaffe@transarc.com' 
Added field #Transarc Status with value `open'

[11/22/93 public]
Filled in Interest List CC with `jaffe@transarc.com' 
Changed Responsible Engr. from `jaffe@transarc.com' to `khale@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[11/23/93 public]
Changed Status from `open' to `cancel' 
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `' 
Added field #Transarc Status with value `'



CR Number                     : 9526
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : rgy_edit policy sprintf incorrect
Reported Date                 : 11/22/93
Found in Baseline             : 1.0.3
Found Date                    : 11/22/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[11/22/93 public]
In rgy_edit module ek_util.c, routine integer32_to_string
the statement sprintf(int_str, "%d%", int32) appears to have an
extra % on the end.  I set the priority to low since it worked 
on pc486, but on our system it results in a null buffer. I believe
the format statement is invalid.

janet

[11/22/93 public]

according to my reading of the ANSI C standard, a "%\0" sequence is an
"invalid conversion specification", which means that its behavior is
"undefined".

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 9524
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : During config, dce_config fails to check AIX times correctly
Reported Date                 : 11/22/93
Found in Baseline             : 1.0.3
Found Date                    : 11/22/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/22/93 public]

  When configuring an AIX machine as a DCE client machine you will get
the following message if the time on the security server is ahead of the
AIX machine:

****** Time on soldier is forward by 
       -1 years 11 months -1 days 23 hours 58 minutes 59 seconds
       compared with time on west.

S:****** Time on soldier is not within specified tolerance (120 sec) of
         time on west.

        Do you want to synchronize soldier's system time to west (y/n)? (n)

soldier = RS/6000 AIX
west = HP 9000/710 HP-UX

root@soldier> rsh west date ; date
Mon Nov 22 11:39:56 EST 1993
Mon Nov 22 11:38:55 EST 1993

  If you get this message you should manually check that the AIX client
time is within 120 seconds of the security server, if it is, answer no
to "Do you want to synchronize soldier system time to west (y/n)?".  If
the times are not within 120 seconds of each other you should only cor-
rect the time on the AIX client to be the same as the time on the sec-
urity server, DO NOT change the time on the security server.  When you
are checking these times make sure to pay attention to the timezones
on each machine.

[11/22/93 public]

After trying a few things I found that this problem is caused by sh on AIX,
if I use a ksh it works fine:

root@soldier> sh
root@soldier> if [ 19931122153037 -lt 19931122153137 ]
> then
> echo 19931122153037 less than 19931122153137
> else
> echo 19931122153037 greater than 19931122153137
> fi
19931122153037 greater than 19931122153137

root@soldier> ksh
root@soldier> if [ 19931122153037 -lt 19931122153137 ]
> then
> echo 19931122153037 less than 19931122153137
> else
> echo 19931122153037 greater than 19931122153137
> fi
19931122153037 less than 19931122153137

If only /etc/dce_config was a ksh instead of sh!!

[03/28/94 public]
Not much I can do about a shell bug on AIX.
Suggested solution if to set the SYNC_CLOCKS environment variable to 'n'.
Canceled.

[03/28/94 public]
Why can't we change the default for /etc/dce_config to be a ksh?



CR Number                     : 9514
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : dns_reader() should signal cond. var. on error
Reported Date                 : 11/18/93
Found in Baseline             : 1.0.2a
Found Date                    : 11/18/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : directory/cds/library/dnsread.c
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[11/18/93 public]

In the dns_reader() routine of library/dnsread.c, the read failure case,
which is handled in the default clause following the return from the read,
does not signal any waiters on the condition variable. This may leave a
thread hanging in dns_read on a signal that never comes.

Here are context diffs for the change:

     *** /tmp/ci.29496..dnsread.c.29525.1       Fri Oct 22 14:00:52 1993
     --- /tmp/dnsread.c.29525.2 Fri Oct 22 14:00:52 1993
     ***************
     *** 1028,1037 ****
     --- 1028,1041 ----
             */
+	DNS_LOCK {
	   dns_reader_state = reader_rundown;
+	   if (Flags_p) pthread_cond_signal((pthread_cond_t*)&Flags_p->fsOpqDNS[OPQCND0]);
+	} DNS_END_LOCK;
            dns_reader_state = reader_rundown;
            close(dns_clerk_socket);
            dns_clerk_socket = -1;
            dns_pending_cleanup(DNS_SOCKET);
            status = read_none;
            break;
        }
        break;
           }

[5/26/94 public]
Unless this is demonstrated on a running system to find what
the real problem is, I would request that this report be cancelled.
I believe that the Flags_p mentioned is still on the cds_pending_p ring,
and the dns_pending_cleanup() call will cause all requests including
the one controlled by Flags_p to be signalled and terminated.

[6/3/94 public]
The customer (Hitachi) told me that they withdrew this change from their
own source base in Feb this year. Go ahead and cancel this.

[08/20/96 public]
Cancelling.



CR Number                     : 9513
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : dfs_config
Short Description             : CacheInfo should be created for in-memory cache.
Reported Date                 : 11/18/93
Found in Baseline             : 1.0.3
Found Date                    : 11/18/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Delta                : 
Transarc Herder               : 
Transarc Status               : 

[11/18/93 public]
The CacheInfo file is needed even when the cache is in memory.  Dfs_config
only creates it for the on-disk cache.
Added field Transarc Delta with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[11/18/93 public]
What version of dfs_config are you using?  This was fixed in the
OSF dfs_config on 10/5.  Cancelled.



CR Number                     : 9511
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : read_only property obsolete but still displayed/changeable.
Reported Date                 : 11/18/93
Found in Baseline             : 1.0.3
Found Date                    : 11/18/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[11/18/93 public]
I changes the properties to make the registry a read-only registry
and the added a principal. It seems that this should fail. Here is
the output from what I did:

2154 ->rgy_edit
Current site is: registry server at /.../agony.cell/subsys/dce/sec/master 
rgy_edit=> do p
Domain changed to: principal
rgy_edit=> pr
  Properties:
    Properties for Registry at:               /.../agony.cell
    Registry is NOT read-only
    Certificates to this server may be generated at any site.
    Encrypted passwords are hidden
    Unix IDs ARE embedded in PGO UUIDs
    Low UID for principal creation:           2598
    Low UID for group creation:               200
    Low UID for org creation:                 100
    Maximum possible UID:                     32767
    Minimum certificate lifetime              5m
    Default certificate lifetime              10h
Do you wish to make changes [y/n]? (n) y
Stamp registry read-only [y/n]? (n) y
Should encrypted passwords be hidden [y/n]? (y) 
Lower bound on principal unix id for automatic UID assignment: (2598) 
Lower bound on group     unix id for automatic UID assignment: (200) 
Lower bound on org       unix id for automatic UID assignment: (100) 
Maximum allowable unix id: (32767) 
Minimum certificate lifetime (minutes): (5m) 
Default certificate lifetime (hours): (10h) 
rgy_edit=> add j
rgy_edit=> v
nobody                                        -2
root                                           0
daemon                                         1
sys                                            2
bin                                            3
uucp                                           4
who                                            5
mail                                           6
tcb                                            9
dce-ptgt                                      20
dce-rgy                                       21
cell_admin                                   100
krbtgt/agony.cell                           2598
hosts/agony/self                            2599
hosts/agony/cds-server                      2600
hosts/agony/gda                             2601
hosts/yale/self                             2602
hosts/yale/cds-server                       2603
hosts/yale/gda                              2604
hosts/agony/dfs-server                      2605
j                                           2606

[11/18/93 public]
I've checked with those who did the replication work and my hunch was
correct.  This property was obsoleted as of 1.0.2 because: it does only a
subset of what the sec_admin 'state -maintenance|-service' functionality
gives you, and isn't really useful since it doesn't make sure the db is
written to disk for backup purposes...  Unfortunately, it wasn't removed
from the docs (our doc writer has opened a separate CR to address that) and
it still displayed and changeable via rgy_edit.  This CR is now against
rgy_edit (to get rid of both display and change of that prop field)...

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 9494
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : gds
Subcomponent Name             : 
Short Description             : gds build is broken
Reported Date                 : 11/16/93
Found in Baseline             : 1.0.3
Found Date                    : 11/16/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/16/93 public]

While I setted up the new RIOS machine (orange) for building dce
the build break at in the ...../directory/gds/stub/  directory.

-------- here is the build.log for that directory  ----------

xlc -c       -DCSTUB -DDCESHARED_PATH=\"/opt/dce\" -DDCELOCAL_PATH=\"/opt/dceloc
al\" -D_POSIX_SOURCE -D_ALL_SOURCE -DAIX32   -I. -I/u1/devobj/dce103a/src/direct
have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 73.50: 150
6-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 91.50: 150
6-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 95.50: 150
6-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 100.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 105.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 118.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 123.50: 15
15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 185.42: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 189.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 194.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 198.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 285.50: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 290.15: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 290.45: 15
06-126 (S) Expression must have a constant value.
"/project/dce/build/dce1.0.3a/src/directory/gds/stub/d24stev.c", line 294.50: 15
06-126 (S) Expression must have a constant value.
*** Error code 1

Stop.
*** Error code 1

Stop.

[11/29/93 public]
I checked the sandbox on Orange in which this error occured.  The first
thing I noticed is that the sources were out-of-date:  11/8.  Secondly, it
has been proven that GDS builds on RIOS for the 1.0.3 release and no
changes have been made in 1.0.3a which would affect GDS. I don't believe
this error occurs.

Since no RIOS builds are currently being done for 1.0.3a I am cancelling
this defect.  If the problem reoccurs in the next RIOS 1.0.3a build with
current sources then it can be re-opened.



CR Number                     : 9489
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : gdscstub or dua
Short Description             : apps don't exit
Reported Date                 : 11/15/93
Found in Baseline             : 1.0.3
Found Date                    : 11/15/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/15/93 public]
While cleaning up from a 48 hour run of gds_xds_str_001, I noticed that
some Dir-User processes were running on the test systems.  In examining the
output from ps, I saw that there were some xt_test programs hanging around
from Nov. 12.  The test driver, being message driven, did not clean up
these processes when they hung, which indicates that they executed all
of the specified GDS operations, and printed a "success" message to the
log file.  This is consistent with what xdb reports as being the point of
the hang (obtained on an HP via xdb -P <pid> ):

>trace
 0 _end + 0x40085ba0 (0x1, 0x4003d5dc, 0x4003d5dc, 0)
 1 _end + 0x40017790 (Bad access to child process (UE308)

The disassembled code looks like this

r0  00000000 000024b5 800af213 00000000 r4  00000000 00000000 00000000
00000000
r8  00000000 00000000 00000000 00000000 r12 00000000 00000000 00000000
00000000
r16 00000000 00000000 00000000 7af5cf84 r20 7afec080 81345170 00000000 0000
      0x800af1ec   _end    +40085b7c   STWS    25,4(0,3)
        0x800af1f0   _end    +40085b80   LDW     32(0,4),20
        0x800af1f4   _end    +40085b84   STWS    20,8(0,3)
        0x800af1f8   _end    +40085b88   LDW     -84(0,30),2
        0x800af1fc   _end    +40085b8c   LDW     -60(0,30),4
        0x800af200   _end    +40085b90   BV      0(2)
        0x800af204   _end    +40085b94   LDWM    -64(0,30),3
        0x800af208   _end    +40085b98   BL      0x800af248,2
        0x800af20c   _end    +40085b9c   OR      0,0,0
 >      0x800af210   _end    +40085ba0   LDW     -24(0,30),2
        0x800af214   _end    +40085ba4   LDSID   (0,2),1
        0x800af218   _end    +40085ba8   MTSP    1,0
        0x800af21c   _end    +40085bac   BE,N    0(0,2)
        0x800af220   _end    +40085bb0   BL      0x800af248,2
        0x800af224   _end    +40085bb4   OR      0,0,0
        0x800af228   _end    +40085bb8   LDW     -24(0,30),2
        0x800af22c   _end    +40085bbc   LDSID   (0,2),1
        0x800af230   _end    +40085bc0   MTSP    1,0
        0x800af234   _end    +40085bc4   BE,N    0(0,2)

I found two of these hung processes on one machine, and one on another.  I
suspect the DUA in the xt_tester is missing some message from the C-Stub
(for instance: hey, it is okay to exit, I verified the workspace is 
shutdown, or something) that it needs to exit.  This is logged with 
a relatively low sev/prio so that it does not hold ship for 1.0.3, but this
should be looked into.

[7/11/94 public]
This should be fixed for 1.1

[8/18/94 public]
We've never been able to reproduce this with the FVTs.  We're just starting
a cycle of the system tests again now so the priority will be dropped while
we wait to reproduce the problem.  Of course, if it's not reproduced this
defect will be cancelled.

[9/30/94 public]
We haven't seen this in a very long time, so I'm cancelling this.



CR Number                     : 9478
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : can newaggr -overwrite mounted filesystem
Reported Date                 : 11/11/93
Found in Baseline             : 1.0.3
Found Date                    : 11/11/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[11/11/93 public]
Done accidentally on HP, reproduced on RIOS. I was glad that my
hfs filesystem had NOT been blown away by the newaggr but surprised
that having the filesystem mounted was not protection enough - and
further surprised that fts create succeeds as does cd/ls/mkdir
commands to the mounted hfs filesystem - I only caught my error
when I went to dfsexport my hfs filesystem as a native filesystem
and saw that it was already dfsexported as lfs. I've entered this
as a B2 because it was admin error but pretty easy and potentially
very painful.

[11/12/93 public]
Filled in Interest List CC with `jdp@transarc.com' 
Changed Responsible Engr. from `jaffe@transarc.com' to `comer@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[11/12/93 public]
newaggr has protections built in against running newaggr on an
*attached* fileset.  Doing this requires an interlock that we can do
(and, in fact, do do) with Episode that we can't do with the native
file system.  This is a prime candidate for an enhancement a vendor
can make to better integrate DFS into the OS.  This is not something
we can do for a reference port, however.  I've changed this CR to an
enhancement request, but I doubt we will be able to do anything on it.
Changed Defect or Enhancement? from `def' to `enh'

[12/16/93 public]
Decided in today's meeting to defer to 1.1.

[3/21/94 public]
This was fixed under 9791.  cancelled.

[3/21/94 public]
Fixing the header above.



CR Number                     : 9475
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : gdsditadm
Short Description             : bogus defect
Reported Date                 : 11/10/93
Found in Baseline             : 1.0.3
Found Date                    : 11/10/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/10/93 public]
Sorry, OT wouldn't let me abort the creation of this defect.



CR Number                     : 9473
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : Can't delete directory
Reported Date                 : 11/10/93
Found in Baseline             : 1.0.3
Found Date                    : 11/10/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/10/93 public]
After having run the GDS switch tests I was trying to cleanup the CDS
namespace prior and was unable to remove a directory.

  cdscp> list dir /.../c=ie/o=digital/sales
			  LIST
		     DIRECTORY   /.../c=ie/o=digital/sales
			    AT   1993-11-10-14:59:38
  sales
  cdscp> del dir /.:/sales/
  
  cdscp> show dir /.:/sales/sales
  
			  SHOW
		     DIRECTORY   /.../c=ie/o=digital/sales/sales
			    AT   1993-11-10-15:00:07
  Error on entity: /.../c=ie/o=digital/sales/sales
  Requested entry does not exist (dce / cds)
  Function: dnsEnumAttr
  dnsEnumAttr: partial results = /.../c=ie/o=digital/sales

A description of the DCE cell configuration can be found in section 5.6.3
of the DCE1.0.3 Porting Guide (or 5.6.4 of the DCE1.0.2 Porting Guide --
it really didn't change.).  A script is provided below to configure the
GDS cache.  GDS switch tests are found in the dcetest install tree in:

  install/hp800/dcetest/dce1.0/test/directory/xds/tests.switch

Here is the GDS initialization script.  This can be used instead of
instructions provided in the Porting Guide.  To initialize the GDS cache,

	1.  Use gdsyssadm option 'c' to configure 
	2.  Use gdssysadm option 'b' to activate
	3.  Exit gdssysadm
	4.  gdsditadm < <name-of-file-you-saved-the-script-in>

Note: you will need to change the IP address in the script to be that of
the machine on which you are reproducing the defect.

The script:

:******************************************************************************:
:****                                                                     *****:
:**** INITIALIZATION BATCHFILE FOR switch tests                           *****:
:****                                                                     *****:
:****  1. initialize cache of dir ID 1                                    *****:
:****                                                                     *****:
:******************************************************************************:
:**** INITIALIZATION BATCHFILE FOR MACHINE #1   (step 1/4)                *****:
:directory id:1
:password:
:Country:
:Organisation:
:Organisational unit:
:common name:
:options():Logon to the DUA Cache
:****Administration ****:
:Function:1
:****Add Client Address *******:
:Operation:05
:P-Selector:
:S-Selector:
:T-Selector:Client
:Net-address 1:TCP/IP!internet=130.105.5.41+port=21010__________________
:Net-address 2:
:Net-address 3:
:Net-address 4:
:Net-address 5:
:****AddObject  ie/digital/dce/dsa/dsa-m1 *******:
:Operation:01
:Objekttypnummer:07
:country:ie
:organization:digital
:OrganizationalUnit:dce
:Common-Name:dsa
:Common-Name:dsa-m1
:ObjectClass:DSA
:Auxiliary Object class:NO
:Attribute Name1:Presentation-Address
:Attribute Name2:DSA-Type
:Attribute Name3:
:Attribute Name4:
:Attribute Name5:
:More:
:attributName:DSA-Type
:attributwert:default/local'
:attributwert:
:attributName:
:attributwert:
:attributwert:
:attributName:
:attributwert:
:attributwert:
:P-Selector:
:S-Selector:
:T-Selector:Server
:Net-address 1:TCP/IP!internet=130.105.5.41+port=21011___________________
:Net-address 2:
:Net-address 3:
:Net-address 4:
:Net-address 5:
:******** RETURN ******:
:operation:00
:**** Administration ****:
:Function:0

[11/10/93 public]
>  cdscp> list dir /.../c=ie/o=digital/sales
>                          LIST
>                     DIRECTORY   /.../c=ie/o=digital/sales
>                            AT   1993-11-10-14:59:38
>  sales
>  cdscp> del dir /.:/sales/
>
>  cdscp> show dir /.:/sales/sales
>
>                          SHOW
>                     DIRECTORY   /.../c=ie/o=digital/sales/sales
>                            AT   1993-11-10-15:00:07
>  Error on entity: /.../c=ie/o=digital/sales/sales
>  Requested entry does not exist (dce / cds)
>  Function: dnsEnumAttr
>  dnsEnumAttr: partial results = /.../c=ie/o=digital/sales
>
Maybe I missed something, but /.:/sales has been removed and what
was "show dir /.:/sales/sales" (I guss you mean "show dir /.:/sales")
going to show you? If you type "list show dir /.:/sales" 
after "del dir /.:/sales", I believe it'll return nothing.

[11/11/93 public]
The command 
cdscp list dir /.../c=ie/o=digital/sales
will list the directory /.../c=ie/o=digital/sales as sales. If
you want to see what directories currently exist in a directory do
cdscp list dir /.../c=ie/o=digital/sales/*
The delete command is probably telling the truth 
/.../c=ie/o=digital/sales/sales does not exist.



CR Number                     : 9408
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : mx300
S/W Ref Platform              : sinix
Component Name                : gds
Subcomponent Name             : 
Short Description             : LIBS does not work in SVR4 specific Makefiles
Reported Date                 : 11/9/93
Found in Baseline             : 1.0.3
Found Date                    : 11/9/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 
Fixed In Baseline             : 
Affected File(s)              : gds/SVR4/adm/admin/Makefile
					     gds/SVR4/cacheadm/admin/Makefile
Sensitivity                   : public

[11/9/93 public]
The tag LIBS must be replaced by gdsditadm_LIBS, resp. gdscacheadm_LIBS
in the specified Makefiles. Otherwise, the libraries are not taken
during linking.

[11/11/93 public]
Howard Melman was right. This was a stupid error in the SNI Munich common
makefile. Therefore canceled.



CR Number                     : 9406
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : the -po subcommand does 
not work when displaying groups.
Reported Date                 : 11/8/93
Found in Baseline             : 1.0.3
Found Date                    : 11/8/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/8/93 public]

The -po subcommand should work with groups and organizations as 
described in the Admin Guide pg. 22-3 (Section 22.2). The example
in this section depicts a group. 

In practice, I get the following:

rgy_edit=> do group
Domain changed to: group
...
< Some standard accounts deleted >
...
subsys/dce/cds-server                        125
subsys/dce/dts-servers                       126
Systest                                      127
rgy_edit=> v Systest
Systest                                      127
rgy_edit=> v Systest -f
Systest                                      127
  Full name:  dce1.0.3 systest
  Uuid:       0000007f-dc78-21cc-b201-080009320e26
  Primary:  pr   Reserved:   --
  Project List:l   
rgy_edit=> v Systest -m
Systest                                      127
  1 members
    marta
rgy_edit=> v Systest -po
?(rgy_edit) "-po" - Option not valid in group domain
rgy_edit=> 

Is the code does not support this subcommand then this CR 
should be changed to Doc.

NOTE: I made a mistake sending this - I realized the doc and core correct.



CR Number                     : 9401
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : rpc/sys_idl/nbase.idl
Short Description             : error_status_t defined as unsigned long
Reported Date                 : 11/8/93
Found in Baseline             : 1.0.3
Found Date                    : 11/8/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/8/93 public]
When ported to a 64-bit platform (such as Alpha), this produces
copious warnings when compiled under code cleanup guidelines.
It is unacceptable for switch() statements, which are restricted to int.
It should instead be defined as unsigned32.

[11/8/93 public]
My face is red... The issue is not 64 bits. Let's go back to basics.
Our cleanup effort led to try to build on the 486 with all those
required gcc switches. Lo and behold, the following:

int
cds_convert_rpc_status ( commStatus )
    error_status_t      commStatus;
{
    int status;

    switch ( commStatus )	/* line 343 */
.
.
.
}

produces an error:

/project/dce/build/dce1.0.3/src/directory/cds/child/clerk_miscel.c:343: warning:
 `long' switch expression not converted to `int' in ANSI C

Is everyone going to have to cast these things to int?

[11/8/93 public]
This seems to be a benign warning from gcc.  In ANSI any integral type can
be used as an expression in a switch statement.  GCC is just telling you
about this.  I expect that it is the -Wtraditional switch that is causing
this.  If you remove this switch do the errors go away?  

There have been other problems with the use of this switch, so far I know
of no legitimate bug that it has found.  DEC is the furthest along in the
code cleanup, have you found any good reason to keep using this switch?  If
you say no, I'm tempted to stop using it.

[11/9/93 public]
I looked through the gcc sources, and I find the following messages which
could come from -Wtraditional:

c-decl.c        c declarations
  function `%s' was previously declared within a block
        * A function declared external in one block and then used after
          the end of the block.

c-lex.c         c lexical scanner
  the meaning of `\\x' varies with -traditional
  the meaning of `\\a' varies with -traditional
        * The character escape sequences `\x' and `\a' evaluate as the
          literal characters `x' and `a' respectively.  Without
          `-traditional', `\x' is a prefix for the hexadecimal
          representation of a character, and `\a' produces a bell.
  width of integer constant changes with -traditional
        * Integer types `unsigned short' and `unsigned char' promote to
          `unsigned int'. (-traditional)
  integer constant is unsigned in ANSI C, signed with -traditional
   * `-2147483648' is positive.
     This is because 2147483648 cannot fit in the type `int', so
     (following the ANSI C rules) its data type is `unsigned long int'.
     Negating this value yields 2147483648 again.
  width of integer constant may change on other systems with -traditional

c-typeck.c      type checking
  `long' switch expression not converted to `int' in ANSI C
        * A `switch' statement has an operand of type `long'.

[05/04/94 public]
Looking a nbase.idl, we have:
typedef unsigned long   unsigned32;         /* positive 32 bit integer */
typedef unsigned long   error_status_t;

So changing error_status_t to be defined as unsigned32 would not help
this warning.  I don't think we are going to declare it to be
an int, so I think the answer is: Yes, anyone who uses an error_status_t
in a switch will have to cast it.

Defect canceled.



CR Number                     : 9395
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : config/dce_config
Short Description             : dce_config doesn't know when remove has failed
Reported Date                 : 11/8/93
Found in Baseline             : 1.0.3
Found Date                    : 11/8/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/8/93 public]
I just got this transcript.  Notice that dce_config claims that the remove
was successful despite the errors.

        selection:  6
    REMOVE will remove the node's ability to operate in the cell.
   A reconfiguration of the node will be required.  If this is not
   a server node, then this node should be unconfigured before a
   REMOVE is done.  Do you wish to continue (y/n)? (n) y
S:****** Attempting to stop all running DCE daemons...

      Enter Cell Administrator's principal name: (cell_admin) 
      Enter password: 

NFS server blind not responding still trying
NFS server blind not responding still trying
NFS server blind ok
xargs: rm not executed or returned -1
xargs: rm not executed or returned -1
S:****** Successfully stopped all running DCE daemons.
S:****** Attempting to remove all remnants of previous DCE
configurations...
xargs: rm not executed or returned -1
xargs: rm not executed or returned -1
rm: Directory /opt/dcelocal/var/dfs/aggrs is not empty.
rm: Directory /opt/dcelocal/var/dfs is not empty.
xargs: rm not executed or returned -1
xargs: rm not executed or returned -1
S:****** Successfully removed all remnants of previous DCE configurations
for all components.

[11/15/93 public]
Since I've seen no activity on this, I assume I must assign an engineer.

[2/6/96 public]
Not enough information provided. Why these NFS access messages are poing
up? dcelocal is supposed to be local to the machine. Cancelling this defect.
If this error shows up, provide details from /tmp/dce_config.log



CR Number                     : 9389
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 5915
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpcd
Short Description             : rpc_ep_unregister() fails
Reported Date                 : 11/5/93
Found in Baseline             : 1.0.3
Found Date                    : 11/5/93
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/5/93 public]
The first part of relocating a clearinghouse is performing a
"cdscp clear clearinghouse" command. during execution of this command,
the clearinghouse endpoint is supposed to be removed from the mapper.
Our calls to rpc_ep_unregister() fail with 382312662:
"not registered in endpoint map (dce / rpc)". The endpoint remains
intact, and when the local clerk tries to access the relocated
clearinghouse, the outdated referral to the local server produces an
unexpected error code which terminates the search, thus not reaching
the new home for the clearinghouse.

I have verified that the information passed to the unregister is
the same as that provided to the previous register request.

[11/8/93 public]

You are seeing the result of OT7174 fix. Are you sure that you are passing
the exactly same interface specification, binding handle vectors and object
UUID vectors? Both rpc_ep_register() and rpc_ep_unregister() create a cross
product from these vectors and add/remove each element in the cross
product. If you are doing:

  rpc_server_use_*protoseqs*();
  rpc_server_inq_bindings(&binding_vector,);
  rpc_ep_register();

  rpc_server_use_*protoseqs*();
  rpc_server_inq_bindings(&binding_vector,);
  rpc_ep_unregister(,binding_vector,,);

the vector of binding handles returned from the fisrt
rpc_server_inq_bindings() call and the one from the second call are likely
different.

[11/8/93 public]
We just did the test over, checking the results with rpccp, and the entry
points go away! So the bug becomes that we get the phony status code.
We are dropping the priority to a minor nuisance.
 As to the comment above, I am using exactly the same binding vector for
both the register and unregister commands.

[11/8/93 public]

I don't think that rpcd returned the phony status code. What happened was
that between the call to rpc_ep_register() and rpc_ep_unregister() someone
else did remove the endpoint(s) registered by the clearinghouse. See my
comment in OT7174. If this defect is going to be kept open, it should be
addressed by 1.1 dced's endpoint mapper.

As for the original cdsclerk problem, is cdsclerk doing
rpc_binding_reset()? Otherwise, it may have a stale endpoint.

[8/15/94 public]
CDS should ignore an 'endpoint not registered' error status.
Note that in 1.1, cdsd complains on shutdown that something it
is trying to unregister is no longer in the endpoint map.

Could cdsadv be removing any endpoints?

The CDS people should re-open this if they can prove the ep_unregister
is returning a bad status code on an existing endpoint.



CR Number                     : 9384
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config - rc.dce
Short Description             : deleting a security replica leaves the file /etc/rc.dce out of date.
Reported Date                 : 11/5/93
Found in Baseline             : 1.0.3
Found Date                    : 11/5/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : /etc/rc.dce
Sensitivity                   : public

[11/5/93 public]

Deleting a security replica leaves the file /etc/rc.dce out of date on the 
host on which the replica was deleted. Thus, the next time /etc/rc.dce runs, 
it tries to start secd giving the following error:

        /opt/dcelocal/bin/secd
Registry: Fatal Error - Cannot initialize server database
 at line 366 of file /project/dce/build/dce1.0.3-snap/src/security/server/rs/rs_main.c - 0x1712207a - Registry object not found (dce / sec)

[03/28/94 public]
What do you mean, 'deleting a security replica'?
Can dce_config do this operation?  If you did this by hand, you must also
modify /etc/rc.dce by hand.

I am going to cancel this defect, please reopen if you can point to a place
where dce_config might make rc.dce consistant.



CR Number                     : 9365
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : cache manager
Short Description             : assertion failure in cm_setattr
Reported Date                 : 11/4/93
Found in Baseline             : 1.0.3
Found Date                    : 11/4/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : unknown
Sensitivity                   : public

[11/4/93 public]

Here's a test that panics the kernel:

	(1) Set up a UFS filesystem to be DFS exported, say /u3.
	(2) Create a DFS mount point for this filesystem, say /:/u3
	(3) Have a sandbox on another UFS partition (which is not
		DFS exported), say /u1/sb.
	(4) make a symbolic link /u1/sb/install -> /:/u3/install.
	(5) cd to /u1/sb/src and execute the following script:

#!/bin/ksh
typeset -i k=5

while (( (k=(k-1)) >= 0 ))
do
        echo $k
        build -k install_all >> LOG$k 2>&1 &
done

The system runs anywhere from 1 to 20 minutes before a panic.  The
panic is always in cm_setattr, line 1820:

	lock_ReleaseWrite(&scp->llock);

This is a macro which expands to:

#define lock_ReleaseWrite(lock)\
        BEGINMAC\
	    osi_assert((lock)->excl_locked == WRITE_LOCK); \
	    (lock)->excl_locked &= ~WRITE_LOCK;\
	    if ((lock)->wait_states) Lock_ReleaseR(lock);\
        ENDMAC

It is the above osi_assert which is failing.

[12/15/93 public]

Bug status is now closed, since two days of testing have not
reproduced this bug in 1.0.3a.

[12/15/93 public]

Changed status to 'cancel' since we don't really know what changed.



CR Number                     : 9362
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit complains of unknown default cell
Reported Date                 : 11/4/93
Found in Baseline             : 1.0.3
Found Date                    : 11/4/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/4/93 public]


I'm getting unknown cell errors from acl_edit when trying
to acl_edit a directory in DFS.  This does not happen with
every DFS directory.


# ls
chmodtest  getset     inherit    sizetest   syscalls
# cd chmodtest
# ls
testdir2
# acl_edit testdir2
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce / s
ec)
INFO: Local cell will be used for operations requiring default cell info.
sec_acl_edit> l

# SEC_ACL for testdir2:
# Default cell = 007f6dd6-eae0-1c95-aa4c-02608c2f6c55
mask_obj:r-x---
unauthenticated:r-----
user_obj:rwxcid
user:000000cd-9a5a-2cb1-a300-02608c2f6c55:r-x--d        #effective:r-x---
group_obj:rw----        #effective:r-----
group:00000070-9a42-2cb1-a301-02608c2f6c55:rw--i-       #effective:r-----
other_obj:r-----
sec_acl_edit> exit
# pwd
/.../headache.qadce.osf.org/fs/alcatraz.epi1/dfs-test/acl/scratch.bad/chmodtest
# getcellname
/.../headache.qadce.osf.org
#



This happens consistently with this one particular directory.

[11/4/93 public]

Cancelling - this is just what happens when one
reconfigures a cell and tries to use the old filesets
and aggregate which have ACLs on them.



CR Number                     : 9354
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : ros
Short Description             : New ROS 2.5a Version for DME
Reported Date                 : 11/4/93
Found in Baseline             : 1.0.3
Found Date                    : 11/4/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : files in nosupport area
Sensitivity                   : public

[11/4/93 public]
I want to submit a new version of ROS (2.5a), that will be used by DME.
The files will be in a separate directory, so they won't interfere with
the DCE ROS files.

Rich, I don't know, if it is allowed to submit these files to the
dce1.0.3 backing build, because they should belong to an unintegrated
OSF dce1.0.3 delivery.
If not, please tell me how I can send the files to you.

[11/11/93 public]
Two compressed tar files had been copied to the /afs/dce/project/dce/sni
directory: rosdme.tar.Z and rosdmetest.tar.Z .
The contents of these tar files should be integrated into the nosupport
area of DCE1.0.3 by OSF.

Delivery was necessary, because DME is using a specific management
profile ( AOM 12 ) for CMIP, that is not supported in the official
DCE1.0.3 ROS delivery.
For DCE1.1, a combined version will be delivered.

[11/12/93 public]
SNI wasn't ready to submit the code before the 1.0.3 freeze so it will be
incorporated into the 1.0.3 by tarring a copy into the source tree.  Since
this does not represent any change in the DCE source tree this defect is
cancelled.



CR Number                     : 9351
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : dts api
Short Description             : utc_mkbin*time accepts NULL pointers as input
Reported Date                 : 11/3/93
Found in Baseline             : 1.0.3
Found Date                    : 11/3/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : common/utcapi.c
Sensitivity                   : public

[11/3/93 public]
utc_mkbin*time accepts NULL pointers as input for *utc, *timesp
and *inaccsp.
I have added
	if (utc == NULL || timesp == NULL || inaccsp == NULL)
		return (-1);
at the beginning of each of the two routines.

[11/04/93 public]
When I first joined OSF, IBM had opened a handful of OT reports on various
parts of the DTS API taking NULL parameters.  We decided, way back then,
that checking for NULL is *not* something DCE code should be doing.
Passing in a NULL pointer is a programming error.  Many experienced
programmers would rather see an immediate core dump then an obscure
run-time error.

This "defect" should be cancelled.

[11/04/93 public]
Sorry, but as Rich says, we don't check for NULL pointers 
(and its a religious argument).  Jim Wade submitted a bunch of these
types of bugs, and we consolodated them all in to a enhancement
request which would verify a utc_t value.  Not much help for this
particular instance, but....

Anyway, we understand if IBM wants this in their code, but we usually
don't do it in ours.

Canceled.



CR Number                     : 9346
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7530
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv won't spawn new clerks
Reported Date                 : 11/3/93
Found in Baseline             : 1.0.3
Found Date                    : 11/3/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/3/93 public]
During today's dfs smoketest, cdsadv would not spawn clerks for non-root
users. A root clerk existed and worked fine. Cdsadv was not built with
debug so attaching useless. Killing and restarting the
cdsadv got rid of the problem so there was no chance to catch
events file. This did not appear to be a "process table full" or
other resource limitation problem since I was able to start other
processes. Assigned to myself - I'll watch for it.

[11/5/93 public]
After rebooting my rios and restarting my dce client, I ran into this
same problem.  I could not get cdsadv to spawn a clerk.  I was running
as root.

Killing and restarting cdsadv fixed the problem.  I too was not built
debug, so I could not attach.  Prior to being rebooted the cleint was
in a dceseact system test for 12 hours.

[11/5/93 public]
Thanks for the update Gerry - so this is not HP-specific then? If you hit
this again, debug or no, can you see if, in your case, this is specific to
root (a clerk that was definitely running at one time) or is it that the
cdsadv won't spawn ANY clerks? Thanks again.

[7/6/94 public]
Not seen since and not enough info in this CR to make it worth keeping
open ... cancelling.



CR Number                     : 9345
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : kinit
Short Description             : kinit fails after tickets expire
Reported Date                 : 11/3/93
Found in Baseline             : 1.0.3
Found Date                    : 11/3/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/3/93 public]

Rajendra reported this via mail; he should have opened a defect report
instead, so I'm doing this for him..

It appears that a recent change to sec_login code by MDF broke kinit when
the login context has already expired.

This is a regression from 1.0.2, and this functionality is necessary, hence
an A0 priority on this.

[11/3/93 public]

never mind; rajendra did open a defect on this.



CR Number                     : 9320
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : src/directory/gds/nds
Short Description             : libNDS not installed in DCE cell
Reported Date                 : 11/2/93
Found in Baseline             : 1.0.3
Found Date                    : 11/2/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : libNDS.a, libNDS.so, libNDS.sl
Sensitivity                   : public

[11/2/93 public]

Although the libNDS library builds & installs during the build of DCE,
it doesn't install (in /opt/dcelocal) during installation & configuration
of a DCE cell.

[11/2/93 public]
That's because you aren't installing GDS as part of the daily smoketesting.



CR Number                     : 9319
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : config
Short Description             : epidaemon start fail message
Reported Date                 : 11/2/93
Found in Baseline             : 1.0.3
Found Date                    : 11/2/93
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : rc.dfs
Sensitivity                   : public

[11/2/93 public]
on the rios machines a start of dce/dfs always
complains that epidaemon start failed

the daemonrruning routine is trying to determine if
it started by doing a ps operation, seems the
epidaemon is never in the ps list...

this is annoying and causes the process to prompt
the user before continuing with the dce/dfs start

[11/2/93 public]
This was fixed on 10/5.  Do you have the latest release of rc.dfs?
I'll assume you didn't and cancel this bug.  If you did, and the
problem still occurs, please re-open.  Thanks.



CR Number                     : 9304
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : secd
Short Description             : secd coredumps after having
been restarted without the -restore_master, following a restore...
Reported Date                 : 11/1/93
Found in Baseline             : 1.0.3
Found Date                    : 11/1/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/1/93 public]

On a cell where one security replica has been configured,
the failure to restart secd with the -restore_master flag, after 
having restore a backup of the resgistry, causes secd to coredump.

The following error is left on the screen by secd before dying.

Registry: Error - Slave update seqno is later than the master's.
Registry: Fatal Error - This master's database is an obsolete
 at line 1127 of file /project/dce/build/dce1.0.3-snap/src/security/server/rs/rs_log.c

If secd is started with the -restore_master all works well. 
I found this problem while running the replica_checklist.

[8/4/94 public]
Refer to CR #11261 for related info.  One thing  is that none
of these scenarios should result in a core dump.  If a user specifies
incorrect flags, a graceful exit should occur...

[8/10/94 public]
The propagation code properly aborts if it finds that it is
trying to propagate to a replica with a higher seqno.  The same
code is used for the very first propagation when bringing up
a master, as well as for all the usual propagation activity.
Admittedly it would be nice if this code could be aware of the
fact that the master is just coming up and give an appropriate
message without dumping the core. The administrator could then
decide which version of the registry should prevail and either
trnasform the more recent replica into a master (if the replica's
db is preferable) or launch secd with the -master_seqno flag
if the master's database has to override the replica's.
Thus I am going to cancel this ot defect report and file an
enhancement.



CR Number                     : 9298
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : ros
Short Description             : Fatal error in ROS
Reported Date                 : 11/1/93
Found in Baseline             : 1.0.3
Found Date                    : 11/1/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/1/93 public]
gdsstub and gdscstubs are dying with the following error message:
   d25raction.c(154): FATAL ERROR: ROS-function failed.

A DCE cell and GDS had been configured for the DUA switch tests on an HP/UX
machine. Both DCE and GDS were brought down and a fresh set of binaries
where installed.  Configuration for both DCE and GDS were preserved.  DCE
cell was restarted.  GDS was activated.  The Sstub died immediately.

Logs will be placed in the AFS cell.

[11/1/93 public]
Logs are in /afs/dce/project/dce/sni/OT9298

[11/1/93 public]
Just went through a cycle of ten activation/de-activations of GDS.  8 times
the gdssstub died, and twice the gdscstub died.  Cstub log contained the
same error message identified above.

Tracing was not turned on.

[11/1/93 public]
Forgot to mention:  latest cycle of testing was done on a fresh set of
binaries (built 10/30) and a fresh configuration.  Reminants of old
configuration were removed.

[zeliff 11/1/93 public] 
There is some evidence that the failure was caused by user error during the
initialization of GDS.  However, if this was the case then why did the
problem re-occur after the re-install which removed the reminants of the
old configuration?  (This was done by answering 'y' to the dce_config
prompt which provides this service.)

In any case, I physically removed the old dcelocal directory (rm -rf is
your friend) and reinstalled everything from scratch.  Problem no longer
occurs. 

Will leave this open for another couple of days.  If it doesn't reoccur I
will cancel it.

[11/2/93 public]
Cancelled and dce.rm defect 9314 opened.



CR Number                     : 9297
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : gdssstub
Short Description             : Sstub dies during weekend in
quiescent cell.
Reported Date                 : 11/1/93
Found in Baseline             : 1.0.3
Found Date                    : 11/1/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/1/93 public]
On Friday I configured a DCE and GDS cell on an HP for the running of the
DUA Switch tests.  I did not, however, run the tests but simply left the
cell in place over the weekend.  On Monday morning I discovered the S-stub
had disappeared.

I've logged this bug against all platforms because I have seen evidence of
similar problems on other platforms.

Date of the gdssstub binary is from nightly build of 10/28.

[11/3/93 public]
Could not reproduce.  Cancelled.  Believed to have been caused by bad cache
initialization.



CR Number                     : 9296
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : mhs tests
Short Description             : 2 mhs/valid tests fail, all platforms
Reported Date                 : 10/29/93
Found in Baseline             : 1.0.3b8
Found Date                    : 10/29/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/29/93 public]

The tests/directory/xds/tests.mhs/valid/add_entry32v and search16v fail
consistently on all platforms.  I will put xt_test -d, dsa, and dua logs
for each test into /afs/dce/project/dce/sni/OTxxxx, where xxxx is the
number assigned to this bug.  Meantime, here's the two xt_test.logs:

add_entry32v:

: BEGIN Include ../tree/build_tree4

: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name1
: 	entry = attribute_list8
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name2
: 	entry = attribute_list1
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name4
: 	entry = attribute_list3
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: Error occured in Include ../tree/build_tree4

: END Include ../tree/build_tree4


: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list4
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name8
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name7
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name16
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name18
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name19
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name20
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name49
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name50
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name77
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name78
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name8
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name7
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name16
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name18
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name19
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name20
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name49
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name50
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name77
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name78
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: BEGIN Include ../tree/delete_tree4

: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name4
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name2
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name1
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: Error occured in Include ../tree/delete_tree4

: END Include ../tree/delete_tree4


: TESTCASE add_entry32v FAILED

 

and search16v:

: BEGIN Include ../tree/build_tree4

: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name1
: 	entry = attribute_list8
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name2
: 	entry = attribute_list1
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name4
: 	entry = attribute_list3
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: Error occured in Include ../tree/build_tree4

: END Include ../tree/build_tree4


: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list4
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name8
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name7
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name16
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name18
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name19
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name20
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name49
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name50
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name77
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name78
: 	entry = attribute_list52
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function SEARCH : 
: 	session = bound_session1
: 	name = name1
: 	subset = DS_WHOLE_SUBTREE
: 	filter = filter11
: 	search_aliases = FALSE
: 	selection = entry_info_selection1
: 	call ds_search()
: 	(NOTICE) total_number from om_get for r_result = 2
: 	(WARNING) more attributes of type 723 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 709 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	(WARNING) more attributes of type 713 received than expected
: 	expected & received search-result same
: 	ds_search() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name8
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name7
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name16
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name18
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name19
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name20
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name49
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name50
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name77
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name78
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: BEGIN Include ../tree/delete_tree4

: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name4
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name2
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name1
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: Error occured in Include ../tree/delete_tree4

: END Include ../tree/delete_tree4


: TESTCASE search16v FAILED

[11/3/93 public]
Could not reproduce.



CR Number                     : 9290
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : low test8 fails during cho
Reported Date                 : 10/29/93
Found in Baseline             : 1.0.3b8
Found Date                    : 10/29/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/29/93 public]


Low test8 fails rather consistently when run from a RIOS client
to an HP server on an Episode filesystem.  This failure happens
during cho.

There are 2 failures:

# fgrep ERROR low.test8.log
- ERROR 47: dup st_compare(F2.1000.777) failed failed; errno = 13
- ERROR: prog8 process 2 returned 1
- ERROR 45: st_compare(f0.111) failed failed; errno = 17
- ERROR: prog8 process 2 returned 1
#


This is a priority 0 since it prevents CHO from running sucessfully.

[10/31/93 public]

Can you run this test with debug turned on?  From looking at the test, I
believe the errno 13 and 17 don't have anything to do with anything.  With
debug turned on we will be able to see what st_compare thought was wrong.

Has this ever worked?  Did it just start failing recently?  Does it fail at
Transarc?  The only relevant recent change is one I made in
src/file/cm/cm_vnodeops.c in order to fix another low/test8 problem on HP.
My change just used code provided by Transarc as an answer to OT 7969.  At
the time I made this change I did not understand how AIX did not get the
same error as HP.  I still do not understand.  I also do not know how
Transarc found the problem since AIX did not exhibit it.  I mention this
because my non-understanding of AIX may also explain the current failure.

[11/1/93 public]

I haven't seen this particular failure before, and I tried to reproduce
it outside of CHO and was unable to .  I recompiled test8 with debug
turned on and haven't seen the problem yet since restarting CHO.

[11/5/93 public]

Cancellling -I've ben running test8 now during the last 5 days and have
not seen this again.



CR Number                     : 9286
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : rpc
Subcomponent Name             : 
Short Description             : rpc__socket_inq_endpoint gets incomplete info from getsockname
Reported Date                 : 10/28/93
Found in Baseline             : 1.0.3
Found Date                    : 10/28/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/runtime/*/comsoc_sys.c
Sensitivity                   : public

[10/28/93 public]

There is evidence (at least in the FTX environment) that getsockname of
a UNIX domain socket which has not been bound to an address will return 0
 (==> ok) without returning the associated naf id.

The consequence in terms of the rpc implementation, is that a call to
rpc__naf_is_connect_closed  (in runtime/comnaf.c) which calls
rpc__socket_inq_endpoint (in runtime/SVR4/comsoc_sys.c) which calls
getsockname such that the naf is not assigned, will lead to a misvectoring
by rpc__naf_is_connect_closed and probably a core dump. 

Although we have not been able to find documentation which specifically
states what the behavior of getsockname should be under these
circumstances, it seems that although an address may not have been bound,
the address family was clearly specified at the time the socket was
created, and should be made available by getsockname.

In any event, if the getsockname does not return the naf, additional
checking should be inserted in the rpc__socket_inq_endpoint to make sure
that a ligitimate address family is returned, or an error should be
returned.

The priority has been set low because this problem has not been reported on
any of our reference platforms. FTX is an SVR4 system, so we should at least
test the behavior of getsockname on our SVR4 reference platform.

I have asked Abbey what the expected behavior of getsockname is on sinix,
and depending on the outcome this report may be targeted more specifically.

I made it an enhnacement request instead of a defect report, because even
if the getsockname does the right thing on most systems. knowledge that it
misbehaves in some environments might inspire us to add a little
checking to our implementations of rpc__socket_inq_endpoint.

[10/29/93 public]

The current implementation of DCE RPC supports IP NAF (AF_INET) only. It
does not support the Unix domain (AF_UNIX) socket. It never open the Unix
domain socket. If Stratus is implementing Unix NAF (it's even not a network
address family, but local.), they are on their own. This is not an only
problem with AF_UNIX, but there are other problems.

[10/29/93 public]

My mistake, the problem was not reported with any specific family, I
incorrectly attributed the problem to UNIX domain sockets. I wasn't sure
what types of sockets RPC employed, but I went ahead and conducted an
experiment to see what getsockname returns for an unbound socket, and the
results indicate that there probably is a problem in our code.

It appears that in in many cases (and in many environments) getsockname does
not modify the family component of sockaddr. What you get is what you
gave getsockname.

The following program demonstrates this point.

#include <sys/types.h>
#include <sys/socket.h>
#include <errno.h>

#define rpc_c_naf_id_ip                 AF_INET
#define rpc_c_network_if_id_stream      SOCK_STREAM
#define rpc_c_network_if_id_dgram       SOCK_DGRAM
#define rpc_c_network_protocol_id_tcp   6
#define rpc_c_socket_ok 0

void main()
{
     int                 sock;
     int                 status;
     struct sockaddr     addr;
     unsigned            length;

     addr.sa_family = -1;

     if ((sock = socket(AF_INET, SOCK_DGRAM, 0)) == -1)
       printf("socket(AF_INET, SOCK_DGRAM, 0); failed\n");
     else if (getsockname(sock, &addr, &length) == -1)
       printf("getsockname failed, errno:%d\n",errno);
     else printf("address family: %d\n",addr.sa_family);

     addr.sa_family = -1;

     if ((sock = socket(AF_UNIX, SOCK_DGRAM, PF_UNSPEC)) == -1)
       printf("socket(AF_UNIX, SOCK_DGRAM, PF_UNSPEC); failed\n");
     else if (getsockname(sock, &addr, &length) == -1)
       printf("getsockname failed, errno:%d\n",errno);
     else printf("address family: %d\n",addr.sa_family);

     addr.sa_family = -1;

     if ((sock = socket(rpc_c_naf_id_ip, rpc_c_network_if_id_stream,
         rpc_c_network_protocol_id_tcp)) == -1)
       printf("socket(rpc_c_naf_id_ip, rpc_c_network_if_id_stream, \
         rpc_c_network_protocol_id_tc); failed\n");
     else if (getsockname(sock, &addr, &length) == -1)
       printf("getsockname failed, errno:%d\n",errno);
     else printf("address family: %d\n",addr.sa_family);
}

Outputs: Note that 65535 and 255 are different representations of the
         -1 that was assigned before the call to getsockname (the family
         id is unsigned and of differing sizes).      

HPUX:

	address family: 65535
	address family: 65535
	address family: 65535
	$

RIOS:
	address family: 255
	address family: 255
	address family: 255
	$

PMAX/OSF1:

	address family: 2
	address family: 65535
	address family: 65535
	$

SINIX:
	Segmentation Fault - core dumped

	(I'm waiting for SNI to give us a better result).

Proposed Enhancement:

	in rpc__socket_inq_endpoint, initialize addr.sa_family to
	AF_UNSPEC /* unspecified */ before calling getsockname,
        and test that addr.sa_family < AF_MAX after returning from
        getsockname.

[10/29/93 public]

Sorry, your test program doesn't initialize length=sizeof(addr). Also,
depending on the protocol family, you must use the different structure for
addr, i.e., struct sockaddr_in for AF_INET, to have enough space for
address. (Though you can get the address family by using struct sockaddr.)

[10/29/93 public]

thaks for attending to this so quickly, I have made the corrections
you pointed out, and the program demonstrates that getsockname
does set family to an appropriate value. These changes also corrected
core dump on sinix, and sinix returned

        address family: 2
        address family: 0
        address family: 2

I will ask submitter to run the test program on their machine.
It is probably safe to close this defect.

[11/10/93 public]

The following additional information was provided by the submitter:

AF_INET, SOCK_STREAM

the problem we have seen at Stratus (on their svr4 based port of DCE)
is actually that getsockname
returns 0 with an invalid address family when the connection is closed by
the other end.  When this happens, a T_DISCON_IND is received by sockmod,
and sockmod in turn send an M_ERROR streams message upstream to set the
write error on the socket to EPIPE.  Since getsockname must write to the
stream in order to obtain the infomation from sockmod, it fails with EPIPE
internally and the error code is not passed back to the application.

In any case, using the returned naf id as an index to an epv table without
checking wether it's valid or not does not appear to be a good idea to me.
Although we have got the problem fixed in our getsockname, performing the
ckeck should only provide a degree of robustness to the DCE applications.

[11/10/93 public]

How do you check if the returned naf id is valid or not? The returned
addr->sa (garbage) from getsockname() may have a valid id. The callers of
rpc__naf_desc_inq_naf_id() always check the returned status. If we can't
trust the status back from the syscalls, how can we code?

Clearly Stratus's socket implementation is broken because getsockname()
returns zero when it shouldn't. (errno should be set to EINVAL, I believe.)
I think that they should fix it or implement their own
rpc__socket_inq_endpoint(), which is the system dependent function. (Is OSF
going to ensure the portability of DCE onto broken systems? :-)

[05/04/94 public]
Going to have to go with Seiichi on this one.  Stratus has a broken
socket interface and it isn't DCE's fault.  Also, these routines
are machine dependant, and all the reference platforms work, so
its the vendors responsibility to rewrite this code as necessary
for their platforms.

Canceled.



CR Number                     : 9276
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : mhs tests
Short Description             : Tests report errors, yet PASS
Reported Date                 : 10/27/93
Found in Baseline             : 1.0.3b8
Found Date                    : 10/27/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/27/93 public]

The xds/tests.mhs tests report errors in ../tree/{build,delete}
routines, but the tests including them "Pass".  Here's an
example log frag:

: BEGIN Include ../tree/build_tree8

: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name1
: 	entry = attribute_list8
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name2
: 	entry = attribute_list1
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name4
: 	entry = attribute_list3
: 	call ds_add_entry()
: 	(ERROR) expected and received DS_status from ds_add_entry differ
: 	ADD_ENTRY returned ERROR

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name8
: 	entry = attribute_list4
: 	call ds_add_entry()
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: Error occured in Include ../tree/build_tree8

: END Include ../tree/build_tree8


: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function ADD_ENTRY : 
: 	session = bound_session1
: 	name = name78
: 	entry = attribute_list55
: 	call ds_add_entry()
: 	(NOTICE) total_number from om_get for r_status = 2
: 	expected and received DS_status from ds_add_entry same
: 	ds_add_entry() returned OK

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: BEGIN Include ../tree/delete_tree8

: Function INITIALIZE : 
: 	call ds_initialize ()
: 	ds_initialize did not return NULL
: 	ds_initialize() returned OK

: Function VERSION : 
: 	feature_list = feature_list1
: 	workspace = workspace1
: 	call ds_version()
: 	expected and received DS_status from ds_version same
: 	ds_version() returned OK

: Function BIND : 
: 	session = default_session
: 	workspace = workspace1
: 	call ds_bind()
: 	expected and received DS_status from ds_bind same
: 	ds_bind() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name8
: 	call ds_remove_entry()
: 	expected and received DS_status from ds_remove_entry same
: 	ds_remove_entry() returned OK

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name4
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name2
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function REMOVE_ENTRY : 
: 	session = bound_session1
: 	name = name1
: 	call ds_remove_entry()
: 	(ERROR) expected and received DS_status from ds_remove_entry differ
: 	REMOVE_ENTRY returned ERROR

: Function UNBIND : 
: 	session = bound_session1
: 	call ds_unbind()
: 	expected and received DS_status from ds_unbind same
: 	ds_unbind() returned OK

: Function SHUTDOWN : 
: 	workspace = workspace1
: 	call ds_shutdown()
: 	expected and received DS_status from ds_shutdown same
: 	ds_shutdown() returned OK

: Error occured in Include ../tree/delete_tree8

: END Include ../tree/delete_tree8


: TESTCASE add_entry30i PASSED

[11/3/93 public]
Could not reproduce.



CR Number                     : 9273
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : Replication
Short Description             : Master secd hangs and goes
into infinite loop while sending error message to the console.
Reported Date                 : 10/27/93
Found in Baseline             : 1.0.3
Found Date                    : 10/27/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/27/93 public]

Using builds available on 10/24, configured the Master and slaves.
The Master secd hanged and sent error messages to the console.
Details are as follows:

1. Configured a Master server on HP/UX.
2. Configured a slave on RIOS.
3. Configured another slave on 486.
4. Put the Master in Maintenance through sec_admin.
5. Got out of sec-admin session.
6. Invoked rgy_edit and tried to add a principal while master was in maint.
7. Got out of rgy_edit session.
8. Invoked sec_admin and it hung.
  Started seeing messages continuously on the window where Master secd was 
  configured with error 22 (defined as  EINVAL- Invalid argument )      

# SECD prop_driver_sleep - error from pthread_cond_timedwait (errno 22)SECD
prop_driver_sleep - error from pthread_cond_timedwait (errno 22)SECD
prop_driver_sleep - error from pthread_cond_timedwait (errno 22)SECD
prop_driver_sleep - error from pthread_cond_timedwait (errno 22)SECD
prop_driver_sleep - error from pthread_cond_timedwait (errno 22)SECD

9. Had to kill Master secd through kill command.
10. Once Master secd was killed, sec_admin invocation returned.

[10/29 93 public]
Liza did some investigation on this bug and found the following:
- replication code appears to be ok.
- Sekhar has tested sec_admin maintenance/service command extensively
  with HP's product during system testing and it always worked.
Keeping this CR open for time being and lowering Priority/Severity.

[8/4/94 public]
Old bug, may be gone.  Max will attempt to reproduce.

[8/18/94 public]

Followed above steps to try to reproduce the bug with the last good
build (bld 14.3).  Things worked as they were supposed to.  Hit on
sec_admin and the replicas a bit more.  No problems.  I'll cancel
this tomorrow if nobody objects.



CR Number                     : 9263
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : 
Short Description             : dfsexport detach panic's machine
Reported Date                 : 10/26/93
Found in Baseline             : 1.0.3
Found Date                    : 10/26/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/26/93 public]

on rios machine w/aggrs m1.aggr1, m1.aggr2
performed fts move of fileset m1.lfs1 on
m1.aggr1 to m1.aggr2 apparently while low
tests were running from dfs client machine
on m1.aggr1

performed dfsexport -detach of m1.aggr1 /dev/epi1
which failed

stopped low tests  
performed dfsexport -detach /dev/epi1 again
machine panic'd

probably wasn't such a nice thing to move an
aggregate that was in use or dfsexport -detach 
one that was in use but not sure a panic should
occur as the result of these operations 

heres the crash trace:
> proc -r
SLT ST    PID   PPID   PGRP   UID  EUID  PRI   CPU   EVENT  NAME
  2 r      202     0     0     0     0   127   120          wait
        FLAGS: swapped_in no_swap fixed_pri kproc
0452-220: Cannot read process table entry  54.
0452-220: Cannot read process table entry  62.
0452-220: Cannot read process table entry  84.
0452-220: Cannot read process table entry  93.
0452-220: Cannot read process table entry  95.
100 r     64c4  62f4  64c4     0     0    60    57          dfsexport
        FLAGS: swapped_in
0452-220: Cannot read process table entry 101.
0452-220: Cannot read process table entry 103.
0452-220: Cannot read process table entry 104.
0452-220: Cannot read process table entry 105.
0452-220: Cannot read process table entry 110.
0452-220: Cannot read process table entry 111.
0452-220: Cannot read process table entry 113.
0452-220: Cannot read process table entry 114.
0452-220: Cannot read process table entry 115.
0452-220: Cannot read process table entry 116.
0452-220: Cannot read process table entry 117.
0452-220: Cannot read process table entry 118.
0452-220: Cannot read process table entry 119.
0452-220: Cannot read process table entry 120.
0452-220: Cannot read process table entry 121.
0452-220: Cannot read process table entry 122.
0452-220: Cannot read process table entry 123.
0452-220: Cannot read process table entry 124.
0452-220: Cannot read process table entry 125.
0452-220: Cannot read process table entry 126.
0452-220: Cannot read process table entry 127.
> trace 100
STACK TRACE:
        .brkpoint ()
        [dcelfs.ext:epig_CloseAggregate] ()
        [dcelfs.ext:ag_efsDetach] ()
        [dfscore.ext:ag_PutAggr] ()
        [dfscore.ext:afscall_aggr] ()


I also have dump file if you'd like

[10/26/93 public]

I've tried the low tests as well as parallel tar's all running in
a loop while executing dfsexport -detach and fts move.  The fts
move simply locks the fldb entry and blocks for some fileset
internal state, and the dfsexport -detach always correctly
fails with an error about a busy aggregate.  Since I can't
reproduce this bug I am cancelling it.



CR Number                     : 9256
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : dtsd core dump
Short Description             : dtsd dumped core during dcetmsyn system test
Reported Date                 : 10/26/93
Found in Baseline             : 1.0.3
Found Date                    : 10/26/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/26/93 public]

While running the dcetmsyn system test using the nightly build available on
10/25/93, dtsd dumped core after running for 16 hours.  The dtsd process had
been up for 18 hours.  I have the core saved in:

	soldier:/opt/dcelocal/var/adm/time/core.save

[10/26/93 public]

Also, soldier is configured as a DTS Local Server in a 13 machine cell
with two other local servers, one HP-UX and one OSF/1.

[10/26/93 public]
I can't debug this:
root@soldier> dbx /bin/dtsd core.save
dbx version 3.1 for AIX.
Type 'help' for help.
core.save does not contain a stack (core ignored)
reading symbolic information ...

I will try to remember the 'smit' magic which will produce useable
core files on a RIOS, and do said magic to soldier.

[10/28/93 public]

Cancelled, I fixed two problems (1 - infinite growing inaccuracy caused by
invalid ntp server, 2 - set ulimits to unlimited) and successfully executed
the dcetmsyn system test for 48 hours.  I'm not sure what caused the core
dump but it is not reproduciple.



CR Number                     : 9250
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : cn
Short Description             : Timer thread uses the assoc after freeing it
Reported Date                 : 10/25/93
Found in Baseline             : 1.0.3
Found Date                    : 10/25/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/runtime/cnassoc.h
                                             rpc/runtime/cnassoc.c
Sensitivity                   : public

[10/25/93 public]

rpc__cn_assoc_reclaim() function MAY use the assoc after deallocating it.
Here is the code fragment from rpc__cn_assoc_reclaim():

                        /*
                         * Done with the shutdown attempt, so decrement the
                         * reference count. This is done via the acb dealloc
                         * routine.
                         */
                        rpc__cn_assoc_acb_dealloc (assoc);
                    }
		    if (loop == false && shutdown_or_abort == true)
			return;
                    RPC_LIST_NEXT (assoc, assoc, rpc_cn_assoc_p_t);
                } /* end while (assoc != NULL) */

If the call to rpc__cn_assoc_acb_dealloc() actually deallocates the assoc
(frees it or returns it to the lookasisde list), RPC_LIST_NEXT() will use
the already deallocated assoc. OT7504 fix eliminates this possibility when
the assoc was shutdown or aborted. However, there is still a chance that
acb_ref_count goes down to zero when rpc__cn_assoc_acb_dealloc() is called
in other cases. (It's a rare case, which happens only when there are thread
context switches before calling rpc__cn_assoc_acb_dealloc() and the
receiver thread releases the reference to the assoc. And even if this
happens assoc->next is still likely pointing to the right place.)

The proposed fix is to make rpc__cn_assoc_acb_dealloc() return a boolean
indicating if it called rpc__list_element_free().

In cnassoc.h line# ~384, change the signature:

PRIVATE boolean32 rpc__cn_assoc_acb_dealloc PROTOTYPE ((
    rpc_cn_assoc_p_t            assoc));

In rpc__cn_assoc_acb_dealloc()::cnassoc.c at line# ~4176, change the the
signature:

PRIVATE boolean32 rpc__cn_assoc_acb_dealloc (assoc)

at line# ~4184, after "rpc_cn_call_rep_t *call_r;", add:

    boolean32                   dflag = false;

and at line# ~4311, after the call to rpc__list_element_free(), add:

        dflag = true;

In rpc__cn_assoc_reclaim()::cnassoc.c at line# ~4036, change:

                        /*
                         * If the assoc has been deallocated, don't continue.
                         * There is a chance that the thread context switch
                         * happened.
                         */
                        if (rpc__cn_assoc_acb_dealloc (assoc) == true)
                            return;

I've found this by the code review and have no test for this. Thus the
priority is 2 (not a stopper for 1.0.3 :-).

[10/25/93 public]
Would this be a better fix for 9090 than passing a cancel up from
the list_free routine?

[10/25/93 public]

Definitely not. Whether rpc__list_element_free() is called or not is
irreverent for OT9090. It is whether rpc__cn_assoc_acb_free() is called or
not.

Well, after opening this CR, I've found the error in my logic. It is
impossible for the receiver thread to decrease the acb_ref_count because
the timer thread is holding the global mutex. So, this can happen only if
acb_ref_count was already zero when the timer thread incremented it, which
means that there was an unused assoc on the grp_assoc_list. The
grp_assoc_list corruption has occurred before the timer thread's execution.
Looks like this CR is going to be cancelled...

[8/16/94 public]
Since Seiichi says it should be canceled....



CR Number                     : 9244
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9212
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : AFSCALL_NEWTGT
Short Description             : AFSCALL_NEWTGT with exp. time  zero should terminate PAG
Reported Date                 : 10/22/93
Found in Baseline             : 1.0.3
Found Date                    : 10/22/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : file/cm/cm_xsyscalls.c
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[10/22/93 public]
 
This is a prerequisite for fixing CR9212 in security.
 
afs_syscall(AFSCALL_NEWTGT, pag, 0) should cause DFS to stop using any
connections authenticated as `pag', so that
kdestroy/sec_login_purge_context prevent future file system operations from
continuing using the purged credentials.

[10/22/93 public]
 
Mail from CFE claims that this is already there in the code.
 
"Never Mind".
Changed H/W Ref Platform from `hppa' to `all' 
Changed S/W Ref Platform from `hpux' to `all' 
Changed Affected File from `file/cm/cm_???' to `file/cm/cm_xsyscalls.c' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'



CR Number                     : 9233
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : XDS tests
Short Description             : threads_up tests fail on UX
Reported Date                 : 10/21/93
Found in Baseline             : 1.0.3b8
Found Date                    : 10/21/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/21/93 public]

when running the threads_up xds tests on HPUX, with DSA-M1 on the tester
UX machine, and DSA-M2 on AIX, many threads fail many tests, or
not diffently, with DS-status differ messages. 
I will put an XDS, DSA and LOG out into the dce cell at
/afs/dce/project/dce/sni/OTxxxx, where xxxx is  the OT number assigned to
this report.  NOTE THAT THEY WILL NOT match the enclosed log, since it
fails differently each time one runs it.

Here's a log frag:

crown treff% cd /u1/treff/tst/xds/tests.xds/threads_up
crown threads_up% setenv D2_LOG_DIR /u1/treff/tst/results/xds/xds
crown threads_up% touch $D2_LOG_DIR/threads_up.new
crown threads_up% foreach i (`ls T*`)
? ../../xt_test -t $i >> $D2_LOG_DIR/threads_up.new
? end
crown threads_up% cat $D2_LOG_DIR/threads_up.new
Directory tester: threads version 2.0t [Oct 20 1993  21:46:45]

[1]STARTadd_entry32v(startup):

[1]STARTadd_entry32v(startup): Opening Include file ../tree/build_tree4

[1]STARTadd_entry32v(startup): INITIALIZE returned OK

[1]STARTadd_entry32v(startup): VERSION returned OK

[1]STARTadd_entry32v(startup): BIND returned OK

[1]STARTadd_entry32v(startup): ADD_ENTRY returned OK

[1]STARTadd_entry32v(startup): ADD_ENTRY returned OK

[1]STARTadd_entry32v(startup): ADD_ENTRY returned OK

[1]STARTadd_entry32v(startup): UNBIND returned OK

[1]STARTadd_entry32v(startup): SHUTDOWN returned OK

[1]STARTadd_entry32v(startup): Exiting Include file ../tree/build_tree4

[1]STARTadd_entry32v(startup): INITIALIZE returned OK

[1]STARTadd_entry32v(startup): VERSION returned OK

[1]STARTadd_entry32v(startup): BIND returned OK

[1]Testcase STARTadd_entry32v(startup) passed

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[17]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[17]BODYadd_entry32v:  Func xt_run : Function call FAILED

[17]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[17]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[17]BODYadd_entry32v:  Func xt_run : Function call FAILED

[17]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[17]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[17]BODYadd_entry32v:  Func xt_run : Function call FAILED

[17]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[17]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[17]BODYadd_entry32v:  Func xt_run : Function call FAILED

[17]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v: ADD_ENTRY returned OK

[19]BODYadd_entry32v: ADD_ENTRY returned OK

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v: ADD_ENTRY returned OK

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v: ADD_ENTRY returned OK

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v: ADD_ENTRY returned OK

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v: ADD_ENTRY returned OK

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[17]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[17]BODYadd_entry32v:  Func xt_run : Function call FAILED

[17]BODYadd_entry32v: ADD_ENTRY returned ERROR

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[22]BODYadd_entry32v: ADD_ENTRY returned ERROR

[15]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[15]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[15]BODYadd_entry32v:  Func xt_run : Function call FAILED

[15]BODYadd_entry32v: ADD_ENTRY returned ERROR

[21]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[21]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[21]BODYadd_entry32v:  Func xt_run : Function call FAILED

[21]BODYadd_entry32v: ADD_ENTRY returned ERROR

[18]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[18]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[18]BODYadd_entry32v:  Func xt_run : Function call FAILED

[18]BODYadd_entry32v: ADD_ENTRY returned ERROR

[20]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[20]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[20]BODYadd_entry32v:  Func xt_run : Function call FAILED

[20]BODYadd_entry32v: ADD_ENTRY returned ERROR

[23]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[23]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[23]BODYadd_entry32v:  Func xt_run : Function call FAILED

[23]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[19]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[19]BODYadd_entry32v:  Func xt_run : Function call FAILED

[19]BODYadd_entry32v: ADD_ENTRY returned ERROR

[19]Testcase BODYadd_entry32v failed

[16]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[16]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[16]BODYadd_entry32v:  Func xt_run : Function call FAILED

[16]BODYadd_entry32v: ADD_ENTRY returned ERROR

[16]Testcase BODYadd_entry32v failed

[24]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[24]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[24]BODYadd_entry32v:  Func xt_run : Function call FAILED

[24]BODYadd_entry32v: ADD_ENTRY returned ERROR

[17]BODYadd_entry32v: ADD_ENTRY returned OK

[17]Testcase BODYadd_entry32v failed

[22]BODYadd_entry32v:  Func xt_cmp_status : DS_SUCCESS expected, error received

[22]BODYadd_entry32v:  Func xt_ds_add_entry : expected and received DS_status differ

[22]BODYadd_entry32v:  Func xt_run : Function call FAILED

[10/22/93 public]
The success of the thread_up tests is NOT guaranteed (up stands for
unpredictable). The reason for the existence of these tests is to test,
if they will crash the directory service processes, and is not test of
the proper functionality.
OSF should have a description of this in the latest porting and testing
guide. Anyway, Rudi Wildgruber will check, if the guide has to be updated
and will make a copy available.

[10/22/93 public]
Ohhh, it's _supposed_ to work that way.  Kind of an _odd_ test . . .
Cancelled.



CR Number                     : 9231
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : xds tests
Short Description             : threads_os tests fail, all platforms
Reported Date                 : 10/21/93
Found in Baseline             : 1.0.3b8
Found Date                    : 10/21/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/21/93 public]


When running the threads_os tests on an HPUX, with DSA-M1 on HPUX and
DSA-M2 on AIX, using the script:

# touch $D2_LOG_DIR/threads_os.log
# foreach i (`ls T*`)
? ../../xt_test -t $i >> threads_os.log
? end
#

too many threads pass on what appears to be ALL of the tests -- only one thread
per test is supposed to pass.  Each time the test is run, different
threads pass/fail differently.  I enclose a log frag from one of the test 
runs; an XDS log, dua log, and dsa log will be put in the cell at
/afs/dce/project/dce/sni/OTxxxx, where xxxx is whatever OT number gets
assigned to this report.  NOTE THAT THEY WILL NOT MATCH THIS LOG, since
they were generated by an earlier run.

*****stuff deleted *****

 [1]STARTmod_entry1v(startup):

 [1]STARTmod_entry1v(startup): Opening Include file ../tree/build_tree8

 [1]STARTmod_entry1v(startup): INITIALIZE returned OK

 [1]STARTmod_entry1v(startup): VERSION returned OK

 [1]STARTmod_entry1v(startup): BIND returned OK

 [1]STARTmod_entry1v(startup): ADD_ENTRY returned OK

 [1]STARTmod_entry1v(startup): ADD_ENTRY returned OK

 [1]STARTmod_entry1v(startup): ADD_ENTRY returned OK

 [1]STARTmod_entry1v(startup): ADD_ENTRY returned OK

 [1]STARTmod_entry1v(startup): UNBIND returned OK

 [1]STARTmod_entry1v(startup): SHUTDOWN returned OK

 [1]STARTmod_entry1v(startup): Exiting Include file ../tree/build_tree8

 [1]STARTmod_entry1v(startup): INITIALIZE returned OK

 [1]STARTmod_entry1v(startup): VERSION returned OK

 [1]STARTmod_entry1v(startup): BIND returned OK

 [1]Testcase STARTmod_entry1v(startup) passed

 [17]BODYmod_entry1v: MODIFY_ENTRY returned OK

 [18]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [18]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [18]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [18]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [19]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [19]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [19]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [19]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [20]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [20]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [20]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [20]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [21]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [21]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [21]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [21]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [16]BODYmod_entry1v: MODIFY_ENTRY returned OK

 [22]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [22]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [22]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [22]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [23]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [23]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [23]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [23]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [24]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [24]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [24]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [24]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [18]BODYmod_entry1v: READ returned OK

 [18]Testcase BODYmod_entry1v failed

 [19]BODYmod_entry1v: READ returned OK

 [19]Testcase BODYmod_entry1v failed

 [20]BODYmod_entry1v: READ returned OK

 [20]Testcase BODYmod_entry1v failed

 [21]BODYmod_entry1v: READ returned OK

 [21]Testcase BODYmod_entry1v failed

 [16]BODYmod_entry1v: READ returned OK

 [16]Testcase BODYmod_entry1v passed

 [25]BODYmod_entry1v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [25]BODYmod_entry1v:  Func xt_ds_modify_entry : expected and received DS_status differ

 [25]BODYmod_entry1v:  Func xt_run : Function call FAILED

 [25]BODYmod_entry1v: MODIFY_ENTRY returned ERROR

 [17]BODYmod_entry1v: READ returned OK

 [17]Testcase BODYmod_entry1v passOBed

 [22]BODYmod_entry1v: READ returned OK

 [22]Testcase BODYmod_entry1v failed

 [24]BODYmod_entry1v: READ returned OK

 [24]Testcase BODYmod_entry1v failed

 [25]BODYmod_entry1v: READ returned OK

 [25]Testcase BODYmod_entry1v failed

 [23]BODYmod_entry1v: READ returned OK

 [23]Testcase BODYmod_entry1v failed

 [1]SHUTDOWNmod_entry1v(shutdown): UNBIND returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): SHUTDOWN returned OK

 [1]SHUTDOWNmod_entry1v(shutdown):

 [1]SHUTDOWNmod_entry1v(shutdown): Opening Include file ../tree/delete_tree8

 [1]SHUTDOWNmod_entry1v(shutdown): INITIALIZE returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): VERSION returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): BIND returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): REMOVE_ENTRY returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): REMOVE_ENTRY returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): REMOVE_ENTRY returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): REMOVE_ENTRY returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): UNBIND returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): SHUTDOWN returned OK

 [1]SHUTDOWNmod_entry1v(shutdown): Exiting Include file ../tree/delete_tree8

 [1]Testcase SHUTDOWNmod_entry1v(shutdown) passed
Directory tester: threads version 2.0t  [Oct 20 1993  21:46:45]

[10/22/93 public]

Changed description, above.  Too many tests are PASSING.  Test was between
HPUX and AIX, not 486.  Sorry about the confusion -- you see
what it's like keeping all 4 reference platforms straight in one's head   .
. . note multiple bodies passing, above . . .

[10/26/93 public]


More data:  seems as between HPUX and 486, ON BOTH MACHINES, no thread
running BODYadd_entry20v ever passes, and in fact the shutdown fails too.
THIS HAPPENS EVERY TIME between HPUX and 486 (hot dog!).
I've put logs into /afs/dce/project/dce/sni/OT9231/add_entry20v*.

And here's the xt_test.log:

# cd xds/tests.xds/threads_os
# ../../xt_test -d -t T10add_entry20v >> $D2_LOG_DIR/add_entry20v.xdslog 

# cat $D2_LOG_DIR/add_entry20v.xdslog 

Directory tester: threads version 2.0t  [Oct 21 1993  22:46:26]

 [1]STARTadd_entry20v(startup): INITIALIZE returned OK

 [1]STARTadd_entry20v(startup): VERSION - dump of DS_status returned

 [1]STARTadd_entry20v(startup): VERSION returned OK

 [1]STARTadd_entry20v(startup): CREATE returned OK

 [1]STARTadd_entry20v(startup): PUT returned OK

 [1]STARTadd_entry20v(startup): BIND - dump of DS_status returned

 [1]STARTadd_entry20v(startup): BIND - dump of read bound_session_return

 [1]STARTadd_entry20v(startup): SESSION at 0x400bf0a8

 [1]STARTadd_entry20v(startup): PSAP at null address

 [1]STARTadd_entry20v(startup): 0x400bf4d8 > [1]STARTadd_entry20v(startup): 38 [1]STARTadd_entry20v(startup): 35 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 34 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 36 [1]STARTadd_entry20v(startup): 04 [1]STARTadd_entry20v(startup): 64  [1]STARTadd_entry20v(startup): 65 [1]STARTadd_entry20v(startup): 01 [1]STARTadd_entry20v(startup): 38 [1]STARTadd_entry20v(startup): 35 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 34 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 31 [1]STARTadd_entry20v(startup):    [1]STARTadd_entry20v(startup): 8[1]STARTadd_entry20v(startup): 5[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 4[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 6[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): d[1]STARTadd_entry20v(startup): e[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 8[1]STARTadd_entry20v(startup): 5[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 4[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 1

 [1]STARTadd_entry20v(startup): 0x400bf4e8 > [1]STARTadd_entry20v(startup): 30 [1]STARTadd_entry20v(startup): 03 [1]STARTadd_entry20v(startup): 64 [1]STARTadd_entry20v(startup): 62 [1]STARTadd_entry20v(startup): 70 [1]STARTadd_entry20v(startup): 01 [1]STARTadd_entry20v(startup): 38 [1]STARTadd_entry20v(startup): 35  [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 34 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 31 [1]STARTadd_entry20v(startup): 31 [1]STARTadd_entry20v(startup): 03 [1]STARTadd_entry20v(startup): 64 [1]STARTadd_entry20v(startup): 61 [1]STARTadd_entry20v(startup):    [1]STARTadd_entry20v(startup): 0[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): d[1]STARTadd_entry20v(startup): b[1]STARTadd_entry20v(startup): p[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 8[1]STARTadd_entry20v(startup): 5[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 4[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 1[1]STARTadd_entry20v(startup): 1[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): d[1]STARTadd_entry20v(startup): a

 [1]STARTadd_entry20v(startup): 0x400bf4f8 > [1]STARTadd_entry20v(startup): 70 [1]STARTadd_entry20v(startup): 31 [1]STARTadd_entry20v(startup): 31 [1]STARTadd_entry20v(startup): 01 [1]STARTadd_entry20v(startup): 38 [1]STARTadd_entry20v(startup): 35 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 34  [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 33 [1]STARTadd_entry20v(startup): 03 [1]STARTadd_entry20v(startup): 64 [1]STARTadd_entry20v(startup): 73 [1]STARTadd_entry20v(startup): 61 [1]STARTadd_entry20v(startup): 01 [1]STARTadd_entry20v(startup): 38 [1]STARTadd_entry20v(startup):    [1]STARTadd_entry20v(startup): p[1]STARTadd_entry20v(startup): 1[1]STARTadd_entry20v(startup): 1[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 8[1]STARTadd_entry20v(startup): 5[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 4[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 3[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): d[1]STARTadd_entry20v(startup): s[1]STARTadd_entry20v(startup): a[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 8

 [1]STARTadd_entry20v(startup): 0x400bf508 > [1]STARTadd_entry20v(startup): 35 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 34 [1]STARTadd_entry20v(startup): 2e [1]STARTadd_entry20v(startup): 33 [1]STARTadd_entry20v(startup): 03 [1]STARTadd_entry20v(startup): 64 [1]STARTadd_entry20v(startup): 73  [1]STARTadd_entry20v(startup): 61 [1]STARTadd_entry20v(startup): 2d [1]STARTadd_entry20v(startup): 6d [1]STARTadd_entry20v(startup): 32 [1]STARTadd_entry20v(startup):                [1]STARTadd_entry20v(startup): 5[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 4[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): 3[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): d[1]STARTadd_entry20v(startup): s[1]STARTadd_entry20v(startup): a[1]STARTadd_entry20v(startup): -[1]STARTadd_entry20v(startup): m[1]STARTadd_entry20v(startup): 2

 [1]STARTadd_entry20v(startup): Password length = 0

 [1]STARTadd_entry20v(startup): Password :

 [1]STARTadd_entry20v(startup): Private extension = 1

 [1]STARTadd_entry20v(startup): _____ End of SESSION _____

 [1]STARTadd_entry20v(startup): HANDLE at 0x400bf060

 [1]STARTadd_entry20v(startup): Type = OM_PRIVATE_OBJECT	[1]STARTadd_entry20v(startup): Flags = 0x1806

 [1]STARTadd_entry20v(startup): Class Identifier : length = 10

 [1]STARTadd_entry20v(startup): 0x400bf090 > [1]STARTadd_entry20v(startup): 2b [1]STARTadd_entry20v(startup): 0c [1]STARTadd_entry20v(startup): 02 [1]STARTadd_entry20v(startup): 88 [1]STARTadd_entry20v(startup): 53 [1]STARTadd_entry20v(startup): 01 [1]STARTadd_entry20v(startup): 03 [1]STARTadd_entry20v(startup): 64  [1]STARTadd_entry20v(startup): 00 [1]STARTadd_entry20v(startup): 00 [1]STARTadd_entry20v(startup):                      [1]STARTadd_entry20v(startup): +[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): S[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): d[1]STARTadd_entry20v(startup): .[1]STARTadd_entry20v(startup): .

 [1]STARTadd_entry20v(startup): Package = 1	[1]STARTadd_entry20v(startup): Type = 0	[1]STARTadd_entry20v(startup): SubId = 0x8000

 [1]STARTadd_entry20v(startup): Subobject list = 0x400013e8	[1]STARTadd_entry20v(startup): XDS Object = 0x400bf0a8

 [1]STARTadd_entry20v(startup): -- End of Handle --

 [1]STARTadd_entry20v(startup):

 [1]STARTadd_entry20v(startup): BIND returned OK

 [1]Testcase STARTadd_entry20v(startup) passed

 [7]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [7]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [7]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [7]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [7]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [7]Testcase BODYadd_entry20v failed

 [8]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [8]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [8]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [8]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [8]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [8]Testcase BODYadd_entry20v failed

 [9]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [9]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [9]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [9]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [9]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [9]Testcase BODYadd_entry20v failed

 [10]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [10]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [10]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [10]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [10]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [10]Testcase BODYadd_entry20v failed

 [11]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [11]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [11]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [11]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [11]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [11]Testcase BODYadd_entry20v failed

 [12]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [12]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [12]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [12]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [12]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [12]Testcase BODYadd_entry20v failed

 [13]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [13]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [13]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [13]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [13]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [13]Testcase BODYadd_entry20v failed

 [14]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [14]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [14]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [14]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [14]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [14]Testcase BODYadd_entry20v failed

 [15]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [15]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [15]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [15]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [15]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [15]Testcase BODYadd_entry20v failed

 [16]BODYadd_entry20v: ADD_ENTRY - dump of DS_status returned

 [16]BODYadd_entry20v:  Func xt_cmp_status : DS_SUCCESS expected, error received

 [16]BODYadd_entry20v:  Func xt_ds_add_entry : expected and received DS_status differ

 [16]BODYadd_entry20v:  Func xt_run : Function call FAILED

 [16]BODYadd_entry20v: ADD_ENTRY returned ERROR

 [16]Testcase BODYadd_entry20v failed

 [1]SHUTDOWNadd_entry20v(shutdown): REMOVE_ENTRY - dump of DS_status returned

 [1]SHUTDOWNadd_entry20v(shutdown):  Func xt_cmp_status : DS_SUCCESS expected, error received

 [1]SHUTDOWNadd_entry20v(shutdown):  Func xt_ds_remove_entry : expected and received DS_status differ

 [1]SHUTDOWNadd_entry20v(shutdown):  Func xt_run : Function call FAILED

 [1]SHUTDOWNadd_entry20v(shutdown): REMOVE_ENTRY returned ERROR

 [1]SHUTDOWNadd_entry20v(shutdown): UNBIND - dump of DS_status returned

 [1]SHUTDOWNadd_entry20v(shutdown): UNBIND returned OK

 [1]SHUTDOWNadd_entry20v(shutdown): SHUTDN - dump of DS_status returned

 [1]SHUTDOWNadd_entry20v(shutdown): SHUTDOWN returned OK

 [1]Testcase SHUTDOWNadd_entry20v(shutdown) failed

[11/2/93 public]
Defect cancelled.  New documentation for the threads XDS tests describe the
expected outcome of this test.



CR Number                     : 9230
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : gdssysadm
Short Description             : Can't save dir1 to file
Reported Date                 : 10/21/93
Found in Baseline             : 1.0.3
Found Date                    : 10/21/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/21/93 public]
The gdssysadm 'save' operation does not work to 'file' on HP/UX.  It
instead writes a bunch of 'echo' commands:

echo 1t3072t./var/directory/gds/dir1/attr24.idx >>
./var/adm/directory/gds/tmp/vol1.1;

to the screen and prints the 'Error: the selection function can't be
executed!' message.

How to reproduce:

1. Configure gds as a basic client-server system, accept all other defaults
2. activate gds
3. Modify t.cache/t.cacheinit2 as you would for the admin tests
4. configure directory1 using cacheinit2 and gdsditadm
5. In gdssysadm, select 'save' with the following options:

	directory: 1
	medium:    file
	name:	   dir1
	password:  <return>

[10/25/93 public]
Able to reproduce consistently on one machine but cannot reproduce on
another.  Dropping to B2 until an explanation of problem is found.  This
will not be considered a ship hold.

[10/25/93 public]
Oops, cancelled by mistake.

More data:
This problem does not occur when telnetting to the victim machine.  It only
seems to occur when logged on to the console.  The environment is HPVue,
using xterms. It occurs with TERM=vt100 and TERM=xterm.

Changing priority to 1 and will be considered a shiphold.

[10/25/93 public]
Problem is with the 'date' command spitting out garbage.  E.g.:

	Mon Oct 25 14:15:37 EDT" 1993

This was caused by a mangled value of TZ in /etc/src.sh on my machine.
Apparently, this file is read when logging onto the console, but is not
read when establishing a logon environment when telnetting in or rloging
in.



CR Number                     : 9226
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : Inrercell Broken
Reported Date                 : 10/21/93
Found in Baseline             : 1.0.3
Found Date                    : 10/21/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/21/93 public]
cdscp show dir /.../foo.qadce.osf.org
Error on entity /.../foo.qadce.osf.org
Software error detected in server (dce / cds)
Function: dnsEnumAttr

Alan Peckham believes the gdad is at faultand we are looking at it.
.

[10/21/93 public]
After looking at the gda trace, I believe this is user error.
It looks like the gda is not finding any nameserver entries
in /etc/resolv.conf. Thus it is not a bind client.
Now, obviously this should be easier to track down, but...
Please cancel this CR or defer for better error notification
in 1.1.

[10/22/93 public]
It wan't the user error that we thought but it was user error. The name
server wasn;t configured correctly to know about the cells. I'm going to
close this bug but will open another to the effect that we need to visit
the complexity of the bind configuration. Most people here that do this
on a regular basis usually screw something up on the first try. We need 
to make the process simpler or at least have gdad give more information
on what's wrong.



CR Number                     : 9225
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : gds
Subcomponent Name             : nds
Short Description             : Can't lex ndscomp.l on HP710
Reported Date                 : 10/21/93
Found in Baseline             : 1.0.3
Found Date                    : 10/21/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : directory/gds/HP800/nds/ndscomp.l
Sensitivity                   : public

[10/21/93 public]
We seem to fall into an infinite loop when lexing ndscomp.l on my HP,
prague.  This does not happen on our nightly build machine, zagreb. 

How to reproduce:

- Log into prague as me
- Do a workon to the sandbox 'ndscomp'
	workon -sb ndscomp
- cd directory/gds/nds
- type: 'build ndscomp'

You probably want to push it into the background.

If you set your window to vt100 emulation, you can invoke the 'top' command
and watch lex eat ~95% of the cpu.

[10/22/93 public]
We found, that it takes on some systems - depending on the hardware and
system load - very long to run the lex.
I heard, that someone found the lex had run over an hour. 
Rich, please check, that it is a very slow running lex.

[10/22/93 public]
Verified that it takes 10 minutes to lex this file on an unloaded HP710.
Although this seems excessive I will cancel.  Abby O'Hara can reopen this
if she thinks the lex time on Sinix is unacceptable.



CR Number                     : 9196
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDSSERV/DCECDSACL6 ==> CDSD spin
Reported Date                 : 10/19/93
Found in Baseline             : 1.0.3
Found Date                    : 10/19/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/19/93 public]

In running the system tests CDSSERV/DCECDSACL6 the cell failed because CDSD
went into an infinite loop.  I am attempting to isolate the problem more than
it already is.  I thought earlier that CDSD was in a loop because SECD had
crashed, but that was due to another test.  The loop always seems to start at
about the 5 hour mark.

[10/21/93 public]

It should be noted that this problem only shows up on a RIOS.  Runs on HP
and OSF1 servers have been ok for over 20 hours.

This problem may be an artifact of the CPU time limit set by RIOS machines.
The run we had going last night bombed sometime after the CDSD got to 59
minutes runtime - and the CPU limit was 60 minutes.  This is confusing in
light of the fact that the runs that were spinning were way over that time.
There is another run going now with a 60 year time limit.

[10/21/93 public]

I cancelled this CR because it represents a confusing and buggy behavior of
AIX.  It is NOT a DCE problem.  The problem was that CDSD was hitting the
AIX CPU time limit.  Last night's runs succeeded with a suitably large CPU
time limit.

The AIX bug is that for some reason hitting the time limit under the
conditions created by these two tests caused AIX to put CDSD into an
infinite loop rather than simply terminate it.  Note that the bug (symptom
CDSD spin) was only occurring when CDSSERV was run on some machine other
than the RIOS server, if this is of any help to IBM in fixing this problem.
(DCECDSACL6 has to be run on the server machine.)



CR Number                     : 9185
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : file/butc/butc
Short Description             : butc starts, but then exits without complaint after couple seconds
Reported Date                 : 10/18/93
Found in Baseline             : 1.0.3
Found Date                    : 10/18/93
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[10/18/93 public]
When I invoke butc in a shell, I get
# butc
Tape Coordinator:  TCID 0   Debug level 0   Cell /.../mice_cell
# 
The prompt returns after a couple seconds.  My TapeConfig looks like
# cat /opt/dcelocal/var/dfs/backup/TapeConfig
2G 1M /dev/rmt/c201d3hb 0
I have succeeded at tar'ing to this device, and reading it back.  I have
done 'bak addhost'
# bak
bak> lshosts
Tape hosts:
    Host mice.ch.apollo.hp.com, port offset 0

[11/8/93 public]
Assign a responsible engineer.

[11/8/93 public]
I belive that this has already been reported and fixed.
Abhijit, please dup this if you know the ot number, otherwise
defer until the OSF gets a chance to test it with our 1.0.3 code base.
Changed Responsible Engr. from `jaffe@transarc.com' to `khale@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[11/10/93 public]
This bug is fixed by the delta in ot9208. Unfortunately, I cannot
mark this as a dup. Please verify this and cancel.

[12/10/93 public]
fixed as part of 9208.
Changed Status from `open' to `cancel'



CR Number                     : 9143
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : xaggr
Short Description             : not enough bits in argument to AG_DETACH
Reported Date                 : 10/15/93
Found in Baseline             : 1.0.2a
Found Date                    : 10/15/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]
HP platform specific.  Hasn't been seen in R1.2.


Transarc Deltas                      [text]: 
Transarc Herder                      [text]: jaffe@transarc.com
Transarc Status                      [text]: open

[10/15/93 public]
On all platforms, when Episode is mounted locally, we try to create a unique
file system ID for the vfs structure by putting the volume ID in the top 16
bits, then the major number in 8 bits, then the minor number in 8 bits.  It's
necessary to fit the fileset ID in there somehow, because the device major
and minor alone are not unique--there can be more than one fileset per device.
Since all these numbers are being truncated, inevitably some information is
lost.  There is at least one place where this can potentially hurt us: in
the interface to AG_DETACH.
 
Consider the epiunmount utility.  This does a statfs on the mounted filesystem,
and then tries to reconstruct the device number from the "unique file system
ID" described above.  This is then passed to ftu_DetachAggr which does the
AG_DETACH syscall, which (in the kernel) ultimately results in a call to
ag_GetAggrByDev.  This function compares the reconstructed device number
passed to it, with a real device number that was obtained when the aggregate
was first attached.  Since the reconstructed device number is likely to be
missing some bits, the comparison may fail.
 
In particular, on HP/UX, the missing bits are likely to be non-zero.  For
instance, a typical disk might be /dev/dsk/c201d1s3.  The device minor number
will be 24 bits wide:  0x201103.
 
We are currently handling this by truncating the device minor number to 8 bits
(0x3), and then in the comparison in ag_GetAggrByDev, we ignore the 16 bits
that we dropped (i.e. we mask them out of both arguments before comparing
them).  The problem with this is that we can easily end up finding the wrong
aggregate in ag_GetAggrByDev.  This could cause the detach to fail and/or
the wrong aggregate to be detached.
 
It is hard to tell at what level the interfaces have to be changed to solve
this problem.  The ultimate cause is that the information returned by statfs
does not have enough bits to uniquely identify an Episode fileset, because
fileset ID's are 64 bits wide and f_fsid[0] is only 32 bits wide.  No matter
how we jam information about fileset ID and/or device number into those 32
bits, there just isn't enough room.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'
Changed Interest List CC from `kissel@apollo.hp.com, jdp@transarc.com, 
 tu@transarc.com' to `kissel@apollo.hp.com, jdp@transarc.com, tu@transarc.com, 
 cfe@transarc.com'

[12/10/93 public]
Changed Fix By Baseline from `1.0.2a' to `1.1'



CR Number                     : 9120
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa,i486,rs6000
S/W Ref Platform              : hpux,osf1,aix
Component Name                : cfg
Subcomponent Name             : src/config
Short Description             : dce_config cleanup fails sometimes
Reported Date                 : 10/14/93
Found in Baseline             : 1.0.3
Found Date                    : 10/14/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dce_config
Sensitivity                   : public

[10/14/93 public]

Sometimes "dce_config" does not clean up completely and doesn't com-
pletely remove "/opt/dcelocal" even though the "cleanup" variables
are set appropriately in the ".env" file, ie, set as follows:

REMOVE_PREV_CONFIG="y"
REMOVE_PREV_INSTALL="y"

[10/14/93 public]
I'm going to need more info on this.  
What doesn't it remove?  The dce.rm script does a rm -rf command
on /opt/dcelocal.  If you dont' have permissions (check umask!)
or there are daemons running (dce.rm should detect this and shut them
down, check /tmp/dce_config.log) it won't be able to remove everything
and it will not complain about it.

Since this is most probably user error, I am lowering this to a C3.

[03/28/94 public]
Haven't had any more problems with this.
Canceled.



CR Number                     : 9101
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : thr
Subcomponent Name             : 
Short Description             : thread assertion fails in cdscp
Reported Date                 : 10/13/93
Found in Baseline             : 1.0.3
Found Date                    : 10/13/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/13/93 public]
cdscp fails with a thread assertion failure:

cdscp> show obj /.:/subsys/dce/*
cdscp> 
**** Assertion failure. cma__queue_empty: queue corruption -- head->blink->flink != head
     at line 436 in /project/dce/build/dce1.0.3/src/threads/cma_timer.c 
%Internal DCE Threads problem (version CMA BL10+), terminating execution.

[7/12/94 public]
This was almost certainly caused by a pointer in cdscp stomping on the
threads run queue. It hasn't been seen that I know, at least in cdscp 
since this report. cancelled.



CR Number                     : 9080
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : rca handle locking
Short Description             : cache keys are insufficient
Reported Date                 : 10/9/93
Found in Baseline             : 1.0.2
Found Date                    : 10/9/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : internal_binding.c
Sensitivity                   : public

[10/9/93 public]
  While working on some as-yet unidentified problem here, I got the
following trace from DEBUG_SEC relating to the RCA binding sequence.
Our 'pe_site' file contains two bindings, identical save for their use
of different towers (udp vs. tcp). What the trace seems to show is that
if the first of these two bindings is invalid, it remains in the binding
cache. When the next alt-handle is picked up, the binding cache is
searched by keys that do not include the tower contents, and so instead
of adding a new binding into the cache and trying it, the RCA instead
gets an "equivalent" binding out of the cache (one already known to be
invalid -- the one for the previous tower -- and not purged) and passes
it back to repeat the invalidation instead of trying to revalidate the
second tower.
  This is one of those iffy bugs that's probably being triggered by some
other bug, perhaps a locally-produced one. Please just let me know if
this cache problem is considered to be "real".
  Attached: trace from "rgy_edit -update" with DEBUG_SEC set to 9;
BIND_PE_SITE set to 1, and CDSD (et alia) not running anywhere.
	.......................................................
	.......................................................
(binding_cache_lookup) Looking for site /.../travis.dce.transarc.com, cell , princ dce-rgy, type 1
(binding_cache_lookup) Cache miss
(rca_site_bind) bumping ref on identity b5470
(rca_site_bind_pe_site) calling get_site_bindings
(rca_get_site_bindings) about to open config file
(rca_get_site_bindings) Got binding 0063e66a-00e3-1cb7-9c4b-9e620d0faa77@ncadg_ip_udp:158.98.13.15[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_get_site_bindings) Got binding 0063e66a-00e3-1cb7-9c4b-9e620d0faa77@ncacn_ip_tcp:158.98.13.15[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_site_bind_pe_site) returned successfully from rca_get_site_bindings
(rca_rebind) Took alt_handle 0 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../travis.dce.transarc.com, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site == /.../travis.dce.transarc.com
(rca_setup_handle) Auth DCE, principal 'dce-rgy@travis.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity b5470, handle ff100
(binding_cache_lookup) Looking for site /.../travis.dce.transarc.com, cell , princ dce-rgy, type 0
(binding_cache_lookup) Cache miss
(rca_site_bind_pe_site) calling get_site_bindings
(rca_get_site_bindings) about to open config file
(rca_get_site_bindings) Got binding 0063e66a-00e3-1cb7-9c4b-9e620d0faa77@ncadg_ip_udp:158.98.13.15[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_get_site_bindings) Got binding 0063e66a-00e3-1cb7-9c4b-9e620d0faa77@ncacn_ip_tcp:158.98.13.15[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_site_bind_pe_site) returned successfully from rca_get_site_bindings
(rca_rebind) Took alt_handle 0 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../travis.dce.transarc.com, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site == /.../travis.dce.transarc.com
(rca_site_bind) Bound to Cell '/.../travis.dce.transarc.com'
(rca_site_bind) Bound to Site '/.../travis.dce.transarc.com'
(rca_lock_handle) locking efffcc30
(rca_unlock_handle) unlocking 103400
(rca_site_bind) String Binding  '0063e66a-00e3-1cb7-9c4b-9e620d0faa77@ncadg_ip_udp:158.98.13.15[33300]'
(binding_cache_enter) Adding 103400 to binding cache: site /.../travis.dce.transarc.com cell /.../travis.dce.transarc.com princ (null) type 0
(rca_lock_handle) locking efffd610
(rca_check_binding) checking 103400
(rca_check_binding) flags is 3
(rca_unlock_handle) unlocking 103400
103400: Dropping site refcount from 2 to 1
(rca_setup_handle) end set_auth_info identity b5470
(rca_setup_handle) rpc_binding_set_auth_info returned status 17122061
(rca_rebind) Took alt_handle 1 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../travis.dce.transarc.com, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site == /.../travis.dce.transarc.com
(rca_setup_handle) Auth DCE, principal 'dce-rgy@travis.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity b5470, handle ff1b0
(binding_cache_lookup) Looking for site /.../travis.dce.transarc.com, cell , princ dce-rgy, type 0
(binding_cache_lookup) Looking at 103400: site `/.../travis.dce.transarc.com' cell `/.../travis.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning 103400
returning cached context 103400
(rca_lock_handle) locking efffd610
(rca_check_binding) checking 103400
(rca_check_binding) flags is 3
(rca_unlock_handle) unlocking 103400
103400: Dropping site refcount from 2 to 1
(rca_setup_handle) end set_auth_info identity b5470
(rca_setup_handle) rpc_binding_set_auth_info returned status 17122061
(rca_rebind) Non-nsi rebind failed
(rca_site_bind_pe_site) assuming /.../travis.dce.transarc.com is string binding
b8a68: Dropping site refcount from 1 to 0
(rca_lock_handle) locking efffe008
Drop ref to identity b5470 from binding cache
(rca_unlock_handle) unlocking b8a68
?(rgy_edit) Unable to contact the master registry - Master Registry server unavailable (Registry Edit Kernel) (dce / sad)

[10/10/93 public]
  Additional debugging here has not competely nailed down the situation
that displays this bug, but I now certainly believe it contributes to
this bug's manifestation. Somehow, the priv service (PS) is silently
failing to get any tickets. Hence, principals' cred files all lack
(client,server) tickets for (PS, AS) and (PS, RS). This causes
rpc_binding_set_auth_info() to fail to fetch credentials, which
contributes to the above scenario. Even the dce-rgy principal lacks
client tickets from the PS.
  Again -- for clarity -- this is all hinging on some bug we must have
introduced here. My concern about the binding cache is only to get the
above trace reviewed and make certain that nothing "real" is broken in
there .. for all I can tell, the cache is prone to contain handles with
their valid flags set although bindings through them have failed, and it
does appear that it may hide contexts which differ only in their
distinct towers.

[8/8/94 public]

************************************************************************
Unless anybody objects, I am going to close this bug in a couple of days.
Here is why.
***********************************************************************

Quite some time is passed and the current trace under the same
circumstances is changed.  By doing a code inspection it seems that
the above case cannot happen anymore.  This is due to the fact that
 1 rca_rebind would not call rca_cache_enter with the bad (0) alt_handle,
   since the rpc_handle goes through an rpc_mgmt_inq_server_princ_name and
   the fact that the handle is bad is detected right away.
 2 the proper use of the hindex in rca_rebind (internal_binding.c).
   This forces the search of alternate handles to start from the handle
   beyond the current.

An attempt to recreate the above described situation seems to confirm
this.

Added below is a trace of rgy_edit -update with DEBUG_SEC=9 and
BIND_PE_SITE=1.  The file /opt/dcelocal/etc/security/pe_site is changed
to have a first 'bad' udp string binding and a secong good tcp binding.

file /opt/dcelocal/etc/security/pe_site (address of sparrow is 130.105.4.225)
------------------------------------------------
/.../sparrow_cell 92d10a6c-b2e4-11cd-85bc-000c00b4b407@ncadg_ip_udp:130.105.4.226[]
/.../sparrow_cell 92d10a6c-b2e4-11cd-85bc-000c00b4b407@ncacn_ip_tcp:130.105.4.225[]
------------------------------------------------

trace of  rgy_edit -update
------------------------------------------------
sparrow> rgy_edit -update
(binding_cache_lookup) Looking for site /.../sparrow_cell, cell , princ
dce-rgy, type 1
(binding_cache_lookup) Cache miss
(rca_site_bind) bumping ref on identity 52c9e0
(rca_site_bind_pe_site) calling get_site_bindings
(rca_get_site_bindings) about to open config file
(rca_get_site_bindings) Got binding
92d10a6c-b2e4-11cd-85bc-000c00b4b407@ncadg_ip_udp:130.105.4.226[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_get_site_bindings) Got binding
92d10a6c-b2e4-11cd-85bc-000c00b4b407@ncacn_ip_tcp:130.105.4.225[]
(rca_bind_to_host) Successful bind.
(rca_get_site_bindings) bind_to_host succeeded
(rca_site_bind_pe_site) returned successfully from rca_get_site_bindings
(rca_rebind) Took alt_handle 0 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../sparrow_cell, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site
== /.../sparrow_cell
(rca_inq_cell_name) rpc_mgmt_inq_server_princ_name failed -- status
16c9a016
(rca_setup_handle) rca_inq_cell_name failed, status 16c9a016
(rca_rebind) Took alt_handle 1 from context
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../sparrow_cell, status 16c9a0c1
(rca_setup_handle) No entry name -- status 16c9a0c1.  Falling back to site
== /.../sparrow_cell
(rca_setup_handle) Auth DCE, principal 'dce-rgy@sparrow_cell'
(rca_setup_handle) rpc_binding_set_auth_info, identity 52c9e0, handle
4cb940
(rca_setup_handle) end set_auth_info identity 52c9e0
(rca_site_bind) Bound to Cell '/.../sparrow_cell'
(rca_site_bind) Bound to Site '/.../sparrow_cell'
(rca_lock_handle) locking 44e498
(rca_unlock_handle) unlocking 4cb640
(rca_site_bind) String Binding
'92d10a6c-b2e4-11cd-85bc-000c00b4b407@ncacn_ip_tcp:130.105.4.225[2829]'
(binding_cache_enter) Adding 4cb640 to binding cache: site
/.../sparrow_cell cell /.../sparrow_cell princ dce-rgy@sparrow_cell type 1
(rca_lock_handle) locking 44e498
(rca_site_bind) bumping ref on identity 52c9e0
(rca_unlock_handle) unlocking 4cb640
(rca_lock_handle) locking 44e498
4cb640: Dropping site refcount from 2 to 1
(rca_unlock_handle) unlocking 4cb640
(rca_lock_handle) locking 55bec8
(rca_unlock_handle) unlocking 4cbc40
Current site is: registry server at /.../sparrow_cell/subsys/dce/sec/master

rgy_edit=> 
------------------------------------------------

[8/10/94]

Cancelled as for previous note



CR Number                     : 9076
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : dced
Subcomponent Name             : secval
Short Description             : 68-byte dcecred_ffffffff stops self
Reported Date                 : 10/8/93
Found in Baseline             : 1.0.2
Found Date                    : 10/8/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/8/93 public]
  Scenario: secd is down, no replicas. In the cell, a client node
reboots, and as it reboots cleans its creds directory. sec_clientd
is then run.
  sec_clientd winds up creating a dcecred_ffffffff file with limited
contents. I have not traced the exact sequence through here -- like all
others, I am so busy -- but what we see is that the cred file has only a
'header'. A picture to replace my thousand words:
                                                                      .
k2# dce.ps
  PID TT STAT  TIME COMMAND
23397 ?  S <   1:15 secd
23403 ?  S     0:14 ./sec_clientd -v
k2# kill 23397
k2# sec_clientd -v &

[1] 23424
k2# ls -ls $CREDS/*ffffffff*
sec_clientd - Unable to open override file /opt/dcelocal/etc/passwd_override
sec_clientd - Registering override interface
sec_clientd 10/08/93 15:52:36 - Registering rsec_login interface
sec_clientd 10/08/93 15:52:39 - Setting up machine context
sec_clientd 10/08/93 15:52:39 - Listening on roverride/rsec_login interface
   1 -rw-------  1 root           52 Oct  8 15:52 /opt/dcelocal/var/security/creds/dcecred_ffffffff

[1]  + Done                 sec_clientd -v
k2# ls -ls $CREDS/*ffffffff*
   1 -rw-------  1 root           52 Oct  8 15:52 /opt/dcelocal/var/security/creds/dcecred_ffffffff
                                                                      .
k2# klist -e -c FILE:$CREDS/dcecred_ffffffff
Specified credentials not found: No currently established network identity for which context exists (dce / sec)
                                                                      .
Kerberos Ticket Information:
Ticket cache: /opt/dcelocal/var/security/creds/dcecred_ffffffff
Default principal: hosts/k2/self@k2.dce.transarc.com
k2#
                                                                      .
                                                                      .
                                                                      .
  But the thumbnail sketch is that this abbrevaited file is not grown by
the addition of tickets; the KDC is down and unreachable. Following the
code in sec_clientd.c:machine_context(), we see that the machine-context
thread gets errors back due to the downed secd, and eventually enters
its TRY-block where it immediately skips over the "while
(GOOD_STATUS(.." loop and then perishes. Along this path, the keymgmt
thread never gets created.
                                                                      .
 The lack of the context thread causes at least dtsd to complain and has
effects on dfsd and its ilk. A user may kills ec_clientd in hopes of
resolving this problem, but what happens then is that
sec_login_setup_first() immediately returns due to the presence of the
creds file. The truncated cred file violates assumptions in the code
paths meant to inherit it, and the exact same outcome as before is
achieved.

[10/8/93 public]
fixed priority to what it was supposed to be - B2.

[08/26/94 public]
dced's secval won't do anything until secd is available.
Cancelling.



CR Number                     : 9075
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : install gds server option also
installs other dce core servers
Reported Date                 : 10/8/93
Found in Baseline             : 1.0.3
Found Date                    : 10/8/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : config/dce_config
Sensitivity                   : public

[10/8/93 public]
When selecting 'install GDS server' dce_config also installs new core
component servers.  This should not happen.

         DCE Installation Menu ( on prague )


         1. Security Server
         2. CDS Server
         3. DTS Server
         4. GDS Server
         5. DFS Server


         6. DCE Client
         7. Application Development Environment
         8. Optional Utilities
         9. Replica Security Server
        10. DFS Client


        98. Return to previous menu
        99. Exit


        selection:  4

        Do you wish to first remove all remnants of
        previous DCE installations for all components?
        You should do so if you plan on re-installing
        all existing DCE components now (n): 
                installing gdscache gdscacheupd gdschdb gdscmxl gdsconf ...
                installing gdscrontab gdscstub gdsdaemon gdsdbread ...
                installing gdsdbwrite gdsdeact gdsditadm gdsdsa gdsexec ...
                installing gdsgendb gdshdlcache gdshdlupd gdsinfo gdsipcchk
...
                installing gdsipcinit gdsipcstat gdslog gdsmkiss gdsmkupd
...
                installing gdssstub gdsstart gdsstep gdssysadm gdstransfer
...
                installing gdsdirinfo gdsutil gdslanguage gdsdistcmd  ...
                installing gdscacheadm ...
                installing rpcd cdsadv cdsclerk dtsd sec_clientd
dtstimed...
                installing dts_null_provider dts_ntp_provider...
               installing rpccp uuidgen cdscp getcellname getip...
                installing acl_edit dce_login rgy_edit dtscp...
                installing sec_admin passwd_import passwd_export...
                installing kinit klist kdestroy...
ln: /usr/lib/libdce.a: File exists
                copying libdce.sl to /usr/lib...
                installing message catalogs...

[10/08/93 public]
I don't really think this is a problem...
If you are going to install GDS with dce_config, you are probably using
DCE.  Even if GDS doesn't *depend* on DCE running.

This also is historical behavior by the way....

Basically, dce_config has the rule: If you install a server, you
will get the DCE client installed too.

[10/14/93 public]
This isn't going to change for 1.0.3 unless its really important.
And since I don't thinks its a bug at all...
Canceled.

[10/20/93 public]
Huh uh.  Re-opened although I will own the fix.

[10/21/93 public]
This is still a stupid thing, but I fixed it anyway.

[10/22/93 public]
Fix was incorrect.  GDS message catalogs are no longer installed.

[10/22/93 public]
Grrrrr..  This is still the right thing to do but it's too much of a pain
in the butt to fix the problem in the time remaining.  Defect cancelled.



CR Number                     : 9071
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7851
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : 
Short Description             : The limit MAXATTRIBUTE is NOT enfor
ced
Reported Date                 : 10/7/93
Found in Baseline             : 1.0.3
Found Date                    : 10/7/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/7/93 public]
The MAXATTRIBUTE is used as the maximum sizs of an attribute value.
Accordingly, AtomicValue_[tu], Update_[tu], SetMember_[tu], 
MemberValue_[tu], ReplicaPointer_[tu], gdaPointer_[tu], READ_BUF_SIZE,
etc, are bound by this limit. But most serious problem is that this
limit is NOT checked and enforced anywhere! Such as update_dns_build() 
doesn't checks data_p against Update_p which is passed in and assume its
caller does allocate enough memory for Update_p, but unfortunately
its caller doesn't check either. The result is CORE DUMP. And when read
from the cds entry, assumption is MAXATTRIBUTE, so reader allocates
buf[MAXATTRIBUTE] and copy over the attibute value which may have len 
longer than MAXATTRIBUTE, cores dump! For example dacl_get().

The second problem is that limit applies certain restriction. For example,
a acl object associated with a cds directory cannot have more than 75 users
in because otherwise it'll exceeds the max size allowed. this could be
hard for a big organization.

[6/28/94 public]
The clerk does inforce maxattribute.  The dacl_get got through cause it
doesn't use the clerk.  We believe all other cases are handle in the library onbehalf of the server.



CR Number                     : 9070
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : libafs
Short Description             : can't build libafs in a sandbox without fsint.klib
Reported Date                 : 10/7/93
Found in Baseline             : 1.0.2a
Found Date                    : 10/7/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[12/2/96 public]
HP platform specific.  Hasn't been seen in R1.2.


Transarc Deltas                      [text]: 
Transarc Herder                      [text]: jaffe@transarc.com
Transarc Status                      [text]: open

[10/7/93 public]
libafs/HPUX/Makefile contains various references to .o files in ../fsint.klib.
As a result, I can't build libafs in a sandbox in which I haven't already
build fsint.klib.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[10/14/93 public]
Is this really a problem?  If so, is there some "standard" way to solve it?
I always assumed there were lots of things you couldn't build in an empty
sandbox until you had built other things first.  Is this not true?

[10/15/93 public]
I believe that if you just put the .o files into libraries and export them,
and use the libraries in the usual way to build the kernel extensions, things
will get done in the right order, because this clever build environment builds
all libraries before building any executables or kernel extensions.  (Also
because if there is a backing sandbox, its export tree is available to the
backed sandbox, while its object tree generally is not.)
This is not exactly a show-stopping problem.  But one of the benefits of
moving to ODE, which we did with much grumbling and grousing, was that it freed
us from various dependencies between builds, and from having to build things
in a particular order ...



CR Number                     : 9065
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsadv
Short Description             : cdsadv core dumps when no swap
Reported Date                 : 10/7/93
Found in Baseline             : 1.0.3
Found Date                    : 10/7/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[10/7/93 public]

Using the nightly build available 10/6/93, I configured a 2 machine cell:
RIOS:	core server + fldb exporting lfs aggregate (root.dfs)
HP:	core client + fldb exporting 1 lfs aggregate

I kicked off the dfs.read_write_all.main system test with the data file
indicating 4 users, 2 servers, 2 aggregates.

Almost immediately, the hp (configured with 97 mb of device swap) had NO
swap available - you couldn't fork a process to even reboot the machine.

The cdsadv core dumped - possibly while trying to fork a clerk for one of
the 4 test users.

Assigning to myself since I saved the core dump in a directory that was
blown away by a subsequent smoketest. Please look to see if the code is
missing error handling for failed forks - thanks.

NOTE: a second test run succeeded after rebooting and restarting dce.

[10/08/93 public]
Its not the fork. The code in adver/adver_clerk_event.c......

        if ((newChild->pid = fork()) == -1) {
          sprintf ( opt_string, "adver: can't fork, errno: %d", errno);
#ifdef DNS_CDS
          LogEvent ( &evp, 0, opt_string );
#else
          printf("%s",opt_string);
#endif

          close(cfd);
          unlink(newChild->saddr.sun_path);
          return;
        }

It would have logged the event and waited for the next one. The client
should have come up with the socket error that we see when a clerk failes
to start. Looks like it probably failed to detect a failed malloc. About 
the only thing it can do in this case is call abort. It may not even be
able to right anything meaningfull to the log since doing so would probably
require a malloc. The call to LogEvent could very well have resulted in
an attempted malloc.

[10/08/93 public]
When a system's runing out swap space anything could happen, especially
the current runing process which could die. who should be blamed?, #1
swap space, #2 system, but not the customer i.e runing process. Remember
in OSF/1 system, if you run out swap space, the current runing process
immediately got killed. This is only way to have the swap space back when
you got into that deep hole. A core dump file may help. This bug should 
either be cancelled because wrong target to blame, or low the proority and
severity but you may cancel it by the end.

[10/12/93 public]
Many operating systems cause the memory request to fail rather than
shooting the process outright. This give the app a chance to handle 
the failure if it can. I'm not sure what the advertiser could do in
this case. We arn't even sure where in the advertiser the failure
occurred but it may have been a point at which a wait/sleep/delay could
have helped. I'm going to lower the priority on this but leave it open.
Hopefully during 1.1 cleanup we can look at each malloc in cds, the
number isn't infinite, and determine whether something other than abort 
is possible.Granted in most cases it won't be but.......

[01/17/94 public]
Changing responsible engineer to John. John - if you feel this can't
be handled more gracefully, then go ahead and cancel.

[08/20/96 public]
Cancelling from the recommendations above.



CR Number                     : 9055
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : "NO_SHARED_LIBRARIES=1" won't work
Reported Date                 : 10/6/93
Found in Baseline             : 1.0.3
Found Date                    : 10/6/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/6/93 public]

I made the following change in Makeconf and then built test/rpc/runtime/perf
but the resulting client & server images are still shared:

.elif ${TARGET_MACHINE}=="HP800"

   NO_SHARED_LIBRARIES=1

   TARGET_OS ?= HPUX
   target_os ?= hpux
   TARGET_CPU ?= PARISC
   target_cpu ?= parisc
   ANSI_CC?=c89

[10/6/93 public]

Status --- "open" to "cancel"

It works with "LINK_STATIC" defined. But, Makeconf needs some cleanup.



CR Number                     : 9046
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : acl_edit fails after creating
62 accounts and setting acl's on those accounts.
Reported Date                 : 10/5/93
Found in Baseline             : 1.0.3
Found Date                    : 10/5/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/5/93 public]

The DME development group has encountered a problem with acl_edit.
Here is the scenerio:
There is a script which using rgy_edit adds a principal, an account and
using acl_edit sets acl for the user in a sequence. They want to do it for
100 users. The script works ok for about first 62 (0-61) accounts
(principal is created, account is created and acl's set using acl_edit
command). At the count of 63, the principal and account is created ok with 
rgy_edit. But acl_edit starts failing with the following errors:


+ acl_edit /.:/hosts/spring/lms -m user:baduser62:------- 
ERROR: communications failure (dce / rpc)


+ acl_edit /.:/hosts/spring/lms -m user:baduser63:------- 
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:/hosts/spring/lms

--------------
rgy_edit appears to be working ok.

New acl_edit invocation fails.

acl_edit /.:
ERROR: connection request rejected (dce / rpc)
Unable to bind to object /.:

This has been duplicated on 486 and hp.

Here is the script:
------------------

#!/bin/sh
set -x
BAD_USER=baduser
GOOD_USER=gooduser
MAX_BAD_USERS=100
#
# Create tons-o-bad-users
#
echo "in add_userdbs"

COUNT=50
while [ $COUNT -lt $MAX_BAD_USERS ]
do
rgy_edit <<EOF
do p
add $BAD_USER$COUNT
do a
add $BAD_USER$COUNT -g none -o none -mp -dce- -pw baddd
EOF
acl_edit /.:/hosts/`hostname`/lms -m user:$BAD_USER$COUNT:-------
COUNT=`expr $COUNT + 1`
done

[10/7/93 public]
Please reproduce this with DEBUG_ACL (env variable) set to 10, and save
all the output to a file...

[10/7/93 public]
Running the test again with DEBUG_ACL set to 10 and analyzing further 
discovered that the cdsd core dumped when invoked for the 62 nd user.
Cancelling this bug.



CR Number                     : 9044
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : config additional CDS server fails if not client
Reported Date                 : 10/5/93
Found in Baseline             : 1.0.3
Found Date                    : 10/5/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : src/config/dce_config
Sensitivity                   : public

[10/5/93 public]

Configuring an additional CDS server on a node does not work unless
the node has first been brought up as a dce client.  There are attempts
to do this correctly in dce_config, but the work is incomplete.  It
would be nice if configure additional CDS server worked to bring up
a client if needed, as do the other configure additonal server options.
Making this work correctly is a better solution than documenting the
deficiency.

Below is an update of the dce_config routines config_morecds and
cds_replicate which correct this behavior.  These routines have been
tested on hppa/hpux and correctly bring up an additional CDS server
whether or not the node has previously been configured as a dce client.
Following the updated routines is a diff from the current code.

#------------------------------------------------------
# config_morecds()
#
# nth CDS Server Configuration
#       Get the name of the Initial CDS Server. Ensure
#             it isn't this machine.
#	Configure this machine as a security client if needed.
# 	If its not a CDS client, make it one.
#	Ensure the administrative user is in the cds-admin
#	      group, re-authenticating if necessary.
#	Check for installation of the cdsd daemon.
#	Update the configuration file cds.conf.
# 	Start the cdsd daemon 
#	Invoke the cds_replicate() routine to create additional
#	      CDS clearinghouses
#	Configure the GDA
#------------------------------------------------------
config_morecds()
{
	log_msg DEBUG "Executing: config_morecds()"

   # Ensure an initial CDS server has been created in the cell.

   this_server=${HOSTNAME}
   #
   # Support configuration input via environment variables
   #
   if [ $cache_cds_server ]; then
	:;
   else
	cache_cds_server=${CACHE_CDS_SERVER:="NULL"}
   fi
   until [ ${cache_cds_server:="NULL"} != "NULL" ]; do
		log_msg VERBOSE "User query: A CDS server must have already been configured.
What is the name of a CDS server in this cell
(if there is more than one, enter the name of 
the server to be cached if necessary)? "
		echo "\tA CDS server must have already been configured."
		echo "\tWhat is the name of a CDS server in this cell"
		echo "\t(if there is more than one, enter the name of"
		echon "\tthe server to be cached if necessary)? "
		read cache_cds_server
		log_msg VERBOSE "User entry: $cache_cds_server"
   done

   cache_cds_server=${cache_cds_server:-$this_server}
   cache_cds_server=`echo $cache_cds_server | cut -f1 -d"." 2>/dev/null`
	
   if [ "$cache_cds_server" = "$this_server" ]
   then
	err_exit "You must first configure an initial CDS server using the \
INITIAL CELL CONFIGURATION option for a CDS Server.  \
Continuing will return to the CONFIGURATION Menu."
	menu2
   else

	if [ ! -f $DCELOCAL/dce_cf.db ]
	then
		create_dcecfdb
	fi

        # Configure as a security client if sec_clientd isn't running.
        ps ${PSARGS} | grep -q sec_clie
        if [ $? -ne 0 ]
        then
                config_secclient
        fi

        # verify that node is now a security client
        ps ${PSARGS} | grep -q sec_clie
        if [ $? -ne 0 ]
        then
                err_exit "Failed to configure node as a security client.  This node \
must be configured as a security client before it can be configured \
as an additional CDS server.  Continuing will return to the Additional \
Server Configuration menu."
                return
        fi

        # Configure as a CDS client if cdsadv isn't running.
	ps ${PSARGS} | grep -q cdsadv > /dev/null
	if [ $? -ne 0 ]
	then
		config_cdsclient
	fi

	# verify that node is now a CDS client
        ps ${PSARGS} | grep -q cdsadv
	if [ $? -ne 0 ]
	then
		err_exit "Failed to configure node as a CDS client.  This node \
must be configured as a CDS client before it can be configured \
as an additional CDS server.  Continuing will return to the Additional \
Server Configuration menu."
		return
	fi

	klist | grep cds-admin >/dev/null 2>&1
	if [ $? != 0 ]
	then
		log_msg DEBUG "Executing: dcelogin (from config_morecds)"
		dcelogin
		if [ $? != 0 ]; then
			menu0
		fi
	fi


	# Set BIND_PE_SITE=0 so that these CDS processes don't try to use
	# the pe_site file.  This is especially necessary for cross-cell
	# authentication to happen correctly.

	log_msg VERBOSE "Executing: BIND_PE_SITE=0"
	BIND_PE_SITE=0

	# Ensure cdsd has already been installed
	if [ ! -f $DCELOCAL/bin/cdsd ]
	then
		err_exit "$DCELOCAL/bin/cdsd doesn't exist.  \
Installation of CDS must be done prior to configuration.  \
Continuing will return to the Main Menu."
		menu0
	fi

	log_msg VERBOSE "Updating the cds.conf file."
	# Update the CDS configuration file cds.conf
	log_msg DETAIL "Executing: echo \"cds.cdsd.security.server_princ_name: \
$cellname/hosts/$HOSTNAME/cds-server\" > $DCELOCAL/etc/cds.conf"
	echo "cds.cdsd.security.server_princ_name: $cellname/hosts/$HOSTNAME/cds-server" > $DCELOCAL/etc/cds.conf
	log_msg DETAIL "Executing: echo \"cds.gdad.security.server_princ_name: \
$cellname/hosts/$HOSTNAME/gda\" >> $DCELOCAL/etc/cds.conf"
	echo "cds.gdad.security.server_princ_name: $cellname/hosts/$HOSTNAME/gda" >> $DCELOCAL/etc/cds.conf
	log_msg DETAIL "Executing: echo \"cds.*.security.host_princ_name: \
hosts/$HOSTNAME/self\" >> $DCELOCAL/etc/cds.conf"
	echo "cds.*.security.host_princ_name: hosts/$HOSTNAME/self" >> $DCELOCAL/etc/cds.conf
	log_msg DETAIL "Executing: echo \"cds.*.security.server_group_name: \
$SUBSYSDIR/cds-server\" >> $DCELOCAL/etc/cds.conf"
	echo "cds.*.security.server_group_name: $SUBSYSDIR/cds-server" >> $DCELOCAL/etc/cds.conf
        log_msg DETAIL "Executing: echo \"cds.*.security.admin_group_name: \
$SUBSYSDIR/cds-admin\" >> $DCELOCAL/etc/cds.conf"
        echo "cds.*.security.admin_group_name: $SUBSYSDIR/cds-admin" >> $DCELOCAL/etc/cds.conf

	# Start cdsd (withOUT the -a)
	log_msg SUMMARY "Starting cdsd..."
        ps ${PSARGS} | grep -q cdsd
	if [ $? = 0 ]
	then
		err_exit "cdsd is already running.  \
Continuing will return to Main Menu."
		menu0
	fi
        #
        #
        start_daemon cdsd -e\* -d
        if [ $? != 0 ]; then
		log_msg DETAIL "Executing: cdsd"
        	cdsd  || { err_exit "cdsd failed to start"; }
        fi
	modify_rcfile cdsd

        cds_replicate

#	# Start gdad
#        echo "\tStarting gdad..."
#        ps ${PSARGS} | grep -q gdad
#        if [ $? -eq 0 ]
#        then
#		err_exit "cdsd is already running.  \
#Continuing will return to Main Menu."
#		menu0
#        fi
#
#	config_gda


	# Set BIND_PE_SITE back for further config
	log_msg VERBOSE "Executing: BIND_PE_SITE=1"
	BIND_PE_SITE=1

	menu2 
   fi
}

#------------------------------------------------------
# cds_replicate()
#
# nth CDS Server Configuration
#    Prompt for name of this new clearinghouse, ensuring
#	 it's different from the original CDS clearinghouse's
#	 name.
#    Create new clearinghouse on this CDS server
#    replicate the specified directories
#------------------------------------------------------
cds_replicate()
{
	log_msg DEBUG "Executing: cds_replicate()"
	# Get clearinghouse name, and ensure it differs from
	# the default clearinghouse name.
	#
	# Support configuration input via environment variables
	newchname=${REP_CLEARINGHOUSE:="NULL"}
	until [ ${newchname:="NULL"} != "NULL" ]
	do
	    log_msg VERBOSE "User query: What is the name for this clearinghouse?  "
	    echon "\tWhat is the name for this clearinghouse?  "
	    read newchname
	    log_msg VERBOSE "User entry: $newchname"
	done

	default_ch=${cache_cds_server}

        while [ "$newchname" = "$default_ch" ]
        do
		log_msg VERBOSE "User query: New Clearinghouse name must differ from $cellname_ch.
What is the name for this clearinghouse?"
                echo "\tNew Clearinghouse name must differ from $cellname_ch"
                echon "\tWhat is the name for this clearinghouse?"
                read newchname
		log_msg VERBOSE "User entry: $newchname"
        done

	#echo "\tCreating clearinghouse files and replica for root directory..."
	log_msg VERBOSE "Creating clearinghouse files and replica for root directory."
	log_msg DETAIL "Executing: cdscp create clearinghouse /.:/$newchname"
	rm -f /tmp/cdscp_out$$
	cdscp create clearinghouse /.:/$newchname >/tmp/cdscp_out$$ 2>&1
	cdscp_status=$?
	chk_cdscp "Error during creation of clearinghouse /.:/$newchname."

	# Initialize namespace to reflect additional server
	ns_addserver_init

	log_msg VERBOSE "User query: Should more directories be replicated? (n)  "
	echon "\tShould more directories be replicated? (n)  "
	read string
	answer=${string:-"n"}
	log_msg VERBOSE "User entry: $answer"
	case $answer in
		y) replicate_more;;
		yes) replicate_more;;
		*) ;;
	esac
}



5,6c5,7
old< #	This machine is a security client, if it
old< #	      isn't already the security server.
---
new> #       Get the name of the Initial CDS Server. Ensure
new> #             it isn't this machine.
new> #	Configure this machine as a security client if needed.
10,14c11,12
old< #       Get the name of the Initial CDS Server. Ensure
old< #             it isn't this machine.
old< #       Invoke the config_basecds() routine to do 
old< #             configuration common to the 1st and Nth CDS
old< #             servers.
---
new> #	Check for installation of the cdsd daemon.
new> #	Update the configuration file cds.conf.
23,26d20
old< 	if [ ! -f $DCELOCAL/dce_cf.db ]
old< 	then
old< 		create_dcecfdb
old< 	fi
28,55d21
old<         # Configure as a CDS client if cdsadv isn't running.
old< 	ps ${PSARGS} | grep -q cdsadv > /dev/null
old< 	if [ $? -ne 0 ]
old< 	then
old< 		config_cdsclient
old< 	fi
old< 
old< 	# verify that node is now a CDS client
old<         ps ${PSARGS} | grep -q cdsadv
old< 	if [ $? -ne 0 ]
old< 	then
old< 		err_exit "Failed to configure node as a CDS client.  This node \
old< must be configured as a CDS client before it can be configured \
old< as an additional CDS server.  Continuing will return to the Additional \
old< Server Configuration menu."
old< 		return
old< 	fi
old< 
old< 	klist | grep cds-admin >/dev/null 2>&1
old< 	if [ $? != 0 ]
old< 	then
old< 		log_msg DEBUG "Executing: dcelogin (from config_morecds)"
old< 		dcelogin
old< 		if [ $? != 0 ]; then
old< 			menu0
old< 		fi
old< 	fi
old< 
90a57,108
new> 	if [ ! -f $DCELOCAL/dce_cf.db ]
new> 	then
new> 		create_dcecfdb
new> 	fi
new> 
new>         # Configure as a security client if sec_clientd isn't running.
new>         ps ${PSARGS} | grep -q sec_clie
new>         if [ $? -ne 0 ]
new>         then
new>                 config_secclient
new>         fi
new> 
new>         # verify that node is now a security client
new>         ps ${PSARGS} | grep -q sec_clie
new>         if [ $? -ne 0 ]
new>         then
new>                 err_exit "Failed to configure node as a security client.  This node \
new> must be configured as a security client before it can be configured \
new> as an additional CDS server.  Continuing will return to the Additional \
new> Server Configuration menu."
new>                 return
new>         fi
new> 
new>         # Configure as a CDS client if cdsadv isn't running.
new> 	ps ${PSARGS} | grep -q cdsadv > /dev/null
new> 	if [ $? -ne 0 ]
new> 	then
new> 		config_cdsclient
new> 	fi
new> 
new> 	# verify that node is now a CDS client
new>         ps ${PSARGS} | grep -q cdsadv
new> 	if [ $? -ne 0 ]
new> 	then
new> 		err_exit "Failed to configure node as a CDS client.  This node \
new> must be configured as a CDS client before it can be configured \
new> as an additional CDS server.  Continuing will return to the Additional \
new> Server Configuration menu."
new> 		return
new> 	fi
new> 
new> 	klist | grep cds-admin >/dev/null 2>&1
new> 	if [ $? != 0 ]
new> 	then
new> 		log_msg DEBUG "Executing: dcelogin (from config_morecds)"
new> 		dcelogin
new> 		if [ $? != 0 ]; then
new> 			menu0
new> 		fi
new> 	fi
new> 
new> 
98,146c116,122
old< 	config_basecds
old< 
old< 	# Determine whether a "define cached server" command is needed.
old< 	# "cdsadv" tries to broadcast to find a cdsd, and if found,
old< 	# makes an entry in the clerk cache.  So if there is an entry in the
old< 	# clerk cache for a host other than self, then a "define cached server"
old< 	# command is not needed.  It takes between 25 (best case) and 75 (WAN/slow
old< 	# link worst case) seconds for the cdsadv to complete this operation.
old< 	# Since a lot of code has flowed under the bridge since we started up the cdsadv,
old< 	# we will do some short sleeps up to a maximum of 75 seconds total, checking the
old< 	# clerk cache between each.
old< 	#
old< 	found=0
old< 	for i in $TEST15CNT; do
old< 		log_msg DETAIL "Executing: cdscp dump clerk cache | grep $cellname >/dev/null 2>&1"
old< 		cdscp dump clerk cache | grep $cellname >/dev/null 2>&1
old< 		if [ $? -ne 0 ]
old< 		then
old< 			log_msg DEBUG "Executing: sleep 5"
old< 			sleep 5
old< 			continue
old< 		else
old< 			found=1
old< 			break
old< 		fi
old< 	done
old< 	if [ $found -eq 0 ]; then
old< 		log_msg SUMMARY "$HOSTNAME cdsadv daemon has not received any responses to its \
old< broadcast for CDS servers.  Executing a \"cdscp define cached server\" command..."
old< 		ip=`getip ${cache_cds_server}`
old< 		if [ $? != 0 ]; then
old< 		    #
old< 		    # Support configuration input via environment variables
old< 		    ip=${CACHE_CDS_SERVER_IP:="NULL"}
old< 		    until [ ${ip:="NULL"} != "NULL" ]
old< 		    do
old< 			log_msg VERBOSE "User query: Enter the IP address of $cache_cds_server:  "
old< 			echon "\tEnter the IP address of $cache_cds_server:  "
old< 			read ip
old< 			log_msg VERBOSE "User entry: $ip"
old< 		    done
old< 		fi
old< 
old< 		rm -f /tmp/cdscp_out$$
old< 		log_msg DETAIL "Executing: cdscp define cached server $cache_cds_server \
old< tower ncadg_ip_udp:$ip >/tmp/cdscp_out$$"
old< 		cdscp define cached server $cache_cds_server tower ncadg_ip_udp:$ip >/tmp/cdscp_out$$ 2>&1
old< 		cdscp_status=$?
old< 		chk_cdscp "cdscp error during \"define cached server\" command."
---
new> 	# Ensure cdsd has already been installed
new> 	if [ ! -f $DCELOCAL/bin/cdsd ]
new> 	then
new> 		err_exit "$DCELOCAL/bin/cdsd doesn't exist.  \
new> Installation of CDS must be done prior to configuration.  \
new> Continuing will return to the Main Menu."
new> 		menu0
148a125,142
new> 	log_msg VERBOSE "Updating the cds.conf file."
new> 	# Update the CDS configuration file cds.conf
new> 	log_msg DETAIL "Executing: echo \"cds.cdsd.security.server_princ_name: \
new> $cellname/hosts/$HOSTNAME/cds-server\" > $DCELOCAL/etc/cds.conf"
new> 	echo "cds.cdsd.security.server_princ_name: $cellname/hosts/$HOSTNAME/cds-server" > $DCELOCAL/etc/cds.conf
new> 	log_msg DETAIL "Executing: echo \"cds.gdad.security.server_princ_name: \
new> $cellname/hosts/$HOSTNAME/gda\" >> $DCELOCAL/etc/cds.conf"
new> 	echo "cds.gdad.security.server_princ_name: $cellname/hosts/$HOSTNAME/gda" >> $DCELOCAL/etc/cds.conf
new> 	log_msg DETAIL "Executing: echo \"cds.*.security.host_princ_name: \
new> hosts/$HOSTNAME/self\" >> $DCELOCAL/etc/cds.conf"
new> 	echo "cds.*.security.host_princ_name: hosts/$HOSTNAME/self" >> $DCELOCAL/etc/cds.conf
new> 	log_msg DETAIL "Executing: echo \"cds.*.security.server_group_name: \
new> $SUBSYSDIR/cds-server\" >> $DCELOCAL/etc/cds.conf"
new> 	echo "cds.*.security.server_group_name: $SUBSYSDIR/cds-server" >> $DCELOCAL/etc/cds.conf
new>         log_msg DETAIL "Executing: echo \"cds.*.security.admin_group_name: \
new> $SUBSYSDIR/cds-admin\" >> $DCELOCAL/etc/cds.conf"
new>         echo "cds.*.security.admin_group_name: $SUBSYSDIR/cds-admin" >> $DCELOCAL/etc/cds.conf
new> 
169,172d162
old< 
old< 	menu2 
old<    fi
old< 
188a179,181
new> 
new> 	menu2 
new>    fi
250,251d242
old< 
old< 	menu2

[10/07/93 public]
We'll get this in if we can but its not a ship stop.

[11/10/93 public]
The HP's changes + dts d should be good enough, I have get these changes in
my sandboxe and tested on both HP and 486. It could be put into the
1.0.3a or 1.1i tree as soon a the tree's opened.

[6/16/94 public]
This belongs to dce_config.

[8/24/94 public]
I configured an additional CDS server on a machine and dce_config
correctly confgiured me as a security and cds client first.
Canceled.



CR Number                     : 8956
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : gds
Subcomponent Name             : 
Short Description             : directory/gds/ros/Seplog/Makefile defines EXPLIB_SUBDIRS when building libdce
Reported Date                 : 10/5/93
Found in Baseline             : 1.0.3
Found Date                    : 10/5/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/5/93 public]

directory/gds/ros/Seplog/Makefile should not define EXPLIB_SUBDIRS when
LIBDCE_LIBRARY_MAKEFILE is defined.

[10/5/93 public]

Well, it's really a problem in libdce/Makefile. Since
directory/gds/ros/Seplog/Makefile has been changed, the following fragment
in libdce/Makefile should be fixed to visit either
directory/gds/ros/Seplog/lib or directory/gds/ros/Seplog/lib_r.

# libslog.a files
LIBDCE_CURR_INCDIR = directory/gds/ros/Seplog
.if exists(${DIRECTORY_GDSMKPATH}/gds.mk)
.include <${DIRECTORY_GDSMKPATH}/gds.mk>
.endif
.include <${MAKETOP}/directory/gds/ros/Seplog/Makefile>
EXP_libslog_OFILES := ${libslog_OFILES}

[10/5/93 public]

More..! Same for directory/gds/dua/Makefile.

[10/5/93 public]

These also need to be fixed.

libdce_6.a_OFILES =             \
        ${EXP_libslog_OFILES:S;^;../directory/gds/ros/Seplog/;g}	\
        ${EXP_libdua_OFILES:S;^;../directory/gds/dua/;g}	\

libdce_3.o_OFILES =            \
	${EXP_libXOM_OFILES:S;^;../directory/xom/;g} \
	${EXP_libXDS_OFILES:S;^;../directory/xds/;g} \
	${EXP_libslog_OFILES:S;^;../directory/gds/ros/Seplog/;g} \
	${EXP_libdua_OFILES:S;^;../directory/gds/dua/;g}

[10/5/93 public]

I now have the latest libdce/Makefile. Cancelling this.



CR Number                     : 8907
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8274
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : 
Short Description             : thread hang in 
rpc__cn_assoc_receive_frag
Reported Date                 : 10/4/93
Found in Baseline             : 1.0.2
Found Date                    : 10/4/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/4/93 public]

Thread trace for 7 =========>>

The following stack was found in cdsclerk which was in a deadlock:

cma__dispatch(0x200c2d68, 0x200c0db8, 0x200c2a88) at 0xd065d678
cma__block(0x200c2d68, 0x200c0db8) at 0xd065d3c0
ptdexc_cond_wait(0x200c2d68, 0x200c0db8) at 0xd06717c4
rpc__cn_assoc_request(0x200c2d68, 0x200c0db8, 0x200c2a88, 0x200c0ad8, 0x0,
0x0,
0x0) at 0xd0484c0c
allocate_assoc_action_rtn(0x200c2d68, 0x200c0db8) at 0xd04840a4
rpc__cn_sm_eval_event(0x200c2d68, 0x200c0db8, 0x200c2a88, 0x200c0ad8) at
0xd0488
a5c
rpc__cn_call_start(0x200c2d68, 0x200c0db8, 0x200c2a88, 0x200c0ad8, 0x0,
0x0) at
0xd0462b20
rpc_call_start(0x200c2d68, 0x200c0db8, 0x200c2a88, 0x200c0ad8, 0x0, 0x0,
0x0) at
 0xd0461638
cds_ReadAttribute(0x200c2d68, 0x200c0db8, 0x200c2a88, 0x200c0ad8, 0x0, 0x0,
0x0,
 0x20132b38) at 0x1001e6ac
ReadAttributeRPC(0x200c2d68, 0x200c0db8, 0x200c2a88) at 0x10030dec
processAddr(0x200c2d68, 0x200c0db8, 0x200c2a88) at 0x1002d440
processCH(0x200c2d68, 0x200c0db8) at 0x1002cfb4
clerk_WalkTree(0x200c2d68, 0x200c0db8) at 0x1002ccac
sendToWalkTree(0x200c2d68, 0x200c0db8) at 0x1002da84
clerkReadAttribute(0x200c2d68) at 0x10031e58
clerk_request(0x200c2d68) at 0x10010eb4
th_start(0x200c2d68) at 0xd055e2b0
cma__thread_base(0x200c2d68) at 0xd0666650

Thread trace for 24 =========>>
cma__dispatch(0x200d2e90, 0x202435e8, 0x200d2bb0) at 0xd065d678
cma__block(0x200d2e90, 0x202435e8) at 0xd065d3c0
ptdexc_cond_wait(0x200d2e90, 0x202435e8) at 0xd06717c4
rpc__cn_assoc_receive_frag(0x200d2e90, 0x202435e8, 0x200d2bb0) at
0xd0485924
rpc__cn_assoc_open(0x200d2e90, 0x202435e8, 0x200d2bb0, 0x20243308, 0x0,
0x0, 0x0
, 0xc00) at 0xd0486c94
rpc__cn_assoc_request(0x200d2e90, 0x202435e8, 0x200d2bb0, 0x20243308, 0x0,
0x0,
0x0) at 0xd0484d60
allocate_assoc_action_rtn(0x200d2e90, 0x202435e8) at 0xd04840a4
rpc__cn_sm_eval_event(0x200d2e90, 0x202435e8, 0x200d2bb0, 0x20243308) at
0xd0488
a5c
rpc__cn_call_start(0x200d2e90, 0x202435e8, 0x200d2bb0, 0x20243308, 0x0,
0x0) at
0xd0462b20
rpc_call_start(0x200d2e90, 0x202435e8, 0x200d2bb0, 0x20243308, 0x0, 0x0,
0x0) at
 0xd0461638
cds_ReadAttribute(0x200d2e90, 0x202435e8, 0x200d2bb0, 0x20243308, 0x0, 0x0,
0x0,
 0xc00) at 0x1001e6ac
ReadAttributeRPC(0x200d2e90, 0x202435e8, 0x200d2bb0) at 0x10030dec
processAddr(0x200d2e90, 0x202435e8, 0x200d2bb0) at 0x1002d440
processCH(0x200d2e90, 0x202435e8) at 0x1002cfb4
clerk_WalkTree(0x200d2e90, 0x202435e8) at 0x1002ccac
sendToWalkTree(0x200d2e90, 0x202435e8) at 0x1002da84
clerkReadAttribute(0x200d2e90) at 0x10031e58
clerk_request(0x200d2e90) at 0x10010eb4
th_start(0x200d2e90) at 0xd055e2b0
cma__thread_base(0x200d2e90) at 0xd0666650

Thread trace for 43 =========>>
cma__dispatch(0x20386bb8, 0x20250f50, 0x203868d8) at 0xd065d678
cma__block(0x20386bb8, 0x20250f50) at 0xd065d3c0
ptdexc_cond_wait(0x20386bb8, 0x20250f50) at 0xd06717c4
rpc__cn_assoc_request(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0,
0x0,
0x0) at 0xd0484c0c
allocate_assoc_action_rtn(0x20386bb8, 0x20250f50) at 0xd04840a4
rpc__cn_sm_eval_event(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70) at
0xd0488
a5c
rpc__cn_call_start(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0,
0x0) at
0xd0462b20
rpc_call_start(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0, 0x0,
0x0) at
 0xd0461638
op3_csr(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0, 0x0, 0x0,
0x2007cb1
0) at 0xd046a860
ep_get_endpoint(0x20386bb8, 0x20250f50, 0x203868d8) at 0xd04672a8
rpc_ep_resolve_binding(0x20386bb8, 0x20250f50, 0x203868d8) at 0xd0466efc
rpc__cn_call_start(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0,
0x0) at
0xd046287c
rpc_call_start(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0, 0x0,
0x0) at
 0xd0461638
op4_csr(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70, 0x0) at 0xd04839ec
rpc_mgmt_inq_server_princ_name(0x20386bb8, 0x20250f50, 0x203868d8,
0x20250c70) a
t 0xd04816bc
get_secure_handle(0x20386bb8, 0x20250f50, 0x203868d8) at 0x10013a90
get_rpc_handle(0x20386bb8, 0x20250f50, 0x203868d8, 0x20250c70) at
0x10013748
ReadAttributeRPC(0x20386bb8, 0x20250f50, 0x203868d8) at 0x10030e6c
processAddr(0x20386bb8, 0x20250f50, 0x203868d8) at 0x1002d440
processCH(0x20386bb8, 0x20250f50) at 0x1002cfb4
clerk_WalkTree(0x20386bb8, 0x20250f50) at 0x1002ccac
sendToWalkTree(0x20386bb8, 0x20250f50) at 0x1002da84
clerkReadAttribute(0x20386bb8) at 0x10031e58
clerk_request(0x20386bb8) at 0x10010eb4
th_start(0x20386bb8) at 0xd055e2b0
cma__thread_base(0x20386bb8) at 0xd0666650

Thread trace for 45 =========>>
cma__dispatch(0x2038b1a0, 0x20388f30, 0x2038aec0) at 0xd065d678
cma__block(0x2038b1a0, 0x20388f30) at 0xd065d3c0
ptdexc_cond_wait(0x2038b1a0, 0x20388f30) at 0xd06717c4
rpc__cn_assoc_request(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0,
0x0,
0x0) at 0xd0484c0c
allocate_assoc_action_rtn(0x2038b1a0, 0x20388f30) at 0xd04840a4
rpc__cn_sm_eval_event(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50) at
0xd0488
a5c
rpc__cn_call_start(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0,
0x0) at
0xd0462b20
rpc_call_start(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0, 0x0,
0x0) at
 0xd0461638
op3_csr(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0, 0x0, 0x0,
0x201cb6c
8) at 0xd046a860
ep_get_endpoint(0x2038b1a0, 0x20388f30, 0x2038aec0) at 0xd04672a8
rpc_ep_resolve_binding(0x2038b1a0, 0x20388f30, 0x2038aec0) at 0xd0466efc
rpc__cn_call_start(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0,
0x0) at
0xd046287c
rpc_call_start(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0, 0x0,
0x0) at
 0xd0461638
op4_csr(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50, 0x0) at 0xd04839ec
rpc_mgmt_inq_server_princ_name(0x2038b1a0, 0x20388f30, 0x2038aec0,
0x20388c50) a
t 0xd04816bc
get_secure_handle(0x2038b1a0, 0x20388f30, 0x2038aec0) at 0x10013a90
get_rpc_handle(0x2038b1a0, 0x20388f30, 0x2038aec0, 0x20388c50) at
0x10013748
ReadAttributeRPC(0x2038b1a0, 0x20388f30, 0x2038aec0) at 0x10030e6c
processAddr(0x2038b1a0, 0x20388f30, 0x2038aec0) at 0x1002d440
processCH(0x2038b1a0, 0x20388f30) at 0x1002cfb4
clerk_WalkTree(0x2038b1a0, 0x20388f30) at 0x1002ccac
sendToWalkTree(0x2038b1a0, 0x20388f30) at 0x1002da84
clerkReadAttribute(0x2038b1a0) at 0x10031e58
clerk_request(0x2038b1a0) at 0x10010eb4
th_start(0x2038b1a0) at 0xd055e2b0
cma__thread_base(0x2038b1a0) at 0xd0666650

Thread trace for 47 =========>>
cma__dispatch(0x2038f8e8, 0x2038d678, 0x2038f608) at 0xd065d678
cma__block(0x2038f8e8, 0x2038d678) at 0xd065d3c0
ptdexc_cond_wait(0x2038f8e8, 0x2038d678) at 0xd06717c4
rpc__cn_assoc_request(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0,
0x0,
0x0) at 0xd0484c0c
allocate_assoc_action_rtn(0x2038f8e8, 0x2038d678) at 0xd04840a4
rpc__cn_sm_eval_event(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398) at
0xd0488
a5c
rpc__cn_call_start(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0,
0x0) at
0xd0462b20
rpc_call_start(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0, 0x0,
0x0) at
 0xd0461638
op3_csr(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0, 0x0, 0x0,
0x2034dd4
8) at 0xd046a860
ep_get_endpoint(0x2038f8e8, 0x2038d678, 0x2038f608) at 0xd04672a8
rpc_ep_resolve_binding(0x2038f8e8, 0x2038d678, 0x2038f608) at 0xd0466efc
rpc__cn_call_start(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0,
0x0) at
0xd046287c
rpc_call_start(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0, 0x0,
0x0) at
 0xd0461638
op4_csr(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398, 0x0) at 0xd04839ec
rpc_mgmt_inq_server_princ_name(0x2038f8e8, 0x2038d678, 0x2038f608,
0x2038d398) a
t 0xd04816bc
get_secure_handle(0x2038f8e8, 0x2038d678, 0x2038f608) at 0x10013a90
get_rpc_handle(0x2038f8e8, 0x2038d678, 0x2038f608, 0x2038d398) at
0x10013748
ReadAttributeRPC(0x2038f8e8, 0x2038d678, 0x2038f608) at 0x10030e6c
processAddr(0x2038f8e8, 0x2038d678, 0x2038f608) at 0x1002d440
processCH(0x2038f8e8, 0x2038d678) at 0x1002cfb4
clerk_WalkTree(0x2038f8e8, 0x2038d678) at 0x1002ccac
sendToWalkTree(0x2038f8e8, 0x2038d678) at 0x1002da84
clerkReadAttribute(0x2038f8e8) at 0x10031e58
clerk_request(0x2038f8e8) at 0x10010eb4
th_start(0x2038f8e8) at 0xd055e2b0
cma__thread_base(0x2038f8e8) at 0xd0666650

Thread trace for 49 =========>>
cma__dispatch(0x20393fd8, 0x20391d68, 0x20393cf8) at 0xd065d678
cma__block(0x20393fd8, 0x20391d68) at 0xd065d3c0
ptdexc_cond_wait(0x20393fd8, 0x20391d68) at 0xd06717c4
rpc__cn_assoc_request(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0,
0x0,
0x0) at 0xd0484c0c
allocate_assoc_action_rtn(0x20393fd8, 0x20391d68) at 0xd04840a4
rpc__cn_sm_eval_event(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88) at
0xd0488
a5c
rpc__cn_call_start(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0,
0x0) at
0xd0462b20
rpc_call_start(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0, 0x0,
0x0) at
 0xd0461638
op3_csr(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0, 0x0, 0x0,
0x2034fd8
8) at 0xd046a860
ep_get_endpoint(0x20393fd8, 0x20391d68, 0x20393cf8) at 0xd04672a8
rpc_ep_resolve_binding(0x20393fd8, 0x20391d68, 0x20393cf8) at 0xd0466efc
rpc__cn_call_start(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0,
0x0) at
0xd046287c
rpc_call_start(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0, 0x0,
0x0) at
 0xd0461638
op4_csr(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88, 0x0) at 0xd04839ec
rpc_mgmt_inq_server_princ_name(0x20393fd8, 0x20391d68, 0x20393cf8,
0x20391a88) a
t 0xd04816bc
get_secure_handle(0x20393fd8, 0x20391d68, 0x20393cf8) at 0x10013a90
get_rpc_handle(0x20393fd8, 0x20391d68, 0x20393cf8, 0x20391a88) at
0x10013748
EnumerateObjectsRPC(0x20393fd8, 0x20391d68, 0x20393cf8) at 0x1003a518
processAddr(0x20393fd8, 0x20391d68, 0x20393cf8) at 0x1002d440
processCH(0x20393fd8, 0x20391d68) at 0x1002cfb4
clerk_WalkTree(0x20393fd8, 0x20391d68) at 0x1002ccac
sendToWalkTree(0x20393fd8, 0x20391d68) at 0x1002da84
clerkEnumerateObjects(0x20393fd8) at 0x1003aa5c
clerk_request(0x20393fd8) at 0x10010eb4
th_start(0x20393fd8) at 0xd055e2b0
cma__thread_base(0x20393fd8) at 0xd0666650

[10/5/93 public]

Is this really an RPC problem? The above stack dump doesn't show the
receiver thread and rpc__cn_assoc_receive_frag() was not hanging. It was
just conditional-waiting.

[10/05/93 public]

Added myself to the cc list, I seem to be having a similar problem on an
HP machine running DCE 1.0.3 from 09/30.  I can not restart my security
server machine, dtsd hangs during startup.  If I comment out dtsd from
/etc/rc.dce, rpcd, secd and the cdsadv start but as soon as I try one
DCE command my cell hangs.  I did not see this problem using a DCE 1.0.3
build from 09/24.

[10/05/93 public]

cdsclerk is chewing CPU cycles after the hang.

[10/6/93 public]
I don't think this is a deadlock scenario.
All the threads are trying to open an association.
Only Thread 24 is ahead of the other threads - looks like, its waiting 
for a response for a Bind PDU.

Two questions:
1. Client will wait indefinitely for a response for a Bind PDU
- is this behavior correct?
(See the OT 8224).

2. Why did not this thread receive a response bind PDU from the server?
Anything funny going on the server side or the heavy load factor of the cell
is contributing to the above scenario?

[10/6/93 public]

Since the thread 24 is in rpc__cn_assoc_open(), it's holding the grp_new
mutex and other threads are cond_wait'ing. (Assuming that all threads are
talking to the same server.) The BIND_ACK is sent by the server's receiver
thread. A problem in the server's receiver thread or the client's receiver
thread? Is a receiver thread started in the client?

[Kapoor 10/7/93 public]
I would appreciate if I could find out for sure that modifying
rpc_c_assoc_grp_alloc_size from 100 to 10 has been tested out in a high stress
environment.

[10/7/93 public]

We have succesfully run our scalability testing, ~50 client nodes for 8
hours, with rpc_c_assoc_grp_alloc_size=10.
Can anyone get the stack dumps of all known threads? On HP-UX, you can use
xdb macros in /afs/dce/project/dce/hp/debug-macros or
/afs/dce/project/dce/hp/debug-macros/xdb . You may need to "kill -ABRT" to
get a coredump.
Or if you can tolerate a lot of output (use the script command to capture
it :-), try
RPC_DEBUG=0.20,1-3.7,11.10,12,13.3,14.20,16.8,23,24,26.2,27,28,30
with cdsadv -f -v. (As long as RPC runtime is alive, you'll see the heart
beat from the timer thread, rpc__cn_assoc_timer_reclaim.)

[10/15/93 public]
The problem was traced to the presence of a secondary CDS server that was not
responding at all, but all the requests were being directed to that server.



CR Number                     : 8906
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : thr
Subcomponent Name             : 
Short Description             : bogus errno's returned by cma_read
Reported Date                 : 10/4/93
Found in Baseline             : 1.0.2a
Found Date                    : 10/4/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[10/4/93 public]
This is related to OT 8693.  cma_read on HPUX can be persuaded to return some
very bogus-looking errno's, including ENOSPC and ENXIO.  The errno returned
is dependent on external circumstances, such as whether stdout is piped into
"more" or goes directly to the terminal.  Here are some specifics.
(1) Simple read program
    I compiled the following program using c89 on an HP9000/710 at Transarc:
--------------
#include <pthread.h>
#include <fcntl.h>
#define DEVICE  "/dev/rdsk/c201d6s0"
#define SIZE    (814162 * 1024)
main()
{
        int fd;
        int offset = SIZE - 10 * 1024;
        extern int errno;
        int bytes;
        char buf[1024];
        errno = 0;
        fd = open(DEVICE, O_RDONLY);
        printf("fd=%d\n", fd);
        while (1) {
                lseek(fd, offset);
                bytes = read(fd, buf, 1024);
		if (bytes == -1)
                printf("bytes = %d, offset=%ld, errno=%d\n", bytes, offset, errno);
		else
		printf("bytes = %d, offset=%ld\n", bytes, offset);
                offset += 1024;
        }
}
--------------
Results:
  - When I piped the output through more, reads beyond some point return
    ENOSPC.  I haven't determined what point that is (i.e. whether it
    corresponds to the size of the partition).  I only know that when I
    ran the program as is, I got ENOSPC, but when I set the initial value
    of SIZE to 10 * 1024, cma_read returned 1024.
  - When I didn't pipe the output through more, cma_read returned 1024
    (i.e. successful read) on EVERY call no matter where we had lseek'ed to.
I ran the following program also:
--------------
/*
 * This is edsk_GuessDeviceCapacity ported as a trivial
 * standalone utility.  It doesn't work on HPUX with or
 * without my proposed patch.
 *
 * The errno is still ENXIO, which I don't know how to get
 * with a simpler program.
 */
#include <pthread.h>
#include <fcntl.h>
#include <unistd.h>
#include <errno.h>
#define DEVICE  "/dev/rdsk/c201d6s0"
long edsk_GuessDeviceCapacity(int, char*, long);
main()
{
    long capacity;
    int fd;
    if ((fd = open(DEVICE, O_RDONLY)) == -1) {
       perror("couldn't open device");
       exit (1);
    }
    capacity = edsk_GuessDeviceCapacity(fd, DEVICE, 8096);
    printf("capacity=%ld\n", capacity);
}
#define AFS_HPUX_ENV
#define EPISODE_DISKBUFFER_MINSIZE 8096
#define osi_Alloc malloc
#define osi_Free(d, s) free((void *)s)
/*
 * The following function is identical to the one in episode/anode/edbasic.c
 */
long 
edsk_GuessDeviceCapacity(
    int rfd,
    char *RawDev,
    long blksiz
    )
{
    char ErrMsg[500];
    unsigned long L, H, M;
    int High, Res, Size;
    char *Data;
    Size = blksiz;
    if (Size < EPISODE_DISKBUFFER_MINSIZE) Size = EPISODE_DISKBUFFER_MINSIZE;
    Data = (char *) osi_Alloc(Size);
    if (Data == NULL) return -1;
    L = 1;	/* needs to be > 0 so that the loop can terminate if H hits 0 */
    H = (0xffffffff) / ((unsigned long) blksiz) - 1;
    while (L <= H) {
	M = (L + H) / 2;
	High = 0;
	errno = 0;
	if (lseek(rfd, M*blksiz, SEEK_SET) == -1) {
	    if (errno == EINVAL) High = 1;
	    else {
		sprintf(ErrMsg, "lseek(%lu) of %s", (M*blksiz), RawDev);
		perror(ErrMsg);
		osi_Free(Data, Size);
		return -1;
	    }
	} else {
	    errno = 0;
	    Res = read(rfd, Data, blksiz);
	    if (Res == blksiz) {
		High = -1;
	    } else if (Res >= 0 && Res < blksiz) {
		High = 1;
	    } else if ((Res > blksiz) || Res < 0) {
#ifdef AFS_HPUX_ENV
		if (errno == ENOSPC)
#else /* AFS_HPUX_ENV */
		if (errno == ENXIO || errno == EINVAL || errno == EIO)
#endif /* AFS_HPUX_ENV */
		{
		    High = 1;
		} else {
		    sprintf(ErrMsg, "read() of %s, %lu for %d", RawDev, (M*blksiz), blksiz);
		    perror(ErrMsg);
		    osi_Free(Data, Size);
		    return -1;
		}
	    }
	}
	if (High > 0) {
	    H = M - 1;
	} else {
	    L = M + 1;
	}
    }
    osi_Free(Data, Size);
    return H;
}
--------------
Results:
  The first call to read ALWAYS returns ENXIO.
Both programs were provided by Michael Schmitz @ OSF.  They were constructed
in the process of debugging OT 8693.
It is not clear to me what cma_read is "supposed" to do when reading beyond
the end of a partition.  For a single-threaded program, I suggest that it
should return the same errno (if any) or results (if any) as are returned
by the read system call.
In any case, the fact that the results depend upon the use of "more" suggests
that the current behavior is unintentional, i.e. a bug.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[10/5/93 public]
Since this is not a DFS problem, I have changed the responsible engineer to
our threads guy.

[10/5/93 public]
Sigh.  Was that really me who wrote the above programs?  First of all, I
defined osi_Free incorrectly, and of course lseek has three arguments.
The following fixed program produces correct results multithreaded or
not.  
As not documented in the HPUX read(2) system call, read() can return
ENXIO for a raw disk device special file if you do the following:
	lseek to an offset not a multiple of the block size (512)
	attempt a read
Also, ENOSPC is returned on reads past EOF.  All that is
needed is to check for ENXIO in edsk_GuessDeviceCapacity.  
edsk_GuessDeviceCapacity is unusual in that it is meant to fail
for small block sizes.  The caller is expected to call back with
blksiz set to progressively higher powers of two until the function
succeeds.  During newaggr, this function is called first with
blksiz=128, then with blksiz=256, then with blksiz=512.  The
first two fail with ENXIO, and the third succeeds.  The only
problem in the original code was that ENXIO was not treated as
an expected error.
/*
 * Compile with:
 *
 * c89 -o g -g -D_HPUX_SOURCE  
 *	-I/project/dce/build/nb_ux/export/hp800/usr/include
 *      -L/project/dce/build/nb_ux/export/hp800/usr/lib g.c -ldce
 */
#include <pthread.h>
#include <fcntl.h>
#include <unistd.h>
#include <errno.h>
#define DEVICE  "/dev/rdsk/c201d4s0"
long edsk_GuessDeviceCapacity(int, char*, long);
main(
    int argc,
    char *argv[]
    )
{
    long capacity;
    int fd;
    long blksiz;
    if (argc <2) {
        printf("g: must specify blksize\n");
        exit(1);
    }
    blksiz = atol(argv[1]);
    if ((fd = open(DEVICE, O_RDONLY)) == -1) {
       perror("couldn't open device");
       exit (1);
    }
    capacity = edsk_GuessDeviceCapacity(fd, DEVICE, blksiz);
    if (capacity > 0)
        printf("Device has %ld blocks of size %ld\n", capacity, blksiz);
    else
        printf("blksiz not usable (%ld)\n", capacity);
}
#define AFS_HPUX_ENV
#define EPISODE_DISKBUFFER_MINSIZE 8192
#define osi_Alloc malloc
#define osi_Free(d, s) free((void *)d)
#define EXPORT
#define IN
/*
 * The following function is identical to the one in episode/anode/edbasic.c
 */
EXPORT long edsk_GuessDeviceCapacity (rfd, RawDev, blksiz)
  IN int rfd;
  IN char *RawDev;
  IN long blksiz;
{
    char ErrMsg[500];
    unsigned long L, H, M;
    int High, Res, Size;
    char *Data;
    Size = blksiz;
    if (Size < EPISODE_DISKBUFFER_MINSIZE) Size = EPISODE_DISKBUFFER_MINSIZE;
    Data = (char *) osi_Alloc(Size);
    if (Data == NULL) return -1;
    L = 1;      /* needs to be > 0 so that the loop can terminate if H hits 0 */
    H = (0xffffffff) / ((unsigned long) blksiz) - 1;
    while (L <= H) {
        M = (L + H) / 2;
        High = 0;
        errno = 0;
        if (lseek(rfd, M*blksiz, SEEK_SET) == -1) {
            if (errno == EINVAL) High = 1;
            else {
                sprintf(ErrMsg, "lseek(%lu) of %s", (M*blksiz), RawDev);
                perror(ErrMsg);
                osi_Free(Data, Size);
                return -1;
            }
        } else {
            errno = 0;
            Res = read(rfd, Data, blksiz);
            if (Res == blksiz) {
                High = -1;
            } else if (Res >= 0 && Res < blksiz) {
                High = 1;
            } else if ((Res > blksiz) || Res < 0) {
#ifdef AFS_HPUX_ENV
                /*
                 * HPUX returns ENOSPC when reading past the end of
                 * the device and ENXIO when reading at offsets not
                 * a multiple of the device block size.  There's no
                 * need to continue the search when errno is ENXIO.
                 */
                if (errno == ENXIO) {
                    osi_Free(Data, Size);
                    return -1;
                }
                else if (errno == ENOSPC)
#else /* AFS_HPUX_ENV */
                if (errno == ENXIO || errno == EINVAL || errno == EIO)
#endif /* AFS_HPUX_ENV */
                {
                    High = 1;
                } else {
                    sprintf(ErrMsg, "read() of %s, %lu for %d", RawDev, (M*blksiz
), blksiz);
                    perror(ErrMsg);
                    osi_Free(Data, Size);
                    return -1;
                }
            }
        }
        if (High > 0) {
            H = M - 1;
        } else {
            L = M + 1;
        }
    }
    osi_Free(Data, Size);
    return H;
}

[10/5/93 public]
The above explanation looks adequate to me.  Cancelling.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 8894
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9042
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : dce_config installs kload in
wrong directory
Reported Date                 : 10/4/93
Found in Baseline             : 1.0.3
Found Date                    : 10/4/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : config/dce_config
Sensitivity                   : public

[10/4/93 public]
In function install_dfsclient in dce_config the program 'kload' is
installed into DCELOCAL/ext.  In function load_dfsext, however, kload is
invoked as DCELOCAL/bin/kload.  One of these needs to be fixed.

This defect affects defect #8552.

[10/14/93 public]
This was fixed under 9042.  I can't dup forward so I'll cancel.



CR Number                     : 8893
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : 
Short Description             : rpc_server_inq_bindings returns "no bindings (dce / rpc)" when invoked after rpc_server_use_all_protseqs_if
Reported Date                 : 10/4/93
Found in Baseline             : 1.0.2a
Found Date                    : 10/4/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/4/93 public]

An OSF DME engineer found this when writinng an application which 
calls rpc_server_use_all_protseqs_if() [instead of 
rpc_server_use_all_protseqs()] and then calls 
rpc_server_inq_bindings(). Adding a call to rpc_server_register_if()
before calling rpc_server_inq_bindings() makes no difference.

The DCE documentation uses general terms to lead one to believe this 
approach is correct.

The same behavior exists in dce1.0.3. A short test program to exhibit 
the problem follows.

The program takes a command line argument (just the letter 'a') and use
plain old  use_all_protseqs() instead of the _if() : It _does_work_ (!!)
when the 'a' is given:

golem 108 > ./test
ERROR rpc_server_inq_bindings: no bindings (dce / rpc)
golem 109 > ./test a
Success! Got bindings.
golem 110 >

The new test program is below; also there is "test.idl" -- it is required
to produce the  rdaclif_v0_0_s_ifspec 

  The pieces below are standalone -- you can try them yourself.

========================  Makefile  ====================


USEDCE=1

WARNS   = -Wall -Wstrict-prototypes
CFLAGS  = $(DEFS) $(WARNS)

IDLFILES = test.idl

PROGRAMS=test

test_OFILES = test.o test_sstub.o

test_sstub.o_CFLAGS = -Di386

test.o: test.c

test.idl:

# use common makefiles
.include <${RULES_MK}>

==========================================================================

============================  test.c  ====================================

#include <stdio.h>

#include <dce/dce_error.h>

#include <dce/aclbase.h>
#include <dce/rpcexc.h>
#include <dce/rdaclif.h>
#include <dce/rpc.h> 
#include <dce/sec_login.h>
#include <dce/rgybase.h>

void CHECK_RPC_STATUS(unsigned long dce_status, char *msg)
{
    if ( dce_status != error_status_ok )
    { 
	unsigned char   buff[dce_c_error_string_len];
	int		j;
	dce_error_inq_text(dce_status, buff, &j);
	fprintf(stderr,"ERROR %s: %s\n",msg,buff); 
	exit(-1); 
    }
}


int main(int argc, char **argv)
{
    unsigned long rpc_status;
    
    rpc_binding_vector_t *acl_binding_vector;
    
    rpc_server_register_if(rdaclif_v0_0_s_ifspec,
			   (uuid_t *)NULL, 
			   (rpc_mgr_epv_t)NULL,
			   &rpc_status);
    CHECK_RPC_STATUS(rpc_status, "rpc_server_register_if");
    
    /*
     * Use all protocol sequences for the rdacl interface.
     */

    /* with command line argument 'a', use plain old 'all_protseq' */
    if ( argc > 1 && argv[1][0] == 'a' )   
	rpc_server_use_all_protseqs(rpc_c_protseq_max_calls_default,
				   &rpc_status); 
    else
	rpc_server_use_all_protseqs_if(rpc_c_protseq_max_calls_default,
				       rdaclif_v0_0_s_ifspec,
				       &rpc_status); 
    
    CHECK_RPC_STATUS(rpc_status, "rpc_server_use_all_protseqs_if");
    
    /*
     * Obtain a vector of server binding handles from the DCE RPC runtime.
     */
    rpc_server_inq_bindings(&acl_binding_vector, &rpc_status);
    CHECK_RPC_STATUS(rpc_status, "rpc_server_inq_bindings");
    
    fprintf(stderr,"Success! Got bindings.\n");
   
}


void foo(char *bar)    /* "stub" function for the IDL file */
{                      /* the IDL compiler does NOT like empty files :-) */
}

===========================================================================

================================  test.idl ================================
/*
 * @OSF_COPYRIGHT@
 * COPYRIGHT NOTICE
 * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
 * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
 * src directory for the full copyright text.
 */
/*
 * historry  
 *
 * Revision 1.1.4.2  1992/12/29  13:30:15  zeliff
 * 	Embedding copyright notice
 * 	[1992/12/28  20:48:29  zeliff]
 *
 * Revision 1.1.2.2  1992/05/08  14:49:31  burati
 * 	Cleaned up comments.
 * 	[1992/05/07  15:15:48  burati]
 * 
 * 	Add rdacl_get_mgr_types_semantics(...)
 * 	[1992/04/29  03:05:27  burati]
 * 
 * Revision 1.1  1992/01/19  14:55:25  devrcs
 * 	Initial revision
 * 
 * 
 */

/*  rdaclif.idl V=11 10/28/91 //littl/prgy/src/idl
**
** Copyright (c) Hewlett-Packard Company 1991
** Unpublished work. All Rights Reserved.
**
*/

[10/4/93 public]
Workaround for OT bug (doesn't like the string H I S T O R Y - without the spaces) 
in the note text.
The rest of that IDL definition is:

[10/4/93 public]
OT doesn't like square brackets in column 0 either.
	 [
	     uuid(47B33331-8000-0000-0D00-01DC6C000000)
	 ]
	 
	 interface rdaclif {
	 
	 	typedef [ref] char *foobar;
	 
	 
	     void foo([in,out] char *bar);
	 
	 }

[10/5/93 public]

This is a user error. You must define the well-known endpoint in your IDL
file to use rpc_server_use_all_protseqs_if(). The documentation is clear.
From rpc_server_use_all_protseqs_if(3) man page:

      rpc_server_use_all_protseqs_if - Tells the RPC runtime to use all the
      protocol sequences and endpoints specified in the interface
      specification for receiving remote procedure calls

	:
	:

      if_handle
          Specifies an interface specification containing the protocol
          sequences and their corresponding endpoint information to use in
          creating binding handles.  Each created binding handle contains a
          well-known (nondynamic) endpoint contained in the interface
          specification.

[10/05/93 public]
Seiichi is is correct, you are not specifying an endpoint when you
use rpc_server_use_all_protseqs_if().

Canceled.



CR Number                     : 8888
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : gds
Subcomponent Name             : 
Short Description             : 1.0.3 gds message files are
not compatible with those of 1.0.2
Reported Date                 : 10/1/93
Found in Baseline             : 1.0.3
Found Date                    : 10/1/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/1/93 public]

Full Description:

	Nick and I just spent two hours trying to debug why latest 1.0.3
gdssysadm dumps core when running on a RIOS machine. It turns out that the
machine has 1.0.2 gds message catalog files installed.

	In other cases, we have seen other message incompatibility
problems.

	It looks like that 1.0.3 gds re-designed message catalog files,
incompatible with 1.0.2 files. One example is using "dspcat gdssysadm.cat 1 1"
on RISO machine to see the different mesaages with 1.0.2 and 1.0.3.

	It is probably too late to say that 1.0.3 should try to make those
message catalog files compatible by adding new sets to the files for new
messages. Assuming that the redesign is a must, I would like to see a check
implemented which will tell me when I am using a wrong version of message
file. 


Proposed Solution:

	Make 1.0.3 gds executable be able to tell if message catalog files are
1.0.2 based. In that case, give an error and quit. "gdssysadm.cat 1 1" is
one example to check for 1.0.2 or 1.0.3.

[10/15/93 public]

Sorry guys, but 1.0.2 cat files go with 1.0.2 executables, and 1.0.3 cat
files go with 1.0.3.  Cancelled.

[10/18/93 public]

On a system where both 1.0.2 and 1.0.3 GDS are available, it is likely that
crossing using will happen. A simple check should help.

There is another side effect due to the way 1.0.3 GDS uses its catalog
file. One particular message cannot be longer than certain length (I belive
that it is "gdssysadm.cat 1 1", where it is a number for 1.0.3, and a long
string for 1.0.2), otherwise it causes core dump (the code allocates an
arrary of "enough" byte to hold this number. The array is on the stack,
followed by a pointer pointing to the starting address of the array. When a
longer message is read, there is no check to insure that it does not go
beyond the bound of the array. When that happens, the next pointer is
corrupted, causing core dump). 

If someone changes the catalog file, in particular that piece of the
message, the GDS will not work any more.



CR Number                     : 8871
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : dtscp
Short Description             : The range for the dtscp command "set local/global set timeout" is wrong.
Reported Date                 : 9/29/93
Found in Baseline             : 1.0.3
Found Date                    : 9/29/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/29/93 public]
According to the man pages, the range of the dtscp command "set local
set timeout" is from 0-00:00:01.000 to 0-00:05:00.000, but the range
enforced by dtscp is 0-00:00:00.000 to 0-00:01:00.000.
The default should be 0-00:00:02.000, but is 0-00:00:05.000.

According to the man pages, the range of the dtscp command "set global
set timeout" is from 0-00:00:01.000 to 0-00:10:00.000, but the range
enforced by dtscp is 0-00:00:00.000 to 0-00:10:00.000.

[10/25/93 public]
In common/dtss_attr_ranges.h, I changed

/* default 'set local set timeout' = 2 sec. */
#define K_LAN_TIMEOUT_LO (2 * K_100NS_PER_SEC)

/* minimum 'set local set timeout' = 1 sec. */
#define K_MIN_LAN_TIMEOUT_LO (K_100NS_PER_SEC)

/* maximum 'set local set timeout' = 5 minutes */
#define K_MAX_LAN_TIMEOUT_LO (5 * K_100NS_PER_SEC * 60)

/* minimum 'set global set timeout' = 1 sec. */
#define K_MIN_WAN_TIMEOUT_LO (K_100NS_PER_SEC)

The ranges now seem to be correct.

[10/26/93 public]
The default local set timeout was raised to 5 seconds and should be
documented that was in recent (1.0.2-1.0.3) docs.

The range enforcement should be fixed.

[10/26/93 public]
The latest 1.0.3  code and docs match for local set timeout.  
Range is 0 sec - 1 min and the default is 5 sec.

For global set timeout, both code and docs match as well.
Range is 0 sec to 10 mins and default is 15 sec.

It looks like everything mentioned here is fine.  Perhaps this is a dup of
5500.  It certainly seems as if the foundin baseline field is wrong,
because the 1.0.3 code looks fine to me.  If I'm missing something then
please tell me, otherwise cancel this bug.

[7/15/94]

The DCE Administration Reference, Update 1.0.3, matches what Howard
has stated above, as do the values in
src/dts/common/dtss_attr_ranges.h.
Cancelling the bug.



CR Number                     : 8869
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfstrace
Short Description             : dfstrace lslog does not display persistent logs
Reported Date                 : 9/29/93
Found in Baseline             : 1.0.2
Found Date                    : 9/29/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : See description
Sensitivity                   : public
Transarc Deltas               : 
Transarc Status               : open
Transarc Herder               : 

[9/29/93 public]
The dfstrace lslog command should provide information on which
logs have a state of persistent.  This is useful because these logs
will not be clear using a "global" clear command (that is, dfstrace
clear without the -set or -log opitions).  Adding this enhancement
will also make dfstrace lslog consistent with dfstrace lsset which
does display persistent event sets.
Added field Transarc Deltas with value `' 
Added field Transarc Status with value `open'

[1/10/94 public]
Changed Responsible Engr. from `comer@transarc.com' to `rajesh@transarc.com' 
Added field Transarc Herder with value `'

[1/10/94 public]
Reassigning to Pervaze, for determination when this work is to be done.
Changed Responsible Engr. from `rajesh@transarc.com' to `pakhtar@transarc.com'

[1/18/94 public]
Changed Status from `open' to `cancel'



CR Number                     : 8868
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : rpc/runtime ?
Short Description             : invalid endpoint entry in rpc
Reported Date                 : 9/29/93
Found in Baseline             : 1.0.3
Found Date                    : 9/29/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : cdscp
Sensitivity                   : public

[9/29/93 public]

During DCE cell setup for the RIOS smoketest dce_config failed when
it tried to start cdsadv and cdsd with the complaints:

S:****** Starting cdsadv...
invalid endpoint entry (dce / rpc)
S:****** Starting cdsd...
invalid endpoint entry (dce / rpc)
ERROR:   cdscp show dir /.: failing -- CDS not usable

[09/29/93 public]
This was caused by a corrupt rpcdep.dat (the endpoint database) file.
A removal of this file allow the cell to come up.

Bug canceled.



CR Number                     : 8703
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9123
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dfs.unconfig
Short Description             : unconfig option in dce_config doesn't unconfigure an fldb server
Reported Date                 : 9/28/93
Found in Baseline             : 1.0.3
Found Date                    : 9/28/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/28/93 public]

It would be nice if the unconfig  option had the ability
to unconfigure an fldb server.  It would be okay if this were
a separate unconfig option.

[9/28/93 public]
Oops, I fixed this under 9123.  Cancelled.



CR Number                     : 8697
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : Syntax error in file/AT386/machdep.mk
Reported Date                 : 9/28/93
Found in Baseline             : 1.0.3
Found Date                    : 9/28/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : file/AT386/machdep.mk
Sensitivity                   : public

[9/28/93 public]
The fix submit for revision 1.1.4.3 of this file does not work and, in
fact, breaks the 486 build.  From file/tools/cmd:

gemini tools/cmd$ build
relative path: ./file/tools/cmd
cd ../../../../obj/at386/file/tools/cmd
"/project/dce/build/dce1.0.3/src/lbe/mk/osf.parse_ext.mk", line 330: Could
not find /tmp/addexists10354
sh: zeliff@gemini::  not found.
"/project/dce/build/dce1.0.3/src/lbe/mk/osf.parse_ext.mk", line 353:
warning: "rm -f /tmp/addexists${DO_IT}" returned non-zero
Fatal errors encountered -- cannot continue

Revision 1.1.4.1 of this makefile continues to work but presumably the
fixes applied in 1.1.4.2 and 1.1.4.3 are needed.

[9/28/93 public]
Okay, I goofed.  Sorry



CR Number                     : 8677
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : Buildconf
Short Description             : Make OBJECTDIR an absolute path
Reported Date                 : 9/24/93
Found in Baseline             : 1.0.3
Found Date                    : 9/24/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : Buildconf.exp and others
Sensitivity                   : public

[9/24/93 public]
OBJECTDIR is used by the 'build' program to find the place where it should
leave the object files created by the build.  (In actuality, this is where
the build program "cd's" to when building.)  This path is currently a
relative path from the local sandbox source tree:

	../obj/${target_machine}

There is an advantage to making this an absolute path: it makes life easier
for DCE developers when debugging problems.  They can invoke the debugger
without having to specify a path to the object file.

There would be some impact on DCE source code.  The following files have
built-in dependencies on OBJECTDIR and would need to be changed:
./file/MMAX/machdep.mk
./file/episode/libefs/OSF1/Makefile
./file/libafs/HPUX/Makefile
./file/libafs/OSF1/Makefile
./file/osi/test_trace.pl
./file/all.sh
./file/install.sh

Also, I haven't given any thought to how this might impact providers or
licensees.

[1/13/94 public]

Assigning to Mario Moreira for review.

[7/1/94 public]
Re-assigned to annie

[7/11/94 public]
There are some problems that I see here.  The first is that this 
change will only be mildly effective in making developers more
productive in the way they do their debugging.  I talked with 
Tom Jordahl and I get the impression that the window within which
to use 'absolute-paths-to-objects'  is fairly narrow and that 
a lot of work would still be needed to support an effective debugging
environment for DCE.  The nightly builds don't have debugging turned-on and
require rebuilding anyway.  Rebuilding (with debugged) backed by a nightly build
using absolute pathnames will only be useful until the nightly build
is turned into a weekly build (at which point the objects will be
pointing to the wrong sources anyway).

Rather than starting an argument over the merits of this particular
solution; it might be more beneficial to list some of the ways
people are currently debugging DCE.  There are some pretty good
ideas out there.

John Bowe has an interesting  way of debugging.  While in a sandbox he
has a script that creates a link in the 'src' tree to a corresponding
executable in the 'obj' tree.  The script traverses all the "../../../obj"
nonsense and he is able to  run gdb on the executable AND be
in the same directory to edit the sources.  Pretty clever if you ask me.
This, of course, does require him to be in a sandbox environment.

Any Mckeen has a few aliases that basically "pushd" and "popd" back
and forth from the 'obj' directory and the 'src' directory.

Tom Jordahl has windows side-by-side (one in the 'obj' tree and 
one in the 'src' tree) to do debugging.


Granted, these techniques are not cutting edge technology, but, these
guys are getting a lot of work done.


Tom mentioned that you guys get more pain from the fact that 'released'
executables (from the nightly builds??) are not compiled with "-g" and
when a problem is found, you need to rebuild with "-g" in order
to go into 'gdb' to find the problem.  Maybe we should look to 
eliminating this part of the debugging cycle.


Ideas??  Comments!!

[melman 7/11/94 public] 
A lot of debuggers let you set a path to search for files in (path_map
in xdb).  I usually run the debugger in the object tree and set this
path as appropriate.

[8/24/94 public]
Considering we are about to enter functional code freeze tomorrow, 
I propose that we cancel this CR.  It would have been very nice to help
in debugging DCE, but, It seems like it is a little too late.

[8/24/94 public]
certainly agreed.

[8/24/94 public]
Disagree.  This should be carried forward into dce1.2.

[8/24/94 public]
Maybe our time could be better spent making up a wishlist of suggestions
for the people who will be taking over all this stuff.   I'm not trying to 
start an argument here, but, this request is so narrow in scope and
its benifits are so small that people will probably wonder why we 
worried about it in the first place.  Once this environment is given to
the providers, most (if not ALL) the folklore, history, and tricks-of-the-trade
that we have developed will be gone.  I'm betting that the next integrator
is going to overhaul the build environment and source tree organization.



CR Number                     : 8676
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8697
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : libafs
Short Description             : Poor method for find OSF/1 kernel
Reported Date                 : 9/24/93
Found in Baseline             : 1.0.3
Found Date                    : 9/24/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : file/libafs/OSF1/Makefile,
Makeconf
Sensitivity                   : public

[9/24/93 public]
In the above mentioned makefile we find the following code for linking a
DFS (and episode) kernels:

dfsvmunix: ${MAKETOP}/${OBJECTDIR}/kernel/${CONFIG}/vmunix.sys
${KERNEL_LDDEP} ${afs_libs_dep} ${rpc_libs_dep}
       ${MACHO_GCC_EXEC_PREFIX}ld ${KERNEL_LDOPTS}  -e pstart -o dfsvmunix
${LIBDIRS} \
       ${${MAKETOP}/${OBJECTDIR}/kernel/${CONFIG}/vmunix.sys:P}
${KERNEL_LDDEP} ${afs_libs} -lepidum ${afs_repeat
s} ${rpc_libs}

.ifndef NO_EPISODE
efsvmunix: ${MAKETOP}/${OBJECTDIR}/kernel/${CONFIG}/vmunix.sys
${KERNEL_LDDEP} ${afs_libs_dep} ${rpc_libs_dep} ${
efs_libs_dep}
       ${MACHO_GCC_EXEC_PREFIX}ld ${KERNEL_LDOPTS}  -e pstart -o efsvmunix
${LIBDIRS} \
       ${${MAKETOP}/${OBJECTDIR}/kernel/${CONFIG}/vmunix.sys:P}
${KERNEL_LDDEP} ${afs_libs} ${efs_libs} ${afs_repe
ats} ${rpc_libs} 
.endif

This requires that a copy of the partially-linked OSF/1 kernel be found in
the sandboxes obj tree:  obj/at386/kernel/DCE/vmunix.sys.  Since this is
only really an issue at OSF1 we could make developer lives easier by having
the makefile look in the obj tree of the osc_sbox1.2 where it really lives.

This would mean adding the following code to Makeconf:
#
#       Specify path to special OSF/1 kernel.  This is used
#       to build the DFS kernels.
   OSF1_KERNEL=/project/osc/build/osc_sbox1.2/obj/at386/kernel/DCE

and changing the lines in the libafs makefile to be:

dfsvmunix: ${OSF1_KERNEL}/vmunix.sys  ${KERNEL_LDDEP} ${afs_libs_dep}
${rpc_libs_dep}
        ${MACHO_GCC_EXEC_PREFIX}ld ${KERNEL_LDOPTS}  -e pstart -o dfsvmunix
${LIBDIRS} \
        ${OSF1_KERNEL}/vmunix.sys:P}  ${KERNEL_LDDEP} ${afs_libs} -lepidum
${afs_repeats} ${rpc_libs}

.ifndef NO_EPISODE
efsvmunix: ${OSF1_KERNEL}/vmunix.sys  ${KERNEL_LDDEP} ${afs_libs_dep}
${rpc_libs_dep} ${efs_libs_dep}
        ${MACHO_GCC_EXEC_PREFIX}ld ${KERNEL_LDOPTS}  -e pstart -o efsvmunix
${LIBDIRS} \
        ${OSF1_KERNEL}/vmunix.sys:P} ${KERNEL_LDDEP} ${afs_libs}
${efs_libs} ${afs_repeats} ${rpc_libs} 
.endif

[zeliff 9/24/93 public] 
Dropping severity & priority.  Should not have been and A0 -- must have
been a Rat reflex.

[9/28/93 public]
Work on this defect is currently gated on a problem in
file/AT386/machdep.mk which prevents me from testing this fix.  Since I
don't know if I'm going to get to this again I'm removing my name as
responsible engineer.

[9/28/93 public]
The defect this is gating on is 8697.

[10/08/93 public]
This fix is really only for internal consumption since OSF/1 
is not a supported platform.  On that basis, I'm cancelling.
If any of the DFS developers or RATS internal to OSF believes 
this change is important for internal use, please feel free
to re-open the bug and assign it to yourself.



CR Number                     : 8664
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 
Short Description             : bad behavior in rgy_edit "ktd"
Reported Date                 : 9/22/93
Found in Baseline             : 1.0.3
Found Date                    : 9/22/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[9/22/93 public]
When a user performs a 'ktd' (delete key table entry) operation on a 
nonexistent key table, two inappropriate events occur:
    1. A confusing (i.e., flat out wrong) error message is issued.
    2. The nonexistent key table file is created and a version number is 
       written to it.

Here's the scenario:
    rgy_edit => ktd -p cell_admin -v 1 -f no_such_file
    "?(rgy_edit) Unable to delete key from table - Key table entry not found
     (dce / krb)"

The reason this occurs is that the kerberos routine that opens key tables
(krb5_ktfileint_open() in ../krb5/lib/keytab/file/ktf_util.c) never returns
a "file not found" type of code. When it is called upon to open a file for
writing, if its first attempt to open the file fails due to nonexistence
it proceeds to create that file. This is appropriate behavior for the 'kta'
(add key table entry) case, but NOT for the 'ktd' case. This routine currently
has no way of knowing whether it has been called for "add" or "delete"
purposes; thus it behaves the same for both.

The net is that any time a user mistypes a key table filename in an rgy_edit
'ktd' session,a bogus key table will be created unbeknownst to him, and will
just sit around taking up space. The message is confusing too, since it implies
that a legitimate filename was supplied. If the routine instead returned the
"file not found" code in the "delete" path, the message would be the more
appropriate

    "?(rgy_edit) Unable to delete key from table - Specified key table not
    found (dce / sec)".



CR Number                     : 8661
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : udebug
Short Description             : udebug -long option useless
Reported Date                 : 9/22/93
Found in Baseline             : 1.0.3
Found Date                    : 9/22/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[9/22/93 public]
The -long option is only useful if you point udebug at the sync site.
If you point it at the sync site, you get the -long info printed
anyway.  Ergo, -long is useless and should be removed.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[9/23/93 public]
Changed Interest List CC from 
 `kdu@transarc.com,vijay@transarc.com,dstokes%austin.ibm.com@transarc.com' to 
 `kdu@transarc.com,vijay@transarc.com,dstokes%austin.ibm.com@transarc.com,rsarbo
 @osf.org'

[10/6/93 public]
Ron -- I just wanted to make sure you saw this.  dce_config uses the -long 
option to udebug.  It looks to me like -long isn't required. -- Mike

[10/11/93 public]
Ted informs me that this option is, in fact, useful after all in diagnosing
problems with establishing quorum.  I'm going to cancel this defect and
open a new one to deal with some user interface consistency problems.  
These new changes should not have any impact on udebug usage in dce_config.
Changed Status from `open' to `cancel'



CR Number                     : 8656
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : mx300
S/W Ref Platform              : sinix
Component Name                : rpc
Subcomponent Name             : 
Short Description             : closing fd 0 before server exports bindings causes CN/RPC hang
Reported Date                 : 9/22/93
Found in Baseline             : 1.0.2a
Found Date                    : 9/22/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/22/93 public]

A problem was detected when file descriptor 0 is closed by a server
prior to the point at which the server exports it's bindings. A test
program was provided which was shown at OSF to be capable of reproducing
the reported problem on the OSF SVR4 reference platform (Frenzy release
from SNI, installed at OSF on machine sni1). It was also demonstated that
the problem copuld not be reproduced on the other DCE refernce platforms.

	rios/aix
	pmax/osf1 (486/osf1 was not tried)
	hp/ux

The test program was pakaged along with instructions, and sent to SNI
for resolution.

More detail on what the program does, and what the problem looks like:

	This example illustrates a bug in the DCE RPC Runtime when the CN
        protocol is used. If file descriptor zero is closed prior to the
        server exporting its bindings, the server will sometimes forget to
        post the file descriptor for the TCP port when it does a
        select/poll call. 

        As a result of this problem, a client of the server will hang
        when it performs the corresponding rpc_mgmt_is_server_listening().

	The problem does not occur if the client uses a DG binding
        in the rpc_mgmt_is_server_listening() call, or id the server
        doesn not close file descriptor 0 before exporting it's bindings.

uuencoded tar archive of the test program including directions on how to
build and execute it is include below.
-------------
begin 644 sni.tar
M+@                                                          
M                                                            
M             # P,# W-34 ,# R,S8Q,@ P,# P,# Q # P,# P,# P,# P
M # U-#0V,S,U-C,P # P,3(R,#  -0                              
M                                                            
M                                          !U<W1A<@ P,&UO;GII
M;&QO                                ;W1H97(                 
M                   P,# P,# P # P,# P,#$                     
M                                                            
M                                                            
M                                                            
M                       N+U)%041-10                          
M                                                            
M                                    ,# P,#8T-  P,#(S-C$R # P
M,# P,#$ ,# P,# P,#4P-#$ ,#4T-#4Q,C(S,S  ,# Q,S$R-0 P        
M                                                            
M                                                            
M     '5S=&%R # P;6]N>FEL;&\                               !O
M=&AE<@                                   # P,# P,#  ,# P,# P
M,0                                                          
M                                                            
M                                                            
M                                             $%B8F5Y+ H*"51H
M:7,@8G5G('=A<R!R97!O<G1E9"!B>2!0>7)A;6ED+"!W:&\@9&5M;VYS=')A
M=&5D('1H870@=&AE('!R;V)L96T*9&ED(&YO="!E>&ES="!O;B Q+C N,B!0
M34%8+B!)(&AA=F4@<VEN8V4@9&5M;VYS=')A=&5D('1H870@,2XP+C(@56QT
M<FEX+"!A;F0*,2XP+C,@:'!U>"!T;R!B92!F<F5E(&]F('1H92!R97!O<G1E
M9"!P<F]B;&5M+@H*"4D@:&%V92!S96YT('EO=2!T:&5I<B!S86UP;&4@<')O
M9W)A;2X@0V]U;&0@>6]U('!L96%S92!T<GD@=&\@<F5P<F]D=6-E"G1H92!P
M<F]B;&5M(&]N(&%N(&%P<')O<')I871E("AK;F]W:6YG('=H870@4'ER86UI
M9"!I<R!W;W)K:6YG('=I=&@L(&%N9"!W:&%T"FES(&%V86EL86)L92!T;R!Y
M;W4I(')E;&5A<V4@;V8@=&AE(%-64C0@=F5R<VEO;B!O9B!$0T4N"@H)22!M
M861E('-O;64@<VUA;&P@8VAA;F=E<R!T;R!T:&4@=&]P(&QE=F5L(&UA:V5F
M:6QE('!R;W9I9&5D(&)Y('1H96TN"D]T:&5R=VES92P@22!W87,@86)L92!T
M;R!R=6X@=&AE('1E<W0@<')E='1Y(&UU8V@@8GD@9F]L;&]W:6YG('1H92!D
M:7)E8W1I;VYS"BAB96QO=RD@9VEV96X@8GD@4'ER86UI9"X@3VYE('=A>2!T
M;R!Q=6EC:VQY(&)U:6QD('1H92!T97-T('!R;V=R86TL('=O=6QD(&)E"G1O
M(&UA:V4@<W9R-"!S<&5C:69I8R!-86ME9FEL97,@*$UA:V5F:6QE+G-V<C0I
M(&)E;F5A=&@@=&AE(&-L:65N="!A;F0@<V5R=F5R"F1I<F5C=&]R:65S+"!A
M;F0@8VAA;F=E('1H92!V86QU92!O9B!-04-(24Y%(&EN('1H92!T;W @;&5V
M96P@;6%K969I;&4@=&\@(G-V<C0B"DD@;6%D92!T:&5S92!C:&%N9V5S(&9O
M<B!Y;W4L('EO=2!W:6QL(&IU<W0@:&%V92!T;R!M86ME('1H92!-86ME9FEL
M92YS=G(T(&9I;&5S"G-U:71A8FQE(&9O<B!U<V4@;VX@>6]U<B!0;&%T9F]R
M;2X*"E1H86YK<R!F;W(@>6]U<B!H96QP+@D*"E)O;B!-;VYZ:6QL;PI$0T4@
M<W5P<&]R= H*4%,Z($D@<F5V:65W960@=&AE($]4(&1A=&%B87-E+"!A;F0@
M:&%D(&$@8V]N=F5R<V%T:6]N('=I=&@@2F]H;B!$=6=A<PH@(" @;VX@:VYO
M=VX@<')O8FQE;7,@:6X@8VUA+"!W:&EC:"!M87D@:&%V92!B965N(')E;&%T
M960@=&\@=&AE('!R;V)L96T*(" @(%!Y<F%M:60@:7,@<V5E:6YG+B!/=7(@
M8V]N8VQU<VEO;B!W87,@=&AA="!T:&ES(&UA>2!R96%L;'D@8F4@86X@4U92
M- H@(" @<W!E8VEF:6,@<')O8FQE;2X*"E1H92!F;VQL;W=I;F<@8V%M92!F
M<F]M(%!Y<F%M:60*+2TM+2TM+2TM+2TM+2TM+2T*5&AI<R!E>&%M<&QE(&EL
M;'5S=')A=&5S(&$@8G5G(&EN('1H92!$0T4@4E!#(%)U;G1I;64@=VAE;B!T
M:&4@0TX@<')O=&]C;VP*:7,@=7-E9"X@268@9FEL92!D97-C<FEP=&]R('IE
M<F\@:7,@8VQO<V5D('!R:6]R('1O('1H92!S97)V97(@97AP;W)T:6YG(&ET
M<PIB:6YD:6YG<RP@=&AE('-E<G9E<B!W:6QL('-O;65T:6UE<R!F;W)G970@
M=&\@<&]S="!T:&4@9FEL92!D97-C<FEP=&]R(&9O<B!T:&4@5$-0"G!O<G0@
M=VAE;B!I="!D;V5S(&$@<V5L96-T+W!O;&P@8V%L;"X@5&\@:6QL=7-T<F%T
M92!T:&ES+"!W92!H879E(&$@*G9E<GDJ"G-I;7!L92!24$,@<')O9W)A;2!H
M97)E('1H870@97AP;W)T<R!A(&)I;F1I;F<@=&\@+RXZ+W9E;F1O<B]P>7)A
M;6ED+VYO=&AI;F<N"@I4:&4@<V5R=F5R(&UU<W0@8F4@<G5N('=I=&@@1$-%
M(&-R961E;G1I86QS('1H870@=VEL;"!A;&QO=R!I="!T;R!P;&%C90IA(&)I
M;F1I;F<@:6X@=&AE(&YA;65S<&%C92!A="!T:&%T(&QO8V%T:6]N+@H*+2!-
M;W9E(&-L:65N="]-86ME9FEL92X\=VAA=&5V97(^('1O($UA:V5F:6QE("AI
M;G-T96%D(&]F(&1O:6YG('1H:7,L(&UA:V4@>6]U<@H@(&]W;B!-86ME9FEL
M92YS=G(T('5S:6YG(&]N92!O9B!T:&4@97AI<W1I;F<@9FEL97,@87,@82!T
M96UP;&%T92X@=&AE;B!#:&%N9V4@=&AE"B @=F%L=64@;V8@34%#2$E.12!I
M;B!T:&4@=&]P(&QE=F5L($UA:V5F:6QE*2X@( HM($UO=F4@<V5R=F5R+TUA
M:V5F:6QE+CQW:&%T979E<CX@=&\@36%K969I;&4@*'-A;64@87,@<')E=FEO
M=7,I"BT@36]D:69Y($UA:V5F:6QE('1O('-E=" G4%))3D-)4$%,)PHM($QO
M9VEN(&%S(&-E;&Q?861M:6X*+2!M86ME(&YA;65S<&%C90HM($QO9VEN(&EN
M(&%S("=04DE.0TE004PG("A)('5S960@8V5L;%]A9&UI;BD*+2!-;V1I9GD@
M:6YC;'5D92]D;VYO=&AI;F<N:"!T;R!S970@>6]U<B!P<F5F97)R960@8FEN
M9&EN9R!L;V-A=&EO;BX@("AN;W0@;F5C97-S87)Y*0HM(&UA:V4@86QL"BT@
M4G5N('1H92!S97)V97(@=VET:"!T:&4@+7@@*&1E8G5G*2!A;F0@=&AE("UC
M("AC;&]S92!&1" P*2!O<'1I;VXN"BT@4G5N('1H92!C;&EE;G0O1$])5"!S
M8W)I<'0*"E1H92!C;&EE;G0@=VEL;"!H86YG('=H96X@:70@8VAE8VMS(')P
M8U]M9VUT7VES7W-E<G9E<E]L:7-T96YI;F<H*2X@268@=&AE"G-E<G9E<B!I
M<R!R=6X@=VET:&]U="!T:&4@+6,@;W!T:6]N("TM(&]R(&EF('1H92!C;&EE
M;G0@=7-E<R!T:&4@1$<@<')O=&]C;VPL"FYO(&AA;F<@;V-C=7)S+@H*3D]4
M13H*5&AI<R!B=6<@9&]E<R!N;W0@87!P96%R(&]N('1H92 Q+C N,B!034%8
M(')E9F5R96YC92!P;W)T+@IG:6X@87,@8V5L;%]A9&UI;@HM(&UA:V4@;F%M
M97-P86-E"BT@3&]G:6X@:6X@87,@)U!224Y#25!!3"<@*$D@=7-E9"!C96QL
M7V%D;6EN*0HM($UO9&EF>2!I;F-L=61E+V1O;F]T:&EN9RYH('1O('-E="!Y
M;W5R('!R969E<G)E9"!B:6YD:6YG(&QO8V%T:6]N+B @*&YO="!N96-E<W-A
M<GDI"BT@;6%K92!A;&P*+2!2=6X@=&AE('-E<G9E<B!W:71H('1H92 M>" H
M9&5B=6<I(&%N9"!T:&4@+6,@*&-L;W-E($9$(# I(&]P=&EO;BX*+2!2=6X@
M=&AE(&-L:65N="]$3TE4('-C<FEP= H*5&AE(&-L:65N="!W:6QL(&AA;F<@
M=VAE;B!I="!C:&5C:W,@<G!C7VUG;71?:7-?<V5R=F5R7VQI<W1E;FEN9R@I
M+B!)9B!T:&4*<V5R=F5R(&ES(')U;B!W:71H;W5T('1H92 M8R!O<'1I;VX@
M+2T@;W(@:68@=&AE(&-L:65N="!U<V5S('1H92!$1R!P<F]T;V-O;"P*;F\@
M:&%N9R!O8V-U<G,N"@I.3U1%.@I4:&ES(&)U9R!D;V5S(&YO="!A<'!E87(@
M;RXO36%K969I;&4                                             
M                                                            
M               P,# P-C0T # P,C,V,3( ,# P,# P,0 P,# P,# P,3(W
M,P P-30T-3$R,C$R-P P,#$S-S$T #                              
M                                                            
M                                            =7-T87( ,#!M;VYZ
M:6QL;P                               &]T:&5R                
M                    ,# P,# P,  P,# P,# Q                    
M                                                            
M                                                            
M                                                            
M                        4%))3D-)4$%,/6-E;&Q?861M:6X*4%))3D-)
M4$%,7U5)1#TQ,# *34%#2$E.13US=G(T"@IA;&PZ('-E<G9E<E]D:7(@8VQI
M96YT7V1I<@H*<V5R=F5R7V1I<CH*"6-D('-E<G9E<CL@;6%K92 M9B!-86ME
M9FEL92XD*$U!0TA)3D4I(&YO=&AI;F=?<V5R=F5R"@IC;&EE;G1?9&ER.@H)
M8V0@8VQI96YT.R!M86ME("UF($UA:V5F:6QE+B0H34%#2$E.12D*"F-L96%N
M.@H)8V0@<V5R=F5R.R!M86ME("UF($UA:V5F:6QE+B0H34%#2$E.12D@8VQE
M86X*"6-D(&-L:65N=#L@;6%K92 M9B!-86ME9FEL92XD*$U!0TA)3D4I(&-L
M96%N"@IC;&]B8F5R.@H)8V0@<V5R=F5R.R!M86ME("UF($UA:V5F:6QE+B0H
M34%#2$E.12D@8VQO8F)E<@H)8V0@8VQI96YT.R!M86ME("UF($UA:V5F:6QE
M+B0H34%#2$E.12D@8VQO8F)E<@H*=&%R9FEL93H*"71A<B!C=F8@+BXO;F]T
M:&EN9RY@9&%T92 G*R5M)60G8" N"@IN86UE<W!A8V4Z"@EC9'-C<"!C<F5A
M=&4@9&ER96-T;W)Y("\N.B]V96YD;W(*"6-D<V-P(&-R96%T92!D:7)E8W1O
M<GD@+RXZ+W9E;F1O<B]P>7)A;6ED"@EA8VQ?961I=" O+CHO=F5N9&]R+W!Y
M<F%M:60@+6T@=7-E<CHD*%!224Y#25!!3"DZ<G=D=&EC80H*8VQE86Y?;F%M
M97-P86-E.@H)8V1S8W @9&5L971E(&1I<F5C=&]R>2 O+CHO=F5N9&]R+W!Y
M<F%M:60*"6-D<V-P(&1E;&5T92!D:7)E8W1O<GD@+RXZ+W9E;F1O<@H*;&4N
M)"A-04-(24Y%*0H*8VQE86XZ"@EC9"!S97)V97([(&UA:V4@+68@36%K969I
M;&4N)"A-04-(24Y%*2!C;&5A;@H)8V0@8VQI96YT.R!M86ME("UF($UA:V5F
M:6QE+B0H34%#2$E.12D@8VQE86X*"F-L;V)B97(Z"@EC9"!S97)V97([(&UA
M:V4@+68@36%K969I;&4N)"A-04-(24Y%*2!C;&]B8F5R"@EC9"!C;&EE;G0[
M(&UA:V4@+68@36%K969I;&4N)"A-04-(24Y%*2!C;&]B8F5R"@IT87)F:6QE
M.@H)=&%R(&-V9B N+B]N;W1H:6YG+F!D871E("<K)6TE9"=@("X*"FYA;65S
M<&%C93H*"6-D<V-P(&-R96%T92!D:7)E8W1O<GD@+RXZ+W9E;F1O<@H)8V1S
M8W @8W)E82XO8VQI96YT                                        
M                                                            
M                       P,# P-S4U # P,C,V,3( ,# P,# P,0 P,# P
M,# P,# P,  P-30T-C,S-C$R-@ P,#$S-#4W #4                     
M                                                            
M                                                    =7-T87( 
M,#!M;VYZ:6QL;P                               &]T:&5R        
M                            ,# P,# P,  P,# P,# Q            
M                                                            
M                                                            
M                                                            
M                                +B]C;&EE;G0O8VQI96YT7V%R9W,N
M8P                                                          
M                                             # P,# V-#0 ,# R
M,S8Q,@ P,# P,# Q # P,# P,# P-38W # U-#,P-3(P,#0T # P,38Q-C< 
M,                                                           
M                                                            
M              !U<W1A<@ P,&UO;GII;&QO                        
M        ;W1H97(                                    P,# P,# P
M # P,# P,#$                                                 
M                                                            
M                                                            
M                                                       C:6YC
M;'5D92 B9&]N;W1H:6YG+F@B"@II;G0@<')O8V5S<U]C;&EE;G1?87)G<RAI
M;G0@87)G8RP@8VAA<B J87)G=EM=*0I["@ES:6=N960@:6YT(&,["@H)=VAI
M;&4@*"AC(#T@9V5T;W!T*&%R9V,L(&%R9W8L(")B.GAV(BDI("$]($5/1BD@
M>PH)"7-W:71C:"AC*2!["@D)8V%S92 G8B<Z"@D)"6)F;&%G(#T@5%)513L*
M"0D)8FEN9&EN9R ](&]P=&%R9SL*"0D)8G)E86L["@H)"6-A<V4@)W@G.@H)
M"0EX9FQA9R ](%12544["@D)"6)R96%K.PH*"0EC87-E("=V)SH*"0D)=F9L
M86<@/2!44E5%.PH)"0EB<F5A:SL*"@D)8V%S92 G/R<Z"@D)8V%S92 G:"<Z
M"@D)"65R<F9L9R ](%12544["@D)"6)R96%K.PH)"7T*"7T*"@ER971U<FXH
M97)R9FQG*3L*?0H()R,%"!@$        "0    $                    K
M*   [4$   (   "*)P   0                     "        5KR9+.@[
MG!Q6O)DLZ*,E)E:\F2SHHR4F  0   (   !U9G,                 R"4%
M" @    45 8(& 0  "XO8VQI96YT+V-L:65N=%]M86EN+F,             
M                                                            
M                               P,# P-C0T # P,C,V,3( ,# P,# P
M,0 P,# P,# P,30P,P P-30S,3$P,#0W-  P,#$V,30W #              
M                                                            
M                                                            
M=7-T87( ,#!M;VYZ:6QL;P                               &]T:&5R
M                                    ,# P,# P,  P,# P,# Q    
M                                                            
M                                                            
M                                                            
M                                        (VEN8VQU9&4@(F1O;F]T
M:&EN9RYH(@HC:6YC;'5D92 \<'1H<F5A9"YH/@H*:6YT"71C;W5N=" ](#$[
M"0D)"0II;G0)<F-O=6YT(#T@,3L)"0D*:6YT"6)F;&%G(#T@1D%,4T4["0D*
M:6YT"79F;&%G(#T@1D%,4T4["0II;G0)>&9L86<@/2!&04Q313L*:6YT"65R
M<F9L9R ]($9!3%-%.PD)"0D*8VAA<@DJ8FEN9&EN9R ]($))3D1)3D<["0D)
M"@IM86EN*&EN="!A<F=C+"!C:&%R("IA<F=V6UTI"GL*"79O:60)"55S86=E
M*"D["@H):68@*'!R;V-E<W-?8VQI96YT7V%R9W,H87)G8RP@87)G=BDI('L*
M"0E5<V%G92@I.PH)"65X:70H,2D["@E]"@H)9&]?:6UP;W)T7V)I;F1I;F<H
M8FEN9&EN9RP@)F=L;V)A;%]B:6YD:6YG7V@I.PH*"7!R:6YT9B@B4E!#(')E
M='5R;G,@)61<;B(L(&1O;F]T:&EN9R@Q,"DI.PH*?0H*=F]I9"!5<V%G92@I
M"GL*"69P<FEN=&8H<W1D97)R+" B57-A9V4Z(&QO;VMU<"!;+6A=(%LM>%T@
M6RUV72!;+6(@8FEN9&EN9UU<;B(I.PH)9G!R:6YT9BAS=&1E<G(L(")<="UH
M("T@:&5L<%QN(BD["@EF<')I;G1F*'-T9&5R<BP@(EQT+60@+2!D96)U9UQN
M(BD["@EF<')I;G1F*'-T9&5R<BP@(EQT+78@+2!V97)B;W-E7&XB*3L*"69P
M<FEN=&8H<W1D97)R+" B7'0M8B M('5S92!A(&1I9F9E<F5N="!B:6YD:6YG
M(&QO8V%T:6]N7&XB"@D)"2)<=" @(" @*&1E9F%U;'1S('1O("5S9W)O=7 @
M86YD("5S:&]S="E<;B(*"0D)(EQT(" @(" H8V%N(&YO="!B92!U<V5D('=I
M=&@@+6PI7&XB+" *"0D)0DE.1$E.1RP@0DE.1$E.1RD["GT*;&EE;G1?87)G
M<RAA<F=C+"!A<F=V*2D@>PH)"55S86=E*"D["@D)97AI="@Q*3L*"7T*"@ED
M;U]I;7!O<G1?8FEN9&EN9RAB:6YD:6YG+" F9VQO8F%L7V)I;F1I;F=?:"D[
M"@H)<')I;G1F*")24$,@<F5T=7)N<R E9%QN(BP@9&]N;W1H:6YG*#$P*2D[
M"@I]"@IV;VED(%5S86=E*"D*>PH)9G!R:6YT9BAS=&1E<G(L(")5<V%G93H@
M;&]O:W5P(%LM:%T@6RUX72!;+79=(%LM8B!B:6YD:6YG75QN(BD["@EF<')I
M;G1F*'-T9&5R<BP@(EQT+6@@+2XO8VQI96YT+V-L:65N=%]S=6)R+F,     
M                                                            
M                                       P,# P-C0T # P,C,V,3( 
M,# P,# P,0 P,# P,# P-#$W,@ P-30S,3$P,#4U-P P,#$V,C V #      
M                                                            
M                                                            
M        =7-T87( ,#!M;VYZ:6QL;P                              
M &]T:&5R                                    ,# P,# P,  P,# P
M,# Q                                                        
M                                                            
M                                                            
M                                                (VEN8VQU9&4@
M(F1O;F]T:&EN9RYH(@HC:6YC;'5D92 \9&-E+W)P8RYH/@H*=F]I9"!D;U]I
M;7!O<G1?8FEN9&EN9RAC:&%R(&5N=')Y7VYA;65;72P@<G!C7V)I;F1I;F=?
M:&%N9&QE7W0@*F)I;F1I;F=?:"D*>PH)=6YS:6=N960S,B @(" @('-T871U
M<SL@(" @(" @(" @(" @(" @+RH@97)R;W(@<W1A='5S("AN8F%S92YH*2 @
M(" @(" @("HO"@ER<&-?;G-?:&%N9&QE7W0@:6UP;W)T7V-O;G1E>'0[(" @
M(" @(" O*B!R97%U:7)E9"!T;R!I;7!O<G0@*')P8V)A<V4N:"D@*B\*"6-H
M87()"2IS=')I;F=?8FEN9&EN9SL*"@ED<')I;G1F*'-T9&5R<BP@(FEM<&]R
M=&EN9R!B:6YD:6YG(&9R;VT@)7-<;B(L(&5N=')Y7VYA;64I.PH*"7)P8U]N
M<U]B:6YD:6YG7VEM<&]R=%]B96=I;B@@("\J('-E="!C;VYT97AT('1O(&EM
M<&]R="!B:6YD:6YG(&AA;F1L97,@*B\*"0ER<&-?8U]N<U]S>6YT87A?9&5F
M875L="P@(" @(" @+RH@=7-E(&1E9F%U;'0@<WEN=&%X(" @(" @(" @(" @
M(" @(" @*B\*"0DH=6YS:6=N961?8VAA<E]T("HI96YT<GE?;F%M92P@+RH@
M8F5G:6X@<V5A<F-H('=I=&@@=&AI<R!N86UE(" @(" @(" @*B\*"0EN;W1H
M:6YG7W8Q7S!?8U]I9G-P96,L(" @(" O*B!I;G1E<F9A8V4@<W!E8VEF:6-A
M=&EO;B H;F]T:&EN9RYH*2 J+PH)"4Y53$PL(" @(" @(" @(" @(" @(" @
M(" @(" @(" O*B!N;R!O<'1I;VYA;"!O8FIE8W0@555)1"!R97%U:7)E9" @
M(" J+PH)"29I;7!O<G1?8V]N=&5X="P@(" @(" @(" @(" @(" O*B!I;7!O
M<G0@8V]N=&5X="!O8G1A:6YE9" @(" @(" @(" @(" J+PH)"29S=&%T=7,*
M"2D["@E#2$5#2U]35$%455,H<W1A='5S+" B0V%N)W0@8F5G:6X@:6UP;W)T
M.B(L($%"3U)4*3L*"@EW:&EL92@Q*2!["@D)<G!C7VYS7V)I;F1I;F=?:6UP
M;W)T7VYE>'0H(" @(" @(" @(" @(" O*B!I;7!O<G0@82!B:6YD:6YG(&AA
M;F1L92 J+PH)"0EI;7!O<G1?8V]N=&5X="P@(" @(" @("\J(&-O;G1E>'0@
M9G)O;2!R<&-?;G-?8FEN9&EN9U]I;7!O<G1?8F5G:6X@*B\*"0D)8FEN9&EN
M9U]H+" @(" @(" @(" @(" O*B!A(&)I;F1I;F<@:&%N9&QE(&ES(&]B=&%I
M;F5D(" @(" @(" @(" @("HO"@D)"29S=&%T=7,*"0DI.PH)"4-(14-+7U-4
M05154RAS=&%T=7,L(")#86XG="!I;7!O<G0@82!B:6YD:6YG(&AA;F1L93HB
M+"!!0D]25"D["@D)9'!R:6YT9BAS=&1E<G(L(")I;7!O<G0@;F5X="!R971U
M<FYE9"!O:UQN(BD["@H)"7)P8U]E<%]R97-O;'9E7V)I;F1I;F<H*F)I;F1I
M;F=?:"P@;F]T:&EN9U]V,5\P7V-?:69S<&5C+" F<W1A='5S*3L*"0E#2$5#
M2U]35$%455,H<W1A='5S+" B0V%N)W0@<F5S;VQV92!B:6YD:6YG.B B+"!2
M15-5344I.PH)"61P<FEN=&8H<W1D97)R+" B<F5S;VQV95]B:6YD:6YG(')E
M='5R;F5D("5D7&XB+"!S=&%T=7,I.PH)"6EF("AS=&%T=7,@(3T@<G!C7W-?
M;VLI"@D)"6-O;G1I;G5E.PH*"0ES=')I;F=?8FEN9&EN9R ]($Y53$P["@D)
M<G!C7V)I;F1I;F=?=&]?<W1R:6YG7V)I;F1I;F<H*F)I;F1I;F=?:"P@"@D)
M"2AU;G-I9VYE9%]C:&%R7W!?=" J*29S=')I;F=?8FEN9&EN9RP@)G-T871U
M<RD["@D)0TA%0TM?4U1!5%53*'-T871U<RP@(D-A;B=T(&-O;G9E<G0@8FEN
M9&EN9R!T;R!S=')I;F<Z("(L(%)%4U5-12D["@D):68@*'-T<FEN9U]B:6YD
M:6YG*0H)"0ED<')I;G1F*'-T9&5R<BP@(F-H96-K:6YG(&9O<B!D865M;VX@
M870@)7-<;B(L('-T<FEN9U]B:6YD:6YG*3L*"@D):68@*')P8U]M9VUT7VES
M7W-E<G9E<E]L:7-T96YI;F<H*F)I;F1I;F=?:"P@)G-T871U<RDI('L*"0D)
M9'!R:6YT9BAS=&1E<G(L(")S97)V97(@:7,@;&ES=&5N:6YG7&XB*3L*"0D)
M8G)E86L["@D)?0H)"61P<FEN=&8H<W1D97)R+" B<V5R=F5R(&ES(&YO="!L
M:7-T96YI;F=<;B(I.PH)"4-(14-+7U-405154RAS=&%T=7,L(")397)V97(@
M=V%S(&YO="!L:7-T96YI;F<Z("(L(%)%4U5-12D["@E]("\J96YD('=H:6QE
M("HO"@H*"7)P8U]N<U]B:6YD:6YG7VEM<&]R=%]D;VYE*" @(" @(" @(" @
M(" @(" O*B!D;VYE('=I=&@@:6UP;W)T(&-O;G1E>'0@*B\*"0DF:6UP;W)T
M7V-O;G1E>'0L(" @(" @(" @+RH@;V)T86EN960@9G)O;2!R<&-?;G-?8FEN
M9&EN9U]I;7!O<G1?8F5G:6X@*B\*"0DF<W1A='5S"@DI.PH)<F5T=7)N.PI]
M"@EI9B H<W1R:6YG7V)I;F1I;F<I"@D)"61P<FEN=&8H<W1D97)R+" B8VAE
M8VMI;F<@9F]R(&1A96UO;B!A=" E<UQN(BP@<W1R:6YG7V)I;F1I;F<I.PH*
M"0EI9B H<G!C7VUG;71?:7-?<V5R=F5R7VQI<W1E;FEN9R@J8FEN9&EN9U]H
M+" F<W1A='5S*2D@>PH)"0ED<')I;G1F*'-T9&5R<BP@(G-E<G9E<B!I<R!L
M:7-T96YI;F=<;B(I.PH)"0EB<F5A:SL*"0E]"@D)9'!R:6YT9BAS=&1E<G(L
M(")S97)V97(@:7,@;F]T(&QI<W1E;FEN9UQN(BD["@D)0TA%0TM?4U1!5%53
M*'-T871U<RP@(E-E<G9E<B!W87,@;F]T(&QI<W1E;FEN9SH@(BP@4D5354U%
M*3L*"7T@+RIE;F0@=VAI;&4@*B\*"@H)<G!C7VYS7V)I;F1I;F=?:6UP;W)T
M7V1O;F4H(" @(" @(" @(" @(" @("\J(&1O;F4@=RXO8VQI96YT+VYO=&AI
M;F<N86-F                                                    
M                                                       P,# P
M-C0T # P,C,V,3( ,# P,# P,0 P,# P,# P,#$P-@ P-30S,#4Q-# Q,0 P
M,#$U-C,T #                                                  
M                                                            
M                        =7-T87( ,#!M;VYZ:6QL;P              
M                 &]T:&5R                                    
M,# P,# P,  P,# P,# Q                                        
M                                                            
M                                                            
M                                                            
M    6PII;7!L:6-I=%]H86YD;&4H:&%N9&QE7W0@9VQO8F%L7V)I;F1I;F=?
M:"D*70II;G1E<F9A8V4@;F]T:&EN9PI["GT*"FYS7V)I;F1I;F=?:6UP;W)T
M7V)E9VEN("HO"@D))G-T871U<PH)*3L*"7)E='5R;CL*?0H):68@*'-T<FEN
M9U]B:6YD:6YG*0H)"0ED<')I;G1F*'-T9&5R<BP@(F-H96-K:6YG(&9O<B!D
M865M;VX@870@)7-<;B(L('-T<FEN9U]B:6YD:6YG*3L*"@D):68@*')P8U]M
M9VUT7VES7W-E<G9E<E]L:7-T96YI;F<H*F)I;F1I;F=?:"P@)G-T871U<RDI
M('L*"0D)9'!R:6YT9BAS=&1E<G(L(")S97)V97(@:7,@;&ES=&5N:6[P    
M      C[!0AE86L[R T  !!4!@@L6 8(     ,D-   L6 0(0!@%"#!8!@BX
M:@0("    "0O!@@     R%@$""<C!0@8!         D    !            
M        *R@  .U!   "    BB<   $                      @      
M &.\F2R(>XD)5KR9+.BC)296O)DLZ*,E)@ $   "    =69S            
M     ,@E!0@(    %%0&"!@$   N+V-L:65N="]$3TE4                
M                                                            
M                                        ,# P,#<U-0 P,#(S-C$R
M # P,# P,#$ ,# P,# P,# T-#( ,#4T,S U,34W,#$ ,# Q-#(Q,@ P    
M                                                            
M                                                            
M         '5S=&%R # P;6]N>FEL;&\                             
M  !O=&AE<@                                   # P,# P,#  ,# P
M,# P,0                                                      
M                                                            
M                                                            
M                                                 ",A+V)I;B]S
M: IS970@+7@*;6%K92!N;W1H:6YG"@H*"F5C:&\@5&AI<R!O;F4@=VEL;"!W
M;W)K"E)00U]355!03U)4141?4%)/5%-%45,];F-A9&=?:7!?=61P.R!E>'!O
M<G0@4E!#7U-54%!/4E1%1%]04D]44T514PHN+VYO=&AI;F<@+7@*"@H*96-H
M;R!4:&ES(&]N92!W:6QL(&AA;F<@249&('1H92!S97)V97(@=V%S('-T87)T
M960@=VET:"!T:&4@+6,@;W!T:6]N"E)00U]355!03U)4141?4%)/5%-%45,]
M;F-A8VY?:7!?=&-P.R!E>'!O<G0@4E!#7U-54%!/4E1%1%]04D]44T514PHN
M+VYO=&AI;F<@+7@*<V5R=F5R(&ES(&QI<W1E;FEN\          (^P4(96%K
M.\@-   05 8(+%@&"     #)#0  +%@$"$ 8!0@P6 8(N&H$" @    D+P8(
M     ,A8! @G(P4(& 0        )     0                   "LH  #M
M00   @   (HG   !                      (       !CO)DLV,WF#E:\
MF2SHHR4F5KR9+.BC)28 !    @   '5F<P                #()04("   
M !14!@@8!   +B]C;&EE;G0O36%K969I;&4N<&UA>                   
M                                                            
M                         # P,# V-#0 ,# R,S8Q,@ P,# P,# Q # P
M,# P,# Q-#4S # U-#0T,C$R,C,U # P,38Q,S4 ,                   
M                                                            
M                                                      !U<W1A
M<@ P,&UO;GII;&QO                                ;W1H97(     
M                               P,# P,# P # P,# P,#$         
M                                                            
M                                                            
M                                                            
M                                  !)1$Q#340)/0DO;W!T+V1C92]B
M:6XO:61L("UV"D-#"3T)9V-C"DE.0TP)/0DM22X@+4DN+B]I;F-L=61E("U)
M+W5S<B]I;F-L=61E"D1)3D-,"3T)+4D@+V]P="]D8V4O<VAA<F4O:6YC;'5D
M92 M22]O<'0O9&-E+W-H87)E+VEN8VQU9&4O9&-E"DQ)3E0)/0EL:6YT("U)
M)"A$24Y#3"D*3$E"4PD]"2UL9&-E("UL:0I#1$5&4PD]"0I#3U-&,0D]"0I#
M1DQ!1U,)/0DD*$E.0TPI("0H1$E.0TPI(" M1$-,245.5" M1$1#12 D*$-$
M1493*2 D*$-/4T8Q*0H*(PHC($-/35!,151%($)524Q$(&]F('1H92!A<'!L
M:6-A=&EO;BX*(PIA;&PZ(" @(&YO=&AI;F<*"@HC"B,@1$-%($E.5$521D%#
M12!"54E,1" *(PII;G1E<F9A8V4Z"6YO=&AI;F<N: IN;W1H:6YG+F@@;F]T
M:&EN9U]C<W1U8BYC.@DN+B]I;F-L=61E+VYO=&AI;F<N:61L(&YO=&AI;F<N
M86-F"@D@(" D*$E$3$--1"D@+4DN+B]I;F-L=61E("UK965P(&-?<V]U<F-E
M("US97)V97(@;F]N92 N+B]I;F-L=61E+VYO=&AI;F<N:61L"@HC"B,@1$-%
M($-,245.5"!"54E,1" *(PI#3$E%3E1?3T)*4R ]8VQI96YT7W-U8G(N;R!N
M;W1H:6YG7V-S='5B+F\@8VQI96YT7V%R9W,N;R!C;&EE;G1?;6%I;BYO"FYO
M=&AI;F<Z"6YO=&AI;F<N:" D*$-,245.5%]/0DI3*0H)(" @"20H0T,I("0H
M0T9,04=3*2 M;R!N;W1H:6YG("0H0TQ)14Y47T]"2E,I("0H3$E"4RD*"@HC
M"B,@36ES8V5L;&%N96]U<PHC"F-L96%N.@H)<FT@+68@8V]R92 J+F\@*E]C
M<W1U8BH@*E]S<W1U8BH@;F]T:&EN9RYH("I?<V%U>"H@<W1U8BYC"@IC;&]B
M8F5R.B!C;&5A;@H)<FT@+68@;F]T:&EN9PH*"F%L;#H@(" @;F]T:&EN9PH*
M"B,*(R!$0T4@24Y415)&04-%($)524Q$( HC"FEN=&5R9F%C93H);F]T:&EN
M9RYH"FYO=&AI;F<N:"!N;W1H:6YG7V-S='5B+F,Z"2XN+VEN8VQU9&4O;F]T
M:&EN9RYI9&P@;F]T:&EN9RYA8V8*"2 @("0H241,0TU$*2 M22XN+VEN8VQU
M9&4@+6ME97 @8U]S;W5R8V4@+7-E<G9E<B!N;VYE("XN+VEN8VQU9&4O;F]T
M:&EN9RYI9&P*"B,*(R!$+B]C;&EE;G0O36%K969I;&4N9&-O<W@         
M                                                            
M                                 # P,# V-#0 ,# R,S8Q,@ P,# P
M,# Q # P,# P,# R,C0V # U-#,Q,3 S-3$S # P,38S,#, ,           
M                                                            
M                                                            
M  !U<W1A<@ P,&UO;GII;&QO                                ;W1H
M97(                                    P,# P,# P # P,# P,#$ 
M                                                            
M                                                            
M                                                            
M                                          !)1$Q#340)/0DO;W!T
M+V1C92]B:6XO:61L("UV"D-&3$%'4PD]"2U/("U)+B M22XN+VEN8VQU9&4@
M+41$0T4@+41#3$E%3E0*0T,)/0DO;W!T+V1C92]B:6XO8V,*24Y#3 D]"2]U
M<W(O:6YC;'5D90I$24Y#3 D]"2]O<'0O9&-E+W-H87)E+VEN8VQU9&4*3$E.
M5 D]"6QI;G0@+4DD*$1)3D-,*0I,24)3"3T)+6QG96Y?<@I83$E"4PD]"2UL
M6&UP("UL6&T@+6Q78R M;&1L("UL6&UU("UL6'0@+6Q897AT("UL6#$Q"@HC
M"B,@0T]-4$Q%5$4@0E5)3$0@;V8@=&AE(&%P<&QI8V%T:6]N+@HC"F%L;#H@
M(" @;F]T:&EN9PH*"B,*(R!$0T4@24Y415)&04-%($)524Q$( HC"FEN=&5R
M9F%C93H);F]T:&EN9RYH"FYO=&AI;F<N:"!N;W1H:6YG7V-S='5B+F,Z"2XN
M+VEN8VQU9&4O;F]T:&EN9RYI9&P@;F]T:&EN9RYA8V8*"2 @("0H241,0TU$
M*2 M22XN+VEN8VQU9&4@+6ME97 @8U]S;W5R8V4@+7-E<G9E<B!N;VYE("XN
M+VEN8VQU9&4O;F]T:&EN9RYI9&P*"B,*(R!$0T4@0TQ)14Y4($)524Q$( HC
M"D-,245.5%]/0DI3(#UC;&EE;G1?<W5B<BYO(&YO=&AI;F=?8W-T=6(N;R!C
M;&EE;G1?87)G<RYO(&-L:65N=%]M86EN+F\*;F]T:&EN9SH);F]T:&EN9RYH
M("0H0TQ)14Y47T]"2E,I"@D@(" ))"A#0RD@)"A#1DQ!1U,I("UO(&YO=&AI
M;F<@)"A#3$E%3E1?3T)*4RD*"@HC"B,@36ES8V5L;&%N96]U<PHC"F-L96%N
M.@H)<FT@+68@8V]R92 J+F\@*E]C<W1U8BH@*E]S<W1U8BH@;F]T:&EN9RYH
M("I?<V%U>"H@<W1U8BYC"@IC;&]B8F5R.B!C;&5A;@H)<FT@+68@;F]T:&EN
M9PH*(PHC($1E<&5N9&5N8VEE<PHC"D-(14-+7U-405154U])3D-,541%4PD]
M"20H24Y#3"DO<W1D:6\N:" D*$1)3D-,*2]D8V4O9&-E7V5R<F]R+F@@)"A$
M24Y#3"DO9&-E+W!T:')E860N:"!<"@D)"0DD*$1)3D-,*2]D8V4O<G!C97AC
M+F@*;F]T:&EN9U](7TE.0TQ51$53"3T)( DD*$E.0TPI+W-T9&QI8BYH("0H
M24Y#3"DO<W1D:6\N:" D*$E.0TPI+W-T<FEN9RYH(%P*"0D)"20H24Y#3"DO
M<WES+W1Y<&5S+F@@)"A)3D-,*2]C='EP92YH("0H24Y#3"DO<WES+VUM86XN
M:"!<"@D)"0DD*$E.0TPI+W-Y<R]S=&%T+F@@)"A)3D-,*2]F8VYT;"YH("0H
M24Y#3"DO87-S97)T+F@@7 H)"0D))"A)3D-,*2]8,3$O26YT<FEN<VEC+F@@
M)"A)3D-,*2]8;2]4;V=G;&5"+F@@7 H)"0D))"A#2$5#2U]35$%455-?24Y#
M3%5$15,I"G5S"B,*8VQE86XZ"@ER;2 M9B!C;W)E("HN;R J7V-S='5B*B J
M7W-S='5B*B!N;W1H:6YG+F@@*E]S875X*B!S='5B+F,*"F-L;V)B97(Z(&-L
M96%N"@ER;2 M9B!N;W1H:6YG"@HC"B,@1&5P96YD96YC:65S"B,*0TA%0TM?
M4U1!5%537TE.0TQ51$53"3T))"A)3D-,*2]S=&1I;RYH("0H1$E.0TPI+V1C
M92]D8V5?97)R;W(N:" D*$1)3D-,*2]D8V4O<'1H<F5A9"YH(%P*"0D)"20H
M1$E.0TPI+V1C92]R<&-E>&,N: IN;W1H:6YG7TA?24Y#3%5$15,)/0D@"20H
M24Y#3"DO<W1D;&EB+F@@)"A)3D-,*2]S=&1I;RYH("0H24Y#3"DO<W1R:6YG
M+F@@7 H)"0D))"A)3D-,*2]S>7,O='EP97,N:" D*$E.0TPI+V,N+V-L:65N
M="]-86ME9FEL92YS=G(T                                        
M                                                            
M    ,# P,#8T-  P,#(S-C$R # P,#$W-3  ,# P,# P,#$T-C, ,#4T-#8S
M,S,T,30 ,# Q-34U-@ P                                        
M                                                            
M                                 '5S=&%R # P;6]N>FEL;&\     
M                          !O<V8                             
M         # P,# P,#  ,# P,# P,0                              
M                                                            
M                                                            
M                                                            
M             $E$3$--1 D]"2]O<'0O9&-E+V)I;B]I9&P@+78*0T,)/0DO
M;W!T+V1C96QO8V%L+V)I;B]C8PI)3D-,"3T)+4DN("U)+BXO:6YC;'5D92 M
M22]U<W(O:6YC;'5D90I$24Y#3 D]"2U)("]O<'0O9&-E+W-H87)E+VEN8VQU
M9&4@+4DO;W!T+V1C92]S:&%R92]I;F-L=61E+V1C90I,24Y4"3T);&EN=" M
M220H1$E.0TPI"DQ)0E,)/0D*0T1%1E,)/0D*0T]31C$)/0D*0T9,04=3"3T)
M)"A)3D-,*2 D*$1)3D-,*2 @+41#3$E%3E0@+41$0T4@)"A#1$5&4RD@)"A#
M3U-&,2D*"B,*(R!#3TU03$5412!"54E,1"!O9B!T:&4@87!P;&EC871I;VXN
M"B,*86QL.B @("!N;W1H:6YG"@H*(PHC($1#12!)3E1%4D9!0T4@0E5)3$0@
M"B,*:6YT97)F86-E.@EN;W1H:6YG+F@*;F]T:&EN9RYH(&YO=&AI;F=?8W-T
M=6(N8SH)+BXO:6YC;'5D92]N;W1H:6YG+FED;"!N;W1H:6YG+F%C9@H)(" @
M)"A)1$Q#340I("U)+BXO:6YC;'5D92 M:V5E<"!C7W-O=7)C92 M<V5R=F5R
M(&YO;F4@+BXO:6YC;'5D92]N;W1H:6YG+FED; H*(PHC($1#12!#3$E%3E0@
M0E5)3$0@"B,*0TQ)14Y47T]"2E,@/6-L:65N=%]S=6)R+F\@;F]T:&EN9U]C
M<W1U8BYO(&-L:65N=%]A<F=S+F\@8VQI96YT7VUA:6XN;PIN;W1H:6YG.@EN
M;W1H:6YG+F@@)"A#3$E%3E1?3T)*4RD*"2 @( DD*$-#*2 D*$-&3$%'4RD@
M+6\@;F]T:&EN9R D*$-,245.5%]/0DI3*2 D*$Q)0E,I"@H*(PHC($UI<V-E
M;&QA;F5O=7,*(PIC;&5A;CH*"7)M("UF(&-O<F4@*BYO("I?8W-T=6(J("I?
M<W-T=6(J(&YO=&AI;F<N:" J7W-A=7@J('-T=6(N8PH*8VQO8F)E<CH@8VQE
M86X*"7)M("UF(&YO=&AI;F<*"@IA;&PZ(" @(&YO=&AI;F<*"@HC"B,@1$-%
M($E.5$521D%#12!"54E,1" *(PII;G1E<F9A8V4Z"6YO=&AI;F<N: IN;W1H
M:6YG+F@@;F]T:&EN9U]C<W1U8BYC.@DN+B]I;F-L=61E+VYO=&AI;F<N:61L
M(&YO=&AI;F<N86-F"@D@(" D*$E$3$--1"D@+4DN+B]I;F-L=61E("UK965P
M(&-?<V]U<F-E("US97)V97(@;F]N92 N+B]I;F-L=61E+VYO=&AI;F<N:60N
M+W-E<G9E<@                                                  
M                                                            
M            ,# P,#<U-0 P,#(S-C$R # P,# P,#$ ,# P,# P,# P,#  
M,#4T-#8S,S8Q,C8 ,# Q,S4P-P U                                
M                                                            
M                                         '5S=&%R # P;6]N>FEL
M;&\                               !O=&AE<@                  
M                 # P,# P,#  ,# P,# P,0                      
M                                                            
M                                                            
M                                                            
M                     "XO<V5R=F5R+W-E<G9E<E]A<F=S+F,         
M                                                            
M                                   P,# P-C0T # P,C,V,3( ,# P
M,# P,0 P,# P,# P,#8R-@ P-30S,#4R,#$P,0 P,#$V,C,U #          
M                                                            
M                                                            
M    =7-T87( ,#!M;VYZ:6QL;P                               &]T
M:&5R                                    ,# P,# P,  P,# P,# Q
M                                                            
M                                                            
M                                                            
M                                            (VEN8VQU9&4@(F1O
M;F]T:&EN9RYH(@H*:6YT('!R;V-E<W-?<V5R=F5R7V%R9W,H:6YT(&%R9V,L
M(&-H87(@*F%R9W9;72D*>PH):6YT(&,["@H)=VAI;&4@*"AC(#T@9V5T;W!T
M*&%R9V,L(&%R9W8L(")C>'9H8CHB*2D@(3T@14]&*0H)"7-W:71C:"AC*2![
M"@D)8V%S92 G8B<Z"@D)"6)I;F1I;F<@/2!O<'1A<F<["@D)"6)F;&%G(#T@
M5%)513L*"0D)8G)E86L["@H)"6-A<V4@)V,G.@H)"0EC9FQA9R ](%12544[
M"@D)"6)R96%K.PH*"0EC87-E("=X)SH*"0D)>&9L86<@/2!44E5%.PH)"0EB
M<F5A:SL*"@D)8V%S92 G=B<Z"@D)"79F;&%G(#T@5%)513L*"0D)8G)E86L[
M"@H)"6-A<V4@)S\G.@H)"6-A<V4@)V@G.@H)"0EE<G)F;&<@/2!44E5%.PH)
M"0EB<F5A:SL*"0E]"@D*"7)E='5R;BAE<G)F;&<I.PI]"@  SS@  .U!   "
M    BB<   $                      @       %6\F2S0\*0U5KR9+&BV
MY@Y6O)DL:+;F#@ $   "    =69S                 ,@E!0@(    %%0&
M"!@$   N+W-E<G9E<B]S97)V97)?;6%I;BYC                        
M                                                            
M                    ,# P,#8T-  P,#(S-C$R # P,# P,#$ ,# P,# P
M,#0R,30 ,#4T-#0R,#<U-S4 ,# Q-C(U,  P                        
M                                                            
M                                                 '5S=&%R # P
M;6]N>FEL;&\                               !O=&AE<@          
M                         # P,# P,#  ,# P,# P,0              
M                                                            
M                                                            
M                                                            
M                             "-I;F-L=61E(")D;VYO=&AI;F<N:"(*
M"FEN= EB9FQA9R ]($9!3%-%.PD)"0H*:6YT"6-F;&%G(#T@1D%,4T4["0D)
M"0II;G0)=F9L86<@/2!&04Q313L)"0D)"FEN= EX9FQA9R ]($9!3%-%.PD)
M"0D*:6YT"65R<F9L9R ]($9!3%-%.PD)"0D*8VAA<@DJ8FEN9&EN9R ]($))
M3D1)3D<["0D)"G-T871I8R!V;VED(%5S86=E*"D["@IM86EN*&EN="!A<F=C
M+"!C:&%R("IA<F=V6UTI"GL*(" @"75N<VEG;F5D,S(@(" @(" @(" @('-T
M871U<SL@(" @(" @(" @+RH@97)R;W(@<W1A='5S("AN8F%S92YH*2 @(" @
M(" @*B\*(" @"7)P8U]B:6YD:6YG7W9E8W1O<E]T("IB:6YD:6YG7W9E8W1O
M<CL@+RH@8FEN9&EN9R!H86YD;&4@;&ES=" H<G!C8F%S92YH*2 J+PH*"6EF
M("AP<F]C97-S7W-E<G9E<E]A<F=S*&%R9V,L(&%R9W8I*2!["@D)57-A9V4H
M*3L*"0EE>&ET*#$I.PH)?0H*"@EI9B H8V9L86<I"@D)8VQO<V4@*# I.PH*
M"6EF("AS971U<%]S97)V97)?8FEN9&EN9W,H8FEN9&EN9RDI('L*"0EF<')I
M;G1F*'-T9&5R<BP@(F-O=6QD(&YO="!E>'!O<G0@8FEN9&EN9W,@=&\@;F%M
M92!S<&%C95QN(BD["@D)97AI="@Q*3L*"7T*"@EF<')I;G1F*'-T9&5R<BP@
M(FYO=&AI;F<@<V5R=F5R(&ES(')E861Y7&XB*3L*"@H)+RHJ*BHJ*BHJ*BHJ
M*BHJ*BHJ*BH@3$E35$5.($9/4B!214U/5$4@4%)/0T5$55)%($-!3$Q3("HJ
M*BHJ*BHJ*BHJ*BHJ*BHJ*BHO"@E44ED@(" @(" @(" @(" @(" @(" @(" @
M(" @(" @(" @(" O*B!T:')E860@97AC97!T:6]N(&AA;F1L:6YG(&UA8W)O
M("HO"@H)"7)P8U]S97)V97)?;&ES=&5N* H)"0ER<&-?8U]L:7-T96Y?;6%X
M7V-A;&QS7V1E9F%U;'0L"@D)"29S=&%T=7,*"0DI.PH)"4-(14-+7U-40515
M4RAS=&%T=7,L(")R<&,@;&ES=&5N(&9A:6QE9#HB+"!215-5344I.PH)"@E&
M24Y!3$Q9(" @(" @(" @(" @(" @(" @(" @(" @(" @(" @(" @(" @+RH@
M97)R;W(@<F5C;W9E<GD@86YD(&-L96%N=7 @*B\*"0ER<&-?<V5R=F5R7VEN
M<5]B:6YD:6YG<R@@(" @(" @(" @(" @(" @("\J(&=E="!B:6YD:6YG(&EN
M9F]R;6%T:6]N("HO"@D)"29B:6YD:6YG7W9E8W1O<BP*"0D))G-T871U<PH)
M"2D["@D)0TA%0TM?4U1!5%53*'-T871U<RP@(D-A;B=T(&=E="!B:6YD:6YG
M(&EN9F]R;6%T:6]N.B(L(%)%4U5-12D["@D*"0ER<&-?97!?=6YR96=I<W1E
M<B@@(" @(" O*B!R96UO=F4@96YD<&]I;G1S(&9R;VT@;&]C86P@96YD<&]I
M;G0@;6%P("HO"@D)"6YO=&AI;F=?=C%?,%]S7VEF<W!E8RP@("\J(&EN=&5R
M9F%C92!S<&5C:69I8V%T:6]N("AN;W1H:6YG+F@I("HO"@D)"6)I;F1I;F=?
M=F5C=&]R+" @(" @(" @(" @(" @(" O*B!V96-T;W(@;V8@<V5R=F5R(&)I
M;F1I;F<@:&%N9&QE<R J+PH)"0E.54Q,+" @(" @(" @(" @(" @(" @(" @
M(" @(" @(" @(" @(" @(" @(" @(" O*B!N;R!O8FIE8W0@555)1',@*B\*
M"0D))G-T871U<R *"0DI.PH)"4-(14-+7U-405154RAS=&%T=7,L(")#86XG
M="!R96UO=F4@96YD<&]I;G1S(&9R;VT@96YD<&]I;G0@;6%P.B(L(%)%4U5-
M12D["@D*"0ER<&-?8FEN9&EN9U]V96-T;W)?9G)E92@@(" @(" @(" @(" @
M+RH@9G)E92!S97)V97(@8FEN9&EN9R!H86YD;&5S("HO"@D)"29B:6YD:6YG
M7W9E8W1O<BP*"0D))G-T871U<PH)"2D[(" *"0E#2$5#2U]35$%455,H<W1A
M='5S+" B0V%N)W0@9G)E92!S97)V97(@8FEN9&EN9R!H8[tom 10/19/93 public]
Since This is not a problem on any other reference platform,
I am lowering this to a B2.

[04/01/94 public]
Canceling this defect since it doesn't appear OSF is going to get
the SVR4 fix for it, and it doesn't happen on any other platform.



CR Number                     : 8636
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : 
Short Description             : rpc_ep_resolve_binding() core dumps
Reported Date                 : 9/20/93
Found in Baseline             : 1.0.2a
Found Date                    : 9/20/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : comif.c
Sensitivity                   : public

[9/20/93 public]
A application does the following and gets a core dump:

do_import_binding(entry_name, binding_h)
unsigned_char_t         *entry_name;
rpc_binding_handle_t    binding_h;
{
  rpc_ns_handle_t import_context;
  error_status_t  status;

  rpc_ns_binding_import_begin(rpc_c_ns_syntax_default,
                              (unsigned_char_t *)entry_name,
                              message_v1_0_c_ifspec,
                              NULL,
                              &import_context,
                              &status);
  CHECK_STATUS(status, "Error (rpc_ns_binding_import_begin):", ABORT);

  rpc_ns_binding_import_next(import_context,
                             (rpc_binding_handle_t *)binding_h,
                             &status);
  CHECK_STATUS(status, "Error (rpc_ns_binding_import_next):", ABORT);

  rpc_ns_binding_import_done(&import_context,
                             &status);
  CHECK_STATUS(status, "Error (rpc_ns_binding_import_done):", ABORT);

  rpc_ep_resolve_binding((rpc_binding_handle_t )binding_h,
                         message_v1_0_c_ifspec,
                         &status);
  CHECK_STATUS(status, "Error (rpc_ep_resolve_binding):", ABORT);
}



(gdb) where
#0  0xa41d6f49 in rpc__if_set_wk_endpoint (4198648, 4202756, -1073743680)
#1  0xa41dcc66 in ep_get_endpoint (4198648, 4202724, -1073743680)
#2  0xa41dcb15 in rpc_ep_resolve_binding (4202724, 4198648, -1073743680)
#3  0x400748 in do_import_binding (
    entry_name=0x47b330 "/.:/users/rousseau/alarm_server", binding_h=0x4020e4)
    at send_alarm.c:138
#4  0x400354 in main (argc=4, argv=0xbffff92c) at send_alarm.c:78


The track of the routines:

rpc_ep_resolve_binding (binding_h, if_spec_h, status)
{
    rpc_binding_rep_p_t     binding_rep = (rpc_binding_rep_p_t) binding_h;
...
    RPC_BINDING_VALIDATE_CLIENT (binding_rep, status);

    if (!binding_rep->addr_has_endpoint)
    {
        /*
         * The binding is partially bound. Prevent other threads
         * from using this handle while we are trying to resolve
         * it.
         */
        ep_get_endpoint ((rpc_if_rep_p_t) if_spec_h, binding_rep, status);
    }

...
}

ep_get_endpoint (if_r, binding_r, st)
{

    rpc_addr = &binding_r->rpc_addr;

    /*
     * Get the endpoint from the i/f spec, if present.
     */
    rpc__if_set_wk_endpoint (if_r, rpc_addr, st);

...
}

rpc__if_set_wk_endpoint (ifspec, rpc_addr, status)
{
    /*
     * get the endpoint from the if spec
     */
    rpc__if_inq_endpoint (
        ifspec,
        (*rpc_addr)->rpc_protseq_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  probable core dump
        &endpoint,
        status);

...
}

Looking at the RPC internals guide, I find this description for the
rpc_addr field of a binding handle:

rpc_addr        An rpc_addr_p_t representing the address of the client (or
                server) half of this binding.  It is initialized to NULL
                if the binding refers to the local host.  Otherwise, it is
                initialized to a protocol-specific value via a call to the
                protocol server specified in "protocol_id"


In this case, the server is on the local host, and the rpc_addr field 
is NULL.

I am testing out a fix in comif.c, rpc__if_set_wk_endpoint():

    /*
     * get the endpoint from the if spec
     */
+    if (*rpc_addr == NULL)
+    {
+        *status = rpc_s_endpoint_not_found;
+        return;
+    }
    rpc__if_inq_endpoint (

[09/20/93 public]
The fix did not work:
(gdb) where
#0  0xa41d8f62 in rpc__naf_addr_set_endpoint (endpoint=0xa41dd7ae "", 
    rpc_addr=0x402104, status=0xbffffad4)
    at /project/dce/build/dce1.0.3/src/rpc/runtime/comnaf.c:437
#1  0xa41dde0e in ep_get_endpoint (if_r=0x4010f8, binding_r=0x4020e4, 
    st=0xbffffb0c) at /project/dce/build/dce1.0.3/src/rpc/runtime/comep.c:2055
#2  0xa41dd6b5 in rpc_ep_resolve_binding (binding_h=0x4020e4, 
    if_spec_h=0x4010f8, status=0xbffffb0c)
    at /project/dce/build/dce1.0.3/src/rpc/runtime/comep.c:1596
#3  0x400748 in do_import_binding (
    entry_name=0x47b330 "/.:/users/rousseau/alarm_server", binding_h=0x4020e4)
    at send_alarm.c:138
#4  0x400354 in main (argc=4, argv=0xbffffb78) at send_alarm.c:78

I am now investigating taking some code from rpc_binding_to_string_binding()
which gets an rpc_addr if the binding doesn't have one.

This might work, but I am uncertain as to when the rpc_addr in a binding
needs to be non-NULL, or if it might be required for it to be NULL in certain
cases.  The code in rpc_binding_to_string_binding() certainly expects
it to be NULL on certain occasions.

[09/21/93 public]

Since this happens in the CLEANUP path, earlier failed call may be free'ing
rpc_addr (== &binding_r->rpc_addr)? If that's the case, you may want to
keep **rpc_addr to somewhere else for the CLEANUP path.

[09/21/93 public]
Well, the problem is that binding_r->rpc_addr is NULL to start with,
so the restoration shouldn't be done.

I am guessing that you could never resolve a 'local' binding with
this routine, because it had this NULL address field.  This code
is *not* set up to handle this case.

This is looking to be a larger can of worms than I though....
Anyone at HP have thoughts on this?

[09/22/93 public]
Turns out this was a problem in the source code, the binding_h was
being cast to a pointer when it wasn't a pointer.

Not a bug in RPC
Canceled.



CR Number                     : 8635
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : rs_prop_tasks
Short Description             : uninit cond var. dumps core while exiting
Reported Date                 : 9/20/93
Found in Baseline             : 1.0.2
Found Date                    : 9/20/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rs/rs_prop_tasks.c
Sensitivity                   : public

[9/20/93 public]
  I have a core file in which the path seems clear. prop_driver_sleep()
was invoked by the  rs_e_prop_long_incommunicado  task and with
*n_bad_prop_state == 2 . This causes the routine to skip any setting of
sleep_cv (only happens in the >else clause of the routines initial >if)
and yet invoke pthread_cond_timedwait() with this uniit'd variable.
  The Solaris OS SEGV'd with this. The evidence includes the fact that
*n_bad_prop_state == 2 and sleep_secs came out to 240, which matches
the >if,>if clause's arithmetic -- it isn't 15*60 as the >else path
would have it be.
......................................................................
  This happened immediately following an unrelated fatal error
in which a checkpoint failed (apparently, rename() is NOT atomic;
I am debugging that one independently as it must be a platform issue).
......................................................................
  THAT managed to happen because of a situation in another OT I filed
weeks ago -- fatal errors leave secd running on both of our platforms
because the CATCH clauses call fatal_st() which gets the DT killed
before it can fall through to the exit() call below their TRY block.
This bug is fixed locally and was not in the build that rocuded the
cond-var error.

[9/20/93 public]
  The cause of the two back-to-back bad state errors is that the
secd was "in limbo" -- it had had a fatal error, but the error in
fatal error handling left it running. But the checkpoint task died, the
rs_state remained stuck in ..._renaming through two prop-task sleeps.
Filled in Reported by Company's Ref. Number with `8928'

[9/20/93 public]
The above scenario describes a problem with secd crashing while in the middle
of failing because of another problem.  That other problem is likely to be
very serious and would be considered high priority.  This problem of it not
handling a fatal error as cleanly as it could, on a non-reference platform
does not warrant a priority of 0, so I have lowered it to 2 so that it will
not affect more serious problems that we are working on.  If and when the
problem that caused the initial fatal to occur is found, please open a
separate defect (CR) to describe it.

[9/20/93 public]
  My fault for confusing things. This OT report represents *only* the
uninitalized cond var core dumper, which could happen independently if a
checkpoint+rename sequence took an unusually long time to complete, or
if the prop tasks were blocked by incompatible states for long enough
(maintanence?).
  The other bugs I brought up will, if they require the OSF's attention,
eventually become independent reports.
  I think the cond-var bug is higher than a C2 rating, but I will accept
your rating.

[8/9/93 public]

In rs_prop_task.c, prop_driver_sleep now properly initializes the
sleep_cv variable defaulting to &prop_long_incommunicado_cv. Unless
any objections are raised I am going to close this one in a couple of
days.

[8/10/93 public]

Cancelled as for previuos note



CR Number                     : 8631
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : dfs_config
Short Description             : HP dfs_config does not load Episode
Reported Date                 : 9/17/93
Found in Baseline             : 1.0.2a
Found Date                    : 9/17/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[9/17/93 public]
In dfs_config, the name of the Episode extension is incorrectly spelled as
"dce_episode" rather than "dfs_episode".
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[09/17/93 public]
The OSF dfs_config does not have this problem.  
Which dfs_config are you using?

[10/6/93 public]
We agree that the problem seems to have gone away.  Canceling.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 8622
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : CPOPT not set to -p
Reported Date                 : 9/17/93
Found in Baseline             : 1.0.3
Found Date                    : 9/17/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : dce_com_env
Sensitivity                   : public

[9/17/93 public]
The CPOPT variable, which should be set to '-p' to preserve 
source file permisions and dates was remove from dce_config
and never placed in to dce_com_env.

[09/17/93 public]
Oops.
Was looking at an old copy of dce_com_env.
Canceled.



CR Number                     : 8613
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8602,9754
Project Name                  : dce
H/W Ref Platform              : i486,other
S/W Ref Platform              : osf1,other
Component Name                : bld
Subcomponent Name             : build
Short Description             : spurious Signal 11 during build
Reported Date                 : 9/16/93
Found in Baseline             : 1.0.3
Found Date                    : 9/16/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : ./lbe/bin/make/dir.c,make.c,var.c,lst.lib/lstDeQueue.c
Sensitivity                   : public

[9/16/93 public]

During the course of a build on the 486 I have been frequently seeing
spurious Signal 11's.   


# rm ../../../obj/at386/file/flserver/flserver
# build
relative path: ./file/flserver
cd /usr/sandbox/delgado/laugh/new486/obj/at386/file/flserver
exec make MAKEFILE_PASS=FIRST  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTA  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=FIRSTB  _SUBMAKE_=_IS_SUBMAKE_  build_all
exec make MAKEFILE_PASS=THIRD  _SUBMAKE_=_IS_SUBMAKE_  build_all
*** Signal 11

Stop.
#

Now if I say "build flserver" things will work:

# build flserver
relative path: ./file/flserver
cd /usr/sandbox/delgado/laugh/new486/obj/at386/file/flserver
/project/dce/build/dce1.0.3/tools/at386/macho/gcc -B/project/dce/build/dce1.0.3/tools/at386/macho/
-%ld," -warn_nopic -glue"  -O        -L/usr/sandbox/delgado/laugh/new486/export/at386/usr/shlib -L/u
sr/sandbox/delgado/laugh/new486/export/at386/usr/shlib -L/project/dce/build/dce1.0.3/export/at386/us
r/shlib -L/usr/shlib -L/usr/sandbox/delgado/laugh/new486/export/at386/usr/lib     -L/usr/sandbox/del
gado/laugh/new486/export/at386/usr/lib     -L/project/dce/build/dce1.0.3/export/at386/usr/lib   -o f
lserver.X fldb_proc_sstub.o flserver.o flutils.o flprocs.o  -lnubik -lcmd -lafsutil -lncompat   -lfl
db -ldacl -ldauth -ldacllfs -ldacl -ldauth  -ldacllfs -losi -lcommondata -lcom_err  -licl -ldce -laf
ssys -lbsd
mv flserver.X flserver
#


I'd like to point out that this is also showing up in the nighly build
logs on the 486.  The problem is that the Signal 11 will not be flagged
as an error, so generally the error checking scripts will not pick this
up.  The end result is that install will complain because some targets
haven't been built.

The nightly build log from 09-13-93 manifests this problem:$ 

fgrep "Signal 11" build.log.09-13-93
*** Signal 11 (continuing)
*** Signal 11 (continuing)
*** Signal 11 (continuing)
*** Signal 11 (continuing)
*** Signal 11 (continuing)
*** Signal 11 (continuing)
*** Signal 11 (continuing)
$

-Wtrigraphs -Wcomment -DEPI_USE_FULL_ID -DDACL_EPISODE -DDACL_COMPILE_FOR_EPI
  -I. -I/u1/devobj/sb/nb_486/src/file/security/dacl_lfs -I/project/dce/build/dce
1.0.3-snap/src/file/security/dacl_lfs  -I../dacl -I/u1/devobj/sb/nb_486/src/file
/security/dacl -I/project/dce/build/dce1.0.3-snap/src/file/security/dacl -I/u1/d
evobj/sb/nb_486/export/at386/usr/include -I/project/osc/build/osc_sbox1.2/export
/at386/usr/include -I/project/osc/build/osc1.2/export/at386/usr/include -I/proje
ct/dce/build/dce1.0.3-snap/export/at386/usr/include -I/project/osc/build/osc_sbo
x1.2/export/at386/usr/include -I/project/osc/build/osc1.2/export/at386/usr/inclu
de  -pic-lib   -L/u1/devobj/sb/nb_486/export/at386/usr/shlib -L/project/dce/buil
d/dce1.0.3-snap/export/at386/usr/shlib -L/usr/shlib -L/u1/devobj/sb/nb_486/expor
t/at386/usr/lib     -L/project/dce/build/dce1.0.3-snap/export/at386/usr/lib    -
ldce   /project/dce/build/dce1.0.3-snap/src/file/security/dacl/dacl_print.c
/project/dce/build/dce1.0.3-snap/tools/at386/macho/gcc -B/project/dce/build/dce1
.0.3-snap/tools/at386/macho/  -%ld," -warn_nopic -glue"  -O        -L/u1/devobj/
sb/nb_486/export/at386/usr/shlib -L/project/dce/build/dce1.0.3-snap/export/at386
/usr/shlib -L/usr/shlib -L/u1/devobj/sb/nb_486/export/at386/usr/lib     -L/proje
ct/dce/build/dce1.0.3-snap/export/at386/usr/lib   -o testacl.epi.X testacl.o dac
l_print.o dfssec_errorStrings.o ../dacl/libdacl.a libdacllfs.a  -lafssys -losi -
lcmd -lcmdAux -lcom_err -ldce -lbsd
mv testacl.epi.X testacl.epi
[ /file/security/dfsauth at 00:52 (AM) Tuesday ]
makepath dfsauth/. && cd dfsauth &&  exec make MAKEFILE_PASS=BASIC     build_all
*** Signal 11 (continuing)
:

[9/17/93 public]
Reassigned to Chris Doherty.  Changed to severity to C because there is a
workaround.  Priority remains high because this does need to be cleaned up
soon.

[10/08/93 public]
Chris is leaving the group, so reassigned it to me.
It appears to be a restriction in the DCE make. the corrct thing to do is
upgrade make to run ODE2.3 make.
This has been designalted to happen in 1.1 time frame since we are so close
to a release.

[01-13-94 public]

Cancelling this defect because we have moved to the ODE2.3 make.

[03-29-94]

This bug still has significance to our 1.0.3 customers, and is a good
candidate for repair in the 1.0.3 patch repository. I believe the problem
reported above to have been caused by multiple frees of the same memory.

I checked that ode2.3 make, and found that the fixes reported below, had
already been made.

The changes captured in the following diffs were shown to fix the "signal
11 problem" on our port to the Sequent machine.

Also, the problem reported on hpux as "signal 10" in OT 9754 
may have been simply a different operating systems way of reporting the
same problem (SIGBUS instead of SIGSEGV).

===================================================================
RCS file: ./lbe/bin/make/lst.lib/lstDeQueue.c,v
retrieving revision 1.1
retrieving revision 1.1.2.1
*** 1.1	1994/03/07 16:31:46
--- 1.1.2.1	1994/03/22 21:03:47
***************
*** 96,107 ****
      if (tln == NilListNode) {
  	return ((ClientData) NIL);
      }
!     
      if (Lst_Remove (l, (LstNode)tln) == FAILURE) {
  	return ((ClientData) NIL);
      } else {
! 	rd = tln->datum;
  	(void) free ((char *)tln);
  	return (rd);
      }
  }
--- 100,113 ----
      if (tln == NilListNode) {
  	return ((ClientData) NIL);
      }
! 
!     rd = tln->datum;    
      if (Lst_Remove (l, (LstNode)tln) == FAILURE) {
  	return ((ClientData) NIL);
      } else {
! /* depend on Lst_Remove to do memory management
  	(void) free ((char *)tln);
+         */
  	return (rd);
      }
diff -c -r1.1 -r1.1.2.1
  }
===================================================================
RCS file: ./lbe/bin/make/var.c,v
retrieving revision 1.1
retrieving revision 1.1.2.1
diff -c -r1.1 -r1.1.2.1
*** 1.1	1994/03/07 16:33:00
--- 1.1.2.1	1994/03/22 21:02:53
***************
*** 1765,1772 ****
  		    ln = Lst_Member(ctxt->context, (ClientData)valVar);
  		    Lst_Remove(ctxt->context, ln);
  		    Buf_Destroy(valVar->val, TRUE);
  		    free((Address)valVar);
! 
  		    break;
  		}
  		case 'D':
--- 1778,1786 ----
  		    ln = Lst_Member(ctxt->context, (ClientData)valVar);
  		    Lst_Remove(ctxt->context, ln);
  		    Buf_Destroy(valVar->val, TRUE);
+ /* depend on Lst_remove to do memory management
  		    free((Address)valVar);
!                     */
  		    break;
  		}
  		case 'D':
===================================================================
RCS file: ./lbe/bin/make/make.c,v
retrieving revision 1.1
retrieving revision 1.1.2.1
diff -c -r1.1 -r1.1.2.1
*** 1.1	1994/03/07 16:32:46
--- 1.1.2.1	1994/03/22 21:09:18
***************
*** 352,358 ****
--- 356,364 ----
  			gn = (GNode *)Lst_Datum (aln);
  			Var_Set (argName, gn->name, pgn);
  			Lst_Remove (pgn->children, aln);
+ /* Depend on Lst_Remove to do memory management
  			free((char *)aln);
+                         */
  			pgn->unmade--;
  		    }
  		}
===================================================================
RCS file: ./lbe/bin/make/dir.c,v
retrieving revision 1.1
retrieving revision 1.1.2.1
d*** 1.1	1994/03/07 16:32:34
--- 1.1.2.1	1994/03/22 21:07:09
***************
*** 1454,1463 ****
  
  	ln = Lst_Member (openDirectories, (ClientData)p);
  	(void) Lst_Remove (openDirectories, ln);
- 
  	Hash_DeleteTable (&p->files);
  	free((Address)p->name);
  	free((Address)p);
      }
  }
  
--- 1461,1471 ----
  
  	ln = Lst_Member (openDirectories, (ClientData)p);
  	(void) Lst_Remove (openDirectories, ln);
  	Hash_DeleteTable (&p->files);
  	free((Address)p->name);
+ /* Depend on Lst_Remove to do memory management
  	free((Address)p);
+ 	*/
      }
  }
iff -c -r1.1 -r1.1.2.1



CR Number                     : 8610
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : ode/workon
Short Description             : WORKON doesn't see SHELL variable
Reported Date                 : 9/15/93
Found in Baseline             : 1.0.3
Found Date                    : 9/15/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/15/93 public]

After changing over to using the Korn shell on an HP I discovered that the
ODE WORKON command did nothing.  After some help and more experimenting on
my own I discovered that the two commands I had for setting up the shell
variables were not sufficient.  They were:

SHELL=`which ksh`
shell=$SHELL

The following screen output shows what happened:

qbarry@chlorine-KSH> echo $shell $SHELL
/bin/ksh /bin/ksh
qbarry@chlorine-KSH> workon
cd'ing to sandbox source directory: /usr/users/qbarry/sb/tetized/src.
project: dce
starting new shell: /bin/ksh.
qbarry@chlorine-KSH> pwd
/users/qbarry
qbarry@chlorine-KSH> shell=/bin/ksh
qbarry@chlorine-KSH> SHELL=/bin/ksh
qbarry@chlorine-KSH> echo $shell $SHELL
/bin/ksh /bin/ksh
qbarry@chlorine-KSH> workon
cd'ing to sandbox source directory: /usr/users/qbarry/sb/tetized/src.
project: dce
starting new shell: /bin/ksh.
My ksh setup done.
qbarry@chlorine-KSH> pwd
/usr/users/qbarry/sb/tetized/src
qbarry@chlorine-KSH> 


Notice that after I went back and changed the shell variables to what they
already were, then WORKON functioned properly.  I subsequently changed my
logon procedure to say

#SHELL=`which ksh`
#shell=$SHELL
shell=/bin/ksh
SHELL=/bin/ksh

and now WORKON works just fine.  I did check to see that KSH was actually
in /bin/ksh and it was.

[09/15/93 public]
This is *not* a DCE bug, but an ODE bug and should be filed in the 
correct database (project ode).

[03/28/94 public]
As I stated above, this is an ODE bug.
Canceled.



CR Number                     : 8594
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : lrgy
Short Description             : wrong auth_src from valid_and_cert_ident?
Reported Date                 : 9/14/93
Found in Baseline             : 1.0.2
Found Date                    : 9/14/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/14/93 public]
  sec_clientd and rpcd are up on a cellmember, but the secd's are down.
A certified login is attempted by a user whose recent login was stashed
in the host's LRGY. The login sees a successful return from sec_login_-
valid_and_cert_ident(), with an auth_src of ".._network". The login
handle, when cast as a sec_login_context_t, shows a state of only
"setup" and an auth_src of ".._local" e.g.
                                                                      .
$15 = {cell = 0x0 "/.../k2.dce.transarc.com", '\000' <repeats 1000 times>,
  principal = 0x0 "travis", '\000' <repeats 1018 times>, identity = 0x53a28,
  krb_info = {cache = 0x53e28, pepper = {pa_type = 0, length = 0,
      contents = 0x0}, num_caches = 0, prev_caches = 0x0,
    tgt_data = 0x106f28}, state = setup, auth_src = sec_login_auth_src_local,
  flags = 0, local = 1, refreshed = 0, refcount = 2, cache_link_next = 0x0,
  cache_link_prev = 0x0, context_name = 0x0, context_name_len = -1, mark = 0,
  namecache = 0x0, namecache_name = 0x0, modtimes = {datafile = 0,
    cachefile = 0, namefile = 0}}
(gdb) cont
                                                                      .
  The login image, for lack of the auth_src==local situation, then
proceeds to try and obtain account expiration dates (and so forth) using
the return login handle. Many of the calls fail due to the context state
of the login handle (which equals 'setup').
  Perhaps this problem report is simply a set of inquires:
  1)  What should a login image do in this case? What information
      about the validity of the account can be determined?
  2)  Why does valid_and_cert_ident() return an auth_src different than
      that stored in the login handle context?
  3)  Likewise, why does valid_and_cert_ident() return TRUE when the
      sec login handle remains in the 'setup' state?
  We want to avoid a case in which a cell with the default 4w local-rgy
cache lifetime allows an expired account to log in during a sec-server
outage, and (more importantly) to be certain that we understand this
situation in which the LRGY comes into use.

[10/7/93 public]
Not reproducible with the current build of 1.0.3 (it sets auth_src to
sec_login_auth_src_local like it should).  If this isn't reproducible on
1.0.3 by next Friday (the freeze date for 1.0.3 bugs), I'm cancelling this CR.

[10/12/93 public]
Still not reproducable in 1.0.3.  Cancelled.



CR Number                     : 8580
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : 
Short Description             : - /u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase.h:332: dce/ker/exc_handling_ids_krpc.h: No such file or directory
Reported Date                 : 9/10/93
Found in Baseline             : 1.0.3
Found Date                    : 9/10/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/10/93 public]

- /u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase.h:332: dce/ker/exc_
handling_ids_krpc.h: No such file or directory

- /u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase.h:338: dce/ker/idl_
ss_krpc.h: No such file or directory

- /project/dce/build/dce1.0.3-snap/tools/at386/macho/gcc -B/project/dce/build/dc
e1
.0.3-snap/tools/at386/macho/  -c       -D_BSD -DCOMPAT_43 -DMACH -D__OSF__ -DNID
L_PROTOTYPES -DIDL_PROTOTYPES  -DAT386 -Wtrigraphs -Wcomment  -pic-none -nostdin
c -pedantic -Wpointer-arith -D_KERNEL -DKERNEL -DIDL_LIB_FLAG -DMIA    -I. -I/u1
/devobj/sb/nb_486/src/rpc/idl/klib -I/project/dce/build/dce1.0.3-snap/src/rpc/id
l/klib  -I../lib -I/u1/devobj/sb/nb_486/src/rpc/idl/lib -I/project/dce/build/dce
1.0.3-snap/src/rpc/idl/lib -I/u1/devobj/sb/nb_486/export/at386/usr/include/kerne
l -I/project/osc/build/osc_sbox1.2/export/at386/usr/include/kernel -I/project/os
c/build/osc_sbox1.2/export/at386/usr/include/kernel -I/u1/devobj/sb/nb_486/expor
t/at386/usr/include -I/project/osc/build/osc_sbox1.2/export/at386/usr/include -I
/project/dce/build/dce1.0.3-snap/export/at386/usr/include -I/project/osc/build/o
sc_sbox1.2/export/at386/usr/include   /project/dce/build/dce1.0.3-snap/src/rpc/i
dl/lib/alfrsupp.c
In file included from /project/dce/build/dce1.0.3-snap/src/rpc/idl/lib/alfrsupp.
c:61:
/u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase.h:302: dce/ker/pthrea
d_exc.h: No such file or directory
In file included from /u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase
.h:326, from /project/dce/build/dce1.0.3-snap/src/rpc/idl/lib/alfrsupp.c:61:
/u1/devobj/sb/nb_486/export/at386/usr/include/dce/rpcexc.h:108: dce/ker/exc_hand
ling.h: No such file or directory
In file included from /project/dce/build/dce1.0.3-snap/src/rpc/idl/lib/alfrsupp.
c:61:
/u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase.h:332: dce/ker/exc_ha
ndling_ids_krpc.h: No such file or directory
/u1/devobj/sb/nb_486/export/at386/usr/include/dce/stubbase.h:338: dce/ker/idl_ss
_krpc.h: No such file or directory
*** Error code 1 (continuing)

[09/10/93 public]
Since this is 486 DFS stuff, reassigning to Diane.

[09/27/93 public]
Diane,

Is this still a bug?  Please close/cancel if not...

[09/30/93 public]
Doesn't look like this is still a bug, and we don't build DFS 
on the 486 for 1.0.3.  Canceled.



CR Number                     : 8561
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdscp show object
Short Description             : show object fails on preferred clearinghouse
Reported Date                 : 09/07/93
Found in Baseline             : 1.0.3
Found Date                    : 09/07/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[09/07/93 public]

Doing a "cdscp show object /.:/<testdir>/<object>" on a secondary clearinghouse
failed 6% of the time (52,700 failures out of 875,000 attempts).  My test
attempts to show 1000 objects (100 objects on 10 directories) after doing
a "set cdscp preferred clearinghouse /.:/tahiti_ch command".  This test
had never failed before on 1.0.3.  My test does the following:

	cdscp set directory <testdir> to skulk
	cdscp show obj /.:/<testdir>/<object>
	echo "set cdscp preferred clearinghouse /.:/tahiti_ch" > /.cdscpinit
	cdscp show obj /.:/<testdir>/<object>
	rm /.cdscpinit

The configuration being used was:

  hp    = DCE 1.0.3 Nightly Build Available 09/03/93
  i486  = DCE 1.0.3 Nightly Build Available 09/03/93
  rios  = DCE 1.0.3 Nightly Build Available 09/03/93
  pmax  = DCE 1.0.2a Final

  largo (hp)    - SEC Master, CDS Client, DTS Clerk
  west (hp)     - SEC Client, CDS Server, DTS Local Server, dts_ntp_provider
  dce9 (pmax)   - SEC Client, CDS Client, DTS Clerk
  soldier (rios)- SEC Client, CDS Client, DTS Local Server
  tahiti (i486) - SEC Slave, CDS Replica, DTS Local Server
  brandy (hp)   - SEC Client, CDS Client, DTS Clerk

[09/07/93 public]
Cancelled, further investigation showed that the create replica command
had failed during the directory/object setup causing the errors.



CR Number                     : 8554
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config / nls/msg
Short Description             : Message files not installed correctly by dce_config
Reported Date                 : 09/03/93
Found in Baseline             : 1.0.3
Found Date                    : 09/03/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[09/03/93 public]

The following message files are not installed by dce_config:

	dcethd.cat
	gdsdithelp.cat
	gdssyshelp.cat
	dfsbmb.cat
	dfsftu.cat
	dfsicl.cat
	dfsrep.cat
	dfszbd.cat
	dfszcm.cat
	dfszfl.cat
	dfszft.cat
	dfszhs.cat
	dfszpx.cat
	dfszuk.cat
	dfszxv.cat

The following message file tries to be installed but does not exist:

	dcethreads.cat

[09/03/93 public]

Cancelled, after looking at dce_config I found that the "LIST" is
not used.



CR Number                     : 8553
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : libdce load -L's are wrong
Reported Date                 : 9/2/93
Found in Baseline             : 1.0.3
Found Date                    : 9/2/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/2/93 public]
The general directive is:  "do something about this."

Here's a synopsis of the mail exchange which resulted in this defect being
opened: 

Tom Jordahl:
-----------
The link line for libdce.sl on the HP's looks like this:

ld -b -L/build/tom/rpc/export/hp800/usr/shlib 
	-L/build/tom/rpc/export/hp800/usr/shlib 
	-L/project/dce/build/dce1.0.3/export/hp800/usr/shlib 
	-L/usr/shlib 
	-L/build/tom/rpc/export/hp800/usr/lib     
	-L/build/tom/rpc/export/hp800/usr/lib     
	-L/project/dce/build/dce1.0.3/export/hp800/usr/lib   
- -o libdce.sl.X libdce_1.o libdce_2.o libdce_3.o libdce_4.o  -lm   

There are a few things wrong with this:

	- /usr/lib and /lib are not specified

	- Why is -lm specified?  It wont find it given the -L switches.

	- all the 'shlib' directories are incorrect for TARGET_OS other
	  than OSF/1 (and perhaps SVR4).

Howard:
------

/usr/lib and /lib are the default locations.  The HP linker looks in the -
-L's before the default locations which are /usr/lib and lib.  The -b says
use a .sl before a .a if you have a choice.

-lm is specified because something in libdce needs (at least used to)
something from the math library, but I forget what.  If it doesn't any
more, it should be removed.  Getting a list of undefined symbols from
libdce and seeing if any are in libm.a would be the way to find out.

If these -L's appear in builds on other machines, then that is a bug.  The
only thing that looks like it won't work on other machines in the above
list is /usr/shlib.  The others are all in the export tree that is part of
a sandbox and is immaterial to what platform it's on.  (I think we always
put our .sl's in <dcelocal>/usr/shlib and our .a's in <dcelocal>/usr/lib.

Now, I'm not sure how these -L's are generated.  Are they machine specific
or not?  Each Makefile (or component.mk file) is responsible to define
LIBFLAGS that are good for all machines and ${TARGET_MACHINE}_LIBFLAGS for
the machine-specific ones.  Yes in 1.1 this will probably have an
OS-specific flavor too.

Tom adds:
--------
The directory shlib is not used for anything on non-OSF/1 platforms.
libdce is installed into /opt/dcelocal/lib on the HP's and exported to
/usr/lib.

The export paths that have shlib in them are useless.
The -L's for HP should be:

	-L/project/dce/build/dce1.0.3/export/hp800/usr/lib
	-L<sandbox>/export/hp800/usr/lib

[12/23/93 public]
Removed my name as responsible engineer.

[1/22/94 public]
 Added my name as responsible engineer

[7/1/94 ]
[Reassigned to Annie

[2/6/96 public]
Here is what works fine for us:

/vob/dce/external/hp800/bin/ld -b -L/vob/dce/export/hp800/usr/shlib -L/vob/dce/export/hp800/usr/lib -L/vob/dce/external/hp800/lib -L/vob/dce/external/hp800/usr/lib -L/vob/dce/external/hp800/lib -L/vob/dce/external/hp800/usr/lib -o libdce.sl.X libdce_1.o libdce_2.o libdce_3.o libdce_4.o -lm

So cancelling the defect.



CR Number                     : 8540
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : DEFTOOLBASE should be a path
Reported Date                 : 8/30/93
Found in Baseline             : 1.1
Found Date                    : 8/30/93
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : possibly Buildconf,
osf.dce.mk, and/or osf.std.mk
Sensitivity                   : public

[8/30/93 public]
Not sure of the severity or priority of this, so I did D2.

DEFTOOLBASE is currently just a single directory that is stuck before tools
(e.g. idl) before the are run.  It should be a path like most other ODE
things so that some tools can be found in my sandbox and other gotten from
either the shared sandbox or backing tree.

To do this you probably need to separate the functionality of the current
DEFTOOLSBASE into two parts:

 1.  Where tools built during the setup pass are places.  I recommend
     using a name like SETUPDIR to match IDIR, and EXPDIR.

 2.  Where tools are found during a build.  I recommend using something
     like TOOLSPATH.

[1/21/94 public]
DEFTOOLBASE is meant to be a single directory path.  When creating tools,
it needs to know specifically where to place the tools (during setup pass).
Of course we could easily change the name of DEFTOOLBASE to SETUPDIR, but 
you'd only really see this in the Buildconf file.

The reasoning to have just one place for tools is so developers wouldn't
have to compile tools and there is an assurance that tools are the latest
and greatest.  Also so (accidently) old tools don't get used within a 
developers sandbox. This can be a case where having that additional option
may not necessarily be a good thing, if people "forget" about the way
a TOOLSPATH (search path) gets used.  

Please comment.

[1/21/94 public]
I really don't understand your argument.  I am suggesting it work like
everything else in a sandbox environment.  If not found in the sandbox
check the backing tree.  The idea being that what the developer is working
on is in the sandbox and the "official" version is in the backing tree.
The sanbox version is probably "later" but not ready for "official".

Currently in a sandbox I work on what I need and get everything else from
the backing tree.  We don't have backed objects, but for the most part I
keep a fully populated object tree and only rebuild objects I'm currently
working on.  The same would be true of tools.  My thought is I have a
TOOLSPATH that first looks in my sandbox and second looks in by backing
tree (just like everything else).  While working on a tool I do builds into
my sandbox and those newly built tools are used for the rest of the build
process.  If I'm not working on a tool I either get it from my sandbox or
from the backing tree.  If I don't work on tools, I probably would never
have them in my sandbox.  If I do have them in my sandbox I have to worry
about them getting out of date just like everything else in my sandbox.

The point of this CR is to make it easier to work on tools, particularly
idl.

[7/1/94 ]
 reassigned to annie

[8/24/94 public]
I propose that we cancel this CR.  Re-doing how DEFTOOLBASE is used
in the common makefiles will only serve to to further impact an
already tight project schedule.  We are about to enter functional freeze
and having as many clean builds as possible is more important than
providing fixes that effect only a small number of people.

[8/24/94 public]
Re-opened.  This defect will be equally as true in 1.2 as it is now.



CR Number                     : 8525
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : cn runtime
Short Description             : bad choice of socket error to
exception mapping
Reported Date                 : 8/29/93
Found in Baseline             : 1.0.2
Found Date                    : 8/29/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/29/93 public]
On cma_connect error EISCONN, rpc runtime raises rpc_x_connection_closed.
This precludes partitioning cn communication errors into those 
raised during a connect and those occuring during a sendmsg or recvmsg.

Mapping to something other than rpc_x_connection_closed(aborted), for
example, rpc_x_is_already_connected, would simplify application error 
handling.

Someone might take a moment to examine the semantics of runtime when
this socket error is encountered - superficially it would seem like
a very bad situation.  An application writer might just (re)try another
binding upon receiving rpc_x_connection_closed.


See OT 7239 for more info on the socket error to exception mapping.

[09/03/93 public]
Humm...  I'm not sure what code you are talking about here.
In cnnet.c, the routine rpc__socket_connect() is called.  This
routine does a connect() (I assume it gets mapped to cma_connect)
and returns any error back up to rpc__socket_connect() (variable 'serr').

Serr, is examined for rpc_c_socket_eisconn, and set to ok if this is
the case.  Otherwise, is is mapped to a status code by 
rpc__cn_network_serr_to_status().  This routine seems harmless
enough and doesn't map the errors to anything untoward.

This is the only code I can find in RPC that refers to EISCONN.
OT 7239 isn't relevant info to this problem.  I believe you meant 7293.

[09/28/93 public]
If I don't get any more information on this bug, I will cancel it
as unable to reproduce.

[09/29/93 public]
I discovered this "bug" by munging cma_connect to to return EISCONN and then
making an rpc. The result returned was rpc_x_connection closed, but it
may have come from the subsequent cma_sendmsg on a non-existent 
connection. I had assumed runtime would be unhappy with EISCONN and the
rpc would fail during the connect.

If this is the case then no special status is required for EISCONN in
the current runtime implementation. 

I am curious, however, if runtime's coming across an already connected
socket is "normal"? Or, should it be considered an error condition?

[09/29/93 public]
It is normal for isconnected to be true in CN rpc.  If you are
trying to connect, why worry if it's already done!

I would also believe that places in RPC are not too carefull when
opening an association, that the connect hasn't already been done.

There is not a bug here.  Canceled.



CR Number                     : 8510
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : 
Short Description             : dfs server goes catatonic
Reported Date                 : 8/24/93
Found in Baseline             : 1.0.3
Found Date                    : 8/24/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/24/93 public]
I've got an HP server that is exporting /usr/local binaries
to a single HP client. For the first few days, it worked
without incident.  However, since then I've been unable to
keep the server up for more than a few hours.  The symptom
is that the server goes completely catatonic.  The screen
refresher doesn't respond to keyboard input, the machine
doesn't respond to pings, and worse yet, the TOC button on
the back of the machine has no effect.  The kernel debugger
is of no use either.  The only way to recover is to hit
the power switch on the front of the machine and reboot.
This obviously does not produce a core dump.  I've been
unable to get pim_info either.  I suspect an infinite kernel
loop (at splhi?), but some shred of debug info is going
to be required to start tracking this one down.

[10/8/93 public]
Since I haven't seen this problem since I filed the bug, the
configuration that reproduced it has been torn down, and 
there's really no useful information to save in this report 
(other than it happened), I'm cancelling this bug.



CR Number                     : 8499
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : rpc_binding_set_auth_info
Short Description             : The rpc_binding_set_auth_info
randomly returns auth ticket expired status.
Reported Date                 : 8/23/93
Found in Baseline             : 1.0.2
Found Date                    : 8/23/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/23/93 public]

This problem has been discovered by the DME development group running 1.0.2
on 486 platform. Here are the details as mailed to me from the DME developer:

   The rpc_binding_set_auth_info API intermittenly return the DCE status 
   "auth ticket expired" (don't know the mnemonic, I run it thru dce_inq_
   error_text()).

   No ticket expiration is scheduled for hours.

   This occurs often when I have multiple threads running in my client,
   usually 20.  It still happens although much less frequently with
   a single thread.

   The login context parameter to rpc_binding_set_auth_info() is
   a context I have gotten by doing an sec_login_import() of another
   process' binding.  I will use the very same binding soon after
   and get no problem. 

   I have experimented and called __set_auth__() with a NULL as the 
   parameter therefore using the current login context of my process 
   and this exhibits the same behaviour of working 999 out of a 1000 
   times, failing and then working the next time.  This indicates to
   me that the problem is *not* within my threads and how they are 
   shuffling around the imported context handle.

[8/4/94 public]
I was the above mentioned "DME developer" who reported this bug.  Max, 
want to dust off the EVS Event Request Broker process to reproduce?  I 
didn't think so.

[8/10/94 public]
Tried to reproduce in all forms, by using imported context or default
context.  Did continuos rpc_binding_set_auth_info for many hours
without any problems.  Will cancel this



CR Number                     : 8498
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8485
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : 
Short Description             : DFS server and client in a tight loop
Reported Date                 : 8/23/93
Found in Baseline             : 1.0.3
Found Date                    : 8/23/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : unknown
Sensitivity                   : public

[8/23/93 public]

Test config:

DFS server - dce10/HP with /u0, /u1 and /u2 exported
DFS client - toaster/HP
Test-: client doing "build install_all" with its install directory 
soft-linked to dce10:/u0.

Bug description:

Both the DFS server and the DCE client got into a tight loop after some
minutes into the installation process --- looping about five hours before 
I reboot both systems. On the server side, three dfsd kernel processes 
consumed 57% of CPU; and, on the client side, the release process and one 
dfsd spent about 30%. 

Two dfstraces, one for each side, are in "hsiao" directory:

	dfstarce.dump.server
	dfstrace.dump.client

[10/1/93 public]
Mike's looking at this one.

[10/18/93 public]
Added interdependency to CR 8498, since both are (easily) reproducible
via the same method.

[12/15/93 public]

I'm closing this bug, since I have not been able to reproduce it in
the 1.0.3a code drop.

[12/15/93 public]
Changed status to cancel since we don't really know what changed.



CR Number                     : 8493
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : gds
Subcomponent Name             : 
Short Description             : NO_GDS=1 does not work.  When set dgs still attempts to build.
Reported Date                 : 8/20/93
Found in Baseline             : 1.0.3
Found Date                    : 8/20/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/20/93 public]

[10/14/93 public]

Assigned to Rich, since he'll be on the stick next week.

[10/20/93 public]
Dropped to B1.  Will try to fix by 1.0.3.

[10/22/93 public]
Deferred until 1.1

[1/5/94 public]
Sigh.  It would be nice to have details about the problem. 

I've confirmed that NO_GDS does work on HP800 and OSF1.  I'm looking for a
spare RIOS to test this on now.

[4/6/94 public]
Cancelled.  I think cjd was confused because there are GDS APIs built into
libdce even though NO_GDS is set.



CR Number                     : 8492
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cds
Subcomponent Name             : cdsclerk / cdsadv
Short Description             : cdsclerk and cdsadv dumping core
Reported Date                 : 08/20/93
Found in Baseline             : 1.0.3
Found Date                    : 08/20/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[08/20/93 public]

Using the DCE 1.0.3 nightly build available on 08/13/93, the cdsclerk and
cdsadv on the CDS master dumped core.  The cell configuration being used is:

                  dce11 (hp)    - SEC Master, CDS Client, DTS Clerk
                  dce13 (hp)    - SEC Client, CDS Server, DTS Local Server
                  largo (hp)    - SEC Slave, CDS Replica, DTS Clerk
                  west (hp)     - SEC Client, CDS Client, DTS Local Server
                  tahiti (i486) - SEC Slave, CDS Replica, DTS Local Server,
                                  dts_ntp_provider
                  brandy (hp)   - SEC Client, CDS Client, DTS Clerk

There were six tests running, one on each machine, which do show object
commands on the master namespace and then show obj on one of the two replica
namespaces.  The namespace contains 20,000 objects in 20 directories (1000
objects per directory).  I ran this same test on the nightly build available
on 08/06 it did not see this problem.

John Dugas has copies of the cdsclerk and cdsadv cores.

[09/23/93 public]

Cancelled, I haven't seen this problem in the last three builds.



CR Number                     : 8491
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : config
Short Description             : Failed to kill msg missing daemon
Reported Date                 : 8/20/93
Found in Baseline             : 1.0.3
Found Date                    : 8/20/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : dfs.clean
Sensitivity                   : public

[8/20/93 public]
when selecting the stop option of dce_config 
dfs.clean does not display the daemon it could
not kill

typo in dfs.clean tries to print $sdaemon instead
of $daemon

workaround is for user to kill -9 any dfs daemons still
running after dce_config stop option has returned to
the dce_config menu

[8/31/93 public]
There are always DFS daemons that cannot be killed.  This
should be fixed but the problem is not in the config
scripts.  Also, I cannot find any use of $sdaemon in the 
context of killing daemons, only starting them.  Is this 
bug still in the OSF source base?

[10/1/93 public]
I just spoke with Charlene.  This bug doesn't exist in the OSF
source base.  Cancelled.



CR Number                     : 8486
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : unknown
Subcomponent Name             : 
Short Description             : Inappropriate includes of some header files
Reported Date                 : 8/19/93
Found in Baseline             : 1.0.3
Found Date                    : 8/19/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/93 public]
The bug is derived from OT#6773. 
Some internal header files are exported to usr/include/dce in export tree
but are included as #include <header.h>. These header files are generated 
by idl. The current build gets around with this problem by having -I../dir 
in INCFLAGS in their Makefiles because the header files also exist in
their obj tree. This problem may not be a problem but could also be a 
enchancement issue. To fix this problem need to properly either export
these header files to usr/include in export tree, or modify their
corresponding idl file(i.e import  statement). Both could face some
problems, for the 1st approache you need to figure out how to export to
two different loactions in a Makefile, for 2rd approache, you need
to find a way to import the idl files from dce/current_dir. But easy and
not-elegant way is the 2rd approach plus export the corresponding idl file
to usr/include/dce in export tree as well.

For example, The cds_clerkserver.h has cds_types.h included as 
"include <cds_types.h>" but cds_types.h is not in export/machine/
usr/include instead of in export/machine/usr/include/dce. The same
problem happens in security, or perhaps somewhere else.

[07/27/94 public]
I think we've fixed all the proper export issues as side-effects of
the cross-technology work that needed this kind of thing.  If you know
of specific problems in the 1.1 code base, please open new bugs.

I'm cancelling this rather then closing it because there was no single
"fix".



CR Number                     : 8485
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8498
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : 
Short Description             : communication failure with server
Reported Date                 : 8/19/93
Found in Baseline             : 1.0.3
Found Date                    : 8/19/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : unknown
Sensitivity                   : public

[8/19/93 public]

The comm-failure happened consistently(four out of four) when a client
(toaster/HP) was doing "build install_all" with the install directory 
soft-linked to a DFS server disk(dce10:/u0). 

It seems to me that the failure is too pre-matured. The install script output
the following error message immediately after the "release" line.

+++ Part of the install output +++

makepath idl/. && cd idl &&  exec make MAKEFILE_PASS=BASIC     install_all
release   -o bin -g bin -m 755 -tostage /u1/hsiao/sbox/102a_dfs/install/hp800/op
t/dce1.0 -fromfile /.../dce10_cell.osf.org/fs/dce1.0.2a/src/security/idl/rgynbas
e.idl /
share/include/dce/rgynbase.idl
dfs: communication failure with server 130.105.5.10 in cell dce10_cell.osf.org.
dfs: lost contact with the fx server 130.105.5.10 in cell dce10_cell.osf.org
release: open /u1/hsiao/sbox/102a_dfs/install/hp800/opt/dce1.0/.release.chk: mak
e: don't know how to make Connection timed out
/u1/hsiao/sbox/102a_dfs/install/hp800/opt/dce1.0/share/include/dce/rgynbase.idl:
 aborting installation
binding.idl. Stop
*** Error code 2
1 error
*** Error code 2
1 error
~

[8/19/93 public]

After the comm failure I get rpc_s_helper_wrong_user(code 382312714) on a 
"ls /:" after "cm stat":

+++ ls /:/u0 history +++

>ls /:/u0
/:/u0 not found
>cm stat
All servers are running.
>ls /:/u0
dfs: set auth binding failed (code 382312714)
dfs: Warning: created unauthenticated binding
102a        102a_dfs    disktab     foo         hsiao       lcache      lost+fou
nd
>ls /:/u0
102a        102a_dfs    disktab     foo         hsiao       lcache      lost+fou
nd

[10/14/93 public]
Haven't seen in a while, downgrading to 2.

[10/14/93 public]

This bug was quite re-producible when discovered. I haven't tried to re-produce
it recently but that doesn't mean "Haven't seen in a while".

To re-produce it, follow the following scenario:

	1. "build" the whole DCE(core+dfs)
	2. link install tree to a DFS disk
	3. "build install_all"

[10/18/93 public]

Added interdependency to CR 8498.  Both are easily reproducible via
the method described above.  Changed priority back to A1.

[12/15/93]

I'm closing this bug, since it is not reproducible in the 1.0.3a code drop.

[12/15/93 public]

Changed status to cancel, since we don't really know what changed.



CR Number                     : 8481
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8881
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : config
Short Description             : SCM doens't allow long hostname
Reported Date                 : 8/19/93
Found in Baseline             : 1.0.3
Found Date                    : 8/19/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : dfs_config
Sensitivity                   : public

[8/19/93 public]
need to allow long hostname (hostname.whatever.else) when config'g Server
Control Machine
Upclient was unable to find Upserver
Upserver was an ibm machine using long hostname....
configuration data should allow hostname to remain long
it currently strips the name to the first .
dfs_config file
config_dfsfs & config_dfsfldb routines do the following:
SCM=`echo $SCM | cut -f1 -d.`
workaround is to set hostname correctly in Bos configuration and
restart process

[10/8/93 public]
This was fixed by Tom Jordahl under 8881, but I can't dup
forward so I'll have to cancel it.



CR Number                     : 8458
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : config
Short Description             : File rc.dce.template should not be "mv"ed to its new name.
Reported Date                 : 8/16/93
Found in Baseline             : 1.0.3
Found Date                    : 8/16/93
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/16/93 public]
In dce_config, there is a function called install_common() that
moves a file named rc.dce to rc.dce.template .  The file rc.dce.template
should be part of the software before calling the install_common() function,
and no moving around of files should exist.  The same is true for 
rc.dfs.

[8/24/94 public]
Humm..  I don't see a reason why the (admittedly slightly inefficient) 
move of rc.{dce,dfs} can't be done.

Changing the name of the files in the source tree has a few undesirable
side affect (rcs history lost), so I think its not a good idea to do this.
Canceled.



CR Number                     : 8454
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : thr
Subcomponent Name             : cma_timer.c
Short Description             : In cma__init_timer, there is
no check for error return from setitimer.
Reported Date                 : 8/16/93
Found in Baseline             : 1.0.2
Found Date                    : 8/16/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/16/93 public]

Full Description:

        If an error occurs on the call to setitimer, there is no
        indication of failure and the timer will not be running thereby
        disabling most of the thread scheduling.

[10/18/93 public]
There isn;t any meaningfull way to handle this condition. The call is
internal to threads and it must just work. If an error were detected 
there is no way to get notification to the application. The call to
cma_init is transparent and is made as a result of a call to an api 
interface. No api interface allows for notification to the user of setimer
errors.



CR Number                     : 8453
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : sandbox rc_files files
Short Description             : Don't need "setenv foo ${foo}" lines
Reported Date                 : 8/16/93
Found in Baseline             : 1.0.3
Found Date                    : 8/16/93
Severity                      : E
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/16/93 public]
Many of the files in the rc_files directory of our sandboxes and
backing builds have lines like these in them:
	setenv INCDIRS ${INCDIRS}
	setenv LIBDIRS ${LIBDIRS}
	setenv SHLIBDIRS ${SHLIBDIRS}
	setenv LPATH ${LPATH}
Or, in general
	[replace] setenv XXX ${XXX}

From Damon (OSF ODE maintainer):
>The only case I can think of where:
>	setenv XXX ${XXX}
>Is useful is in a case such as:
>	XXX stuff
>	setenv XXX ${XXX}
>That would set the internal rc variable for use by ODE as well as setting
>it in the environment. This assumes that there is some variable called
>XXX that ODE recognizes and uses. I don't know of any cases of this.

So I think we should work on removing lines like this.  They are
confusing.  Start by removing the from the template files.

[9/24/93 public]
These rc_files are obsolete after the upgrade to ODE2.3 and have been
defuncted.  This condition doesn't occur in the Buildconf files.



CR Number                     : 8428
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : CDS Additional Server is nonfunctional initial server machine.
Reported Date                 : 8/10/93
Found in Baseline             : 1.0.3
Found Date                    : 8/10/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/10/93 public]
The CDS Additional Server configuration does not establish a replica of
the master clearinghouse on the same machine. Prompts for the secondary 
clearinghouse name and then reports the following error but secondary is
not created. 

        Are you using multiple LAN's within this cell? (n)
S:****** Starting cdsadv...
WARNING: cdsadv is already running.
S:****** Starting cdsd...
ERROR:   cdsd is already running.  Continuing will return to Main Menu.

[09/17/93 public]
I'm not sure if this is a bug, assigning to John D. so he can verify.
Perhaps its letting the user get too far (ie not checking for cdsd
right away when confiuring a replica).

[03/28/94 public]
On further review, this just looks like he was trying to config a 
replica on a machine already a cds server.
Canceled.



CR Number                     : 8424
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : modification dates being dropped
Reported Date                 : 8/9/93
Found in Baseline             : 1.0.2
Found Date                    : 8/9/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/9/93 public]
----- begin travis 7/14/93
                                                                     .
 Notice that if, in rgy_edit, one changes an account by placing all the
changes on a single command line, e.g.
                                                                     .
	rgy_edit=> change -p binky -g shaftees -o hellco -pw sheila -mp -dce-
                                                                     .
that the account "changed by" date and, if applicable, the password "was
last changed" dates do not get updated. If an analogous change is made
on the 'long form' for the same command, e.g.
                                                                     .
	rgy_edit=> change -p binky -g shaftees -o hellco
	Enter new account id [pname]: (binky)
	Enter new account group [gname]: (shaftees)
	Enter new account org [oname]: (hellco)
	Change password? [y/n]? (n) y
	Enter new password:
	Retype new password:
	Enter your password:
                                                                     .
  I have not read the code yet, but I suspect that this is due to the
implementation of rgy_edit and its form entry system; the date probably
gets updated only in the long form code.

[9/10/93 public]
Assigned to 'mob' who's working on rgy_edit now.
I believe the server is supposed to update the 'date' fields, so the
above doesn't sound possible (the fact that the problem doesn't occur
if you execute the same command in interactive mode).  Mary, make sure
we can reproduce it before looking into the code too much...

[9/29/93 public]
  I have no idea how confused I was the day I claimed to see this bug. I
can't reproduce it myself, and understanding the layout of the account
change code, I doubt it ever happened at all. Please allow me to cancel
this bug, and accept my apologies for filing a bogus bug.

[9/29/93 public]
Not reproducible, not possible, cancelled with permission of reporting party.



CR Number                     : 8423
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : fault in cell cmd
Reported Date                 : 8/9/93
Found in Baseline             : 1.0.2
Found Date                    : 8/9/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[8/9/93 public]
When adding an intercell trust path using the rgy_edit 'cell' command,
if the administrator specifies a local unix UID on the command line
(using the -lu option) which is already in use, two things happen:
                                                                      .
	silently, the operation 'compiler' code notices that
	that UID is in use, but this error is not flagged,
	or the flagged error is not expected by the caller.
	the result is that the local UID field is filled
	into the command's operation form as being missing,
	when in fact it wasn;t missing, but was only incorrect.
                                                                      .
	loudly, the operation code notices that this argument
	was not specified, and as this condition was to be
	prevented by the compiler's checks, it signals a
	'FAULT' message to the terminal and aborts the image.
                                                                      .
A workaround would be to allow rgy_edit to provide its default value for
this argument -- caution, I didn't review that path to see if problems
were also present there, but others have used it and succeeded -- or to
check by hand to see that the UID they provide is not in use within the
local registry.
                                                                      .
Another 'problem' which falls into the annoyance category is that if a
cell name is given tothe 'cell' command and this name lacks the '/.../'
prefix, the command returns and error of the form, "this command lacks
data inthe correct syntax." With 12 arguments, this message doesn't give
enough data to narrow in on this 'error'. It seems reasonable for
rgy_edit to prepend the "/.../" prefix if it is missing -- the name
*has* to be a remote cell, after all.
                                                                      .
Filed as B2 because it would be difficult for an outside user to
determine the problem here, and hence would be blocked during intercell
work. There is a workaround (find and use an unused UID) and there is no
data loss, so, B2.

[09/10/93 public]
Assigned to 'mob' who's working on rgy_edit for 1.0.3.

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 8398
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : osf1
Component Name                : thr
Subcomponent Name             : cma_init.c, cma_util.c
Short Description             : Trace file management in
startup won't work with locks that are added by osf/1 reentrant libc
Reported Date                 : 8/2/93
Found in Baseline             : 1.0.2
Found Date                    : 8/2/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/2/93 public]

Licensee reported the following problem with osf/1's reentrant C library. 
Basically the lock that libc_r.a added for file operation does not 
coexist with DCE trace mechanism.

The suggested fix also involves some fix to libc_r.a on osf/1 system.

Full Description:

 On our OSF/1 base, stdio locking and the use of the trace file are
 incompatible.  The trace file is opened before locks have been set;
 however, once the locks have been specified, the next use of the trace
 file fails because its lock is not known to DCE.
 
 The only way I know of to solve this is to close the trace file while
 the locks are being specified, then reopen it (for append).  This also
 requires modifying libc to not attempt to retain lock info on FILE
 structures that are currently unused.
 
 Reason:  OSDqa05606 Trace file management in startup won't work with locks
 Add cma__suspend_trace function, fix trace file opening to re-open
 after a suspension of tracing.
 
     *** /tmp/ci.21083..cma_util.c.21110.1	Thu Jul 15 12:53:37 1993
     --- /tmp/cma_util.c.21110.2	Thu Jul 15 12:53:38 1993
     ***************
     *** 601,616 ****
            */
           if (optcnt == 0)
       	cma___g_trace_bits = ~0;
       
           trace_env[trclen] = '\0';
     !     cma___g_trace_file = cma__int_fopen (trace_env, "w");
     !     cma__trace_print (
       	    cma__c_trc_init,
       	    "(init_trace) opening trace file %s",
       	    trace_env);
           }
       /*
        *  FUNCTIONAL DESCRIPTION:
        *
        *	cma__trace_print - Print trace statements to a log file.
        *
     --- 601,670 ----
            */
           if (optcnt == 0)
       	cma___g_trace_bits = ~0;
       
           trace_env[trclen] = '\0';
     ! #if _CMA_OSIMPL_ == _CMA__OS_OSF
     !     /* if cma___g_trace_file is non-null, we're re-opening, so append */
     ! 
     !     if (cma___g_trace_file) {
     !         cma___g_trace_file = cma__int_fopen (trace_env, "a+");
     ! 	cma__trace_print (
     ! 	    cma__c_trc_init,
     ! 	    "(init_trace) re-opening trace file %s",
     ! 	    trace_env);
     !     } else {
     ! #endif
     !         cma___g_trace_file = cma__int_fopen (trace_env, "w");
     ! 	cma__trace_print (
       	    cma__c_trc_init,
       	    "(init_trace) opening trace file %s",
       	    trace_env);
     + #if _CMA_OSIMPL_ == _CMA__OS_OSF
     +     }
     + #endif
     +     }
     + #if _CMA_OSIMPL_ == _CMA__OS_OSF
     + /*
     +  *  FUNCTIONAL DESCRIPTION:
     +  *
     +  *	Close the trace file (if one is open); this is normally done
     +  *	only when locks are being set (to prevent the FILE struct
     +  *	for the trace file from having an improper lock in it).
     +  *
     +  *  FORMAL PARAMETERS:
     +  *
     +  *	none
     +  *
     +  *  IMPLICIT INPUTS:
     +  *
     +  *	cma___g_trace_file
     +  *
     +  *  IMPLICIT OUTPUTS:
     +  *
     +  *	none
     +  *
     +  *  FUNCTION VALUE:
     +  *
     +  *	none
     +  *
     +  *  SIDE EFFECTS:
     +  *
     +  *	none
     +  */
     + void
     + cma__suspend_trace
     + #ifdef _CMA_PROTO_
     + 	(void)
     + #else	/* no prototypes */
     + 	()
     + #endif	/* prototype */
     +     {
     + 	    if (cma___g_trace_file)
     + 		    fclose(cma___g_trace_file);
           }
     + #endif
       /*
        *  FUNCTIONAL DESCRIPTION:
        *
        *	cma__trace_print - Print trace statements to a log file.
        *
     ***************
     *** 1647,1656 ****
     --- 1701,1711 ----
       	cma__bugcheck ("gettimeval: gettimeofday");
       
           time_struc->tv_sec = tmptime.tv_sec;
           time_struc->tv_nsec = tmptime.tv_usec * 1000;
       #endif
     +     return(0);
           }
       /*  DEC/CMS REPLACEMENT HISTORY, Element CMA_UTIL.C */
       /*  *23   24-MAR-1992 13:46:39 BUTENHOF "Put bugcheck output in file" */
       /*  *22   13-MAR-1992 14:10:35 BUTENHOF "Add tracing" */
       /*  *21   10-MAR-1992 16:27:58 BUTENHOF "Change ftime to gettimeofday" */
 
Related-file::Added 930716 by wright:: 3.add_enc
 /build/hiosfm/RCS/src/dce/src/threads/./cma_init.c,v 7.2
 wright 1993/07/15 16:55:22 +47 -3
 Reason:  OSDqa05606 Trace file management in startup won't work with locks
 Correct setting of locks, add errno function specification, and
 revise trace file usage to avoid lock mismanagement.
 
     *** /tmp/ci.21129..cma_init.c.21158.1	Thu Jul 15 12:55:24 1993
     --- /tmp/cma_init.c.21158.2	Thu Jul 15 12:55:24 1993
     ***************
     *** 250,259 ****
     --- 250,262 ----
       #include <cma.h>
       #undef _EXC_NO_EXCEPTIONS_
       #if defined(SNI_DCOSX)
       #include <sys/resource.h>
       #endif	/* SNI_DCOSX */
     + #if _CMA_OSIMPL_ == _CMA__OS_OSF
     + #include <lib_data.h>
     + #endif
       #include <cma_defs.h>
       
       #if _CMA_UNIX_TYPE ==  _CMA__SVR4
       #define CMA_INIT_NEEDED 1
       #endif
     ***************
     *** 452,461 ****
     --- 455,467 ----
       	lib_spinlock_func_t	spinlock_trylock;
       	lib_threadid_func_t	thread_id;
       } lib_lock_functions_t;
       
       static lib_lock_functions_t	cma___g_lib_funcs;
     + #if _CMA_OSIMPL_ == _CMA__OS_OSF
     + static lib_data_functions_t	cma___g_data_funcs;
     + #endif
       
       # ifndef NDEBUG
       static cma__t_int_mutex		*cma___g_dbg_libcr_m;
       static lib_mutex_t		cma___g_dbg_libcr_v[1024];
       static int			cma___g_dbg_libcr_c;
     ***************
     *** 551,560 ****
     --- 557,576 ----
           {
           /*
            * Initialize the environment first, specifically to get the value of the
            * trace file (if any). This assume that cma___init_env isn't dependent
            * on ANY other DECthreads features!
     +      *
     + #if _CMA_OSIMPL_ == _CMA__OS_OSF
     +      * Which, on OSF/1, is a bogus assumption, unless you close the
     +      * trace file in cma___init_lib_hooks; otherwise, you get conflicting
     +      * locks in place for the trace file, and the DCE locking package
     +      * barfs ("never heard of this lock").  Close-and-reopen didn't work
     +      * either, since the close logic tried to be cute and recycle the
     +      * FILE struct, rather than deleting the lock.  I have since modified
     +      * our libc to avoid this.
     + #endif     
            */
           cma___init_env ();
       
           /*
            * WARNING:
     ***************
     *** 669,679 ****
     --- 685,706 ----
           cma__init_signal ();
           cma__trace ((cma__c_trc_init, "(init_static) debug code"));
           cma__init_debug ();			/* Must be after mutexes */
       #if (_CMA_OSIMPL_ == _CMA__OS_OSF) && _CMA_REENTRANT_CLIB_
           cma__trace ((cma__c_trc_init, "(init_static) library reentrancy hooks"));
     + # if _CMA_OSIMPL_ == _CMA__OS_OSF
     +     cma__suspend_trace ();
     + # endif
           cma___init_lib_hooks ();
     + # if _CMA_OSIMPL_ == _CMA__OS_OSF
     +     /*
     +      * Reinitialize the environment, specifically to reopen the trace file
     +      * (if any).  We can't continue to use the same stream, because its locks
     +      * will be wrong now that they've been explicitly specified.
     +      */
     +     cma___init_env ();
     + # endif
       #endif
           cma__trace ((cma__c_trc_init, "(init_static) timers"));
           cma__init_timer ();
           cma__trace ((cma__c_trc_init, "(init_static) initialization complete"));
           }
     ***************
     *** 998,1010 ****
           cma___g_lib_funcs.spinlock_delete = (lib_spinlock_func_t)cma___spin_delete;
           cma___g_lib_funcs.spinlock_lock = (lib_spinlock_func_t)cma___spin_lock;
           cma___g_lib_funcs.spinlock_unlock = (lib_spinlock_func_t)cma___spin_unlock;
           cma___g_lib_funcs.spinlock_trylock = (lib_spinlock_func_t)cma___spin_trylock;
           cma___g_lib_funcs.thread_id = (lib_threadid_func_t)cma___get_self_tcb;
     ! 
           libc_declare_lock_functions (&cma___g_lib_funcs);
           ldr_declare_lock_functions (&cma___g_lib_funcs);
           }
       #endif					/* _CMA__OS_OSF */
       /*  DEC/CMS REPLACEMENT HISTORY, Element CMA_INIT.C */
       /*  *30   24-APR-1992 17:04:11 SCALES "Unconditionalize signal module init" */
       /*  *29   17-APR-1992 11:11:19 BUTENHOF "Add version number string" */
     --- 1025,1054 ----
           cma___g_lib_funcs.spinlock_delete = (lib_spinlock_func_t)cma___spin_delete;
           cma___g_lib_funcs.spinlock_lock = (lib_spinlock_func_t)cma___spin_lock;
           cma___g_lib_funcs.spinlock_unlock = (lib_spinlock_func_t)cma___spin_unlock;
           cma___g_lib_funcs.spinlock_trylock = (lib_spinlock_func_t)cma___spin_trylock;
           cma___g_lib_funcs.thread_id = (lib_threadid_func_t)cma___get_self_tcb;
     ! #if _CMA_OSIMPL_ == _CMA__OS_OSF
     !     /* OSF/1 libc name starts with an underscore */
     !     _libc_declare_lock_functions (&cma___g_lib_funcs);
     ! #else
           libc_declare_lock_functions (&cma___g_lib_funcs);
     + #endif
     + #if _CMA_OSIMPL_ != _CMA__OS_OSF
     +     /* function does nothing on OSF/1 system */
           ldr_declare_lock_functions (&cma___g_lib_funcs);
     + #endif
     + 
     + #if _CMA_OSIMPL_ == _CMA__OS_OSF
     + {
     +     extern int *cma_errno _CMA_PROTOTYPE_ ((void));
     + 
     +     cma___g_data_funcs.data_hdl = NULL;
     +     cma___g_data_funcs.data_ref = (void *(*)(void *))cma_errno;
     +     _libc_declare_data_functions(&cma___g_data_funcs);
     + }
     + #endif
           }
       #endif					/* _CMA__OS_OSF */
       /*  DEC/CMS REPLACEMENT HISTORY, Element CMA_INIT.C */
       /*  *30   24-APR-1992 17:04:11 SCALES "Unconditionalize signal module init" */
       /*  *29   17-APR-1992 11:11:19 BUTENHOF "Add version number string" */

[10/18/93 public]
libc_r.a isn't used in our reference osf/1 configuration. Even as an 
enjancement request we wouldn;t want to modify osf.1'a libc_r.a to make
it work. Canceled

[10/18/93 public]
Marked as enhancement last time, meant to cancel. Canceled now.



CR Number                     : 8396
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : osf1
Component Name                : thr
Subcomponent Name             : cma_ux.c cma_vp.c
Short Description             : cma_fork code does not manage
child properly when using Mach threads and reentrant libc
Reported Date                 : 8/2/93
Found in Baseline             : 1.0.2
Found Date                    : 8/2/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/2/93 public]

Licensee reported the following problem when using Mach threads and
reentrant libc:

Full Description:

 In a threads implementation using Mach threads, the cma_fork() call
 does not maintain state properly in the child.  The mach state must be
 reinitialized, and the vp state must be reinitialized in a specific
 order. 
 
 Do reinits in correct order, invoke mach_reinit, avoid reinit_malloc
 (which does not exist on OSF/1). cma__reinit_malloc is used but not 
 defined in OSF/1 reentrant code part.

 mach_init() is part of libmach.a on osf/1 system.
 
     *** /tmp/ci.22319..cma_ux.c.22346.1	Thu Jul 15 17:03:55 1993
     --- /tmp/cma_ux.c.22346.2	Thu Jul 15 17:03:55 1993
     ***************
     *** 249,258 ****
     --- 249,266 ----
           } cma___t_fork_rtns;
       
       /*
        * LOCAL MACROS
        */
     + #if (_CMA_OSIMPL_ == _CMA__OS_OSF) && _CMA_REENTRANT_CLIB_
     +     /*
     +      * If we're on OSF/1 system and using libc_r.a instead of wrappers, then
     +      * there are cma__reinit_malloc calls, but there is no such routine, so
     +      * we're just defining it out of existence for now.  Error??
     +      */
     + # define cma__reinit_malloc(cma__c_reinit_prefork_lock)
     + #endif
       
       /*
        * LOCAL FUNCTIONS
        */
       
     ***************
     *** 426,436 ****
           else {					/* child process */
       	/*
       	 * Reinitialize required data structures, and remove all other
       	 * threads from the known threads list in forked process.
       	 */
     ! 
       	/*
       	 * FIX-ME:
       	 *
       	 * This is inefficient. In each case, we need to clear state and
       	 * unlock the mutexes. The two are separated because the parent
     --- 434,446 ----
           else {					/* child process */
       	/*
       	 * Reinitialize required data structures, and remove all other
       	 * threads from the known threads list in forked process.
       	 */
     ! #if (_CMA_OSIMPL_ == _CMA__OS_OSF) && _CMA_REENTRANT_CLIB_
     !     mach_init();
     ! #endif
       	/*
       	 * FIX-ME:
       	 *
       	 * This is inefficient. In each case, we need to clear state and
       	 * unlock the mutexes. The two are separated because the parent
     ***************
     *** 439,448 ****
     --- 449,459 ----
       	 * functions should be implemented as a switch() with the clear case
       	 * preceeding and falling through into the unlock case.
       	 */
       	cma__unset_kernel ();	
       	cma__int_unlock (cma__g_global_lock);
     + 
       #if (_CMA_OSIMPL_ == _CMA__OS_OSF) && _CMA_REENTRANT_CLIB_
       	/*
       	 * If we're on OSF/1 system and using libc_r.a instead of wrappers,
       	 * then we're also using cma_malloc.c, and need to call its prefork
       	 * reinit.
     ***************
     *** 475,488 ****
       	cma__reinit_signal (cma__c_reinit_postfork_unlock);
       	cma__reinit_mutex (cma__c_reinit_postfork_clear);
       	cma__reinit_mutex (cma__c_reinit_postfork_unlock);
       	cma__reinit_attr (cma__c_reinit_postfork_clear);
       	cma__reinit_attr (cma__c_reinit_postfork_unlock);
     ! 	cma__reinit_vp (cma__c_reinit_postfork_clear);
       	cma__reinit_vp (cma__c_reinit_postfork_unlock);
       	cma__reinit_debug (cma__c_reinit_postfork_clear);
       	cma__reinit_debug (cma__c_reinit_postfork_unlock);
       
       	/*
       	 * Call do fork specifying that we're in child just after fork. This
       	 * for atfork() functionality.
       	 */
     --- 486,503 ----
       	cma__reinit_signal (cma__c_reinit_postfork_unlock);
       	cma__reinit_mutex (cma__c_reinit_postfork_clear);
       	cma__reinit_mutex (cma__c_reinit_postfork_unlock);
       	cma__reinit_attr (cma__c_reinit_postfork_clear);
       	cma__reinit_attr (cma__c_reinit_postfork_unlock);
     ! 
     ! 	/* don't rearrange the following unless you really know what
     ! 	 * you are doing */
     ! 
       	cma__reinit_vp (cma__c_reinit_postfork_unlock);
       	cma__reinit_debug (cma__c_reinit_postfork_clear);
       	cma__reinit_debug (cma__c_reinit_postfork_unlock);
     + 	cma__reinit_vp (cma__c_reinit_postfork_clear);
       
       	/*
       	 * Call do fork specifying that we're in child just after fork. This
       	 * for atfork() functionality.
       	 */
     ***************
     *** 684,693 ****
     --- 699,710 ----
           {
           cma___g_fork_queue_mutex = cma__get_mutex (&cma__g_def_attr);
           cma__obj_set_name (cma___g_fork_queue_mutex, "atfork queue");
           cma__queue_init (&cma___g_fork_handler_queue);
           }
     + 
     + 
       /*  DEC/CMS REPLACEMENT HISTORY, Element CMA_UX.C */
       /*   14A1 17-APR-1992 08:34:06 KEANE "Apply undeferral fix to improved BL9" */
       /*  *17   13-MAR-1992 14:10:46 BUTENHOF "Add tracing" */
       /*  *16   19-FEB-1992 13:50:37 SCALES "Perform undeferal on enter-kernel" */
       /*  *15   18-FEB-1992 15:31:27 BUTENHOF "Adapt to new alloc_mem protocol" */
 
Related-file::Added 930716 by wright:: 3.add_enc
 /build/hiosfm/RCS/src/dce/src/threads/./cma_vp.c,v 7.4
 wright 1993/07/15 21:07:07 +75 -16
 Reason:  OSDqa05609 cma_fork code does not manage child properly
 Clean up vpid's properly, note which one belongs to the only thread
 running in the child.
 
     *** /tmp/ci.22365..cma_vp.c.22425.1	Thu Jul 15 17:07:09 1993
     --- /tmp/cma_vp.c.22425.2	Thu Jul 15 17:07:09 1993
     ***************
     *** 262,275 ****
           }
       
       /*
        *  FUNCTIONAL DESCRIPTION:
        *
     !  *	cma__reinit_vp:  Do pre/post re-Initialize 
        *
        *  FORMAL PARAMETERS:
        *
        *	flag
        *
        *  IMPLICIT INPUTS:
        *
        *	None
     --- 262,338 ----
           }
       
       /*
        *  FUNCTIONAL DESCRIPTION:
        *
     !  *	cma___del_vpid:  delete a specific vpid structure
        *
        *  FORMAL PARAMETERS:
        *
     +  *	qptr		 queue containing vpid structure
     +  *
     +  *  IMPLICIT INPUTS:
     +  *
     +  *	none
     +  *
     +  *  IMPLICIT OUTPUTS:
     +  *
     +  *	None
     +  *
     +  *  FUNCTION VALUE:
     +  *
     +  *	None
     +  *
     +  *  SIDE EFFECTS:
     +  *
     +  *	None
     +  *
     +  *      this code was removed from the reinit_vp routine since it's
     +  *	needed twice
     +  *
     +  */
     + #if _CMA_KTHREADS_ == _CMA__MACH
     + static void
     + cma___del_vpid
     + #ifdef _CMA_PROTO_
     + 	(
     + 	cma__t_queue	*qptr)
     + #else	/* no prototypes */
     + 	(qptr)
     + 	cma__t_queue	*qptr;
     + #endif	/* prototype */
     +     {
     + 	cma__t_vpid	vptr = (cma__t_vpid)qptr;
     + 
     + 	cma__queue_remove (qptr);
     + 
     + 	/*
     + 	 * FIX-ME
     + 	 *
     + 	 * Need to determine whether ports are copied to a forked
     + 	 * task... if so, we need to port_deallocate() here, and
     + 	 * we don't need to allocate a new port for the current
     + 	 * VP (else clause).
     + 	 */
     + 	cma__trace ((
     + 		cma__c_trc_init | cma__c_trc_vp,
     + 		"(del_vpid) deleting cached vp_id %08x, vp %d, synch %d",
     + 		vptr,
     + 		vptr->vp,
     + 		vptr->synch));
     + 
     + 	cma__free_mem ((cma_t_address)vptr);
     +     }
     + #endif
     + 
     + /*
     +  *  FUNCTIONAL DESCRIPTION:
     +  *
     +  *	cma__reinit_vp:  Do pre/post fork re-Initialize 
     +  *
     +  *  FORMAL PARAMETERS:
     +  *
        *	flag
        *
        *  IMPLICIT INPUTS:
        *
        *	None
     ***************
     *** 308,319 ****
       	    break;
       	    }
       	case cma__c_reinit_postfork_clear : {
       	    thread_t		self;
       	    cma__t_queue	*qptr;
       
     - 
       	    /*
       	     * Remove all active VP structures, except for the VP that's
       	     * currently running.
       	     */
       	    self = thread_self ();
     --- 371,383 ----
       	    break;
       	    }
       	case cma__c_reinit_postfork_clear : {
       	    thread_t		self;
       	    cma__t_queue	*qptr;
     + 	    cma__t_int_tcb	*cur_tcb = cma__get_self_tcb();
     + 	    cma__t_vpid		myvp = cur_tcb->sched.processor->vp_id;
       
       	    /*
       	     * Remove all active VP structures, except for the VP that's
       	     * currently running.
       	     */
       	    self = thread_self ();
     ***************
     *** 322,342 ****
       	    while (qptr != &cma___g_vp_queue) {
       		cma__t_vpid	vptr = (cma__t_vpid)qptr;
       		cma__t_queue	*qnext = cma__queue_next (qptr);
       
       
     ! 		if (vptr->vp != self) {
     ! 		    cma__queue_remove (qptr);
       		    /*
       		     * FIX-ME
       		     *
       		     * Need to determine whether ports are copied to a forked
       		     * task... if so, we need to port_deallocate() here, and
       		     * we don't need to allocate a new port for the current
       		     * VP (else clause).
       		     */
     - 		    cma__free_mem ((cma_t_address)vptr);
       		    }
       		else {
       		    kern_return_t	status;
       		    port_t		synch_port;
       		    task_t		task;
     --- 386,405 ----
       	    while (qptr != &cma___g_vp_queue) {
       		cma__t_vpid	vptr = (cma__t_vpid)qptr;
       		cma__t_queue	*qnext = cma__queue_next (qptr);
       
       
     ! 		if (vptr != myvp) {
     ! 		    cma___del_vpid (qptr);
       		    /*
       		     * FIX-ME
       		     *
       		     * Need to determine whether ports are copied to a forked
       		     * task... if so, we need to port_deallocate() here, and
       		     * we don't need to allocate a new port for the current
       		     * VP (else clause).
       		     */
       		    }
       		else {
       		    kern_return_t	status;
       		    port_t		synch_port;
       		    task_t		task;
     ***************
     *** 347,357 ****
       		    self = thread_self ();
       		    status = port_allocate (task, &synch_port);
       
       		    cma__trace ((
       			    cma__c_trc_init | cma__c_trc_vp,
     ! 			    "(reinit_vp) running in vp %d, synch port is %d",
       			    self,
       			    synch_port));
       
       		    if (status != KERN_SUCCESS) {
       			cma__trace ((
     --- 410,422 ----
       		    self = thread_self ();
       		    status = port_allocate (task, &synch_port);
       
       		    cma__trace ((
       			    cma__c_trc_init | cma__c_trc_vp,
     ! 			    "(reinit_vp) running in thread %x, vpid %x, vp %d, synch is %d",
     ! 			    cur_tcb,
     ! 			    myvp,
       			    self,
       			    synch_port));
       
       		    if (status != KERN_SUCCESS) {
       			cma__trace ((
     ***************
     *** 399,416 ****
       	    while (qptr != &cma___g_vp_cache) {
       		cma__t_vpid	vptr = (cma__t_vpid)qptr;
       		cma__t_queue	*qnext = cma__queue_next (qptr);
       
       
     ! 		cma__queue_remove (qptr);
     ! 		/*
     ! 		 * FIX-ME
     ! 		 *
     ! 		 * Need to determine whether ports are copied to a forked
     ! 		 * task... if so, we need to port_deallocate() here.
     ! 		 */
     ! 		cma__free_mem ((cma_t_address)vptr);
       		qptr = qnext;
       		}
       
       	    cma__spinunlock (&cma___g_vp_lock);
       	    break;
     --- 464,475 ----
       	    while (qptr != &cma___g_vp_cache) {
       		cma__t_vpid	vptr = (cma__t_vpid)qptr;
       		cma__t_queue	*qnext = cma__queue_next (qptr);
       
       
     ! 		cma___del_vpid (qptr);
     ! 
       		qptr = qnext;
       		}
       
       	    cma__spinunlock (&cma___g_vp_lock);
       	    break;

[10/18/93 public]
The reference platform doesn;t support libc_r.a. Canceled.



CR Number                     : 8380
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : 
Short Description             : Include files for sample
acl_mgr are not in acl_mgr directory.
Reported Date                 : 7/28/93
Found in Baseline             : 1.0.3
Found Date                    : 7/28/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/93 public]

	The sample acl_mgr source does not contain all needed files in
the source directory.  Therefore the user must use trial and error
to find the appropriate include files.

[7/29/93 public]

[8/2/93 public]
changed to enhancement.



CR Number                     : 8377
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : 
Short Description             : Need enhancement to DCE build
that will optionally also build encryption less libdce
Reported Date                 : 7/28/93
Found in Baseline             : 1.0.2
Found Date                    : 7/28/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/28/93 public]

Full Description:
        Currently it seems that the build will build
        either export or domestic versions of DCE.
        One could build it in either a separate sandbox
        ( if you are using ode, but this wastes space )


Proposed Solution:
        Enhance makefiles so that encryption less versions
        of libdce also get built and installed ( althouth
        in a separate place eg: $TOSTAGE/usr/ELSlib ( ELS
        stands for Encryption LesS )

[1/22/94 public]
 Changed responsible engineer to Mario Moreira...very low priority!!!

[4/19/94 public]
Ah who cares, this is cancelled - too low a priority anyway!



CR Number                     : 8374
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : ?
Short Description             : fs test suite failures on hpux
Reported Date                 : 7/27/93
Found in Baseline             : 1.0.3b1
Found Date                    : 7/27/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/27/93 public]


The fs tests 7,8, and 10 are failing on hpux.  Here are the partial
logs:



TEST7:

test7 iteration number 1
Number of files obtained by find: 1
Filesizes obtained by wc: 16384
- diff -r failed (E3)
test7 iteration 1 done

fs/test7 returning 1 in /.../headache.qadce.osf.org/fs/dfs-test/fs
Tue Jul 27 16:56:53 EDT 1993
---------


TEST8:

This is a DFS directory
The file '.' resides in the cell 'headache.qadce.osf.org',
in fileset 'root.dfs', on host explorer.osf.org.
Fileset Name          Quota    Used  % Used   Aggregate
root.dfs             4278870971   26489     0%     0% = 26489/4278870971 (non
-LFS)
DFS is using 973 of the cache's available 10000 1K byte (disk) blocks.


Move directory failed (E13)
Copy directory failed (E15)

fs/test8 returning 2 in /.../headache.qadce.osf.org/fs/dfs-test/fs
Tue Jul 27 16:57:24 EDT 1993
#
----


TEST10:

Details of directory #2 - /.../headache.qadce.osf.org/fs/dfs-test/fs
-------------------------------
This is a DFS directory
The file '.' resides in the cell 'headache.qadce.osf.org',
in fileset 'root.dfs', on host explorer.osf.org.
Fileset Name          Quota    Used  % Used   Aggregate
root.dfs             4278870971   26716     0%     0% = 26716/4278870971 (non
-LFS)
DFS is using 1421 of the cache's available 10000 1K byte (disk) blocks.


test10 starting process number 1
   test10 starting iteration 1, process number 1
- test10 process 1: diff -r failed (E5)
- test10 process 1: diff -r failed (E8)
- test10 process 1: diff -r failed (E10)
- test10 process 1: diff -r failed (E11)
   test10 iteration 1, process number 1, done
test10 process number 1 done

fs/test10 returning 1 in /.../headache.qadce.osf.org/fs/dfs-test/fs
Tue Jul 27 16:59:18 EDT 1993

[07/28/93 public]

It appears that the diff command on HPUX has some different 
and unexpected behavior.  The following sequence of commands
illustrates the problem:

# mkdir abc abc/def abc/def/ghi
# mkdir abc1
# cp -r abc abc1
# diff -r abc abc1/abc
Common subdirectories: abc/def and abc1/abc/def
Common subdirectories: abc/def/ghi and abc1/abc/def/ghi
# echo $?
2

The same sequence of commands on an OSF system will return 0.

[07/28/93 public]


There is a bug in the HPUX diff command which is causing
all of the observed test failures.  The fix
is to obtain a new "diff".



CR Number                     : 8361
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : Bad libdce.sl with -O switch
Reported Date                 : 7/25/93
Found in Baseline             : 1.0.3
Found Date                    : 7/25/93
Severity                      : A
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/25/93 public]

The libdce.sl built with "-O" switch was useless.

When dce_config cdsd failed on rpc_ns_binding_unexport and
dce_login got segfault.

I rebuilt a libdce.sl without "-O" and that worked successfully
on dce_config and some smoke tests.

I am on vacation this week and I hope someone can pick this up.
 HP folk may want to re-produce this bug and debug it.

[7/26/93 public]

During the HP/UX port Bill Sommerfeld ran into the same problem.
Speculation was that there was a missing volatile declaration somewhere.

[7/26/93 public]

This is a known problem.  Workaround is "don't do that"; priority has been
dropped for now.

The crashes you get with -O have not been adequately analyzed yet, but they
appear to have something to do with exception handling.

For our product we have added a "#pragma optimize_off" to exc_handling.h
which "fixes" it at the cost of disabling the optimizer.  Avoiding using -O
until we analyze what's going on is probably the best solution.

[8/24/94 public]
I will assume this still hasn't been addressed.

Can someone (Bill?) from HP take a few seconds and either
explain why or cancel this defect.

Its been OVER A YEAR now, and I'm sure someone (certainly on HP's product
team) has figured out why this doesn't work and fixed it.

[8/25/94 public]

Functionality and bug-free-ness has been more important than high
optimization levels for us, especially since analyzing compiler bugs is a
pain in the *** in a system as large as DCE..

FYI, our most recent product release (1.0.3-based) was built at +O1 using
the A.09.34 compiler.

Note that -O is equivalent to +O2 on HP-UX.

[2/6/96 public]
Cancelled. This is more like a compiler optimization bug. Should be addressed
by individual vendors during productization.



CR Number                     : 8359
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : Changing group for existing
account does not work using change command.
Reported Date                 : 7/23/93
Found in Baseline             : 1.0.2
Found Date                    : 7/23/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/23/93 public]

In a single machine cell, configured a principal/account with group and org
as none. Using rgy_edit change command tried to change group from none to
something while leaving org as none. Got the following error:

rgy_edit=> change
Change Account=> Enter account id [pname]: dummy
Enter account group [gname]: dummyg
Enter account organization [oname]: none
?(rgy_edit) Unable to change account "none" - Account does not exist
(Registry Edit Kernel) (dce / sad)

[7/23/93 public]
Cancelled as pilot error.  You specified the new group in the wrong place.
You must specify the existing principal, group and org, then it will ask you
if you want to change any of them (ie: changing foobar's group from none to
system):

rgy_edit=> change
Change Account=> Enter account id [pname]: foobar
Enter account group [gname]: none
Enter account organization [oname]: none
Enter new account id [pname]: (foobar) 
Enter new account group [gname]: (none) system
Enter new account org [oname]: (none) 
Change password? [y/n]? (n) 
Enter new misc info: () 
...



CR Number                     : 8329
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : bld
Subcomponent Name             : 
Short Description             : ranlib isn't necessary on UX
Reported Date                 : 7/21/93
Found in Baseline             : 1.0.3
Found Date                    : 7/21/93
Severity                      : E
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/21/93 public]
Builds on HP/UX invoke ranlib unnecessarily.  There are a variety of
instances of:

  ranlib libedit.a
  ranlib: ar already did it for you, see ar(1).

[11/12/93 public]
The general case of this is already taken care of in osf.lib.mk by making
the invocation of ranlib dependent on TARGET_OS.  However, this still
occurs for libdce.a on HP/UX.  Therefore this must be implemented in
libdce/Makefile.

[12/23/93 public]
Changed assignment of defect.

[1/20/94 public]
The history here is that libdce.a had to be built in chunks because the 
ar command to create the library in one shot overflowed the 'exec'
command's arguement buffer.  The osf.lib.mk makefile has no provision for 
handling this kind of incremental library creation, hence the rules for 
archiving the static libdce library in the Makefile.  The reason the ranlib
is done is because (at the time I wrote it anyway) OSF needs/needed a
ranlib after the ar.

[1/7/94 ]
Re-assigned to me

[2/8/96 public]
Don't see it any more. Since ours is ODE only env, cancelling this..



CR Number                     : 8317
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : dfsexport
Short Description             : dfsexport hangs (sometimes) exporting episode aggregate
Reported Date                 : 7/19/93
Found in Baseline             : 1.0.2a
Found Date                    : 7/19/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[7/19/93 public]
While testing the ability to use different block and fragment combinations
on an episode aggregate, dfsexport hung. The test script repeatedly
newaggr's the same aggregate, exports it, creates filesets and mount points,
deletes filesets and mount points, and detaches it for all possible combos.
(dfs.block_frag and block_frag.data to be submitted this week along with
other scripts that execute the "stress factors" listed in the 102 and 102a
plans).
This particular run of the script hung on the first try, although previous
runs had succeeded.
Logging was:
START DATE AND TIME IS Mon Jul 19 16:14:07 EDT 1993
dfs.block_frag: Formatting aggregate
*** /dev/rrz1a ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (65536-byte) blocks: 1599
*** Defaulting to 15 log blocks                       (maximum of 2 concurrent transactions).
/dev/rrz1a: Already marked as non-BSD.
Done.  /dev/rrz1a is now an Episode aggregate.
dfs.block_frag: Formating w/ 65536 65536 PASSED
dfs.block_frag: Exporting w/65536 65536
I am unable to CTL-C out of the script or kill the dfsexport process. The
ps output indicates it is not gaining time/spinning in user space so a
kdb interrupt might show something useful.
dfstab file contains:
# blkdev aggname aggtype aggid 
/dev/rz1a      lfs_aggr2        lfs     2
/dev/rz1e      lfs_aggr3        lfs     3
/dev/rz1d      /u3              ufs     33      0,,28
and has NOT been editted since the last successful dfsexport of /dev/rz1a.
The command syntax was:
dfsexport /dev/rz1a

[7/19/93 public]
Using kdb, the only interesting thread stack around was:
thread_block()
mp_sleep()
sleep()
Lock_Obtain()
elbb_SyncForce()
efs_sync()
ag_efsFlagsToStates()
end()
Please let me know ASAP what other information would be useful as I would
like to be able to continue testing on this machine ... Thanks.

[7/19/93 public]
The newaggr lists the episode aggregate as having a maximum of two
concurrent transactions.  This may very well be too small.  I would attempt
to set the script up so that no matter what the block size, there were 
at least 4 concurrent transaction supported by each aggregate.
Can you please reproduce this problem on a RIOS.  We have no pmax platforms,
and thus cannot guarantee that we will be able to reproduce it here.
Can you please send us the scripts that you use to test this.  We will
run them here on a RIOS and see if we can reproduce the problem.
I've assigned this to mike comer for safe keeping.  I do not believe that 
this defect is stop ship for 1.0.2a.
Changed Responsible Engr. from `jaffe@transarc.com' to `comer@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[7/19/93 public]
Thanks Elliot. I've mailed you the script and datafile.

[7/20/93 public]
Rebooting and retrying the dfsexport w/o any changes to the aggregate also
hangs with a stack trace of:
task ... [dfsexport] ... W_EVENT wantkmemmap
thread_block()
malloc()
osi_kalloc()
osi_Alloc()
elbb_LogInit()
epig_Init()
end() bad ref by kdb ...
This stack may be questionnable due to the "bad ref" message but just in
case, thought I'd include this clue here.

[7/20/93 public]
elbb_Alloc tries to alloc a piece of memory the size of a block.
You're starting with a block size of 64k.  Does this mean that 
the OSF/1 memory allocator has been fixed?

[7/20/93 public]
The "real" thread stack was probably more like this:
thread_block()
mp_sleep()
sleep()
Lock_Obtain()
elbb_SyncForce()
efs_sync()
ag_efsSync()
afscall_aggr()
syscall [or whatever it is called in OSF/1]
...
This represents a fileset deletion.  (The only caller of AG_SYNC is the
fileset deletion code in ftserver/ftserver_vprocs.c.)  It is trying to obtain
the global lock on the logged buffer system.  (That is, the call to Lock_Obtain
is in the body of the macro BUFFER_LOCK, invoked in elbb_SyncForce.)
.
This seems like a perfectly normal state of affairs and I cannot tell, from
this information only, why there would be a deadlock.  Presumably either
someone has forgotten to release the buffer lock, or there is some other thread
that is holding that lock and is somehow deadlocked with this thread.
Note that this is NOT the stack of a call to dfsexport.  If dfsexport is
also hung, it might be helpful to see its stack too.  (However it might just
be hung trying to obtain the same lock, which would not shed any new light
on the situation.)  My advice is, if you see this again, get stack traces
of ALL the threads that you can.  Also, if there is any way you can improve
the quality of the stack traces (i.e. show static functions such as ag_efsSync
instead of ag_efsFlagsToStates, and show the entire stack), that might be
helpful too.

[7/21/93 public]
I couldn't reproduce this on a rios so I'm assigning this back to you,
Gail, as pmax-specific.  I ran the script you sent to Elliot 14 times
in a row successfully.  I then got some failures -- probably due to my
ticket expiring -- but no hangs.  After cleaning things up (but not
rebooting), the script continues to run.
By the way, there was a bug in the version of the script I got where
the list of filesets wasn't being cleared on delete.
Filled in Interest List CC with `comer@transarc.com' 
Changed Responsible Engr. from `comer@transarc.com' to `gmd' 
Changed Resp. Engr's Company from `tarc' to `osf'

[7/30/93 public]
Since this appears to be pmax-specific BUT may prove to be a test/code/doc bug
that 4 concurrent transactions is the minimum, I'm leaving this open and moving
it to 1.0.3.

[8/9/93 public]
4 concurrent transactions should not be required for things to work
properly.  I suspect this scenario is hitting problems in the pmax
kernel -- at least on of the problems your mention above looks related
to the memory allocation bug/feature of OSF/1.  
Changed Priority from `1' to `2'

[10/8/93 public]

Aged relative to Aug 1.

[10/14/93 public]

Both Steve Moriarty and I have successfully run dfs.block_frag on the HP. I am doublechecking
that the low number of concurrent transactions was hit before cancelling.

[10/14/93 public]

Forced number of transactions to be 1 by restricting the logsize to be 10 (switch on newaggr)
and hit a whole different problem running dfs.block_frag (with all newaggr's
containing the -logsize 10):

dfs.block_frag: Creating 11 filesets on aggr w/ 32768 16384 PASSED
dfs.block_frag: Fileset operations not yet implemented
dfs.block_frag: Deleting filesets
Returned from rpc_server_listen: cthread create failed (dce / rpc)
RPC no longer listening to network: cthread create failed (dce / rpc).
AFS_SetContext(budapest.osf.org) fails: Internal corruption (dfs / fsh)
Error in delete: Internal corruption (dfs / fsh)
delete FAILED

Closing this CR and opening another ... net gain 0 except for the aging.



CR Number                     : 8312
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : rpc
Subcomponent Name             : rpccp
Short Description             : inclusion of  <fcntl.h> not portable
Reported Date                 : 7/19/93
Found in Baseline             : 1.0.2
Found Date                    : 7/19/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : rpccp.c
Sensitivity                   : public

[7/19/93 public]


The addition of  " #include <fcntl> " is operating system specific.
fcntl is a operation system specific header file.

The inclusion of file.h, a C header file, includes the necessary
information, on u*x systems it includes fcntl.h, and is portable.

The following depicts the change:

+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +
Element RPCCP.C(12) Line 96
      1)#include <sys/file.h>
      1)

+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +
Element RPCCP.C(11) Line 96
      2)#include <fcntl.h>
      2)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -


This change was compiled, built, and executed on three of our platforms,
two of them being ultrix and osf/1.

[7/19/93 public]

Not so fast; I just checked my copy of the POSIX standard.

POSIX.1 specifies <fcntl.h>.

It does *not* specify <sys/file.h>

This change decreases portability, not increases it, and should probably
not go in.

[7/20/93 public]

Good point.  I was not aware of this.  But, our definitions of portability are
different.  My definition extends beyond u*ix operating systems to other o.s.
where fcntl.h does not exist.  Your definition of portability addresses only
the u*ix world.  So, your point about this change decreases portability is not
true when talking about my definition of portability.  The rpccp.c component 
has been building on all the platforms until this change.

[07/20/93 public]
Perhaps you have a system where "file.h" is found and "fcntl.h" is not
found.  This doesn't mean that using file.h is the "more portable" thing
to do.  DCE conforms to Posix, and posix says "use fcntl.h".  For 1.1
this defect should probably be cancelled; I guess for 1.0.3 it can
live a little longer. :-)

[7/20/93 public]

"DCE conforms to Posix" - no need to say more.  POSIX chose System V's not BSD's
header file.  My loss.  No sense it letting this live longer then it needs to.
I'll cancel this defect.

[07/20/93 public]
Canceled.



CR Number                     : 8285
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsclerk.h and dnsclerk.h should not be on ILIST
Reported Date                 : 7/15/93
Found in Baseline             : 1.0.2
Found Date                    : 7/15/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/93 public]
The include files cdsclerk.h and dnsclerk.h give the prototypes for
the cds programming interface (cdspi). The cdspi is an unsupported
and undocumented interface used by the dce core components. Both
cdsclerk.h and dnsclerk.h are currently on the ILIST, so they are
installed on customer systems.  Customers will use these routines
and eventually require support for them.  We should either delete
cdsclerk.h and dnsclerk.h from the ILIST, or document and support
this interface.

[07/29/93 public]
I checked with management on this end, Dave Loundsbury in particular, and
the headers stay in the ILIST. Although we do not encourage the use of
the cdspi and those who do use it must be responsible for the consequences
of a change we realize it is being used on occasion.



CR Number                     : 8283
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 
Short Description             : syntax errors in sec_login_pvt.c
Reported Date                 : 7/15/93
Found in Baseline             : 1.0.3
Found Date                    : 7/15/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/15/93 public]

"/u1/users/devobj/sb/nb103_rios/src/security/h/sec_login_pvt.h", line 119.5: 1506-046 (S) Syntax error.
"/u1/users/devobj/sb/nb103_rios/src/security/h/sec_login_pvt.h", line 132.22: 1506-046 (S) Syntax error.
"/u1/users/devobj/sb/nb103_rios/src/security/h/sec_login_pvt.h", line 137.5: 1506-046 (S) Syntax error.
"/u1/users/devobj/sb/nb103_rios/src/security/h/sec_login_pvt.h", line 145.5: 1506-046 (S) Syntax error.
"/u

[7/15/93 public]

Changed Responsible Engr. from wang to pwang.

[7/22/93 public]
burati@apollo.hp.com wrote:
This occurs on RIOS because there is a ridiculously low limit on the
number of chars allowed in the -I's of a compile line.  It hits this
file first because it is one of the longer filenames, with more places
that it needs to get includes from than other files.  Shortening the
names of the sandboxes will help (Elliot's suggestion of creating
/ relative links to the sandboxes and using those instead of long AFS
pathnames fixed the problem for me).

After confirmed with paananen, this problem has not happened in night 
build, so this bug should be concelled.



CR Number                     : 8273
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : rpc
Subcomponent Name             : rpcd (endpoint mapper)
Short Description             : is_listening not initialized
Reported Date                 : 7/14/93
Found in Baseline             : 1.0.2
Found Date                    : 7/14/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : rpcdsliv.c
Sensitivity                   : public

[7/14/93 public]

In the ping_server routine, the boolean variable is_listening is not
initialized to false.  ping_server could potentially return a true when the
server is not at all listening thus leaving stale data in the ep database.
D
D
D
D
D
D
D
D
D
D
D
server is not at all listening and thus leav

[08/23/93 public]
Looking at the code, the variable in question, is_listening, is always set:

	is_listening = rpc_mgmt_is_server_listening(binding_h, status);

The call to rpc_mgmt_is_server_listening() will always return true or false.

Not a bug, canceled.



CR Number                     : 8268
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : rpc
Subcomponent Name             : 
Short Description             : Turn on prototype for other platforms/languages supported by DCE.
Reported Date                 : 7/13/93
Found in Baseline             : 1.0.2
Found Date                    : 7/13/93
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : dce_error.h
Sensitivity                   : public

[7/13/93 public]
 
Turn on prototypes for dce_error_inq_text() for languages and platforms
supported by DCE.

[10/14/93 public]
As far as I can see the file *does* provide prototypes:
extern void dce_error_inq_text (
#ifdef __STDC__
    unsigned long           status_to_convert,
    unsigned char           *error_text,
    int                     *status
#endif    
);

Until code cleanup time, using STDC seems good enough for me.
Canceled.



CR Number                     : 8251
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : rep
Short Description             : rep test3 fails rios to rios
Reported Date                 : 7/8/93
Found in Baseline             : 1.0.2a
Found Date                    : 7/8/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/8/93 public]


Replication test3 fails when run rios to rios:


Added replication site barge m1.aggr2 for fileset Rubble.23563.3
Passed
Added replication site cobbler m3.aggr2 for fileset 5459
Passed

Checking sites...
- sites are wrong (1):
4d3
< fileset 4 on cobbler /dev/lv02, sa 1:17:00.
rtest3: Test case, E123: FAILED


----


# pwd
Checking sites...
- sites are wrong (1):
2d1
< fileset 1 on cobbler /dev/lv02, sa 0:31:00.
4d2
< fileset 2 on cobbler /dev/lv02, sa 0:10:00.
6d3
< fileset 3 on cobbler /dev/lv02, sa 0:31:00.
8d4
< fileset 4 on cobbler /dev/lv02, sa 0:30:00.
rtest3: Test case, E125: FAILED

Checking FLDB info, sixth time


We'll see if we can get more detailed information.

[07/13/93 public]

Apparently there was some cruft left over from
previous runs which failed due to setup problems.
This seems to upset the reptests (i.e., having other replicated
filesets in the cell).

Cancelling.



CR Number                     : 8227
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : ftserver
Short Description             : ftserver appears hung during cho
Reported Date                 : 7/2/93
Found in Baseline             : 1.0.2a
Found Date                    : 7/2/93
Severity                      : B
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : open

[7/2/93 public]
This is an all-rios cho configuration.  After more than 20 hours one of the
lfs filesets exported by machine1 (barge) became unavailable:
# cd m1.lfs1
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
^Z
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
dfs: fileset (0,,4) is busy with code 691089542 on server 130.105.5.20 in cell dfs_only_works_at_transarc.
# fts statft -server /.:/hosts/barge
Error in statftserver: communications failure (dce / rpc)
Here's the end of the ftlog on barge; Note that there has not been any logging in the
last 12 hours:
 
93-Jul-01 21:53:10 vols_Restore: returning 0
93-Jul-01 21:53:10 Restored fileset 0,,5309/3: returned code 0
93-Jul-01 21:53:25 Restoring fileset 0,,5309/3
93-Jul-01 21:53:25 vols_Restore: returning 0
93-Jul-01 21:53:25 Restored fileset 0,,5309/3: returned code 0
93-Jul-01 22:16:09 ftserver_CreateVolume: created ft4.28585 as 0,,5320 on aggr 3
93-Jul-01 22:48:12 ftserver_CreateVolume: created fts.test14.28476 as 0,,5323 on aggr 3
93-Jul-01 22:58:14 ftserver_CreateVolume: created fts.test14.28476 as 0,,5323 on aggr 3
93-Jul-01 22:58:59 Restoring fileset 0,,5323/3
93-Jul-01 22:59:01 vols_Restore: returning 0
93-Jul-01 22:59:01 Restored fileset 0,,5323/3: returned code 0
93-Jul-01 22:59:20 Restoring fileset 0,,5323/3
93-Jul-01 22:59:20 vols_Restore: returning 0
93-Jul-01 22:59:20 Restored fileset 0,,5323/3: returned code 0
 
ps -deaf | fgrep ftserver
    root 15789 15018   0   Jun 30      - 23:18 /opt/dcelocal/bin/ftserver 
I tried to get an icl log but the ftserver does not appear to respond.
It does not appear to be using any cpu time either.

[7/2/93 public]
The error code is the new VOLERR_TRANS_PENDING one, saying that some process
is in the middle of a VOL_AGOPEN syscall desiring to take this fileset
off-line for some reason, and the exporter returns this failure to allow
the fileset to become available for the operation.  However, the VOL_AGOPEN
is not allowed to proceed until the activeVnops count for the fileset goes
to zero.  Clearly, here, the ftserver is the process stuck in the kernel
doing this syscall, as it's not tracing or logging anything, or responding
to RPCs: it's in the kernel, in a system call.  The question would be why
the activeVnops count isn't reaching zero.  There's a new ICL log that can
be dumped (called ``disk,'' it logs the ``xops'' ICL set among others); its
contents may be useful here.  Also useful would be to know what the current
activeVnops count is, since it looks like this value is being incremented
without being decremented.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[7/7/93 public]
I'm not sure that Transarc can make any further progress on this item.  I'm
happy to leave this assigned to Transarc, but I would like the next person 
to hit this problem to contact us so that we can gather as much information
as possible.
Changed Responsible Engr. from `jaffe@transarc.com' to `comer@transarc.com' 
Filled in Transarc Status with `open'

[07/16/93 public]
Defer to 103 since this does not appear to be in our
way right now.

[9/28/93 public]
This defect is getting a little long in the tooth.  Is it still a problem?
Can we cancel it?

[10/8/93 public]
There doesn't seem to be any activity on this defect so I'm giving it
back to Diane.  Please assign it back to me if there's still a
problem.
Filled in Interest List CC with `comer@transarc.com' 
Changed Responsible Engr. from `comer@transarc.com' to `delgado' 
Changed Resp. Engr's Company from `tarc' to `osf'

[10/08/93 public]

Has not been seen on the 1.0.3 code base - cancelling



CR Number                     : 8222
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : gds
Subcomponent Name             : 
Short Description             : Talking to a 1.0.1 DSA from a
1.0.2 client causes the 1.0.1 S-stub to go away
Reported Date                 : 7/1/93
Found in Baseline             : 1.0.2a
Found Date                    : 7/1/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/1/93 public]

Full Description:

	I was trying to do some client server communication between 1.0.1 GDS
	(my Sparc port) and 1.0.2 GDS (AIX ref port, 1.0.2a_b2 build).

	When I tried to connect 1.0.2 GDS to my 1.0.1 DSA running on my Sparc,
	I got warning/error saying "Couldn't read schema", but it did connect
	to the DSA, then when I tried to read attributes of an entry by
	specifying the necessary items, I got "No connection to DSA/DUA" error.
	Checking on the 1.0.1 GDS on Sparc, I foudn the S-stub process was 
	gone.
	
	Going from 1.0.1 to 1.0.2 DSA is OK.


Proposed Solution:

	This could be the problem of my 1.0.1 GDS Sparc port. But I was not
	able to find a reference 1.0.1 port to test it.

[9/21/93 public]


I am not sure whether this is  a porting problem or a real
problem in GDS 1.0.1. I have no version of GDS1.0.1 and I
don't want to fix bugs in GDS1.0.1 which are already fixed in GDS 1.0.3.
I don't know what you have done but there was some excepted 
incompatible changes in the protocol between 1.0.1 and 1.0.3
(e.g. for some conformance issues).
I don't think that this is a prior 1 bug and atleast we should close
it or downgrade it.

[10/15/93 public]

Cancelled.



CR Number                     : 8200
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : building rpcd
Short Description             : rpcd should not have llbd support
Reported Date                 : 6/25/93
Found in Baseline             : 1.0.2
Found Date                    : 6/25/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/25/93 public]
By default, rpcd should be built without NCS1.5 llbd support.  This means
adding -DNO_LLB to the CFLAGS, or perhaps adding NO_LLB as a make
variable.  I can't figure it out -- somebody who understands rpc.mk and
rpcd/Makefile should make this change.

[6/25/93 public]
It should probably be combined with the other variables that do the NCS
support such as NO_COMPAT_NCS15 in src/rpc/runtime/Makefile.

[6/25/93 public]

1) I don't think that this is a defect.

2) even if it is, you don't want to combine NO_LLB and NO_COMPAT_NCS15
(they were originally combined and were separated for a reason).

If NO_LLB is off and NO_COMPAT_NCS15 is on, you generate an rpcd which can
deal with llb requests from legacy NCS applications (such as the HP-UX
audio server, questions about which from Rich Salz spawned this defect
report), without all the COMPAT_NCS15 rpc_$foobar calls.

Since llbd and rpcd use the same well known port, you can't run both of
them at once.

I don't think the 1.5 llbd support hurts you any; you aren't testing it,
and it doesn't add that much code space.

[10/14/93 public]
I am going to have agree with Bill on this one.  Since HP is now a reference
port, its usefull to us (OSF) to have this functionality, and its more
work to take it out.

Besides, you can turn it off with the ifdefs.
Canceled.



CR Number                     : 8198
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : sec
Short Description             : Credentials incorrect after restarting secd?
Reported Date                 : 6/24/93
Found in Baseline             : 1.0.2
Found Date                    : 6/24/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[6/24/93 public]
When there was not enough disk space left and running bos tests secd was killed
with screen message:
Registry: Fatal Error - Unable to write database header.
 at line 983 of file ../../../../../src/security/server/rsdb/balanced_trees.c
Registry: Fatal Error - Checkpoint task aborting
 at line 365 of file ../../../../../src/security/server/rs/rs_rsdb.c
Registry: Fatal Error - DT exiting with alert exception
 at line 487 of file ../../../../../src/security/server/rs/rs_main.c - 0x0000000
0 - successful completion
Registry: Fatal error in main thread; exiting
I understand that if secd continues its life then thing could be even worse 
but after I started secd manually (I suppose this will work) the bos test4
hang on "bos stop" command and when I was creating a cds directory the
message was given
puzzle# cdscp cre dir /.:/dfs-test
Error on entity: /.../puzzle.com/dfs-test
Insufficient rights to perform requested operation (dce / cds)
Function: dnsCreateDir
Note that I was cell_admin at that time.
After a reboot all problems were gone. 
--Jess
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[6/24/93 public]
Fixed short description to be more descriptive of what the problem is.
Changed fixby field from 1.0.2 (which has already been shipped) to 1.0.3.
Changed engineer from Bill to myself, because I've just seen the problem
recently, and Bill's not available to look into it at the moment...

[09/28/93 public]
I had assigned this to myself originally because I had seen the problem back
in the 1.0.2 timeframe once and figured that I'd be able to reproduce it
easily...  This is not reproducible at 1.0.3 (I just spent a half hour killing
and restarting secd and other shells that were in cdscp, running klist,
rgy_edit... kept working after restarts).  If no one from Transarc listed
above (Jaffe, Pahktar, Jess, Fred) can reproduce this with 1.0.3 in the next
two weeks (because of the freeze), then I'll cancel it as unreproducable.

[10/7/93 public]
Not reproducable. Cancelled.



CR Number                     : 8195
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : rios client hangs on close if disk quota is exceeded.
Reported Date                 : 6/23/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/23/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[6/23/93 public]
While running dfs.lock, the fileset became full enough that there was not
enough room for the whole data file to be written.  On a pmax, the behavior
in this case was somewhat expected; the client did a bunch of reads, and
then returned a "disc quota exceeded" error on closing the file.  On the 
rios, the client hangs on the file close in this situation.

[6/23/93 public]
Changed Responsible Engr. from `jaffey' to `tu@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[9/28/93 public]
I have tried to run several tests to create that "disk quota exceeded" 
situation but without any success. In fact, I suspect that there was some 
other thing went wrong that caused the system hung at the time rather than 
this disk full error. Please cancel it if you have not been able to 
reproduce it any longer. thanks.
Filled in Subcomponent Name with `cm'

[10/4/93 public]
We have been unable to reproduce this problem.  You may wish 
to wait for the Transarc drop to attempt to reproduce this bug.
Changed Responsible Engr. from `tu@transarc.com' to `mhickey' 
Changed Resp. Engr's Company from `tarc' to `osf'

[10/8/93 public]

Aged relative to Aug 1.

[10/14/93 public]
Assigned to Gail to reproduce.

[11/24/93 public]
I thought I'd hung but actually I did get the following message eventually:

cp: cannot close /:/RP-final_logs: No space left on device

There was at least a five minute delay between running out of space and
having this error returned to me. This is not as troubling as the fact
that a partial file with no permission bits is left around. 

root@vodka> ls -l /:/RP*
----------   1 guest    12       88276992 Nov 24 16:43 /:/RP-final_logs

The copy was from a HP native filesystem to a RIOS lfs fileset whose
quota was larger than the available space on the logical volume for
the lfs fileset and smaller than the file being copied. Is this related
to the HP-specific cp error (CR 9552)? I will continue testing with the
filewnr program to see if the "hang" portion of the problem is specific
to the test.

[11/24/93 public]
Tested by starting a filewnr -n 10000 -f /:/<client_machine_name>_filewnr.out
on both a rios and hp. (both are flservers, file servers and clients - the
rios happens to be the file server for root.dfs). Neither test should complete,
regardless of what the other does, based on lack of physical space on the
logical volume housing root.dfs.

The rios 1/2 of the test was started ~2 minutes before the hp 1/2 and exited
correctly with a failure on close. The hp 1/2 appears to have hung - the
size of the file remained constant for 20 minutes while the filewnr 
program did not reported anything - but did eventually report that the
close failed. So ... I would say that either the hang WAS due to some
other cause OR was reported prematurely. Note that all writes returned
success even those that occured over 15 minutes after the device
was full. I believe this is the undesirable but consistent/expected behavior
of dfs.

So - are the incomplete files supposed to be left around? What happened
to the permissions on the incomplete copy? I'll cancel this and open
separate bug(s) when responses are received here - thanks!

[01/16/94 public]
Canceling - both exceeding quota AND "No space left on device" are reported.



CR Number                     : 8194
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : hppa
S/W Ref Platform              : hpux
Component Name                : dfs
Subcomponent Name             : dfsbind
Short Description             : set auth binding fails with  sec_login_s_no_current_context
Reported Date                 : 6/23/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/23/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[6/23/93 public]
We have now seen this more than once, first with cho and then
with other stress testing:
dfs: set auth binding failed (code 387064044)
dfs: Warning: created unauthenticated binding
:#define sec_login_s_no_current_context (387064044)
I am logging this as a '1' because the use of the unauth binding 
will cause permissions problems with the cho tests.  This seems
to pop up during stress.
Also, I have not seen this before we got the dd

[6/24/93 public]
Diane, 
It could also be the problem that the caller has a bogus PAG number stored
in the CM. Would you want to set a brk pt at 
    cm_printf("dfs: set auth binding failed (code %d)\n, st)
When it stops next time, read  connp->authIdentity[0] and 
connp->authIdentity[1]. 
connp->authIdentity[1] should have the pag number and connp->authIdentity[0]
has the /use/bin/login id.
Filled in Interest List CC with `tu' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[6/24/93 public]
The message may be more or less harmless, depending on what the RPC handle
is to be used for.  There are some cases of move-TSR (that Tu is fixing in
related work) in which the cm_rrequest structure isn't being initialized
before it's used, but if it's used only for token grants, it really doesn't
matter.

[07/09/83 public ]

move to 103

[08/4/93 public]

We have now seen this on HPUX.  

dfs: lost contact with the fx server 130.105.5.22 in cell headache.qadce.osf.org
dfs: communication failure with server 130.105.5.22 in cell headache.qadce.osf.org.
dfs: set auth binding failed (code 387064044)
dfs: Warning: created unauthenticated binding
dfs: fx server 130.105.5.22 in cell headache.qadce.osf.org back up!

[11/5/93 public]

Cancelling - We have not seen this for at least a month.



CR Number                     : 8189
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : unknown
Short Description             : the rios panics during cho
Reported Date                 : 6/22/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/22/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[6/22/93 public]
This has happened now two nights in a row.  After about 3 hours
of cho machine 1 panics.  I have two crash dumps on alcatraz in
/u0/dump-jun-22 and /u0/dump-jun-21.  There is not much information
to go on here.  The stack of the running process is 0 in both cases.
Please do not down grade the priority or severity of this bug as it
is blocking us from meeting our exit criteria.

[6/22/93 public]
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[6/22/93 public]
Transarc can not make any progress on this problem until there is more
information.  Its clear that the machine is crashing, but we have no clue
why or where.  I would suggest making sure that the dump volume (/dev/hd7)
has at least as much space as the physical machine memory.  Having a debugger
on the machine will greatly improve our changes of debugging this.  Since we
havn't seen this at Transarc, we can't provide much assistance at this point.
Filled in Interest List CC with 
 `jaffe@transarc.com,cfe@transarc.com,tu@transarc.com' 
Changed Responsible Engr. from `jaffe@transarc.com' to `delgado' 
Changed Resp. Engr's Company from `tarc' to `osf'

[06/22/93 public]
Did you look at the crash dumps or are you just guessing?\
All the information in them is not zero. There's stuff
in there about what was runnable at the time, and rather
than my having to pull all of that out of the crash dumps
and put it in this ot I though it would be better for
someone at transarc to look at them.
Since we do not have a working rios debugging enviornemnt
the crash dumps will have to suffice.  They do contain
the state of the system at the time of the crash, so
there must be something in there you can use.

[6/23/93 public]
Well, This has been interesting.  I finally got through gazacha onto alcatraz.  After poking around for a while, I found the following things:
When I logged on the machine was very slow.
You are running AIX 3.2.3 (I can tell because you have a /usr/lpp/bosperf
directory, which exists only on 3.2.3)
Your machine is a 16 Meg rios.
Your paging to three paging partitions, on three different disks, and each of
these disks is operating at close to %50 of capacity.  I'de say that much of
the slowness is caused by the paging.
Your /dev/hd7 partition which is used for dumping crash dumps is only 8 meg.
This means that you never get a complete crash dump, which may be why we have
so much trouble with the crash dumps.
All I can tell from the crash dumps for 8189 is that some kernel thread caused
a Data Storage Interrupt.  With a larger /dev/hd7, or a debugger, we could
probably track this down.
I am going to reassign 8189 back to the OSF because you need to get more info
for anyone to make progress.
Changed Responsible Engr. from `jaffe@transarc.com' to `delgado' 
Changed Resp. Engr's Company from `tarc' to `osf'

[06/25/93 public]

This usually happens within 3 hours of adding the acl tests to the cho
cell. Note, we've found that it seems the system has to be loaded and
have the acl tests running to it from another client in order for this
to happen.  Yesterday, we got a hang instead of a crash, and today
we got another crash:

> trace
STACK TRACE:
        [dfscore.ext:zlc_PruneQueue] ()
Frame pointer not valid.
> pcb
        USER AREA FOR thr$ (ProcTable Address 0xe3003a00)

SAVED MACHINE STATE 
    curid:0x00003a64  m/q:0x00137683  iar:0x05989cb0  cr:0x24000082 
    msr:0x000090b0  lr:0x05989c8c  xer:0x00000018
    ctr:0x000863c0  *bus:0x00000000
    *prevmst:0x00000000  *stackfix:0x00000000  intpri:0x0000000b 
    backtrace:0x00  tid:0x00000000  fpeu:0x00  ecr:0x00000000
    Exception Struct
      0x000007ae  0x0a000000  0x00000000  0x000007ae  0x00000106
    Segment Regs
     0:0x00000000   1:0x007fffff   2:0x00001210   3:0x007fffff  
     4:0x007fffff   5:0x007fffff   6:0x007fffff   7:0x007fffff  
     8:0x007fffff   9:0x007fffff  10:0x007fffff  11:0x007fffff  
    12:0x007fffff  13:0x007fffff  14:0x00000606  15:0x007fffff  
    General Purpose Regs
     0:0x00000000   1:0x2ff7f698   2:0x059e31b0   3:0x00000001  
     4:0x00000780   5:0x00000000   6:0x00000001   7:0x00000000  
     8:0x000001f0   9:0x00000185  10:0x00137683  11:0x05d75980  
    12:0x0597f1d4  13:0xdeadbeef  14:0xdeadbeef  15:0xdeadbeef  
    16:0xdeadbeef  17:0xdeadbeef  18:0xdeadbeef  19:0xdeadbeef  
    20:0xdeadbeef  21:0xdeadbeef  22:0xdeadbeef  23:0xdeadbeef  
    24:0xdeadbeef  25:0xdeadbeef  26:0xdeadbeef  27:0xdeadbeef  
    28:0xdeadbeef  29:0xdeadbeef  30:0x0598aaa0  31:0x059899e4  
    
Floating Point Regs
        Fpscr: 0x00000000 
     0:0x00000000 0x00000000  1:0x00000000 0x00000000  2:0x00000000 0x00000000 
     3:0x00000000 0x00000000  4:0x00000000 0x00000000  5:0x00000000 0x00000000 
     6:0x00000000 0x00000000  7:0x00000000 0x00000000  8:0x00000000 0x00000000 
     9:0x00000000 0x00000000 10:0x00000000 0x00000000 11:0x00000000 0x00000000 
    12:0x00000000 0x00000000 13:0x00000000 0x00000000 14:0x00000000 0x00000000 
    15:0x00000000 0x00000000 16:0x00000000 0x00000000 17:0x00000000 0x00000000 
    18:0x00000000 0x00000000 19:0x00000000 0x00000000 20:0x00000000 0x00000000 
    21:0x00000000 0x00000000 22:0x00000000 0x00000000 23:0x00000000 0x00000000 
    24:0x00000000 0x00000000 25:0x00000000 0x00000000 26:0x00000000 0x00000000 
    27:0x00000000 0x00000000 28:0x00000000 0x00000000 29:0x00000000 0x00000000 
    30:0x00000000 0x00000000 31:0x00000000 0x00000000 
> 



-r
SLT ST    PID   PPID   PGRP   UID  EUID  PRI   CPU   EVENT  NAME
  2 r      202     0     0     0     0   127   120          wait  
        FLAGS: swapped_in no_swap fixed_pri kproc
  3 r      303     0     0     0     0    39     0          netw  
        FLAGS: swapped_in no_swap fixed_pri kproc
 13 r      d07     1   d07     0     0    60     0          errdemon  
        FLAGS: swapped_in wake/sig locks
0452-220: Cannot read process table entry  33.
 45 r     2d4b  2c4a  2c4a     0     0    68    17          flserver  
        FLAGS: swapped_in
 52 r     349a  3353  349a     0     0    93    67          crash  
        FLAGS: swapped_in
 56 r     3862  365f  1a29     0     0    61     2          thr   
        FLAGS: swapped_in kproc
 58 r     3a64  365f  1a29     0     0    61     2          thr$  
        FLAGS: swapped_in kproc
0452-220: Cannot read process table entry  78.


I haven't got through the first crash dump yet as this latter crash
happened after I restarted dfs and was trying to look at the first
crash dump.  


Crash dumps are there on alcatraz in /u0 - please have a look and
see what you think.

[07/09/93 public]

move to 103

[09/01/93 public]


This isn't a zero anymore.  Will attempt to veryify on 1.0.3
or cancel

[10/7/93 public]

We ran 48 hours of cho with the ACL tests on 1.0.3 and did
not see the problem.



CR Number                     : 8184
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : need define cached server in rc.dce
Reported Date                 : 6/21/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/21/93
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/21/93 public]

After rebooting and restarting DCE on machines on different subnets in
the same cell, I noticed that cds client machines on a different subnet
from the cds server required the "cdscp define cached server" command in
order to function properly. This command should be included in the rc.dce
script and enabled by dce_config when the initial configuration requires
the "cdscp define cached server" command.

It would be nice to have this fix during 102a for making large cell testing
with DFS a little easier.

[07/16/93 public]
Placed this in dce and moved fix by to 1.0.3.

[8/9/93 public]
I don't see why a "cdscp define cached server" should be necessary on a client
machine after the initial configuration was completed (assume completions 
without error). The cds_cache should contain the server binding information 
at this point and  following the reboot and restart operations irrespective of 
the subnets of the client and server.

[03/28/94 public]
I don't believe this is really needed.  Once the define cache server
has been done, there should be no need for rc.dce to so it again.
Canceling and John D. can reopen if I am wrong.



CR Number                     : 8180
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpc/runtime/cn
Short Description             : Potential memory leak in CN call control block.
Reported Date                 : 6/18/93
Found in Baseline             : 1.0.2
Found Date                    : 6/18/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/18/93 public]

rpc__cn_call_ccb_create() allocates a large fragbuf for the protocol
header. However, rpc__cn_call_ccb_free() returns it to a small fragbuf
list. In cncall.c/rpc__cn_call_ccb_create():
    fragbuf_p = rpc__cn_fragbuf_alloc (false);
In cncall.c/rpc__cn_call_ccb_free():
        rpc__cn_smfragbuf_free (ccb->prot_header);

This means that a process is wasting some memory, i.e., a large fragbuf in
a small fragbuf list.

[7/2/93 public]

Fixing the above memory leak caused secd and cdsd crashes in our
scalability testing (>50 client nodes doing dce_login and change passwd
simultaneously for 8 hours). The crash happened in free() because of memory
corruption in malloc'ed space. Our guess is that somewhere in CN code, the
small fragbuf, which is used only for the call_rep->prot_tlr, is
overwritten beyond 256 bytes. Without the fix, the small fragbuf free list
is populated with large fragbufs and it gives enough space to be
overwritten.

Also, I believe that sometime in the past, call_rep->prot_header
(ccb->prot_header) size was increased from the small fragbuf to the large
one (in rpc__cn_call_ccb_create()). However, other parts of CN code weren't
adjusted. For instance, RPC_CN_FREE_ALL_EXCEPT_PROT_HDR macro defined in
cnxfer.h is still using rpc_c_cn_small_frag_size to calculate the free
bytes in the prot_header.

[9/24/93 public]
rpc__cn_fragbuf_alloc with the input value 'false' is going
to allocate only a small fragbuf. (see cnfbuf.c) -
So rpc__cn_call_ccb_free() is doing the correct thing 
of calling rpc__cn_smfragbuf_free();

[9/24/93 public]

Right. I'm cancelling this CR.



CR Number                     : 8168
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : List of Optional DFS servers is wrong
Reported Date                 : 6/17/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/17/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[6/17/93 public]
When installing DCE/DFS from dfs-103-3.18 (dce1.0.2ab4), it suddenly
pops up a question about whether optional dfs SERVERS should be
installed. (The relevant function in dce_config is install_dfs. ) And
the list of servers (!) displayed is
	cm fms udebug
	scout upclient upserver
The only DFS server in this list is upserver. Scout is considered to
be a monitoring tool and not a DFS server. 
This error needs rectification.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[7/7/93 public]
This is low priority - moving to fixby 1.0.3.

[7/7/93 public]
This is a technicality more than a bug.  Cancelling.



CR Number                     : 8166
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : holding wrong lock in truncate
Reported Date                 : 6/16/93
Found in Baseline             : 1.0.2
Found Date                    : 6/16/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[6/16/93 public]
The solaris port is holding the wrong lock in TryToSmush and TruncateFile.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[6/17/93 public]
Solaris specific defects do not belong in OT.
Changed Status from `open' to `cancel'



CR Number                     : 8164
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : uuid
Short Description             : procedure uuid__get_os_time in the file
.../src/rpc/runtime/uuidsys_template uses wrong base time for timestamp
component of a uuid.
Reported Date                 : 6/16/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/16/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/16/93 public]
The timestamp component of a DCE variant uuid must use base time of October
15, 1582.  The routine generating uuids (uuid_create) calls
uuid__get_os_time to get a timestamp to be used in the uuid.  The
uuid__get_os_time procedure in .../src/rpc/runtime/uuidsys_template returns
the value obtained from a gettimeofday call which returns a time relative
to a date in 1970, not 1582.  Note that the os dependent routines, for
example uuid_ultrix.c, add an offset to the value returned by getttimeofday
to correct for the difference in time basis.  uuidsys_template.c should
either use the utc_ call or add an offest to gettimeofday.

[8/24/94 public]
There is only one copy of uuid__get_os_time(), now contained in uuidsys.c.
It correctly adds the offset for utc time.
uuidys_template.c no longer exists.
Bug canceled.



CR Number                     : 8140
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : bak
Short Description             : bakserver hangs on deletedump
Reported Date                 : 6/10/93
Found in Baseline             : 1.0.2
Found Date                    : 6/10/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Status               : open

[6/10/93 public]
The bakserver has been hanging when deletedumps are done on it. 
The sequence required to hang it is
	Do a Deletedump of a non-existent dump
	do another deletedump
Added field Transarc Deltas with value `' 
Added field Transarc Status with value `open'

[6/11/93 public]
This is a duplicate of Sybase bug 3565
Filled in Interest List CC with `vijay' 
Changed Status from `open' to `cancel'



CR Number                     : 8129
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : dfsexport
Short Description             : more detach failures
Reported Date                 : 6/9/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/9/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : 

[6/9/93 public]
Detach appears to be successful, but it is not sucessful (code base is
nightly build as of 6/9/93):
root@explorer  # dfsexport -detach /dev/rz3d
dfsexport: Revoking tokens for filesets on aggregate 3...
root@explorer  # newaggr /dev/rz3d -block 4096 -frag 512 -log 300  
newaggr: The aggregate is in use; detach before continuing (dfs / ftu) locking device
root@explorer  # dfsexport
WARNING: The UFS aggregate /dev/rz3b has 0 filesets
dfsexport: /dev/rz3b, ufs, 2, 0,,0
dfsexport: /dev/rz3d, lfs, 3, 0,,0
root@explorer  # dfsexport -detach /dev/rz3d
WARNING: The UFS aggregate /dev/rz3b has 0 filesets
dfsexport: Revoking tokens for filesets on aggregate 3...
dfsexport: Failed to detach /dev/rz3d:exp.aggr1 (Aggregate is not attached (dfs / ftu))root@explorer  # newaggr /dev/rz3d -block 4096 -frag 512 -log 300
newaggr: The aggregate is in use; detach before continuing (dfs / ftu) locking device
The only thing I did to this aggregate was to export it; do an efts lsft and
then efts deleteft (which failed with "cross-device link).  I wanted to detach 
and run newaggr to get rid of the fileset but newaggr fails because the system 
thinks it's still attached.
I log this as a '1' because there does not appear to be any way around this
except to reboot, which is unacceptable.

[6/9/93 public]
Changed Responsible Engr. from `jaffe@transarc.com' to `jdp@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[06/09/93 public]
The aggregate structure is still in the kernel's registry and  in dfsatab.
The kernel struct aggr has the following values:
    a_states = 0, a_refcount = 1, aggrId=3, aggrname=exp.aggr1
When I set a_states to 1 via kdb, I am then able to detatch successfully
this aggregate.

[6/11/93 public]
Diane,
 
Is it possible that the aggregate had one of it's filesets epimounted at
the point you tried to do the detach?

[06/11/93 public]
No, I didn't mount the aggregate; I only dfsexported it.

[6/21/93 public]
First, I note that we don't have the status returned by the first detach.  Its
possible that it failed, which would explain the later behavior.  There is
a -force flag to dfsexport -detach, which would probably have solved the 
problem.  
I'm going to downgrade this to a C3, since the only error was that detach
failed without printing a message as such.  The -force switch would have 
succeeded in detaching the fileset.
If you still have this problem (with the -force switch), and can reproduce
it, we will take another look.
Changed Severity from `B' to `C' 
Changed Priority from `1' to `3' 
Changed Fix By Baseline from `1.0.2a' to `1.0.3'

[8/25/93 public]
Diane, I am not sure the defect is  pmax specific or the problem has been
fixed recently. Regardless, I have run the same scenario mentioned above and
could not reproduct it in our new code base, 103-3.28 on RIOS. 
I assigned it to you so you can dispose it appropriately. 
Thanks,
# dfsexport
dfsexport: /dev/epi0, lfs, 2, 0,,0
dfsexport: /dev/epi2, lfs, 3, 0,,0
dfsexport: /dev/epi10, lfs, 4, 0,,0
dfsexport: /dev/lv11, ufs, 1, 0,,1
dfsexport: /dev/lv03, ufs, 100, 0,,10
                                                                            
# dfsexport -detach /dev/epi10
dfsexport: Revoking tokens for filesets on aggregate 4...
# newaggr  /dev/epi10 -block 4096 -frag 512 -log 300
*** /dev/repi10 ALREADY CONTAINS AN EPISODE FILE SYSTEM
Episode fragment size (512) must be at least 1k (1024).
*** Using default initialempty value of 1.
*** Using default number of (4096-byte) blocks: 8191
*** Reserving 300 log blocks                          (maximum of 16 concurrent
transactions).
Problem with making /dev/repi10 an Episode aggregate.
#  newaggr  /dev/epi10  8192 1024 -overwrite
*** /dev/repi10 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 4095
*** Defaulting to 40 log blocks                       (maximum of 4 concurrent t
ransactions).
/dev/repi10: Already marked as non-BSD.
Done.  /dev/repi10 is now an Episode aggregate.
  
# dfsexport -all
dfsexport: /dev/lv11:/dfs (id 1):  Already attached: not attached
dfsexport: /dev/epi0:epi0 (id 2):  Already attached: not attached
dfsexport: /dev/epi2:epi2 (id 3):  Already attached: not attached
dfsexport: /dev/lv03:/jfs (id 100):  Already attached: not attached
Filled in Interest List CC with `jdp@transarc.com, tu@transarc.com' 
Changed Responsible Engr. from `jdp@transarc.com' to `delgado@osf.org' 
Changed Resp. Engr's Company from `tarc' to `osf' 
Filled in Transarc Herder with `jaffe@transarc.com'

[10/8/93 public]

Aged relative to Aug 1.

[10/15/93 public]

Dianne - I couldn't reproduce this either - Here's what I did:

1) Added ufs aggregate entry to dfstab w/o fsid (no fldbentry for it either)
root@dce13> cat dfstab
# blkdev aggname aggtype aggid (fsid-for-UFS)
/dev/dsk/c201d5s0       /u0     ufs     1       0,,1
/dev/dsk/c201d6s0       /       ufs     2

2) export
root@dce13> dfsexport -all
dfsexport: /dev/dsk/c201d5s0:/u0 (id 1):  Already attached: not attached
root@dce13> dfsexport
dfsexport: /dev/dsk/c201d5s0, ufs, 1, 0,,1
WARNING: The UFS aggregate /dev/dsk/c201d6s0 has 0 filesets
dfsexport: /dev/dsk/c201d6s0, ufs, 2, 0,,0

3) detach
root@dce13> dfsexport / -detach
WARNING: The UFS aggregate /dev/dsk/c201d6s0 has 0 filesets
dfsexport: Revoking tokens for filesets on aggregate 2...
root@dce13> dfsexport
dfsexport: /dev/dsk/c201d5s0, ufs, 1, 0,,1

4) export
root@dce13> dfsexport -all
dfsexport: /dev/dsk/c201d5s0:/u0 (id 1):  Already attached: not attached
root@dce13> dfsexport
dfsexport: /dev/dsk/c201d5s0, ufs, 1, 0,,1
WARNING: The UFS aggregate /dev/dsk/c201d6s0 has 0 filesets
dfsexport: /dev/dsk/c201d6s0, ufs, 2, 0,,0

On one attempt, while the server was in TSR mode, the detach failed with
a message about the server recovering tokens after a crash but the -force
option worked. If you have other ideas, let me know, otherwise we can
cancel.

[10/15/93 public]

Add me to the list of people who can't reproduce this bug.  I basically
followed gmd's steps using all LFS filesets.  The bug doesn't show up
there either.  Based on the number of people (4) who can't reproduce
it, the bug seems worthy of cancellation.



CR Number                     : 8120
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : copyright
Short Description             : Move COPYRIGHT.DCE
Reported Date                 : 6/9/93
Found in Baseline             : 1.0.2
Found Date                    : 6/9/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/9/93 public]
The current OSF copyright statements all include the statement:

   See the file named COPYRIGHT.DCE in the src directory for the
   full copyright text.

These are included in many files that end users will see (all include
files, for example).

We are not shipping DCE source code (as I suspect most/all vendors are
not).  But we are now forced to create a 'src' directory in our product
so we can include this file where it was promised.  Hopefully, we won't
be getting customers' expectations up when they find an /opt/dcelocal/src
directory...  ;-)

Can this sentence be rephrased to allow more flexibility in our 
placement of this file in the future?  (Or to provide a more logical
hard-coded location...)

[6/9/93 public]
I'll follow up on this.  Of course, this involves lawyers so it may 
take a bit ... ;-)

[9/24/93 public]
This is really more a managerial issue, so I punting it over to Ken
Rodrigues.
It really should  be resolved for 1.0.3.

Can this sentence be rephrased to allow more flexibility in our
placement of this file in the future?  (Or to provide a more logical
hard-coded location...)

[7/1/94 ]
reassigning to annie



CR Number                     : 8115
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : MBZ code from epif_GetStatus during fts dump
Reported Date                 : 6/8/93
Found in Baseline             : 1.0.2
Found Date                    : 6/8/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[6/8/93 public]
From the IBM defect:
prefix        p
name          6404
reference     
abstract      panic on fts dump
duplicate     
state         open                        priority                          
severity      2                           target                            
age           1
notes:
    <Note by abansal (Anju Bansal), 93/06/06 16:07:58, action: open>
The machine was hung in an fts dump command.  Continuing through the debugger
caused a panic.
    <Note by pehkonen (Jean E. Pehkonen), 93/06/06 16:09:39, action: note>
asserted at line 474 of vol_efsScan
   468      epid_MakeIndexOnly (&fid, handlerp->index);
   469      code = epif_Open (VTOVH (volp), &fid, &ap);
   470      if (code == EPI_E_NOENT)
   471          return VOL_ERR_DELETED;
   472      MBZ (code);
   473      code = epif_GetStatus (ap, &fstat);
   474      MBZ (code);
   475      code = epif_Close (ap);
   476      MBZ (code);
   477      switch (fstat.mode & S_IFMT) {
Stack is:
panic
vol_efsScan
afscall_volser
kafs_syscall
ftserver was the running process and it had the kernel_lock at the time
of the panic.
Register state:
GPR0  00000000 2FF97938 000E7278 0000000B 2FF97988 2FF98000 0000000B 000090B0 
GPR8  00000002 6F6C6174 65640076 6F000000 00062B30 10005EF4 20184478 0000F0B0 
GPR16 201852A4 00000000 00000C06 2FF98000 00000000 014E98C8 014DE314 015B7C18 
GPR24 00000000 00000007 02130455 FFFFFFFF 200C0B58 014E3A58 00062B98 00000000 
ap is:
> d 2ff97938+44 100
2FF9797C   014E3A58 05F3A300 0584D80C 2FF97A58   |.N:X......../.zX|
2FF9798C   28002024 05CAF100 00000000 00000000   |(. $............|
2FF9799C   05CB9EA0 00000000 00000000 00000000   |................|
2FF979AC   FFFFFFFF 00000000 00000000 2FF979F8   |............/.y.|
2FF979BC   00000000 00000000 00000001 FFFFFFFF   |................|
2FF979CC   05D67BAC 00000C06 2FF98000 2FF97A18   |..{...../.../.z.|
2FF979DC   014E98C8 014DE314 015B7C0D 00000000   |.N...M...[|.....|
2FF979EC   0000000A 00000000 20184FF8 2FF97A58   |........ .O./.zX|
2FF979FC   05F3A314 014B5968 00000000 2FF97A58   |.....KYh..../.zX|
2FF97A0C   014E9E44 000610BC 00000000 2FF97A58   |.N.D......../.zX|
2FF97A1C   00000000 014A9600 00000000 2FF97AD8   |.....J....../.z.|
2FF97A2C   014AECAC 0146F804 015B7C0D 00000000   |.J...F...[|.....|
2FF97A3C   0000000A 00000000 FFFFFFFF 200C0B58   |............ ..X|
2FF97A4C   02130455 05F3A300 00000000 2FF97F38   |...U......../..8|
2FF97A5C   22002028 014B5FDC 0000007F 2FF97AD8   |". (.K_...../.z.|
From reply by ota:
It would be really nice to have the value of "code" that actually caused
the panic.  I don't see anything in the registers that looks like a code
value.  Also what you show for "ap" can't be right because the address
is on the stack.  All anode hanldes are allocated and should have a
address like 0x05F3A300.
Assuming the the "ap" returned from epif_Open is really valid then it
seems that the main source of error codes in epif_GetStatus is in
opening ACL containers.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[6/8/93 public]
Changed Fix By Baseline from `1.0.2' to `1.0.2a' 
Filled in Reported by Company's Ref. Number with `IBM6404'

[6/13/93 public]
IBM saw this defect once, but was unable to reproduce it or to provide ted
with any further information.  We may yet hit it again, but its not fixby
102a.
Changed Fix By Baseline from `1.0.2a' to `1.0.3'

[6/13/93 public]
Our test group hit this again overnight. We will be providing more
information tomorrow.
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `' 
Added field #Transarc Status with value `'

[11/1/93 public]
The detail here is a light so it is hard to tell which delta fixed this
particular OT.  I suggested two, and Carl suggested a third.  In any
case, the problem no longer seems to be occurring.
I discussed this with Carl and Tu and they agree this should be canceled.
Changed Status from `open' to `cancel'



CR Number                     : 8114
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : TLB miss under ParSetWorker()
Reported Date                 : 6/8/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/8/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/8/93 public]
Gail took a TLB miss on her mostly idle PMAX.  The stack appeared
hosed, as well as the PC.  It appears from the registers that 
a call to FlushQueuedServerTokens() was made from ParSetWorker()
immediately before the crash.  However, the PC was set to an
invalid address outside of FlushQueuedServerTokens().  Without
a valid PC, progress is difficult.  I've perused the 
FlushQueuedServerTokens() code for suspicious long jumps without
luck.

I've set the priority low until we can prove we can make this
happen more than once.  If so, we'll have to look at alternative
means for debugging this (icl logging/printfs in 
FlushQueuedServerTokens() as a brute force approach, other suggestions
welcome).

[6/21/93 public]
Cancelling until we can reproduce.



CR Number                     : 8093
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : fts, ftserver
Short Description             : Incremental "-time"
dump/restore does not work over LFS
Reported Date                 : 6/4/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/4/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[6/4/93 public]
While trying out the admin_checklist system test, on a 2 pMax cell,
(/.../cell_of_death, nodes dce9 and prelude, single flserver on
dce9), dump and restore did the following:
 
root@dce9> cd /:
root@dce9> ls 
SWAPON                dce102_exp_dce_6250   prelude_lfs1
bradcj                dce102_exp_ode_6250   prelude_lfs2
dce102_dom_dce_6250   dce102_exp_proj_6250  prelude_ufs2
dce102_dom_proj_6250  dce9_lfs1
root@prelude  # cp -R /project/dce/build/dce1.0.2/src/test/directory/xds
/:/dce9_lfs1
root@prelude  # ls -l /:/dce9_lfs1
total 2
drwxrwxrwx   7 notes    daemon              800 Jun  3 14:39 xds
root@prelude  # ls -l dce9_lfs1/xds
total 1426
-r--r--r--   1 notes    daemon             1955 Jun  3 14:35 Makefile
-r--r--r--   1 notes    daemon            42407 Jun  3 14:34 dump.c
drwxrwxrwx   2 notes    daemon              704 Jun  3 14:35 examples
drwxrwxrwx   5 notes    daemon              384 Jun  3 14:40 tests.mhs
drwxrwxrwx   5 notes    daemon              384 Jun  3 14:35 tests.switch
drwxrwxrwx   7 notes    daemon              448 Jun  3 14:37 tests.xds
drwxrwxrwx   6 notes    daemon              416 Jun  3 14:39 tests.xom
drwxrwxrwx   6 notes    daemon              416 Jun  3 14:39 tests.xom
-r--r--r--   1 notes    daemon             9694 Jun  3 14:35 xt.h
-r--r--r--   1 notes    daemon            73203 Jun  3 14:35 xt_dsFuncs.c
-r--r--r--   1 notes    daemon             8387 Jun  3 14:35 xt_export.h
-r--r--r--   1 notes    daemon            32664 Jun  3 14:35 xt_file.c
-r--r--r--   1 notes    daemon            52669 Jun  3 14:35 xt_omFuncs.c
-r--r--r--   1 notes    daemon           294309 Jun  3 14:35 xt_parms.h
-r--r--r--   1 notes    daemon            90673 Jun  3 14:35 xt_rValue.c
-r--r--r--   1 notes    daemon            17755 Jun  3 14:35 xt_run.c
-r--r--r--   1 notes    daemon             1071 Jun  3 14:35 xt_test.c
-r--r--r--   1 notes    daemon            24816 Jun  3 14:35 xt_tree.c
 
# Do the full dump first . . .
 
root@dce9> fts dump -fileset dce9_lfs1 -time 0 -file /usr/users/treff/lfs1.dump
Dumped fileset dce9_lfs1 to file /usr/users/treff/lfs1.dump
root@dce9> fts delmount -dir /:/prelude_lfs2
root@dce9> fts restore -ftname prelude_lfs2 -server prelude -aggr prelude_lfs2 -file /usr/users/treff/lfs1.dump -overwrite
fts restore: The fileset prelude_lfs2 (0,,28) already exists in the FLDB.
fts restore: Overwriting the existing entry...
Restored fileset prelude_lfs2 on prelude prelude_lfs2 from /usr/users/treff/lfs1.dump
root@dce9> cd /:/dce9_lfs1/xds
root@dce9> ls  
total 1426
-r--r--r--   1 notes    daemon             1955 Jun  3 14:35 Makefile
-r--r--r--   1 notes    daemon            42407 Jun  3 14:34 dump.c
drwxrwxrwx   2 notes    daemon              704 Jun  3 14:35 examples
drwxrwxrwx   5 notes    daemon              384 Jun  3 14:40 tests.mhs
drwxrwxrwx   5 notes    daemon              384 Jun  3 14:35 tests.switch
drwxrwxrwx   7 notes    daemon              448 Jun  3 14:37 tests.xds
drwxrwxrwx   6 notes    daemon              416 Jun  3 14:39 tests.xom
drwxrwxrwx   6 notes    daemon              416 Jun  3 14:39 tests.xom
-r--r--r--   1 notes    daemon             9694 Jun  3 14:35 xt.h
-r--r--r--   1 notes    daemon            73203 Jun  3 14:35 xt_dsFuncs.c
-r--r--r--   1 notes    daemon             8387 Jun  3 14:35 xt_export.h
-r--r--r--   1 notes    daemon            32664 Jun  3 14:35 xt_file.c
-r--r--r--   1 notes    daemon            52669 Jun  3 14:35 xt_omFuncs.c
-r--r--r--   1 notes    daemon           294309 Jun  3 14:35 xt_parms.h
-r--r--r--   1 notes    daemon            90673 Jun  3 14:35 xt_rValue.c
-r--r--r--   1 notes    daemon            17755 Jun  3 14:35 xt_run.c
-r--r--r--   1 notes    daemon             1071 Jun  3 14:35 xt_test.c
-r--r--r--   1 notes    daemon            24816 Jun  3 14:35 xt_tree.c
root@dce9> cat >> woof
woof woof woof woof  
root@dce9> ls -l woof
root@dce9> cat >> woof
woof woof woof woof  
root@dce9> ls -l woof
-rw-r--r--   1 100      daemon               20 Jun  4 15:05 woof
root@dce9> date                              
Fri Jun  4 15:11:26 EDT 1993
root@dce9> fts dump -fileset dce9_lfs1 -time "06/04/93 15:10" -file /usr/users/treff/lfs1.dump
Dumped fileset dce9_lfs1 (incr from 4-Jun-1993 15:10) to file /usr/users/treff/lfs1.dump
root@dce9> fts restore -ftname prelude_lfs2 -server prelude -aggr prelude_lfs2 -file /usr/users/treff/lfs1.dump -overwrite
fts restore: The fileset prelude_lfs2 (0,,28) already exists in the FLDB.
fts restore: Overwriting the existing entry...
Restored fileset prelude_lfs2 on prelude prelude_lfs2 from /usr/users/treff/lfs1.dump
root@dce9> fts crmount -dir /:/prelude_lfs2 -fileset prelude_lfs2
root@dce9> cd /:/prelude_lfs2/xds
root@dce9> ls -l
root@dce9> ls: The file ./woof does not exist.
total 1426
-r--r--r--   1 100      daemon             1955 Jun  3 14:35 Makefile
-r--r--r--   1 100      daemon            42407 Jun  3 14:34 dump.c
drwxrwxrwx   2 100      daemon              704 Jun  3 14:35 examples
drwxrwxrwx   5 100      daemon              384 Jun  3 14:40 tests.mhs
drwxrwxrwx   5 100      daemon              384 Jun  3 14:35 tests.switch
drwxrwxrwx   7 100      daemon              448 Jun  3 14:37 tests.xds
drwxrwxrwx   6 100      daemon              416 Jun  3 14:39 tests.xom
-r--r--r--   1 100      daemon             9694 Jun  3 14:35 xt.h
-r--r--r--   1 100      daemon            73203 Jun  3 14:35 xt_dsFuncs.c
-r--r--r--   1 100      daemon             8387 Jun  3 14:35 xt_export.h
-r--r--r--   1 100      daemon            32664 Jun  3 14:35 xt_file.c
-r--r--r--   1 100      daemon            52669 Jun  3 14:35 xt_omFuncs.c
-r--r--r--   1 100      daemon           294309 Jun  3 14:35 xt_parms.h
-r--r--r--   1 100      daemon            90673 Jun  3 14:35 xt_rValue.c
-r--r--r--   1 100      daemon            17755 Jun  3 14:35 xt_run.c
-r--r--r--   1 100      daemon             1071 Jun  3 14:35 xt_test.c
-r--r--r--   1 100      daemon            24816 Jun  3 14:35 xt_tree.c
 
Oops.  Pertinent info:
 
prelude xds% fts lsaggr -server dce9
fts lsaggr -server prelude
There are 2 aggregates on the server dce9 (dce9.osf.org):
                  /u1 (/dev/rz1c): id=1     (non-LFS)
            dce9_lfs1 (/dev/rz3c): id=30    (LFS)
prelude xds% There are 3 aggregates on the server prelude (prelude.osf.org):
                  /u2 (/dev/rz1f): id=10    (non-LFS)
         prelude_lfs1 (/dev/rz1d): id=20    (LFS)
         prelude_lfs2 (/dev/rz1e): id=40    (LFS)
prelude xds% fts lsheader -server dce9 -long
Total filesets on server dce9 aggregate /u1 (id 1): 1
root.dfs 0,,1 RW non-LFS     states 0x10011085 On-line
    dce9.osf.org, aggregate /u1 (ID 1)
    Parent 0,,0       Clone 0,,2       Backup 0,,3
    llBack 0,,0       llFwd 0,,0       Version 0,,0      
     565704 K alloc limit;  299015 K alloc usage
     565704 K quota limit;  299015 K quota usage
    Creation Fri May  7 13:33:00 1993
Total filesets on-line 1; total off-line 0; total busy 0
 
Total filesets on server dce9 aggregate dce9_lfs1 (id 30): 1
dce9_lfs1 0,,40 RW LFS     states 0x10010005 On-line
    dce9.osf.org, aggregate dce9_lfs1 (ID 30)
    Parent 0,,0       Clone 0,,41      Backup 0,,42
    llBack 0,,0       llFwd 0,,0       Version 0,,3046   
    1048576 K alloc limit;    2114 K alloc usage
       5000 K quota limit;    2114 K quota usage
    Creation Wed Jun  2 00:11:40 1993
    Last Update Fri Jun  4 15:05:33 1993
Total filesets on-line 1; total off-line 0; total busy 0
Total number of filesets on server dce9: 2
 
prelude xds% fts lsheader -server prelude -long
Total filesets on server prelude aggregate /u2 (id 10): 1
prelude.ufs2 0,,4 RW non-LFS     states 0x10011085 On-line
    prelude.osf.org, aggregate /u2 (ID 10)
    Parent 0,,0       Clone 0,,5       Backup 0,,6
    llBack 0,,0       llFwd 0,,0       Version 0,,0      
     239553 K alloc limit;       1 K alloc usage
     239553 K quota limit;       1 K quota usage
    Creation Sun May 23 22:26:42 1993
Total filesets on-line 1; total off-line 0; total busy 0
 
Total filesets on server prelude aggregate prelude_lfs1 (id 20): 1
prelude_lfs1 0,,37 RW LFS     states 0x10010005 On-line
    prelude.osf.org, aggregate prelude_lfs1 (ID 20)
    Parent 0,,0       Clone 0,,38      Backup 0,,39
    llBack 0,,0       llFwd 0,,0       Version 0,,5671   
    1048576 K alloc limit;     137 K alloc usage
       5000 K quota limit;     137 K quota usage
    Creation Tue Jun  1 15:37:46 1993
    Last Update Tue Jun  1 17:23:30 1993
Total filesets on-line 1; total off-line 0; total busy 0
Total filesets on server prelude aggregate prelude_lfs2 (id 40): 1
 
prelude_lfs2 0,,28 RW LFS     states 0x10010005 On-line
    prelude.osf.org, aggregate prelude_lfs2 (ID 40)
    Parent 0,,0       Clone 0,,29      Backup 0,,30
    llBack 0,,0       llFwd 0,,0       Version 0,,3046   
    1048576 K alloc limit;    2114 K alloc usage
       5000 K quota limit;    2114 K quota usage
    Creation Mon May 24 23:48:48 1993
    Last Update Fri Jun  4 15:31:02 1993
Total filesets on-line 1; total off-line 0; total busy 0
Total number of filesets on server prelude: 3
 
Note that a dump -version using the exact same testcase data, filesets,
etc, worked.  Go figure.
 
I'll put the 2 original dump files, plus a dump of the, uhhhh,
incomplete target fileset,  down into the cell at 
/afs/dce/project/dce/transarc/OTxxxx, with xxxx being whatever OT
number this becomes.  Any other data I can dig up for you, let me know.

[6/04/93 public]
Since the cell won't let me do any writing into dce/project/dce/transarc,
the three dump files are in /afs/dce/project/dce/osf/OT8093.
This is an A0, since this rather simple dump/restore is, nonetheless,
part of system test . . .

[6/7/93 public]
Changed Responsible Engr. from `Elliot_Jaffe@transarc.com' to 
 `khale@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[6/7/93 public]
This test is mis-conceived and I'd recommend that this bug be cancelled.
The time given to the incremental dump should have been a time before the
initial complete dump was taken; that is, if the initial complete dump
were made at 15:00, then it won't make sense to create an incremental dump
(to be used with only that complete dump) based on a timestamp any later than
15:00.
 
In particular, the file ``woof'' was created after the complete dump was
made, at 15:05, and the incremental dump includes only those changes made
between 15:10 and the time of the dump (>= 15:11); this pair of dumps
(one complete and one incremental) was disjoint, and didn't span the whole
creation of the ``woof'' file.
 
The test is also flawed in that the first restoration (of the complete dump)
should have been made to create a new fileset, not overwrite an existing
fileset.  Alternatively, the prelude_lfs2 fileset should have been deleted
before the first restoration.  Ideally, you'd also inform the cache manager
that you were about to re-use a fileset name (prelude_lfs2) so that it should
discard any old information from prior incarnations of that fileset.
Filled in Interest List CC with `cfe@transarc.com'



CR Number                     : 8086
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : episode holds vol lock too long
Reported Date                 : 6/2/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/2/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[6/2/93 public]
Episode can deadlock doing a vol detach.  Here's the stack trace of interest:
(from Jean P. at IBM)
I was running connectathons from 2 different clients in the cell when I 
attempted to do a dfsexport -detach on the aggregate which contains root.dfs 
(The connectathons were running against directories in root.dfs, also).  One 
of the clients was on test4; the other on test5 when I attempted the dfsexport.
dfsexport hung with the following stack:
vms_delete			;waits for vnode I/O done
vnvm_recycle
vnm_Inuse			;iterates over lots of vnodes
vol_efsDetach			;holds volume lock
vol_Detach
ag_UnRegisterVolume
afscall_aggr
kafs_syscall
The stacks for the Episode daemon processes were:
e_wait
e_sleep
osi_aix_Sleep
Lock_Obtain
vol_efsHold		; locks volume lock to bump ref count
volreg_Lookup
efs_getvolume
efs_BioDaemon		; finishes I/O 
efs_vmm_proc
procentry
e_wait
e_sleep
e_sleepl
sleepxTc
get_bioreq
efs_BioDaemon
efs_vmm_proc
procentry
e_wait
e_sleep
osi_aix_Sleep
osi_SleepWI
epia_Async
efs_vmm_proc
procentry
The proper fix is to modify vol_efsDetach to release the volp->lock
over the vnm_InUse call, and perhaps over the epig_CloseVolume call.
Perhaps some revalidation would also need to be done when re-obtaining
the lock to verify that nothing too serious happened to the volume
structure, but I'm not sure what the rules are here when detaching a volume.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[6/3/93 public]
Please reset your default to 1.0.3 mike.
Changed Found in Baseline from `1.0.2' to `1.0.2a' 
Changed Fix By Baseline from `1.0.2' to `1.0.3'

[6/4/93 public]
Changed Subcomponent Name from `episode' to `lfs'

[7/6/93 public]
Defect Closure Form
-------------------
--Regression test program below--
--Verification procedure below--
--Other explanation below--
Associated information:
Tested on TA build:  
Tested with backing build:  
Changed Responsible Engr. from `kazar@transarc.com' to `prem@transarc.com'
Changed Responsible Engr. from `prem@transarc.com' to `jdp@transarc.com'

[9/24/93 public]
I am cancelling this defect for the following reasons:
                                                                               
1) Kazar's "ot export" operation did not leave any info about the associated 
  delta and I could not find any deltas that is named after this ot number
  in all the recent 103 builds.                                                
2) The problem (holding a lock to long) mentioned above did not hold true
   any more. The vol_efsDetach DOES  release the volp->lock before a call
   to vnm_InUse. This fix is in all the available source trees.
   I suspect someone may have fixed it in another delta by accident.
Changed Status from `open' to `cancel'



CR Number                     : 8081
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Administrative tasks in
active namespace creates problems
Reported Date                 : 6/1/93
Found in Baseline             : 1.0.2
Found Date                    : 6/1/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.2
Fixed In Baseline             : 
Affected File(s)              : 
Diff supplied by              : 
Diff release                  : 
Sensitivity                   : public

[6/1/93 public]
Our testing lab has an administration test whereby they create 
clearinghouses, add several directories, delete the directories, and
then delete the clearinghouses.  They do this when several other tests
are running, and we have frequently seen database corruption problems.
We have not detailed the problems here, because the problems vary.  

We have told the lab to have the namespace in a quiet state when they
are addind or deleting clearinghouses.  However, the question remains:
Should we be able to do administrative tasks while other application
programs are running using the CDS namespace?  If the answer is 'yes',
and the problems we are seeing should not be happening, then we can
capture more information to add to this defect.  If the answer is
'no,' then the documentation should be modified to state that the cell
should be in a quiesced state before administrative tasts are done.

Test recognizes that the documentation states that a single
Clearinghouse per server is the recommended set-up, but should this be
documented as a stronger restriction?

[8/24/94 public]
You should be able to do administrative tasks as you describe with the
server active.  The only time you need to worry is for a backup.  The
server should be shut down for that.

There was a bug in the database discovered in 1.0.3 (db_btree.c)
See if you can re-create with 1.1

[08/20/96 public]
I'm cancelling this OT since there are no specific problems to fix.
Plus, fixes to OTs 12879, 13208, and 12932 will help in this space.



CR Number                     : 8078
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : dg
Short Description             : flserver dumps core with fixed unaligned read access
Reported Date                 : 6/1/93
Found in Baseline             : 1.0.2a
Found Date                    : 6/1/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[6/1/93 public]
This happened during cho.  This is a 3 flserver cell. The flserver
on the pmax dumped core :
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.5, Copyright 1992 Free Software Foundation, Inc.
OSF version 1.0 created Thu Dec  3 12:48:59 1992
..(no debugging symbols found)...
Core was generated by `flserver'.
Program terminated with signal 6, IOT/Abort trap.
#0  0x73055b48 in ubik_dbVersion ()
(gdb) b main
Breakpoint 1 at 0x40fd10
(gdb) run
Starting program: /opt/dcelocal/bin/flserver 
(no debugging symbols found)...(no debugging symbols found)...
Breakpoint 1, 0x40fd10 in main ()
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0x73055b48 in kill ()
(gdb) bt
#0  0x73055b48 in kill ()
#1  0x73008610 in raise ()
#2  0x7300d030 in abort ()
We had rpc tracing turned on at the time on this flserver, and this
is what it was doing at the time of the core dump:
(recv_state_timer) Ping timeout [002943a2-cae3-1515-ba9f-08002b14b387, 10.0]
(rpc__dg_call_signal_failure) CCALL st = 0x16c9a016 (orig st = 0x0) [002943a2-cae3-1515-ba9f-08002b14b387, 10.0]
(rpc__dg_call_end) Sending orphan quit
rpc__dg_ccall_timer) Orphan timeout
(rpc__dg_call_signal_failure) CCALL st = 0x16c9a016 (orig st = 0x16c9a016) [002943a2-cae3-1515-ba9f-08002b14b387, 10.0]
(rpc__dg_do_quit) Orphaning call [00295824-6a28-1818-9f6c-08002b14b387, 3.0]
(rpc__dg_scall_orphan) Orphaning scall [00295824-6a28-1818-9f6c-08002b14b387, 3.0]
(rpc__dg_call_signal_failure) SCALL st = 0x16c9a05e (orig st = 0x0) [00295824-6a28-1818-9f6c-08002b14b387, 3.0]
(rpc__krb_get_tkt) refresh failed (status 16c9a0e7)
(rpc__krb_dg_pre_call) rpc__krb_get_tkt failed: st 16c9a0e7
(rpc__dg_call_signal_failure) CCALL st = 0x16c9a0e7 (orig st = 0x0) [0012b22c-6aaa-1818-ba9f-08002b14b387, 0.0]
(rpc__dg_call_end) Sending orphan quit
rpc__dg_ccall_timer) Orphan timeout
(rpc__dg_call_signal_failure) CCALL st = 0x16c9a016 (orig st = 0x16c9a0e7) [0012b22c-6aaa-1818-ba9f-08002b14b387, 0.0]
Fixed unaligned read access. PID 447 (flserver) at pc 0x734cb9ac, addr 0x23
AbortDumpHandler called

[6/1/93 public]
Filled in Interest List CC with `cfe@transarc.com' 
Changed Responsible Engr. from `pakhtar@transarc.com' to `khale@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[06/02/93]

Dave is going to have a look at this.

[06/17/93 public]

Don't see it very often - lowering priority.

[06/22/93 public]

It's still with us.  Here's the stack trace from the core file:

GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.5, Copyright 1992 Free Software Foundation, Inc.

OSF version 1.0 created Thu Dec  3 12:48:59 1992

..(no debugging symbols found)...
Core was generated by `flserver'.
Program terminated with signal 6, IOT/Abort trap.
#0  0x73055b48 in ubik_dbVersion ()
(gdb) b main
Breakpoint 1 at 0x40fd10
(gdb) run
Starting program: /opt/dcelocal/bin/flserver 
(no debugging symbols found)...(no debugging symbols found)...
Breakpoint 1, 0x40fd10 in main ()
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0x73055b48 in kill ()
(gdb) bt
#0  0x73055b48 in kill ()
#1  0x73008610 in raise ()
#2  0x7300d030 in abort ()
#3  0x40e12c in AbortDumpHandler ()
Cannot access memory at address 0x101be32c.
(gdb)

[6/23/93 public]

From the evidence above, I wouldn't assume that this is an RPC bug.  There are several
RPCs which fail (and appear to be handled correctly by the runtime), and there's some
kind of trap occuring.  The two may or may not be related.

Anyway, the flserver is setting up a handler (AbortDumpHandler) for SIGBUS, SIGSEGV, 
and SIGILL.  If you can reproduce the problem without using this handler, you'll be
able to tell where the fault is happening.

[7/15/93 public]
Moving out to 1.0.3 since problem is not currently blocking and we
can't make progress with the current problem staging/debugging
environment.

[9/4/93 public]

Anymore info on this? As Mark stated, the above evidence doesn't tell
whether this is an RPC bug or not. Also, the use of RPC_DEBUG, as stated in
the first report, was dangerous without the OT8255 fix. I'm lowering the
priority.

[8/22/94 public]
Since we are reaching the end of 1.1, we need to know if this really
is an RPC defect.  Has this been seen by any DFS folks in the past
6 months?  If not, I am considering canceling this defect.

[8/25/94 public]
We haven't seen this (the original failure was on the PMAX!) recently.
No usefull information will be lost, so I am canceling this defect.



CR Number                     : 8075
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : fts
Short Description             : fts restore insists on getting tokens even on damaged filesets
Reported Date                 : 5/28/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/28/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[5/28/93 public]
Currently, ``fts restore'' insists on getting tokens for filesets that are
about to be restored onto, even if the command is restoring a complete dump
and is thus about to make the fileset consistent.  The problem is that if
a restoration is interrupted, the target is left inconsistent and you can't
get tokens on such a fileset.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[6/1/93 public]
Craig, if this needs to be in 1.0.2a, then please update the Fix by field.
Changed Found in Baseline from `1.0.2' to `1.0.2a' 
Changed Fix By Baseline from `1.0.2' to `1.0.3'

[8/5/93 public]
I can no longer reproduce this in the current code base.
I suspect that it was repaired, or worked around, in the fixes for 6180.
I was able to create an inconsistent fileset with an interrupted restore
and was then able to do a complete restoration without problems.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 8065
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : security registry
Short Description             : secd died with fatal error
Reported Date                 : 5/27/93
Found in Baseline             : 1.0.2
Found Date                    : 5/27/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[5/27/93 public]
I found the following displayed in a window from which I had started secd.
# Registry: Fatal Error - Error while saving database.
 at line 1047 of file ../../../../../src/security/server/rsdb/balanced_trees.c
Registry: Fatal Error - Checkpoint task aborting
 at line 365 of file ../../../../../src/security/server/rs/rs_rsdb.c
Registry: Fatal Error - DT exiting with alert exception
 at line 487 of file ../../../../../src/security/server/rs/rs_main.c - 0x00000000 - successful completion
Registry: Fatal error in main thread; exiting
This was from DCE build, dce1.0.2a-0427
Some history is in order.  The reason I started secd in this window was
that it mysteriously died.  I could not find any data as to why it died, so
I restarted it and everything seemed fine.  I believe this second secd 
ran for about 12 hours.  It died sometime around 5:00am this morning, since
I have an error message from an fts command (run via cron) that indicates
the registry server was not available at this time.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[5/27/93 public]
You will get that error if a write() failed for some reason while writing
the database out to disk.  The most likely cause of this is the /opt
partition filling up.  Please check to see if this is the case.

[5/27/93 public]
Thanks for the quick response.
I believe that is the correct assessment of the situation.  I in fact had
changed the dfs cache to be it's own separate file system rather than be
part of /opt.  However, it would be nice if this was recorded in a 
standard place that administrators could easily find.  Also, I assume the
errno on the write would be ENOSPC.  So printing the perror of this would
clarify the situation.
Changed Status from `open' to `cancel'

[5/27/93 public]
This kind of error message will be fixed in 1.1 after serviceability work is done.



CR Number                     : 8061
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : dfsd can't free cacheblocks
Reported Date                 : 5/26/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/26/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/26/93 public]
This ot is to track a problem we have been seeing since the
advent of dfs.carl.   I currently have in the cho cell a 
client only pmax which has been getting for over 24 hours
continuous messages about "dfs: can't free cacheblocks".
There is a process which is stuck with the following stack trace:
cm_rdwr
cm_GetDLock
cm_GetDOnLine
cm_ReserveBlocks
osi_Wait
also here are the values for some cm variables:
cm_blocksUsed = 9984
cm_CacheBlocks = 10000
cm_cacheFiles = 1250
Note that cm_blocksUsed and cm_cacheFiles values have remained
the same for about the last 18 hours.  I can see where cm_blocsUsed
gets incremented, but where does this value get decremented?
I also set a break point in AFS_StoreData to see if we
were even writing back anything and we never seem to hit
this break point (maybe were not supposed to - I'm still
reading the code to try to figure out what we should be
doing under normal circumstances).  
Here's a partial dfstrace log 
time 597.520760, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 597.520760, pid 874: in cm_GetDownD, need space 1 
time 597.567632, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 597.567632, pid 2412: in cm_GetDownD, need space 1 
time 598.524666, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 598.524666, pid 874: in cm_GetDownD, need space 1 
time 598.579350, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 598.579350, pid 2412: in cm_GetDownD, need space 1 
time 599.528572, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 599.528572, pid 874: in cm_GetDownD, need space 1 
time 599.591068, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 599.591068, pid 2412: in cm_GetDownD, need space 1 
time 600.532478, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 600.532478, pid 874: in cm_GetDownD, need space 1 
time 600.598880, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 600.598880, pid 2412: in cm_GetDownD, need space 1 
time 601.141814, pid 0: running write through dslots 
time 601.145720, pid 0: servertokenmgt running 5 subops 
time 601.145720, pid 0: running major renewlazyreps 
time 601.145720, pid 0: Renewlazyreps starts 0 subjobs 
time 601.149626, pid 0: in cm_FlushQueuedServerTokens for server c2772300 
time 601.149626, pid 0: in cm_FlushQueuedServerTokens for server c28e6700 
time 601.149626, pid 0: in cm_FlushQueuedServerTokens for server c2776200 
time 601.149626, pid 0: in cm_FlushQueuedServerTokens for server c2776700 
time 601.149626, pid 0: in cm_FlushQueuedServerTokens for server c28e6800 
time 601.540290, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 601.540290, pid 874: in cm_GetDownD, need space 1 
time 601.606692, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 601.606692, pid 2412: in cm_GetDownD, need space 1 
time 602.544196, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 602.544196, pid 874: in cm_GetDownD, need space 1 
time 602.614504, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 602.614504, pid 2412: in cm_GetDownD, need space 1 
time 603.552008, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 603.552008, pid 874: in cm_GetDownD, need space 1 
time 603.622316, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 603.622316, pid 2412: in cm_GetDownD, need space 1 
time 604.555914, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 604.555914, pid 874: in cm_GetDownD, need space 1 
time 604.630128, pid 2412: reserveblocks emergency, scp c390af80, truncating dcp c28cf3a0! 
time 604.630128, pid 2412: in cm_GetDownD, need space 1 
time 605.153532, pid 0: flushactivescaches starting 3 concurrent storebacks 
time 605.157438, pid 0: running FlushActiveSCaches 
time 605.157438, pid 0: running FlushActiveSCaches 
time 605.157438, pid 0: running FlushActiveSCaches 
time 605.559820, pid 874: reserveblocks emergency, scp c3910e00, truncating dcp c28d1a24! 
time 605.559820, pid 874: in cm_GetDownD, need space 1 
Elliott, I put you on the cc list; maybe you can give us some pointers
about where to look next.  In the meantime we'll try to collect more
data.

[05/26/93 public]
More data.
freeDCCount = 1091
cm_indexTable => first 500 entries are all zero
The dfstrace log still looks the same.  It says it's truncating cache
files but we don't see any further log info which verifies that
that is actually happening (like cm_FlushDCache).

[05/26/93 public]
Even more stuff:
The cm_indexFlags array looks like:
first 714 entries = 2 => index entry in freeDCList
after this there are some 4's and 3 41's
It looks like in cm_GetDownD we are not finding anything which
is flushable (we never make the call to cm_FlushDCache).

[5/27/93 public]
Changed Interest List CC from `jaffe@transarc.com' to `jaffe@transarc.com, 
 tu@transarc.com, kazar@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[5/28/93 public]
The problem seems to be very odd. The cm did not write any data back to 
the server, (if I read your report correctly), and therefore it could not
free any dcache blocks. I will read it first and phone you later this 
afternoon.

[5/28/93 public]
Re-assigned to tu who's been investigating this.
[06/18/83 public]
We've only seen this in conjuction with 8052 (no quorum).  Now that
the quorum problems have been fixed this problem is no longer blocking
us - move to 103

[9/14/93 public]
Diane, 
As mentioned above, this anamoly was only seen when flservers could not reach
quorum. If this is not reproduciable (it seems to be the case) after ot 8052 
was fixed, would you want to cancel this one. 
Thanks, 
Tu

[11/4/93 public]
Diane, 
This bug report has been very old and I assume that you have not seen this
happen again. If this is the case, do you think I (or you ) can cancel it. 
Thank you. 
Changed Interest List CC from `jaffe@transarc.com, tu@transarc.com, 
 kazar@transarc.com' to `jaffe@transarc.com, tu@transarc.com, 
 kazar@transarc.com, comer@transarc.com'

[12/10/93 public]
Assign to the OSF so that they can test and/or cancel it.
Changed Responsible Engr. from `tu@transarc.com' to `delgado' 
Changed Resp. Engr's Company from `tarc' to `osf'

[1/11/94 public]
This is cancelled.  I shot the flserver while copying a large
amount of data into DFS.  I successfully copied about 120MB of 
data before stopping because I was about to run out of space.  
When I returned ~2 hours later, I was unable to access DFS 
because the cm went to the flserver to refresh it's fileset 
name to location mapping, and there was no flserver (expected
behavior).



CR Number                     : 8060
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : thr
Subcomponent Name             : 
Short Description             : pthread_cond_timedwait
returns wrong errno when timer expires.
Reported Date                 : 5/25/93
Found in Baseline             : 1.0.2
Found Date                    : 5/25/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/25/93 public]
pthread_cond_timed_wait returns EWOULDBLOCK when the timer expires rather
that EAGAIN as documented.

[8/17/93 public]
corrected short description; correct function name is 
pthread_cond_timedwait.

After searching all the files in src/threads and comparing all revisions
of cma_pthread.c (where pthread_cond_timedwait lives), I could not find 
the string EWOULDBLOCK. The pertinent code section is:


    TRY {

        if (cma_cond_timed_wait (cond, mutex, &time) == cma_s_timed_out) {
            cma__set_errno (EAGAIN);
            status = -1;
            }

        }
    CATCH (cma_e_alerted) {
        /*
         * This exception is used to implement pthread_cancel; as such, the
         * exception must be allowed to propagate out of the wait call so
         * that the cleanup handlers can catch it, and eventually the thread
         * will terminate.
         */
        RERAISE;
        }
    CATCH_ALL {
        cma__set_errno (EINVAL);
        status = -1;
        }
    ENDTRY

    return status;
    }

... and ...

lobster 537 %  bdiff -r1.1.4.6 -r1.1 cma_pthread.c | grep EWOULD

 [ ./threads/cma_pthread.c ]
===================================================================
RCS file: ./threads/cma_pthread.c,v
retrieving revision 1.1.4.6
retrieving revision 1.1
diff -r1.1.4.6 -r1.1
lobster 538 %



CR Number                     : 8049
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : krpc
Short Description             : DG call timer should probably not time out calls in "init" state..
Reported Date                 : 5/24/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/24/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/24/93 public]
Transarc has seen some spurious comm failures when the system was under
heavy load, and these, among others, are blocking their CHO runs (exit
criteria for 1.0.2a).  I can't find an open defect report relating to this,
but I've seen mail go by on the issue in the past month, so I'm opening
this one.
When an authenticated DG call is just starting, it calls the authentication
"pre_call" operation as the last thing in rpc__dg_call_start().  At this
point, it appears that the call timer is running; if the pre_call operation
takes more than 30 seconds (and it may if the system is under very heavy
load), the call timer will blow out the call before it gets a chance to
actually transmit anything.
One possible fix may be to comment out the code in the switch in
rpc__dg_ccall_timer() which calls ccall_cancel_timer() and
ccall_timeout_timer() if the call is in the "init" state.  [The theory here
is that there isn't anything for the client to be hung up waiting for in
*this* call until after it transmits something.]

[5/25/93 public]
It's not possible to see a comm failure while in the init state.
The reason we call the two timer routines while the call is in the init
state is that it *is* possible for a call to get hung up before it has 
transmitted anything.  The runtime guarantees that calls made over a single
binding handle will be serviced by a single server.  In the event that 
concurrent calls are made over a single partially bound handle, only the first
proceeds, all others are blocked until the handle becomes fully bound.
The ccall_timeout_timer() routine is used to detect *call* timeouts (set up
through rpc_mgmt_set_call_timeout), not *comm* timeouts.  That is, it guarantees
that the total amount of time taken to run a call does not exceed a pre-determined
value.

[6/1/93 public]
Cancelled as per Mark K.

[6/2/93 public]
While the specific code in question may be correct, there is still a significant
problem being seen in dfs with respect to communication failures.  See 
OT 7932 and 7785 for more descriptions.  Can someone involved with RPC look
at these problems and give us a clue on what to do next?
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'



CR Number                     : 8048
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 8055
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : rep
Short Description             : Rep functional tests fail
Reported Date                 : 5/24/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/24/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/24/93 public]
I ran the rep tests over the weekend between a PMAX and a RIOS
and encountered a spin in rep test 1.
 
The spin occurs while reading a directory in a RO fileset.  I
eventually ran out of tokens on the PMAX housing the RO fileset.
I believe this may be a secondary effect (cascading errors) which
was already reported by Carl Burnett.
 
Also, the repserver was unable to start at 4AM and 9AM
on Sunday because it couldn't determine the DFS junction for
the local cell name: Timeout occurred, operation not performed (dce/cds)
Registry server unavailable.  I believe this may have been caused
by the fact that I have many megabytes worth of the following messages in
my messages file which filled up /usr:
 
May 21 21:19:05 shotz vmunix: 738033545: tkm_TokenFreeList_ObtainToken: out of \
free tokens, about to force garbage collection
 
So, I have lots of secondary symptoms, but little about the root
of the problem.  I did notice the following message sequence in
the Ftserver log file on the pmax (I started the rep tests at
about this time):
 
93-May-21 18:06:33 SFTSERVER_ListVolumes: can't open 0,,8: 691089536
93-May-21 18:06:33 Restoring fileset 0,,8/11
93-May-21 18:06:36 vols_Restore: returning 0
93-May-21 18:06:36 Restored fileset 0,,8/11: returned code 0
93-May-21 18:07:28 Restoring fileset 0,,10/11
93-May-21 18:07:29 vols_Restore: returning 0
93-May-21 18:07:29 Restored fileset 0,,10/11: returned code 0
93-May-21 18:12:35 Restoring fileset 0,,12/11
93-May-21 18:12:37 vols_Restore: returning 0
93-May-21 18:12:37 Restored fileset 0,,12/11: returned code 0
93-May-21 18:19:25 Restoring fileset 0,,10/11
93-May-21 18:19:26 vols_Restore: returning 0
93-May-21 18:19:26 Restored fileset 0,,10/11: returned code 0
93-May-21 18:20:13 Restoring fileset 0,,12/11
93-May-21 18:20:16 vols_Restore: returning 0
93-May-21 18:20:16 Restored fileset 0,,12/11: returned code 0
93-May-21 18:22:21 Restoring fileset 0,,10/11
93-May-21 18:22:23 vols_Restore: returning 0
93-May-21 18:22:23 Restored fileset 0,,10/11: returned code 0
I've seen the above error message in the past as a result of 
fts release.  The message translates to "repserver forward fileset".
 
I know this isn't alot of information to go on, but I've tried
the rep functional tests ~8 times on various builds over the
past few months and have not been able to get a clean run yet (with 
no errors).  This fact needs to be addressed.
 
The fldb looks like:
 
# fts lsfldb
 
Lemieux.23686
        readWrite   ID 0,,11  valid
        readOnly    ID 0,,12  valid
        backup      ID 0,,13  invalid
number of sites: 2
  Sched repl: maxAge=0:03:00; failAge=0:05:00; reclaimWait=1:30:00; minRepDelay0
   server           flags     aggr   siteAge principal      owner
barge.osf.org       RW,RO    lfs_aggr 0:02:00 hosts/barge    <nil>
shotz.osf.org       RO       lfs_aggr 0:02:00 hosts/shotz    <nil>
 
lfs_set
        readWrite   ID 0,,4  valid
        readOnly    ID 0,,5  invalid
        backup      ID 0,,6  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner
shotz.osf.org       RW       lfs_aggr 0:00:00 hosts/shotz    <nil>
 
root.dfs
        readWrite   ID 0,,1  valid
        readOnly    ID 0,,2  invalid
        backup      ID 0,,3  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner
barge.osf.org       RW       lfs_aggr 0:00:00 hosts/barge    <nil>
----------------------
Total FLDB entries that were successfully enumerated: 3 (0 failed)
 
After clearing space and restarting the repserver, lsreplicas reveals:
 
# fts lsrep -fileset 0,,11 -all
On barge.osf.org:
Lemieux.23686, cell 134240781,,1166164071: src 0,,11 (lfs_aggr) (on barge.osf.org) => barge.osf.org 0,,12 (lfs_aggr)
   flags 0x20001, volstates 0x10423206.  NumKAs 0; lastKA sweep=Wed Dec 31 19:00:00 1969
   srcVV: 0,,214; curVV: 0,,214; WVT ID = 738018798,,927
   Lost token 7895074 ago; token expires 10544 hence; new version published 738263113 ago
   vvCurr 730368039.310929 (7895074 ago); vvPingCurr 738259257.038818 (3856 ago)
   Last update attempt 0.000000 (738263113 ago); next scheduled attempt 0.000000 (-738263113 hence)
   Status msg: GetToken returned 0x404 token, ID 738018798,,927.
 
On shotz.osf.org:
Lemieux.23686, cell 134240781,,1166164071: src 0,,11 (lfs_aggr) (on barge.osf.org) => shotz.osf.org 0,,12 (lfs_aggr)
   flags 0x20001, volstates 0x10423206.  NumKAs 0; lastKA sweep=Wed Dec 31 19:00:00 1969
   srcVV: 0,,214; curVV: 0,,214; WVT ID = 738018798,,932
   Lost token 7776144 ago; token expires 14264 hence; new version published 738263523 ago
   vvCurr 730487379.716331 (7776144 ago); vvPingCurr 738263387.107030 (136 ago)
   Last update attempt 0.000000 (738263523 ago); next scheduled attempt 0.000000 (-738263523 hence)
   Status msg: GetToken returned 0x404 token, ID 738018798,,932.

[5/24/93 public]
I'm sorry, but this isn't just ``little'' information about a primary problem,
it's no information.  The only thing that could be construed as a primary
problem is the token leak problem that Carl found and for which he's built
a fix.  The message in the FtLog is completely normal, and simply says that
one process is trying to do an ``fts lsheader'' while the repserver has
a fileset in use.  The rep functional tests by themselves could cause this.
 
I expect that your diagnosis of the filled /usr partition is correct for the
repserver restart problems.  Otherwise, I'm not sure what you want the
repserver to do about it.
 
What constitutes a ``run'' of the rep functional tests?  I would think that
it would be a single execution of rtest1, rtest2, and rtest3 (or just the
first two if you have only one server in your cell).  Is this what you meant
when you say you ran them ``over the weekend''?  Or were you running them
in a loop somewhere?  (Running them in a loop will guarantee that you'll
exercise the token manager's R/O token leak, and eventually run it out of
tokens.)  Which problem have you run into 8 times in various builds--not
being able to run them through once (which takes maybe half an hour), or
not being able to leave them running in a loop all weekend?
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[5/24/93 public]
Given the lack of useful diagnostic information, is it really appropriate to
leave this as an A0?
 
Changed Interest List CC from `cfe@transarc.com' to `pakhtar@transarc.com' 
Changed Responsible Engr. from `pakhtar@transarc.com' to `cfe@transarc.com'

[5/24/93 public]
I've reproduced the problem.  I'll put the dfstrace dump and the 
test output in ~notuser/rep_spin.

[5/25/93 public]
The second time this problem showed, the spin eventually corrected 
itself, but it took ~6 hours to run rtest1 and I ran out of tokens
again.

[5/25/93 public]
I looked at the rep_spin data and the code in question, and when I went to
coordinate an approach with Mike Kazar, he was already working on a solution
that would accomplish everything I was planning and more.  He's doing that
work under OT 8055.
 
As usual, I'd have preferred to dup this OT report to 8055, but the numbers
are in the wrong order, so I can't.  Cancelling this and filling in its
related-OT number with 8055, and upping the priority of 8055.
Filled in Inter-dependent CRs with `8055' 
Filled in Priority with `1' 
Changed Status from `open' to `cancel'



CR Number                     : 8047
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : 
Short Description             : Stail UUID prevents write
permission to dts-entity when initializing time service.
Reported Date                 : 5/24/93
Found in Baseline             : 1.0.2
Found Date                    : 5/24/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/24/93 public]
Intermittently we receive the message "must have write
permission to the DTS entity (dce / dts)"  when
executing "dtscp create type clerk".  This is shown below
when using mkdce to configure dts.  On AIX mkdce executes
rc.dce and rc.dce executes rc.dts.  rc.dts executes
"dtscp create type clerk" but fails with the error unable
to write to dts entity.  The only way we have been able
to reproduce this problem is to unconfigure Initial cds server,
cds clerk and dts.  We keep security master server, security client,
and rpc endpoint mapper configured.  We then execute the
mkdce -n os2dce17.austin.ibm.com -s os2dce17.austin.ibm.com 
cds_srv sec_srv all_cl to reconfigure cds and dts.  After doing 
this 3 or 4 times this results in the error message. 
We have seen this problem less frequently
when doing a normal unconfiguration and reconfig.

mkdce provides the following output--

Enter password for DCE account cell_admin:

Configuring RPC Endpoint Mapper (rpc)...
RPC Endpoint Mapper (rpc) configured successfully

Configuring Security Client (sec_cl)...
Password must be changed!
Security Client (sec_cl) configured successfully

Configuring CDS Clerk (cds_cl)...
CDS Clerk (cds_cl) configured successfully

Configuring DTS Clerk (dts_cl)...
error executing command:
        must have write permission to the DTS entity (dce / dts)
Cannot create DTS clerk
Current state of DCE configuration:
cds_cl       COMPLETE   CDS Clerk
dts_cl       PARTIAL    DTS Clerk
rpc          COMPLETE   RPC Endpoint Mapper
sec_cl       COMPLETE   Security Client

After this failure dts-entity does not exist in acl_edit.
acl_edit -e /.:/hosts/os2dce17.austin.ibm.com/dts-entity

Regardless of the permissions that we place on
/.:/hosts/os2dce17.austin.ibm.com/self or
/.:/hosts/os2dce17.austin.ibm.com we cannot successfully
create the time service using dtscp create type clerk.

Why does the dts-entity not exist? It does not appear to be
an obvious acl problem.

Tracing through the code we found the following information:
mgt_acl_init() reads an acl in permanent storage (mgt_acl file)
or creates a default acl and writes it to
/opt/dcelocal/var/adm/time/mgt_acl.

When the "cdscp create type clerk" is issued the CreateCmd()
routine is called in mgtrpc.c. This routine calls
mgt_test_write_access() to test that we have write access to
the dts interface. "dts_s_mgt_no_write" is returned
if failure occurs.  mgt_test_write_access() calls
dpe_acl_client_is_authorized() passing the mgt_acl and
client_handle.  When a management rpc call is made, the
management server routines check the caller's access
against this acl by calling dpe_acl_client_is_authorized().

The dpe_acl_client_is_authorized() gets the client PAC and
passess the client PAC and management acl to
dpe_acl_mgr_is_authorized().  This routine uses the RPC
binding handle to obtain the client's authentication
info (PAC).  It then checks the acl provided to see
if the requested access is granted for the client.

dpe_acl_mgr_is_authorized() routine expects to have
write_access but only read_access is returned.

The dpe_acl_mgr_get_access() routine does the masking operation
to get a mask containing a 1 for each permission granted by
the first ACL Entry catagory of the ACL which the PAC matches,
and 0s elswhere.  In normal case an ACL entry type of user is
given, it enters the non-NULL PAC sequence, the in_default_realm
variable is set to true (real.uuid and default_realm.uuid are equal),
the first case is entered sec_acl_e_type_user and user_entry is
set to one.  Since the user_entry is set, the USER check code is
executed and an appropriate mask is returned.  Write permission
is granted.

In the failing case we find that sec_acl_e_type_any_other is
received and the user_entry is never set.  The realm.uuid and
the default_realm.uuid are not equal.  The any_other_entry is
set and the ANY_OTHER check is made.  This check returns a mask
corresponding to the perm in the "any_other_entry".  The perm
read permissions only.   We found that the mgt_acl corresponded
to a default_acl created by the mgt_acl_init() and
create_default_acl() routines.  This default acl contains
read permission for ANY_OTHER and the trace of the entry
gave 4 as the number of entries(acl_p->num_entries = 4).

I am going to place code in dpe_acl_mgr_get_access() routine
to help me find out what the uuid's are and why they are not
equal.  It appears that we may be picking up a stail dts-entity
uuid from someplace and the dts-entity is never recreated at
config time.  If you have additional information please let me
know.  I will also recreate the problem, remove the mgt_acl file,
restart dts, and see if the mgt-acl is picking up a wrong uuid
from the mgt_acl file.

How can I read the uuids stored in the mgt_acl file avoiding the 
information in cache?
You can call me at 512/838/0386 or email to smith@os2dce17.austin.ibm.com.

[05/25/93 public]
We have not seen this problem at OSF.  I have seen the error message
when trying to create a server when the dts-server entity has not
been created in the namespace (see src/config/dce_config from OSF).
ie. I configure a clerk, then try to 'create type server' by hand.

It seems you are close to figuring out this problem, please keep 
OSF (me - tom@osf.org) informed.


Tom,
The failure is due to dtsd reading a bad uuid from an old stail mgt_acl file.
The dtsd creates a default acl and writes it to a mgt_acl file.  This file
will be read if it exists or created when it does not.  When the dtsd
daemon is started but not configured a mgt_acl file is created but rmdce
will not remove this file since dts was not configured.  When dts is restarted
it reads this stail mgt_acl file to get a default_realm uuid to compare it
with the client realm uuid.   Since the default_realm uuid is an old uuid
the client and default realm uuids are different and it is assumed that
some other user is trying to access the dts-entity. 

The uuids are different so the dts logic does not use the sec_acl_e_type_user
instead it uses sec_acl_e_type_any_other.  The sec_acl_e_type_any_other
has a uuid of "00000000-0000-0000-0000-000000000000" and read permission only.
Since, any other user has read permission only we are unable to carry out the
write test to the dts-entity.   

Although, this is a user problem due to improper configuration, we should
have a cleaner way of handling this since it can provide a catch
22 situation for customers when configuring dts.

Can you contact DEC to see if it is appropriate to create the mgt_acl file
and read it each time dtsd is restarted?  This may have undesirable 
consequences if the acls are initially setup differently in the registery
database than in the mgt_acl file.   Another option is to have the config
files remove the mgt_acl file even if dts is not configured. 

To recreate this problem configure security, cds, rpc, and dts.  Unconfigure
dts using rmdce -l dts_cl.  Start /bin/dtsd, use dtscp create type clerk, 
and dtscp enable to enable the time service.  Do a rmdce -l all and a proper
mkdce to configure rpc, security, cds. and dts.  You will see the message
as dts is configured.  You can check for the stail mgt_acl file thoughout 
these steps.  If you remove the mgt_acl file and restart the daemon
you will not see the message "must have write permission to the DTS entity".


We are having a number of dts problems who can I contact directly when I
have questions relating to dts internals.  It is also important to note
that customers can get themselves into improper configuration situations
that we may not be currently be taking account of.

The output of the uuid info follows:

mgt_acl_init just read acl storage mgt_acl.
default realm uuid for the acl: 007a1980-1127-1c05-8cf3-10005a4f2223
Create_Cmd PROTSEQ: ncacn_ip_tcp, NET_ADDR: 129.35.65.109, ENDPNT: 1369, NET_OPT:
 , UUID:

dpe_acl_mgr_get_access:
client realm uuid: 0012b7f4-47ee-1c0a-a6aa-10005a4f2223, acl default_realm uuid:
007a1980-1127-1c05-8cf3-10005a4f2223, in_default_realm: 0

dpe_acl_mgr_get_access sec_acl_e_type_any_other:
client realm uuid: 0012b7f4-47ee-1c0a-a6aa-10005a4f2223, acl default_realm uuid:
007a1980-1127-1c05-8cf3-10005a4f2223

client principal uuid: 00000064-47ee-2c0a-a600-10005a4f2223, acl any_other_entry
uuid: 00000000-0000-0000-0000-000000000000

dtsd read the mgt_acl file and found the old default uuid that dtsd had
previously created.  When I enter the dpe_acl_mgr_get_access() 
I found that the accessor_info realm uuid was different from the 
default realm uuid read from the stail mgt_acl file. 
The in_default_realm fails and I enter the switch() statement with 
a case of sec_acl_e_type_any_other for one the the entries.  The routine
gets to the ANY_OTHER check and enters the masked_access macro.  The 
access_extent returned is read only because the default entry for
any other user in the mgt_acl file is read only.  

Why is the defaults read only for anyother user and unauthenticated users?
This sounds reasonable since we do not want just any user or an
unauthenticated user to write to the dts-enity.

We simply do not have the same client uuid as we originally had since we
are picking up the old default_realm uuid.  In this situation the mgt_acl
file is corrupt but since it passes the checksum logic dtsd does not
have a problem with it.  OSF should consider the possibility of this type 
corruption and deal with it.  This is a design issue.  I have mentioned
the short term fixes of removing this file regardless of dts 
configuration or possibly creating it before reading it each time dtsd 
starts up.

Let me know what OSF is going to do as soon as possible.

Thanks

[06/01/93 public]
Tracy,

Thanks again for investigating this problem.  I suspect that this
is mainly an IBM configuration issue (we do not have the rmdce and
mkdce tools you refer to).  In June of 1992, OT 4199 was fixed
which added a remove of the /var/adm/time/mgt_acl file to /etc/dce.rm.

Perhaps your dce.rm scripts are missing this?  
Re-reading your message I believe this is the case.  
The correct fix is to remove the mgt_acl file when reconfiging DTS.

As far as you internals questions are concerned, Jim Wade @ IBM
is a great internal (to you) resource on DTS.  I believe he knows
almost as much as the guys from DEC!  As far a DEC is concerned,
they are not going to continue to support DTS for OSF.  OSF
now owns this component.  Translate OSF to 'me' again.

I can get some 'unofficial' help from Joe Comuzzi and others at
DEC when I have a question on the design, but basically the
ball is in my court.

Anyway, I would be happy to take a look at the problems you are
having.  I assume you are working with DTS from the 1.0.2 release.
We at OSF have had few problems with it recently.  Please remember
that your configuration mechanism is probably *very* different
from our "simple" scripts (dce_config, etc.).  

Unless you feel strongly otherwise, I will cancel this bug as IBM
specific.

I tried sending this via mail, but I don't think this reached you.
Could you Email me (tom@osf.org) your address?  Thanks.

[06/01/93 public]
Tom,
thanks for the information.  We do remove mgt_acl files when we unconfigure
dce but like you mentioned it will also need to exist when we reconfigure
dce. This will prevent problems with improper configuration of dts. 

What should be done with a corrupt acl_mgr file.  Currently the checksum
error checking is not sufficient to determine if the mgt_acl file has
been corrupted or broken into.  If a wrong uuid can exist then I'm not
certain if I understand why we are checking for a corrupted mgt_acl file.
Why do we use this mgt_acl file in the first place? 

My address is os2dce17.austin.ibm.com. If you can't reach me at this
address try smith@yale.austin.ibm.com.  Bob Whitehurst is just down the
hall from the lab.

You can cancel this defect but OSF should look at the mgt_acl error checking
and possibly coding dtsd to create the mgt_acl file each time
dtsd is restarted.  So, we have two things to look at.  First, is the error
checking that is being done on the mgt_acl file reasonable.  Second,
should the mgt_acl file be created each time dtsd is restarted instead
of being read when it already exists.  Other vendors will run into
this problem later.  The proper place for this to be handled for proper
configuration of dtsd is in dtsd itself.  If you want I can open up
two defects on these issues.

Modifying the config scripts will fix our problems but every vendor will
have to deal with how dtsd handles this situation.  I feel that it is
more reasonable to expect dtsd to create the mgt_acl each time dtsd
is restarted.

[01/14/94 public]

DTS has an ACL.  This ACL, like all ACL's, must be stored in the local
filesystem.  DTS left "space" in its ACL file for a checksum, but that
checksum is not currently used.  We think that is okay, although someone
could open an OT enhancement request to put in a real checksum, it should
be low priority:  worry about local O/S disk corruption is not a big DCE
concern.

The more complicated issue is:  what should DTS put in its ACL?  By
default, it gives everyone read access and read/write access to the
timeserver admin and the machine principal.

From my reading of this bug report, the config scripts in use re-create
the timeserver admin, and therefore the dts acl is outdated, and perceived
to be bad.  Things are working they way they should be -- if you remove
principals, and create new principals with the same responsibilities, then
you must update the appropriate ACL's.

If my last paragraph is wrong, please re-open this defect (and use real
short words when you explain it to me:-).  Thanks.



CR Number                     : 8008
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7239
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : all
Short Description             : Change ALL includes of
dce/pthread.h to pthread.h and dce/pthread_exc.h to pthread_exc.h.
Reported Date                 : 5/17/93
Found in Baseline             : 1.0.3
Found Date                    : 5/17/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/17/93 public]

Both of these headers get installed by the Application Development
Environment in /usr/include. For 1.0.2 there is a link that allows
older apps to find these in /usr/include/dce but this may go away in
the future. Apps including dce/pthread.h may not build in a DCE
environment that uses something other than DCE Threads. Some of our
headers that apps end up including are guilty of including dce/pthread.h. 
These need to be fixed.

[06/23/93 public]
Perhaps, then, we should not put dce/pthread.h and dce/pthread_exc.h in
the install tree?

[09/30/93 public]
This is essitially a dup of 7239.  The only file in the src tree
is src/rpc/sys_idl/stubbase.h, and I am fixing that under 7239.

[09/30/93 public]
My mistake, I misread 7239.  There are *many* places in the DCE source
code which include dce/pthread_exc.h.  This defect still needs to
be addressed.  And should be addressed in 1.0.3.

Raising to a P1.

[10/04/93 public]
Since this is a threads issue, giving this one (and 7239) to John Dugas
so he can straighten out this mess.

[10/15/93 public]
Its been decided that pthread_exc.h will stay in include/dce. Cancel.



CR Number                     : 8001
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : /test/file/itl/spoke
Short Description             : Include file spoke_defs.h not found.
Reported Date                 : 5/13/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/13/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/13/93 public]

[5/18/93 public]
Is this really a problem.  I've seen build reports for the last few days
without any errors.  I'm going to assign this to the build group for further
clarification.
Changed Component Name from `dfs' to `bld' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[08/30/93 public]
Since Ed isn't here, someone needs to verify that this is not a bug.

[9/2/93 public]
This should have been closed long ago.



CR Number                     : 8000
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : tests
Short Description             : /test/file/update missing a file
Reported Date                 : 5/13/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/13/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/13/93 public]
in ... test/file/update
xlc -c        -D_ALL_SOURCE -DAIX32 -g -DITL_FS_TEST  -I. -I/u1/devobj/sb/nb_rios/src/test/file/os_calls   -I/u1/devobj/sb/nb_rios/export/rios/usr/include  ../../../../../src/test/file/os_calls/file_test.c
xlc           -L/u1/devobj/sb/nb_rios/export/rios/usr/lib -o file_test.X file_test.o  -litlFile -litlUtils -litlHubSpoke -litl -ldce -lcom_err -lbsd  
0706-005 ld: Cannot find file: /lib/libitlHubSpoke.a
	Check path name and permissions or
	use local problem reporting procedures.

[5/18/93 public]
This defect should be canceled it was caused by ot 8001 which looks like a
build related failure (NFS server down??), since it has not been seen during
subsequent nightly builds
Changed Component Name from `dfs' to `bld' 
Changed Status from `open' to `cancel' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'



CR Number                     : 7998
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : sec_admin / lrep -all
Short Description             : lrep -all gives ticket error for Last comm status
Reported Date                 : 05/13/93
Found in Baseline             : 1.0.2
Found Date                    : 05/13/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[05/13/93 public]

Every once in a while I get the following message when I do an lrep -all
command within sec_admin:

	Last comm status: Cannot find ticket for requested realm (dce / krb)

This is the Last comm status for one of two slaves in my cell.  Everything
appears to be working fine if I just do the lrep -all command again.

[05/18/93 public]
This is normal behaviour.  From time to time the slave's ticket expires
and is refreshed.  The master, when communicating with the slave, will
get this auth error (because the ticket has expired). The master
automatically recovers from this error by getting a refreshed ticket from
the slave.

[5/19/93 public]
Since this is normal behavior, there's no defect reported here.
I've marked this CR 'cancel', per Liza's explanation of the behavior.



CR Number                     : 7988
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : 
Short Description             : Interoperability problems
between SNI and DEC
Reported Date                 : 5/13/93
Found in Baseline             : 1.0.2
Found Date                    : 5/13/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/13/93 public]

There seem to be several interoperability problems between Siemen's GDS
and DEC's X.500. These problems were found on mips-OSF/1, but I
will soon verify whether or not they occur on AIX as well.

Here is a description of the current level of understanding of the problems.

The (cstub) trace shows it getting a user request and converting it to
ASN.1. This request is basically a 'SHOW ENTRY /CN=SCHEMA attributes
...'.  The request appears to be encoded correctly, but is embedded in
some other data, which I cant understand.  I think the DUA is
detecting an internal error and aborting the connection.  I believe
the reason that it works Siemans DUA to Siemans DSA is that they use a
private transfer syntax, so the request never has to be encoded as a
real X.500 message.  (The bind request indicates an alternate syntax,
we only support ASN.1).

The relevant bit of the log file follows

         R_UNKNOWN        (no_ros)                                07:41:58
             Record data: 
                      0 06040100 00300424 00000002 01005061 |.....0.$......Pa|
                 0x0010 4e304c02 0103a047 a1450202 01000201 |N0L... G!E......|
                 0x0020 33313ca0 13301131 0f300d06 03550403 |31< .0.1.0...U..|
                 0x0030 14067363 68656d61 a111310f a10d310b |..schema!.1.!.1.|
                 0x0040 06092b0c 02885301 030402be 0d310ba0 |..+..S....>.1. |
                 0x0050 04030203 08a10302 0100ba03 02010000 |.....!....:.....|
                 0x0060 00                                  |................|
30000001 s_datarq(30000001, 0x10034000, 80, S_END) = 65535        07:41:58
         s_error(-) = S_INVMGLEN - invalid message length         07:41:58
30000001 ->AB      -2                                             07:41:58     
               TDISC     USER_ABORT RELEASE_TC
               ----------------  ARP  ------------------------- PRESENTATION --
               ABORT REASON: unspecified
30000001 s_uaborq(30000001, (0x10034000,5)) = S_OK                07:41:58


DEC's DSA normally includes a calling-AP-title in bind requests and a
responding-AP-title in bind responses.  The SNI DUA doesn't seem to like the
responding-AP-title.

There is another problem, though who is at fault is not clear.  SNI does not
include a Direct-reference OID in either the bind request or bind response.
DEC's software expects one to be present.

[10/15/93 public]

Not a reference platform, nor gds, even.  Cancelled .



CR Number                     : 7987
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : control
Short Description             : CDS_LinkTimeout Expiration
displays 1 hour earlier than it is set for
Reported Date                 : 5/12/93
Found in Baseline             : 1.0.2.b23
Found Date                    : 5/12/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/12/93 public]
I create a link to an object, assigning a CDS_LinkTimeout Expiration and
Extension.  I set the directory to skulk, and then show the link.  Some of
the time, the expiration shows as 1 hour earlier than what was set.

For example:

> cdscp create link /.:/jsirkin/dir1/link3 CDS_LinkTarget = \
> /.:/jsirkin/dir1/obj1 CDS_LinkTimeout = \(1993-11-13-10:18:00
365-00:00:00\)

[root@yale:12] /
> cdscp set directory /.:/jsirkin/dir1 to skulk

[root@yale:12] /
> cdscp show link /.:/jsirkin/dir1/link3 CDS_LinkTarget CDS_LinkTimeout

                        SHOW
                    SOFTLINK   /.../xinu.cell/jsirkin/dir1/link3
                          AT   1993-05-12-10:46:17
              CDS_LinkTarget = /.../xinu.cell/jsirkin/dir1/obj1
             CDS_LinkTimeout = :
                  Expiration = 1993-11-13-09:18:00.000-06:
                   Extension = +365-00:00:00.000I-----

[06/16/93 public]
Any idea how to force this condition. I've made several attempts at
replicating it without  success.

[07/29/93 public]
I can't reproduce this now. Cancelled.



CR Number                     : 7986
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_cf.h
Short Description             : dce_cf.h does not include stdio.h
Reported Date                 : 5/12/93
Found in Baseline             : 1.0.2
Found Date                    : 5/12/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[5/12/93 public]
The dce_cf.h file uses the FILE type from stdio.h but does not include
stdio.h.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/8/93 public]
I just spoke with Fred.  This bug was apparently filed based 
on inspection.  I hesitate to simply include stdio.h without
a specific compilation test case that shows the problem before 
the fix and verifies the fix once it is made.

Therefore, we agreed to cancel this bug unless a specific 
compilation problem can be identified.  Cancelled.



CR Number                     : 7972
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : osf1
Component Name                : bld
Subcomponent Name             : 
Short Description             : build error in  /test/file/acl/scripts/syscalls
Reported Date                 : 5/11/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/11/93
Severity                      : A
Priority                      : 0
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/11/93 public]
[ /test/file/acl/scripts/syscalls at 15:43 (PM) Sunday ]
release: reopen /project/dce/build/nb_pmax/src/../install/pmax/dcetest/dce1.0/test/file/acl/README.tmp: File exists
/project/dce/build/nb_pmax/src/../install/pmax/dcetest/dce1.0/test/file/acl/README: aborting installation
*** Error code 1 (continuing)

[5/18/93 public]
This problem was caused by an incremental build.  The file README.tmp is no
longer part of the configuration.  I'm going to cancel this defect, since
the problem has not been seen in subsequent builds.
Changed Component Name from `dfs' to `bld' 
Changed Status from `open' to `cancel' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'



CR Number                     : 7962
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : acl_edit
Short Description             : user/group entries in ACL with "unauth cell" default realm mapped to storing cell
Reported Date                 : 5/7/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/7/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.


Transarc Deltas                      [text]: 
Transarc Herder                      [text]: jaffe@transarc.com
Transarc Status                      [text]: open

[5/7/93 public]
For a ACL with a foreign cell (e.g. unauthenticated cell), as the
default realm, the uuid put in user entries in the ACL is the uuid of
the user in the storing cell.  Thus when you list the ACL, you do not
get user names but uuids as acl_edit is not able to map the uuid to
names in the "unauthenticated cell". One fix would be to prevent
additon of "user" and "group" entries in an ACL with the
"unauthenticated cell" as default realm, since all unauth users are
mapped into anonymous@anonymousCell anyway and so the user and group
entries in such an ACL will never be used
Similarly for group entries
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[9/28/93 public]
As Tu just pointed out to me, this seems to be a problem with acl_edit not
using the default cell of the ACL when adding user/group entries to that ACL,
If it was using the default realm id and it was the anonymous id, then the
translation of those names wouldn't work and it wouldn't allow you to enter
user or group entries, which would solve the problem.

[7/14/94 public]
Moved to dcecp component for Howard to look at prior to setting status
to defer to 1.2  (dcecp now performs most functions of the control programs)

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.

[8/3/94 public]
Moved back to sec.  I will open another bug for dcecp to make sure dcecp
does not have the same problem.  We here don't completely understand the
problem and HP folks are too overworked right now to explain.  

This really is a severity E since it is just a cosmetic problem.  It has to
do with names being displayed instead of UUID's.



CR Number                     : 7958
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : dce rpc
Short Description             : Bug in binding_cache_remove function
Reported Date                 : 5/7/93
Found in Baseline             : 1.0.2
Found Date                    : 5/7/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[5/7/93 public]
The test cell is configureed by dfs-102-2.10 backed by osf b23 with
two machines. Running our distributed tests leads to the death of
"dfsbind" (core dump). 
Here is the stack trace for the core dump.
As you can see it is panic at refcnt == 0;
(dbx) where
raise(0x0) at 0xd00d693c
abort(0x0) at 0xd00d684c
_assert(0x0, 0xdeadbeef, 0xdeadbeef) at 0xd012c904
rpc_binding_free(binding_h = 0x202c3fbc, status = 0x201cd11c), line 214 in "com
bind.c"
rpc_binding_vector_free(binding_vec = 0x20212a6c, status = 0x201cd11c), line 28
5 in "combind.c"
rpc_ns_binding_import_done(import_context = 0x202393bc, status = 0x201cd11c), l
ine 225 in "nsbndimp.c"
sec_rgy_site_close(0x202393a8, 0x201cd11c, 0x1, 0x0, 0xdeadbeef, 0xdeadbeef, 0x
deadbeef, 0xdeadbeef) at 0xd0427d60
binding_cache_remove(0x202393a8) at 0xd0423b04
rca_binding_cache_purge(0x0) at 0xd0423d64
binding_cache_enter(0x202c1e48) at 0xd0423860
rca_site_bind(0x201cd660, 0x201cdd24, 0x3, 0x0, 0x20053f00, 0x0, 0x201cdd1c, 0x
201cdd18) at 0xd04279ac
sec_rgy_site_bind(0x201cdd38, 0x201cdd24, 0x201cdd1c, 0x201cdd18) at 0xd0422fac
sec_rgy_site_bind_query(0x201cdd38, 0x201cdd24, 0x201cdd1c, 0x201cdd18) at 0xd0
4230c8
sec_krb_sec_parse_name(0x202d8328, 0x5, 0x20171dec, 0x201ce984) at 0xd0448b90
cred_from_cred_rep(credrep = 0x201cea40, cred = 0x201ce9f8), line 446 in "auth_
helper.c"
handle_sec_krb_get_cred(inptr = "^C^B^A^A\241^Z0^X^[^Ehosts^[^Cmoe^[\ndfs-serve
r\243\2000\200\240^C^B^A^A\241^C^B^A^B\242\200^D\202^A\350^HE\347\276\324\177\3
62\315z\277\334\276\243\221\264\256^^3^H^V\274Qu[N^C\355\215\361^M\337L\274\377
3\367\353\332\207-\276Z3>&\234q\355K\306J\204\3135y; \240%[Dp^]KP^X\344\342^$|\
200\356\241\366?\373\337\316\210c2[3", inlen = 58, outbuf = ""), line 519 in "a
uth_helper.c"
do_auth_request(inptr = "A", inlen = 58, outbuf = "", outsize = 0x20171dcc), li
ne 786 in "auth_helper.c"
ProcessRequest(req = 0x20171dc4), line 371 in "main_helper.c"
service_thread(addr = 0x20090b18), line 277 in "main_helper.c"
cma__thread_base(0x200a8838) at 0xd04149a4
cma__restore_thread_ctx() at 0xd03fdfe8
raise(0x0) at 0xd00d693c
(dbx)
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[5/7/93 public]
A couple of things that I might add:  First, this condition occurs
under heavy load (and seems to take a while O(hours) to create).  It
seems to be reproducible but with effort.
I looked at the stack trace a bit.  It is running with a libdce where
the rpc code is compiled -g, so I got lost when I got into the sec
code.  Anyway, the binding vector passed to rpc_binding_vector_free is
bogus.  For example, it thinks there are ~7000 binding handles.  The
context passed to rpc_ns_binding_import_done() looks pretty bogus, as
well.  I don't know if binding_cache_remove is passing the right
thing.

[6/10/93 public]
Change fixby to 1.0.3 as agreed at 6/9 tech call with Transarc.

[6/10/93 public]
I think this problem may be fixed by Carl's auth_helper fixes.  
We should try to reproduce it when we get the new dfsbind.

[8/29/94 public]
I think this defect was fixed by the auth_helper fixes submitted over
a year ago.  In any case, the above comments seem to indicate that
bogus data was passed to rpc from security.

Canceled.



CR Number                     : 7953
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : fx: protection failure in readdir (perms = 1, have 0)
Reported Date                 : 5/7/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/7/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/7/93 public]
CONFIG: 	2 pmax cell, 2 flservers, root.dfs in lfs
BUILD:		nb available 4/26/93
TEST:		unclear as yet
Logging that the symptom of repeated error messages of the
form:
fx: protection failure in readdir (perms = 1, have 0) 
were seen. Low severity and priority since it is not clear yet how these
are related to other problems seen on this server (the pmax exporting root.dfs
and epi.1 lfs filesets). These other problems do actually involve unexpected
access to files and directories. Narrowing down which problem produces this
message.

[5/7/93 public]
Upping the priority/severity and reassigning to Rajesh. The test case is the
following:
- cd to a directory in lfs, this directory should contain files that are
NOT accessible by unauthenticated users
- login as a Unix user and dce principal that DOES have access to the directory
and the files that directory contains
- read some or all of the directory's files
- kdestroy and exit the dce_login shell
- read some or all of the directory's files
NOTE: you still have access to any you read before the kdestroy!

[5/7/93 public]
kdestroy does not destroy your credentials in the kernel and this could 
allow you access to files even after the kdestroy.
Exiting the dce_login shell should really revert to the unauth user and
access to files and dirs that do not allow unauth access should 
not be allowed.
 
Many problems have been found in the past week w.r.t. unauthenticated
access and ACLs. These problems are being fixed and hence downgrading
the priority of this bug down to 2. If the problem still exists
once those fixes are in place, we should upgrade the priority
on this one again.
Filled in Interest List CC with `comer' 
Changed Priority from `1' to `2'

[5/21/93 public]
Now that a lot of the ACL bugs have been fixed, I retried with a system
with the ACL fixes and was unable to reproduce the problem.
Gail, if the sequence of operations I tried is not representative, let
me know and I can retry. Also, once you have a build with the changes
for the following ACL related OT's could you retry and let me know if
the problem still exists. OTs = 7961, 7966, 8002, 8003, 8005, 8023.
The deltas for the above OTs have been exported. Thanks.
The sequence of operations I tried

[rajesh] cd /:
dfs: set auth binding failed (code 387064044)
ldfs: Warning: created unauthenticated binding

[:] klist
No DCE identity available: No currently established network identity for which c
ontext exists (dce / sec)
Kerberos Ticket Information:
klist: No credentials cache file found (dce / krb) while setting cache flags (ti
cket cache /tmp/krb5cc_4970)

[:]  ls -l
total 14
-rw-r--r--   1 rajesh   system         0 May 21 11:21 a
-rw-r--r--   1 100      12            22 May 21 13:38 afile
lrwxrwxrwx   1 rajesh   transarc       1 May 21 10:03 b@ -> a
drwxr-xr-x   2 100      12           256 May 19 11:46 bwl/
drwxrwxr-x   2 100      12           288 May 19 10:27 dir1/
drwxrwxrwx   2 ota      episode      256 May 19 11:31 ota/
drwxrwxrwx   2 rajesh   system       256 May 19 11:30 rajesh/
drwxr-xr-x   2 100      12           256 May 19 10:40 ravi/
drwxrwxr-x   4 100      12           512 May 20 15:34 unauth-nonroot/
drwxrwxr-x   2 100      12           256 May 18 13:20 unauth-root/

[:] acl_edit afile -l
Warning - binding to registry is unauthenticated
dfs: set auth binding failed (code 387064044)
dfs: Warning: created unauthenticated binding
# SEC_ACL for afile:
# Default cell = /.../power7.dce.transarc.com
user_obj:rw-c--
group_obj:r-----
other_obj:r-----

[:] cat afile
cat: cannot open afile

[:] dce_login rajesh rajesh
% klist
DCE Identity Information:
        Warning: Identity information is not certified
        Global Principal: /.../power7.dce.transarc.com/rajesh
        Cell:      0051b0f8-11d2-1bf9-bbe4-02608c2ef49f /.../power7.dce.transarc
.com
        Principal: 0000136a-467d-2bfa-9b00-02608c2ef49f rajesh
        Group:     00000000-11d6-2bf9-bb01-02608c2ef49f system
        Local Groups:
                00000000-11d6-2bf9-bb01-02608c2ef49f system
Identity Info Expires: 93/05/21:23:49:00
Account Expires:       never
Passwd Expires:        never
Kerberos Ticket Information:
Ticket cache: /opt/dcelocal/var/security/creds/dcecred_41000010
Default principal: rajesh@power7.dce.transarc.com
Server: krbtgt/power7.dce.transarc.com@power7.dce.transarc.com
        valid 93/05/21:13:49:00 to 93/05/21:23:49:00
Server: dce-rgy@power7.dce.transarc.com
        valid 93/05/21:13:49:01 to 93/05/21:23:49:00
Server: dce-ptgt@power7.dce.transarc.com
        valid 93/05/21:13:49:03 to 93/05/21:15:49:03
Client: dce-ptgt@power7.dce.transarc.com        Server: krbtgt/power7.dce.transa
rc.com@power7.dce.transarc.com
        valid 93/05/21:13:49:03 to 93/05/21:15:49:03
Client: dce-ptgt@power7.dce.transarc.com        Server: dce-rgy@power7.dce.trans
arc.com
        valid 93/05/21:13:49:04 to 93/05/21:15:49:03
Client: dce-ptgt@power7.dce.transarc.com        Server: hosts/power7/dfs-server@
power7.dce.transarc.com
        valid 93/05/21:13:49:04 to 93/05/21:15:49:03
% ls -l
total 14
-rw-r--r--   1 rajesh   system         0 May 21 11:21 a
-rw-r--r--   1 100      12            22 May 21 13:38 afile
lrwxrwxrwx   1 rajesh   transarc       1 May 21 10:03 b -> a
drwxr-xr-x   2 100      12           256 May 19 11:46 bwl
drwxrwxr-x   2 100      12           288 May 19 10:27 dir1
drwxrwxrwx   2 ota      episode      256 May 19 11:31 ota
drwxrwxrwx   2 rajesh   system       256 May 19 11:30 rajesh
drwxr-xr-x   2 100      12           256 May 19 10:40 ravi
drwxrwxr-x   4 100      12           544 May 21 13:48 unauth-nonroot
drwxrwxr-x   2 100      12           256 May 18 13:20 unauth-root
% touch c
% cat afile
Created by cell_admin
% kdestroy
% exit

[:] klist
No DCE identity available: No currently established network identity for which context exists (dce / sec)
Kerberos Ticket Information:
klist: No credentials cache file found (dce / krb) while setting cache flags (ticket cache /tmp/krb5cc_4970)
y% [:] cat afile
cat: cannot open afile

[:] more afile
afile: Permission denied

[:] echo $status
1
Changed Interest List CC from `comer' to `comer, jaffe'

[5/21/93 public]
Gail, 
one more ACL OT - 7959 (though this should not affect this bug at all).

[9/24/93 public]
Changed Responsible Engr. from `rajesh@transarc.com' to `tu@transarc.com'

[9/24/93 public]
Gail, 
I have just tired the test scenario mentioned above on the HP platform and
could not reproduce it at all.  I don't think the bug is there.
In fact, I suspect the defected you saw could be the result of a very
confused environment at that time. The CM always chooses/creates an 
unauthenticated rpc binding for an user who does do dce_login. Accordingly,
the fx server always perform the authorization based on the  PAC derived
from the rpc binding.  This code path have been very stable for a long time.
                                                                              
I was wondering that you want to cancel it if you too cannot reproduce it.
Thanks,

[10/4/93 public]
Assigned to gail so that she can cancel it.
Changed Responsible Engr. from `tu@transarc.com' to `gmd'

[10/4/93 public]
Changed Resp. Engr's Company from `tarc' to `osf'

[10/8/93 public]

Aged relative to Aug 1.

[12/16/93 public]
Now that the Transarc drop is here, able to try this out - acl changes (and others?)
appear to have removed the ability to cd to a directory you don't have permission to
as an unauthenticated user (this was fixed before the end of 1.0.2a) nor can I read
files I had read previously as an authenticated user. Note that
root's authenticated identity as self has also clarified things in this area as
well.

> su gmd /* no dce account or credentials */
% su cell_adm             /* unix user corresponding to dce user cell_admin */
> dce_login cell_admin -dce- /* create shell with cell_admin credentials */
Password must be changed!
> cd /:/epi_1	/* cd to an episode fileset */
> ls 
dce.clean         dce_com_utils     dce_config_utils  rc.dce.std
dce.unconfig      dce_config        rc.dce
dce_com_env       dce_config_env    rc.dce.orig
root@cobbler> cat rc.*
(text deleted)
> kdestroy /* destroy credentials files */
> ^D	/* exit dce_login shell */
> id
uid=100(cell_adm) gid=1(staff)
root@cobbler> klist
No DCE identity available: No currently established network identity for which context exists (dce / sec)

Kerberos Ticket Information:
klist: No credentials cache file found (dce / krb) while setting cache flags (ticket cache /tmp/krb5cc_100)
> cd /:/epi_1
ksh: /:/epi_1: Permission denied.
> cat /:/epi_1/*
cat: 0652-050 Cannot open /:/epi_1/*.



CR Number                     : 7952
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfs
Short Description             : Dummy acl for dir owned by foreign user has wrong default realm
Reported Date                 : 5/7/93
Found in Baseline             : 1.0.2
Found Date                    : 5/7/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : sshi!ibm.com
Transarc Status               : open

[5/7/93 public]
An authenticated user is not able to update the ic or io ACL of a 
directory to add permission bits for local cell users. The
following log illustrate the problem. The default cell for the ic 
and io ACL is still the local cell, not the dummy cell created 
for unauth users. We suspect that this is reason why acl_edit
reject the update request...
> klist | grep principal
Default principal: hosts/pal411.austin.ibm.com/self@icdfs2.austin.ibm.com

[root@pal411] /.:/fs/shi1
> mkdir foodir

[root@pal411] /.:/fs/shi1
> acl_edit foodir -l
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (
dce
 / sec)
INFO: Local cell will be used for operations requiring default cell info.
INFO: Local cell will be used for operations requiring default cell info.
# SEC_ACL for foodir:
# Default cell = fffffffd0000.00.00.00.00.00.00.00.00
user_obj:rwxcid
group_obj:r-x---
other_obj:r-x---
foreign_other:/.../icdfs2.austin.ibm.com:r-x---
> acl_edit foodir -ic -l
# Initial SEC_ACL for directories created under: foodir:
# Default cell = /.../icdfs2.austin.ibm.com
user_obj:rwxcid
group_obj:r-x---
other_obj:r-x---
> acl_edit foodir -io -l
# Initial SEC_ACL for objects created under: foodir:
# Default cell = /.../icdfs2.austin.ibm.com
user_obj:rwxcid
group_obj:r-x---
other_obj:r-x---
> acl_edit foodir -io
sec_acl_edit> m foreign_other:/.../icdfs2.austin.ibm.com:rwxcid
sec_acl_edit> exit
ERROR: not a valid DFS acl (dce / sec)
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `sshi!ibm.com' 
Added field Transarc Status with value `open'

[5/17/93 public]
As Shepherd notes, the real problem is that the default realm of the
dummy initial ACL is not the owner's cell but the storing cell. 
This problem has been fixed under OT 8005. Hence this one should be
cancelled.
The following log of operations show that problem is solved.
# whoami
root
# klist
DCE Identity Information:
        Global Principal: /.../bugacl/hosts/power7/self
        Cell:      006df556-1151-1bf0-b468-02608c2ef49f /.../bugacl
        Principal: 00000066-1154-2bf0-b400-02608c2ef49f hosts/power7/self
        Group:     0000000c-1154-2bf0-b401-02608c2ef49f none
        Local Groups:
                0000000c-1154-2bf0-b401-02608c2ef49f none
Identity Info Expires: 93/05/17:22:05:05
Account Expires:       never
Passwd Expires:        never
Kerberos Ticket Information:
Ticket cache: /opt/dcelocal/var/security/creds/dcecred_ffffffff
Default principal: hosts/power7/self@bugacl
Server: krbtgt/bugacl@bugacl
        valid 93/05/17:12:05:05 to 93/05/17:22:05:05
Server: dce-rgy@bugacl
        valid 93/05/17:12:05:05 to 93/05/17:22:05:05
Server: dce-ptgt@bugacl
        valid 93/05/17:16:35:32 to 93/05/17:18:35:32
Client: dce-ptgt@bugacl Server: krbtgt/bugacl@bugacl
        valid 93/05/17:16:35:32 to 93/05/17:18:35:32
Client: dce-ptgt@bugacl Server: hosts/power7/cds-server@bugacl
        valid 93/05/17:16:35:35 to 93/05/17:18:35:32
Client: dce-ptgt@bugacl Server: dce-rgy@bugacl
        valid 93/05/17:18:25:51 to 93/05/17:18:35:32
# cd /:
# ls
acltest         dir1            rajesh          unauth-nonroot
cell_admin      e               test            unauth-root
d               foo             testdir         who
# ls
acltest         dir1            rajesh          unauth-nonroot
cell_admin      e               test            unauth-root
d               foo             testdir         who
# cd unauth-root
# acl_edit . -l
# SEC_ACL for .:
# Default cell = /.../bugacl
mask_obj:rwx-id
user_obj:rwxcid
group_obj:rwx-id
other_obj:rwx-id
any_other:rwx-id
# mkdir foreign
# acl_edit foreign -l
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce /
 sec)
INFO: Local cell will be used for operations requiring default cell info.
# SEC_ACL for foreign:
# Default cell = fffffffe0000.00.00.00.00.00.00.00.00
user_obj:rwxcid
group_obj:r-x---
other_obj:r-x---
# acl_edit foreign -ic -l
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce /
 sec)
INFO: Local cell will be used for operations requiring default cell info.
# Initial SEC_ACL for directories created under: foreign:
# Default cell = fffffffe0000.00.00.00.00.00.00.00.00
user_obj:rwxcid
group_obj:r-x---
other_obj:r-x---
# acl_edit foreign -io -l
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce /
 sec)
INFO: Local cell will be used for operations requiring default cell info.
# Initial SEC_ACL for objects created under: foreign:
# Default cell = fffffffe0000.00.00.00.00.00.00.00.00
user_obj:rwxc--
group_obj:r-x---
other_obj:r-x---
# acl_edit foreign -io
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce /
 sec)
INFO: Local cell will be used for operations requiring default cell info.
sec_acl_edit> l
# Initial SEC_ACL for objects created under: foreign:
# Default cell = fffffffe0000.00.00.00.00.00.00.00.00
user_obj:rwxc--
group_obj:r-x---
other_obj:r-x---
sec_acl_edit> m foreign_other:/.../bugacl:rwx
sec_acl_edit> l
# Initial SEC_ACL for objects created under: foreign:
# Default cell = fffffffe0000.00.00.00.00.00.00.00.00
mask_obj:rwx---
user_obj:rwxc--
group_obj:r-x---
other_obj:r-x---
foreign_other:/.../bugacl:rwx---
sec_acl_edit> exit
# acl_edit foreign -io -l
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce /
 sec)
INFO: Local cell will be used for operations requiring default cell info.
# Initial SEC_ACL for objects created under: foreign:
# Default cell = fffffffe0000.00.00.00.00.00.00.00.00
mask_obj:rwx---
user_obj:rwxc--
group_obj:r-x---
other_obj:r-x---
foreign_other:/.../bugacl:rwx---
#
Changed Short Description from `Can not set permission bits in ic and io ACL as 
 aunauth user' to `Dummy acl for dir owned by foreign user has wrong default 
 realm'

[5/18/93 public]
This problem was fixed by OT 8005.  Since I can't dup into the future, I'm 
cancelling this defect.
Changed Status from `open' to `cancel'



CR Number                     : 7941
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7896
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : unable to recover agg after rep
Reported Date                 : 5/6/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/6/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/6/93 public]
Three machine cell, 2 PMAX 1RIOS.  After running through the 
system test test/systest/file/dfs.repfs_checklist, I rebooted
the machines because the cdsd had core dumped on the RIOS.
On reboot, the Episode aggregate on the RIOS did not recover 
cleanly:
Verifying /dev/lv02
Will run recovery on /dev/lv02
recovery statistics:
        Elapsed time was 515 ms
        7 log pages recovered consisting of 476 records
        Modified 4 data blocks
        199 redo-data records, 0 redo-fill records
        0 undo-data records, 0 undo-fill records
Ran recovery on dev 1/1
Verify Zero Link Count List: Volume epi.1 file counts didn't match: claims 0 but should be 2.
Verify: Zero Link Count list in volume epi.1 needs updating.
Verify Zero Link Count List: Volume epi.1.readonly file counts didn't match: claims 0 but should be 2.
Verify: Zero Link Count list in volume epi.1.readonly needs updating.
zeroLinkCnt <no name was available>: volume index: 7 anode index 10
zeroLinkCnt <no name was available>: volume index: 7 anode index 9
zeroLinkCnt <no name was available>: volume index: 6 anode index 10
zeroLinkCnt <no name was available>: volume index: 6 anode index 9
Processed 4 vols 47 anodes 4 dirs 43 files 0 acls
Done.  Some inconsistencies found verifying /dev/rlv02
        WARNING: PROBLEM RECOVERING /dev/lv02
        Press <ENTER> to continue or CTRL-C to exit
I'm trying to find room to squirrel away the aggregate.  What additional 
information would be useful?

[5/6/93 public]
I've squirrelled the recovered aggregate if any one's interested.  The 
salvager was apparently able to fix the problem:
root@singsing> salvage /dev/lv02
Salvaging /dev/lv02
Will run recovery on /dev/lv02
Verify Zero Link Count List: Volume epi.1 file counts didn't match: claims 0 but should be 2.
Verify: Zero Link Count list in volume epi.1 needs updating.
Salvage: replacing Zero Link Count list
Verify Zero Link Count List: Volume epi.1.readonly file counts didn't match: claims 0 but should be 2.
Verify: Zero Link Count list in volume epi.1.readonly needs updating.
Salvage: replacing Zero Link Count list
zeroLinkCnt <no name was available>: volume index: 7 anode index 10
zeroLinkCnt <no name was available>: volume index: 7 anode index 9
zeroLinkCnt <no name was available>: volume index: 6 anode index 10
zeroLinkCnt <no name was available>: volume index: 6 anode index 9
Processed 4 vols 47 anodes 4 dirs 43 files 0 acls
Done.  Some inconsistencies repaired salvaging /dev/rlv02
root@singsing> salvage /dev/lv02
Salvaging /dev/lv02
Will run recovery on /dev/lv02
Processed 4 vols 47 anodes 4 dirs 43 files 0 acls
Done.  /dev/rlv02 checks out as Episode aggregate.
root@singsing>

[5/6/93 public]
Turns out both the PMAX and RIOS aggregates had trouble recovering, 
here's the log from the PMAX:
 recovering aggregate /dev/rz1f... 
Verifying /dev/rz1f
Will run recovery on /dev/rz1f
recovery statistics:
        Elapsed time was 9648 ms
        10 log pages recovered consisting of 502 records
        Modified 10 data blocks
        241 redo-data records, 0 redo-fill records
        0 undo-data records, 0 undo-fill records
Ran recovery on dev 1/1
Verify Zero Link Count List: Volume epi.1.readonly file counts didn't match: claims 1 but should be 2.
Verify: Zero Link Count list in volume epi.1.readonly needs updating.
zeroLinkCnt <no name was available>: volume index: 7 anode index 10
zeroLinkCnt <no name was available>: volume index: 7 anode index 9
Processed 3 vols 30 anodes 3 dirs 27 files 0 acls
Done.  Some inconsistencies found verifying /dev/rrz1f
        WARNING: PROBLEM RECOVERING /dev/rz1f
        Press <ENTER> to continue or CTRL-C to exit
I don't have room to save this PMAX aggregate.  I assume you'd prefer 
the RIOS version anyway.

[5/6/93 public]
Changed Responsible Engr. from `pakhtar@transarc.com' to `ota@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[5/7/93 public]
It is interesting that there are no other link count errors.
The repserver messes with the ZLC list when it does clones and restores.
There is some possibility that the fileset header management code here
is not doing this correctly.
Filled in Interest List CC with `cfe, jdp'

[5/11/93 public]
In particular, the fixes for OT 7896 may have fixed this problem.
Could you re-test once those are all up and running?  Thanks.
Changed Interest List CC from `cfe, jdp' to `cfe, jdp, ota' 
Changed Responsible Engr. from `ota@transarc.com' to `rsarbo' 
Changed Resp. Engr's Company from `tarc' to `osf'

[6/7/93 public]
I haven't been able to reproduce this on dfs.carl.  Cancelling and
filling in interdependent cr with 7896.



CR Number                     : 7937
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : Cannot delete an object completely
Reported Date                 : 5/5/93
Found in Baseline             : 1.0.2
Found Date                    : 5/5/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/5/93 public]
Running on B23, I created the directory /.:/jeanne and the object
/.:/jeanne/obj1.  After doing some other things in the directory,
I decided to cdscp del obj /.:/jeanne/obj1, and was given an error
(see output below).  The end result is that I cannot delete the
directory /.:/jeanne, because it is not empty.  A cdscp list obj
returns nothing, but a cdscp list dir returns obj1.  Needless to
say, I can't recreate the object since it's in a "half existance"
state.

> cdscp del obj /.:/jeanne/obj1
Error on entity: /.../xinu.cell/jeanne/obj1
Requested entry does not exist (dce / cds)
Function: dnsDelObj
dnsDelObj: partial results = /.../xinu.cell/jeanne/obj1

[root@yale:2] /
> cdscp del link /.:/jeanne/*
Error on entity: /.../xinu.cell/jeanne/*
Requested entry does not exist (dce / cds)
Function: dnsDelSLink
dnsDelSLink: partial results = /.../xinu.cell/jeanne

> cdscp set dir /.:/jeanne to skulk

[root@yale:2] /
> cdscp show dir /.:/jeanne

                        SHOW
                   DIRECTORY   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:35:37
            RPC_ClassVersion = 0100
                     CDS_CTS =
1993-05-05-14:02:49.465112100/10-00-5a-4f-33-bf
                     CDS_UTS =
1993-05-05-14:02:55.755194100/10-00-5a-4f-33-bf
              CDS_ObjectUUID = 0047096e-c909-1be7-9387-10005a4f33bf
                CDS_Replicas = :
          Clearinghouse UUID = 003e367c-8d44-1bd5-a00c-10005a4f33bf
                       Tower = ncacn_ip_tcp:129.35.67.232[]
                       Tower = ncadg_ip_udp:129.35.67.232[]
                Replica type = master
          Clearinghouse Name = /.../xinu.cell/yale_ch
                 CDS_AllUpTo =
1993-05-05-14:35:31.015560100/10-00-5a-4f-33-bf
             CDS_Convergence = medium
           CDS_ParentPointer = :
               Parent's UUID = 00430dfa-8d4c-1bd5-a00c-10005a4f33bf
                     Timeout = :
                  Expiration = 1993-05-05-09:02:49.492-05:
                   Extension = +1-00:00:00.000I0.000
                      MyName = /.../xinu.cell/jeanne
        CDS_DirectoryVersion = 3.0
            CDS_ReplicaState = on
             CDS_ReplicaType = master
               CDS_LastSkulk =
1993-05-05-14:35:31.015560100/10-00-5a-4f-33-bf
              CDS_LastUpdate =
1993-05-05-14:18:04.817453100/10-00-5a-4f-33-bf
             CDS_RingPointer = 003e367c-8d44-1bd5-a00c-10005a4f33bf
                   CDS_Epoch = 003e0f62-c90c-1be7-9387-10005a4f33bf
          CDS_ReplicaVersion = 3.0

[root@yale:2] /
> cdscp del dir /.:/jeanne
Error on entity: /.../xinu.cell/jeanne
Directory must be empty to be deleted (dce / cds)
Function: dnsDelDir

[root@yale:2] /
> cdscp
cdscp> list dir /.:/jeanne/*
                        LIST
                   DIRECTORY   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:37:10
obj1
cdscp> delete object /.:/jeanne/obj1
Error on entity: /.../xinu.cell/jeanne/obj1
Requested entry does not exist (dce / cds)
Function: dnsDelObj
dnsDelObj: partial results = /.../xinu.cell/jeanne/obj1

cdscp> set dir /.:/jeanne to skulk
cdscp> list obj /.:/jeanne/*
                        LIST
                      OBJECT   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:39:17
cdscp> list dir /.:/jeanne/*
                        LIST
                   DIRECTORY   /.../xinu.cell/jeanne
                          AT   1993-05-05-04:39:24
obj1

[05/05/93 public]
My guess is an acl permission problem.

[05/05/93 public]
Sorry I bounced out of the ot report early. What I meant to say is
that principal jd needs either delete permission to the object or
administer permission to the directory. Note - you need read permission
to do the acl_edits.

jd@eyeball $ dce_login jd -dce-
$ acl_edit /.:/foo -l

# SEC_ACL for /.:/foo:
# Default cell = /.../c=us/o=osf/ou=dce/cn=eyeball_cell
unauthenticated:r--t---
user:cell_admin:rwdtcia
user:hosts/eyeball/cds-server:rwdtcia
user:jd:r--t--a
group:subsys/dce/cds-admin:rwdtcia
group:subsys/dce/cds-server:rwdtcia
any_other:r--t---
$ acl_edit -e /.:/foo/obj1 -l

# SEC_ACL for /.:/foo/obj1:
# Default cell = /.../c=us/o=osf/ou=dce/cn=eyeball_cell
unauthenticated:r--t-
user:cell_admin:rwdtc
user:jd:r-dt-
group:subsys/dce/cds-admin:rwdtc
group:subsys/dce/cds-server:rwdtc
any_other:r--t-
$ cdscp del obj /.:/foo/obj1

[05/05/93 public]
I was running as cell_admin with full permissions.  However, even if I
didn't have the correct acls, it should have completely failed rather than
putting me in the "half deleted" state.



CR Number                     : 7932
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 6959
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : fxd? krpc?
Short Description             : comm failure/set context lost contact with fx server
Reported Date                 : 5/4/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/4/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/4/93 public]
BUILD:	102a available 4/26/93
CONFIG:	2 pmax cell, 2 flservers, root.dfs in lfs on one, ufs exported on other
TEST/ACTIVITY:	had run dfs.lock and dfs.glue overnight (unsuccessfully due
	to a dfsbind core dump and connection timed out errors)
This problem differs from the intermittent time out errors in that you do
not ever recover. All clients trying to access dfs receive either:
% cd /:
dfs: comm failure/set context (code 382312470)
dfs: lost contact with the fx server 130.105.5.27 in cell p102a_cell.qadce.osf.org
/:: Connection timed out
or simply:
root@dce12> cd /:
/:: Connection timed out
Assigning to myself since I believe this will be reproducable and NEXT time
I'll have krpc debugging on. Whatever this problem is, I believe it's been
in the code awhile (OT 6959).

[5/5/93 public]
This is most certainly a dfs problem.  The dfstrace dumps should
clearly identify the culprit if we can get them soon after the 
failure.  I expect that a locking problem occured on 130.105.5.27.
This is another case where a debugger should clearly deliniate the 
problem.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[5/6/93 public]
Seen again - this time with a different code though - is that significant?
dfs: comm failure/set context (code 382312556)
dfs: lost contact with the fx server 130.105.5.27 in cell p102a_cell.qadce.osf.org
./bin/stcode 382312556 
382312556 (decimal), 16c9a06c (hex): call timed out (dce / rpc)
Logs taken within an hour of the original problem - cell fairly
idle so hopefully they're good. See ~notuser/gmd/7932_logs.

[5/7/93 public]
Good test run.  There were at least three failures that I can detect.
on valentine, you were running some type of ACL tests, and an AFS_GetAcl
call to the local server timed out.  It looks like valentine in
SAFS_FetchACL, attempted to collect the correct tokens, and while getting
a token, it got hung.  This caused the AFS_GetAcl RPC to timeout.  (marking
the host as down).
Meanwhile, someone on dce12 tried to make an AFS_SetContext call to
valentine, and it timed out.  (I looked for the px side on valentine, but
could not positively identify it.)  
What is interesting about this whole mess is that the dfsbind on dce12
got the auth_ticket_expired failure at about this same time.  Its hard to
tell what the order of failures was.  Some of our new debugging will help 
with this.
The logs still don't deliver a smoking gun.  Can you get the systems set up 
for debugging or a crash dump so that we can see what was happening at the
time.  You mentioned in the README that krpc debug was turned on.  I thought
that this would put more debug information in the dfstrace dump, but I saw
nothing.  Its not helpfull to turn on krpc debugging once the failure occurs,
we really need to see the failure happen with the tracing already in place.
Synopsis: Still nothing to fix.  Maybe some more info.  Need to debug the
system in place.
to see that in the log.
caused the

[5/7/93 public]
Thanks for looking at the logs. The krpc debugging was on the whole time -
but I didn't set it at the right level. You are correct that I happened
to have been running ACL tests at the time but I don't believe that's
significant. The auth ticket expired incident may be significant - I'll
watch for that - I believe Mike Comer is researching the auth ticket
expired problems in general, correct? When will the new and improved debugging
code arrive at OSF?

[5/7/93 public]
To be more clear, I have seen this problem MANY times - usually by running
dfs.glue. This is the first time I've seen it while running ACL tests.

[5/17/93 public]
Problem still being seen with dfs.carl - is anyone looking at this?!

[5/18/93 public]
Can you provide some more information.  In particular, this defect should
address the problem that you see a timeout, and then the server never comes
back.  If the server comes back, then your seeing a different problem
(ot 7785).  If the server is really dead, then you need to get a debugger 
on the machine, and get the stack traces.  We are not seeing this type
of problem here at Transarc, so we cannot debug it alone.

[5/18/93 public]
You're correct - I didn't realize there's a separate bug for the "recovers"
case because it's only a B1 - I'll update that one, thanks. To be clear, so
far all we've seen with dfs.carl are timeouts from which we eventually recover.

[6/1/93 public]
This hasn't shown up yet with dfs.carl - unclear whether this has been fixed
or is just masked by other problems. Dropping the priority to a 1.

[6/3/93 public]
I'm assigning this to dave so that he can try and move this forward.  Diane's
last note suggests that this problem may have been fixed with the initial
dfs-carl drop.  Transarc has not seen this type of problem for a long time.
Changed Responsible Engr. from `jaffe' to `davel'

[06/11/93 public]

We have not seen the unrecoverable comm failure/set context in quite
a while; I have seen comm failures and set context during cho but
the system always recovers. - cancelled.



CR Number                     : 7927
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : 
Short Description             : Hang during attempted write
Reported Date                 : 5/3/93
Found in Baseline             : 1.0.2a
Found Date                    : 5/3/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[5/3/93 public]
Elliot - assigned to you since you've probably got the most recent
system restart experience - please reassign if appropriate. 
BUILD:	nb available 4/27/93
CONFIG:	single machine rios cell, only fileset = root.dfs in lfs
(no replicas, clones, etc.)
TEST:	nada - rebooted and restarted dce and dfs
without dce_log'ing in, immediately after reboot and restart,
as Unix user root in the same window rc.dce and rc.dfs were run:
root@cobbler> cd /:
root@cobbler> ls
cobbler_date  dce12_date    val_date
root@cobbler> cat *date
Wed Apr 28 11:47:11 EDT 1993
Wed Apr 28 11:47:19 EDT 1993
Wed Apr 28 11:47:17 EDT 1993
root@cobbler> echo `date` > cobbler_date
(hung for 30 minutes so far)
This should have failed with "Permission denied" since the existing
/:/cobbler_date was owned by cell_adm/cell_admin (Unix/dce).
In a remote cell, I am able to overwrite existing files dce12_date and val_date,but these were owned by "nobody".
In a 2nd window, I am able to run a similar command successfully.
root@cobbler> echo `date` > cobbler_nobody_date
root@cobbler> ls -l
total 0
-rw-r--r--   1 cell_adm none          29 Apr 28 11:47 cobbler_date
-rw-r--r--   1 nobody   nobody        28 May 03 19:24 cobbler_nobody_date
-rw-r--r--   1 nobody   nobody        28 May 03 19:19 dce12_date
-rw-r--r--   1 nobody   nobody        28 May 03 19:23 val_date
(note that this success did NOT require overwriting an existing file)
Other strange behavior seen is this short hour of uptime:
comm failure/lost contact
the file . does not exist
root@cobbler> rm cobbler_nobody_date
root@cobbler> kdestroy
root@cobbler> env |grep KRB
dfs: communication failure with server 130.105.201.7 in cell r102a_cell.qadce.osf.org.
dfs: lost contact with the fx server 130.105.201.7 in cell r102a_cell.qadce.osf.org
KRB5CCNAME=FILE:/opt/dcelocal/var/security/creds/dcecred_4100000c
root@cobbler> ls
ls: 0653-341 The file . does not exist.
root@cobbler> pwd
/:
root@cobbler> ls
ls: 0653-341 The file . does not exist.
root@cobbler> echo `date` > cobbler
/bin/ksh: cobbler: 0403-005 Cannot create the specified file.
root@cobbler> cm check
All backup filesets checked.
root@cobbler> cm stat
All servers are running.
root@cobbler> ls
dfs: set auth binding failed (code -1)
dfs: Warning: created unauthenticated binding
cobbler_date  dce12_date    val_date
I have dfstrace dumps and an icl.bind.
I've left the hung command hanging - please contact me
asap. Thanks. The /opt/dcelocal/var/dfs/adm logs show nothing.

[5/4/93 public]
I've looked at hung.dump, and I can see the shell attempting to access the
file.  The cache manager correctly failed the cm_access call with 13 (EACCES).
The issue here is where is the process hung.  The trace clearly shows that 
the kernel returned from the access system call.  Unfortunatly, there is 
no further activity in the log for the hung shell.
Can you hook up a dump terminal to the rios and find out where this process
is.  If there is no hope, then at least get a core dump from the machine.
You can do this by making sure that there is at least 20Meg in /dev/hd7, 
turning the switch to "service mode", and pushing the yellow button.  After
some time, the led's will go from C02 to C00 or C04.  C00 is success, and
you can now extract the crash from /dev/hd7 when the machine comes up.
C04 means that you did not have enough space in /dev/hd7, and the dump is
worthless.
How about calling Mike K. (at the OSF today) and have him look at this.
Changed Fix By Baseline from `1.0.3' to `1.0.2a' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[5/6/93 public]

Crashdump didn't tell us anything - taken too late. Couldn't reproduce
after reboot - dropping to a 2.

[05/28/93 public]
Canceling - no one's seen this again.



CR Number                     : 7926
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : thr
Subcomponent Name             : 
Short Description             : stubbase.h can't include <dce/pthread_exc.h>
Reported Date                 : 5/3/93
Found in Baseline             : 1.0.2
Found Date                    : 5/3/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : src/rpc/sys_idl/stubbase.h src/rc_files/shared
Sensitivity                   : public

[5/3/93 public]

At 1.0.2, the installed location of pthread_exc.h was changed from
/share/include/dce to /share/include. However, stubbase.h has not been
changed to reflect this change and still includes <dce/pthread_exc.h>.
Thus, without the compatibility links created by dce_config the compilation
of the IDL generated stubs will fail. Since the compatibility link
($DCELOCAL/share/include/dce/pthread_exc.h ->
$DCELOCAL/share/include/pthread_exc.h) is for the existing codes, not for a
new code, stubbase.h should be changed to include <pthread_exc.h>.

Also, when this change will take effect, the INCDIRS env. in
rc_files/shared must be changed to

  replace setenv INCDIRS "-I${export_base}/usr/include -I${export_base}/usr/include/dce"

so that stubbase.h can find pthread_exc.h under ODE where pthread_exc.h is
exported to ${export_base}/usr/include/dce instead of
${export_base}/usr/include. Note: You don't want to export it to
${export_base}/usr/include because A LOT of DCE internal codes are
expecting it in the dce directory.

[06/16/93 public]
As soon as we decide where pthread_exc.h should reside I'll take care of 
this bug or reassign it to dave weisman. I believe there are other includes
of dce/pthread_exc.h in addition to the one in stubbase.h that are
affected.

[9/7/93]
pthread_exc.h will stay in the dce subdirectory so the #include in stubbase.h
is correct.



CR Number                     : 7857
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : i486
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : ctrl-c aborts next cmd too in rgy_edit
Reported Date                 : 5/3/93
Found in Baseline             : 1.0.2
Found Date                    : 5/3/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[5/3/93 public]

The control c operation during rgy_edit session is not working properly.
Invoked rgy_edit and during add operation entered control c and return.
rgy_edit came back with an error message and prompt. At prompt, any
commands entered after the above scenerio doesn't work; i.e. rgy_edit
comes back ok without performing that operation.

On PMAX
-------
root@ice  # dce_login cell_admin -dce-
Password must be changed!
root@ice  # rgy_edit                                        
Current site is: registry server at /.../freedom/subsys/dce/sec/master 
rgy_edit=> add tester
Enter account group [gname]: 
?(rgy_edit) ADD command aborted - Required input not found (Registry
Editor/TTY Interface) (dce / sad)
rgy_edit=> do p  		(domain did not changed to principal)
rgy_edit=> do
Current domain is: account


On RIOS
-------
# rgy_edit
Current site is: registry server at /.../freedom/subsys/dce/sec/repl1
(read-only)
rgy_edit=> site -u   
Site changed to: registry server at /.../freedom/subsys/dce/sec/master 
rgy_edit=> do a
Domain changed to: account
rgy_edit=> add osf
Enter account group [gname]: ^C
?(rgy_edit) Unable to add account " - Group name contains an illegal
character (Registry Edit Kernel) (dce / sad)
Do you wish to try again  [y/n]? (n) 
rgy_edit=> add tester		(account tester didn't get created)
rgy_edit=>

[5/3/93 public]
Fixed short description so you can tell what's wrong from just that (the
summary reports we get daily contain just the short description).  Control-c
is working, contrary to what the original description said.  The problem is
that it's aborting the next command too (ie: the TRY/CATCH macros in the cmd
processor catching it twice?)

[7/12/93 public]

This problem is reproducible on 486 hardware platform running osf1.
Changed HW Ref Platform to i486 from pmax.

rgy_edit=> do
Current domain is: account
rgy_edit=> add tester
Enter account group [gname]: 
?(rgy_edit) ADD command aborted - 17083078
rgy_edit=> do p
rgy_edit=> do
Current domain is: account

[8/2/93 public]

Changed owner to mob.

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.



CR Number                     : 7845
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : bakserver
Short Description             : dumpinfo only displays last dump
Reported Date                 : 4/29/93
Found in Baseline             : 1.0.2
Found Date                    : 4/29/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : open

[4/29/93 public]
I did several dumps of the filesets in my cell using bak dump. After the dumps,
I tried to do a bak dumpinfo but it only displays the entry for the last dump 
that was done in the cell. 
I also noticed when doing the dump that I got the following messages. It appears
the bakserver has lost the information for the previous dumps.
No parent dump Flintstone.incr, looking for a higher-level dump
No parent dump Flintstone.full, looking for a higher-level dump
Doing level 0 dump due to missing higher-level dumps
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `jaffe@transarc.com' 
Added field #Transarc Status with value `open'

[5/3/93 public]
Changed Responsible Engr. from `jaffe@transarc.com' to `vijay@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `open'

[5/3/93 public]
Are you sure you are using different tapes for each of those dumps you did.
When a tape is reused for a dump, the dump that is already on tape is
removed from the database before the new dump is put on it. The dumpID is
stored in the tape label and this is how butc knows which dump to delete from
the database. When doing the incremental dump, try doing it on a different
tape. If you really want to do more than one dump onto the same tape without
removing the dump entry from the database, do a tar on the tape in between
the full and incremental dumps. This tar overwrites the tape label, and the
incremental dump that follows does not recognize the tape label and proceeds
without deleting any dump entry.

[5/3/93 public]
Well, I have been using the same tape to do multiple dumps. I have been doing
a "bak labeltape" with a Null label between dumps - doesn't this delete the
dump ID? It seems like it should.  I tried what you suggested (doing a tar 
in between dumps) and I was able to get more than one level of dump so I 
guess this defect may be cancelled.
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `' 
Added field #Transarc Status with value `'

[5/4/93 public]
Yes, a labeltape also removes the dump from the database if the tape holds one.
Once a tape holding a valid dump gets overwritten (labeltape, dump), the dump
is first removed and then the overwriting process proceeds. I'll go ahead and
cancel this defect.
Changed Status from `open' to `cancel'



CR Number                     : 7831
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7720, 8003
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfs
Short Description             : ACL for files created by unauth users is wrong
Reported Date                 : 4/29/93
Found in Baseline             : 1.0.2
Found Date                    : 4/29/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : sshi!ibm.com
Transarc Status               : open

[4/29/93 public]
The following problems exist for files created by unauthenticated 
users:
1.A foreign_other entry was added in the ACL.       
2.Defaul cell name is bogus.
The log attached illustrates the problem:

[sshi@kazuko]>klist | grep principal
Default principal: hosts/kazuko.austin.ibm.com/self@shepherd.cell.austin.ibm.c
om

[sshi@kazuko]>touch foounauth

[sshi@kazuko]>acl_edit foounauth -l
/*********** ************ *****/
Unknown default cell from ACL - ERROR: Cell UUID is not a valid cell name (dce
 / sec)
INFO: Local cell will be used for operations requiring default cell info.
# SEC_ACL for foounauth:
/********************** *****/
# Default cell = fffffffd0000.00.00.00.00.00.00.00.00
user_obj:rw-c--
group_obj:rw----
other_obj:rw----
/***************************/
foreign_other:/.../shepherd.cell.austin.ibm.com:rw----
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `sshi!ibm.com' 
Added field Transarc Status with value `open'

[5/4/93 public]
Add myself to CC list.
Filled in Interest List CC with `rajesh@transarc.com'

[5/10/93 public]
Rajesh,
Are you still planning to use the same default cell id (-3) or will
invent something different? You have addressed the reason why there 
is an foreign_other entry last week. So it is not a real problem now. 
Thanks...
Shepherd
--------
Changed Reported by from `lhughes@transarc.com' to `sshi@ausvm1.vnet.ibm.com' 
Changed Responsible Engr. from `lhughes@transarc.com' to `rajesh@transarc.com'

[5/12/93 public]
During last week's conference call, we decided to go with -2 if my memory
serves right. Please correct if this is not so. 
Delta cburnett-ot7720-change-anon-to-minus-3 changes the -2 to -3. I
have sent mail to Carl requesting that we "unexport" that delta. Once
that has been done, the issues raised in this OT will have been
resolved and we can close/cancel this one. Will update the OT appropriately
when I get Carl's response.
Filled in Inter-dependent CRs with `7720'

[rajesh@transarc.com 5/17/93 public] 
Carl created an anti delta for ot 7720 under ot 8003. Hence this OT
should really be marked as dup of 8003. But since that cannot be done,
I am cancelling this one.
Changed Inter-dependent CRs from `7720' to `7720, 8003' 
Changed Status from `open' to `cancel'



CR Number                     : 7830
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfs
Short Description             : ACL id permission bits were not inherited correctly
Reported Date                 : 4/29/93
Found in Baseline             : 1.0.2
Found Date                    : 4/29/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : sshi!ibm.com
Transarc Status               : closed

[4/29/93 public]
Permissions bits id were not inherited from the parent directroy for a
file object. According to the latest admin guide:
> The control, insert and delete permissions for the file's user_obj 
> entry are copied directly from the user_obj entry of the parent's
> initial Object Creation ACL. 
However, Rajesh mentioned that id permissions do not apply to a file
object, which I aggreed. In this case, the user should not be allowed
to specify id permission bits for io entry. The admin guide should
reflect this change too. 
The following log illustrates the problem
---------------------------------------------------------------------

 [sshi@kazuko]>klist | grep principal
Default principal: cell_admin@shepherd.cell.austin.ibm.com

 [sshi@kazuko]>pwd
/.:/fs

 [sshi@kazuko]>acl_edit /.:/fs -l
# SEC_ACL for /.:/fs:
# Default cell = /.../shepherd.cell.austin.ibm.com
user_obj:rwxcid
group_obj:rwx-id
other_obj:rwx-id

 [sshi@kazuko]>acl_edit /.:/fs -ic -l
# Initial SEC_ACL for directories created under: /.:/fs:
# Default cell = /.../shepherd.cell.austin.ibm.com
user_obj:rwxcid
group_obj:rwx-id
other_obj:rwx-id

 [sshi@kazuko]>acl_edit /.:/fs -io -l
# Initial SEC_ACL for objects created under: /.:/fs:
# Default cell = /.../shepherd.cell.austin.ibm.com
user_obj:rwxcid
group_obj:rwx-id
other_obj:rwx-id

 [sshi@kazuko]>touch foo

 [sshi@kazuko]>acl_edit foo -l
# SEC_ACL for foo:
# Default cell = /.../shepherd.cell.austin.ibm.com
user_obj:rw-c--
group_obj:rw----
other_obj:rw----
Shepherd Shi
------------
be allowed to specify 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `sshi!ibm.com' 
Added field Transarc Status with value `open'

[5/4/93 public]
I talked with senior developers here and the train of thought is that
even though the id bits are meaningless for files now, they could be
used for other user/system defined semantics.
Hence, we should advise users that they should not set id bits on
files or initial object ACLS. That way the id bits would never appear
in any inherited ACL and hence never in the system. But if the users
do explicitly set the id bits for a file/initial object ACL, then neither
should we generate a hard error nor do anything special in the
code to strip off the id bits.
Comments are appreciated.
Filled in Interest List CC with `rajesh, ota, cfe'

[5/6/93 public]

[5/10/93 public]
>Hence, we should advise users that they should not set id bits on
>files or initial object ACLS. That way the id bits would never appear
>in any inherited ACL and hence never in the system. But if the users
>do explicitly set the id bits for a file/initial object ACL, then neither
>should we generate a hard error nor do anything special in the
>code to strip off the id bits.
I agree with your suggestions. Please correct the code which strip off
id bits...
Shepherd
---------
 
Changed Reported by from `lhughes@transarc.com' to `sshi@ausvm1.vnet.ibm.com' 
Changed Reported by Company from `tarc' to `ibm' 
Changed Responsible Engr. from `lhughes@transarc.com' to `rajesh@transarc.com'

[5/11/93 public]
Actually, the code right now does not do anything special to strip off
id bits for files. I regression tested this feature in dfs-102-2.10 +
deltas rajesh-db3330-correct-permission-listed-in-dummy-io-acls and
rajesh-db3333-umask-and-acls. The log of operations performed is
attached below.
As a result I have downgraded the Priority/ Severity. Since this has a
potential doc impact I have added Jeff K. to the CC list.
Shepherd, let me know if you find the id bits being explicitly stripped
of for files. If you find it to be working correctly, we should cancel this
one.
Log: 
# pwd
/.../bugacl/fs/rajesh
# ls -l
total 0
-rw-r--r--   1 rajesh   system         0 May 11 17:34 a
# acl_edit a -n
sec_acl_edit> l
# SEC_ACL for a:
# Default cell = /.../bugacl
user_obj:rw-c--
group_obj:r-----
other_obj:r-----
sec_acl_edit> m user_obj:rwcid
sec_acl_edit> l
# SEC_ACL for a:
# Default cell = /.../bugacl
user_obj:rw-cid
group_obj:r-----
other_obj:r-----
sec_acl_edit> m other_obj:rwxid
sec_acl_edit> l
# SEC_ACL for a:
# Default cell = /.../bugacl
user_obj:rw-cid
group_obj:r-----
other_obj:rwx-id
sec_acl_edit> m group_obj:rid
sec_acl_edit> l
# SEC_ACL for a:
# Default cell = /.../bugacl
user_obj:rw-cid
group_obj:r---id
other_obj:rwx-id
sec_acl_edit> exit
# acl_edit a -l
# SEC_ACL for a:
# Default cell = /.../bugacl
user_obj:rw-cid
group_obj:r---id
other_obj:rwx-id
# mkdir d
# acl_edit d -io -l
# Initial SEC_ACL for objects created under: d:
# Default cell = /.../bugacl
user_obj:rwxc--
group_obj:r-x---
other_obj:r-x---
# acl_edit d -io -n
sec_acl_edit> l
# Initial SEC_ACL for objects created under: d:
# Default cell = /.../bugacl
user_obj:rwxc--
group_obj:r-x---
other_obj:r-x---
sec_acl_edit> m user_obj:rwxcid
sec_acl_edit> m group_obj:rwxcid
sec_acl_edit> m other_obj:rwxcid
sec_acl_edit> co
sec_acl_edit> exit
# acl_edit d -io -l
# Initial SEC_ACL for objects created under: d:
# Default cell = /.../bugacl
user_obj:rwxcid
group_obj:rwxcid
other_obj:rwxcid
# pwd
/.../bugacl/fs/rajesh
# ls -l
total 2
-rw-r--rwx   1 rajesh   system         0 May 11 17:34 a
drwxr-xr-x   2 rajesh   system       256 May 11 17:38 d
# touch d/f		<<<<< creates file with 0666 mode
# acl_edit d/f -l
# SEC_ACL for d/f:
# Default cell = /.../bugacl
user_obj:rw-cid
group_obj:rw-cid
other_obj:rw-cid
# acl_edit d/f			<<<< modify acl again to test robustness
sec_acl_edit> l
# SEC_ACL for d/f:
# Default cell = /.../bugacl
user_obj:rw-cid
group_obj:rw-cid
other_obj:rw-cid
sec_acl_edit> m user:ravi:rid
sec_acl_edit> l
# SEC_ACL for d/f:
# Default cell = /.../bugacl
mask_obj:rw-cid
user_obj:rw-cid
user:ravi:r---id
group_obj:rw-cid
other_obj:rw-cid
sec_acl_edit> co
sec_acl_edit> exit
# acl_edit d/f -l
# SEC_ACL for d/f:
# Default cell = /.../bugacl
mask_obj:rw-cid
user_obj:rw-cid
user:ravi:r---id
group_obj:rw-cid
other_obj:rw-cid
#
Changed Interest List CC from `rajesh, ota, cfe' to `rajesh, ota, cfe, 
 jeff@transarc.com' 
Changed Severity from `B' to `C' 
Changed Priority from `1' to `3'

[5/12/93 public]
Some more interesting data that shows things are working as they should.
Try acl inheritance for files when no "w" but with "id" and when
the file mode do not specify w.

 [rajesh] dce_login rajesh rajesh



CR Number                     : 7823
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : rgy_edit exits w/fatal err trying to add org alias
Reported Date                 : 4/28/93
Found in Baseline             : 1.0.2
Found Date                    : 4/28/93
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : client/admin/rgy_edit/tty_pgo.c
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[4/28/93 public]
I ran this on an older version of 1.0.2 (about a month old, but I don't
remember the number exactly), but someone here tried it on the "latest" and
got exactly the same results.  To reproduce, start rgy_edit (I was logged
in as cell_admin) and then enter the following:

  rgy_edit=> do org
  Domain changed to: org
  rgy_edit=> add blah 8 -al

rgy_edit will exit without a core file, with the following message:

FAULT 0x17083004 at line 8496 of file ../../../../../../src/security/client/admin/rgy_edit/ek_db.c

[5/5/93 public]
Fixed the short description so the summary reports are more informative.
The problem is that it should be checking this before it gets to that point
and letting you know that you can't add an alias in the org domain.  Since
there is a workaround ("don't do that because it's unsupported behavior") I've
downgraded it from 'A' to 'B'.

[5/6/93 public]
Not reproducible on HPUX.  I get: 
rgy_edit=> add blah 8 -al
?(rgy_edit) "-al" - Option not valid in org domain

Please try this again on both RIOS and PMAX and let me know what happens on
each.  Our PMAX hasn't had a build on it in months and our RIOS has been
hanging and not coming back up cleanly many times today so I can't test it
on either of those platforms at the moment.

[5/6/93 public]
Oops, never mind.  I went back to exit emacs and saw the problem as it
disappeared off the screen.  This will be fixed for 1.0.3 as requested.
For those that want the fix for their own use, change the following line
in routine tty_do_add_pgo() in client/admin/rgy_edit/tty_pgo.c
<         if ((domain == eif_domain_person) || (domain = eif_domain_group)) {
---
>         if ((domain == eif_domain_person) || (domain == eif_domain_group)) {
Again, the workaround for the above problem (until you make the fix) is don't
do that because it's not supported.

[7/27/94 public]
This CR either does not affect dcecp or has a related CR open.
It really belongs to rgy_edit and should not be assigned to dcecp.

[8/1/94 public]
All control program bugs are being changed to E4 due to the existance
of dcecp.

[8/26/94 public]
The fix mentioned in the above note [burati 5/6/93] should have been made 
in the routine tty_do_change_pgo() in addition to tty_do_add_pgo().  There
were 2 occurrences of this error in tty_pgo.c.  Only the fix to
tty_do_add_pgo() has made it into the DCE 1.1 source.  For the Sequent
port of DCE 1.0.3, we intermittently get the following error during 
dce_config:

	Are you using multiple LAN's within this cell? (n)

ERROR:  rgy_edit error while adding entries for CDS to the registry
database.
 Message from rgy_edit:
 FAULT 0x17083007 at line 8251 of
  ../../src/security/client/admin/rgy_edit/ek_db.c

We have also fixed the following bug in the function ek_init_op() in
the file ek_db.c:

    case ekn_mem_add_group_member:
    case ekn_mem_add_org_member:
    case ekn_mem_del_group_member:
    case ekn_mem_del_org_member:
        form_clear(clear_op->op_form);
FIX-->  break;

    case ekn_policy_get:
    case ekn_policy_get_effective:
    case ekn_policy_set:
        form_clear(clear_op->op_form);
        break;

     .....

The break statement is missing where indicated and so the form_clear(...)
function is executed twice in certain cases.



CR Number                     : 7803
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : acl entries unthreaded incorrectly
Reported Date                 : 4/26/93
Found in Baseline             : 1.0.2
Found Date                    : 4/26/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[4/26/93 public]
The invalidate acl user function leaves the acl entries in the vnode's
queue, which it shouldn't.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[6/1/93 public]
This bug turned out to be a porting bug to SUNOS, which mike originally
thought was an acl bug.  Its not, so its canceled.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 7802
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDS database is getting corrupted
via object deletes, resulting in nameserverbug being returned from cdsd.
Reported Date                 : 4/26/93
Found in Baseline             : 1.0.2b22
Found Date                    : 4/26/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/26/93 public]
Our Customer Environment Test (CET) lab has been running into a problem where
when a directory is attempted to be deleted, a "Software Error Detected in
Server" message comes back.  This directory has objects created under it (
usually only one, an RPC server entry) that do not appear to be there any
more due to a cdscp delete operation (the object will not show during a list
operation).  

Upon getting into cdsd via dbx, I noticed that the routine find_entry_pos() 
is returning a position that db_btree_locate_entry_bkt() doesn't like.  The 
node_header record gives a node_count of 1 and the position coming back is 1.  
This condition causes db_btree_locate_entry_bkt() to dereference the 
node_next_p pointer, only to find that it is null.

This generates the nameserverbug error condition.  Upon talking with Alan
Peckham he feels the dummy name (sentinal) is getting stomped.  He and Dave
Griffin have discussed the problem.  I have instructed CET to immediately save
any checkpoint and tlog files the minute this problem occures.  I will then
use cdsdb_dump to check out the operations that have taken place against the
directory in question.

[09/22/93 public]
I can't make this happen. Is it still a problem? Can I get a test case
that reproduces it.

[09/27/93 public]
Not reproducable. cancelled.

[jd 09/28/93 public] 
Set status to cancel...



CR Number                     : 7790
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : RPC API rpc_binding_set_auth_info()
Short Description             : incorrect status code.
Reported Date                 : 4/23/93
Found in Baseline             : 1.0.2
Found Date                    : 4/23/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/23/93 public]
        We found this problem on RIOS with RPC Validation software, while
        testing RPC API with a recent DCE build.

        When rpc_binding_set_auth_info() is supplied with an unregistered
        server principal name and a valid server binding handle, it returns
        with the status "sec_rgy_object_not_found" in stead of
        KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN. This test returns the correct status
	code KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN on Pmax with the latest build.
	This test used to work on RIOS until Feb 93 with the correct status code
	KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN.

[9/27/93 public]

Is this still happening? I got the KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN status
on HP-UX using both 1.0.2 and 1.0.3 based builds (running the perf test).
Since I can't test it on RIOS, could you try it again on 1.0.3 based build.

[9/30/93 public]

If there is no new info, I'll cancel this CR.


I ran the RPC VTS API tests on 9/29/93 and did not see this 
error.

[10/1/93 public]

Not happening anymore.



CR Number                     : 7789
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_key_() APIs should accept same 
authn_services as RPC
Reported Date                 : 4/23/93
Found in Baseline             : 1.0.2
Found Date                    : 4/23/93
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/23/93 public]
According to the manpages, the sec_key_mgmt...() calls that have an
authn_service argument will accept only rpc_c_authn_dce_secret or
rpc_c_authn_dce_public (future) values.  Why not the other values defined
in rpcbase.idl, especially rpc_c_authn_default?

Application developers who want the consistency of using rpc_c_authn_default
throughout their code are going to be unhappy.

[07/18/94 public]
The sec_key_mgmt API's generally take two parameters:
	key type
	pointer to key data
If you think of the type/data-pointer as a union, then you see that it
is more-or-less impossible to use rpc_c_authn_default:  you must explicitly
specify which type of key you are using (want to modify).

I think this should be cancelled.

[7/18/94 public]
Ok...

[7/18/94 public]
Yeah, I know... this is 'just' a usability issue.

I'm still not clear on why rpc_c_authn_default can't (shouldn't)
be mapped under the covers to whatever the default is.  Why can 
the programmer use this abstraction in one part of DCE and not another?

[07/19/94 public]
You can't use rpc_c_authn_default because you need to know explicitly
what *type* of key you are sending/receiving so that you can decode the
sec_passwd_rec_t.

Suppose in a future release, DCE 2.x, rpc_c_authn_default changed from
private to public key.  All your code would now still compile, but it
would be totally bogus.

[7/19/94 public]
Ditto what Rich says...  The authn_default is mainly so you can say to just use
whatever authentication method is the default for what you're currently doing.
When you store a key using the key management functions, you are storing a
specific type of key, to be used for a specific purpose and a specific authn,
you can't just let it pick for you.

[07/20/94 public]
Ok, got it.  Thanks guys.



CR Number                     : 7786
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : ftserver
Short Description             : comm failure on fts rename
Reported Date                 : 4/22/93
Found in Baseline             : 1.0.2
Found Date                    : 4/22/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[4/22/93 public]
This ot is a carryforward from 7475.  I'm including the appropriate info from 
that defect:
 gmd 4/21/93 public]
  root@dce12> fts rename -oldname epi.3 -newname epi.4
  [Failed to revert one or more names on filesets: communications failure (dce / rpc)]
  Error in rename: communications failure (dce / rpc)
  
  This is a 102a build (available 4/20/93). 3 pmax cell, 3 flservers, root.dfs in
  lfs (replicated root.dfs).
  There is nothing in the /usr/adm/messages or var/dfs/adm/*Log files near the
  time of this comm failure. I have dfstrace dumps taken immediately after
  this on all 3 machines. They are in ~notuser/gmd and named:
  7475.valentine.dump (root.dfs server)
  7475.dce5.dump (epi.3 server)
  7475.dce12.dump (dce12.u3 ufs server + core server + machine where fts rename
  command issued)
 
 tu@transarc.com 4/21/93 public]
  I read your all three traces mentioned above and there is not that much 
  info in them. By looking at error messages, it seems that fts could not talk
  to the ftserver.  I also confirmed this with Craig. 
                                                                       
  Have you checked whether your ftserver is still up ? If the ftserver is 
  still up, then it would be a rpc comm failure under a different situation.
  That is, it is not between fx server and CM.
 
 gmd 4/21/93 public]
  The ftservers' last restarts were all ~20 minutes before the comm failure. Your
  comment implies that the "comm failure" is therefore a different problem -
  Should I log the new CR with you, Tu, as responsible engineer?
 
I've set this a priority 2, because we do not have enough information to 
understand what happened.  Please collect the following info should this
occur again:
 
  icl dump (kill -30) of the ftserver where is fileset resides.
  icl dump (kill -30) of all flservers in the cell.
  dfstrace dump of the server where the fileset resides.
 
Hopefully, this will give us enough info to deduce what is happening.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[4/22/93 public]
The output from this fts command is consistent with the ftserver on the
machine housing epi.3 simply not being up at all.  As to why it wasn't
responding to RPC requests, I'd have no idea--if indeed it was still up
when you tried the command.  You might use some command that talks only
to an ftserver, such as ``fts statft /.:/hosts/valentine'', to tell.

[05/20/93]

We'll be investigating this.

[10/8/93]

Aged relative to Aug 1.

[1/11/94 public]
Cancelling.  I ran a script that changed the name of a fileset 
back and forth between two names.  It changed the name ~50 times 
successfully until I shot the ftserver.  I got the error shown 
above (expected behavior).  I restarted the ftserver and the script 
picked up again where it left off.  After another ~50 renames,
I killed the script, ran cm checkfilesets and was able to access
the fileset through the mount point.

This gets tested in the fts tests anyway.



CR Number                     : 7785
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : krpc
Short Description             : call timeout and communication failure in cmfx.
Reported Date                 : 4/22/93
Found in Baseline             : 1.0.2
Found Date                    : 4/22/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[4/22/93 public]
This ot report is a continuation of 7475 with clearer direction.
The symptoms are:
  A) The cache manager returns ETIMEDOUT on file system access.
  B) Either:		"cm checkservers" shows all servers up and access is
			now successful.
     Or:		After some amount of time (we've seen up to 80 minutes,
			The cm shows the server as coming back up, at which
			point access is now successful.
  C) The dfstrace output shows either 
	   382312556 call timed out (dce / rpc)
	or 
	   382312470 communications failure (dce / rpc)
	as the result of an RPC call (usually from AFS_GetTime).
Potential culprits in this failure are:
  1) The RPC subsystem has failed to correctly handle the RPC.
  2) The DFS protocol is such that occasional long pauses occur.
	Its possible that a potential token management issue might cause 
	this problem, but we need more information in order to track it down.
When you suspect this problem, we need the following information:
  "dfstrace dump" logs from the client where the failure occured, and all
	servers that it was accessing.
  icl dumps from the user level dfsbind on the client.
  icl dumps from the flservers and potentially the ftservers in the cell.
I realize that this is a lot of information, but since we have no clear
culprit, I'de rather err on the side of too much information than too little. 
Please open a new ot for user level comm failures in dfs processes.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[5/18/93 public]
Timeout problems are still being seen with dfs.carl. Correcting severity and
priority.

[5/19/93 public]
Elliot - reread your instructions and I have one question: can you do a
"kill -30" of the ftserver pid for an icl dump of an ftserver or is there
some other method?

[5/19/93 public]
Yes, you can kill -30 the ftserver process and it will do the dump

[05/20/93 public]

We are going to look at this here.

[6/1/93 public]
Dropping this to a priority 1 - unclear whether this is gone or just blocked
by other problems.

[06/11/93 public]

just noting that this is still a problem even with the latest dfs.

# dfs: Warning: the rpc call to server 130.105.5.78 in cell leprosy timed out.
dfs: comm failure/set context (code 382312556)
dfs: lost contact with the fx server 130.105.5.78 in cell leprosy
dfs: comm failure/set context (code 382312556)
dfs: lost contact with the fx server 130.105.5.78 in cell leprosy
dfs: comm failure/set context (code 382312556)
dfs: lost contact with the fx server 130.105.5.78 in cell leprosy
dfs: Warning: the rpc call to server 130.105.5.3 in cell leprosy timed out.
dfs: Warning: the rpc call to server 130.105.5.3 in cell leprosy timed out.
dfs: Warning: the rpc call to server 130.105.5.3 in cell leprosy timed out.
dfs: Warning: the rpc call to server 130.105.5.3 in cell leprosy timed out.

[06/18/93 public]

more data:

We have a dfsbind trace log from around the time where we hit a set context
failure and it shows that infrequently do_auth_request can take more than
30 seconds to complete:

time 804.901110, pid 8: do_auth_request: entry 
time 844.411285, pid 8: do_auth_request: exit code:0  


time 382.820110, pid 11: do_auth_request: entry 
time 641.690084, pid 11: do_auth_request: exit code:0  


time 961.831674, pid 7: do_auth_request: entry 
time 12.790498, pid 7: do_auth_request: exit code:0  


time 661.979857, pid 8: do_auth_request: entry 
time 747.667597, pid 8: do_auth_request: exit code:0

[07/07/93 public]

Many of the problems we were seeing were due to insufficient physical
memory in our dfs servers.  The recommended memory size is 32 meg and
we were running with 16 meg rios servers.  Upgrading to 32 meg servers
greatly lessened the severity of this problem.



CR Number                     : 7777
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : rpc_server_register_if() API
Short Description             : input parameter is being modified
upon a successful return.
Reported Date                 : 4/21/93
Found in Baseline             : 1.0.2
Found Date                    : 4/21/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/21/93 public]
        We found this problem on RIOS with RPC Validation software, while
        testing RPC API with latest weekly DCE build.

        rpc_server_register_if() modifies the value of the input parameter
        mgr_type_uuid when invoked, upon successful return. This happens
	with a nil or a generated uuid is supplied for this parameter.

[4/30/93 public]
	Cancelling this bug. Intermediate failures are gone with the latest
	dce build.

[8/13/93 public]
not reproducible.



CR Number                     : 7775
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : xvolume
Short Description             : afscall_volser is too big
Reported Date                 : 4/21/93
Found in Baseline             : 1.0.2
Found Date                    : 4/21/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : vol_init.c
Sensitivity                   : public
Transarc Status               : 
Transarc Deltas               : 
Transarc Herder               : 

[4/21/93 public]
I observed that afscall_volser() generates a lot of code.
I tried to just invoke the VOLCHECK() macro in fewer places,
in the obvious way, by just invoking once before the switch 
statement instead of in most of the cases of the switch statement.
This cut the binary size on HPUX from 16+KBytes to less than
12KBytes, for a savings of 4+KBytes.  When you guys get to it...

[6/21/93 public]
This is an enhancment, since the code works just fine as it stands.
We'll try and get this one in 1.0.3
Changed Defect or Enhancement? from `def' to `enh' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[6/23/93 public]
Changed Responsible Engr. from `jaffe' to `kazar@transarc.com'

[1/20/94 public]
I did this as part of some other work, but neglected to tag it in this
OT report.  The OSF should have the code that does this.

[1/20/94 public]
Changed Status from `open' to `cancel'



CR Number                     : 7772
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : Leaks when setting-up/refreshing login identity
Reported Date                 : 4/21/93
Found in Baseline             : 1.0.1
Found Date                    : 4/15/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[4/21/93 public]
While debugging memory leaks in the DFS ftserver some security-related
leaks were found.  When preparing for a fileset move, the ftserver
establishes a login context in order to talk to another ftserver.
I've included some rough memory usage numbers (from ps output).
After calling each of the following routines, memory usage has
increased by the specified amount:
        sec_login_setup_identity:       112k
        sec_login_valid_from_keytable:  56k
        rpc_binding_set_auth_info:      20k
Are these numbers reasonable?  I guess I could be convinced that they
were an expected one-time cost; however, on subsequent move requests,
the ftserver refreshes its login context, causing even more memory to
be allocated:
        sec_login_refresh_identity:     28k
        sec_login_valid_from_keytable:  12k
The second set of numbers are actually more troublesome, since the
growth occurs each time a fileset is moved (actually, twice each time).

[4/21/93 public]
Changed Interest List CC from `jaffe@transarc.com' to `jaffe@transarc.com, 
 cfe@transarc.com'

[4/21/93 public]
Uhh.  Just because I don't get around to answering a query by mail doesn't
mean that it's an A1 bug.  Priority dropped because there's a workaround
(restart your ftservers when they get too big; don't refresh the login
context unless it needs it..)
There is significant caching in RPC and security which will not reach
steady state until after 15-20 minutes or so; as a result, it makes much
more sense to recycle existing login contexts, and to defer doing login
context refreshes, until they're actually needed.  I don't know what kind
of ticket lifetimes you're using in the servers, but you should only
refresh if you don't have enough lifetime to be certain of completing the
transaction.
Note that long-running RPC's in progress at the time of expiration will
continue to completion; expiration is only checked at the start of a call.

[4/21/93 public]
Changed Interest List CC from `jaffe@transarc.com, cfe@transarc.com' to 
 `jaffe@transarc.com, cfe@transarc.com,demail1!carl' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[10/20/93 public]
 
Not really a P1 bug.  I haven't had a chance to determine whether this is a
real bug or whether they're just not using the security services correctly.
as they aren't beating my door down looking for a bug fix to this, I have
to assume it can be deferred to 1.1 ...

[04/12/95 public]
One and half year after the last update to this ot ...

IBM ghas sent in some new information regarding to this problem. They use 
DCE 1.0.3 on RS/6000. This is important for them:

When making security API calls to sec_login_*() to setup, validate and purge
an identity in a tight loop (ie one set of these calls per 10 seconds or
less), the process grows by about 10k per loop.  If the program slows down for
about a minute, some of the growth is recouped, but under constant load, the
process continues to grow indefinitely.  This is causing the DCE Application
server to run out of memory (and pretty quickly!).

Repeat By:

main() {
    while(1) {
        sec_login_setup_identity();
        sec_login_validate_identity();
        sec_login_purge_context();
    }
}

You will see that the process grows very fast.

Proposed Solution:

We have no solution.  But:

the RPC auth_info cache (comauth.c) never makes a hit on the cache lookup.
the auth_identity field is never matched.  This is because the calls to
sec_login_setup_identity() and sec_login)certify_identity() malloc new
memory for the login_context that is passed in before doing the auth_info
lookup.  Therefore, the auth_identity field of the auth_info structure
(which is actually a cast of the krb_info structure) will never match anything
in the cache, because part of the lookup key is newly malloc'ed memory, and
it is comparing structure addresses.  When a cache lookup fails, the RPC
runtime assumes that the info is not in the cache, and should be in it, so
it adds the new auth_info structure to the cache.  Since no hits are being
made, the cache grows linearly on each lookup call.

We tried disabling the cache altogether.  We figured since the cache was never
registering a hit, and a call was always being made to the DCE security service
anyways, if we eliminated the cache we would not encounter a performance hit
(it actually should be faster, since the failed cache lookup is avoided), and
the leak would go away.  This was not so.  When we bypassed the auth_info cache,
The process still grew at the same rate.  The culprit now was the krb_info_t
structure.  This structure is a field of the sec_login_context_t
structure, and is used by the RPC runtime also.  It is very hard to keep
track of this structure, because it is cast to different types in different
components.  It appears that there is a reference count on the sec_login_context
_t, as well as a reference count on the rpc_auth_info_t structure
and these counts are never being sent back down to 0 when repeated calls to
the DCE security API are made.  There is definitely a correlation between these
two structures, but it is not clear what it is.

[04/12/95 public]
I worked with Paul Highley @ IBM on this a few months ago and
thought I had demonstrated that this apparent leak was a result
of rpc holding onto connection info, which references auth info,
keeping login contexts alive for a while after they're purged.
The numbers at 1.0.3 were 5-minute thread wakeups and 10-minute
timeouts; after inserting a >15m sleep outside a sample program's
for loop, the malloc space was freed.  If this isn't true on their
port, the problem report may be platform-specific...

[2/2/96 public]
The original report above was just confusion about what was occurring when
you executed those API calls.  The later information showed that there was
a leak refreshing/purging and the ilk...  During our 1.1 cleanup, we ran
extensive memory analysis runs over this stuff to get rid of the leaks and
believe that we got rid of the ones that were occurring on HPUX (as told to
us by Purify).  IBM has found some more with their analysis, that only occur
on AIX (because it's rpc_string_free() is not equivalent to free() as it is
on HPUX), and OTs with real info have been opened for those.  Since this OT
doesn't refer to a specific leak, but rather to what was a combination of
all those other leaks reported, I'm cancelling this report and we'll work
from the others.

[2/5/96 public]
We have a local bug tracking this problem. Any chance you know the
other OT numbers relevant to this problem?

[2/5/96 public]
Some subset (or all) of the following could cause memory leaks in a test
program like the one described above.  The reason for addressing those
instead of this more general report is that those have actual information
that we can use to track down the problem with.  Just knowing that something
grows does not mean there's a leak, given the number of caches and RPC contexts
that get set up during the above operations.  Knowing it grows without bound
because of a leak gives us something to go on.  Note that most of the OTs
I list below were opened by Gerry Thome at IBM.

13008 C 2 05/23/95 Mem leak in security API's
13007 C 2 10/10/94 rpc_binding_free misplaced in rca_rebind()
13005 C 3 06/16/95 mem leak rca_site_bind_nsi_cell_if()
13000 C 2 08/02/95 Inconsistent malloc()/free(), memory leakage
12976 C 2 07/25/95 Memory leak in krb5_free_last_req()
12975 C 2 07/25/95 rpc_mem_string memory leak( rca_setup_handle)
12970 C 2 07/25/95 memory leak in sec_login_validate_cert_auth()
12969 C 2 07/25/95 memory leak in sec_login_pvt_get_local_login_info()
12968 C 2 07/25/95 sec_rgy_site_close() leaks memory



CR Number                     : 7771
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : control
Short Description             : CDS_Ringpointer problems, it
frequently does not display, or shows wrong value
Reported Date                 : 4/21/93
Found in Baseline             : 1.0.2
Found Date                    : 4/21/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/21/93 public]

CDS_RingPointer is supposed to show the UUID of a clearinghouse containing
another replica of this directory when you do either a show directory or a
show replica.  After creating three clearinghouses on a single cell
machine, creating a directory in one, and replicas in the other two, I run
show dir and show rep with very inconsistent results.

On B22 code, the last time I ran it, CDS_RingPointer did not show up.  If I
specified the attribute, it showed as <empty set> in all three
clearinghouses.  On other tests, repeated calls of cdscp show dir have
intermittent results - sometimes the CDS_Ringpointer will show up, and
sometimes it will not.  

Several times cdscp show dir will result in the CDS_RingPointer displaying
the UUID of the clearinghouse in which the master exists, rather than the
UUID of a clearinghouse which holds a replica.  The cdscp show replica
calls then usually show a CDS_RingPointer of <empty set>

[8/20/93 public]
After some digging I believe the above described behavior is normal. The
CDSPI Technical Suplement says

CDS_RingPointer Used by CDS software. Esists only on the master replica of
                a directory. Coordinates the convergence of distrubuted 
                updates during a skulk. Contains the universal unique 
                identifier (UUID) of a clearinghouse.

Now, if I set cdscp confidence to high I always get a RingPointer. If
I set my preferred clearinghouse to the master replica of the directory
I'm showing I always get a RingPointer. If I set my preferred clearinghouse
to a read only replica of the directory I always get <empty set>. If I
set nither preferred clearinghouse nor confidence equal high I sometimes
get a RingPointer and I sometimes don't. But this is as it should be
because it will depend on whether the request was satisfied from the
master or a replica. 
Cancelled.



CR Number                     : 7757
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : Secd core dump.
Reported Date                 : 4/20/93
Found in Baseline             : 1.0.2
Found Date                    : 4/20/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/20/93 public]

This *might* be a secd problem or it may be a dup of a defered threads
bug, 2995. Ignore the cma__vo_interrupt line in the trace, it's a red
hearing. In fact it's only called from within code bracketed by 
_CMA_THREAD_IS_VP_ which is supposed to be , and is - I asked cpp, turned
off. The rest of the trace makes sense if secd took a SIGIOT==SIGABRT.
This is only done by the bug_check routine and is supposed to indicate
an internal cma error. We know from past experience however that a 
a call to cma__error with the cma kernel lock in hand will trigger
the bug check. The call to cma__error may have been the result of
a problem in the app. Ot 2995 addresses the bug check side affect.
The following trace occurred in a system test after 52 hours.
I'm not convinced this is a security bug, it probably a dup of 2995
but it might not be. I want to open this to let people look at the
data to see if any bells go off. If the bells are silent and it doesn't
present itself again any time soon we'll dup it to 2995. 



GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.5, Copyright 1992 Free Software Foundation, Inc.

OSF version 1.0 created Thu Dec  3 12:48:59 1992

..(no debugging symbols found)...
Core was generated by `secd'.
Program terminated with signal 6, IOT/Abort trap.
#0  0x73055b48 in _auxv ()
(gdb) b __start
Breakpoint 1 at 0x400000
(gdb) r
Starting program: /usr/ucb/secd

Breakpoint 1, 0x400000 in __start ()
(gdb) kill
Kill the inferior process? (y or n) y
In Local core dump file,
#0  0x73055b48 in kill ()
(gdb) bt
#0  0x73055b48 in kill ()
#1  0x73141ec8 in cma__abort_process ()
#2  0x7312416c in exc_raise ()
#3  0x731244ec in exc_pop_ctx ()
#4  0x7316ac38 in cma__thread_base ()
#5  0x7317a9c0 in cma__vp_interrupt ()
Cannot access memory at address 0x2bd226ed.
(gdb) info reg
zero(r0): 0; at(r1): 0xffffffff; v0(r2): 0; v1(r3): 0x1;
a0(r4): 0x12c; a1(r5): 0x6; a2(r6): 0x101fca18; a3(r7): 0;
t0(r8): 0x735308d0; t1(r9): 0; t2(r10): 0; t3(r11): 0;
t4(r12): 0; t5(r13): 0; t6(r14): 0; t7(r15): 0;
s0(r16): 0x12; s1(r17): 0; s2(r18): 0; s3(r19): 0;
s4(r20): 0; s5(r21): 0; s6(r22): 0; s7(r23): 0;
t8(r24): 0; t9(r25): 0; k0(r26): 0; k1(r27): 0x730558c4;
gp(r28): 0; sp(r29): 0x101fca40; s8(r30): 0x101fca60; ra(r31): 0x73141ec8;
sr: 0; lo: 0; hi: 0; bad: 0;
cause: 0; pc: 0x73055b48; fp: 0x101fca40; inx: 0; rand: 0; tlblo: 0;
ctxt: 0; tlbhi: 0; epc: 0; prid: 0;
(gdb) x/16i $pc-32
0x73055b28 <ioctl+20>:  lw $v1,3648($v1)
0x73055b2c <ioctl+24>:  nop
0x73055b30 <ioctl+28>:  jr $v1
0x73055b34 <ioctl+32>:  nop
0x73055b38 <ioctl+36>:  jr $ra
0x73055b3c <ioctl+40>:  nop
0x73055b40 <kill>:      li $v0,37
0x73055b44 <kill+4>:    syscall
0x73055b48 <kill+8>:    beq $a3,$zero,0x73055b64 <kill+36>
0x73055b4c <kill+12>:   nop
0x73055b50 <kill+16>:   lui $v1,29446
0x73055b54 <kill+20>:   lw $v1,3652($v1)
0x73055b58 <kill+24>:   nop
0x73055b5c <kill+28>:   jr $v1
0x73055b60 <kill+32>:   nop
0x73055b64 <kill+36>:   jr $ra

[4/20/93 public]

My guess here is that we're seeing an unhandled exception.

Did you see any output from secd on stdout?

Try adding rs_task_fatal to the list of things-to-set-breakpoints-in.

rs_task_fatal should just call abort rather than pthread_exit; if secd hits
a fatal error, it should blow up.

I think the only reason why this isn't the case was that on Domain/OS,
abort sometimes didn't kill the process if the process was inhibited (a
aegis-ism roughly comparable to having all signals blocked or all
interrupts disabled).

[4/20/93 public]
Changing State from open to defer for 1.0.3.

[8/9/93 public]

No one (including John) has seen this problem since it was opened.



CR Number                     : 7753
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : assertion failure block_alloc.c line 3125
Reported Date                 : 4/19/93
Found in Baseline             : 1.0.2b23
Found Date                    : 4/19/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[4/19/93 public]
I was trying to clean up some files left over from a low.moderate
run (via dfs) on a fileset which was previously healthy (at mount
time) and I hit the following assertion failure:
 
asstion failed line 3125 anode/block_alloc.c
 
siteDescOur
SAFS_RemoveDir+7d8
vrele+13c
xglue_inactive+4c
nosf_inactive+4c
efs_inactive+1e4
epif_ChangeLink+47c
epia_Truncate+564
epib_FreeFrags+460
 
  3118      BEGIN_LCRIT (struct elbb_buffer *buf,
  3119                   code = epix_GetBuffer (h->bitmap, p, &buf),
  3120                   code = elbb_Release (buf, elbb_lazy)) {
  3121          struct bitmapPage *page = (struct bitmapPage *) elbb_BufferData (buf);
  3122          u_long firstFrag;
  3123          u_long nFrags;
  3124
  3125          assert (BITMAP_PAGE_OK (page, h));
  3126          assert ((frags->block >= page->baseOffset) &&
  3127                  (frags->block < page->baseOffset + page->blocksPerPage));
  3128
  3129          firstFrag = (frags->block - page->baseOffset)*page->fragmentsPerBlock
+
  3130              frags->first + keep;
  3131          nFrags = frags->length-keep;
  3132
  3133          if (keep) {                     /* can't be empty if keeping any */
  3134              if (frags->length == h->fragmentsPerBlock)
  3135                  empty = -2;             /* signal to update logged map */
  3136              else empty = 0;
  3137          }
 
This is the fldb info for the fileset which caused the problem:
 
# fts lsfldb -server /.:/hosts/fire
m1.lfs2  
        readWrite   ID 0,,487  valid
        readOnly    ID 0,,1265  invalid
        backup      ID 0,,489  valid
number of sites: 1
   server           flags     aggr   siteAge principal      owner               
Error: communications failure (dce / rpc)
fire.osf.org        RW,BK    3       0:00:00 hosts/fire     <nil>

[4/19/93 public]
Changed Responsible Engr. from `jsk@transarc.com' to `ota@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[04/20/93 public]
I don't know what's going on here, but I got tired of this and newaggr'd
the aggregate, created a new fileset, and started copying a file tree there
and got yet another panic in block_alloc.c.  There are no disk errors
logged to the console to indicate that this might be a disk problem.
 
Here's what is probably another useless stack trace:
 
assertion failed line 2746  block_alloc.c
 
epia_Read + 1dd0 
epib_Allocate_5b4
 
  2743          BEGIN_CRIT (code = epix_GetBuffer (h->bitmap, p, &buf),
  2744                      code = elbb_Release (buf, elbb_lazy)) {
  2745              page = (struct bitmapPage *)elbb_BufferData(buf);
  2746              assert (BITMAP_PAGE_OK (page, h));
  2747              if (start == EPIX_ANODE_BLOCKEMPTY)
  2748                  start = page->baseOffset, wait = 0;
  2749
  2750              /* as long as everything is okay, keep looking for blocks */
  2751              while ((code == 0) && (b < nBlocks)) {
  2752

[4/20/93 public]
I assume that you newaggr'ed the aggregate before starting up DFS or
exporting the aggregate in a freshly-rebooted system.  Right?
Also, I expect that Ted will need some compressed version of the aggregate
data in order to debug this, but I'll defer to him to pick the right way
to get the bits packed up.

[4/20/93 public]
It would be important to have the aggregate if I am to find out exactly
what is going on.  However, it is clear that the disk is damaged.  Did
you run the salvager when this happened?  What did it say?  That might
go a long way to explaining the problem.
It also looks like the same error both times.  Are you sure the newaggr
really took effect on the aggregate in question?
Filled in Interest List CC with `cfe'

[5/18/93 public]
Assigning to diane.  We need the aggregate to make any more progress.
Changed Interest List CC from `cfe' to `cfe@transarc.com, ota@transarc.com' 
Changed Responsible Engr. from `ota@transarc.com' to `delgado'

[06/02/93 public]

We no longer have the aggregate which had this feature - cancelled.



CR Number                     : 7707
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : sec_admin
Short Description             : lrep sub-command only prints
partial name for Default replica when x.500 style cell name is used.
Reported Date                 : 4/13/93
Found in Baseline             : 1.0.2
Found Date                    : 4/13/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/13/93 public]

Using dce1.02-weekly builds this morning, configured a RIOS Master and
2 pmax slaves in a single cell using x.500 type name. Invoked sec_admin on 
rios master and got the following:

sec_admin> lrep
Default replica:  /.../c=us/o=bob_the_chefs
Default cell:     /.../c=us/o=bob_the_chefs


subsys/dce/sec/master (master)

subsys/dce/sec/repl1

subsys/dce/sec/repl2

sec_admin> site
Default replica:  /.../c=us/o=bob_the_chefs
Default cell:     /.../c=us/o=bob_the_chefs

[4/13/93 public]
This is not quite what I pictured from your description on the phone.
You said that when you do a lrep, you don't see the subsys/dce/sec/master
name in the list of replicas.  You did according to the above.  I assume
what you are complaining about is the "Default replica" label.  This has
nothing to do with the replica list command.  This is the name that the
sec_rgy_site_bind() call resolved to.  If you can resolve from the cell
name to /.:/cell-profile, then to /.:/sec, then to /.:/subsys/dce/sec/master
THEN you will see the full name for the  Default replica name.  Given
that all you see is the cellname, that means you couldn't resolve through
the namespace to /.../cellname/subsys/dce/sec/replica, so it used the cell
name that you gave it to get the bindings out of the pe_site file.  So,
the question is "Should you be able to resolve via NSI/CDS the name
/.../c=us/o=bob_the_chefs/cell-profile and similarly for /.../c=us/o=
bob_the_chefs/sec and /.../c=us/o=bob_the_chefs/subsys/dce/sec/master "???
If you can't do this with cdscp and rpccp, then you won't be able to resolve
bindings that way with sec_admin or rgy_edit, so try the naming tools first
to figure out what's wrong.

[4/13/93 public]

Mike, the rpccp show entry /.../c=us/o=bob_the_chefs/subsys/dce/sec/master
command worked ok. By forcing the site to master using sec_admin, it worked.

sec_admin> site /.: -u
Default replica:  /.../c=us/o=bob_the_chefs/subsys/dce/sec/master
Default cell:     /.../c=us/o=bob_the_chefs

sec_admin> lrep
Default replica:  /.../c=us/o=bob_the_chefs/subsys/dce/sec/master
Default cell:     /.../c=us/o=bob_the_chefs


subsys/dce/sec/master (master)

subsys/dce/sec/repl1

subsys/dce/sec/repl2

[4/14/93 public]
As I noted above, you must be able to bind through /.:/cell-profile and
/.:/sec to be able to see the full replica name.  Forcing it to an update
site is a different case, because it asks the server for it's name in that
case...  To make this easier, I've included the commands you'll need to try
in order to check what I talked about above:
site /.:/subsys/dce/sec/master
site /.:/sec
site /.:/cell-profile
site /.:
site /.../c=us/o=bob_the_chefs/subsys/dce/sec/master
site /.../c=us/o=bob_the_chefs/sec
site /.../c=us/o=bob_the_chefs/cell-profile
site /.../c=us/o=bob_the_chefs
and let us know which of these work.

[8/2/93 public]

Rajendra, is this *really* broken given Mike's latest instructions,
on any of the *current* reference platforms?  Please update this
bug or cancel.



CR Number                     : 7689
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : runtime
Short Description             : Protocol version mismatch
during cdscp create clearinghouse
Reported Date                 : 4/12/93
Found in Baseline             : 1.0.2
Found Date                    : 4/12/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/12/93 public]
A create clearinghouse generated the following:

cdscp> create clear /.:/os2dce06
(receive_packet) assoc->20134ad8 Protocol version mismatch - major->1
minor->5
Failure in routine: cp_create_clh; code = 382312502
Connection closed (dce / rpc)

receive_packet is in rpc/runtime/cnrcvr.c

[4/14/93 public]

We are intermittently seeing a very similar problem on the pmax while
bringing up a cell:

        /opt/dcelocal/bin/sec_clientd
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/dtsd
root@dce9> (receive_packet) assoc->100f5880 Protocol version mismatch -
major->1 minor->5
(receive_packet) assoc->100f5480 Protocol version mismatch - major->1
minor->5
(receive_packet) assoc->100f5a80 Protocol version mismatch - major->1
minor->5
(receive_packet) assoc->10183af8 Protocol version mismatch - major->1
minor->5
(receive_packet) assoc->100f5a80 Protocol version mismatch - major->1
minor->5
(receive_packet) assoc->100f5080 Protocol version mismatch - major->1
minor->5
(receive_packet) assoc->100f5080 Protocol version mismatch - major->1
minor->5
(receive_packet) assoc->100f5a80 Protocol version mismatch - major->1
minor->5
/opt/dcelocal/bin/sec_clientd 04/13/93 23:13:11 - Warning - unable to
refresh identity ... will idle and retry

[4/15/93 public]

The following is excerpted from OT 7700 and happened on the same test run:

ON CDS SERVER, DCE STARTUP WINDOW MESSAGES:

(receive_packet) assoc->20128c18 Protocol version mismatch - major->1 minor->5
(receive_packet) assoc->20128c18 frag_length 4097 in header > fragbuf data size 4096
(receive_packet) assoc->20158148 Protocol version mismatch - major->1 minor->5
/opt/dcelocal/bin/sec_clientd 04/13/93 23:13:04 - Warning - unable to refresh identity ... will idle and retry
... Cannot contact any KDC for requested realm (dce / krb)

[9/8/93 public]
Weidong Wang previously could reprodce this problem on RIOS
with an earlier DCE build (1.0.2a) with a test program.
With this same test program, this problem is not reproducible
on RIOS as well as on HP using the lastest nightly builds.
So lowering the priority - if anybody sees the problem again 
we can increase the priority.

[9/8/93 public]

did not see this problem in a while; And also could not reproduce
this problem with the test program which had sucess in reproducing in 
the earlier builds. If this problem reappears, reopen this bug.



CR Number                     : 7630
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : secd
Short Description             : Update ops to a slave returning wrong error codes
Reported Date                 : 4/1/93
Found in Baseline             : 1.0.2
Found Date                    : 4/1/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/1/93 public]

Using nightly build available on 4/1 AM, configured a RIOS Master and three
PMAX slaves. Using rgy_edit added/deleted few principals binding to the
master site. When bound to a replica site, adding/deleting principals
using rgy_edit gives incorrect messages as follows:

rgy_edit=> site -u
Site changed to: registry server at /.../freedom/subsys/dce/sec/master 
rgy_edit=> add xyz
rgy_edit=> add abc
rgy_edit=> v
nobody                                        -2
root                                           0
daemon                                         1
sys                                            2
bin                                            3
uucp                                           4
who                                            5
mail                                           6
tcb                                            9
dce-ptgt                                      20
dce-rgy                                       21
cell_admin                                   100
krbtgt/freedom                               101
hosts/barge/self                             102
hosts/barge/cds-server                       103
hosts/barge/gda                              104
hosts/zippy/self                             105
hosts/ice/self                               106
hosts/gnocci/self                            121
testp                                        122
testp1                                       123
testp2                                       124
xyz                                          125
abc                                          126
rgy_edit=> site  /.../freedom/subsys/dce/sec/repl3 
Site changed to: registry server at /.../freedom/subsys/dce/sec/repl3 
rgy_edit=> v
nobody                                        -2
root                                           0
daemon                                         1
sys                                            2
bin                                            3
uucp                                           4
who                                            5
mail                                           6
tcb                                            9
dce-ptgt                                      20
dce-rgy                                       21
cell_admin                                   100
krbtgt/freedom                               101
hosts/barge/self                             102
hosts/barge/cds-server                       103
hosts/barge/gda                              104
hosts/zippy/self                             105
hosts/ice/self                               106
hosts/gnocci/self                            121
testp                                        122
testp1                                       123
testp2                                       124
xyz                                          125
abc                                          126
rgy_edit=> site
Current site is: registry server at /.../freedom/subsys/dce/sec/repl3 
rgy_edit=> del xyz
Please confirm delete of name "xyz" [y/n]? (n) y
?(rgy_edit) Unable to delete principal "xyz" - User not authorized to
perform operation (Registry Edit Kernel) (dce / sad)
rgy_edit=> add pqr
?(rgy_edit) Unable to add principal  "pqr" - Principal quota exhausted (dce
/ sec)

rgy_edit=> site -u
Site changed to: registry server at /.../freedom/subsys/dce/sec/master 
rgy_edit=> add pqr
rgy_edit=> del xyz
Please confirm delete of name "xyz" [y/n]? (n) y
rgy_edit=> v
nobody                                        -2
root                                           0
daemon                                         1
sys                                            2
bin                                            3
uucp                                           4
who                                            5
mail                                           6
tcb                                            9
dce-ptgt                                      20
dce-rgy                                       21
cell_admin                                   100
krbtgt/freedom                               101
hosts/barge/self                             102
hosts/barge/cds-server                       103
hosts/barge/gda                              104
hosts/zippy/self                             105
hosts/ice/self                               106
hosts/gnocci/self                            121
testp                                        122
testp1                                       123
testp2                                       124
abc                                          126
pqr                                          127

[4/1/93 public]
Fixed the short description.  This is not a rgy_edit bug, it's secd passing
back the wrong error codes.  I have no idea what they might have changed to
cause this, so I'll leave it assigned to myself until I figure out where these
error codes are being set...

[4/1/93 public]
This is not reproducible on HPUX (it always gives me the correct not master
error).  Were you seeing this in the hosed cell that you had, which wasn't
doing propagations correctly either?  Can you reproduce it in a fresh cell?

[4/2/93 public]
Latest status:  This is not reproducible on HPUX or RIOS.  It was reproducible
once this morning by Raj, but now he can't reproduce it (even configured extra
PMAX slaves this time and still can't reproduce it).

[4/2/93 public]
Lowering severity/priority to B/2 from A/1. I will try to duplicate this
again and if this is not re-producable will cancel it.

[8/2/93 public]

Rajendra, please reproduce or cancel this bug as you said you would
4 months ago.



CR Number                     : 7616
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 
Short Description             : rgy_edit doesn't warn on date input error
Reported Date                 : 3/30/93
Found in Baseline             : 1.0.2
Found Date                    : 3/30/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/26/96]
cancel - addressed in DCE1.2.2.

[3/30/93 public]
A complaint from "the field":

In DCE rgy_edit you can change the good_since date and time 
using the change facility. You can either change it to the
current time using 'now' or to a specified date and time. 
If you make an error in putting in the time separator, it doesn't
warn you of such, and defaults the time to 00:00 of the day
specified. 
I would like it to warn you if it detects any erroneous input.
It does if you put in an incorrect time, or if you put in a bad
separator in the date or time, but not if you put a bad marker
between the date and time (i.e. not a dot '.')
This seems to cause it to ignore the time field and use the default
value (00:00). It should warn you.
If an administrator makes such an error when trying to invalidate
tickets on a compromised account, they may leave the system open
to a hacker already on the system, with still valid tickets.

How about at least putting in friendlier prompts?  Ie,
Good since date [yy/mm/dd.hh:mm or 'now']:
instead of
Good since date [yy/mm/dd or 'now']:

[3/30/93 public]

A confirmation message of "mumblemumble date set to yy/mm/dd.hh:mm" would
also help here.

[3/31/93 public]
This is a request for more syntax checking (functionality which isn't there,
not functionality that doesn't work) so I made this an enhancement (if we
had a defect open for all the places where better checking could be done, we'd
have a defect density that would keep 1.0.2 from freezing forever...).
I changed the fixby field to 1.0.3, since there's no way they'd let this into
1.0.2 at this time anyway.  Note: the prompts will all be worked on for the
1.1 serviceability/i18n work anyway, so we'll make them "friendlier" as part
of that work.



CR Number                     : 7606
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : security rca binder
Short Description             : b21 binding problems
Reported Date                 : 3/29/93
Found in Baseline             : 1.0.2
Found Date                    : 3/29/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2a
Fixed In Baseline             : 
Affected File(s)              : binding.c, internal_binding.c
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[3/29/93 public]
  Looking at the code differences between b15 and b20 reveals
significant changes in the update/query bindings operations
(sec_rgy_site_bind_{update,query}). This bug begins its life as an
inquiry as to whether or not the described behavior has ever been seen
before and whether or not it has already been fixed.
  While running a test script under b15, registry handles returned by
sec_rgy_bind_site_update() invariably provoke "unknown reject (dce/
rpc)" errors as soon as they are passed to any sec_rgy_ routine (namely,
sec_rgy_acct_user_replace() or sec_rgy_pgo_add() ). Converting these
calls to be calls to the more general sec_rgy_site_bind() routine (which
has the same parameters) makes these errors vanish without any other
changes to the code or script. The script runs indefinitely after this
change is made, but cannot survive the first use of the handle
otherwise.
  Looking at the b15 code, it appears that the problem must lie within
(or below) the scope of rca_site_resolve_update() .
  We have not yet advanced to b20 and so I am unable to verify the
presence of this behavior in that baselevel. This was observed on a
one-node cell running b15 on SunOS 4.1.3 using udp protocols
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[3/29/93 public]
  I edited the above to read 'b15' instead of the erroneous 'b17'.

[3/30/93 public]
As noted above, this problem has been seen on SunOS which is currently not
part of the reference platforms supported. Also, you are using a build
which is not current; i.e. b20. If this problem is seen on the reference 
platforms using b20, we will address this issue for 1.0.2. Rather than 
cancelling this bug at this time, I'm making it priority 2.

[4/13/93 public]
  This was seen again on a b20 SunOS4 build here at Transarc. A script
log of the ITL image in progress, at DEBUG_SEC level nine, perhaps
shines a light on the bindings. Another log (longer) with RPC tracing
enabled to the hilt, can also be provided. As this is not seen on a
reference platform (yet: ITL build problems here prevent a RIOS check) I
will continue snooping around until I find it. This absolutely blocks
replication testing for SunOS here.
  Again, I emphasize that running this same script in the same
(one server and one node) cell with the two verbs
"rgy_site_bind_update" and "rgy_site_bind_query" replaced by simple
"rgy_site_bind" verbs (settable in the first lines of the script, below)
results in this problem not being seen. I'll review the (simple) script
implementations of those commands, but they are honestly cut'n'paste of
the "rgy_site_bind" routine.
  I will start by double-checking the binding auth info structure I pass
to the routine... but again, it works *fine* for sec_rgy_site_bind() .
		   ---- ---- ---- ---- ---- ---- ----
		   ---- ---- ---- ---- ---- ---- ----
		   ---- ---- ---- ---- ---- ---- ----
k2# setenv DEBUG_SEC 9 6
k2# !-2
./replication.csh~
CHO_3DOT_CELL_NAME was not set, guessing /.../k2.dce.transarc.com
( You may ignore any "Warning" message that immediately follows. )
^[[1] (0:00) --- The test is starting on Tue Apr 13 11:18:05 1993
 [1] (0:01) --- *:
 [1] (0:01) --- *: set BIND_2_UPDATE "rgy_site_bind_update"
 [1] (0:01) --- *: set BIND_2_QUERY  "rgy_site_bind_query"
 [1] (0:01) --- *:
 [1] (0:01) --- *: *
 [1] (0:01) --- *: * Read the environment for test parameters. Provide useful defaults.
 [1] (0:01) --- *: *
 [1] (0:01) --- *: getEnv CHO_DURATION_H
 [1] (0:01) --- *: if ( $CHO_DURATION_H == "" ) { set CHO_DURATION_H 48 } else
 [1] (0:01) --- *:   { set CHO_DURATION_H ( 0 + $CHO_DURATION_H ) }
 [1] (0:01) --- *:
 [1] (0:01) --- *: getEnv ADMIN_NAME
 [1] (0:01) --- *: if ( $ADMIN_NAME == "" ) { set ADMIN_NAME cell_admin }
 [1] (0:01) --- *:
 [1] (0:01) --- *: getEnv ADMIN_PWD
 [1] (0:01) --- +:
 [1] (0:01) --- +: getEnv ADMIN_PWD
 [1] (0:01) --- *: if ( $ADMIN_PWD == "" ) { set ADMIN_PWD "-dce-" }
 [1] (0:01) --- *:
 [1] (0:01) --- *: getEnv CHO_SEC_RGY_MASTER
 [1] (0:01) --- +:
 [1] (0:01) --- +: getEnv CHO_SEC_RGY_MASTER
 [1] (0:01) --- *: if ( $CHO_SEC_RGY_MASTER == "" ) {
 [1] (0:01) --- *:   set CHO_SEC_RGY_MASTER "/.:/subsys/sec/master"
 [1] (0:01) --- *: }
 [1] (0:01) --- *:
 [1] (0:01) --- *: getEnv CHO_SEC_RGY_THREADS
 [1] (0:01) --- +:
 [1] (0:01) --- +: getEnv CHO_SEC_RGY_THREADS
 [1] (0:02) --- *: if ( $CHO_SEC_RGY_THREADS == "" ) { set CHO_SEC_RGY_THREADS 1 }
 [1] (0:02) --- *:
 [1] (0:02) --- *: * Environment variables which our csh jacket script provides:
 [1] (0:02) --- +:
 [1] (0:02) --- +: * Environment variables which our csh jacket script provides:
 [1] (0:02) --- *: getEnv CHO_SEC_RGY_PROLOGUE
 [1] (0:02) --- *: include $CHO_SEC_RGY_PROLOGUE
 [1] (0:02) --- *: getEnv CHO_3DOT_CELL_NAME
 [1] (0:02) --- *: set CHO_SEC_RGY_REPLICA_COUNT 0
 [1] (0:02) --- *: quit
 [1] (0:02) --- *:
 [1] (0:02) --- *: *
 [1] (0:02) --- *: * Start a timer to mark the end of the test.
 [1] (0:02) --- *: *
 [1] (0:02) --- *: set durationMinutes ( $CHO_DURATION_H * 60 )
 [1] (0:02) --- *: setAfter timesUp $durationMinutes
 [1] (0:02) --- *:
 [1] (0:02) --- *: *
 [1] (0:02) --- *: * Begin the per-thread setup; each thread run a copy of the big inner loop.
 [1] (0:02) --- *: *
 [1] (0:02) --- *: coLoop taskNumber 1 1 $CHO_SEC_RGY_THREADS
 [4] (0:02) --- *:   set uniquePrefix ( $ITL_HostName + "_" + $ITL_ProcessId + "_" + $ThreadId )
 [4] (0:02) --- *:   set passCount 0
 [4] (0:02) --- *:   *
 [4] (0:03) --- *:   * Set the masked error set to include only smooth sailing.
 [4] (0:03) --- *:   *
 [4] (0:03) --- *:   expect OK
 [4] (0:03) --- *:
 [4] (0:03) --- *:   *
 [4] (0:03) --- *:   * Establish an identity known to be a cell administrator.
 [4] (0:03) --- *:   *
 [4] (0:03) --- *:   setup_identity $ADMIN_NAME 0
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell , princ dce-rgy, type 0
(binding_cache_lookup) Cache miss
(rca_site_bind_nsi) Attempting to bind to site /.../k2.dce.transarc.com
(rca_site_bind_nsi) import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../k2.dce.transarc.com
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==137d28
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../k2.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../k2.dce.transarc.com/subsys/dce/sec/master
(rca_site_bind) Bound to Cell '/.../k2.dce.transarc.com'
(rca_site_bind) Bound to Site '/.../k2.dce.transarc.com/subsys/dce/sec/master'
(rca_lock_handle) locking 117c20
(rca_unlock_handle) unlocking ef328
(rca_site_bind) String Binding  '0091f852-7e35-1bc9-80f3-c037cf9a0000@ncadg_ip_udp:192.55.207.154[1939]'
(binding_cache_enter) Adding ef328 to binding cache: site /.../k2.dce.transarc.com/subsys/dce/sec/master cell /.../k2.dce.transarc.com princ (null) type 0
(rca_lock_handle) locking 117c70
(rca_check_binding) checking ef328
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking ef328
ef328: Dropping site refcount from 2 to 1
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell /.../k2.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning ef328
returning cached context ef328
(rca_lock_handle) locking 117fd8
(rca_check_binding) checking ef328
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking ef328
ef328: Dropping site refcount from 2 to 1
 [4] (0:04) --- *:   validate_i $LOGIN_HANDLE $ADMIN_PWD
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell /.../k2.dce.transarc.com, princ dce-rgy, type 1
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
info_type mismatch, dce expected
(binding_cache_lookup) Cache miss
(rca_site_bind) bumping ref on identity ee028
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../k2.dce.transarc.com
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==13b5a8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../k2.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../k2.dce.transarc.com/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@k2.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity ee028, handle 13b5a8
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell /.../k2.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning ef328
returning cached context ef328
(rca_lock_handle) locking 115d20
(rca_check_binding) checking ef328
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking ef328
ef328: Dropping site refcount from 2 to 1
(rca_setup_handle) end set_auth_info identity ee028
(rca_site_bind) Bound to Cell '/.../k2.dce.transarc.com'
(rca_site_bind) Bound to Site '/.../k2.dce.transarc.com/subsys/dce/sec/master'
(rca_lock_handle) locking 116b48
(rca_unlock_handle) unlocking 13b028
(rca_site_bind) String Binding  '0091f852-7e35-1bc9-80f3-c037cf9a0000@ncadg_ip_udp:192.55.207.154[]'
Purging binding cache
(binding_cache_enter) Adding 13b028 to binding cache: site /.../k2.dce.transarc.com/subsys/dce/sec/master cell /.../k2.dce.transarc.com princ dce-rgy@k2.dce.transarc.com type 1
(rca_lock_handle) locking 116c20
(rca_check_binding) checking 13b028
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking 13b028
13b028: Dropping site refcount from 2 to 1
 [4] (0:05) --- password has expired
 [4] (0:05) --- *:   set_context $LOGIN_HANDLE
 [4] (0:05) --- *:   maintain_identity $LOGIN_DEFAULT_HANDLE $ADMIN_PWD
 [4] (0:05) --- *:
 [4] (0:05) --- *:   *
 [4] (0:05) --- *:   * Prepare a useful variable containing our binding authorization information.
 [4] (0:05) --- *:   *
 [4] (0:05) --- *:   set BAI sec_rgy_bind_auth_info_t
 [4] (0:05) --- *:   	  sec_rgy_bind_auth_dce
 [4] (0:06) --- *: 	  $rpc_c_protect_level_pkt_privacy
 [4] (0:06) --- *: 	  $rpc_c_authn_dce_secret
 [4] (0:06) --- *: 	  $rpc_c_authz_dce
 [4] (0:06) --- *: 	  $LOGIN_DEFAULT_HANDLE
 [4] (0:06) --- *:   *
 [4] (0:06) --- *:   * Bind to our site -- we want an update site, this time.
 [4] (0:06) --- *:   *
 [4] (0:06) --- *:   $BIND_2_UPDATE $CHO_3DOT_CELL_NAME $BAI RGY_HANDLE
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell , princ dce-rgy, type 1
(binding_cache_lookup) Looking at 13b028: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `dce-rgy@k2.dce.transarc.com' 1
authn_level mismatch
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
info_type mismatch, dce expected
(binding_cache_lookup) Cache miss
(rca_site_bind) bumping ref on identity ee028
(rca_site_bind_nsi) Attempting to bind to site /.../k2.dce.transarc.com
(rca_site_bind_nsi) import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Attempting to bind to cell /.../k2.dce.transarc.com
(rca_site_bind_nsi_cell) Trying rs_bind interface
(rca_site_bind_nsi_cell) rs_bind import_next failed, status 16c9a0b5
(rca_site_bind_nsi_cell) Trying caller-specified interface
(rca_site_bind_nsi_cell) about to call rca_setup_handle; rpc_handle==16daa8
(rca_setup_handle) bind succeeded -- setting up handle
(rca_setup_handle) req. site name is /.../k2.dce.transarc.com, status 0
(rca_setup_handle) Replace entry name with /.../k2.dce.transarc.com/subsys/dce/sec/master
(rca_setup_handle) Auth DCE, principal 'dce-rgy@k2.dce.transarc.com'
(rca_setup_handle) rpc_binding_set_auth_info, identity ee028, handle 16daa8
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell /.../k2.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at 13b028: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `dce-rgy@k2.dce.transarc.com' 1
info_type mismatch, none expected
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning ef328
returning cached context ef328
(rca_lock_handle) locking 1170c0
(rca_check_binding) checking ef328
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking ef328
ef328: Dropping site refcount from 2 to 1
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell , princ dce-rgy, type 0
(binding_cache_lookup) Looking at 13b028: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `dce-rgy@k2.dce.transarc.com' 1
info_type mismatch, none expected
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning ef328
returning cached context ef328
(rca_lock_handle) locking 1176b0
(rca_check_binding) checking ef328
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking ef328
ef328: Dropping site refcount from 2 to 1
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell /.../k2.dce.transarc.com, princ (null), type 0
(binding_cache_lookup) Looking at 13b028: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `dce-rgy@k2.dce.transarc.com' 1
info_type mismatch, none expected
(binding_cache_lookup) Looking at ef328: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `(null)' 0
(binding_cache_lookup) Cache hit: returning ef328
returning cached context ef328
(rca_lock_handle) locking 117358
(rca_check_binding) checking ef328
(rca_check_binding) flags is 13
(rca_unlock_handle) unlocking ef328
ef328: Dropping site refcount from 2 to 1
(rca_setup_handle) end set_auth_info identity ee028
(rca_site_bind) Bound to Cell '/.../k2.dce.transarc.com'
(rca_site_bind) Bound to Site '/.../k2.dce.transarc.com/subsys/dce/sec/master'
(rca_lock_handle) locking 118180
(rca_unlock_handle) unlocking 168a28
(rca_site_bind) String Binding  '0091f852-7e35-1bc9-80f3-c037cf9a0000@ncadg_ip_udp:192.55.207.154 [1939]'
Purging binding cache
(binding_cache_enter) Adding 168a28 to binding cache: site /.../k2.dce.transarc.com/subsys/dce/sec/master cell /.../k2.dce.transarc.com princ dce-rgy@k2.dce.transarc.com type 1
(rca_site_bind) bumping ref on identity ee028
168a28: Dropping site refcount from 2 to 1
 [4] (0:08) --- *:
 [4] (0:08) --- *:   *
 [4] (0:08) --- *:   * Create some groups and orgs for use during the test.
 [4] (0:08) --- *:   * For now, make three of each, starting at zero.
 [4] (0:08) --- *:   *
 [4] (0:08) --- *:   set pgoMax 3
 [4] (0:08) --- *:
 [4] (0:08) --- *:   * Number of user accounts to add/mangle/delete at a go
 [4] (0:08) --- *:   set userChunkSize 50
 [4] (0:08) --- *:
 [4] (0:08) --- *:   set pgoIndex 0
 [4] (0:08) --- *:
 [4] (0:08) --- *:   * We'll modify this, using it as a template.
 [4] (0:08) --- *:   * fields:Id (uuid_t) unix_num (int) quota (int) flags (..int) name (..string)
 [4] (0:08) --- *:
 [4] (0:08) --- *:   set pgoItem sec_rgy_pgo_item_t "" -1 0 sec_rgy_pgo_flags_none "for rent"
 [4] (0:08) --- *:
 [4] (0:08) --- *:   repeat
 [4] (0:08) --- *:
 [4] (0:09) --- *:     set pgoItem.fullname ( $uniquePrefix + "grp" + $pgoIndex )
 [4] (0:09) --- *:     rgy_pgo_add $RGY_HANDLE sec_rgy_domain_group $pgoItem.fullname $pgoItem
(rca_lock_handle) locking 118990
(rca_check_binding) checking 181528
(rca_check_binding) flags is b
(rca_unlock_handle) unlocking 181528
 [4] (0:09) --- *:
 [4] (0:09) --- *:     set pgoItem.fullname ( $uniquePrefix + "org" + $pgoIndex )
 [4] (0:09) --- *:     rgy_pgo_add $RGY_HANDLE sec_rgy_domain_org $pgoItem.fullname $pgoItem
(rca_lock_handle) locking 118990
(rca_check_binding) checking 181528
(rca_check_binding) flags is b
(rca_unlock_handle) unlocking 181528
 [4] (0:09) --- *:
 [4] (0:09) --- *:     set pgoIndex ( $pgoIndex + 1 )
 [4] (0:09) --- *:   while ( $pgoIndex < $pgoMax )
 [4] (0:09) --- +:
 [4] (0:09) --- +:     set pgoItem.fullname ( $uniquePrefix + "grp" + $pgoIndex )
 [4] (0:09) --- +:     rgy_pgo_add $RGY_HANDLE sec_rgy_domain_group $pgoItem.fullname $pgoItem
(rca_lock_handle) locking 118990
(rca_check_binding) checking 181528
(rca_check_binding) flags is b
(rca_unlock_handle) unlocking 181528
 [4] (0:09) --- +:
 [4] (0:09) --- +:     set pgoItem.fullname ( $uniquePrefix + "org" + $pgoIndex )
 [4] (0:09) --- +:     rgy_pgo_add $RGY_HANDLE sec_rgy_domain_org $pgoItem.fullname $pgoItem
(rca_lock_handle) locking 118990
(rca_check_binding) checking 181528
(rca_check_binding) flags is b
(rca_unlock_handle) unlocking 181528
 [4] (0:09) --- +:
 [4] (0:09) --- +:     set pgoIndex ( $pgoIndex + 1 )
 [4] (0:09) --- +:   while ( $pgoIndex < $pgoMax )
 [4] (0:09) --- +:
 [4] (0:09) --- +:     set pgoItem.fullname ( $uniquePrefix + "grp" + $pgoIndex )
 [4] (0:09) --- +:     rgy_pgo_add $RGY_HANDLE sec_rgy_domain_group $pgoItem.fullname $pgoItem
(rca_lock_handle) locking 118990
(rca_check_binding) checking 181528
(rca_check_binding) flags is b
(rca_unlock_handle) unlocking 181528
 [4] (0:10) --- +:
 [4] (0:10) --- +:     set pgoItem.fullname ( $uniquePrefix + "org" + $pgoIndex )
 [4] (0:10) --- +:     rgy_pgo_add $RGY_HANDLE sec_rgy_domain_org $pgoItem.fullname $pgoItem
(rca_lock_handle) locking 118990
(rca_check_binding) checking 181528
(rca_check_binding) flags is b
(rca_unlock_handle) unlocking 181528
 [4] (0:10) --- +:
 [4] (0:10) --- +:     set pgoIndex ( $pgoIndex + 1 )
 [4] (0:10) --- +:   while ( $pgoIndex < $pgoMax )
 [4] (0:10) --- *:
 [4] (0:10) --- *:   * Close our handle.

[4] (0:10) --- *:   rgy_site_close $RGY_HANDLE
181528: Dropping site refcount from 1 to 0
(rca_lock_handle) locking 118bc0
Drop ref to identity ee028 from binding cache
(rca_unlock_handle) unlocking 181528
 [4] (0:10) --- *:   set RGY_HANDLE 1
 [4] (0:10) --- *:
 [4] (0:10) --- *:   *
 [4] (0:10) --- *:   * Define some of the constants for the following loop.
 [4] (0:10) --- *:   *
 [4] (0:10) --- *:   set callerKey sec_passwd_rec_t 0 sec_passwd_plain $ADMIN_PWD
 [4] (0:10) --- *:
 [4] (0:10) --- *:   * admin_part: creator uuid, cre. date, last changer uuid,
 [4] (0:10) --- *:   *       last change date, expiry, good since date, flags, auth_flags
 [4] (0:10) --- *:   set adminPart sec_rgy_acct_admin_t "" 0 "" 0 0 0
 [4] (0:10) --- *:    		 ( $sec_rgy_acct_admin_client | $sec_rgy_acct_admin_valid |
 [4] (0:10) --- *:                    $sec_rgy_acct_admin_server )
 [4] (0:10) --- *: 		 ( $sec_rgy_acct_auth_renewable | $sec_rgy_acct_auth_tgt |
 [4] (0:10) --- *: 		   $sec_rgy_acct_auth_forwardable )
 [4] (0:10) --- *:
 [4] (0:10) --- *:
 [4] (0:11) --- *:   * Init a counter for the long loop.
 [4] (0:11) --- *:   set userIndex 0
 [4] (0:11) --- *:
 [4] (0:11) --- *:   echo Task $ThreadID initialization complete
 [4] (0:11) ---  Task 0 initialization complete
 [4] (0:11) --- *:
 [4] (0:11) --- *:   ***
 [4] (0:11) --- *:   *** Repeat the following mayhem until time runs out.
 [4] (0:11) --- *:   ***
 [4] (0:11) --- *:
 [4] (0:11) --- *:   repeat
 [4] (0:11) --- *:     echo Task $ThreadID beginning pass $passCount with low user $userIndex
 [4] (0:11) ---  Task 0 beginning pass 0 with low user 0
 [4] (0:11) --- *:
 [4] (0:11) --- *:     *
 [4] (0:11) --- *:     * Section 1.1 -- add fifty user accounts. We need the update site.
 [4] (0:11) --- *:     *
 [4] (0:11) --- *:     $BIND_2_UPDATE $CHO_3DOT_CELL_NAME $BAI RGY_HANDLE
(binding_cache_lookup) Looking for site /.../k2.dce.transarc.com, cell , princ dce-rgy, type 1
(binding_cache_lookup) Looking at 168a28: site `/.../k2.dce.transarc.com/subsys/dce/sec/master' cell `/.../k2.dce.transarc.com' princ `dce-rgy@k2.dce.transarc.com' 1
(binding_cache_lookup) Cache hit: returning 168a28
returning cached context 168a28
(rca_site_bind) bumping ref on identity ee028
168a28: Dropping site refcount from 2 to 1
 [4] (0:11) --- *:
 [4] (0:11) --- *:     set lowUser $userIndex
 [4] (0:11) --- *:     repeat
 [4] (0:11) --- *:       set username ( $uniquePrefix + "user" + $userIndex )
 [4] (0:11) --- *:       set groupname ( $uniquePrefix + "grp" + $userIndex % $pgoMax )
 [4] (0:11) --- *:       set orgname ( $uniquePrefix + "org" + $userIndex % $pgoMax )
 [4] (0:11) --- *:
 [4] (0:12) --- *:       set pgoItem sec_rgy_pgo_item_t "" -1 0 $sec_rgy_pgo_flags_none $username
 [4] (0:12) --- *:       rgy_pgo_add $RGY_HANDLE sec_rgy_domain_person $username $pgoItem
(rca_lock_handle) locking 118888
(rca_check_binding) checking 186028
(rca_check_binding) flags is b
(rca_check_binding) checking 186028
(rca_check_binding) flags is a
(rca_check_binding) checking 186028
(rca_check_binding) flags is a
(rca_check_binding) checking 186028
(rca_check_binding) flags is a
(rca_check_binding) checking 186028
(rca_check_binding) flags is a
(rca_unlock_handle) unlocking 186028
 [4] (0:12) ### error (unexpected) - unknown reject (dce / rpc)
 [1] (0:12) ### RunFromFile has returned with an error, exiting
k2#
 		   ---- ---- ---- ---- ---- ---- ----
 		   ---- ---- ---- ---- ---- ---- ----
 		   ---- ---- ---- ---- ---- ---- ----

[4/13/93 public]
  Updated title to mention b20.
  What happened to the HISTORY lines here... seems to have triggered on
ITL's double-bracket message headers.
  Severity changed to A
Changed Short Description from `b17 binding problems' to `b20 binding problems' 
Changed Severity from `C' to `A'

[04/13/93 public]
Added a space in front of all "["es that were not associated with a
note header.

[4/19/93 public]
  Traced into routine rpc__krb_dg_recv_ck, where this error begins as a
packet verification failure. This returns up through routine
rpc__dg_execute_call() where it is converted (on the security server
side) into a WAY failure, and from there is converted into an unknown
reject, which is returned to the client. The client attempts five
rebinds, and after each, retries this call. It never succeeds.
  It is not known why the WAY failure happens. As is documented above,
the binding auth info structure is identical for the first and second
calls to sec_rgy_site_bind_update(), and yet the second call returns a
registry handle which cannot be used.
  Several tweaks of the script have failed to isolate any problem within
our (ITL-based) test harness. I don't know where this one is.
  I am raising this to A1 to get at least an ACK on the problem's
existence. This is justified by the amount of time spent here trying to
isolate it and the effect this is having on our testing (we have no
workaround).
  I'm equally suspicious of our test harness, the binding cache, and
potential memory corruption (we use a free() which intentionally alters
the freed memory, and it finds things like this) within the security
service. A recommendation for reproducing this would be to translate the
above script trace into a short C program. If time permits, I will code
this and mail it to the resp. engineer -- but time runs out here for
this effort.
Changed Interest List CC from `travis@transarc.com, 
 bb+transarc.alpine@transarc.com,rsarbo' to `travis@transarc.com, 
 bb+transarc.alpine@transarc.com,rsarbo,saxena'

[4/20/93 public]
 Reproduced with the attached program on 1.0.2b21 running on a RIOS. The
attached program has the cell-naem hardcoded into it, beware.
 The output prodcued here at Transarc is:
died: line 137, unknown reject (dce / rpc)
  Severity bumped to 1. Title changed to reflect b21 baselevel.
		   ---- ---- ---- ---- ---- ---- ----
		   ---- ---- ---- ---- ---- ---- ----
#include <pthread.h>
#include <dce/binding.h>
#include <dce/dce_cf.h>
#include <dce/dce_error.h>
#include <dce/nbase.h>
#include <dce/pgo.h>
#include <dce/rgynbase.h>
#include <dce/rpcsts.h>
#include <dce/sec_login.h>
#include <dce/secsts.h>
#include <dce/uuid.h>
#define DIE(x) if (x) die((x), __LINE__)
void die( error_status_t est , int line )
{
  dce_error_string_t txt;
  error_status_t lst;
  dce_error_inq_text(est, txt, &lst);
  if (lst != error_status_ok)			/* Translation failed */
    sprintf((char *) txt, "(no msg) %d", (int) est);
  fprintf(stderr, "died: line %d, %s\n", line, txt);
  exit(1);
}
main(int argc, char **argv)
{
  char ADMIN_NAME[]		= "cell_admin";
  char ADMIN_PWD[] 		= "-dce-";
  char CHO_SEC_RGY_MASTER[]	= "/.:/subsys/sec/master";
  char CHO_3DOT_CELL_NAME[]	= "/.../warlock.dce.transarc.com";
  char prefix[120];
  sec_rgy_handle_t rgy_handle;
  sec_rgy_bind_auth_info_t bai;
  sec_rgy_pgo_item_t pgoItem;
  sec_rgy_acct_admin_t adminPart;
  sec_rgy_acct_user_t userPart;
  sec_rgy_pname_t username, groupname, orgname;
  sec_passwd_version_t newKeyVersion;
  int pgoIndex;
  int userIndex;
  int lowUser;
  sec_login_handle_t login_handle;
  error_status_t est;
  sec_passwd_rec_t pwd, callerKey, newKey;
  boolean32 pwd_expired;
  sec_login_auth_src_t auth_src;
  sec_rgy_login_name_t loginName;
  int CHO_SEC_RGY_THREADS = 1;
  int CHO_SEC_RGY_REPLICA_COUNT = 0;
  int pgoMax = 3;
  int userChunkSize = 25;
  sprintf(prefix, "k2_%d_", getpid());
  sec_login_setup_identity(ADMIN_NAME, 0, &login_handle, &est);
  DIE(est);
  pwd.key.key_type = sec_passwd_plain;
  pwd.key.tagged_union.plain = ADMIN_PWD;
  sec_login_valid_and_cert_ident(login_handle, &pwd, &pwd_expired, &auth_src,
				 &est);
  DIE(est);
  /* no need to maintain ident; test fails immediately */
  bai.info_type = sec_rgy_bind_auth_dce;
  bai.tagged_union.dce_info.authn_level = rpc_c_protect_level_pkt_privacy;
  bai.tagged_union.dce_info.authn_svc = rpc_c_authn_dce_secret;
  bai.tagged_union.dce_info.authz_svc = rpc_c_authz_dce;
  bai.tagged_union.dce_info.identity = login_handle;
  sec_rgy_site_bind_update(CHO_3DOT_CELL_NAME, &bai, &rgy_handle, &est);
  DIE(est);
  pgoIndex = 0;
  uuid_create_nil(&pgoItem.id, &est);
  pgoItem.unix_num = -1;
  pgoItem.quota = 0;
  pgoItem.flags = sec_rgy_pgo_flags_none;
  do {
    sprintf(pgoItem.fullname, "%sgrp%d", prefix, pgoIndex);
    sec_rgy_pgo_add(rgy_handle, sec_rgy_domain_group,
		    pgoItem.fullname, &pgoItem, &est);
    DIE(est);
    sprintf(pgoItem.fullname, "%sorg%d", prefix, pgoIndex);
    sec_rgy_pgo_add(rgy_handle, sec_rgy_domain_org,
		    pgoItem.fullname, &pgoItem, &est);
    DIE(est);
    
    pgoIndex++;
  } while (pgoIndex < pgoMax);
  sec_rgy_site_close(rgy_handle, &est);
  DIE(est);
  callerKey.key.key_type = sec_passwd_plain;
  callerKey.key.tagged_union.plain = ADMIN_PWD;
  adminPart.expiration_date = 0;
  adminPart.good_since_date = 0;
  adminPart.flags = sec_rgy_acct_admin_client |
                    sec_rgy_acct_admin_valid |
                    sec_rgy_acct_admin_server;  
  adminPart.authentication_flags = sec_rgy_acct_auth_renewable |
                                   sec_rgy_acct_auth_tgt |
                                   sec_rgy_acct_auth_forwardable;
  sec_rgy_site_bind_update(CHO_3DOT_CELL_NAME, &bai, &rgy_handle, &est);
  DIE(est);
  do {
    lowUser = userIndex;
    do {
      sprintf(username, "%suser%d", prefix, userIndex);
      sprintf(groupname, "%sgrp%d", prefix, userIndex);
      sprintf(orgname, "%sorg%d", prefix, userIndex);
      uuid_create_nil(&pgoItem.id, &est);
      DIE(est);
      pgoItem.unix_num = -1;
      pgoItem.quota = 0;
      pgoItem.flags = sec_rgy_pgo_flags_none;
      strcpy(pgoItem.fullname, username);
      
      sec_rgy_pgo_add(rgy_handle,sec_rgy_domain_person,username,&pgoItem,&est);
      DIE(est);
      sec_rgy_pgo_add_member(rgy_handle, sec_rgy_domain_group,
			     groupname, username, &est);
      DIE(est);
      sec_rgy_pgo_add_member(rgy_handle, sec_rgy_domain_org,
			     orgname, username, &est);
      DIE(est);
      strcpy(loginName.pname, username);
      strcpy(loginName.gname, groupname);
      strcpy(loginName.oname, orgname);
      
      sprintf(userPart.gecos, "GECOS+%d", userIndex);
      sprintf(userPart.homedir, "/usr/%s", username);
      strcpy(userPart.shell, "/bin/sh");
      userPart.passwd_version_number = 1;
      userPart.passwd_dtm = 0;
      userPart.flags = sec_rgy_acct_user_passwd_valid;
      strcpy(userPart.passwd, "");
      
      newKey.key.key_type = sec_passwd_plain;
      newKey.key.tagged_union.plain = username;
      sec_rgy_acct_add(rgy_handle, loginName, sec_rgy_acct_key_person,
		       userPart, adminPart, callerKey, newKey,
		       sec_passwd_des, &newKeyVersion, &est);
      userIndex++;
    } while (userIndex % userChunkSize);
    sec_rgy_site_close(rgy_handle, &est);
    DIE(est);
  } while (1); /* for demo purposes, repeat forever. */
/* remainder of test not converted to raw C code. */
}
		   ---- ---- ---- ---- ---- ---- ----
		   ---- ---- ---- ---- ---- ---- ----
Changed Short Description from `b20 binding problems' to `b21 binding problems' 
Changed Priority from `2' to `1' 
Changed How was this defect found? from `other' to `handson'

[4/20/93 public]
As Bill just pointed out to me, the above test program is broken.  Note that
in the last set of nested loops, you do a sec_rgy_site_close on the rgy handle
and then loop back on the outer loop, doing more sec_rgy_* calls with a
bogus (freed) rgy_handle.  If this is how your other test was written to, then
please cancel this CR.  If your other test is coded correctly, then please use
that to test on the RIOS, and get us something that we can use to reproduce
the problem here.  I've seen no problems doing lots of sec_rgy_site_bind_update
calls here via sec_admin and rgy_edit, then using the handles from those calls.

[4/20/93 public]
With the fixed ordering of sec_rgy_site_* calls that you gave me, it was dying
in sec_rgy_acct_add() (but the handle worked for the two previous sec_rgy_pgo
calls).  After debugging and fixing a half dozen bugs in the test code, it
runs fine (for the 3 accounts that should work, since you create 3 groups in
the first loop, but try to create more accounts referencing  groups that you
didn't create (presumably since you didn't expect it to get past the first one
because of your other problems).
Here's the changes to the test code that works on HPUX.
5 > diff -b /tmp/test.c ./test.c
31c31,32
<   char  ADMIN_PWD[]           = "-dce-";
---
>   char  ADMIN_PWD_STR[]         = "-dce-";
>   char  ADMIN_PWD[sec_passwd_str_t_size];
42a44
>   sec_rgy_acct_key_t key_parts = sec_rgy_acct_key_person;
64a67
>   strcpy((char *) ADMIN_PWD, ADMIN_PWD_STR);
109a114
>   strcpy((char *) ADMIN_PWD, ADMIN_PWD_STR);
121,122d125
<   DIE(est);
<
129a133
>     DIE(est);
167,168c170,171
<       sec_rgy_acct_add(rgy_handle, loginName, sec_rgy_acct_key_person,
<                      userPart, adminPart, callerKey, newKey,
---
>       sec_rgy_acct_add(rgy_handle, &loginName, &key_parts,
>                        &userPart, &adminPart, &callerKey, &newKey,
170a174
>       DIE(est);
Here's a list of things I fixed:
(1) you were passing 6 of the 10 parameters to sec_rgy_acct_add() by value
    instead of by reference as they should be.
(2) there were missing status checks on several calls, so you couldn't always
    tell where it failed.
(3) the ADMIN_PWD plaintext password is overwritten by sec_login_validate...
    so you need to reset it for later use.
Please run this on RIOS then on SunOS and let us know whether it works on each.
(diff'd version from email with the version I fixed that works).

[4/21/93 public]
  Mike Burati and I have exchanged a cleaned-up version of the program.
This version is failing at Transarc, but not at HP. The RIOS compilation
of the program does not use Transarc's internal implementation of the
heap -- so there are no theories left as to why this is happening. I am
performing experiments as asked by HP. For RIOS, the program is built
against Transarc's dfs-102-2.9 installed include files and libraries.
For SunOS, it is built against a port of b21. The reject occurs
identically on both platforms.

[4/21/93 public]
As per Mike Burati's message, reducing priority/severity to B/2 and
deferring this CR to be fixed by 1.0.3. If further testing shows that the
failure is reproducible, we will bump the severity/priority as appropriate.

[4/22/93 public]
Lest my words get taken out of context and my intentions misunderstood again,
I am enclosing the message that Raj refers to above, for the record.  The 'you'
I referred to in the message was Ward, who opened this defect.  Note that I
only recommended that this be deferred if it was unreproducable after testing
on the latest RIOS build at the OSF (since it was failing on RIOS at Transarc).
I am assuming that this has been deferred because it was not reproducable at
the OSF on RIOS, so if that is not the case, let us know ASAP.
 I'm out of ideas too, and don't have time to chase down an
 unreproducable problem for 1.0.2, so I'm recommending to Rajendra
 that the defect (CR7606) be reduced in severity and priority,
 and be deferred to 1.0.3, UNLESS he can reproduce it there on
 PMAX or RIOS using your latest test (the one you email'd me this
 morning).
 Raj, I'll send you the test program in the next email message.
 Just build it and run it as "# test /.../cellname" (substituting
 your cellname in there).  Please run the test there and (with
 the help of other decision makers down there) figure out what
 to do with this CR based on the results of your tests.  If it
 works, it'll just keep adding accounts...  If it fails, it'll
 have added some pgo's but no accounts.  If it does fail, I'll
 need to know right away because it would be serious enough
 that 1.0.2 would not be usable until it's fixed.

[4/23/93 public]
Just to make it clear, as per Mike's instructions I ran the test on RIOS
here with the code he sent me last evening and it worked ok. I added 500 
accounts before stopping it.

[4/23/93 public]
 Reproduced on local cell cho1.dce.transarc.com node larry. larry is a
RIOS running AIX 3.2 and OSF DCE 1.0.2 b23 . This was done at Elliot
Jaffe's request; the OT report update is purely to record the results.
			---- ---- ---- ---- ----
			---- ---- ---- ---- ----
# pwd
/afs/transarc.com/project/alpine/dev/sb/travis/src/test/security/transarc/itl
# ./a.out `getcellname`
Opening registry handle
Closing registry handle
Adding 25 user accounts beginning at user 0
Opening registry handle
died: line 152, unknown reject (dce / rpc)
			---- ---- ---- ---- ----
			---- ---- ---- ---- ----
Changed Interest List CC from `travis@transarc.com, 
 bb+transarc.alpine@transarc.com,rsarbo,saxena,hathaway,weisman,bradcj' to 
 `travis@transarc.com, 
 bb+transarc.alpine@transarc.com,rsarbo,saxena,hathaway,weisman,bradcj,jaffe@tra
 nsarc.com'

[5/21/93 public]
Revisiting this bug, it seems to have gone away. Now, before
everybody gets happy, there were some environmental changes here which
forced me to modify the program to retest it: namely, we here at
Transarc/DCE are now running the internationalized variant of DCE, and
due to this, I had to move the authz_lvl down to packet integrity level
to rerun the test. I'm leaving the revamped program going against a
replicated security service (SunOS 4.1.3, and SunOS 5.2 master)
overnight. If I get a chance to set up a domestic replicated service,
I'll re-run the image as it was.

[6/1/93 public]
I'm cancelling this. I'll re-open it if it reappears. I still have not
had the resources to build an domestic cell down here, and other
priorities are pressing.
Changed Status from `open' to `cancel'



CR Number                     : 7588
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : osf/1
Short Description             : sleep() with PCATCH falg is not interruptable.
Reported Date                 : 3/25/93
Found in Baseline             : 1.0.2
Found Date                    : 3/25/93
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[3/25/93 public]
When a process gets into sleep on a lock then there is no way
to interrupt it even control-C won't wake it up util the
lock is available. I traced the problem and found that the 
problem was in osf1 kernel function mpsleep(), if I was not wrong.
--Jess
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[3/25/93 public]
Correct a mail address.  Don't know if this is a DFS problem exactly.
Changed Component Name from `dfs' to `dce' 
Changed Subcomponent Name from `osf1' to `osf/1' 
Changed Responsible Engr. from `delgado@osf' to `delgado'

[3/25/93 public]
This sounds like purely an OSF/1 problem and shouldn't even be here
unless it is preventing DFS (or some other DCE component) from 
meeting exit criteria.  Downgrading until more specific
information is provided how this problem relates to DCE.  If 
none is forthcoming, this bug will be cancelled.

[3/26/93 public]

[09/01/93 public]

Pmax is not supported any longer.



CR Number                     : 7576
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : pmax crash - Read address error
Reported Date                 : 3/23/93
Found in Baseline             : 1.0.2
Found Date                    : 3/23/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[3/23/93 public]
Assigning to myself until I see it again. Highly possible that 1st pmax
client's bizarre/unknown state recovering from CR 7568 crash caused
2nd pmax client's demise. Note that the 3rd pmax, the core and root.dfs
server and sync site is acting as it should - reporting lost contact/loss
of quortum.
BUILD:	nb available 3/19/93
CONFIG	3 pmax, 3 flserver cell - config'd today (3/23/93) - healthy ~3 hours
DETAILS:	1st pmax client went down and out with CR 7568
		(suspected kernel overflow)
		brought 1st pmax client back up (rc.dce, rc.dfs)
		there was an error about "entry not found" running
		rc.dts but APPEARED benign
		on 2nd pmax client, cd /:/gmd_dfs -> CRASH
stack trace from kdb:
		malloc
		rpc__mem_malloc
		rpc_string_binding_parse
		rpc_binding_from_string_binding
		krpc_BindingFromSockaddr
		cm_ConnByHost
		cm_ConnByMHosts
		cm_GetVolumeByName
		cm_HoldVolume
		end
		on 1st pmax client, appears to
		be messed up more seriously than I thought:
root@valentine> rpccp show group /.:/fs
>>> rpc runtime error: entry not found (dce / rpc)
root@valentine> ps laxww|grep rpc
    0   202     1   9 -13   0 9.27M 1.32 event  S    ??         1:03.20
/opt/dcelocal/bin/rpcd
    0  5174  4972   4 -13   0 7.72M 444K spipe  S  + pts/2      0:00.41
grep rpc
root@valentine> cdscp show dir /.:
                        SHOW
                   DIRECTORY   /.../dce5_cell
                          AT   1993-03-23-12:37:52
Error on entity: /.../dce5_cell
Requested entry does not exist (dce / cds)
Function: dnsEnumAttr
dnsEnumAttr: partial results = %x000000000000000000000000000000000000

[3/24/93 public]
NOTE: I had turned krpc debugging on on BOTH pmax clients but NOT on
the pmax server that remained healthy.

[03/25/93 public]
I've seen this crash now twice in the OSF CHO cell, both times on
machine 4 (the PMAX client-only machine in the cell).  Whether
coincidentally or not, on both occasions this crash happened immediately
after m3 in the CHO cell had hung as described in OT 7568.
The stack trace I got was the same as the one Gail shows above,
from the cm_ConnByMHosts entry point downward (different call
stack above that, but I think that's irrelevant).  In my crashes,
the stack looks like this (with offsets added):

		malloc+640
		rpc__mem_malloc+200
		rpc_string_binding_parse+41c
		rpc_binding_from_string_binding+ac
		krpc_BindingFromSockaddr+1cc
		cm_ConnByHost+528
		cm_ConnByMHosts+49c

In poking around with kdb, I see that something has corrupted one of
the cache "buckets" used by the OSF/1 kernel malloc() routine.  The
first word of this bucket is supposed to be a pointer to the first
region of memory associated with the bucket.  At the point of the
crash, this word contains the value "5".  (This was true in both
crashes I've looked at.)

Naturally, it's very hard to determine after the fact what was
responsible for this corruption.  I believe the failing call to
malloc() is the one at line 1306 of rpc/runtime/combind.c, though I
believe this call is not at fault.  (All the information it passes
downward looks valid.)

I have two theories about what might have happened.  I'm hoping someone
with RPC experience (Hi, Bill!) can evaluate these and provide some a
priori direction to the search for what's going wrong, rather than
having me or another OSF'er do a brute-force hunt for problems.  Both
times I've seen this, I, like Gail, was running with the new KRPC
debugging/logging turned on.  I'd like to concentrate on the
possibility that turning this on is responsible for the corruption.
There are at least three possibilities.  If the problem is linked to
KRPC logging, perhaps we can evaluate these.  If not, the possibilities
are too general to provide any guidance.

	First, OSF/1 malloc() could be misbehaving.  Seems unlikely
	(given the rarity of this symptom), but I guess it's possible.

	Second, some caller of malloc() could be writing to mallocked
	memory after it's been freed.  The regions of memory in a
	malloc() bucket are linked using the first word of each region,
	and exactly these regions are returned to its callers.  So a
	late write into the first word of mallocked memory could
	corrupt the bucket list as I have seen.

	Third, there could be a mismatch in RPC memory "type"
	(RPC_MEM_IS_FL class) between some rpc__mem_alloc()/
	rpc__mem_free() pair.  I see that, when the type is not "fixed
	length", the RPC allocation code stores an entry length in the
	first word of the region returned by the underlying malloc()
	package, and modifies the address returned to its caller
	appropriately.  This kind of mismatch could also corrupt
	malloc() internal data, though it's harder to see exactly how
	this particular corruption could result.

Anyway, I very much hope that this bug is linked to enabling KRPC
logging, since at least that gives us some orientation in starting to
look for it.  I will start up the CHO cell again, without KRPC logging
turned on, and see if I can make the failure happen in that case.
Raising priority to a 1.
Bill, if you want your usual debug info I can provide it, but I'm
not sure it will do you any good -- I've been over it already.

[3/25/93 public]
Hmm.  dfs_icl_printf doesn't allocate memory itself so it seems unlikely
that logging is responsible (but you never know).
Option 2 or 3 seems fairly unlikely to me, unless some CM code is calling
the wrong version of free() with strings returned from RPC..
With respect to option 3: it could be possible to verify if this is the
case by building an instrumented version of rpcmem which includes the "type
tag" in the allocated memory itself.

[3/25/93 public]
see also my note to #7568 regarding the stack usage in dfs_icl_printf..

[3/26/93 public]
Filled in Responsible Engr. with `bolinger' 
Filled in Resp. Engr's Company with `osf' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[04/09/93 public]
No real progress in tracking this one down.  I haven't been able to
extract any interesting data post-mortem that seem relevant to this
failure.  The call chain down to the panic seems to be working with
valid data -- unsurprising, I guess, since the corruption probably
resulted from some _earlier_ memory allocation or free.  My only
suggestion in debugging this further is to enable OSI-level malloc()
debugging via the AFSDEBMEM preprocessor symbol and/or RPCMEM tracing
and perform more testing.

[04/16/93 public]
Downgraded since this doesn't prevent meeting exit criteria for 
1.0.2a.  Will upgrade if we see it without krpc debug on.

[08/3/93 public]
Cancelling since PMAX'es are not supported in 1.0.3.



CR Number                     : 7560
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : gdsditadm
Short Description             : Bizarre (yet consistent) behavior from gdsditadm if command-line oprions used.
Reported Date                 : 3/22/93
Found in Baseline             : 1.0.2b19
Found Date                    : 3/22/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/22/93 public]
This is a strange defect, if it is a defect at all.

The gdsshd system test setup tries to do the following:

  - configure an initial DSA,
  - add a few other DSA's to the cache
  - Add the initial country, org, org unit, "dsa" and dsa-name to the DSA.
  - configure another DSA
  - change the master knowledge of the other DSA to be owned by the
    initial DSA
  - copy the DIT from the inital DSA to the root of the other DSA
  - Add the other DSA to the DIT.

When I do any of the create or copy operations, I use the following to 
specify the directory id, operation, and DSA

gdsditadm -i<dir_id> -o<operation> -d<DSA-dn> << EOF

followed by the batch file.  This works for all operations except the creation
of the intial DSA object.  In this case, the log file shows no errors, but
a request to show objects for /us/osf/dce/*/*, Object Type: * shows only
the other DSA, not the initial DSA.  If the batch file is run again, the
log file shows the error "Object already exists".  If I change the batch
file to remove the object (which the log says exists, but which I can't 
see via gdsditadm!), and run the modified script twice, the log from the
first run shows no error, but the log from the second run says "Object
does not exist!".  I am flabbergasted.  Is GDS maintaining some alternate
DIB to which I have no access?

As a workaround, I modified the script so that the dir id and operation are
specified in the batch file as opposed to the gdsditadm command line.

My questions are as follows:
   1) Is it not legal to use these options whe running gdsditadm with a
      batch file?
   
   2) If so, why does it work in all of the cases described above except
      for one?

   3) If not, why, and where is it stated in the documentation? This used
      to work (in DCE 1.0.1).

[06/08/93 public]
Changed "Fix By Baseline" field from 1.0.2 to 1.0.3.

[08/17/93 public]
Canceled, because it was a configuration problem.



CR Number                     : 7539
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : cm setsetuid doesn't report failures
Reported Date                 : 3/18/93
Found in Baseline             : 1.0.2
Found Date                    : 3/18/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : 

[3/18/93 public]
The command cm setsetuid returns 0 and reports no error even if it
failed (ie. when you do not have enough privilege to successfully
execute this command).
(admin_checklist)

[3/23/93 public]
Changed Responsible Engr. from `pakhtar' to `tu@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[4/9/93 public]
It succeeds and fails appropriately for me.  Could you please re-check?

[7/20/93 public]
Gail, I have tried it on AIX and could not reproduce it. I suspect this 
could have been fixed or it is a very PMAX specific. 
Please cancel it if it is really not reproducd any more or let me know 
any new development. 
Thanks, 
Tu
Changed Responsible Engr. from `tu@transarc.com' to `gmd@osf.org' 
Filled in Transarc Herder with `jaffe@transarc.com'

[7/22/93 public]
Hmm - I can no longer reproduce this problem either. I may have been confusing
local Unix identity with DCE principal identity ie. logged in as local Unix 
user root but as DCE prinipal gmd, you can successfully setsetuid and the
reverse is NOT the case (Unix user gmd, DCE principal root). In any case,
my current testing appears to be consistent with documentation - canceling.



CR Number                     : 7535
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : kruntime
Short Description             : -UNCK doesn't always undefine NCK 
					     in 1.2 Gcc compiler
Reported Date                 : 3/18/93
Found in Baseline             : 1.0.2
Found Date                    : 3/18/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : kruntime/Makefile
Sensitivity                   : public

[3/18/93 public]
 This problem only appears with latest 1.2 Gcc compiler:
     gcc version 2.3.1-osf.8 (pmax) 

    Some files in kruntime do want the NCK being defined, but
    some files do not. The kruntime/Makefile uses a global CFLAGS which
    has "-DNCK".  For those file who do not want it, the makefile uses
    the technique "-UNCK" to undefine it for them. But unfortunately, 
    our gcc will regroup all symbols defined and symbols undefined into 
    two groups, the order of these two groups appear is not certainly 
    the way you hope in which the group of defined symbols appears before 
    the group of undefined symbols. This means that the technique we 
    currently use does not always work. 

    So the Makefile need to be changed to have secondary CFALGS which doesn't
    have NCK defined for those files who do not want NCK.

[07/27/93 public]
Diane Delgado encountered this, and has a fixed Makefile.
Since the OSF/1 platform is not a suported reference platform
for DFS (and kruntime), I am going to cancel this bug, however
if and when these changes are needed, they are already made
so this info isn't being lost.



CR Number                     : 7485
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : idl/idl_compiler
Short Description             : Enum max boundary check is wrong.
Reported Date                 : 3/11/93
Found in Baseline             : 1.0.2b18
Found Date                    : 3/11/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
The AES says that enumeration identifiers map onto consecutive integers
beginning with 0 (Section 4.3.13.1) and that up to 32767 are allowed. This
means that the mapped values of enumeration literals are in the range
0-32766. We therefore believe the existing code is correct. If you actually
have an IDL with 32767 identifiers in an enumeration and it is failing,
please e-mail me a copy and I will look into it further.
	hinxman@clt.enet.dec.com

[3/11/93 public]


IDL compiler does not allow enumerated types with 32767 elements (the max
number allowed, according to the documentation).  This is because the check
it does for determining the boundary condition is incorrect.

File affected:     src/rpc/idl/idl_compiler/astp_sim.c
Routine affected:  AST_enumerator_node().

There should be a ">" in a comparison instead of ">=" when checking for
the max number of allowed elements.

The line:
        if ((unsigned int)N >= ASTP_C_SHORT_MAX) overflow = TRUE;

Should be:
        if ((unsigned int)N > ASTP_C_SHORT_MAX) overflow = TRUE;

[3/11/93 public]

This defect should NOT have been cancelled.  I can show the problem in the
code, and I have a testcase to prove that it does not work correctly as is.

Here is the relevent code piece, from astp_sim.c:

AST_type_n_t *AST_enumerator_node
#ifdef PROTO
(
    AST_constant_n_t *constant_list,
    AST_type_k_t size
)
#else
(constant_list, size)
    AST_constant_n_t *constant_list;
    AST_type_k_t size;
#endif
{
    AST_enumeration_n_t *enum_node_ptr;
    AST_type_n_t *type_node_ptr;
    unsigned int N = 0;
    AST_constant_n_t *cp;
    int overflow = FALSE;


    /*
     * Loop through the constant nodes and assign them integer values from
     * 0 through N.
     */
    for (cp = constant_list; cp; cp = cp->next)
    {
        /*
        ** Set the value of the enum element, if we overflow set a flag
        */
        cp->value.int_val = N++;
        if ((unsigned int)N >= ASTP_C_SHORT_MAX) overflow = TRUE;
    }

    ....
    ....

If you look at the above for loop, you see that although N is initialized
to 0, it is incremented before the overflow check is done.  This causes the
overflow check to fail when the enum has the maximum number of elements,
because it considers N = max to be a failure.  Since N was set to 1 before
the first comparison was done, N should have a range of 1 to max, and not
0 to max-1.  Simply changing the >= to a > fixes the problem, and we have
the testcase to show that this fix works.  I am not going to send the
testcase thru the mail though, since it is about 500k big.  I can ftp it
somewhere, or put it somewhere where it can be picked up.



CR Number                     : 7484
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : Cdsclerk grew on Ed Perkins' login/logout test
Reported Date                 : 3/11/93
Found in Baseline             : 1.0.2
Found Date                    : 3/11/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/11/93 public]

The cdsclerk/root grew about 1.3Kbytes per login/logout when running
Ed's sec.rgy.7 test.

[3/11/93 public]
Given that we were supposed to freeze tomorrow, and now at least by next FRI,
it would help if you gave us a little more info than that, if you're going to
report a problem against us...  There's no evidence here that this is
definitely a security problem, other than the fact that it's related to
logins.  In fact, it might be correct, because for every login, you are
talking to the cdsclerk at some point, and it is going to have to import a
login context for every different identity you talk to it with.  I've added
dce-ot-cds to the CC list, because I'd like Mark or Peter to comment on
whether this is expected from cdsclerk.  I'm really inclined to cancel this
right now for lack of information, but I'll wait for a CDS comment before I
do...

[3/12/93 public]

Mike,
	When I ran my own version of login/logout test:

		dce_login cell_admin -dce- <<EOF
		kdestroy
		EOF

	The cdsclerk has very small growth. What's the diff between
	the two cases. 

	By the way I had the following data regarding cdsclerk's growth.

Jean

The following is the growth pattern of the cdsclerk/root via "ps aux " with
intervals of 30 mins.

root      1796 10.2 13.0 8.57M 3.12 ??       S    21:28:28   2:36.32 /opt/dcelo
root      1796 11.2 17.8 10.1M 4.28 ??       S    21:28:28   8:23.89 /opt/dcelo
root      1796 23.9 18.1 10.5M 4.34 ??       S    21:28:28  14:08.29 /opt/dcelo
root      1796 23.2 18.9 10.5M 4.55 ??       S    21:28:28  19:50.61 /opt/dcelo
root      1796 10.4 18.8 10.9M 4.50 ??       S    21:28:28  25:36.70 /opt/dcelo
root      1796 13.0 20.8 11.0M 4.99 ??       S    21:28:28  31:29.17 /opt/dcelo
root      1796 10.3 20.9 11.8M 5.02 ??       S    21:28:28  37:17.13 /opt/dcelo
root      1796 15.0 23.1 12.9M 5.55 ??       S    21:28:28  43:08.56 /opt/dcelo
root      1796 16.0 21.2 14.0M 5.09 ??       R    21:28:28  48:58.87 /opt/dcelo
root      1796 13.6 24.3 15.1M 5.84 ??       S    21:28:28  54:56.39 /opt/dcelo
root      1796  0.4 28.2 15.6M 6.78 ??       S    21:28:28  57:32.20 /opt/dcelo

[3/12/93 public]
I believe the difference is that Ed's test is doing sec_login_valid_and_cert
and with dce_login you are only doing sec_login_validate_identity()...  That
coupled with the fact that Ed's test does logins/logouts much faster than
you can do dcelogin/kdestroy in a loop, so it should be growing faster.
In the real world, you are going to have multiple people logging in to 
multiple accounts, so there will be multiple clerks, not one sharing multiple
identities.  Let me reiterate what I said above: "The clerk has to import
a new identity each time through the loop above, so it should be growing".
Unless you have some proof that there is a leak here, then please cancel
this defect, because (1) it should be growing, and (2) it is not growing much
per login, and (3) in the real world, people are not using it in this way...

[3/15/93 public]

Owner : burati ---> hsiao
Priority : 2 ---> 4

I am not sure whether it is NOT a real world application. So, I'll keep this
bug alive and I'll own it before I can relate it to some component(s).

[4/7/93 public]

I don't know if what I have to say is directly relevent to this OT report,
but I thought that this might be a good place to start...

When running the cds system test cds_abuse 
(src/test/systest/directory/cds_abuse), I notice that the clerk for
the uid of the user running the test grows very large.  After
about 13112 operations operations (about 20 hours of testing), the
cdsclerk had grown to a size of 21 meg (this is with connection oriented
RPC).  This seems very excessive (especially considering that the CDS
server was only about 25 meg) at that point.

(Just as an aside, when running the same test with only UDP RPC, the
cdsclerk was only 19 meg after 15300 operations).

This may also be a case where this is not the expected usage, but I thought
that this was another important data point.



CR Number                     : 7481
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : uuidgen installed on all clients
Reported Date                 : 3/11/93
Found in Baseline             : 1.0.2
Found Date                    : 3/11/93
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : dce_config
Sensitivity                   : public

[3/11/93 public]
Why do we install uuidgen on all client machines?  

This question might make more sense if you know that we only
install idl on machines configured as App Dev machines.

idl.cat is installed on all client machines not just those
machines that have the idl compiler.  Is this correct or are
there messages in this catalog that other things (stubs?)
can generate? 

My thought is that all three of these should only be on App
Dev machines.  This would cause changes in dce_config (there
are user visible changes in messages displayed--installing
foo--but nothing like a prompt change) and in some
documentation (Admin Guide).

When the time comes an inter-related Doc Bug should be opened.

[3/11/93 public]
One reason uuidgen is installed is that it is used by dce_config
during some 'rpccp export' calls during configuration.  Every
client really needs it.

[4/12/93 public]

I can imagine shell scripts for installs of products based on DCE wanting
to use uuidgen or an equivalent to generate a "database" object uuid.

What's the harm of including uuidgen in the base distribution?  assuming
you're using shared libraries, it's not very big.

[6/16/93 public]
I cancelled this, as people make convincing arguments for it.



CR Number                     : 7449
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : replication
Short Description             : cannot locate rgy object when creating slave
Reported Date                 : 3/9/93
Found in Baseline             : 1.0.2
Found Date                    : 3/9/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/9/93 public]

Sometimes we haven't been able to configure a slave on a rios
system.  sec_create_db reports that it can't find the registry
object.  Doing an initial cell config again seems to fix the problem.

[3/9/93 public]
I've seen this problem last week and re-configing fixed it. Thought it was
a hick-up.

[3/9/93 public]
If you're getting "Registry object not found", it may mean that the ACL on
/.:/sec/replist has not been modified yet.  I would think that you would see an
acl_edit error from dce_config if that were happening, but I have seen problems
with dce_config not passing errors on before. You would have trouble trying
to change the acl, if /.:/sec were not set up yet, or if the client had cached
a copy of it before it was set up completely.  Setting up a slave immediately
after configuring the master is not a good idea.  Give the master time to
finish setting up the namespace...
If you can get this to happen again, use acl_edit on the master to make sure
the ACL on /.:/sec/replist has been modified correctly, then on the slave,
use rpccp show_entry /.:/sec to make sure it can find the master via NSI.

[3/17/93 public]
Since emartin hasn't had time to look into this, I've reassigned it to myself.
I am unable to reproduce this at all, even configuring the RIOS slave after
configuring an HPUX slave as Liza suggested.  Since nobody has seen this
lately, and nobody seems to have seen it more than once (all around the same
time) and it is not blocking anybody, and there's a simple workaround if you
do see it, and nobody has saved the output they got from when it happened, or
checked to see if the acl was set up correctly, I'm downgrading this to a
C2 (w/Carolyn's permission).

If anybody sees this again AND gets the information that I requested above,
then I will upgrade this.  If nobody can reproduce this by the day before the
freeze, I'm cancelling this, and assuming that either something else fixed it,
or it was something wrong with the way things were set up at the time...

[8/2/93 public]

Final warning.  If anyone's seen this, then respond or else the 
bug is cancelled.



CR Number                     : 7437
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : Secd had minor memory leak with dce_login
Reported Date                 : 3/5/93
Found in Baseline             : 1.0.2
Found Date                    : 3/5/93
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/5/93 public]

The security daemon, secd, had minor memory leak with dce_login. For 
4,136 iterations of the following script:

	dce_login cell_admin -dce- << EOF
	kdestroy
	EOF

the total growth is only 280 Kbytes or 69 bytes/iteration. With an equivalent
dce_login test by Ed Perkins --- loops of the following security API calls:

	sec_login_setup_identity
	sec_login_valid_and_cert_ident
	sec_login_get_expiration
	sec_login_set_context
	sec_login_purge_context

For 5,500 loops the increase is 310 Kbytes or 58 bytes/loop.

Note that Ed Perkins got conflicting results ---- much higher leak rate.

[3/8/93 public]
Note: secd SHOULD increase in size when you are running dce_login in a loop,
because the runtime is caching call information for each client (up to a
certain point).  The question is, does the size ever level off.  We need to
know the size every so often for 15 minutes or so, then the size every 5 mins
for the next 15 or so... (for Jean's test).  For Ed's test, tell us the growth
after 2500,5000,7500,10000 iterations (the one pt above at 5500 isn't enough
to tell us if it's something that's allocated initially and reused or a
constant growth pattern).

[3/8/93 public]

The following is a 30 minutes interval "ps aux" log when running Jean's 
test ---

  473 pts/0    S <    0:34.53 secd -bootstrap
root       473  0.0 12.5 9.11M 3.00 pts/0    S <  21:30:34   0:34.53 secd -boot
root       473  1.2 10.8 9.20M 2.59 ??       S <  21:30:34   1:26.64 secd -boot
root       473  0.5 10.9 9.21M 2.61 ??       S <  21:30:34   2:22.22 secd -boot
root       473  0.4 10.9 9.22M 2.61 ??       S <  21:30:34   3:15.50 secd -boot
root       473  0.4 11.1 9.23M 2.67 ??       S <  21:30:34   4:12.04 secd -boot
root       473  0.1 11.1 9.23M 2.67 ??       S <  21:30:34   5:05.43 secd -boot
root       473  0.1 11.1 9.23M 2.67 ??       S <  21:30:34   6:00.32 secd -boot
root       473  0.3 11.1 9.23M 2.67 ??       S <  21:30:34   6:53.45 secd -boot
root       473  0.5 11.3 9.23M 2.71 ??       S <  21:30:34   7:49.37 secd -boot
root       473  0.4 11.3 9.23M 2.71 ??       S <  21:30:34   8:43.05 secd -boot
root       473  0.4 11.3 9.23M 2.71 ??       S <  21:30:34   9:39.51 secd -boot
root       473  4.2 11.3 9.23M 2.71 ??       S <  21:30:34  10:33.15 secd -boot
root       473  0.2 11.3 9.23M 2.71 ??       S <  21:30:34  11:28.64 secd -boot
root       473  4.1 11.3 9.23M 2.71 ??       S <  21:30:34  12:22.25 secd -boot
root       473  0.3 11.3 9.23M 2.71 ??       S <  21:30:34  13:18.09 secd -boot
root       473  0.4 11.3 9.23M 2.71 ??       S <  21:30:34  14:11.98 secd -boot
root       473  0.5 11.3 9.23M 2.71 ??       S <  21:30:34  15:08.29 secd -boot
root       473  0.4 11.3 9.23M 2.71 ??       S <  21:30:34  16:01.43 secd -boot
root       473  0.7 11.3 9.23M 2.71 ??       S <  21:30:34  16:57.95 secd -boot
root       473  0.4 11.3 9.23M 2.71 ??       S <  21:30:34  17:52.15 secd -boot
root       473  0.7 12.0 9.35M 2.89 ??       S <  21:30:34  19:00.27 secd -boot
root       473  0.7 12.0 9.35M 2.89 ??       S <  21:30:34  19:53.86 secd -boot
root       473  0.8  8.1 9.35M 1.95 ??       S <  21:30:34  20:50.84 secd -boot
root       473 10.0  8.1 9.35M 1.95 ??       S <  21:30:34  21:45.18 secd -boot
root       473  3.0  8.5 9.35M 2.05 ??       S <  21:30:34  22:41.01 secd -boot
root       473 10.7  9.7 9.36M 2.32 ??       S <  21:30:34  23:42.13 secd -boot
root       473  4.9 10.2 9.39M 2.45 ??       S <  21:30:34  25:08.60 secd -boot


For Ed's test the "ps aux" 30-minutes-interval log gave the following
sequence:

	9.09M
		<--- test start some minutes after the first "ps aux"
	9.22M
	9.26M
	9.27M
	9.28M
	9.29M
	9.31M
	9.32M
	9.33M
	9.34M
	9.36M
		<---- test fail after 5 hours of testing due to test server's
			ticket refresh failure.
	9.36M 

Note that, in 30 minutes, Ed's test's average thruput is about 546 
login/logout and it is about 164 login/logout for Jean's test. So, 
we see faster leaking in Ed's test.

[3/8/93 public]
Using Ed's numbers from above (since Jean's were from *many* clients, which
means the runtime is allocating lots of client info...), after the initial
client info setup...  you started seeing about .01M per half hour leaking.
1024K*.01 = 10.24K per half hour with 546 iterations gives us 10.24/546=0.01875
which is an 18.75byte per iteration leak.  Since this is fairly insignificant
I've lowered the severity to D.  Since nothing other than p0's and 1's are
allowed to be fixed in the remaining 1.0.2 days, I've changed the "Fix by"
to 1.0.3.

[9/2/93 public]
Since this is really a very minor leak, and it's not clear that it is even
a problem, we don't feel this warrants fixing for 1.0.3, and are cancelling
it.



CR Number                     : 7429
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : root cdsclerk hung
Reported Date                 : 3/5/93
Found in Baseline             : 1.0.2b17
Found Date                    : 3/5/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[3/5/93 public]
BUILD:	b17 aka dfs 2.6
CONFIG:	4 pmax cell - 3 fl servers, root.dfs in ufs
TEST:	2 dfs.glue, 1 dfs.lock
By machine:
dce12 = sec,cds,dts,fldb server and file server exporting root.dfs in ufs
glue test (without cache consistency portion enabled) 6 CHO 
/usr/adm/messages contains:
Mar  4 20:18:24 dce12 vmunix: dfs: Warning: the rpc call to server 130.105.201.1
0 in cell dce12_cell timed out.
Mar  4 20:18:25 dce12 vmunix: dfs: dce errors (code 668147713) from the fileset
location server 130.105.202.31 in cell dce12_cell
Mar  4 20:18:49 dce12 last message repeated 7 times
Mar  4 20:21:13 dce12 last message repeated 2 times
Mar  4 20:23:14 dce12 last message repeated 8 times
Mar  4 20:40:41 dce12 last message repeated 16 times
Mar  4 20:48:04 dce12 last message repeated 12 times
Mar  4 20:48:08 dce12 vmunix: dfs: fx server 130.105.202.25 in cell dce12_cell b
ack up!
Mar  4 20:48:14 dce12 vmunix: dfs: dce errors (code 668147713) from the fileset
location server 130.105.202.31 in cell dce12_cell
20:21
Suddenly, it can't find a directory under /:. For the next
20 minutes, tests fail for this reason, then, just as suddenly, it CAN
find the directory under /: and tests start passing for the next 8 minutes.
Then can't find the directory under /: for 6 minutes, then CAN for 5 minutes,
can't for 10 minutes, CAN for 5 minutes, etc.
Due to errors on my part/in my tests, AFTER these problems started
I filled  the ufs partition being exported as root.dfs.
NOW:
dce12 bos status -long indicates that none of the servers has had
to be restarted, there are no core files anywhere nor do the adm logs
show anything. fts commands hang, 
root@dce12> cm statservers
These servers are still down:  osfloan.osf.org, valentine.osf.org.
***********************************************************
dce5 = file server, client for everything else exporting lfs
dfs.lock ran until (oops!) disk quota exceeded
/usr/adm/messages contains:
Mar  4 19:18:58 dce5 vmunix: dfs: server disk quota exceeded
Mar  4 19:19:58 dce5 vmunix: dfs: dce errors (code 668147713) from the fileset l
ocation server 130.105.202.31 in cell dce12_cell
Mar  4 19:19:58 dce5 vmunix: dfs: fileset (0,,10) is not available!
(where 130.105.202.31 = dce12)
NOW:
dce5 bos status -long indicates that none of the servers has had to
be restarted, no core files, adm logs show nothing, fts commands hang,
root@dce5> cm statservers
These servers are still down:  valentine.osf.org.
***********************************************************
valentine = dts, fl server exporting lfs and ufs aggregates
no test running here - merely a client in 3 other tests.
/usr/adm/messages contains:
Mar  4 19:28:15 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 19:30:45 valentine vmunix: dfs: Warning: the rpc call to server 130.105.5
.27 in cell dce12_cell timed out.
Mar  4 19:30:45 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 19:33:51 valentine vmunix: dfs: fileset location server 130.105.201.10 in
 cell dce12_cell back up!
Mar  4 20:25:01 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 20:25:02 valentine vmunix: dfs: dce errors (code 668147713) from the file
set location server 130.105.202.31 in cell dce12_cell
Mar  4 20:25:02 valentine vmunix: dfs: dce errors (code 668147713) from the file
set location server 130.105.202.31 in cell dce12_cell
Mar  4 20:27:31 valentine vmunix: dfs: Warning: the rpc call to server 130.105.2
01.10 in cell dce12_cell timed out.
Mar  4 20:27:31 valentine vmunix: dfs: dce errors (code 668147713) from the file
set location server 130.105.202.31 in cell dce12_cell
Mar  4 20:27:32 valentine vmunix: dfs: fileset (0,,7) is not available!
NOW:
valentine bos status -long indicates that none of the servers has had to
be restarted, no core files, adm logs show nothing, fts commands hang,
root@valentine> cm statservers
These servers are still down:  osfloan.osf.org, valentine.osf.org.
***********************************************************
osfloan = dts, fl server exporting ufs aggregate
dfs.glue (without cache consistency) 0.5 CHO
Valentine unable to see osfloan's directory - see /usr/adm/messages
above (osfloan = 130.105.201.10) - then recovers - then osfloan 
has trouble seeing a directory under /: (since dce12 was having trouble)
at 20:20. Like dce12, alternates between being able to see /: and
not until the test fills up the ufs partition.
/usr/adm/messages contains:
Mar  4 20:16:01 osfloan vmunix: dfs: fx server 130.105.202.25 in cell dce12_cell
 back up!
Mar  4 20:18:08 osfloan vmunix: dfs: dce errors (code 668147713) from the filese
t location server 130.105.202.31 in cell dce12_cell
Mar  4 20:18:18 osfloan last message repeated 3 times
Mar  4 20:20:51 osfloan last message repeated 2 times
Mar  4 20:23:11 osfloan last message repeated 8 times
Mar  4 20:40:38 osfloan last message repeated 14 times
Mar  4 20:49:17 osfloan last message repeated 22 times
Mar  4 20:55:57 osfloan last message repeated 26 times
Mar  4 21:10:08 osfloan last message repeated 40 times
Mar  4 21:20:56 osfloan last message repeated 68 times
Mar  4 21:31:02 osfloan last message repeated 165 times
Mar  4 21:41:06 osfloan last message repeated 169 times
Mar  4 21:51:10 osfloan last message repeated 183 times
Mar  4 21:51:18 osfloan last message repeated 3 times
Mar  4 21:51:21 osfloan vmunix: dfs: fx server 130.105.201.10 in cell dce12_cell
 back up!
Mar  4 21:51:21 osfloan vmunix: dfs: dce errors (code 668147713) from the filese
t location server 130.105.202.31 in cell dce12_cell
Mar  4 21:51:21 osfloan vmunix: dfs: fileset (0,,7) is not available!
NOW:
osfloan bos status - long indicates that none of the servers has had to
be restarted, no core files, adm logs show nothing, fts commands hang,
but get slightly further than the others with:
root@osfloan> fts lsfldb
fts: Using unauthenticated connection for cell /.../dce12_cell: auth ticket expired (dce / rpc).
root@osfloan> cm statservers
All servers are running.
*************************************************
Ron and Diane think this may be related to an ftserver hang seen in 2.7.
I can leave this cell up for awhile - let me know if you are interested
in logging in.

[3/5/93 public]
Changed Interest List CC from `vijay@transarc.com' to `pakhtar@transarc.com' 
Changed Responsible Engr. from `pakhtar' to `vijay@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[3/5/93 public]
Lowering the priority to 2 since, realistically, no work will be
done on this unless it is seen again with 2.7 or later drops.
In response to Vijay and Craig (thanks for asking):
	- osfloan's time was off by ~45 minutes! Osfloan was one
	of the flservers and had most likely been the sync site at
	the start of the test - this explains SOME things, sort of -
	unclear why osfloan would be more affected than other pmaxes
	by console printf's and why the remaining 2 flservers couldn't
	get their act together inspite of osfloan ...
	- rpccp show entry /.:/fs output was identical on all 4 machines,
	the FlLogs on all machines indicate that all 3 flservers were
	known at the last time I restarted.
	- udebug output below
	- bos lsadmin /.:/hosts/<hostname> showed dfs-admin present
	on all 3 machines
	- klist's for machine self show refreshes working (good check 
	though ... the core system test people and I have seen the
	fff creds file disappear but not consistently)
Udebug output:
root@osfloan> cd /:
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: fileset (0,,1) is not available!
/:: No such device
root@osfloan> date
Fri Mar  5 13:04:58 EST 1993
root@osfloan> date 03051345
Fri Mar  5 13:45:55 EST 1993
root@osfloan> cd /:
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: fileset (0,,1) is not available!
/:: No such device
root@osfloan> cd /opt/dcelocal/bin
root@osfloan> udebug /.:/fs
root@osfloan> udebug /.:/fs 
root@osfloan> bos restart -server /.:/hosts/osfloan -process flserver -localauthroot@osfloan> udebug /.:/fs -long
Host 130.105.201.10, his time is 0
Vote: Last yes vote for 130.105.5.27 at 0 (sync site); Last vote started at -57
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at 0
Sync host 130.105.5.27 at 0
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -731358502
Server 31.202.105.130: (db 0.0)
    last vote rcvd at 1, last beacon sent at 1, last vote was no
    dbcurrent=0, up=1 beaconSince=1
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -30, last beacon sent at -30, last vote was no
    dbcurrent=0, up=1 beaconSince=1
***********************************************************
root@valentine> udebug /.:/fs
root@valentine> bos restart -server /.:/hosts/valentine -process flserver -localauth
root@valentine> udebug /.:/fs -long
Host 130.105.5.27, his time is 0
Vote: Last yes vote for 130.105.5.27 at -4 (sync site); Last vote started at -16
Local db version is 731358416.1
I am sync site until 86 (3 servers)
Recovery state 1f
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -45
Server 31.202.105.130: (db 731358416.1)
    last vote rcvd at 56, last beacon sent at -1, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
Server 10.201.105.130: (db 731358416.1)
    last vote rcvd at 45, last beacon sent at 0, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
root@valentine> udebug /.:/fs -long
Host 130.105.5.27, his time is 0
Vote: Last yes vote for 130.105.5.27 at -7 (sync site); Last vote started at -7
Local db version is 731358416.1
I am sync site until 83 (3 servers)
Recovery state 1f
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -96
Server 31.202.105.130: (db 731358416.1)
    last vote rcvd at 47, last beacon sent at -8, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
Server 10.201.105.130: (db 731358416.1)
    last vote rcvd at 37, last beacon sent at -8, last vote was yes
    dbcurrent=1, up=1 beaconSince=1
root@valentine> cm statservers
All servers are running.
**************************************************************
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 130.105.5.27 at -64206 (sync site); Last vote started at -64206
Local db version is 731290861.1
I am not sync site
Lowest host 130.105.5.27 at -64206
Sync host 130.105.5.27 at -64206
Sync site's db version is 731290861.1
0 locked pages, 0 of them for write
This server started at -731358365
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -85770, last beacon sent at -85770, last vote was no
    dbcurrent=0, up=1 beaconSince=1
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -85770, last beacon sent at -85770, last vote was no
    dbcurrent=0, up=1 beaconSince=1
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 130.105.5.27 at -5 (sync site); Last vote started at -62
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at -5
Sync host 130.105.5.27 at -5
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -731358522
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -85927, last beacon sent at -138, last vote was no
    dbcurrent=0, up=1 beaconSince=0
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -85927, last beacon sent at -79, last vote was no
    dbcurrent=0, up=1 beaconSince=0
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 130.105.5.27 at -8 (sync site); Last vote started at -63
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at -8
Sync host 130.105.5.27 at -8
Sync site's db version is 731358416.1
0 locked pages, 0 of them for write
This server started at -731358568
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -85974, last beacon sent at -185, last vote was no
    dbcurrent=0, up=1 beaconSince=0
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -85974, last beacon sent at -126, last vote was no
    dbcurrent=0, up=1 beaconSince=0
root@dce12> bos restart -server /.:/hosts/dce12 -proc flserver -localauth
root@dce12> udebug /.:/fs -long
Host 130.105.202.31, his time is 0
Vote: Last yes vote for 255.255.255.255 at -68 (not sync site); Last vote started at -731358866
Local db version is 731358416.1
I am not sync site
Lowest host 130.105.5.27 at -6
Sync host 130.105.5.27 at -6
Sync site's db version is 0.0
0 locked pages, 0 of them for write
This server started at -731358866
Server 10.201.105.130: (db 0.0)
    last vote rcvd at -6, last beacon sent at -6, last vote was no
    dbcurrent=0, up=1 beaconSince=1
Server 27.5.105.130: (db 0.0)
    last vote rcvd at -6, last beacon sent at -6, last vote was no
    dbcurrent=0, up=1 beaconSince=1
****************************************************************

[3/21/93 public]
Up'ing priority from 2 to 0 - this was an IDLE CELL! 
BUILD:	nb available 3/11/93 (aka DFS 2.8)
CONFIG:	3 pmax cell, 2 flservers, all 3 machines = dfs servers and clients
DETAILS:
	DFS healthy and usable when I left Friday the 19th.
	Cell idle from Friday to today, Sunday the 21st.
	All bosserver processes automatically restarted at 4 in the
	morning on all 3 machines. Since then, unable to achieve quorum.
	Time on the 3 machines differs by 3 seconds .
SYMPTOMS:
	dce5 - dfsbind catatonic, flserver process hung
	dce12 - repserver reporting quorum problem
	valentine - (non-flserver) looks okay
dce12's FlLog looks normal:
93-Mar-21 04:00:13 flserver: log initialized to /opt/dcelocal/var/dfs/adm/FlLog
93-Mar-21 04:00:22 flserver: using default group of /.../dce12_cell/fs
93-Mar-21 04:01:35 flserver: cell dce12_cell, trial ID 134228757,,3182475965, 2
servers.
93-Mar-21 04:01:35 flserver: ready to service requests.
dce5's FlLog doesn't:
93-Mar-21 04:00:19 flserver: log initialized to /opt/dcelocal/var/dfs/adm/FlLog
93-Mar-21 04:00:24 flserver: using default group of /.../dce12_cell/fs
in other words, missing last 2 log messages.
udebug on dce5 produces comm failure:
root@dce5> ./udebug -group  /.:/fs
return code 382312470 from UBIKVOTE_Debug
udebug on dce12 produces odd output:
root@dce12> /opt/dcelocal/bin/udebug -group /.:/fs
Host 130.105.202.31, his time is -1
Vote: Last yes vote for 130.105.202.31 at -9 (not sync site); Last vote started at -9
Local db version is 732473521.13
I am not sync site
Lowest host 130.105.202.31 at -9
Sync host 0.0.0.0 at -732732944
Sync site's db version is 732473521.13
0 locked pages, 0 of them for write
This server started at -732732944
Both flserver machines know about each other:
root@dce12> rpccp show group /.:/fs
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: dce errors (code 668147713) from the fileset location server 130.105.202.31 in cell dce12_cell
dfs: fileset (0,,1) is not available!
group members:
  /.../dce12_cell/hosts/dce12/self
  /.../dce12_cell/hosts/dce5/self
root@dce5> rpccp show group /.:/fs
group members:
  /.../dce12_cell/hosts/dce12/self
  /.../dce12_cell/hosts/dce5/self
I have an icl.bind and dfstrace dump on dce5 (/opt/dcelocal/var/dfs/adm:
icl.bind.catatonic, dump.catatonic) - sorry, krpc debugging was not turned
on. Stopping and restarting dfsbind did not cure anything. I have NOT tried
restarting the flserver on dce5 because that would just cover up the 
problem. Please take a look at this before the next automatic restart -
Thanks.

[3/22/93 public]
Vijay and I checked the cell out again today. I discovered that the dfsbind
process was catatonic and that rpccp and cdscp requests as root hang (root
cdsclerk) now (not the case yesterday). Vijay discovered that the flserver
was in a loop calling:
	rpc_ns_entry_object_inq_next
Killing the cdsclerk for root caused the flserver to exit with:
93-Mar-22 13:41:19 flserver: ubik_ServerInit(/.../dce12_cell/fs, subsys/dce/dfs-fs-servers) failed: 282110316 (Error with socket (dce / cds))
The flserver process was restarted and succeeded (with a new cdsclerk). The
core file from the hung cdsclerk looked normal (from John Dugas:
Afraid the dump doesn't help much. I ran cdsclerk on the core and found
that the null thread was in the process of checking to see if there is
pending io for any thread.
(gdb) bt
#0  0x73056584 in select ()
#1  0x7321fd70 in cma__io_available ()
This is a pretty reasonable thing for an idl clerk to be doing.
Except that the clerk shouldn't have been idle - there were requests
pending. Vijay noticed that the cdsclerk was NOT gaining any CPU time
- it was in the "U" state (uninterruptible sleeping process). 
Looks like (potentially) a cds or threads bug ... Debug ideas welcome
for the next time this is seen.

[3/22/93 public]
I just wanted to add some of my notes on debugging the above situation. The
flserver process was hung (not looping) at
rpc_ns_entry_object_inq_{begin,next}
compat_get_group_object_uuid
ubik_ServerInit
flserverDriver
The flserver process was accumulating CPU time slowly but all of it was
within rpc_ns_entry_object_inq_begin or rpc_ns_entry_object_inq_next (which 
one of these two I'm not sure). When Gail killed the hung cdsclerk, 
ubik_ServerInit failed with the error 
93-Mar-22 13:41:19 flserver: ubik_ServerInit(/.../dce12_cell/fs, subsys/dce/dfs-fs-servers) failed: 282110316 (Error with socket (dce / cds))
This error was logged by the flserver, and the flserver quit. The bosserver
then restarted a new flserver. The flservers then achieved quorum.
The fact that dfsbind was catatonic, the flserver hung on a rpc_ns call, and
rpccp and cdscp command hung point to the fact that the cdsclerk was unable
to service requests and was hung. 
root  679 1.0 11.6 12.4M 2.78 ?? S Mar 17 180:48.52 /opt/dcelocal/bin/cdsclerk -U root -u 0 -m 0
root 1469 0.0  4.0 9.05M 984K ??  S Mar 21   0:31.42 /opt/dcelocal/bin/flserver
As can be noticed the cdsclerk has been running since Mar 17. The only baffling
part of this scenario is how the rpccp command worked for Gail on Sunday when
the flserver failed to start up on Sunday morning. Based on the facts we have
it is clear that the cdsclerk is responsible for the hang. The flserver is hung
during startup and has not called rpc_server_listen yet. Without this call
made, ubik RPCs cannot be made and so, the process of quorum establishment has
not begun yet. Since there were only two flservers in the cell, quorum could
be achieved which is perfectly normal. Killing the cdsclerk process seemed to
solve the problem with flserver getting a CDS error code, dfsbind moving from
catatonic to normal state, and fts and cd /.:/fs commands working. 
Based on the above notes, I would suggest lowering the priority, and/or
assigning it to the cds folks. One thing that might aid debugging is to 
run "-g" versions of flserver and cdsclerk. This way, we could use a core
dump to find out the state of the process at the time of hang. I noticed
that the flserver binary on dce5 was not built with symbols and the same may
be true of cdsclerk. The other aid would be to get a debugger that can 
attach to running process and be thread aware to get stack back traces of
each thread.

[3/22/93 public]
Thanks for clarifying Vijay. Unfortunately, the OSF/1 ref plat doesn't
support attaching a debugger to a running proc. I've been seeing problems
with CDS in DFS cells (CRs 7530,7307 and 7134) so this may be related/a
dup of those. I've altered the short description, component and responsible
engineer to reflect the CDS portion of the problem. Hopefully someone can
suggest a non-verbose way to trace the root cdsclerk's activites.

[3/23/93 public]
Thanks!
Adding DFS readers to the CC list.
Changed Interest List CC from `pakhtar@transarc.com,jd' to 
 `pakhtar@transarc.com,jd,dce-ot-dfs,cfe,vijay'

[3/23/93 public]
One last piece of information - the original catatonic dfsbind process (ie.
on Sunday) was doing a call to:
	rpc_ns_entry_inq_resolution

Last lines of the icl.bind file were:

time 4.199684, pid 786: helper read: exit code:114
time 4.199684, pid 786: helper read: entry
time 4.199684, pid 786: ProcessRequest: entry
time 4.199684, pid 786: do_auth_request: entry
time 4.340364, pid 786: do_auth_request: exit code:0
time 4.340364, pid 786: ProcessRequest: exit code:0
time 4.340364, pid 786: helper write: entry
time 4.359894, pid 786: helper write: exit code:786
time 4.367706, pid 786: helper read: exit code:794
time 4.367706, pid 786: helper read: entry
time 4.367706, pid 786: ProcessRequest: entry
time 4.367706, pid 786: do_auth_request: entry
time 4.480980, pid 786: do_auth_request: exit code:0
time 4.480980, pid 786: ProcessRequest: exit code:0
time 4.480980, pid 786: helper write: entry
time 4.512228, pid 786: helper write: exit code:387
time 286.202312, pid 786: helper read: exit code:23
time 286.350740, pid 786: helper read: entry
time 286.397612, pid 786: ProcessRequest: entry
time 286.471826, pid 786: sec_id_parse_name: entry name=/.../dce12_cell
time 286.780464, pid 786: sec_id_parse_name: exit code:0
time 286.819524, pid 786: dfs_GetJunctionName: entry
time 288.678923, pid 786: dfs_GetJunctionName: exit code:0
time 288.678923, pid 786: rpc_ns_entry_inq_resolution: entry

[3/25/93 public]
Downgrading to a "2" until seen again. Using single cdsclerk setup to
catch problem next time with debug info.

[09/27/93 public]
This wasn;t seen throughout the 1.0.2 system test cycle and we can;t
reproduces it now. Cancelled.



CR Number                     : 7419
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : kernel TLB miss in streams driver
Reported Date                 : 3/4/93
Found in Baseline             : 1.0.2
Found Date                    : 3/4/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Status               : open

[3/4/93 public]
Kernel TLB miss while running lots of things on a pmax in a CHO cell.
the machine paniced after ~12 hours of heavy use:
Ksegv pc = 80158354, va = 0, sp = c391a628
Kdb kernel trap [test7a]: TLB miss (read) trap, code=0
stopped at      putq_owned+230: sw      s0,0(v0) <0>    <s0=c27d6800,v0=0>
kdb> $k
thread 0xc13f8000, pcb 0xc391ac08, W_EVENT 0
<Exception frame> Cause=0x30000008 Badvaddr=0x0 SR=0xff14 EPC=0x80158354
0xc391a6cc putq_owned() from putq+54
0xc391a6fc putq() from strtty_wput+1d4
0xc391a71c strtty_wput() from csq_lateral+c8
0xc391a74c csq_lateral() from puthere+68
0xc391a77c puthere() from ldtty_start+e8
0xc391a79c ldtty_start() from ldtty_write+2bc
0xc391a7c4 ldtty_write() from ldtty_wput+e8
0xc391a7fc ldtty_wput() from csq_lateral+c8
0xc391a82c csq_lateral() from puthere+68
0xc391a85c puthere() from osr_write+694
0xc391a87c osr_write() from osr_run+2d8
0xc391a8d4 osr_run() from pse_write+bc
0xc391a914 pse_write() from spec_write+12c
0xc391a94c spec_write() from ufsspec_write+70
0xc391a9bc ufsspec_write() from vn_write+238
0xc391a9f4 vn_write() from rwuio+16c
0xc391aa54 rwuio() from write+50
0xc391aa94 write() from syscall+27c
0xc391aadc syscall() from VEC_syscall+44
0xc391ab64 VEC_syscall()
         <Exception frame> Cause=0x20 Badvaddr=0x100000f4 SR=0xff3c EPC=0x405020
kdb> $r
at    1
v0    0
v1    0
a0    c253c88c
a1    c27d6800
a2    801dfe30  strtty_wput
a3    c253c8e8
t0    c2503f00
t1    0
t2    0
t3    0
t4    0
t5    0
t6    0
t7    0
s0    c27d6800
s1    c27d6800
s2    c253c88c
s3    0
s4    0
s5    c253c68c
s6    c270fa00
s7    400
t8    804f9e14  partab+20
t9    0
k0    800d2d50  simple_unlock+6c
k1    80158354  putq_owned+230
gp    ff3d
sp    c391a6cc
s8    c391a77c
ra    80157d04  putq+5c
sr    ff14
lo    c
hi    0
badv  0
cs    30000008
pc    80158354  putq_owned+230
putq_owned+230: sw      s0,0(v0) <0>    <s0=c27d6800,v0=0>
kdb> putq_owned+190,50/ia
putq_owned+190: nop
putq_owned+194: lw      v0,8(s1)
putq_owned+198: nop
putq_owned+19c: bne     v0,zero,putq_owned+20c
putq_owned+1a0: nop
putq_owned+1a4: lw      v0,10(s1)
putq_owned+1a8: lw      a0,c(s1)
putq_owned+1ac: nop
putq_owned+1b0: subu    s3,v0,a0
putq_owned+1b4: slt     at,zero,s3
putq_owned+1b8: beq     at,zero,putq_owned+20c
putq_owned+1bc: nop
putq_owned+1c0: lw      v0,8(a1)
putq_owned+1c4: nop
putq_owned+1c8: subu    v0,v0,v1
putq_owned+1cc: slt     at,v0,s3
putq_owned+1d0: bne     at,zero,putq_owned+20c
putq_owned+1d4: nop
putq_owned+1d8: move    a1,v1
putq_owned+1dc: move    a2,s3
putq_owned+1e0: jal     bcopy
putq_owned+1e4: nop
putq_owned+1e8: lw      v0,10(s0)
putq_owned+1ec: nop
putq_owned+1f0: addu    v0,s3,v0
putq_owned+1f4: sw      v0,10(s0)
putq_owned+1f8: move    a0,s1
putq_owned+1fc: jal     freeb
putq_owned+200: nop
putq_owned+204: j       putq_owned+248
putq_owned+208: nop
putq_owned+20c: move    s3,zero
putq_owned+210: move    s0,s1
putq_owned+214: lw      v0,8(s2)
putq_owned+218: nop
putq_owned+21c: sw      v0,4(s0)
putq_owned+220: beq     v0,zero,putq_owned+23c
putq_owned+224: nop
putq_owned+228: lw      v0,8(s2)
putq_owned+22c: nop
putq_owned+230: sw      s0,0(v0)
putq_owned+234: j       putq_owned+240
putq_owned+238: nop
putq_owned+23c: sw      s0,4(s2)
putq_owned+240: sw      s0,8(s2)
putq_owned+244: sw      zero,0(s0)
putq_owned+248: beq     s3,zero,putq_owned+268
putq_owned+24c: nop
putq_owned+250: lw      v0,18(s2)
putq_owned+254: nop
putq_owned+258: addu    v0,s3,v0
putq_owned+25c: sw      v0,18(s2)
putq_owned+260: j       putq_owned+298
putq_owned+264: nop
putq_owned+268: lw      v0,10(s0)
putq_owned+26c: lw      v1,c(s0)
putq_owned+270: nop
putq_owned+274: subu    v0,v0,v1
putq_owned+278: lw      v1,18(s2)
putq_owned+27c: nop
putq_owned+280: addu    v0,v0,v1
putq_owned+284: sw      v0,18(s2)
putq_owned+288: lw      s0,8(s0)
putq_owned+28c: nop
putq_owned+290: bne     s0,zero,putq_owned+268
putq_owned+294: nop
putq_owned+298: jal     splimp
putq_owned+29c: nop
putq_owned+2a0: move    s0,v0
putq_owned+2a4: addiu   a0,s2,7c
putq_owned+2a8: jal     simple_lock
putq_owned+2ac: nop
putq_owned+2b0: lw      v0,18(s2)
putq_owned+2b4: lw      v1,28(s2)
putq_owned+2b8: nop
putq_owned+2bc: sltu    at,v0,v1
putq_owned+2c0: bne     at,zero,putq_owned+2d8
putq_owned+2c4: nop
putq_owned+2c8: lw      v0,1c(s2)
putq_owned+2cc: nop
putq_owned+2d0:
Added field Transarc Deltas with value `' 
Added field Transarc Status with value `open'

[03/04/93 public]
Comments from Tom Talpey (tmt@osf.org):

I need to calibrate my instruments. This is DCE 1.0.2, meaning it's
running on a Pmax with OSF/1 1.1.1? Also, it appears this was a write
to a hardware TTY, is this correct?

If both these answers are yes, I believe it's a known bug which, due to
the reference platform change, has been deferred indefinitely. However,
I know of a fairly straightforward fix (the driver fails to protect
itself with spltty()). Let me know and I'll investigate further.

Thanks for the report.

Tom Talpey.

[03/11/93 public]
I have made changes to the console driver in OSF/1 1.1.1 that are meant
to address this bug.  The new driver works at OSF in our usage patterns
(very limited local console access + use of X on console display) as
well as the old driver did.  However, we've never seen the Streams
failure described here, because we don't use the PMAX console like
Transarc does.  I do not know whether the new driver would make
Transarc's usage pattern (heavy remote console access) work better.

I asked Elliot Jaffe yesterday if he'd be willing to test the new
driver to see if the Streams problem had gotten better -- the short
answer is that he didn't think that would be worthwhile.  Transarc has
worked around the occasional failures they've seen, and will not be
using OSF/1 on their PMAX's after DCE 1.0.2 (real soon now).

So I believe that it's not worthwhile to submit the new driver before
1.0.2.  There's a good chance that it will never be submitted at all,
in which case this defect should eventually be cancelled.

For now, reduce the priority and defer the defect.  If Elliot or
anyone else at Transarc changes their minds, we can revisit this.

[04/27/93 public]
Oops...  Missed this one in scanning OT for defects assigned to me.

[09/28/93 public]
PMAX OSF/1 is no longer a reference platform.  Cancelled.



CR Number                     : 7407
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : episode
Short Description             : assert in vnm_Rouse after hitting disk quota
Reported Date                 : 3/3/93
Found in Baseline             : 1.0.2
Found Date                    : 3/3/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[3/3/93 public]
2 machine hetero cell
core components on pmax
ufs root.dfs on pmax, RIOS jfs and PMAX Episode filesets 
mounted underneath.
As a DFS client on the PMAX, while copying test binaries into the 
PMAX Episode fileset, got multiple "server disk quota exceeded 
messages" followed by an assertion failure on the PMAX at line 1373 
of efs_misc.c.  Looking at source, I believe cause of assert is 
non-zero error return from call to epif_Open() in vnm_Rouse().
kdb says stack is:
gimmeabreak
Debugger
vnm_Rouse
vnm_Unrouse
but I think it's confused and actual stack trace is (based on manual
examination of stack contents):
gimmeabreak
Debugger
vnm_Rouse
Recycle
efs_reclaim
nosf_reclaim
The machine is still in kdb if I can gather any further info, but I
can't guarantee how long it will stay that way.  I'm not sure the return 
value from epif_Open() is accessible at this point since there's been 
an intervening function call to blow away the register.

[3/3/93 public]
At Bruces's request, here's the raw stack (or at least part of it):
c2abd200		c2abd200	c2953200		6
vnm_Rouse+68		c2a3fe8c	0			c2a4ac8c
copyright+9844 		55d		copyright+97a9		2
c2abd200		vnm_Unrouse+104	processory_array	VEC_tlbmiss+28
a010			94c38		0			fff05558
c2abd200		c2abd200	c3ad98a4		efs_reclaim+78
c2abd258		c2abd200	simple_unlock+6c	(blank)
VEC_tlbmiss+28		c1551e88	U_ADDRESS+4		0
ff34			vnode_stats+c	c3ad9894		c2abd200
vinvalbuf+24c		c2abd200	nosf_reclaim+54		8
c2d96204		8		3b8			c2abd278
c2abd200		c2abd200	xglue_reclaim+54	(blank)
0			dead_vnodeops	5a32			icache_stats+c
c3ad98a4		vclean+ec	20004			vclean+1d4
simple_unlock+6c	(blank)		5a32			c2abd200
dead_vnodeops		2		1			ufs_vnodeops
c274e000		vgone+174	vgone+150		simple_unlock+6c
iget+134		c2953794	c3ad97f4		simple_unlock+6c
getnewvnode+1c4		c2abd200	vnode_stats+c		c3ad9894
getnewvnode+340		3000000c	getnewvnode+24c
Changed Interest List CC from `ota@transarc.com, bwl@transarc.com' to 
 `ota@transarc.com' 
Changed Responsible Engr. from `pakhtar@transarc.com' to `bwl@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[3/12/93 public]
We don't have enough information to go any further on this.  Assigned to
Ron to attempt to reproduce, and cancel if we don't see it under 2.8.  I've 
dropped the priority since it hasn't been reproduced and there is nothing
we can do with the current information.  Please call us when/if this 
occurs again.
Changed Priority from `1' to `2' 
Changed Responsible Engr. from `bwl@transarc.com' to `rsarbo'

[3/30/93 public]
We've seen something which appears to be the same thing as this with
b20.  I had a 1 cell machine (pmax) with an episode fileset which
was mounted locally, but not accessed through dfs.  I was copying a
file tree to this episode fileset when the paritition on which this
fileset resided ran out of space.  Shortly afterward the machine 
crashed because it attempted to reference a bad address of 0x06.
The stack was
  vnm_Unrouse +fc
  vnm_Rouse +2c
  epif_Open +ac
epif_Open +ac corresponds to lw a1,4(s0); s0 at this point is 2
This is the instruction right before jal epid_IndexFromFid.
Here's some information I collected about the vnode which this
code was operating on:
v_usecount=0
v_holdcount=0
v_flag=0x20004 - VXLOCK|V_CONVERTED
v_op -> this has the xglue*, efs*, nosf* routines
vfreef, vfreeb = 0
vmountf, vmountb = 0
vtype = VNON
v_mount = dead_mount
efs specific data:
vd_flags = 4
vdu_volp = 2

[4/7/93 public]
Changed Transarc Status from `open' to `import'

[4/19/93 public]
Not sure why this was changed to import.  If there is a delta, can
someone please ot export this and add it here.
Changed Transarc Status from `import' to `open'

[6/7/93 public]
We've not seen this in >2 months. Cancelling.



CR Number                     : 7401
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : TLB miss (read) - cm_CheckSize
Reported Date                 : 3/2/93
Found in Baseline             : 1.0.2b17
Found Date                    : 3/2/93
Severity                      : A
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[3/2/93 public]
BUILD:	b17 (aka dfs 2.6)
CONFIG:	4 pmax cell
	PMAX1	- sec, cds, dts, fl server and dfs client
	PMAX2	- dts, fl server and dfs client
	PMAX3	- dts, fl server and dfs client
	PMAX4	- file server and dfs client
root.dfs in ufs on PMAX1
all dfs clients with small (100 block) caches
registry altered such that default cert lifetime = forever but
server principal cert lifetimes = 10h and gmd cert lifetime = 4d
Had run dfs.glue successfully for 5 hours to a ufs partition on PMAX2,
then the dfsbind's on PMAX1 and PMAX4 core dumped (core files unusable -
Diane tried to look at them) and shortly (but definitely not immediately)
after that the test on PMAX2 hung the rest of the night.
Next day -> Connection timed out/lost contact errors appear and then disappear
with a new dce_login - although lifetime of certificate had at least 3 days.
dfstrace dump, kill -30 (dfsbind_pid) and drop into kdb to look around.
Come back up - correct time - test still hanging - no activity in cell and PMAX2crashes with:
TLB miss (read)
cm_CheckSize() from end+###
That's all kdb would tell me - couldn't continue.
Long description included because I doubt this will be easily reproducable
(note no activity at time of crash). I have the dump, iclbind and notes
on some of the threads. High priority on bugs found by system test a policy.

[3/3/93 public]
Clearly, this is going to be tough to reproduce or verify.  I did learn
something, though, which is that the only call to cm_CheckSize() in the
whole system is from a procedure that services the pioctl() that sets
a new cache size.  One micro bug is that cm_CheckSize is called to reduce
cache usage to the requested amount before sanity-checking the input
value.  So it becomes very interesting to know what you were trying to set
the cache size to (e.g. with ``cm setcachesize'' or an equivalent).
And there must have been such a process running, or else this stack trace
is totally useless.
.
The unusable dfsbind core dumps will also contribute to the amorphous
and fundamentally insoluble nature of this report, unless it's a
reproducible case.
Filled in Interest List CC with `cfe' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[3/4/93 public]
Thanks for the info Craig - cancelling since the kdb stack trace must
be garbage - no cm commands were being issued at the time - the hung
test may have come back to life but it's only a basic file write/read
test - not something that directly manipulates cache parameters.

[4/23/93 public]
BUILD:	102a available 4/26/93
CONFIG: 3 pmax cell, 3 flservers
TEST:	client to both a glue and a lock run - definitely no cm set/get
	cache size commands running

Same questionable kdb stack trace seen again - unfortunately I rebooted
before realizing this. Re-opening, dropping to a "2" and assigning to
myself. NEXT time ...

[05/28/93 public]
Haven't seen this one - cancelling.



CR Number                     : 7379
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : rpc_ns
Short Description             : clean up classversion optimization
Reported Date                 : 3/1/93
Found in Baseline             : 1.0.2
Found Date                    : 3/1/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/1/93 public]

David Magid of DEC reviewed the change I made for 7351 and found it to be
ok; however (as might be expected) he wanted to make a minor change to it.
He wrote:

   I don't see anything wrong with the code changes made for this.

   However, I probably would have done it a bit differently. I would have:

   - added the boolean field classversion_checked to the rpc_nsentry_t
     structure

   - initialized the field to false in rpc__nsentry_from_entry()

   - tested the field in rpc__ns_check_rpc_class_version(), called
     dnsReadAttrValue() as necessary, and change the field to true

   Both the lookup node (rpc_lkup_node_t) and inquiry context 
   (rpc_ns_inq_rep_t) contain an nsentry, so there'd be no need to
   modify those structures. 
   
   I'd prefer this alternative - it better localizes the change (to
   rpc_nsentry_t and rpc__ns_check_rpc_class_version()) and doesn't
   need to involve any of the lookup code.

Rather than delaying the submit of this known, working, performance
improvement, we're going to submit it as-is, and defer cleaning it up until
after 1.0.2..

[07/20/93 public]
Unless you wich to make the changes Bill, this isn't going get done.

Canceled.  Please re-open if you have the cleanup ready (tested of course!).



CR Number                     : 7350
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : rpc debugging
Short Description             : Hangs dce_login.
Reported Date                 : 2/24/93
Found in Baseline             : 1.0.1
Found Date                    : 2/24/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[2/24/93 public]
With the environment variable RPC_DEBUG set to the value,
  2-5.255,10.255,15.255,18.255,22.255,26.255
I tried doing a dce_login.  After issuing the following message, it just
hung.
(pkt_make_reservation) blocking call, pkts 0 [007d8a02-e231-1b1b-be6c-08005a4d2084, 0.0]
This was on OSF build b15.
(OT required me to put a responsible engineer, sorry Bill.)
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[2/24/93 public]

The particular DEBUG values you've come up with tell the DG protocol to

    1) create a packet pool of size 0
    2) drop 40% of all transmitted packets

(of course #2 is hardly a problem, given #1)

[8/27/93 public]

This will go away at 1.1, as part of the serviceability mods.

[08/27/93 public]
Lower the priority on this one since it wont be fixed till 1.1.

Also, the user caused the error by setting incorrect debug flags,
an argument can be made that being able to shoot yourself in the foot
with debug isn't really a bug....  Should we close this one?

[8/27/93 public]

Yes, I think so.  The functionality which was (incorrectly) used
above will not be removed at 1.1, it will just be accessible through some
other mechanism.  If a user finds the new back door, they can cause the
same failure;  I think the important thing is that this not be something
a user can do unknowingly.

[8/27/93 public]
Complete documentation of the DEBUG values would help.  The Porting and
Testing Guide is very weak on this subject and should be updated.  Perhaps
this should be changed to a doc bug.

[08/31/93 public]
I am canceling this defect and will open a doc bug for 1.1 to get
the description of RPC_DEBUG enhanced.

[08/31/93 public]
Actually, the 1.0.2 Porting and Testing Guide has a nice section on
RPC_DEBUG (3.5.1).  I think all the info needed is there, so I'm
not going to open a doc bug.



CR Number                     : 7316
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : mx300
S/W Ref Platform              : sinix
Component Name                : thr
Subcomponent Name             : 
Short Description             : probable parse error in cma_px.h
Reported Date                 : 2/22/93
Found in Baseline             : 1.0.2
Found Date                    : 2/22/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : src/threads/cma_px.h
Sensitivity                   : public

[2/22/93 public]
Looking through cma_px.h I found the following:

/*
 * CONSTANTS AND MACROS
 */

#if (!_CMA_REENTRANT_CLIB_) || (_CMA_UNIX_TYPE ==  _CMA__SVR4)
   #if (_CMA_UNIX_TYPE ==  _CMA__SVR4)
     #if !defined(_REENTRANT_LIBC_) && !defined(_REENTRANT_RTLD_) && \
         !defined(_REENTRANT_MALLOC_)!defined(__REENTRANT_EXIT_) && \
         !defined(_REENTRANT_STDIO_) && !defined(_REENTRANT_LIBGEN_) && \
         !defined(_REENTRANT_LIBM_) && !defined(_REENTRANT_NSL_) && \
         !defined(_REENTRANT_LIBNSL_) && !defined(_REENTRANT_LIBSOCKET_) &&\
          !defined(_REENTRANT_LIBRESOLV_) && !defined(_REENTRANT_TCPIP_)
            #define sigaction cma_sigaction
      #endif
   #else
# ifndef _CMA_NOWRAPPERS_
#  if !_CMA_THREAD_IS_VP_
#   define sigaction cma_sigaction   
#  endif
# endif
   #endif  /*_CMA__SVR4 */
#endif

In addition to the indentation style chosen bein unreadable, the line with
_REENTRANT_MALLOC seems to be in error.  There needs to be an && between
the two conditions tested for on that line.  Also I would bet that the
second conditional on that line has one too many leading underscores (i.e.,
it should be _REENTRANT_EXIT_ and not __REENTRANT_EXIT_).  Also couldn't the
conditionals have been broken up a little better so that OS == SVR4 isn't
tested for on both the first and second lines.

[Fri Jul 16 12:48:35 EDT 1993 public]

This file has been changed.  Hopefully the indentation style is
more readable and all typos have been fixed.

Since this is not assigned to me anymore, I am not going to change the
state.  If it is not agreed that this has been fixed, please post more
information about what other problems should be fixed.

[8/9/93 public]
Inspection of the code shows this was fixed as part of the merge by hinman@sni
(file cma_px.h, rev. 1.1.7.2).



CR Number                     : 7312
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : Recreating an exported UFS filesystem makes mount point "impassible"
Reported Date                 : 2/22/93
Found in Baseline             : 1.0.2b16
Found Date                    : 2/22/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[2/22/93 public]
Note:  this defect was observed in a system installed from DFS 2.4.  I
have not upgraded the test system to 2.6 due to the continuing serious
problems Diane et al. have had in using the NB since 2.6 was dropped.
I have not been able to try reproducing this under 2.6 due to a lack
of crash machines with spare disk partitions.
Given a single-machine cell in which a UFS filesystem has been
exported, it seems that an operation that "re-creates" the filesystem
(i.e., that overwrites the existing root inode with one containing a
new generation number) can change the behavior of the filesystem when
it's remounted.  The change is that traversal of the mount point for
the filesystem fails in the "upward" direction.  For instance, running
pwd in the root of the filesystem will print "/".  Sometimes, trying to
cd out of the filesystem via a relative pathname ("../newfileset" or
whatever) also fails.
This problem seems always to occur on a filesystem that has been
newly-restored from a dump via the "fts restore -overwrite" command.
The problem sometimes occurs on a previously-exported filesystem that
is detached/unmounted, newfs'd, then remounted/re-exported.
Here is a log that illustrates the problem.  "/u1/ppd" is a program
that prints the device/i-number of successive parent directories
of "." until it reaches what seems to be the root of the directory
tree.
In this first output (from Saturday), the problematic fs is exported at
/.:/fs/fire.fs2.  fire.fs1 is another UFS fs that hadn't been touched
since the machine was booted.
        root@fire  # cd /.:/fs
        root@fire  # pwd
        /.../fire_cell.osf.org/fs
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = ffff0066
        path ./../: current dev = 1, current ino = ffff0065
        path ./../../: current dev = 1, current ino = 2
        path ./../../../: current dev = 800, current ino = 2
        current == root
        root@fire  # cd fire.fs1
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = 10009
        path ./../: current dev = 1, current ino = ffff0066
        path ./../../: current dev = 1, current ino = ffff0065
        path ./../../../: current dev = 1, current ino = 2
        path ./../../../../: current dev = 800, current ino = 2
        current == root
Note that we can't traverse the mount point of fire.fs2 at all:
        root@fire  # cd ../fire.fs2
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = 70002
        current == previous
        root@fire  # pwd
        /
        root@fire  # cd ..
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = 70002
        current == previous
        root@fire  # pwd
        /
        root@fire  # cd ../fire.fs1
        ../fire.fs1: No such file or directory
fire.fs1 is still available, however:
        root@fire  # cd /.:/fs/fire.fs1
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = 10009
        path ./../: current dev = 1, current ino = ffff0066
        path ./../../: current dev = 1, current ino = ffff0065
        path ./../../../: current dev = 1, current ino = 2
        path ./../../../../: current dev = 800, current ino = 2
        current == root
        root@fire  # pwd
        /.../fire_cell.osf.org/fs/fire.fs1
Today, things look a bit different.  I've just restored a new
dump into fire.fs2:
        root@fire  # cd /.:/fs/fire.fs2
        root@fire  # pwd
        /
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = 70002
        current == previous
So pwd (i.e., getcwd()) still seems unable to traverse the mount
point of fire.fs2, but I can cd out of fire.fs2 via a
relative pathname:
        root@fire  # cd ../fire.fs1
        root@fire  # pwd
        /.../fire_cell.osf.org/fs/fire.fs1
        root@fire  # /u1/ppd
        root dev = 800, root ino = 2
        path ./: current dev = 1, current ino = 10009
        path ./../: current dev = 1, current ino = ffff0066
        path ./../../: current dev = 1, current ino = ffff0065
        path ./../../../: current dev = 1, current ino = 2
        path ./../../../../: current dev = 800, current ino = 2
        current == root
Craig Everhart speculates that a cache entry within the CM is
not being invalidated when the UFS filesystem is detached.  That
sounds about right...

[2/22/93 public]
Filled in Interest List CC with `kazar@transarc.com' 
Filled in Responsible Engr. with `jdp@transarc.com' 
Filled in Resp. Engr's Company with `tarc' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[02/23/93 public]
I've had a chance to merge up the OSF/1 volops code to DFS 2.6, and to
test the failure scenario described here on a single-machine PMAX cell
installed from the current OSF NB, which is based on 2.6.  I have not
been able to reproduce the failure so far.  Details:
	On a filesystem that's overwritten with fts restore, there
	seems no longer to be a problem.  Both pwd and the parent
	directory printer function normally.
	If I try the other way of reproducing the failure (detach,
	newfs, re-attach a DFS-exported UFS filesystem), I find that
	I can no longer do the detach.  If I try, I see this pair
	of messages:
		root@fire  # ./do-u 3d
		+ dfsexport -detach /dev/rz3d 
		dfsexport: Revoking tokens for filesets on aggregate 2231311...
		dfsexport: Failed to detach /dev/rz3d:/fs1 (Device busy)
Carl mentioned yesterday that you could no longer detach locally-mounted
"filesets" (i.e., UFS filesystems).  If this is known and intended
behavior, then I'm willing to say the defect described by this CR no longer
exists.
If someone will please confirm that the dfsexport behavior noted above
is correct, I will cancel this defect.
Thanks.

[2/24/93 public]
adding me to CC list.
I don't believe that it was our intention to prevent the detaching of
non-LFS filesets in the dfsexport stuff, even though they're mounted
locally.  We have several restrictions on what you can do to locally-mounted
filesets (you can't destroy them, you can't move them to another server),
but I think that you should be able to change your mind and stop exporting
a fileset.
There's a bug (OT 7225, fix included in DFS 2.7 as
jdp-ot7225-fix-detach-refcount-management) that corrects at least some of
the problems we had in detaching filesets with dfsexport that were new in
DFS 2.6.
Changed Interest List CC from `kazar@transarc.com' to `kazar@transarc.com, 
 cfe@transarc.com'

[02/24/93 public]
Per phone conversation with Pervaze:  Though the symptoms noted
here have "disappeared" in DFS 2.6, the people at Transarc who have
looked at the relevant CM code are convinced that a problem still
exists.  Since the latent bug(s) are no longer holding up my
testing of the new OSF/1 volops code, we agreed to reduce the
priority of this defect -- but with the understanding that Transarc
will continue analyzing it with a view to fixing it in 1.0.2.
There's apparently a good deal of surprise that the scenario
described here (restoring atop an exported UFS filesystem) doesn't
cause more problems than it seems to.  If, for whatever reason,
the bug does again become more visible, we may have to raise the
priority again.  When OSF receives DFS 2.7, I will again try
to detach exported UFS partitions.  Assuming that then succeeds,
I'll try to reproduce this mount point weirdness using that
method, as well.

[2/24/93 public]
The actual work to resolve this problem is in Mike Kazar's domain.
Changed Interest List CC from `kazar@transarc.com, cfe@transarc.com' to 
 `jdp@transarc.com, cfe@transarc.com' 
Changed Responsible Engr. from `jdp@transarc.com' to `kazar@transarc.com'

[7/7/93 public]
Just as a reminder.  The cause of the problem of traversing .. up from the
root of a UFS fileset seemed to be this.  The uniquifier of the root directory
of a filesystem can change when the filesystem is restored.  As it happens,
both JFS and Episode use a uniquifier of 1 for the root directory of all
filesets, but OSF/1 UFS (and probably other UFSes also) start the uniquifier
at an arbitrary value.  Now, when the CM traverses a mount point into a UFS
fileset, it looks up the afsFid for the root directory and remembers it in
the volp->rootFid field for the volume, as well as in the scp->mountRoot
information.
 
Now, if that UFS fileset has a complete dump restored to it, in general the
uniquifier of the root directory will change.  The vnode number of the root
directory will not generally change, though I suppose it might.  It's my
guess that the CM isn't handling this change in uniquifiers well, and that
it is perhaps reporting obsolete information for the value of '..' in the
fileset's root directory.
 
Just for clarity, the situation is that there are two UFS filesets, U1 and U2,
created/newfs'ed at different times, with different uniquifiers on their
root directories.  There are DFS mount points for both of these filesets--
in particular, for fileset U2.  The CM has traversed the mount point into U2,
and has thus cached information about it.  Fileset U1 is then dumped, and
is restored onto fileset U2, thus changing the uniquifier for its root
directory.
 
FYI, the only signal that is generated at present to mark this restoration
is that read&write data&status tokens are revoked for the target fileset.
 
I believe that when Don Bolinger was working on this problem, he attempted
to change the OSF/1 UFS dump and restore operations to force the root
directory's uniquifier to 1, in order to achieve interoperability with JFS
and Episode, but I can't find evidence of that now.

[7/19/93 public]
I took a look at the CM code, and as far as I can tell, things should
work in 1.0.3, *as long as you do a "cm checkft"* command after doing
the restore.  The issue is this: there no object that gets a callback
when the root file ID changes for a file system.  Frankly, I can't
quite see why the file ID *is* changing in this case, rather than
being restored, but that's a different issue.
In any event, when we have data not connected with a token, we
typically revalidate it on a periodic basis, and provide the "cm
checkft" command to trigger these checks on a demand basis.
I've looked through the code, and it looks to me like a checkft
command will force the revalidation of all of the mount points in the
cache.  When we cruise through the mount point again (you'll have to
re-CD, since you're CD'd to a stale vnode right now), the
cm_EvalMountPoint function should mark the new root as a fileset root,
and setup the ".." pointers properly.
I'd like to cancel this bug, unless someone can replicate it in the
1.0.3 code base after doing the "cm checkft" command.

[8/17/93 public]
                                                                              
Don, I have run the same test scenario on RIOS/103 (dfs-103-3.25) with the 
test program you provided to try to reproduce this problem. I could not 
reproduce it. The cm restore works just fine. 
                                                                              
In fact, you mentioned in this report dated [bolinger 02/23/93 public] that 
you even could not reproduce it. I believe, as Mike indicated above also,  
that the problem no longer exists. Unless you have further suggestions, I 
would like to ask you to cancel it. 
Thanks, 
Tu
Changed Interest List CC from `jdp@transarc.com, cfe@transarc.com' to 
 `jdp@transarc.com, cfe@transarc.com, tu@transarc.com'

[8/18/93 public]
I've assigned this to Ron since Don no longer works on the DFS.
Changed Responsible Engr. from `kazar@transarc.com' to `rsarbo'

[8/18/93 public]
Cancelling after speaking with Don.



CR Number                     : 7307
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : Unable to see namespace after reboot
Reported Date                 : 2/22/93
Found in Baseline             : 1.0.2
Found Date                    : 2/22/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/22/93 public]

Low priority since I haven't seen this before and doubt I'll see it
again soon ...

BUILD:	nb available 2/17
CONFIG:	3 pmax cell, 1 = sec+cds server, all 3 = fl servers and dfs clients
DETAILS:
Config cell successfully (btw, all 3 on different subnets). Reboot the pmax
that happens to house root.dfs. Unable to bring up the file exporter after
the reboot:

fxd -mainprocs 7 -admingroup subsys/dce/dfs-admin 
fxd: can't get the DFS junction name for cell /.../dce12_cell: entry not found (dce / rpc)

All cdscp show attempts fail as well:
cdscp show dir /.:

                        SHOW
                   DIRECTORY   /.../dce12_cell
                          AT   1993-02-22-06:00:19
Error on entity: /.../dce12_cell
Requested entry does not exist (dce / cds)
Function: dnsEnumAttr
dnsEnumAttr: partial results = %x000000000000000000000000000000000000

Stop and restart sec + cds daemons with an events file for cdsadv and
cdsclerk.

Here's what they contain after 2 attempts to list dir /.:/hosts/* (unauth
and auth) and the above show dir attempt.

(Feel free to cut them down to the useful portions)

CDSADV.LOG
----------------------------------------------------------------------

Unloading cache
Kill pid 26890
Kill pid 26870
 >InitEvent()
 <InitEvent() return(1)
 >dnsInitAdver()
 >CAInitLocks
 >InitiateTimer(1)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <InitiateTimer(1) return(1)
 >InitiateRandomTimer(0)
 >RandomizeInterval()
 <RandomizeInterval()
 >InitiateTimer(0)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <InitiateTimer(0) return(1)
 <InitiateRandomTimer(0)
 <dnsInitAdver() return(1)
 >adver_rpc_start()
 >dthread_lock(0x10071178)
 >dthread_create(,0x10000470,0x410a54,0x10072200)
 >th_birth(0x410a54,0x10072200,268436592->(adver_rpc_thread,0))
 <th_birth(0x410a54,0x10072200,0x10000470->(adver_rpc_thread,0)) return(0x10070930)
 <dthread_create(0x10070930,0x10000470,0x410a54,0x10072200) return(282107905)
 >dthread_unlock(0x10071178)
 <adver_rpc_start() return(0x10072200)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >dthread_create_mutex()
 >dthread_create_condition()
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
><dthreads: switch to 0x10070930->adver_rpc_thread
 >adver_rpc_thread() return(0x00000000)
 >dthread_lock(0x10071178)
 >dthread_signal(0x100711b8)
 >dthread_unlock(0x10071178)
><dthreads: switch to 0x10070030->main
  GetNextEvent() 0=select(256,00000000000001011,0,00000000000000011)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetTimeEvent(0)
 >CancelTimer(0)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <CancelTimer(0)
 <GetTimeEvent(0,0x10001008->ETdnsSolicit)
 >ScheduleTimeEvent()
 <ScheduleTimeEvent()
 <GetNextEvent() return(0x10001008->ETdnsSolicit)
 >ProcessEvent(0x10001008->ETdnsSolicit)
 >dnsSolicit(0x10001008->ETdnsSolicit)
 >cds_bind(7fffe6b8,)
 <cds_bind(7fffe6b8,) return(TRUE) protseq(ncadg_ip_udp)
 <dnsSolicit(0x10001008->ETdnsSolicit)
 >ProcessEvent(0x10001008->ETdnsSolicit) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
><dthreads: switch to 0x10070a30->*foreign*
 >cds_Solicit_s()
 >cds_SendAdvertisements()
 >dthread_create_mutex()
 >dthread_create_condition()
 >dthread_lock(0x100715f8)
 >dthread_unlock(0x100715f8)
 >dthread_lock(0x100715f8)
 >dthread_signal(0x10071638)
 >dthread_unlock(0x100715f8)
 <cds_SendAdvertisements()
 <cds_Solicit_s()
 >cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 <cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 >cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 <cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 >cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 <cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 <cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 >cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 <cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 <cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 >cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 <cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
><dthreads: switch to 0x10070030->main
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >GetConnectEvent(000000000000000100000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetConnectEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(1)
 >GetConnectEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetConnectEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetExceptEvent(000000000000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >GetConnectEvent(000000100000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111)
 <GetConnectEvent(000000100000000000000000000000000000000000000000000000000000000000010101001001111111111111111110000001010010011111111111111111100000000000000000000000000000000000010011001001111111111111111110000001111000011100100100110011100011111100000000110001001100111) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 >newSocket()
 >GetSockName(7)
 <GetSockName(7,/opt/dcelocal/var/adm/directory/cds/dssS0) return(1)
 <newSocket()
 >dthread_create_mutex()
 >dthread_lock(0x100718f8)
 >dthread_unlock(0x100718f8)
  BindChildDssd() exec(/opt/dcelocal/bin/cdsclerk) for(0,1) name(/opt/dcelocal/var/adm/directory/cds/cdsclerk_26970_root)
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 <processReadEvent(,5,0x10001040->ETdnsChild)
 <GetNextEvent() return(0x10001040->ETdnsChild)
 >ProcessEvent(0x10001040->ETdnsChild)
 >BindChild(0x10001040->ETdnsChild)
 >BindChildDssd()
 >dthread_lock(0x10071138)
 >dthread_unlock(0x10071138)
 <BindChildDssd()
 <BindChild(0x10001040->ETdnsChild)
 >GetSockPtr(5)
 <GetSockPtr(5) return()
 >ProcessEvent(0x10001040->ETdnsChild) return(K_PROC_EVENT_CONTINUE)
 >GetNextEvent()
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >processReadEvent(,5,)
 >TerminateIPC()
 <TerminateIPC() return(1)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000000000001011,0,00000000000000011)
><dthreads: switch to 0x10070a30->*foreign*
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 >cds_Solicit_s()
 >cds_SendAdvertisements()
 >dthread_lock(0x100715f8)
 >dthread_unlock(0x100715f8)
 >dthread_lock(0x100715f8)
 >dthread_signal(0x10071638)
 >dthread_unlock(0x100715f8)
 <cds_SendAdvertisements()
 <cds_Solicit_s()
 >cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 <cds_Advertise_s(,/.../admin_cell,0004367a-624b-1b82-8aec-08005a0d2b0f,{1})
 >cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 <cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 >cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 <cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 >cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 <cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 <cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 >cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 <cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 >cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 <cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 >cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 <cds_Advertise_s(,/.../tinker_cell,00811258-ef3e-1b88-a125-02608c2fe978,{1})
 >cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 <cds_Advertise_s(,/.../jolt_cell.osf.org,00899c67-7aa4-1b82-88cc-08002b12df72,{1})
 >cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 <cds_Advertise_s(,/.../carpenter_cell,0061224b-16f5-1b85-abb3-08002b14b387,{1})
 >cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 <cds_Advertise_s(,/.../qwert_cell,0065ba45-83e6-1b2f-81ca-08002b12c2fd,{1})
 >cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 <cds_Advertise_s(,/.../moon_cell,0029f1db-4a1c-1b70-ba65-08002b12a166,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 <cds_Advertise_s(,/.../eyeball_cell.qadce.osf.org,005027ed-6d81-1b85-92f1-08002b13872c,{1})
 >cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 <cds_Advertise_s(,/.../crosscell.qadce.osf.org,007f1d23-3102-1b85-b537-08002b0ef941,{1})
 >cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 <cds_Advertise_s(,/.../demo_cell,006cfcab-a090-1b81-8d74-08002b1d1368,{1})
 >cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
 <cds_Advertise_s(,/.../fire_cell.osf.org,00331fdb-cf15-1b83-adbb-08002b14b387,{1})
><dthreads: switch to 0x10070030->main
  GetNextEvent() 1=select(256,0000000000000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >GetConnectEvent(0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(1)
 >GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetConnectEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011) return(0)
 >ExpiredTimer()
 <ExpiredTimer() return(0)
 >adv_cmaUnlock()
 >dthread_lock(0x10071478)
 >dthread_signal(0x100714b8)
 >dthread_unlock(0x10071478)
  GetNextEvent() select(256,00000010000001011,0,00000010000000011)
  GetNextEvent() 1=select(256,0000001,0,0)
 >adv_cmaLock()
 >dthread_lock(0x10071478)
 >dthread_unlock(0x10071478)
 >GetExceptEvent(0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101011)
 <GetExceptEvent(00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000[gmd 8/13/93 public]
Well - wouldn't ya know - I HAVE seen this problem again! I logged it
separately as a "need cdscp define cached server" bug months later when
I discovered that solved the problem but apparently that one was closed
after Ed Perkins did some testing and couldn't reproduce it (without
DFS - although it seems unrelated to DFS). The steps to reproduce this are:

	- config with cds server on one subnet, dfs machine (client or server)
	on another

	- shutdown -r dfs machine
	- sh -x /etc/rc.dce and sh -x /etc/rc.dfs
.
.
.
dfsd: All DFS daemons started.
root@claus> dfsexport
dfsexport: /dev/rz3c, ufs, 3, 0,,7
dfsexport: /dev/rz1c, lfs, 2, 0,,0
root@claus> fts crmount -dir /:/claus.u3 -fileset claus.u3
fts: DFS junction for cell '/.../dce12_cell.qadce.osf.org' not found: entry not found (dce / rpc).

root@claus> cdscp show dir /.:

                        SHOW
                   DIRECTORY   /.../dce12_cell.qadce.osf.org
                          AT   1993-08-13-14:11:22
Error on entity: /.../dce12_cell.qadce.osf.org
Requested entry does not exist (dce / cds)
Function: dnsEnumAttr
dnsEnumAttr: partial results = %x000000000000000000000000000000000000

root@claus> ping claus           
PING claus.qadce.osf.org: (130.105.201.9): 56 data bytes

root@claus> ping dce12
PING dce12.qadce.osf.org: (130.105.202.31): 56 data bytes
root@claus> cdscp dump clerk cache

CACHED DIRECTORIES*****************************************************

CACHED CLEARINGHOUSES**************************************************

CACHED ATTRIBUTE VALUES************************************************

CACHED USERS***********************************************************


Somehow, the cache is getting cleared when I do a shutdown -r on pmax. If
this doesn't happen on the 103 reference platforms, probably not an issue.

[9/15/93 public]
Gail, please let me know while you reproduce it. We may need your cell
to work on it. Thanks.

[9/21/93 public]
Unable to reproduce. Rebooted numerous times with the following config:

shades = 486 on subnet 5:

        CELL:   shades_cell
        CONFIG: sec, cds, dts server, dfs client
        BUILD:  1.0.3 build available 9/13/93

dce13 = hp on subnet 201:

        CELL:   shades_cell
        CONFIG: sec, cds, dts client, fl server
        BUILD:  1.0.3 build available 9/13/93

Canceling.



CR Number                     : 7239
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : 
Short Description             : pthread_exc.h may be wrong dir
Reported Date                 : 2/17/93
Found in Baseline             : 1.0.2b16
Found Date                    : 2/17/93
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/17/93 public]
While compiling a systest test program, I found that the file include
file stubbase.h has the following include:

include <dce/pthread_exc.h>

However, pthread_exc.h is not installed in /usr/include/dce. It is put
in /usr/include. What does POSIX specify for this file if anything?

I did a grep for pthread_exc.h in the install tree and stubbase.h was
the only file which included pthread_exc.h.

[08/26/93 public]
dce_config no longer install's links from dce/pthread.h to /usr/include
so apps that include stubbase.h wont compile on an installed 1.0.3
system.

Please fix!

[09/30/93 public]
Ok, I'll fix it :-)  Had someone come in to my office to complain,
and since the file is in rpc/sys_idl.

This also requires a change for src/threads/Makefile to export
pthread_exc.h to /usr/include, not /usr/include/dce.

[10/04/93 public]
No, I'm not going to fix it.  I am going to give it back to John Dugas
since he knows what is going on.

What I *will* do is make dce_config install a link from /usr/include/dce
back up to /usr/include for the pthread files.

This is a hack and only hides the problem.  DCE needs to fix this *NOW*
in 1.0.3 before we have way to much source code out there including
the wrong stuff.

[10/15/93 public]
pthread_exc.h is in include dce and that's where its going to stay. 
Cancel.

[10/19/93 public]
Really cancelled this time.



CR Number                     : 7214
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : thr
Subcomponent Name             : idl marshalling code
Short Description             : a client may be able to crash a server
in its marshalling code by passing bogus parameters
Reported Date                 : 2/12/93
Found in Baseline             : 1.0.2
Found Date                    : 2/12/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/12/93 public]
This problem was found during early testing of security replication.
The master security server propagated an account replace (rs_prop_acct_replace)
that contained a pointer to a null rs_acct_key_transmit_t (instead
of the correct null pointer) which crashed the slave in marshalling code.
This example can be reproduced by using:
    security/server/rs/rs_log_acct.c, revision 1.1.4.6
Rebuild this file, librs.a, and secd.  Configure a master and slave.
Use rgy_edit to change some fields of an account without changing
the password.

[3/1/93 public]
This problem is sufficiently complex that it cannot be fixed in 
the 1.0.2 timeframe.   Changed to "fix in 1.0.3."

[3/1/93 public]
Because this problem can be resolved by not passing bogus parameters, 
the severity is being changed and we will address this in the next release.

[3/4/93 public]
When assigning severity, please don't miss the fact that this problem
may make any server vulnerable to a denial of service attack.

[08/03/93 public]
For 1.0.3 there has been a redesign of the idl backend.  This
may not be a problem anymore, but this should be verified.
Tony Hinxman is probably the person who would know...

[08/18/93 public]
This is really the old raise an exception or core dump on syncronous 
terminating signal argument. For 1.0.1 and earlier the default behavior
for such a signal was to raise an exception. For 1.0.2 this was changed to
force a core dump. I emphasize the word default. If a server writer,
for any reason, believes the correct behavior for the server is to raise
an exception the server may be written to do so. Establish the signal
handler with sigaction, it can be on a per thread basis, and supply a 
handler similar to....

sigsegv_handler(int sig,int  siginfo, struct sigcontext *scp)
{
   RAISE(exc_e_illaddr);
}

For 1.1 there is a proposal to have the behavior depend on a setting in 
the acf file. An enhancement request is being filed to implement this
in the 1.1 timeframe. The above description is a work around for the 
problem, as  stated in this ot, during the 1.0.3 timeframe.



CR Number                     : 7211
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : sec client agent
Short Description             : Got invalid cell name in rca_setup_handle()
Reported Date                 : 2/11/93
Found in Baseline             : 1.0.1
Found Date                    : 2/11/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : internal_binding.c
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[2/11/93 public]
  Symptom: rgy_edit executes a bad free() call which causes a paranoid
implementation of free() to flag a bad release.
  Environment: secd has died (for reasons not yet known); rgy_edit is
attempting to bind via the pe_site file's stored entry. The RCA routine
rca_setup_handle() has just called rpc_ns_entry_expand_name() on "/..."
and received the same string in return with OK status. The routine then
adds 5 (GLOBAL_DIR_ROOT_LEN) to this string's pointer. This is beyond
the terminating NULL for this string, and the following strcat blindly
copies a vast string which, in Transarc's case, overwrites our stack, in
particular, the value of tmp_name_p . tmp_name_p is then freed and this
free() is trapped as invalid.
  I don't know why the context->cell_name (which was expanded) was
"/...". Note that the comment on the line which is in error is:
		     ---- ---- ---- ---- ---- ----
            ucp = (tmp_name_p + GLOBAL_DIR_ROOT_LEN); /* !!! barf */
		     ---- ---- ---- ---- ---- ----
  Hmm. Note also that, should there just happen to be some zeros lying
around in the memory extent allocated to provide tmp_name_p (from
rpc_ns_entry_expand_name()) that this doesn't die, which is probably
what the ref. platforms are seeing happen.
  A full GDB backtrace follows:
		     ---- ---- ---- ---- ---- ----
#0  rca_setup_handle (context=0x120c28, status=0xf7ffe8c4) at /local/travis/dev/sb/travis/src/security/client/rca/internal_binding.c:1042
#1  0xf74dd7a0 in rca_rebind (context=0x120c28, status=0xf7ffe8c4)
    at /local/travis/dev/sb/travis/src/security/client/rca/internal_binding.c:1134
#2  0xf74de07c in rca_site_bind_pe_site (context=0x120c28, status=0xf7ffe8c4)
    at /local/travis/dev/sb/travis/src/security/client/rca/internal_binding.c:1274
#3  0xf74dc740 in rca_nsi_binding_import (context=0x120c28, status=0xf7ffe8c4)
    at /local/travis/dev/sb/travis/src/security/client/rca/internal_binding.c:939
#4  0xf74e0308 in rca_site_bind (site_name=0xf7ffe360 "/.../k2.transarc.com", auth_info=0xf7ffe8a8, flags=3, if_spec=0xf7770efc,
    princ=0xf776cfb0 "dce-rgy", cell=0x0, context=0x925c0, status=0xf7ffe8c4)
    at /local/travis/dev/sb/travis/src/security/client/rca/internal_binding.c:1696
#5  0xf74ccf10 in sec_rgy_site_bind (site_name=0xf7ffed44 "", auth_info=0xf7ffe8a8, context=0x925c0, status=0xf7ffe8c4)
    at /local/travis/dev/sb/travis/src/security/client/rca/binding.c:133
#6  0xf74ccfa8 in sec_rgy_site_bind_query (site_name=0xf7ffed44 "", auth_info=0xf7ffe8a8, context=0x925c0, status=0xf7ffe8c4)
    at /local/travis/dev/sb/travis/src/security/client/rca/binding.c:193
#7  0x73d20 in ek_site_open_by_access (site=0xf7ffed44 "", access_type_p=0xf7fff14c)
    at /local/travis/dev/sb/travis/src/security/client/admin/rgy_edit/ek_site.c:229
#8  0x108b0 in eif_site_open_by_access (desired_access=ek_site_query)
    at /local/travis/dev/sb/travis/src/security/client/admin/rgy_edit/eif_site.c:174
#9  0x19fac in eif_do_cl_args (argc=1, argv=0xf7fff3d4, cl_op=0xf7fff2f0)
    at /local/travis/dev/sb/travis/src/security/client/admin/rgy_edit/tty.c:1628
#10 0x1a680 in _Gct_jacketed_main (argc=1, argv=0xf7fff3d4) at /local/travis/dev/sb/travis/src/security/client/admin/rgy_edit/tty.c:1707
#11 0x80b34 in main ()
(gdb) list
1037                    return false;
1038                }
1039
1040                u_strcat(rgy_princ_name, "@");
1041                ucp = (tmp_name_p + GLOBAL_DIR_ROOT_LEN); /* !!! barf */
1042                u_strcat(rgy_princ_name, ucp);
1043                rpc_string_free(&tmp_name_p, &st);
1044            }
1045            /*
1046             * stash the principal name in the context for future
(gdb) print rgy_princ_name
$70 = {"dce-rgy@\000\000\000\020\000\000\000\000w8=Dw8=H\000\000\000\000\000\000\000\002\000\000\000\002\000\000\000\awq@\\wyxwy,0\000\000\
000\twy\020wy\020\000\000\000\005U`w8b\fwy2P\000\000\000\000\000(\000\000wy Pwyxwy x\000\000\000\t\000\000\000$\000\000\000\004\000\000\0
00\t\000\000\000\awq@\\w'X\000\000 p\000\000\000\b\000\000\000\t\000\000@\000\000\000 pUXw8:]J~wyxwy,0\000\000\000\t:]J~wq@\\\000(O`:]J~w
y,0wyx\000\000\000\t"...}
(gdb) print tmp_name_p
$71 = (unsigned char *) 0x2a2828 "/..."
(gdb) next				<<<----- SEE COMMENT BELOW
1043                rpc_string_free(&tmp_name_p, &st);
(gdb) print tmp_name_p
$72 = (unsigned char *) 0xddf00dba<Address 0xddf00dba out of bounds>
(gdb) print ucp
$73 = (
    unsigned char *) 0x2a282d "]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:
]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:]:"...
(gdb) x/40x ucp
0x2a282d <end+2065333>: 0xddbaddba      0xddbaddba      0xddbaddba      0xddbaddba
		     ---- ---- ---- ---- ---- ----
  The flagged "next" command above actually executes the u_strcat()
call at line 1042 listed above. Before the strcat(), tmp_name_p is
valid.  Afterwards, is has been overwritten by some longword in the
range pointed at by ucp.  0xbaddbadd is the memory pattern with which
our paranoid heap routines initialize all new allocations ... the
allocation of tmp_name_p by rpc_ns_entry_expand_name() filled the
extent, unfortunately without ANY zeros nearby (intentionally: that's
malloc's paranoid behavior; it did its job here).
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[2/12/93 public]
The pe_site file contents during this were:
		     ---- ---- ---- ---- ---- ----
/.../k2.transarc.com 006D9A20-809E-1B76-8E60-C037CF9A0000@ncadg_ip_udp:192.55.207.154[]
		     ---- ---- ---- ---- ---- ----

[2/12/93 public]
Thank you for the detailed analysis.  Fortunately or unfortunately for you,
this code has changed *significantly* since the version you're using; the
new version is:
	u_strcpy(rgy_princ_name, context->uncanon_princ_name);
	if (context->cell_name) {
	    unsigned_char_p_t  ucp;
	    u_strcat(rgy_princ_name, "@");
	    ucp = (context->cell_name + GLOBAL_DIR_ROOT_LEN); /* !!! barf */
	    u_strcat(rgy_princ_name, ucp);    
	}
From browsing the old versions, it appears as if this was changed on
12/8/92 by Rob Stanzel as part of the client-side binding update for
replication.
Changed "found in release" to 1.0.1 since the version you quoted goes back
at least that far (but was current until 12/08/93).

[2/20/93 public]
There's nothing wrong with the address arithmetic there;  it was correct for
every valid cellname.  Something before that point messed up and gave you that
bogus /... (note, as Bill says, this code has been vastly rewritten, so the
free that you're talking about isn't even there anymore).  Please try this
again with a recent 1.0.2 build (preferably from at least 2/22/93, since that
will have Bill's secidmap fix and some fixes I'm making to the binding code)
and let us know if you can get it to set the cellname to /...  If not, then
this is an unreproducible problem with the current code...

[8/2/93 public]
No action on this bug since 2/20.  Last chance to update or else
we're cancelling it.

[8/3/93 public]
  This problem has not been seen since it was reported. Do cancel it.

[8/3/93 public]

Cancelling this bug.



CR Number                     : 7199
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : 
Short Description             : exception creating
client the second time on different machines
Reported Date                 : 2/10/93
Found in Baseline             : 1.0.1
Found Date                    : 2/10/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/10/93 public]
Creating an rpc client on a different machine than the server works the
first time but the client gets an exception the second time. 
DCE has to be reloaded to fix it.

[2/10/93 public]

Could you give more information on reproducing this?  Was this using a
test program, which RPC protocols, other DCE activity, etc?

[2/10/93 public]
Bug is reproduced in mainstream. 
No other dce activity. Code follows.

server OSF1 dce6 1.1.1 osc1.1.1 b? mips
client OSF1 dce4 1.1.1 osc1.1.1 b? mips

on Client...

ot@dce4> cd /project/dme/qa/dtet/mckeen/pmax
root@dce4> ulimit -n 256
root@dce4> ./ping_client mckeen
Password must be changed!
root@dce4> ./ping_client mckeen
Password must be changed!
./ping_client: caught exception
Exception: Address exception raised (dce / thd)

on Server...

root@dce6> ./ping_server mckeen
Password must be changed!
NOTE  6192 2.11 14:43:19: SERVER mckeen: listening...
NOTE  6192 2.11 14:43:56: SERVER mckeen: ping RPC called
NOTE  6192 2.11 14:43:56: SERVER mckeen: done listening...
NOTE  6192 2.11 14:43:56: SERVER mckeen: unexporting from namespace
NOTE  6192 2.11 14:43:58: SERVER mckeen: unregistering from endpoint mapper
NOTE  6192 2.11 14:43:59: SERVER mckeen: unregistering interface
root@dce6> ./ping_server mckeen
Password must be changed!
NOTE  5902 2.11 14:44:25: SERVER mckeen: listening...

This also reproduces on 486 machines under 1.1.1b5 and 1.1.2 .

/build/bbelch@sif % more client.log
Script started on Wed Feb 03 11:16:40 1993

 clam:/project/dme/qa/dtet/mckeen# ./ping_client feb4

 clam:/project/dme/qa/dtet/mckeen# ./ping_client feb4
./ping_client: caught exception (-1539973516)
%Exception report; exception address is 0xA435DE74.
Abort process (core dumped)

/build/bbelch@sif % more server.log
mckeen@craftsman (dme10 mckeen_dme10 1) $ ./ping server feb4
NOTE  2625 2.3 11:16:29: SERVER feb4: listening...
NOTE  2625 2.3 11:16:58: SERVER feb4: ping RPC called
NOTE  2625 2.3 11:16:58: SERVER feb4: done listening...
NOTE  2625 2.3 11:16:58: SERVER feb4: unexporting from namespace
NOTE  2625 2.3 11:16:59: SERVER feb4: unregistering from endpoint mapper
NOTE  2625 2.3 11:16:59: SERVER feb4: unregistering interface
mckeen@craftsman (dme10 mckeen_dme10 1) $ ./ping server feb4
NOTE  2626 2.3 11:17:13: SERVER feb4: listening...
NOTE  2626 2.3 11:18:38: SERVER feb4: ping RPC called
NOTE  2626 2.3 11:18:38: SERVER feb4: done listening...
NOTE  2626 2.3 11:18:38: SERVER feb4: unexporting from namespace
NOTE  2626 2.3 11:18:39: SERVER feb4: unregistering from endpoint mapper
NOTE  2626 2.3 11:18:39: SERVER feb4: unregistering interface


The code is a pair of test programs. The idl file appears first.

[3/26/93 public]

Our test bed is no longer availabe to do the stack trace as Dave
requested. If someone can find machines you can contact Andy
McKeen about the problem.

[6/14/93 public]

Cancelled.



CR Number                     : 7180
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : quota lies about space available
Reported Date                 : 2/9/93
Found in Baseline             : 1.0.2
Found Date                    : 2/9/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[2/9/93 public]
In the self-host cell I created a big fileset to hold many-megabyte files
generated from dumping big filesets, in the course of debugging other
problems.  The fileset is ``user.cfe.dumptemp'', and it had a 200 MB quota.
I had created three files, each about 44.5 MB.  I was about to create a
fourth, and it might have gotten even bigger, so I deleted two of these big
files and started a process that created what woud have been the fourth file.
After writing about 31 MB, though, my writing process started to get EIO
back from write() system calls.  Here's some pertinent poking around:
saratoga ~/dumptemp % fts lsq .
Fileset Name          Quota    Used  % Used   Aggregate
user.cfe.dumptemp    200000   74536    37%    28% = 229772/819196 (LFS)
saratoga ~/dumptemp % fts aggrinfo saratoga
LFS aggregate epi0 (/dev/epi0): 469332 K free out of total 511992
LFS aggregate epi1 (/dev/epi1): 589424 K free out of total 819196
saratoga ~/dumptemp % fts lsft . -verbose
_____________________________________________
user.cfe.dumptemp 0,,609 RW LFS     states 0x14005 On-line
    saratoga.transarc.com, aggregate epi1 (ID 12)
    Parent 0,,0       Clone 0,,610     Backup 0,,611
    llBack 0,,0       llFwd 0,,0       Version 0,,66575
    1048576 K alloc limit;   74536 K alloc usage
     200000 K quota limit;   74536 K quota usage
    Reclaim wait: 0:00:00
    Maximum *node index: 3
    Creation Wed Feb  3 15:50:04 1993
    Last Update Tue Feb  9 19:17:47 1993
    Last Access Tue Feb  9 19:17:47 1993
user.cfe.dumptemp
        readWrite   ID 0,,609  valid
        readOnly    ID 0,,610  invalid
        backup      ID 0,,611  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner
saratoga.transarc.c RW       epi1    0:00:00 hosts/saratoga <nil>
_____________________________________________
saratoga ~/dumptemp % ls -l
total 149056
-rw-r--r--   1 cfe      transarc 44540000 Feb 03 20:08 mason.dump
-rw-r--r--   1 cfe      transarc 31756288 Feb 09 18:00 tryagain.3
saratoga ~/dumptemp % cat tryagain.3 tryagain.3 > ta.5
cat: 0652-054 Cannot write to output.
There is not enough space in the file system.
cat: 0652-054 Cannot write to output.
There is not enough space in the file system.
saratoga ~/dumptemp % ls -l
total 149064
-rw-r--r--   1 cfe      transarc 44540000 Feb 03 20:08 mason.dump
-rw-r--r--   1 cfe      transarc   36864 Feb 09 19:19 ta.5
-rw-r--r--   1 cfe      transarc 31756288 Feb 09 18:00 tryagain.3
saratoga ~/dumptemp % fts lsq .
Fileset Name          Quota    Used  % Used   Aggregate
user.cfe.dumptemp    200000   74540    37%    28% = 229776/819196 (LFS)
saratoga ~/dumptemp %
Any clues?
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[2/10/93 public]
I don't see any obvious problem.  It kinda seems like a quota
reservation problem.  One way to test this is to run "sync" a few times
to flush out VM and see if that helps.  Actually you may have to detach
the aggregate to really Unreserve all the vnodes.
It is interesting that this is just after deleting much space.  The
files aren't still open or else the aggreaget wouldn't show the space as
free.  Could it be that the freedblock code is tying down this many
blocks?  It should be able to hold on to more than 10*10 blocks/aggr.
Whoops, I just looked at the code.  It seems as it I was unable to
continue forcing the log to maintain this limit.  Note that when you get
those "increasing elbt_MaxTrans" messages it also means that the freed
block code will have to allocate records for each block freed in each of
those transactions.  I just ran (for instance) "test_anode
big_files.test" and it got to (elbt_MaxTrans == 1100) it also allocated
2225 freed block records (presumably about 90% for blocks and 10% for
transactions.  Thus there were around 2000 blocks tied up here.  I don't
know what the stats were for your system but this is a pretty-smoking
gun, I'd say.
Perhaps Bruce or Tony have some good ideas?
Filled in Interest List CC with `bwl, mason'

[6/7/93 public]
haven't seen any good ideas lately . . . and it _is_ unfriendly.
Elevated to B.

[9/14/93 public]
I have been looking for a reproducible case of this recently.  We are
about to cancel 3899 as fixed-by-accident.
Filled in Reported by Company's Ref. Number with `DB 3899'

[9/30/93 public]
This isn't reproducible.  Any further problems of this type will be
tracked under DB 3899 (which is still open at low priority).
Changed Status from `open' to `cancel'



CR Number                     : 7165
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : sec
Subcomponent Name             : security: rsdb
Short Description             : under load, rsdb can become flakey
Reported Date                 : 2/8/93
Found in Baseline             : 1.0.2
Found Date                    : 2/8/93
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[2/8/93 public]
  In preparation for a stress test, I submitted a command file containing
the following commands to rgy_edit:
 ----
do p
add stress/user1
add stress/user2
..
add stress/user14999
do a
add stress/user1 -av -pv ...
...
add stress/user14999 -av -pv ...
q
 ----
 The configuration was a private cell running on an otherwise unloaded
SparcII over SunOS 4.1.3. As this script executed, I checked the syntax
of some commands I needed for the complimentary clean-up script from
another window. This other window, then, was running rgy_edit to the
same registry that was adding the 15k accounts (on the same, local node).
From this other window, I issued sporadic commands to view a small scope
in the principals' domain. After a few of these, the account-adding
window spat out:
>>?(rgy_edit) Unable to add "stress/user1696" - Specified object already
exists (Registry Edit Kernel) (dce / sad)
  From the sporadic-command window, I did the following:
 ----
rgy_edit> scope ""
rgy_edit> view stress/user1696
?(rgy_edit) Cannot retrieve any matching entries for stress/user1696
"" - Entry not found (Registry Edit Kernel) (dce / sad)
 ----
  This turns out to be reproducible. Just start a script going like the
account-add script (turn one out with a helper script) funnelled into
rgy_edit. While this is going, go into another shell, start another
rgy_edit, set the scope to krbtgt , and view . (It's much more likely to
happen when the account-domain commands are in progress.)
  Each time I do this, I stand (empirically) a 6 in 8 chance of getting
one of the following errors from the account-add process:
  + Cannot add account <principal name> - Registry server unavailable
  + Cannot add account <group or org name> - Registry server unavailable
  + specified object already exists (when it doesn't according
    to the script commands themselves and output from the
    competing, sporadic-command window)
  It also appears from observation of the performance of the 'view' of
the (singleton) scope 'krbtgt' that the database search may be searching
the entire db, as opposed to some subset of it bounded by a sort order;
the single answer appears immediately even under load but the view
command does not return for some time. Perhaps bounding this search can
reduce the lock competition within the db enough to make this problem
diminish into the background.
  Finally, this is the Transarc SunOS build of OSF 1.0.2 BL7. No changes
have been made locally to the rsdb or rgy_edit . The test system appears
to have plenty of resources (100k+ remains for swapping; cpu at 30%;
/opt has 100+Mb available)
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[2/20/93 public]
Since this needed to be assigned to somebody, I put Anne's name on it for now,
because she's done the most work in the rsdb code...

[2/20/93 public]
  For clarity, the last sentence of the original report text should read,
"100Mb+ remains for swapping" as opposed to "100k+ remains for
swapping." The system was not down to 100Kb of swap space. Sorry for the
typo

[9/23/93 public]
We weren't able to reproduce this problem on HP-UX.  Do you still get
this problem for later DCE releases?  Can you reproduce the problem
on a reference platform ?

[9/23/93 public]
   I was using the "update" program from the test tree to add a huge
number of accounts to RSDB recently and did see this occur again. Two
copies of "update", running with distinct prefixes for their PGOs (e.g.
"U1 U1 U1" and the other had "U2 U2 U2") resulted in one error of the
above description: one account was claimed to already exist, when it
could not have been created yet (the registry was clean before the test
began). If this was a bug in the "update" program, I'll be surprised.
   As this happened only once in nearly 45,000 additions, I could not
put it up on my list of current things to investigate. That, and the
fact that this evidently has not happened on any reference platform,
probably means we should downgrade this bug into the C3 range (or lower).
Changed Severity from `B' to `C' 
Changed Priority from `1' to `3'

[11/30/93 public]
  This has been seen again.
  I was building a large cell, using the following commands:
.
[k2-travis] foreach i (4 5 6)
foreach? $LATEST/install/sparc/dcetest/dce1.0.2a/test/security/commands/rgy/update -p cell_admin -pw -dce- -a 100000 /.../oink.dce.transarc.com OINK$i OINK$i OINK$i &
foreach? end
.
  Within an hour, the following errors had been given by the update
programs:
.
TIMING: (Per call aggregate) [0.084250]user+sys [1.428080] real time
TIMING: (Per call period 20) [0.085000]user+sys [1.455534] real time
Unable to add person 'OINK6/X00059' (status 0x17122076)
    Operation was: sec_rgy_pgo_add (line=511)
.
TIMING: (Per call aggregate) [0.087900]user+sys [2.646847] real time
TIMING: (Per call period 20) [0.087500]user+sys [1.520896] real time
Unable to add person 'OINK6/X00208' (status 0x17122076)
    Operation was: sec_rgy_pgo_add (line=511)
.
TIMING: (Per call aggregate) [0.088667]user+sys [2.676756] real time
TIMING: (Per call period 20) [0.079500]user+sys [1.470831] real time
Unable to add acct 'OINK6/X00363' (status 0x17122075)
    Operation was: sec_rgy_acct_add (line=481)
.
TIMING: (Per call aggregate) [0.090200]user+sys [2.787128] real time
TIMING: (Per call period 20) [0.082500]user+sys [1.459959] real time
Unable to add acct 'OINK6/X00503' (status 0x17122075)
    Operation was: sec_rgy_acct_add (line=481)

[11/30/93 public]
...and:
.
TIMING: (Per call aggregate) [0.098661]user+sys [5.068336] real time
TIMING: (Per call period 20) [0.090000]user+sys [3.333304] real time
Unable to add member 'OINK5/X01687' to group 'OINK5/X00001' (status 0x16c9a016)
    Operation was: sec_rgy_pgo_add_member (line=446)
Unable to add member 'OINK6/X01689' to org 'OINK6/X00001' (status 0x16c9a016)
    Operation was: sec_rgy_pgo_add_member (line=453)
Unable to add acct 'OINK4/X01687' (status 0x16c9a016)
    Operation was: sec_rgy_acct_add (line=481)

[8/11/94]
Is this still a problem?

[8/15/94 public]
  Resources to run such long tests are thin here, so I haven't
reproduced that problem since about June -- but only because I haven't
tried. It did show up in one long run I made in June, two instances if I
recall. That would have been our 1.0.3, post-merge code line. It only
takes one machine (and about 48Mb of memory) -- actually, if the
trashing is what causes this, less memory may assist in reproducing
it... just a matter of time here.
  I don't want to close this until a few runs take place without this
error's appearence...

[2/2/96 public]
Last reported reproduction of this was over a year and a half ago.
We've been trying to reproduce problems like this here and have been
able to use the same update program to add over 250,000 accounts without
seeing any problems.  I'm cancelling this defect as not reproducible.



CR Number                     : 7162
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd hangs after a session of
abuse.
Reported Date                 : 2/8/93
Found in Baseline             : 1.0.2b14
Found Date                    : 2/8/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[2/8/93 public]

Running "abuse" on a two machine cell (one CDS Server, and one Security Server) 
ends with a "No Errors Detected" message, at which time a "cdscp del clear" is
attempted and the CDS server fails to respond.  While several other operations
seem to work (list, show, etc.) it is impossible to delete an existing
clearinghouse, or create a new one.

Upon an attempt to perform a set dir /.: to new epoch (in order to restore
some order to cds), cdsd dumped a partial core file.  We will attempt to get
a decent core file and annotate this OpenTrack with more information.

[2/23/93 public]
Ed - I have been asked to look into this problem. It would seem to me
that this problem is a hung or dying thread. The information that would
(hopefully) help to isolate the problem would be to kill the server
before the "del clear" and restart with event tracing turned on.
Hopefully the bug won't go away by the stop/start. I will be at
(508)597-0942 on 2/24, otherwise at (508)486-7217.

[3/2/93 public]
Lowered the severity to B2.
Changed Priority from `1' to `2' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[10/13/93 public]
This bug has nothing (or at least now) to do with abuse test.
The problem with cannot-create-delete-clearinghous is that 
you're NOT allowed to create or delete a clearinghouse on a
host which has not cdsd running. I tried both ways (with and
whitout) abuse run first. You can create/delete clearinghouse
on server host not client host. But if you create a secondary
server on client host you're able to do so on this client host
too. The code is written this way in cprpc_server.c to call
cprpc_get_binding_handle() with ch_fullname_p = (cds_FullName_t *)0
which means go get a local binding for me. Concel by now.



CR Number                     : 7158
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : dfsexport -all -detach/-attach not clean
Reported Date                 : 2/8/93
Found in Baseline             : 1.0.2
Found Date                    : 2/8/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3a
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[2/8/93 public]
BUILD:	b14
CONFIG:	2 pmax cell
	1 = sec,cds,fl server and dfs client (dce5)
	1 = file server, sec, cds, dfs client (valentine)
DETAILS:
Able to dfsexport -all -detach, or so it seems (no feedback and 
subsequent dfsexport returns nothing either).
Remove dfsatab, doublecheck dfstab, dfsexport -all to reattach
and I appear to fail to attach /u2 - but I am able to create a
mount point and cd successfully to this empty fileset/aggregate.
Basically, it looks like dfsexport's output is faulty but it is
doing the job correctly.
root@valentine(120) dfsexport -all -detach -verbose
root@valentine(121) dfsexport
root@valentine(122) ls -l dfsatab
-rw-------   1 root     bin                   0 Feb  8 13:59 dfsatab
root@valentine(123) rm dfsatab
root@valentine(124) cat dfstab
# blkdev aggname aggtype aggid (fsid-for-UFS)
/dev/rz1b      /u2        ufs     3  0,,100
/dev/rz1e      /u4        ufs     4  0,,7
root@valentine(126) dfsexport -all
dfsexport: Failed to attach /dev/rz1b:/u2 (File exists).  Ignoring it.
root@valentine(127) dfsexport
dfsexport: /dev/rz1e, ufs, 4, 0,,7
root@valentine(113) fts crmount -dir /:/val_u2 -fileset val.u2
root@valentine(114) cd /:/val_u2
root@valentine(115) ls
root@valentine(116) fts lsfldb -server valentine
val.u2
        readWrite   ID 0,,100  valid
        readOnly    ID 0,,101  invalid
        backup      ID 0,,102  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner
valentine.osf.org   RW       /u2     0:00:00 hosts/valentine<nil>

[2/9/93 public]
Changed Responsible Engr. from `pakhtar@transarc.com' to `jdp@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[2/19/93 public]
More minor problems with dfsexport
BUILD:	nb available 2/17/93
CONFIG: 3 pmax cell, 3 fl servers
TEST:	test/systest/admin/file/tests/admin_checklist (to be submitted
	next week)
Doublechecking instructions in the checklist, I found that dfsexport
"loses" the fileset id of a ufs aggregate if you:
fts crfldbentry ...
update /opt/dcelocal/var/dfs/dfstab 
rm /opt/dcelocal/var/dfs/dfsatab
dfsexport -aggregate /u2
dfsexport -aggregate /u2 -detach
fts delfldbentry ...
fts crfldbentry ...
update /opt/dcelocal/var/dfs/dfstab (with NEW fsid)
rm /opt/dcelocal/var/dfs/dfsatab
dfsexport -aggregate /u2
dfsexport now reports the fsid for /u2 as 0,,0 and NOT 0,,13.
Hmm - now a less than minor problem, operator error of removing the
dfsatab file and then trying :
root@valentine> dfsexport -all -detach -force
dfsexport: Revoking tokens for filesets on aggregate
system dropped into kdb with
kdb> $k
gimmeabreak()
Debugger()
simple_lock()
vrele()
dounmount()
unmount()
syscall()
VEC_syscall()

[7/14/93 public]
Gail, I would like to assign this to you also for now. Here are reasons:
1) We cannot reproduce it here and we have not seen this for a long time,
2) Jeff has also made several fixes in this area and may have already fixed it,
and 3) it is really a pmax platform specific ..
If you cannot reproduce it, would you like to cancel it ?
  
Thanks,
Filled in Interest List CC with `jdp@transarc.com' 
Changed Responsible Engr. from `jdp@transarc.com' to `gmd' 
Changed Resp. Engr's Company from `tarc' to `osf'

[7/30/93 public]
I am unable to reproduce this because I am blocked by ANOTHER dfsexport
problem, both on the rios and the pmax. I am reporting the new problem
and leaving this one to be reproduced/cancelled in 1.0.3.

[10/8/93 public]

Aged relative to Aug 8.

[12/17/93 public]

There are really two bugs reported in this CR, both involving cells
with only pmaxes.  The first [gmd 2/8/93] was a two pmax cell.  I have
been unable to reproduce this bug in a two HPUX cell.

The second bug [gmd 2/19/93] was reported for a three pmax cell with
3 flservers.  I have been unable to reproduce this in a 2 HPUX cell.

Since pmax'es are not a reference platform anyway, I am canceling this CR.



CR Number                     : 7134
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdscp /.: fails
Reported Date                 : 2/4/93
Found in Baseline             : 1.0.2
Found Date                    : 2/4/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/4/93 public]

BUILD:	nb available 1/29/93 (= b14)
CONFIG:	2 pmax cell with dfs

problem on client pmax:

cdscp show dir /.:
returns Entry not found
partial results

after cell had been idle 2 - 3 days

different dce_login status and other unix ids all fail.

[2/5/93 public]
Need more information. Stack trace from cores, clerk and server logs...
Please reproduce. Is this problem occurring on other platforms?

[2/5/93 public]
Yes - it was a short description - snoopy was being taken down. 
More facts:
	* no core files anywhere
	* same command (cdscp show dir /.:) works fine on the server
	* even new cdsclerks have the same problem
	* I have not seen this before but am curious if some
	dfsbind problems we've been seeing are related.

Here's a clerk log produced by killing the root clerk, creating the
cdsclerk.events file and doing a cdscp show dir /.:

(feel free to chop it down to a useful size)


  main() using cache(0)
 >dthread_create(,0x100000c8,0x4013ec,0x7fffeaf0)
 >th_birth(0x4013ec,0x7fffeaf0,268435656->(signal_catcher,0))
 <th_birth(0x4013ec,0x7fffeaf0,0x100000c8->(signal_catcher,0)) return(0x100725b8)
 <dthread_create(0x100725b8,0x100000c8,0x4013ec,0x7fffeaf0) return(282107905)
 >start_listener(0x7fffeaf0->)
 >dthread_create(,0x10000090,0x402544,0x7fffeaf0)
 >th_birth(0x402544,0x7fffeaf0,268435600->(clerk_listener,0))
 <th_birth(0x402544,0x7fffeaf0,0x10000090->(clerk_listener,0)) return(0x100726b8)
 <dthread_create(0x100726b8,0x10000090,0x402544,0x7fffeaf0) return(282107905)
 <start_listener(0x7fffeaf0->) return(TRUE)
 >dthread_lock(0x10077208)
 >dthread_wait(0x10077288,0x10077208)
><dthreads: switch to 0x100726b8->clerk_listener
 >clerk_listener()
 >dthread_handler_push(0x1002e9f8->0x402c4c(0x7fffeaf0))
 <dthread_handler_push(0x1002e9f8->0x402c4c(0x7fffeaf0))
 >dthread_import_fd(3)
 <dthread_import_fd(3)
 >dthread_lock(0x10077208)
 >dthread_broadcast(0x10077288)
 >dthread_unlock(0x10077208)
 >dthread_accept(3,0x1002ea10,0x1002e798->106)
 <dthread_accept(3,0x1002ea10,0x1002e798->16) return(5)
 >start_client(0x7fffeaf0->,5)
 >dthread_create_mutex()
 >dthread_create_condition()
 >dthread_lock(0x10077208)
 >dthread_unlock(0x10077208)
 >dthread_create(,0x10000080,0x404470,0x100727b8)
 >th_birth(0x404470,0x100727b8,268435584->(clerk_client,0))
 <th_birth(0x404470,0x100727b8,0x10000080->(clerk_client,0)) return(0x100728b8)
 <dthread_create(0x100728b8,0x10000080,0x404470,0x100727b8) return(282107905)
 <start_client(0x7fffeaf0->,5) return(TRUE)
 >dthread_accept(3,0x1002ea10,0x1002e798->106)
><dthreads: switch to 0x100720b8->main
 >dthread_timed_wait(0x10077288,0x10077208,05-feb-1993 19:20:12.4594039)
><dthreads: switch to 0x100728b8->clerk_client
 >clerk_client(0x100727b8->5)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_handler_push(0x10046a48->0x406e20(0x100727b8))
 <dthread_handler_push(0x10046a48->0x406e20(0x100727b8))
 >read_request(5)
 >dthread_read(5,0x100727e4,54)
 <dthread_read(5,0x100727e4,54) return(54)
 >dthread_read(5,0x100729b8,118)
 <dthread_read(5,0x100729b8,118) return(118)
 <read_request(5) 172=read()
 >dthread_lock(0x10077308)
 >dthread_create(,0x10000088,0x404dbc,0x100727b8)
 >th_birth(0x404dbc,0x100727b8,268435592->(clerk_request,0))
 <th_birth(0x404dbc,0x100727b8,0x10000088->(clerk_request,0)) return(0x10072ab8)
 <dthread_create(0x10072ab8,0x10000088,0x404dbc,0x100727b8) return(282107905)
 >dthread_detach(0x10072ab8->clerk_request)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_lock(0x10077308)
 >dthread_handler_push(0x100467d8->0x40365c(0x100727c4))
 <dthread_handler_push(0x100467d8->0x40365c(0x100727c4))
 >dthread_wait(0x10077348,0x10077308)
><dthreads: switch to 0x10072ab8->clerk_request
 >dthread_create_mutex()
 >dthread_create_condition()
 >dthread_lock(0x10077308)
 >dthread_unlock(0x10077308)
 >clerk_request(0x100727b8->5)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >clerkEnumerateAttributes()
 >sendToWalkTree(/.../dce5_cell)
 >clerk_WalkTree(/.../dce5_cell)
 >CAResolveName(/.../dce5_cell)
 >CALock
 <CALock
 >CAResolveName(FILE:/opt/dcelocal/var/security/creds/dcecred_ffffffff,0,/.../dce5_cell,)
 >CAFindLink(/.../dce5_cell,12)
 <CAFindLink(/.../dce5_cell,12) return(0)
 <CAResolveName(FILE:/opt/dcelocal/var/security/creds/dcecred_ffffffff,0,/.../dce5_cell,00000000-0000-0000-0000-000000000000) return(0)
 >CAUnlock
 <CAUnlock
 <CAResolveName(/.../dce5_cell)
 >ChooseInitCh(,/.../dce5_cell)
 >CALock
 <CALock
 >CAFindDir(/.../dce5_cell,6)
 <CAFindDir(/.../dce5_cell,6) return(0)
 >CAFindDir(/...,17)
 <CAFindDir(/...,17) return(0)
 >CAFindDir(/,20)
 <CAFindDir(/,20) return(0)
 <ChooseInitCh(,00000000-0000-0000-0000-000000000000) return(0)
 >CAUnlock
 <CAUnlock
  clerk_WalkTree looking for (00000000-0000-0000-0000-000000000000)
 <clerk_WalkTree(/.../dce5_cell)
 <sendToWalkTree(/.../dce5_cell)
 <clerkEnumerateAttributes() status(282108916)
 >dthread_lock(0x10077308)
 >dthread_unlock(0x10077308)
 >dthread_write(5,0x10086188,16)
 <dthread_write(5,0x10086188,16) return(16)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_lock(0x10077308)
 >dthread_wait(0x10077348,0x10077308)
><dthreads: switch to 0x100728b8->clerk_client
 >dthread_handler_pop(0x100467d8->0x40365c(0x100727c4),0)
 <dthread_handler_pop(0x100467d8->0x40365c(0x100727c4),0)
 >dthread_unlock(0x10077308)
 >read_request(5)
 >dthread_read(5,0x100727e4,54)
 <dthread_read(5,0x100727e4,54) return(0)
 <read_request(5) 0=read() errno(0)
 >dthread_setcancel(0)
 <dthread_setcancel(0) return(1)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_wait(0x10077348,0x10077308)
><dthreads: switch to 0x10072ab8->clerk_request
 >dthread_unlock(0x10077308)
 >dthread_lock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_delete_condition(0x10086144)
 >dthread_delete_mutex(0x10086048)
 <clerk_request(0x100727b8->5) return(0)
 >dthread_exit(0x0) thread(0x10072ab8->clerk_request)
  th_death(0x10072ab8->clerk_request)
><dthreads: switch to 0x100728b8->clerk_client
 >dthread_unlock(0x10077308)
 >dthread_setcancel(1)
 <dthread_setcancel(1) return(0)
 >dthread_handler_pop(0x10046a48->0x406e20(0x100727b8),1)
 >link_free(100727b8)
 >dthread_lock(0x10077308)
 >dthread_close(5)
 <dthread_close(5) return(0)
 >dthread_broadcast(0x10077348)
 >dthread_unlock(0x10077308)
 >dthread_broadcast(0x10077348)
 >dthread_lock(0x10077208)
 >dthread_broadcast(0x10077288)
 >dthread_unlock(0x10077208)
 >dthread_delete_mutex(0x100727c4)
 >dthread_delete_condition(0x100727dc)
 >dthread_detach(0x100728b8->clerk_client)
 <link_free(100727b8)
 <dthread_handler_pop(0x10046a48->0x406e20(0x100727b8),1)
 <clerk_client(0x100727b8->5) return(0)
 >dthread_exit(0x0) thread(0x100728b8->clerk_client)
  th_death(0x100728b8->clerk_client)
><dthreads: switch to 0x100720b8->main
 >dthread_timed_wait(0x10077288,0x10077208,05-feb-1993 19:20:12.4594039)

[2/8/93 public]
Raising the Severity to A since rebooting and restarting DCE does NOT
solve the problem.

[2/25,93 public]
Thanks for the clerk log. It is obvious from the log and your description
that there is a broadcast problem. The above clerk has no clearinghouses
in its cache and has nowhere to go, yet there is a healthy server on the
LAN accessable by the node-local clerk. Peter Keegan says that he has seen
situations where local netmasks are broken.
Try the "cdscp define cached server" command to directly enter the server
into the cache. Look at your configuration. If there is nothing obvious,
we can try turning logging on both the client advertiser and the server
advertiser to see whether it is a transmit or receive problem.

[2/25/93 public]
Thanks Alan. I have not seen this problem again so I am lowering the priority
for now.

[07/08/93 public]
Hasn't beem any activity on this since the above. I'm going to
assume the problem was a network glitch. Canceled.

[7/16/93 public]
Unless this bug can be reproduced with the logging requested by
Alan Peckham, above, this bug should be closed.



CR Number                     : 7123
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : secd
Short Description             : secd crashes when pmax client unresponsive
Reported Date                 : 2/3/93
Found in Baseline             : 1.0.2
Found Date                    : 2/3/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[2/3/93 public]

BUILD: nb available 1/29/93 = weekly build 14
CONFIG:	3 machine cell
	rios = sec, cds, fl server, dfs client
	pmax1 = sec, cds, dfs client, file server
	pmax2 = sec, cds, dfs client

all 3 machines had clerk dtsds running as started by default by dce_config

DETAILS:
	secd on rios core dumped when I dropped pmax2 into kdb
	for ~20 minutes (ie. inaccessible) sometime during
	that 20 minute interval. I had had no problems with core
	components when I dropped pmax2 into kdb.

	Once secd was gone, the following error message was
	actually valid! I saw it on both the pmax clients.

sec_clientd 02/03/93 16:34:06 - Host Principal key management failure
... Registry server unavailable (dce / sec)

[8/2/93 public]

Gail, can you reproduce this problem using the current reference 
platforms?

[8/3/93 public]
Unfortunately, I will not have an opportunity to try this for a few weeks.
I'll cancel and when dfs system testing begins again, we will certainly
hit this if it still exists ...



CR Number                     : 7114
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : rc.dce
Short Description             : Unable to restart CDS
Reported Date                 : 2/3/93
Found in Baseline             : 1.0.2
Found Date                    : 2/3/93
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[2/3/93 public]
It isn't clear if this needs to be addressed by CDS or the configuration
mechanisms... I'll describe the symptoms:
 
On an AIX machine, running b6 core components,  the machine
was running successfully. Upon rebooting the machine, CDS wouldn't start,
thereby causing a cascade of startup failures for other components including
DFS. Several reboot attempts failed to fix the problem, but served to
identify CDS as the cause of failures.
 
Finally, removing
/opt/dcelocal/etc/cdscache.shmid 
and rebooting permitted the entire system to come up correctly.
 
Either the startup scripts need to clean up appropriate state, or CDS
isn't starting correctly in some circumstances.
 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[2/9/93 public]
It's not a dfs defect.  As Pervaze says, it may be viewed as a CDS defect
or a startup-script defect.  Let's start with it as a CDS problem.
Changed Component Name from `dfs' to `cds' 
Filled in Interest List CC with `cfe@transarc.com'

[2/12/93 public]
I had similar problems starting up the cdsadv on clean machines (ie.
no old shared memory segments, dce had NOT been started since the last reboot)
 
sh -x /etc/dce.rm
rm -rf /opt/dce*
ksh /etc/dce_config -> install and config a pmax
 
During dce_config, cdsadv complained that it:
 
Can't initialize shared memory cache 
Cannot auto-enable clerk
 
These same error messages appeared on both
machines, one was being configured as a dce server, the other as a dce
client to a healthy rios dce server.
 
My pmaxes were both running b14 efsvmunix for kernels, but I was installing
and configing b15 so I rebooted with the b15 efsvmnunix and
tried both again - voila! - all is well now.

[06/08/93 public]
Changed "Fix By Baseline" field from 1.0.2 to 1.0.3.
Changed Interest List CC from `cfe@transarc.com rsarbo@osf.org' to 
 `cfe@transarc.com, rsarbo@osf.org, bww@transarc.com'

[9/15/93 public]
Cannot reproduce this bug on dce1.0.3 code base. 
The /opt/dcelocal/etc/cdscache.shmid should not be a reason because cdsadv is
going to get a new shared memory region and if there is a cdscache.shmid
left over it is going to remove the existed shm key and this cdscache.shmid 
and write a new one. Cancel this bug by now.



CR Number                     : 6994
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7336
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : dfsexport not always enabled in rc.dfs
Reported Date                 : 1/25/93
Found in Baseline             : 1.0.2b11
Found Date                    : 1/25/93
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/25/93 public]
config_dfsfldb is missing the call to 'enable_in_dfs_rc dfsexport'.
The diff below shows where to place it (in a similar position as in
config_dfsfs).

*** dce_config.orig     Mon Jan 25 10:32:49 1993
--- dce_config  Mon Jan 25 10:35:31 1993
***************
*** 5061,5066 ****
--- 5061,5068 ----
        read DEVNAME
    done

+   enable_in_dfs_rc dfsexport
+
    # Create the dfstab file based on the filesystem type.
    # Do the appropriate dfsexport command.
    case $option in

[6/7/93 public]
This was fixed under 7336.



CR Number                     : 6989
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : idl backend test binop_alloc
Short Description             : not checking for exceptions properly
Reported Date                 : 1/23/93
Found in Baseline             : 1.0.2b12
Found Date                    : 1/23/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/23/93 public]

idl backend test binop_alloc not checking for exceptions properly

from test/rpc/idl/binop_alloc/client_aux.c:

            TRY
                binop_alloc_fail(h, i, i, &n);
                failures++;
                printf("***FAIL***: binop_alloc_fail did not raise an
exception\
n");
L3            CATCH(exc_e_illaddr)
L4            CATCH(rpc_x_unknown_remote_fault)
L1                /* Expected result */
            CATCH_ALL
                printf("***FAILURE***: binop_alloc_fail wrong exception
(expecte
d exc_e_illaddr)\n");
L2                print_exception(THIS_CATCH);
            ENDTRY;


Comments:

L1  This comment seems out of place.  The expected result should be the 
    particular CATCH clause of the expected exception.

L2  "failures++;" should be part of the CATCH_ALL (i.e., the unexpected
    results).

L3,L4 If SIGSEGV is not caught by the server, the expected exception
    is rpc_x_comm_failure.

[08/23/93 public]
Since this is in a test, OSF is responsible to fix it.

[08/31/93 public]
This code/test has been removed from the test (in 1.0.2).
Bug canceled.



CR Number                     : 6957
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7879
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : fts
Short Description             : fts lsquota against a JFS prints a non-pretty value
Reported Date                 : 1/21/93
Found in Baseline             : 1.0.2
Found Date                    : 1/21/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Status               : open
Transarc Deltas               : 
Transarc Herder               : jaffe

[1/21/93 public]
If I do fts lsquota /.:/fs where root.dfs is a JFS, fts returns the following
error:
Error in lsquota: Cross-device link
Isn't it supposed to return the same information as a df against the local
mount point?
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `mason@transarc.com' 
Added field #Transarc Status with value `open'

[1/21/93 public]
Changed Responsible Engr. from `mason@transarc.com' to `cfe@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[1/22/93 public]
Well, it's supposed to return something comparable to the mount-point `df',
but not exactly the same: the aggregate information in ``fts lsquota'' is
supposed to be the same as the `df' information.
I haven't reconfigured my test cell to try to reproduce this, but I have an
exported JFS fileset named varda.tmp, and the command
	fts lsquota -fileset varda.tmp
is reporting what I'd expect.  Your ``Cross-device link'' error suggests that
you've re-configured this cell without flushing all caches.  Would you mind
trying:
	cm checkfilesets
	fts lsq /.:/fs
My expectation is that this will work, since my guess is that you've renamed
some JFS fileset to be root.dfs without telling the CM.  If it doesn't fix
the problem, please help diagnose it by getting the output of:
	fts lsfldb root.dfs
	cm whereis /.:/fs
	fts lsquota -fileset root.dfs
	fts lsft -fileset root.dfs
	fts lsft /.:/fs
Thanks!

[1/22/93 public]
I figured out what the problem was. In my dfstab file, the aggrid for root.dfs
was 2 but the FLDB entry had 3, thus the "Cross-device" error.  By syncing
those up, fts lsquota /.:/fs now works with a JFS.
This does bring up a couple questions, though.  How was I able to get to root.dfs
in the first place?  Does the server just go by the fileset number in the dfstab 
in the case of JFS and not the aggrid.
Also, is this proper output for lsquota:
# fts lsquota /.:/fs
Fileset Name          Quota    Used  % Used   Aggregate
root.dfs             4194303       0     0%     4% = 548/12288 (non-LFS)
I would think the value for Quota should be 0 since Used and % Used
are both displayed as 0.
Added field #Transarc Deltas with value `' 
Added field #Transarc Herder with value `' 
Added field #Transarc Status with value `'

[1/22/93 public]
Yup, the CM doesn't need the aggrid; all it wants is the fileset ID and the
server identity (address + principal).  Glad you were able to determine
what the test-case problem was.
The 4194303 value for the quota is artificial; it's set in ufsops/ufs_volops.c
to a fixed value.  This is a temp work-around for problems that Carl was
having with dumping JFS filesets and restoring them into Episode: UFS/JFS
was reporting zero values for ``fileset quota,'' but Episode was having trouble
restoring data into filesets for which the quota values had been set to zero.
Not that I know what the real solution is to that one, other than perhaps
implementing an ``unbounded'' quota limit whose representation is 0.
However, given that that's the only remaining problem, I'm changing this
OT report to an enhancement.
Changed Defect or Enhancement? from `def' to `enh' 
Filled in Interest List CC with `demail1!burnett, jdp@transarc.com' 
Changed Severity from `B' to `D' 
Changed Priority from `1' to `3'

[1/25/93 public]
Filled in Transarc Herder with `jaffe' 
Filled in Transarc Status with `open'
Changed Short Description from `fts lsquota against a JFS is broken' to `fts 
 lsquota against a JFS prints a non-pretty value'

[3/30/94 public]
This was fixed by Jeff Prem in connection with OT 3298 in March of 1993.
Changed Status from `open' to `dup' 
Filled in Duplicate Of with `3298'

[3/30/94 public]
Oops--OT 7879, not OT 3298.
I'd dup this to OT 7879, but I can't, so I'm cancelling this one.
Filled in Inter-dependent CRs with `7879' 
Changed Status from `dup' to `cancel' 
Changed Duplicate Of from `3298' to `'



CR Number                     : 6956
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7513
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : Host creds being blown away...
Reported Date                 : 1/21/93
Found in Baseline             : 1.0.2
Found Date                    : 1/21/93
Severity                      : A
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe
Transarc Status               : open

[1/21/93 public]

BUILD: nb available 1/15/93 aka dfs 2.3
CONFIG: 2 machine cell, rios = sec,cds and fl server
			pmax = sec,cds and dfs client

root.dfs in episode
1 additional jfs fileset exported

DETAILS: Logged in as unix user gmd, and dce principal gmd
	 cd'd to directory in jfs exported fileset via dfs
	 	cd /:/cobbler_u1/gmd_dfs
	 successful file editing
	 idle overnight and tickets expire
	 ls is successful
	 dce_login gmd is successful then:

dce_gmd@cobbler> cd /:
/bin/ksh: /:: 0403-036 The specified directory is not valid.

	as unix user root and dce principal cell_admin:
root@cobbler> cm whereis /:/cobbler_u1/gmd_dfs
cm: '/:/cobbler_u1/gmd_dfs': Connection timed out

	BUT
	fts lsfldb is successful

	and on pmax client, can successfully access /:/cobbler_u1/gmd_dfs

dce_gmd@dce12# cd /:/cobbler_u1/gmd_dfs
dce_gmd@dce12# pwd
/.../cobbler_cell/fs/cobbler_u1/gmd_dfs

dce_gmd@dce12# cm whereis /:/cobbler_u1/gmd_dfs
The file '/:/cobbler_u1/gmd_dfs' resides in the cell 'cobbler_cell', 
in fileset 'cobbler.u1', on host cobbler.osf.org.

[1/21/93 public]
Changed Responsible Engr. from `pakhtar' to `tu@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[1/22/93 public]

More data ...

Killed and restarted dfsbind with -debug.
Exited dce_login shells and re-su'd to unix user gmd and re-dce_logged in,
still no luck.

	dce_gmd@cobbler> cd /:
	/bin/ksh: /:: 0403-036 The specified directory is not valid.

Exited dce_login shells and as unix user root (no dce_login):

	root@cobbler> cd /:
	dfs: ticket has expired! 
	dfs: Warning: created unauthenticated binding
	root@cobbler> ls
	ls: 0653-343 Cannot read ..
	root@cobbler> pwd
	/:
which is correct since root.dfs is in episode, protected by acls
and the acl on /.../cobbler_cell is:

	# SEC_ACL for /.../cobbler_cell:
	# Default cell = /.../cobbler_cell
	unauthenticated:r--t---
	group:subsys/dce/cds-admin:rwdtcia
	group:subsys/dce/cds-server:rwdtcia
	any_other:r--t---

so by dce_logging in :

	root@cobbler> dce_login cell_admin -dce-
	Password must be changed!
	root@cobbler> ls
	cobbler_u1

I'm all set ... as root/cell_admin.
Then I su to gmd, dce_login as gmd and I'm all set as well -
what happened? I have always been root su'd to gmd so that's
not it. And the new dfsbind didn't seem to have any effect.
Thanks -

[1/22/93 public]

To clarify this rather confusing situation, I'm modifying the above
note so that the prompts reflect the current unix user and dce principal.
To recap:

	I'm in dfs as unix user gmd, dce principal gmd and doing fine.
	My tickets expire and I'm still doing fine, that is, I can
	successfully do an ls in dfs.
	As unix user gmd, I re-dce_login as dce principal gmd and WHAM,
	I can't access dfs at all.
	I try as unix user root and dce_principal cell_admin and I
	can't access dfs either.

The rest is just attempts to debug/remedy the situation.
	The unix user gmd, dce principal gmd on the client
	machine can still access dfs.

	Killing and restarting dfsbind doesn't SEEM to help
	since my first attempt to access dfs is as unix user gmd
	and dce principal gmd and it fails. (Note that these
	failures are NOT permission/acl failures)
	Magically, as unix user root, NO dce principal, I have
	access but, correctly, no permission. 
	I dce_login as cell_admin and all is well. Not only
	that, as unix user gmd and dce principal gmd, all is
	well too!

My suspicion WOULD be the cache mgr if it weren't for the fact that
caches are dce principal specific and BOTH dce principals gmd and
cell_admin were shut out. What else is common to all dce
principals on the client side that could "go stale" and might
get refreshed by access as hosts/<machine name>/self? Is it something
in dfsbind?

Thanks again.

[1/22/93 public]

After talking to you on the phone and reading your recent recap, I think I 
know the "pattern" that caused the problem. 
>
>DETAILS: Logged in as unix user gmd, and dce principal gmd
>	 cd'd to directory in jfs exported fileset via dfs
>	 	cd /:/cobbler_u1/gmd_dfs
>	 successful file editing
>	 idle overnight and tickets expire    *********
>	 ls is successful
>	 dce_login gmd is successful then:
>
>dce_gmd@cobbler> cd /:
>/bin/ksh: /:: 0403-036 The specified directory is not valid.
>
After "idle overnight and tickets expire", "ls is successful" doesn't mean
ls really fetches any data from the server. In fact, 'ls' might use
the cached info about that dir. (Note: ls should fail with EACCES when the 
ticket expires. This should get fixed when the kinit work gets integrated in
the future.)

Your 'cd /:' failed initially  suggested that there could be a problem 
with dfsbind then again I could not explain why the rest of dce_login/cd would
work. 

Do you remember that you 'cd /:' "immediately" after your started a new 
dfsbind ? That might make some difference. 

>
>Exited dce_login shells and as unix user root (no dce_login):
>
>	root@cobbler> cd /:
>	dfs: ticket has expired! 
>	dfs: Warning: created unauthenticated binding
>	root@cobbler> ls
>	ls: 0653-343 Cannot read ..
>	root@cobbler> pwd
>	/:
>
BTW, the error message 'dfs: ticket has expired!' indicated the usr must be
associated with a pag (ie., had been already dce_logined) not just as
unix user root.

In any event, next time when you see the same problem (ie., leave the 
machine idle for a night), please do NOT kill the dfsbind, get icldump
on both dfsbind and cm first. After starting a new dfsbind, wait for a min
or so before doing 'cd /:' and get icl dump if it sill does not work.

[1/27/93 public]
Upgrading to priority 0 due to new policy about bugs blocking system test.
To answer your questions/comments:

If you are unix user root, you don't have to dce_login to have credentials,
you are automatically the dce principal hosts/<machine name>/self.

The cd /: after the new dfsbind was immediate.

I will look for this problem (and others) when the 2.4 drop is available
in a build.

[1/29/93 public]
Upgraded to a 2.3 build that contained the fix for 6917 (which is actually
removing a previous fix). In any event, this build should allow dfsbind
and other processes to successfully renew tickets. Left the machine
idle overnight (except for a periodic "ps" gathering statistics). This
morning, with a /bin/sh:

root@dce12> cd /:
/:: Invalid argument

root@dce12> /bin/ksh
root@dce12> cd /:
/:: The directory specified is not valid.

BUILD:	nb available 1/27 (2.3 + 6917 fix)
CONFIG: rios fl server with root.dfs in jfs ** NOTE - no episode!
	pmax fl server with ufs partition exported
	pmax file server with ufs partition exported
	both are also dfs clients

The only machine that this is occurring on right now is the pmax
file server - the rios and other pmax are fine.

I have an icldump, icl.bind and ps log - can you log in remotely and
take a look? Thanks

[1/29/93 public]
This seems to be the same problem as the one described in OT 6917. The fix
to OT6917 was in sec_login of 1.0.2b14. Are you sure that your dfs 2.3 is 
running on this DCE core. 

Please mail me the icl.bind you have. It should not be that long. 

Thanks.

[2/1/93 public]

The earlier description of the problem certainly sounds like it was
linked to the failure to refresh the "self" tickets.  One piece of
data missing from this bug report is if this behavior has been
observed on a newly restarted cell (e.g. rebooted) or if it only
happens after some set period of time.

I'd like to see this resolved, as it has been open quite some time.
I'm adding Comer to the CC list because of Tu's concerns this is
related to dfsbind.

Also, now that you have 2.4 does this still happen?

So many variables, so little time!

[2/11/93 public]
How true Tony ... Changed the short description for clarity, changed the
severity back to 0, changed the component so security due to new details
listed below. NOTE: b14 DEFINITELY includes the fix for 6917.

REPRODUCABLE AT WILL:	No
BUILD:			b14
CONFIG:			RIOS = cds,sec server, fl server - root.dfs in jfs
			PMAX1 = fl server, cds, sec, dfs client
			PMAX2 = fl server, cds, sec, dfs client
TEST:			ran through dfs.repfldb_checklist then left cell
			idle overnight, then began running test that
			does file and directory reads and writes (LOW
			stress) from RIOS and PMAX2.

DETAILS:	on pmax2
		cd /: -> Connection timed out.
		dce_login cell_admin -dce-
		cd /: -> Connection timed out.
		dce_login gmd blah (test principal and password I've added)
		cd /:: Connection timed out.
		kill -30 229 (dfsbind pid)
		kill 229
		dfsbind -debug
		cd /: -> Invalid argument
		cdscp show dir /.: -> fine

I have the icl.bind file and the small output of dfsbind -debug. I looked
at the icl.bind file and saw the error code 387064044 -> No currently
established network identity for which context exists. (dce /sec). Checked
/usr/adm/messages - nothing. Sec_clientd is still running BUT the machine
cred files dcecred_ffffffff* are missing.

As I'm investigating this, on the RIOS:
sec_clientd 02/11/93 15:39:02 - Warning - unable to refresh identity ... will idle and retry
... No credentials cache file found (dce / krb)

Sure enough, the machine cred files are missing on the RIOS as well and now
cd /: -> Invalid argment as well (although minutes before this, access to
/: was fine). Secd and sec_clientd still alive and running.

PMAX1 however, is fine and can access /:. 

The cell has been up and running fine for 2 days. PMAX2 however, was rebooted
and restarted ~24 hours ago.

Reducing default ticket lifetimes to 2 hours and running some tests with
secd and rpcd in debug mode in the foreground.

[2/16/93 public]
Ran dfs.lock with 2h default ticket lifetime and secd in foreground using
b15. Came up with CR 7234 but no additional data for this one. Will try
again soon.

[2/18/93 public]
Assigned it to myself.  Unfortunately, we don't have DFS up and running here
and with the plethora of defects I'm working on, I definitely won't have time
to learn how in the next week or so... so I'm only going to be able to try and
reproduce similar problems (ie: why the creds files disappear out from under
sec_clientd...).

[hsiao 02/25 public] 

I just lost another dcecred_ffffffff file --- so far twice. The only
clue I have is that, long before I realized its loss, I had run a long 
login/logout test.

[2/25/93 public]
The ONLY reason this file should be able to disappear is if you aren't logged
in and purge the default context.  If a test runs kdestroy without being
logged in (ie: KRB5CCNAME not set) it will blow away the host's creds.  If a
test calls sec_login_purge_context() with the default context, it may be able
to blow it away too (I haven't thought that one through as far as ref counts...
go, but it seems like it could happen).  If so, then it would be a test bug.

[2/26/93 public]

Is this it?

dfs: set auth binding failed (code -1)
dfs: Warning: created unauthenticated binding
# klist
No DCE identity available: No currently established network identity for which context exists (dce / sec)

Kerberos Ticket Information:
klist: No credentials cache file found (dce / krb) while setting cache flags (ticket cache /opt/dcelocal/var/security/creds/dcecred_41000003)

# env
TZ=EST5EDT
DISPLAY=nike:0.0
USER=root
TERM=xterm
HOME=/
SHELL=/bin/csh
LOGNAME=root
PATH=/sbin:/usr/sbin:/usr/bin:/usr/local/bin:/usr/bin/X11
KRB5CCNAME=FILE:/opt/dcelocal/var/security/creds/dcecred_41000003

Here's what's in the creds directory:
dcecred_4100000b       dcecred_4100000d.nc    dcecred_57a60001
dcecred_4100000b.data  dcecred_4100000e       dcecred_5c469b01
dcecred_4100000b.nc    dcecred_4100000e.data  dcecred_ffffffff
dcecred_4100000c       dcecred_4100000e.nc    dcecred_ffffffff.data
dcecred_4100000c.data  dcecred_5664fb01       dcecred_ffffffff.nc
dcecred_4100000d       dcecred_5664fb01.nc
dcecred_4100000d.data  dcecred_57137f01


This dfs client has been up for 2days with the same core components.
Previous to this its core server had been down for awhile and was
rebooted and dce restarted.  I noticed this problem sometime after
the restart of the core server, wherein this client had bigtime
clockskew problems which were resolved well before I issued the klist
command.  

I am running b17.

[3/2/93 public]

disregard my previous comments; I really belive this was an 
error on my part.

[3/2/93 public]
The current status of this bug is:
	- test does NOT contain a kdestroy so that possibility is out
	- OT 7234 fix is not yet in so I may not get far trying to reproduce it

[3/3/93 public]
I'm also seeing the machine creds disappear with the latesti nightly build
from 3/3/93. I caught it by configuring a cell. Set registry property:
Default certificate lifetime to 10 minutes. The sec_clientd complained
that it could not refresh identity and no credential cache file found in
roughly ten minutes. Additionally I was executing sec.rgy.7 at the same time.
I am not sure how easily this is recreated yet.

[3/16/93 public]
According to Gail, the original reported problem here is not a security
problem, and may or may not be still happening, but would have to be addressed
by DFS, not security, so the real problem being reported is that the host
principal's creds (dcecred_ffffffff) are being blown away by somebody...

Ed's test (sec.rgy.7) was able to blow them away, but I believe I found that
problem, and opened a CR against the test (7513).

Gail, were there any tests that do logins/logouts running when you encountered
the problem with the host's creds file disappearing?  If so, which tests and
where can I find them.

[3/16/93 public]
Mike - the dfs system tests make use of the dce_login -exec switch to
run tests remotely in a security context. There are no kdestroys in the
tests. The tests are:
	src/test/systest/file/dfs.glue
	src/test/systest/file/dfs.lock
These scripts use the filewnr and dirread programs as well as the dirwrite.sh
script. Sample data files for these scripts are:
	src/test/systest/file/glue.data
	src/test/systest/file/lock.data
Please take a look and let me know if there is a problem with these tests.

[3/17/93 public]
Thanks for looking at the tests Mike. I'm dropping the priority to 2 -
haven't seen this in awhile and will likely be able to cancel.

[6/22/93 public]
This has not been seen at all - canceling.



CR Number                     : 6903
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : Salvage Authorization Check Test does not check salvage success correctly.
Reported Date                 : 1/19/93
Found in Baseline             : 1.0.2b6
Found Date                    : 1/19/93
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[1/19/93 public]
The salvage authorization check test needs to consider that a
successful salvage command can have a non-zero return code 3.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[9/1/93 public]
Canceled because it is no longer true in the 1.0.2 code base.
Changed Status from `open' to `cancel'



CR Number                     : 6880
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : 
Short Description             : mkgmtime cannot handle extremely large (+/-) input timetms
Reported Date                 : 1/18/93
Found in Baseline             : 1.0.2
Found Date                    : 1/18/93
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : utcapi.c
Sensitivity                   : public

[1/18/93 public]

From Jim Wade at IBM:
name          3275
abstract      mkgmtime cannot handle extremely large (+/-) input timetms.

notes:
    <Note by rdl (Rick LeMon), 92/10/12 16:34:19, action: open>
mergetime (called by utc_mkgmtime) cannot handle extremely large (+/-) input
timetm's without returning -1.  Extremely large means within one year of
the extremes of time representable by a utc.

    <Note by rdl (Rick LeMon), 92/10/13 09:21:33, action: note>
Same happens when mergetime is called by utc_mklocaltime.

    <Note by mcmeen (John B. McMeen), 92/12/10 11:22:23, action: modify>
OT should be written, fix must come from OSF.

[06/28/93 public]
I could really use further information on this defect.
Like a specific test case.

utc_mkgmtime() handles time conversion with tm structs that
define years up to 28,910 years in the future.

This is enforced by this code in mergetime():
    year = tm->tm_year + 1900;
    if (year < -27644 || year > 30809)
        return(-1);

It is possible that inceasing these limits would break the conversion
algorithm in an unknown way. Besides, this is very close to the
approximate 30,000 year range claimed for a utc struct.

I am canceling this defect.
Please feel free to reopen if you have a specific tm struct value that
this code fails for (and provide it!).



CR Number                     : 6853
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : mx300
S/W Ref Platform              : sinix
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : inconsistent error message on 'delete clearinghouse'
Reported Date                 : 1/15/93
Found in Baseline             : 1.0.2
Found Date                    : 1/15/93
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/15/93 public]

Set up the a clearinghouse with the following acl:

	unauthenticated:r----
	user:000003F8-F0BB-21CB-8300-0000C0365F52:-w---
	group:subsys/dce/cds-admin:rw-tc
	group:subsys/dce/cds-server:rw-tc
	any_other:r----

and then issue:

	cdscp delete clearinghouse

command.  The error message returned is:

	Failure in routine: cp_clrdel_clh; code = 282108909
	Insufficient rights to perform requested operation (dce / cds)

This is different than other permission problem error message.  For
example, most other problems print out something like:

	Error on entity: /.../psycho.cells.sni-usa.com/dacl_delete_anyother_13070/dacl_deletes
	Insufficient rights to perform requested operation (dce / cds)
	Function: dnsDelDir

[12/13/93 public]
The second message results from an error status being returned by one
of the cdspi functions while the first is the result of failure being
detected in some other function. The kind of information in hand at the
time of a cdspi failure is more or less predictable and a special error
message routine is called to put out what you see in the second message.
The first message on the other hand is a best effort notification of
a condition at the time of failure. The information in hand is by nature
unpredictable and the message routine in intentionaly simple minded.
I investigated the possibility of improving the exiting mechanism and
concluded any worthwhile change would involve substantial changes to
the exiting code. Since the 1.1 servicability package will replace the
existing mechanism, and hopefully rid the code of the above
inconsistancies, we will forego any changes for 1.0.3.



CR Number                     : 6831
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : 
Short Description             : incremental build problems
Reported Date                 : 1/14/93
Found in Baseline             : 1.0.2
Found Date                    : 1/14/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[1/14/93 public]
PMAX:

[ /file/flserver

fldb_proc_cstub.c: In function VL_GetStats:
fldb_proc_cstub.c:3891: structure has no member named `reserved'
fldb_proc_cstub.c:3976: structure has no member named `reserved'

[ /file/ftserver
makepath ftserver/. && cd ftserver &&  exec make MAKEFILE_PASS=THIRD
build_all
/project/dce/build/nb_pmax/tools/pmax/macho/gcc
-B/project/dce/build/nb_pmax/tools/
pmax/macho/  -c    -D_SHARED_LIBRARIES -O  -Dunix
-DDCESHARED_PATH=\"/opt/dce\" -DD
CELOCAL_PATH=\"/opt/dcelocal\"  -G 0 -pedantic -Wpointer-arith -nostdinc
-Wtrigraph
s -Wcomment    -I- -I. -I/project/dce/build/nb_pmax/src/file/ftserver
-I/project/d
ce/build/nb_pmax/export/pmax/usr/include
-I/project/osc/build/osc_sbox1.1.1/export/
pmax/usr/include -I/project/osc/build/osc1.1.1/export/pmax/usr/include
-pic-lib   -
L/project/dce/build/nb_pmax/export/pmax/usr/shlib -L/usr/shlib
-L/project/dce/build
/nb_pmax/export/pmax/usr/lib
-L/project/osc/build/osc1.1.1/export/pmax/usr/ccs/lib
 -ldce   ftserver_proc_cstub.c

ftserver_proc_cstub.c: In function FTSERVER_GetStatus:
ftserver_proc_cstub.c:1730: structure has no member named `static_spare1'
(missing `static_spare1',2,and 3)

-ldce   ftserver_proc_sstub.c
ftserver_proc_sstub.c: In function op12_ssr:
ftserver_proc_sstub.c:1978: structure has no member named `static_spare1'
ftserver_proc_sstub.c:1980: structure has no member named `static_spare2'
ftserver_proc_sstub.c:1982: structure has no member named `static_spare3'
ftserver_proc_sstub.c:2100: structure has no member named `maxQuota'

[ /file/episode/vnops at 01:38 (AM) Thursday ]
makepath vnops/. && cd vnops &&  exec make MAKEFILE_PASS=BASIC
build_all
make: don't know how to make ../../../file/episode/vnops/efs_mtpt.h
(continuing)

max/usr/ccs/lib  -ldce   ../../../../../src/file/episode/vnops/efs_newvol.c
/project/dce/build/nb_pmax/tools/pmax/macho/gcc

max/usr/ccs/lib  -ldce   ../../../../../src/file/episode/vnops/stubs.c
/project/dce/build/nb_pmax/tools/pmax/macho/gcc
-B/project/dce/build/nb_pmax/tools/
pmax/macho/  -%ld," -warn_nopic -glue"  -O
-L/project/dce/build/nb_pmax/expo
rt/pmax/usr/shlib -L/usr/shlib
-L/project/dce/build/nb_pmax/export/pmax/usr/lib -L/
project/osc/build/osc1.1.1/export/pmax/usr/ccs/lib -o newvol.X efs_newvol.o
stubs.o
  -lefsops -ldir -lanode -llogbuf -lasync -leacl  -lxcred -losi -llwpdummy
-lafsuti
l -ldfskutil  -ledsk  -lcom_err -ltools  -ldacl -ldacllfs  -ldce -lbsd
efs_newvol.o: Undefined symbol "vnm_CreateVolume" referenced

../../../../../src/file/episode/vnops/test_vnodeops.c
test_vnodeops.o: Undefined symbol "vnm_CreateVolume" referenced

[ /file/libafs at 01:49 (AM) Thursday ]
makepath libafs/. && cd libafs &&  exec make MAKEFILE_PASS=BASIC
build_all
/project/dce/build/nb_pmax/tools/pmax/macho/ld -T 80030000  -e start -o
dfsvmunix -
L/project/dce/build/nb_pmax/export/pmax/usr/lib
-L/project/osc/build/osc1.1.1/expor
t/pmax/usr/ccs/lib  ../../../../obj/pmax/kernel/DCE/vmunix.sys   -lcm
-lkdfskutil -
lafs -laggr -lcm -lkdfsncs -lkdfskutil  -lpx -lhost -lkzlc -lktkset
-lkxcred -lkrep
cli  -lkosi -lkicl -lkfldb -lkafs4srv  -lkafs4clt -lkcommondata -lufsops
-lxvnode -
lagfs  -lktkc -lktkm -lktpq -lvolreg -lvolume -lkdacl -lkdacllfs -lepidum
-lkosi -l
kdacl  -lknck -lkidl -lkdes
cm_pioctl.o: Undefined symbol "cm_PSetAcl" referenced
cm_pioctl.o: Undefined symbol "cm_PGetAcl" referenced

RIOS:
[ /file/flserver at 20:07 (PM) Wednesday ]
makepath flserver/. && cd flserver &&  exec make MAKEFILE_PASS=THIRD
build_a
/usr/include  fldb_proc_cstub.c
"fldb_proc_cstub.c", line 3891.28: 1506-022 (S) reserved not a member of
the str
uct or union stats_.
"fldb_proc_cstub.c", line 3976.28: 1506-022 (S) reserved not a member of
the str
uct or union stats_.
*** Error code 1 (continuing)

[1/15/93 public]
As discussed with Rich Zeliff, two incremental build problems
have been identified:

1) The dependencies for IDL generated .c stubs are not accurately
determined.

2) Defuncted header files (or presumably other files) can confuse
the dependency list generation process for libraries.  The result 
is these libraries will not get rebuilt because they do not have a 
complete dependency list.

The issue is further confused by the fact that old versions of 
these libraries may still reside in the export tree and the build
will attempt to link with these stale versions.

I will leave it up to Rich to reclassify/reprioritize this OT as 
appropriate.  Re-assigned to Rich.

[1/21/93 public]
The defect changed to an enhancement becaus: (addressing Ron's points,
above)

1.  This is a goal for the code cleanup project for 1.1
2.  The Rats can watch for defuncted files on the submission requests and
schedule full builds rather than incremenetal builds
3.  We will begin removing the export tree every night as part of the build
process.

[11/12/93 public]
Incremental builds are no longer done.  All other work is covered by code
cleanup goals.



CR Number                     : 6801
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : CM
Short Description             : system call write failed for a large file.
Reported Date                 : 1/12/93
Found in Baseline             : 1.0.2
Found Date                    : 1/12/93
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[1/12/93 public]
Have two processes runing on same machine and let them writting 64k data
a time into a file interleavely and repeatly via DFS then check the contents 
and the file size. Both the content and the size will be wrong. This problem 
was found from dfs-102-2.2 by running my ITL scripts"read-write-dist.scr" that
can be found form "~jess/dfs/sb/src/test/file/os_calls/stress". It has no
problem to pass the test form glue layer.
To run the scripts: (telnet to moe)
  1. Have three windows (one HUB, two spokes).
  2. cd /:/test1/stress (for all windows).
  3. issur the command "./file_test -l /.:/dfs_test/a" from one of windows.
  4. issur the command "./file_test -c /.:/dfs_test/a" from the rest two.
  5. type "inc read-write-dist.scr" form the window for step 3.
  6. check the part "Test write consistency among spokes".
You will see the problem.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[2/8/93 public]
These semantics are beyond what POSIX requires for a local file system.  While
we might wish to enhance this functionality at some point, it is not a defect
in DFS.
Changed Status from `open' to `cancel'

[2/8/93 public]
After more discussion, this is being reopened.  POSIX requires strong length
setting semantics.  Not a P1, however.
Changed Priority from `1' to `2' 
Changed Status from `cancel' to `open'

[8/31/93 public]
Could not reproduce it myself in 103 code base. Jess mentioned that 
he could not reproduce it either. In fact, he just ran that specific itl script
yesterday in 103 code base on Solaris and passed the test.
This defect could be fixed as a result of other works in CM's dcache area. 
                                                                               
Mark it Cancelled
Changed Status from `open' to `cancel'



CR Number                     : 6772
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : incorrect aggregate size calculation in salvage
Reported Date                 : 1/8/93
Found in Baseline             : 1.0.2
Found Date                    : 1/8/93
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[1/8/93 public]
The edsk_CheckAsEpisode function, used by the salvage program to compute
and verify superblock parameters, incorrectly calculates the aggregate
size when it is a multiple of 64KB, or is up to 1KB smaller than a
multiple of 64KB.  This causes salvage to complain "Device too small
for aggregate" when the aggregate is salvaged.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[9/30/93 public]
A reexamination of this code with Blake shows no bug.  Even at the time
this defect was reported there was no common case where the salvager
complained about "Device too small".  Either the bug was fixed
"accidently" or the original report was in error.
Filled in Interest List CC with `ota' 
Changed Status from `open' to `cancel'



CR Number                     : 6517
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : gds
Subcomponent Name             : dsa
Short Description             : gdsmkiss & gdsgendb don't work
across NFS
Reported Date                 : 12/17/92
Found in Baseline             : 1.0.2
Found Date                    : 12/17/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : gdsmkiss, gdsgendb
Sensitivity                   : public

[12/17/92 public]
We've seen this problem before and we've even opened defects against it,
but (if I remember correctly) we've had problems reproducing it.  Well,
here it is again:

This occured when building in a fully populated sandbox in which the obj
tree was provided via an NFS mount.

for i in /amigo1/devobj/sb/nb_pmax/export/pmax/usr/shlib /usr/shlib; do  if
[ -f $i/libdce.so ]; then  break;  fi  done;  rm -f attr*.* obje
cts*.*;  inlib $i/libdce.so;  ./gdsmkiss
../../../../../src/directory/gds/dsa/schema_ib;  rmlib $i/libdce.so
error from create file: ./objects0, iserrno 22
*** Error code 2 (continuing)

for i in /amigo1/devobj/sb/nb_pmax/export/pmax/usr/shlib /usr/shlib; do  if
[ -f $i/libdce.so ]; then  break
;  fi  done;  inlib $i/libdce.so;  ./gdsgendb . .;  rmlib $i/libdce.so
gendb aborted

[2/1/93 public]
This was originally an A0 because it broke a nightly build.  Since there's
a workaround (don't run these programs across a hard mount), we're
downgrading it to C2.

[2/17/93 public]
I can add some more information to the defect since we've run up against
this once again.

Here are the current list of symptoms:
	
			Mounted 
OS of Build		Filesystem		Result

RIOS			RIOS			works, go figure
RIOS			PMAX, hard mount	gdsmkiss hangs
						(for hours, 8 in
						this case)
RIOS			PMAX, soft mount	gdsmkiss returns
                                                an error 2.

[3/23/93 public]
hmm.  Downgraded to 3, deferred till 1.0.3.

[4/5/93 public]

I had the same problem a while ago when trying to build a sandbox on my
Sparc with obj mounted from a RIOS. gksmkiss hung there forever. I didn't
l=know what was going on, but got around it by cleaning up local disk and
had obj local.

Later I got a hanging problem again when doing threads testing. On test
(cuvb_nbi_005) tests fcntl (cma_fcntl). On thing it does is to create a 
write lock (F_WRLCK) for the file. When I ran  this
test, it failed by hanging there forever (could not be killed either).
Using debugger I found that it happens with the call to create the write
lock. It never returns. At first I thought that Sun may not sopport write
lock, or Sun's write lock is buggy. It turns out that it is because of nfs
(I mount another disk from another machine). When a lock is created, it
goes through the lockd. If the file is nfs mounted, the local lockd will
talk to the remote lockd, which will talk to statd for status monitoring.
If any one of the lockd or statd is not running, the process is waiting
forever. The machine I mount the disk did not run lockd and statd.

So, since gksmkiss uses fil lock too, I suspected that it was the same
cause. The RIOS I was using did not run lockd and statd by default, so I
started them and I was able to do nfs mount build.

Another thing I learned is that OSF/1 does not have lockd and statd, which
makes it impossible to nfs mount from a OSF/1 machine and do the build.

[10/7/93 public]
This is a problem with OSF's implementation of NFS and therefore isn't a
defect in GDS.  Cancelled.



CR Number                     : 6494
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : 
Short Description             : clean up obsolete ifdefs
Reported Date                 : 12/16/92
Found in Baseline             : 1.0.2
Found Date                    : 12/16/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Status               : closed
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com

[12/16/92 public]
Clean up obsolete ifdefs in the DFS code base.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[5/20/94 public]
This is a reminder that has outlived its usefulness.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 6417
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dskl
Subcomponent Name             : 
Short Description             : dswc: token processing error
during build
Reported Date                 : 12/10/92
Found in Baseline             : 1.0.2
Found Date                    : 12/10/92
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[12/10/92 public]

 /diskless/swap/kernel ]
makepath kernel/. && cd kernel &&  exec make MAKEFILE_PASS=BASIC
build_all
cc -c        -D_KERNEL -DKERNEL  -DDEBUG_DSWC -D_ALL_SOURCE -DAIX32   -I.
-I/usr/users/devobj/sb/nb_rios/src/diskless/
swap/kernel -I/project/dce/build/dce1.0.2/src/diskless/swap/kernel
-I../user -I/usr/users/devobj/sb/nb_rios/src/diskle
ss/swap/user -I/project/dce/build/dce1.0.2/src/diskless/swap/user
-I/usr/users/devobj/sb/nb_rios/export/rios/usr/inclu
de -I/project/dce/build/dce1.0.2/export/rios/usr/include
../../../../../src/diskless/swap/kernel/dswc.c
/usr/users/devobj/sb/nb_rios/tools/rios/bin/idl
-I/usr/users/devobj/sb/nb_rios/export/rios/usr/include -I/project
/dce/build/dce1.0.2/export/rios/usr/include `genpath -I../config`  -keep
c_source -header ./dswd.h   -I/usr/users/devo
bj/sb/nb_rios/export/rios/usr/include
-I/project/dce/build/dce1.0.2/export/rios/usr/include
../../../../../src/diskles
s/swap/user/dswd.idl -server none
cc -c        -D_KERNEL -DKERNEL  -DDEBUG_DSWC -D_ALL_SOURCE -DAIX32   -I.
-I/usr/users/devobj/sb/nb_rios/src/diskless/
swap/kernel -I/project/dce/build/dce1.0.2/src/diskless/swap/kernel
-I../user -I/usr/users/devobj/sb/nb_rios/src/diskle
ss/swap/user -I/project/dce/build/dce1.0.2/src/diskless/swap/user
-I/usr/users/devobj/sb/nb_rios/export/rios/usr/inclu
de -I/project/dce/build/dce1.0.2/export/rios/usr/include  dswd_cstub.c
cc     -edswc_config -bI:/lib/kernex.exp -bI:/lib/syscalls.exp
-bloadmap:dswc.ldmap -bI:../../../../../src/diskless/s
wap/kernel/extras.exp    -L../RIOS
-L/usr/users/devobj/sb/nb_rios/src/diskless/swap/RIOS
-L/project/dce/build/dce1.0.2
/src/diskless/swap/RIOS -L/usr/users/devobj/sb/nb_rios/export/rios/usr/lib
  -L/project/dce/build/dce1.0.2/export/ri
os/usr/lib -o dswc.X dswc.o dswd_cstub.o   -lkidl -lknck -lkdes
0706-154 ERROR:  Error in token processing;
                  number of tokens exceeds maximum of (8)
0706-154 ERROR:  Error in token processing;
                  number of tokens exceeds maximum of (8)
0706-154 ERROR:  Error in token processing;

[2/16/93 public]

Because neither OSF nor any of the providers are dependent on this code,
the priority is being lowered.

[5/25/94 public]
The diskless source has been defuncted from the tree.
OSF no longer supports diskless.
Canceled.



CR Number                     : 6320
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : 
rgy_edit help text needs improvement.
Reported Date                 : 12/3/92
Found in Baseline             : 1.0.1
Found Date                    : 12/3/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[12/3/92 public]

Full Description:

   On-line rgy_edit help can be much improved.  In many cases, only
syntactical assistance is given. Additional information, including at least
a brief description of the command its purpose, as well as the semantics
of its arguments should be included. See the 'scope' and 'ktadd' commands
for good examples, and the 'member' command as an example of a command
which needs improvement.



CR Number                     : 6302
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 5329,6278
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : dfs
Subcomponent Name             : 
Short Description             : apparent violation of POSIX semantics
Reported Date                 : 12/2/92
Found in Baseline             : 1.0.2
Found Date                    : 12/2/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.2
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[12/2/92 public]

Using the 1.55 bits on HPUX, the following sequence run on a single-machine
DFS cell produces an error:

cd /:
cp 4MB 4MBcopy &
rm 4MB

The intention is that the 'rm' take place while 'cp' is still running.
If DFS is POSIX compliant, we should get a complete copy in '4MBcopy' 
and when 'cp' closes the '4MB' file, it will be actually deleted.
But on HPUX, we get a read error in mid-copy.

This OT may be related to 6278 and/or 5329, which is still listed as open.
I thought I'd log it separately in case it isn't.
If people cannot reproduce the error on a reference platform, we'll 
chase the bug here.

[12/14/92 public]
I can't duplicate this problem, and we've fixed plenty of problems in this area,
so I'm cancelling this bug.  Reopen it if it appears again.

Here's the log of two of these runs, using a 3 MB cache.  I did the operations twice,
once with a flushed file and once without the flush.  In both cases it worked:

# cat /unix /unix /unix >bigfile
ls -l bigfile
# -rw-r--r--   1 root     system   4402329 Dec 14 17:04 bigfile
# cm flush bigfile
# cp bigfile bigfile2&

 [1] 25623
# rm bigfile
# ls -l bigfile2
-rw-r--r--   1 root     system    794624 Dec 14 17:05 bigfile2
# !!
ls -l bigfile2
-rw-r--r--   1 root     system   1499136 Dec 14 17:05 bigfile2
# !!
ls -l bigfile2
-rw-r--r--   1 root     system   2555904 Dec 14 17:05 bigfile2
# !!
ls -l bigfile2
-rw-r--r--   1 root     system   3596288 Dec 14 17:06 bigfile2
# !!
ls -l bigfile2
-rw-r--r--   1 root     system   4382720 Dec 14 17:06 bigfile2
# !!
ls -l bigfile2
-rw-r--r--   1 root     system   4402329 Dec 14 17:06 bigfile2

 [1]  + Done                 cp bigfile bigfile2
#
#
# \

#
#
#
# mv bigfile2 bigfile
# ls -l bigfile*
-rw-r--r--   1 root     system   4402329 Dec 14 17:06 bigfile
# sync
cp bigfile big# file2&^R
cp bigfile bigfile2&

 [1] 25634
# rm bigfile
#
#
#
# ls -l bigfile*
-rw-r--r--   1 root     system    712704 Dec 14 17:07 bigfile2
#

 [1]    Done                 cp bigfile bigfile2
# ls -l bigfile*
-rw-r--r--   1 root     system   4402329 Dec 14 17:07 bigfile2
#
Changed Status from `open' to `cancel' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'



CR Number                     : 6258
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : bak
Short Description             : "addftentry" won't accept DCE pathname for -server option
Reported Date                 : 12/1/92
Found in Baseline             : 1.0.2
Found Date                    : 12/1/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[12/1/92 public]
   "addftentry" only accepts short names instead of full DCE pathnames for
the -server option.  e.g. "foo" for "/.../<cellname>/hosts/foo
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[7/20/93 public]
ot6724 actually fixed, among other fixes, this particular problem reported
in this defect. The delata,  vijay-ot6724-bak-resolve-host-name-issues, has
been already integrated into the 1.0.2 tree around Jan, 93. 
Mark this cancelled. 
Changed Status from `open' to `cancel'



CR Number                     : 6249
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : bak
Short Description             : "restoreft" doesn't recognize DCE pathname for server
Reported Date                 : 12/1/92
Found in Baseline             : 1.0.2
Found Date                    : 12/1/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[12/1/92 public]
   "restoreft" recognizes 'short' names for the -server option, not DCE
pathnames.  e.g. It recognizes dewitt instead of
/.../dewitt.transarc.com/hosts/dewitt.  The procedure
bak/commands.c:bc_VolRestoreCMD calls bak/dsvs.c:bc_ParseHost which, in
turn, calls ???:gethostbyname and this procedure takes only short names.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[7/20/93 public]
As with ot6258, this defect was already fixed by ot6724, as part of other
fixes. The delta, vijay-ot6724-bak-resolve-host-name-issues, has been
already integrated into the 1.0.2 tree around Jan of 93. 
Mark it cancelled
Changed Status from `open' to `cancel'



CR Number                     : 6227
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : secd
Short Description             : Add rgy prop flag to disallow neg uids
Reported Date                 : 11/30/92
Found in Baseline             : 1.0.1
Found Date                    : 11/30/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : security/idl/rgynbase.idl,security/server/rs/?,security/server/rsdb/?
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[11/30/92 public]
rgy_edit allows creation of pgo's with negative unix uid in contradiction
with POSIX, XOPEN standards requiring unix uid to be a non-negative
integer.

Repeat as follows:

$ rgy_edit
Current site is: registry server at /.../pierrot_cell/subsys/dce/sec/master
rgy_edit=> do p
Domain changed to: principal
rgy_edit=> add
Add Principal=> Enter name: foo
Enter UNIX number: (auto assign) -100
Enter full name: ()
Enter object creation quota: (unlimited)
Add Principal=> Enter name:
rgy_edit=> v foo
foo                                         -100
rgy_edit=> quit
bye.

[11/30/92 public]
This feature was purposely allowed (some vendors require use of negative uids).
For those vendors that may want to be purely POSIX or X/OPEN, I've made this an
enhancement request for secd (*not* a defect of rgy_edit which should not be
the component making this decision since it's only a client of the API) to add
a properties flag disallowing creation of negative uids.  I've assigned it to
Joe for now, so he can decide the usefulness of adding this in 1.1.



CR Number                     : 6196
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cds/library/cdspi function
Short Description             : CDSPI - cdsCreateObj() converts attribute CDS_ClassVersion value
Reported Date                 : 11/24/92
Found in Baseline             : 1.0.1
Found Date                    : 11/24/92
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/24/92 public]

One Line Description:

        CDSPI - cdsCreateObj() converts attribute CDS_ClassVersion value

Full Description:

        Supplying a very large or very small value to the
        CDS_ClassVersion attribute on the cdsCreateObj() function
        will convert it to some small value.

        Class version values will converts like the following
        (in v.n format):
            -1.9999999999999999         to   255.255
            -11111111111111.300         to   0.44
            1000000000000.300           to   255.44
            1000.-100000000000000       to   232.0
            -24599999999.-1009999999999 to   0.0

        In CDSCP, if specify a value outside of range 0-255 for the
        version major or minor number, an object without the
        CDS_Class and CDS_ClassVersion attribute will be created.

        There is a limit ( zero to 255 ) to the value of v.n and
        this is not documented.  To the administrator, it would be
        unacceptable if these values were lost without warning.
        This limit exists because both the version major and version
        minor value are of type 'unsigned char'.  At the minimum, some
        warning message should be provided when these attributes are
        omitted.

Proposed Solution:

        Error checking should be done by CDSCP, warning message should
        be given when value is lost and this (the limits) must be
        documented.

[12/8/92 public]
Changed Sev/Pri as per OSF reclassification.

[9/22/93 public]
This bug is somewhat confusing. The "One Line Description" claimed that
CDSPI: cdsCreateObj converted attribute CDS_ClassVersion value wrong. But
CDSPI is private API which is not exported and the value check is supposed
to be done on upper layer not CDSPI/cdsCreateObj(). The "Full Description"
claimed that cdscp doesn't check the value (major or minor number) which is
never happened. The cdscp parser does check to make sure the values are in

[0-255]. The checking is done by cdscp parser and if a out-range value is 
detected whole process is gone off.  Cancel this non-bug!



CR Number                     : 6171
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : nidl_to_idl
Short Description             : calls itself to2 rather than nidl_to_idl
Reported Date                 : 11/20/92
Found in Baseline             : 1.0.2b4
Found Date                    : 11/20/92
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/20/92 public]

The usage message in rpc/idl/nidl_to_idl refers to the program as "to2"
rather than "nidl_to_idl".

The version number of 0.001 seems rather low.

This is a purely cosmetic problem, of course.

[1/7/93 public]
Promoted to enhancement.

[5/13/94 public]
For DCE 1.1, this program is no longer supported and will be defuncted.
Enhancement canceled.



CR Number                     : 6155
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : Wrong error message when
setting CDS_InCHName attribute of a directory.
Reported Date                 : 11/19/92
Found in Baseline             : 1.0.2b5
Found Date                    : 11/19/92
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/19/92 public]

Full Description:

        Setting the CDS_InCHName attribute to false (from true) of
        a directory that contains a child directory whose
        CDS_InCHName attribute is true returns error message:

            "Error on entity: /.../TLBDS4MEcell/dir1
             Directory must be empty to be deleted (dce / cds)
             Function: dnsDisallowCH                           "

        This error message is incorrect since no delete operation is
        performed.  The error message should indicate that all its
        descendants must not have the ability to store clearinghouse
        names.

Repeated By:

        from the CDSCP prompt, enter

              cdscp>  create dir /.:/dir1
              cdscp>  set    dir /.:/dir1 CDS_InCHName = true
              cdscp>  create dir /.:/dir1/dir2
              cdscp>  set    dir /.:/dir1/dir2 CDS_InCHName = true
              cdscp>  set    dir /.:/dir1 CDS_InCHName = false
              Error on entity: /.../TLBDS4MEcell/dir1
              Directory must be empty to be deleted (dce / cds)
              Function: dnsDisallowCH

              cdscp>

Proposed Solution:

        Change the error message in the code to reflect the nature of
        the error more accurately.

[11/24/92 public]
(Proxy for Dave Griffin)
This is a design bug -- a new error code will have to be invented.   I don't
see any alternative mappings for the error that are any better than NotEmpty
(what it uses right now).

[8/9/93 public]
The fix is to add a new error code to dns[cds]msg.msg though. But the
attribute is going to go away in 1.1. So defer this one to 1.1.

[8/9/93 public]
Since this bug is going to be cancelled in 1.1. We decided to cancel
it now instead of deferring it.



CR Number                     : 5962
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : login
Short Description             : Assertion failure while shutting down cell
Reported Date                 : 11/6/92
Found in Baseline             : 1.0.2
Found Date                    : 11/6/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/6/92 public]

Actions prior to the assertion failure (described below):

A cell consisting of a single PMAX was configured. Then I 
shut down and brought back up secd a few times (a couple of
times in locksmith mode). The final time secd was started normally
(i.e. not in locksmith mode) and then I left the cell running
overnight.

When I came in the morning a dce_login 'hung'. Killing the cdsclerk 
did not have any effect.  So I tried to shut down the cell and got 
the following assertion failure:

# sh /etc/dce.clean
Stopping DCE daemons...
 Assertion failed: found_present == 1 , file ../../../../src/security/client/log
in/sec_login_cache.c , line 149
        DCE daemons stopped
#

The baselevel used was a nightly build from Nov 2 morning.

[1/29/93 public]

Need more information.

If anyone sees this again, put complete information here and call me..

[8/2/93 public]

Has anyone seen this problem lately, on the new reference platforms?
No action since 1/29, we'd like to cancel it if it no longer exists.



CR Number                     : 5930
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dts
Subcomponent Name             : 
Short Description             : DTSCP prompt to be removed when inputting from a file
Reported Date                 : 11/4/92
Found in Baseline             : 1.0.1
Found Date                    : 11/4/92
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[11/4/92 public]

Full Description:   When input to control program is redirected from
a file, the prompts output by the command processor may be staggered.
For example, suppose input.fil contains the following:
    set servers required 4
    enable
    show servers required

Then the control program is invoked (on AIX) as follows:
dtscp < input.fil

The following output is produced:

dtscp> dtscp> dtscp> Servers Required          = 4
dtscp> [svrs3] temp>

Note that '[svrs3] temp>' is the UNIX shell prompt.
The dtscp prompts thus appear staggered, i.e. with no carriage return
between them, corresponding to those commands that produce no output.
This can be confusing to the customer.

It would be preferable if for the redirection mode the prompts were not
printed at all, or at least, if they were printed on separate lines.

[06/07/93 public]
Dtscp uses a DEC parsing program which has this characteristic.
I believe cdscp will show this behavior too.
If the user doesn't want to see these prompts, they can use this
form of invocation:
    dtscp set servers required 4
    dtscp enable
    dtscp show servers required

Also, the new DCE Shell will provide dtscp functionality and will
support scripting.

Bug canceled.



CR Number                     : 5816
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 5815
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : stub code
Short Description             : DFS stub code is bloated
Reported Date                 : 10/26/92
Found in Baseline             : 1.0.2
Found Date                    : 10/26/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : Various Makefile's and .acf files.
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[10/26/92 public]

Please refer to OT5815 for a description of an IDL compiler
enhancement that can be used to help reduce DFS kernel stub sizes.

Once IDL is so enhanced, the DFS .acf files should be modified to
make more aggressive use of the IDL [out_of_line] attribute, and
the Makefiles should be modified to eliminate the use of 'caux'
files.  Also, the couple of 'xxx_s2c.h' header files can be defuncted.

This change cannot be implemented until the fix of OT5815 is submitted.

[2/9/93 public]
And it should stay marked as an enhancement at least until OT 5815 is
addressed.
Changed Defect or Enhancement? from `def' to `enh' 
Changed Fixed In Baseline from `1.0.2' to `' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[10/26/92 public]
I believe this enhancement was included in the 1.0.3 IDL compiler.
Assigned to Mike to verify since it's relevant to small resource
effort.

[4/29/94 public]
I'm canceling this bug since the problem has indeed been
fixed in the new IDL compiler.  (Note that the prerequesite
OT 5815 has also been cancelled.)



CR Number                     : 5815
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : idl
Short Description             : idl makes bloated stubs
Reported Date                 : 10/26/92
Found in Baseline             : 1.0.1
Found Date                    : 10/26/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : oolrtns.c
Sensitivity                   : public

[10/26/92 public]

 The current IDL compiler has a serious, but very simple defect
that causes excessive stub code to be generated.  This OT report
describes a small change to IDL that will result in dramatic
savings in DFS and other DCE components.
.
BACKGROUND
  When the IDL author tries to conserve code space by applying
the [out_of_line] attribute to complex data types, the subroutines
for marshalling and unmarshalling complex data types are generated
in the xxx_caux.c and xxx_saux.c files.  The idea is that the
client stub code in the xxx_cstub.c file calls the marshall/unmarshall
routines in the xxx_caux.c file, and the server stub code in the
xxx_sstub.c file calls the marshall/unmarshall routines in the
xxx_saux.c file. 
.
  Each out_of_line data type generates four subroutines:
.
	<type>Ome [marshall, callee]   appears in xxx_saux.c file
	<type>Oue [unmarshall, callee] appears in xxx_caux.c file
.
	<type>Omr [marshall, caller]   appears in xxx_caux.c file
	<type>Our [unmarshall, caller] appears in xxx_caux.c file
.
PROBLEM STATEMENT
.
  But in fact, the marshalling code in the 'Ome' routines is identical 
to that in the 'Omr' routines.  The unmarshalling code in the 'Oue' and
'Our' routines is also identical.
.
  Therefore, binaries like a DFS kernel or kernel extension, or a shared
libdce, that must link in both client and server stubs, are likely to be
linking in two copies of the marshalling/unmarshalling code.  For 
aggressive users of the [out_of_line] facility, this can add up to a
big penalty.
.
SUGGESTION
.
  The suggestion is to add a new switch to IDL, "-client stub_saux",
directing the IDL compiler to generate a client stub which calls the
marshalling and unmarshalling routines in the server aux file, and 
leave out the generation of a client aux file.  This change is backward
compatible with existing uses of the IDL compiler - clients who
do not supply the new switch will not observe any change.  Clients
who wish to take advantage can add the switch in their IDLFLAGS.
.
  I have prototyped this enhancement using a 1.0.1-based IDL compiler
with reasonable success.  The idl changes involve expanding the
command line parser to recognize a new switch, and a one line change
to change the name of the out_of_line [un]marshalling routines to
be the name found in the server aux file. 
.
  In the case of DFS, use of the '-client stub_saux' switch, combined
with tagging most of the non-trivial data-types with [out_of_line],
resulted in a 100KB savings in kernel code size, and smaller savings
for user space utilities.  I believe similar or better results could
be obtained in libdce.

[6/9/93 public]

The new idl code generator makes this OT moot.



CR Number                     : 5762
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : fts
Short Description             : should allow delete even if can't get tokens?
Reported Date                 : 10/22/92
Found in Baseline             : 1.0.2
Found Date                    : 10/22/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[10/22/92 public]
At the moment, when a fileset is marked ``inconsistent,'' you can't delete
it with ``fts delete'' since it will be unable to obtain a whole-fileset
token that will freeze out other users (data&status read&write).  You can
simply combine ``fts zap'' with ``fts delfldbentry'' to achieve a comparable
effect, but maybe it would be a fine idea to let ``fts delete'' work.
Possible methods would include letting the TKM grant the token in some
way, or letting ``fts delete'' ignore some class of failures in getting the
token.
There's a danger in allowing the TKM to grant the token anyway, in that it will
seek to revoke write-style tokens, and that will prompt CMs to store back
changes.  But CMs will be unable to do that, since the fileset is really
inconsistent.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[8/5/93 public]
I can no longer reproduce this problem
I believe that it was repaired, or worked around, in the fixes for OT 6180.
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 5722
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : px
Short Description             : scout (or fshost) doesn't update Ws field
Reported Date                 : 10/20/92
Found in Baseline             : 1.0.2
Found Date                    : 10/20/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[10/20/92 public]
The Ws field in the scout display is always 0.  This doesn't seem right...
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[10/4/93 public]
The original defect described above was fixed. That is, the scout does
display some valid number in Ws field. However, the real problem was
that Ws (the number of clients accessing this server) sometimes did not go
down if one client crashed and stoped accessing the server. 
This defect was actually coming from file server's fs host package.  The host
manager did not recycle the host data structure representing the down server 
even after a long period of time. The reason is that the reference count
with the host remains high all the time. Somehow, the host manager 
did not decrement the host in a rare race condition. This would cause
a small core leak in the server.                                           
Unfortunatelly, it is hard to reproduce the process to reproduce it is very
time consuming. I was only able to reproduce it twice and recently I could
not reproduce it anymore. 
I am cancelling it since the defect is not reproducible and insignificant. 
Changed Subcomponent Name from `scout' to `px' 
Changed Status from `open' to `cancel' 
Changed Responsible Engr. from `vijay@transarc.com' to `tu@transarc.com'



CR Number                     : 5684
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : 
Short Description             : sec_rgy_server_unavailable - sporadic error
Reported Date                 : 10/16/92
Found in Baseline             : 1.0.2
Found Date                    : 10/16/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
OB                            : 
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[10/16/92 public]
The following (apparent) security problem showed up when running the fts 
tests on a pmax.  It also happened a while back when running fts tests, 
and seems to be unpredictable. I'm appending text below, supplied 
by Vijay Anand.

The error is sec_rgy_server_unavailable. Below is a paste from the error 
buffer. As you can see from this, a fts crserver command fails with 
this error, but a subsequent command works fine. This error happened on 
one fts crserver command out of 200 in the test suite. It looks to me 
like request to secd is timing out because secd is busy doing something else. 

How do applications have to handle this error in general? 
What I'm aiming at is, when does this error occur,and how do 
applications take care of this. I'm not sure which routine caused this
error. The routine seems to have been called within ubik_ClientInit and 
could be a sec_id_parse_name or a rpc_binding_register_auth_info. 
The error is hard to reproduce.

-- following is a cut'n paste of the error that occurred --

+ fts crserverentry -server 255.255.255.33 -principal trouble.33 -quota 33 -owner abelian.33 
+ echo Passed 
Passed

+ fts crserverentry -server 255.255.255.34 -principal trouble.34 -quota 34 -owner abelian.34 
fldb_InitUbikHandle: ubik client init for /.../dceadmin.com/fs failed (Registry server unavailable (dce / sec)).
+ echo test13: Test case, E49: FAILED 
test13: Test case, E49: FAILED

+ fts crserverentry -server 255.255.255.35 -principal trouble.35 -quota 35 -owner abelian.35 
+ echo Passed 
Passed

Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[10/16/92 public]

[10/16/92 public]
Please reproduce this with the environment variable DEBUG_SEC set to 5

[10/20/92 public]
As noted in email correspondence between Pervaze, Julie and I, we cannot track
this problem down at this time and need help from any person that can.  Setting
DEBUG_SEC to at least 1 will hopefully tell us what the real internal error was
when the above failure occurs.  Without that information we can't even guess
what the problem might be.  If anybody at OSF can reproduce this (running the
fts tests), could you run them with DEBUG_SEC set (redirected to a log if
necessary) and run them until you get the failure?

[10/21/92 public]
I just spoke to Dave Treff and he said he can reproduce the problem
here. So I will work with him on this.

[1/26/93 public]
We still do not have enough information from the above to do much of anything
on this...  Dave, if you can still reproduce this, please do so after setting
DEBUG_SEC (env var) to 5 as stated above, and rerun the tests...  We need info
on this immediately to decide whether it will be fixed by the functionality
(and lower than B1 defects) freeze next Friday.

[2/26/93 public]
Can I assume that nobody's tests are blocked on this anymore, since nobody has
updated this defect (or complained about these test problems) since October?
Dave, can you reproduce this anymore?  If "yes", then please do so as I asked
above with DEBUG_SEC set to 5.  If "no", then we should assume that the problem
has been fixed and close this CR.  Please try this sometime early next week
after Bill's NSI improvement fixes and the big security drop with the binding
code fixes have been submitted.

[4/16/93 public]
OK, it's 6 months after this bug was opened and we still don't have any more
information on whether it's reproducible.  Back on October 21, Sekhar said
that Dave Treff could reproduce it, because on Oct 20th, we (Pervaze, Julie
and I) noted that we could not reproduce it.  This is only open because Dave
could.  Dave, please update this defect, cancelling it if it's not
reproducible, or if you think it is, then when you get a chance could you give
us the information I asked for above?  If this is still a problem, then it
is something that may affect 1.0.2a system testing.

[8/2/93 public]

4 months later, last call on this bug or it's cancelled.

[8/3/93 public]

After checking with Ron Arbo, cancelling this bug. Transarc can re-open
this bug if it can be duplicated with the latest security sources.



CR Number                     : 5659
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : rpc
Subcomponent Name             : uuidgen
Short Description             : Add an interface name command
line option to uuidgen.
Reported Date                 : 10/15/92
Found in Baseline             : 1.0.1
Found Date                    : 10/15/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[10/15/92 public]
Why not include the capability in the uuidgen command code to accept an
optional command line argument to plug into "INTERFACENAME" in the
resulting .idl file?

[07/20/93 public]
After consideration, OSF does not have the resources to make this enhancement. 

Canceled.



CR Number                     : 5631
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : 
Short Description             : set auth binding failed
Reported Date                 : 10/14/92
Found in Baseline             : 1.0.2
Found Date                    : 10/14/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[10/14/92 public]
Scenario: two machines, machine "A" is configured as both the primary DFS and
DCE server machine; machine "B" is a DCE client, and DFS server (no flserver,
fx only).

I've just completed the reboot of the primary machine.  On the secondary
machine, I do the following:

% dce_login
Enter Principal Name: mason
Enter Password:
% cd /:
% ls
dfs: set auth binding failed (code 12)
dfs: Warning: created unauthenticated binding
ls: 0653-345 .: Permission denied.
% ls
ls: 0653-345 .: Permission denied.
% ls
% exit
% icldump > ~/mason/debug-info/icldump/olorin-otxxxx-binding-failure-after-auth
% dce_login mason mason
% cd /:
% ls
dfs: set auth binding failed (code 12)
dfs: Warning: created unauthenticated binding
ls: 0653-345 .: Permission denied.
% icldump > ~/mason/debug-info/icldump/olorin-otxxxx-binding-failure-after-auth.2

I'll be renaming the icldump logs, but I need this OT number first; I'll note
the final name once I have the ot #.

Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[10/14/92 public]
Two notes:

(1) I realize this may not be a cm problem, but rather a security problem
(I've opened a defect report against sec_clientd because of restart-related
problems - that is OT 5603).  Unfortunately, it is manifesting itself via
DFS.

(2) the icldump logs are in /afs/transarc.com/usr/mason/debug-info/icldump:

ot5631-olorin-14oct92-binding-failure-after-auth.Z
ot5631-olorin-14oct92-binding-failure-after-auth.2.Z

Additional information:

I checked the accessability of the cell from machine "A" and all is well.

[12/15/92 public]

This is the same as 6467, actually.  What's happening is anyAccess is set
to 55, but the local user's rights are 0, so some access are spuriously working.
Changed Responsible Engr. from `kazar@transarc.com' to `bwl'

[12/18/92 public]

[12/31/92 public]

[1/7/93 public]

Hmm - I don't think this is the same as 6467 - I'm seeing this behavior
outside of lfs. This may be a combined security/dfs problem or just
a security one but I'll need help figuring that out I also don't know
if this is separate from 4398. Here's the scoop:

CONFIG: 2 pmax cell, 1 = dce server and dfs client, (dce12)
	1 = fl server, dce and dfs client (dce5)
BUILD: nightly build available 12/29 aka b10
REGISTRY: default values
TEST/ACTIVITY: dfs.lock as PRINC=gmd Unix user=gmd

I was debugging the script - no stress on the system. The script does
an rsh dcelogin -exec of a program that writes a file in a dfs directory
on each machine. The dce_login's on the dce server/dfs client pmax
produced these messages in the /usr/adm/messages file:

Jan  6 21:44:51 dce12 vmunix: dfs: set auth binding failed (code 336761023)
Jan  6 21:44:51 dce12 vmunix: dfs: Warning: created unauthenticated binding
Jan  6 21:44:55 dce12 vmunix: dfs: set auth binding failed (code 336761023)
Jan  6 21:44:55 dce12 vmunix: dfs: Warning: created unauthenticated binding
Jan  6 21:46:34 dce12 vmunix: dfs: set auth binding failed (code 336761023)
Jan  6 21:46:34 dce12 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 08:44:20 dce12 vmunix: dfs: set auth binding failed (code 336761023)
Jan  7 08:44:20 dce12 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 08:44:24 dce12 vmunix: dfs: set auth binding failed (code 336761023)
Jan  7 08:44:24 dce12 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 08:51:45 dce12 vmunix: dfs: set auth binding failed (code 336761023)
Jan  7 08:51:46 dce12 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 08:51:50 dce12 vmunix: dfs: set auth binding failed (code -1)
Jan  7 08:51:50 dce12 vmunix: dfs: Warning: created unauthenticated binding

Then, dce_login's started succeeding but THEN

Jan  7 09:45:32 dce12 vmunix: dfs: communication failure/set context
Jan  7 09:45:32 dce12 vmunix: dfs: lost contact with the fx server 130.105.202.2
5 in cell dce12_cell
Jan  7 09:49:26 dce12 vmunix: dfs:  fx server 130.105.202.25 in cell dce12_cell
back up!

I looked back and saw that there were 3 of these comm failure/set context
errors BEFORE these set auth binding errors SINCE the machine was rebooted
and the cell restarted (rc.dce, rc.dfs).

Back on the file server, things were not all rosey either:

Jan  6 18:13:25 dce5 vmunix: dfs: communication failure/set context
Jan  6 18:13:25 dce5 vmunix: dfs: lost contact with the fx server 130.105.202.25
 in cell dce12_cell
Jan  6 18:16:26 dce5 vmunix: dfs:  fx server 130.105.202.25 in cell dce12_cell b
ack up!
Jan  6 20:04:42 dce5 vmunix: dfs: set auth binding failed (code 382312712)
Jan  6 20:04:43 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  6 20:06:20 dce5 vmunix: dfs: auth helper not running
Jan  6 20:06:20 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 07:49:40 dce5 vmunix: dfs: ticket has expired!
Jan  7 07:49:41 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 07:49:51 dce5 vmunix: dfs: ticket has expired!
Jan  7 07:49:51 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 08:40:59 dce5 vmunix: dfs: set auth binding failed (code 387063931)
Jan  7 08:40:59 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 08:45:00 dce5 vmunix: dfs: ticket has expired!
Jan  7 08:45:02 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 11:45:10 dce5 vmunix: dfs: set auth binding failed (code 387063931)
Jan  7 11:45:10 dce5 vmunix: dfs: Warning: created unauthenticated binding
Jan  7 11:45:39 dce5 vmunix: dfs: set auth binding failed (code 387063931)
Jan  7 11:45:39 dce5 vmunix: dfs: Warning: created unauthenticated binding

The "auth helper" message was real - this problem has been logged separately
in 4398. The cell was completely idle at 11:45.

[ gmd 1/18/93 ]

No ideas from the dfs people so giving the security side a try. The
error codes are:

root@water(102) ./stcode 336761023
336761023 (decimal), 141290bf (hex): No credentials cache file found (dce / krb)
root@water(103) ./stcode 382312712
382312712 (decimal), 16c9a108 (hex): helper process aborted (dce / rpc)
root@water(104) ./stcode 387063931
387063931 (decimal), 1712207b (hex): Registry server unavailable (dce / sec)

I suspect there is/was more than one bug here. I've changed the short
description and assigned this to Sekhar. I'll gladly open a separate
defect or start updating new/existing defects. Debug ideas welcome.

Thanks -

[1/26/93 public]
I'm lost in the above confusion...  I've listed those from Transarc that have
commented above, in the CC list, to make sure they still get copies of this
now that it's a 'sec' defect.

ONE of the above problems seems to be equivalent to CR6917, which I just
submitted a fix for (dfsbind losing its credentials).  The only other
scenario I see above that you are saying is causing a problem is that a DFS
client machine starts having problems after the server machine that's running
secd is rebooted.  Is this what I should be looking into? or are there other
things that you're doing, buried in the above information?

[1/26/93 public]
Mike - Yes, I think 6917 might be related - Hopefully, there'll be a good
build tonight so I can try it out. I'm not doing anything "tricky" so
no, there is nothing buried in the above information - just trying to hit
the 48 CHO mark - I reboot in an attempt to achieve a clean known state
for starting tests.

[2/1/93 public]
Well, it's not gone - but things seemed to be better with the fix for
6917. Here's what's happening:

BUILD: 	nb available 1/29/93 (contaings 6917 fix AND dfs 2.4)
CONFIG:
	singsing_cell:
	R - singsing	sec,cds,fl servers, dfs client
	R - cobbler		fl server, sec,cds,dfs client
	P - dce12		fl server, sec,cds,dfs client
	P - water		sec,cds,dfs client	

	root.dfs in jfs

DETAILS:
	- Singsing crashed within 45 minutes of starting dfs.glue
	(Unfortunately, I did not sysdumpdev and the power
	surge/outage has now caused the most recent crash)

	- After rebooting and restarting Singsing, but not the
	test (ie. the cell was healthy and idle), I got a
	sec_clientd error on water "Host principal key management
	failure ... Registry server unavailable"

	- Restarting the test (with less stress ie. fewer
	processes, fewer writes per file, etc.), there are
	some successful remote dfs reads and writes but the
	following errors occur:

	water fails on some but not all attempts to get auth
	bindings - helper process goes catatonic - I have an
	icl.bind - I killed and restarted dfsbind.

	at the same time water is having problems, dce12
	(who is NOT involved in the test - merely an idle
	fl server machine) reports the same "Host principal
	key management failure ... Registry server unavailable"

	cobbler gets a "Connection timed out" error on an
	attempt to close a file it has just written. I also
	noticed that one of the files that were successfully
	written by cobbler was owned by nobody - even though
	the access should definitely been authenticated AND
	the authentication was set for 4 days.

The important stuff (I think) for you to note is:
	* these single un-provoked management key failures.
	* inability to authenticate
	* lost authentication more than 3 days early

[2/8/93 public]
Gail, I finally had a chance to look at this again...  I can't reproduce the
underlying problem you seem to have seen (stop/restart secd and sec_clientd
can't find it).  Can you try this again with a current build, if you have
time?

[2/19/93 public]
Unfortunately, other bugs have prevented proving whether this one has been
solved or not. I'm lowering the priority since it is not currently blocking
system test. I will gladly close it when my tests run successfully.

[6/22/93 public]
There were a number of dfs-specific issues with authentication which
were solved and which may have solved this one as well - canceling.
The tests are not uncovering this behavior any longer.



CR Number                     : 5630
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : panic: doing a dfsexport -all -detach
Reported Date                 : 10/14/92
Found in Baseline             : 1.0.2
Found Date                    : 10/14/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[10/14/92 public]
As I was trying to shut down my pmax secondary file server, I
successfully dce.clean'd all, and then I tried running dfsexport -all
-detach.  I got an error message:
dfsexport: Failed to detach /dev/epi0: luthien.epi0 (Device busy)
^C'd the dfsexport, tried again, got the same message, and then got
the kernel panic:
    $k
    thread 0x0c15121a4,  pcb 0x80496b10, W_EVENT 0
    <Exception frame> Cause= 0x30000008 Badvaddr= 0x0 SR= 0x0ff14
    epif_Open() from vnm_VInit+34
    vnm_VInit() from vnm_FindVnode+7b0
    vnm_FindVnode() from VFtoEV+154
    VFtoEV() from vol_efsVget+28
    vol_efsVget() from volreg_LookupExtended+770
    volreg_LookupExtended() from SAFS_StoreStatus+248
    SAFS_StoreStatus() from op7_ssr+508
    op7_ssr() from rpc__dg_execute_call+175c
    rpc__dg_execute_call() from cthread_call_executor+3ac
    cthread_call_executor() from base_routine+104
    base_routine() from find_thread_args+0b0
    $l
    task 0x0c1329d 0x0c1339eac  R    pri = 31, 0u 1674s 0c
    thread 0x0c1338fd4   W N vm_page_free_wanted
    thread 0x0c1338e58   W N reaper_queue
    thread 0x0c1338cdc   W N swapin_queue
    thread 0x0c1338b60   W N thread_swap_tick
    thread 0x0c13389e4   W N 0
    thread 0x0c1338868   W N psig_queue
    thread 0x0c13386ec   W N acctwatch
    thread 0x0c1337b0c   W N nfs_timer
    thread 0x0c1396bb4   W N 0c1354c60
    thread 0x0c13968bc   W N 0c1354c40
    thread 0x0c13965c4   W   8047b5d0
    thread 0x0c13962cc   W N delay_tbl+4
    thread 0x0c1512d84  R    pri = 6, 0u 811s 0c
    thread 0x0c1512c08   W N 0c14e820c
    thread 0x0c1512a8c   W N 0c14e8234
    thread 0x0c1512910   W N 0c14e825c
    thread 0x0c1512794   W N 0c14e8284
    thread 0x0c1512618   W N 0c14e82ac
    thread 0x0c151249c   W N 0c14e82d4
    thread 0x0c1512320   W N 0c14e82fc
    thread 0x0c15121a4  R    pri = 6, 0u 722s 0c
    thread 0x0c1512028   W N 0c14e33b4
    thread 0x0c1511eac   W   8047b5d0
    thread 0x0c15112cc   W N 0c150684c
    thread 0x0c1554910   W N 0c1354860
    thread 0x0c1554794   W   8047b5d0
    thread 0x0c1554618   W N 0c1354800
    thread 0x0c155449c   W N 0c13547e0
    thread 0x0c1554320   W N 0c13547c0
    thread 0x0c15541a4   W   8047b5d0
    thread 0x0c1511448   W N 0c1354700
    thread 0x0c1575618   W N 0c1354600
    thread 0x0c1575794   W N 0c15c94c0
    task 0x0c1329b60 [init                ] proc 80647768 pid 1 map 0x0c003c900: thread 0x0c1339d30   W   U_ADDRESS pause
    task 0x0c1329a54 [vnode_pager         ] proc 80647850 pid 2 map 0x0c003c7e0: 6 threads:
    thread 0x0c1339bb4   W   0
    thread 0x0c1339740   W   0
    thread 0x0c13395c4   W   0
    thread 0x0c1339448   W   0
    thread 0x0c13392cc   W   0
    thread 0x0c1339150   W N swbuf pgout_done
    task 0x0c1329948 [device pager        ] proc 80647938 pid 3 map 0x0c003c6c0: thread 0x0c1339a38   W   0
    task 0x0c132983c [exception hdlr      ] proc 80647a20 pid 4 map 0x0c003c630: thread 0x0c13398bc   W  (swapped) 0
    task 0x0c1329730 [mach_init           ] proc 80647b08 pid 5 map 0x0c003c5a0: thread 0x0c133ad84   W  (swapped) 0
    task 0x0c1329518 [kloadsrv            ] proc 80647cd8 pid 15 map 0x0c003c480: thread 0x0c13383f4   W  (swapped) 0c1358e40 network
    task 0x0c1329624 [update              ] proc 80647bf0 pid 16 map 0x0c003c510: thread 0x0c1338570   W   U_ADDRESS pause
    task 0x0c13290e8 [syslogd             ] proc 80648078 pid 55 map 0x0c003c1b0: thread 0x0c1337e04   W   0c1337ea4 event
    task 0x0c1328fdc [named               ] proc 80648160 pid 59 map 0x0c003c120: thread 0x0c1337c88   W  (swapped) 0c137ad40 network
    task 0x0c1328ed0 [portmap             ] proc 80648248 pid 81 map 0x0c003c000: thread 0x0c1337990   W  (swapped) 0c1337a30 event
    task 0x0c1328dc4 [mountd              ] proc 80648330 pid 83 map 0x0c1385f30: thread 0x0c1337814   W  (swapped) 0c13378b4 event
    task 0x0c1328cb8 [nfsd                ] proc 80648418 pid 85 map 0x0c1385e10: thread 0x0c1337698   W   0c1369640 network
    task 0x0c1328bac [nfsd                ] proc 80648500 pid 87 map 0x0c1385cf0: thread 0x0c133751c   W   0c1369640 network
    task 0x0c1328aa0 [nfsd                ] proc 806485e8 pid 88 map 0x0c1385c60: thread 0x0c13373a0   W   0c1369640 network
task 0x0c1328994 [nfsd                ] proc 806486d0 pid 89 map 0x0c1385bd0: thread 0x0c1337224   W   0c1369640 network
    task 0x0c1328888 [nfsiod              ] proc 806487b8 pid 90 map 0x0c1385b40: thread 0x0c13370a8   W   asyncdaemon_requests
    task 0x0c1329300 [nfsiod              ] proc 806488a0 pid 91 map 0x0c003c240: thread 0x0c13380fc   W   asyncdaemon_requests
    task 0x0c132877c [nfsiod              ] proc 80648988 pid 92 map 0x0c1385a20: thread 0x0c1397d84   W   asyncdaemon_requests
    task 0x0c1328670 [nfsiod              ] proc 80647ea8 pid 93 map 0x0c1385990: thread 0x0c1397c08   W   asyncdaemon_requests
    task 0x0c1328458 [ntpd                ] proc 80648b58 pid 97 map 0x0c1385870: thread 0x0c1397910   W   0c13979b0 event
    task 0x0c132834c [inetd               ] proc 80648c40 pid 103 map 0x0c13857e0: thread 0x0c1397794   W  (swapped) 0c1397834 event
    task 0x0c1328240 [cron                ] proc 80648d28 pid 108 map 0x0c13856c0: thread 0x0c1397618   W   0c13a3f40 network
    task 0x0c1328134 [lpd                 ] proc 80648a70 pid 120 map 0x0c13855a0: thread 0x0c139749c   W  (swapped) 0c139753c event
    task 0x0c132940c [getty               ] proc 80647dc0 pid 124 map 0x0c003c2d0: thread 0x0c1338278   W  (swapped) cons ttyin
    task 0x0c1328028 [getty               ] proc 80648ef8 pid 125 map 0x0c1385480: thread 0x0c1397320   W  (swapped) cons+140 ttyin
    task 0x0c13291f4 [telnetd             ] proc 80647f90 pid 126 map 0x0c003c360: thread 0x0c1337f80   W   0c1338020 event
    task 0x0c1328564 [csh                 ] proc 80648e10 pid 127 map 0x0c1385900: thread 0x0c1397a8c   W   U_ADDRESS pause
    task 0x0c13a9a54 [dfsbind             ] proc 80649550 pid 183 map 0x0c13851b0: thread 0x0c1396448   W  (swapped) 8047d7ec intr_wait
    task 0x0c13a983c [fxd                 ] proc 806491b0 pid 186 map 0x0c13acc60: thread 0x0c1396150   W N shutdown_cond
    task 0x0c13a9624 [fxd                 ] proc 80649720 pid 187 map 0x0c13aca20: thread 0x0c1511d30   W   8047b5d0
    task 0x0c13a9518 [bosserver           ] proc 80649808 pid 190 map 0x0c13ac990: thread 0x0c1511bb4  R    pri = 15, 334786u 6018s 441598c
    task 0x0c13a940c [bosserver           ] proc 80649ba8 pid 198 map 0x0c13ac870: thread 0x0c1511a38   W   0c1511ad8 event
    task 0x0c154ec6c [dfsd                ] proc 8064a118 pid 209 map 0x0c13ac480: thread 0x0c1511150   W N cm_shuttingDown
    task 0x0c154ed78 [dfsd                ] proc 8064a200 pid 210 map 0x0c13ac360: thread 0x0c1554d84   W N cm_bkgDaemons
    task 0x0c154eb60 [dfsd                ] proc 8064a2e8 pid 211 map 0x0c13ac2d0: thread 0x0c1554c08   W N cm_bkgDaemons
    task 0x0c13a9d78 [dfsexport           ] proc 80649f48 pid 2980 map 0x0c13acf30:
    thread 0x0c1397028  R    pri = 23, 0u 9s 874248c
    task 0x0c13a90e8 [who                 ] proc 80649c90 pid 2981 map 0x0c13ac7e0:
    thread 0x0c15115c4  R  N pri = 12, 0u 0s 0c
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mcinerny@transarc.com' 
Added field Transarc Status with value `open'

[10/14/92 public]
Changed Subcomponent Name from `episode' to `lfs'

[7/21/93 public]
No longer reproduciable. 
I believe this defect has been fixed, along with OT#7762 and OT#7158, 
by Jeff's recent (April/May) work in dfsexport area.
Mark it cancelled.
Changed Status from `open' to `cancel' 
Changed Transarc Herder from `mcinerny@transarc.com' to `jaffe@transarc.com'



CR Number                     : 5604
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : CM gives EACCES incorrectly.
Reported Date                 : 10/9/92
Found in Baseline             : 1.0.2
Found Date                    : 10/9/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[10/9/92 public]
Scenario: two machine cell; machine "A" is the primary DCE & DFS server,
machine "B" is a DCE client and secondary DFS server (no flserver).  The
primary crashed (for an unrelated reason, I've not yet opened up that OT).
The reboot of the primary DCE server required that I restart the security
daemon on the secondary (DCE client).
An attempt to look at a particular directory returned EPERM:
% pwd
pwd: The file access permissions do not allow the specified action.
% cd ..
% ls
bar  bin  dfs
% pwd
/.../mandos.dce.transarc.com/fs/usr/mason
I have full rights on the directory:
% acl_edit dfs
sec_acl_edit> l
# SEC_ACL for dfs:
# Default cell = /.../mandos.dce.transarc.com
user_obj:rwxc--
group_obj:rwx---
other_obj:rwx---
sec_acl_edit> ^D
Interestingly, though, this operation and/or "cm flush" did the trick:
% cm flush
% cd dfs
% ls
export    link      obj       rc_files  src       tools
%
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[10/12/92 public]
The icldump is in:
/afs/transarc.com/usr/mason/debug-info/icldump/ot5604-olorin-09oct92-eperm.Z

[10/14/92 public]
Changed Interest List CC from 
 `kazar,bb+transarc.afs.dce.self-host@transarc.com' to 
 `kazar,bb+transarc.afs.dce.self-host@transarc.com,demail1!carl'

[3/11/93 public]
All this time I thought the problem was an errno of 1 (EPERM), which would be
quite weird.  Instead, it's just a vanilla EACCES problem that needs to be
re-tested on more recent software.
Changed Short Description from `CM gives EPERM incorrectly.' to `CM gives 
 EACCES incorrectly.'

[9/14/93 public]
I have tried several times before and could not reproduce it any more. 
I suspect this could be fixed as part of acl_edit work. 
Cancel it.
Changed Status from `open' to `cancel'



CR Number                     : 5449
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cdsd
Short Description             : cdsd aborts on restart
Reported Date                 : 9/23/92
Found in Baseline             : 1.0.1
Found Date                    : 9/23/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/23/92 public]
This problem can occur on any restart.  Currently, we are running with
compression=0 because of problems we've seen when compression was on.
This stack is:

abort process in raise at 0xd000693c
0xd000693c (raise+0x24) 80410014          l   r2,0x14(r1)
(dbx) where
raise(0x0) at 0xd000693c
abort.abort(0x0) at 0xd012ad14
node_check(0x0) at 0x10033bbc
insert_record(0x0, 0xdeadbeef, 0xdeadbeef, 0xdeadbeef) at 0x100347e0
build_index(0x0) at 0x10036a84
db_btree_build(0x0, 0xdeadbeef, 0xdeadbeef, 0xdeadbeef) at 0x10036e1c
db_checkpoint_load(0x0) at 0x1003d278
db_setup(0x0) at 0x1001f7dc
dns_enable(0x0, 0xdeadbeef) at 0x1006a014
server_auto(0x0) at 0x10000830
server_watchdog(0x0) at 0x10000b48
main(0x0, 0xdeadbeef) at 0x10000438

[9/23/92 public]
A potential fix (workaround? kludge?) to this problem would be to take a
snapshot of the bucket at the beginning of insert_record() after determining
len and passing node_check() the first time, then attempt the insert,
then if the final node_check() fails revert to the snapshot.  This would
involve a version of node_check() that returned a bad code instead of
abort()ing.  Is this worth pursuing?  Clearinghouse files which cause the
failure are available on request.

[12/8/92 public]
Changed severity and priority as per OSF reclassification.

[9/17/93 public]
This problem is not happening in 1.0.3 code base. David Skeen of IBM
believes it got fixed by DEC in 1.0.2 work. Cancel it by now.



CR Number                     : 5442
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : non-authenticated access to DFS/LFS not valid.
Reported Date                 : 9/23/92
Found in Baseline             : 1.0.2
Found Date                    : 9/23/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[9/23/92 public]
Initial access for non authenticated users seems to be broken.

Bring up a new DFS cell with episode as root.dfs.
Without running dce_login, cd to /: and type ls.
My log is :

	...
        It is recommended that the password for the cell_admin user
        be changed after all configuration for this machine is complete.
# cd /:
# ls
ls: 0653-345 .: Permission denied.
# pwd
pwd: The file access permissions do not allow the specified action.
# cd /
# dce_login cell_admin -dce-
Password must be changed!
# cd /:
# ls
# pwd
/.../mandos.dce.transarc.com/fs

Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[9/23/92 public]
Changed H/W Ref Platform from `all' to `rs6000' 
Changed S/W Ref Platform from `all' to `aix'

[9/28/92 public]
Reassigned to Bruce.

Changed Responsible Engr. from `mason@transarc.com' to `bwl@transarc.com'

[9/29/92 public]
(quoting bwl)

The reason that /: is not accessible to an un-authenticated user is
that, by default, access to the root directory created by fts crft is
limited to authenticated users.  (As a matter of fact, the directory
is created without an ACL.  Access to a file or directory without an
ACL is as if it had an ACL whose USER_OBJ, GROUP_OBJ, and OTHER_OBJ
entries were derived from the file's or directory's mode, and which
did not have any other entries, such as UNAUTH_MASK.)

The right way to fix this is that, immediately after the fts crft, the
fileset should be mounted (fts crmount, etc.), and the ACL of the root
directory should be modified as desired (acl_edit).

The reason this didn't show up until recently was because I recently
fixed an Episode bug in checking access to files/directories without
ACL's.

(me again)

I've reassigned this to Ron Arbo.  Since this is correct operation,
albeit somewhat non-intuitive, it is an enhancement request, not a
bug.

If y'all at OSF don't think this is reasonable, cancel it.

This problem should be observable on OSF/1, also.

Changed Defect or Enhancement? from `def' to `enh' 
Changed Component Name from `dfs' to `dce' 
Changed Subcomponent Name from `lfs' to `dce_config' 
Changed Responsible Engr. from `bwl@transarc.com' to `rsarbo' 
Changed Resp. Engr's Company from `tarc' to `osf'



CR Number                     : 5359
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : rgy_edit
Short Description             : \ not escaping chars correctly in rgy_edit
Reported Date                 : 9/9/92
Found in Baseline             : 1.0.1
Found Date                    : 9/9/92
Severity                      : D
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : security/client/admin/rgy_edit/tty_io.c and security/utils/args.c
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[9/9/92 public]
ORBIT defect #1607.

The Admin Guide, Security Module states in the "Name Format" section
that names in the registry may consist of any letter, digit or
non[sic]-alphanumeric except for the @ sign.

However, a double-quote cannot appear in a name unless it is escaped by
a backslash.  If you do escape the ", then BOTH characters appear in the
name. (Eg, try adding the principal \").

Neither \ nor " are treated as regular characters by rgy_edit as the
documentation implies.  The " has some string-delimiting function (is 
this functionality useful in rgy_edit??) and the \ acts like a hybrid
between a regular character and an escape character.

[10/15/92 public]
Assigned it to myself.  Lowered Severity to D (Significant, but an acceptable
workaround exists) as opposed to B (Critical with no workaround).
You can get " in a principal name, but not specifying it on the command line
(let it prompt you, and it works).
The " string delimiting is functionally useful in rgy_edit.  You may have
arguments to commands that have multiple tokens, with spaces (for example
rgy_edit=> add foobar -f "Foo J. Bar"
where you don't want the "'s as part of the fullname, but you must use them
in the argument, so the command utility will know it's one token.
So, it seems that the problem is with the \ not delimiting correctly.

[10/15/92 public]

OT cleanup 1 : Severity : unchanged (D) ;   Priority : unchanged (3);

NB. In view of the (reeasonable) workaround, severity of D and Priority of 3 is 
     indeed appropriate.

[10/23/92 public]
Made the description more clear about what the problem is.

[8/2/93 public]

Responsible -> mob

[10/13/93 public]
fix available.  will submit when request is acknowledged.

[10/15/93 public]
Fix has been submitted.  Files ../src/security/client/admin/rgy_edit/tty_io.c
and ../src/security/utils/args.c

[or smithtl 8/28/95 public]
Need fix.  This was to be fixed in 1.1 but fix was backed out.
Submitted in 1992. See defects 9239 and 9149.

Please provide current status since this has not been updated
since 10/15/93.



CR Number                     : 5340
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : runtime
Short Description             : pkt_alloc asserts due to
rpc_g_dg_pkt_pool.free_count=0
Reported Date                 : 9/4/92
Found in Baseline             : 1.0.1b25
Found Date                    : 9/4/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[9/4/92 public]

Using the dramatic tests with a three system configuration.  We found
that pkt_alloc asserts due to rpc_g_dg_pkt_pool.free_count=0.

This problem cannot currently be reproduced but should be investigated
using the stack trace and looking at the runtime time code.

is_sort() is simply an intermediate server routine that sorts data by calling
ussort().

The idl definition for ussort:
extern void ussort(
#ifdef IDL_PROTOTYPES
    /* [in] */ handle_t h,
    /* [in] */ uuid_t *cuuid,
    /* [in, out] */ idl_long_int data[][80],
    /* [in] */ idl_ulong_int size,
    /* [out] */ error_status_t *status
#endif

The acf entry for ussort:

interface isus1
{
	[enable_allocate] ussort([comm_status, fault_status] status);
}

The call to ussort from is_sort() in dtis1_manager.c:
void    is_sort(
        handle_t bh,
        uuid_t *cuuid,
        idl_ulong_int nth,
        idl_char *unres_name,
        IS_SortType stype,
        idl_long_int data[][IS_LINE_LENGTH],
        idl_ulong_int size,
        error_status_t *stp
)
{
        rpc_binding_handle_t    us_bh;
        uuid_t  objuuid;
        int     allowed;
        int     check_stack;
        NestedRpcThreadData     *nrtd;
        error_status_t  st;

        SS_ALLOC_TEST;

        nrtd = callcallback(bh, cuuid, nth);

        allowed = chkacl(
                logfp,
                bh,
                cuuid,
                princ_full_name,
                si->protect_level,
                si->authn_svc,
                si->authz_svc,
                op_name[3],
                stp
        );
        if (*stp != rpc_s_ok) {
                if (trace_rpc)
                        LOGhead(logfp, cuuid, "exiting is_sort(1)");
                waitcallback(cuuid, nrtd);
                return;
        }
        if (!allowed) {
                LOGshot(logfp, cuuid, "Error",
                        "Not allowed to execute is_sort");
                *stp = sec_acl_not_authorized;
                if (trace_rpc)
                        LOGhead(logfp, cuuid, "exiting is_sort(2)");
                waitcallback(cuuid, nrtd);
                return;
        }

        check_stack = chkmgrcount(logfp, cuuid);

        getobjuuid(cuuid, stype, &objuuid);

        setupbinding(bh, cuuid, nth, unres_name, &objuuid, &us_bh, stp);
        if (*stp != rpc_s_ok) {
                if (trace_rpc)
                        LOGhead(logfp, cuuid, "exiting is_sort(3)");
                waitcallback(cuuid, nrtd);
                return;
        }

        if (trace_rpc)
                LOGhead(logfp, cuuid, "calling ussort");
        else
                showentryname(us_bh, cuuid, "is_sort");
        ussort(us_bh, cuuid, data, size, stp);
        if (trace_rpc)
                LOGhead(logfp, cuuid, "returning from ussort");
        if (*stp != rpc_s_ok)
                LOGstat(logfp, cuuid, "ussort", *stp);

        rpc_binding_free(&us_bh, &st);
        if (st != rpc_s_ok)
                LOGstat(logfp, cuuid, "rpc_binding_free", st);

        waitcallback(cuuid, nrtd);
        have_a_rest(logfp, cuuid, si->pacing);
        if (trace_rpc)
                LOGhead(logfp, cuuid, "exiting is_sort(0)");
}

[10/16/92 public]
Changed code enginer to Mishkin.

[1/7/92 public]

This bug does not seem to be reproducible.  Can we get it cancelled?

[1/7/93 public]

For William Sullivan in our PVT group:

 We can probably reproduce this defect by using the dramatic test in
 a high stress environment ( ie 10 clients, 10 threads/client ) with
 short ( i.e. 5 minute ) call timeouts.  This problem was reproducible
 in the testing but it got marked defer because we could avoid it
 easily and otherwise it was not reproducible.  I am fairly certain 
 it is related to rpc call cancellation.

I do not think this should be cancelled.  We (IBM) will get back to it
as soon as we are able.

[8/29/94 public]
This defect is so stale I do not believe any information will be lost
by canceling it.  IBM has (apparently) never gotten back it (1 1/2 years)
and no one outside of them has seen it (*ever* as far as I can tell).

Canceled.



CR Number                     : 5257
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : Need better salvager tests
Reported Date                 : 8/31/92
Found in Baseline             : 1.0.2
Found Date                    : 8/31/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[8/31/92 public]
We need better test facilities for the salvager, as described in
Rajesh's Recovery/Salvager testing proposal.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[8/31/92 public]
This is an enhancement, not a defect.
Changed Defect or Enhancement? from `def' to `enh'

[11/11/93 public]
This defect is overly broad.
Changed Status from `open' to `cancel'



CR Number                     : 5234
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 2515
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : cds/control/dnscp_creobj.c & cds.txt
Short Description             : Cannot use cdscp to create an
object with CDS_ObjectUUID
Reported Date                 : 8/27/92
Found in Baseline             : 1.0.1
Found Date                    : 8/27/92
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/27/92 public]

        An Administrator cannot modify the CDS_ObjectUUID once the
        object is created because the CDS_ObjectUUID is unmodifiable
        (This is a bug fix for OT2515.) Therefore in order to have
        a CDS_ObjectUUID, we must supply this value during creation
        time. The CDSPI cdsCreateObj allows an option UUID parameter
        but the CDS Control Program always called the API with an
        NULL UUID parameter.
Repeat By:

        Create an obj with CDSCP, then try to change the CDS_ObjectUUID
        attribute using CDSP. Another case is try to create an obj
        with a CDS_ObjectUUID.

cdscp> create obj /.:/foo
cdscp> set obj /.:/foo CDS_ObjectUUID = 12345678-1234-1234-1234-123456789012
(This gave an error message saying attribute is unmodifiable)

cdscp> create obj /.:/foo CDS_ObjectUUID 12345678-1234-1234-1234-123456789012
(syntax error             x )


Note, if you create an obj with cdscp create obj /.:/foo, it does not have
a value for CDS_ObjectUUID. I can understand why we don't want people to
modify the uuid, for obvious reason. But in that case, shouldn't it always
create one uuid for the new obj?

The proposed solution from IBM:

        Change the code in dnscp_creobj to have the cdsCreateObj api
        called with an Non-Null UUID if supplied by the user. Also
        the cds.txt (parser text file) would have to be update to
        avoid the syntax checking of the control program.

[10/27/92 public]

Changed to defect.

[07/07/93 public]
According to the AES draft CDS_objectUID is read/write/delete therfore
the current behavior is definitely broken. It will not become an
enhancement request and should be fixed in 1.0.3.

[9/8/93 public]
Based on the AES/Distributed Computing - Directory Services, and a discussion 
with Norbert and John, the CDS_ObjectUUID is one time writable during the 
creation time and the purpose of this attribute is to identify the object. 
The use of cdscp should not be allowed to supply a uuid because the supply
can not be guaranteed to be unique. So the behavior of cdscp is correct.
Cancel this bug.



CR Number                     : 5211
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dskl
Subcomponent Name             : 
Short Description             : improper usage of inet_ntoa
Reported Date                 : 8/26/92
Found in Baseline             : 1.0.1
Found Date                    : 8/26/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[8/26/92 public]
 
The following two files contain some improper usages of inet_ntoa().
Instead of passing data of type struct in_addr to this call they sometimes
pass the s_addr field of struct in_addr. This is a problem on some machines.
 
1.  diskless/boot/bootpd/bootpd.c
2.  diskless/client/print.c
 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[5/25/94 public]
The diskless source has been defuncted from the tree.
OSF no longer supports diskless.
Canceled.



CR Number                     : 5198
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : scavenger errors require investigation and repair
Reported Date                 : 8/25/92
Found in Baseline             : 1.0.2
Found Date                    : 8/25/92
Severity                      : C
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[8/25/92 public]
The scavenger tests need to be re-run and the failure conditions analyzed and
repaired.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[10/27/92 public]
Reassigned to Blake.
Changed Interest List CC from `jdp@transarc.com' to `jdp,ota' 
Changed Responsible Engr. from `ota@transarc.com' to `blake@transarc.com'

[7/21/93 public]
After talking to Blake and realized that this test program is no longer
useful. There are some other test programs that also cover this area. 
So cancelled. 
Changed Status from `open' to `cancel'



CR Number                     : 5181
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : Connection-Oriented RPC Protocol
Short Description             : Server hangs and sends dummy
packets forever.
Reported Date                 : 8/24/92
Found in Baseline             : 1.0.1b23
Found Date                    : 8/21/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/24/92 public]

As part of the DCE validation test suite we are testing the Connection-based
RPC protocol and we need explanation on the following test scenario.

We are testing the CN RPC Server run-time in the following manner.
The validation software acting as a DCE Client sends a BIND PDU to the 
CN RPC Server runtime with:
		max_xmit_frag = 0;
		max_recv_frag = 0;

The value '0' implies (according to the NCA Run-time Extensions Spec) the
default value; i.e.MustRecvFragSize = 1432.

The DCE Server run-time in turn sends a BIND_ACK PDU with:
		max_xmit_frag = 1432;
		max_recv_frag = 0;

A Request PDU is then sent to the Server run-time to perform a remote 
procedure call. The Server run-time in turn sends a correct Response to the
validation software. But, after the last fragment of the Response is sent
by the Server, it starts behaving differently. The Server starts sending
unknown packets to the validation client software forever; i.e with the
value '0' in every field except call_id and p_cntx_id which are same
as were for the original request.

It appears that the DCE Server run-time is hung in the loop sending the
unknown packets forever assuming that it is still continuing with the
response fragments for the request. Another BIND request is also ignored by
the Server run-time when it is hung in this state.

[9/9/92 public]

We are having difficulty reproducing this.  We are able to reproduce
the bind/bind_ack behavior, but we don't see the looping that comes
after.

Can you please rerun the experiment with the following values:

1) Have the client send
   max_xmit_frag = 4096
   max_recv_frag = 0

2) Have the client send
   max_xmit_frag = 0
   max_recv_frag = 4096

And see if either of these cases exhibit the same behavior.

Also, can you send me the IDL file that you used and, if it's variable,
the datasize you specified?

[9/23/92 public]

As per our conversation, we have tested the two scenerios described
below and have found the following results.

1) Client sends:
   max_xmit_frag = 4096
   max_recv_frag = 0

The same behavior by the dce server run-time has been exhibited as before; 
i.e. server appears to be hung.

2) Client sends:
   max_xmit_frag = 0
   max_recv_frag = 4096

This scenerio works ok.

Also, the datasize in the IDL file is not variable.

[10/16/92 public]
Changed A1 -> B2

[10/16/92 public]
Changed code engineer to Wei Hu @ DEC.

[1/7/93 public]
Promoted to enhancement.

[07/20/93 public]
Bill Sommerfeld makes a convincing argument that this should be a defect
because you can write a denial of service attack if you can get
servers to hang.

[9/16/93 public]
We found this problem through RPC validation software, when we filed
this bug.

I tried to reproduce the problem using the RPC validation software, 
with the recent nightly builds, both on HP and 486, with no luck.



CR Number                     : 5126
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cds
Subcomponent Name             : 
Short Description             : server bugcheck
Reported Date                 : 8/19/92
Found in Baseline             : 1.0.1
Found Date                    : 8/19/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/19/92 public]


I had a rios which was a server for core components and dfs and I did a dce.clean and
then a rc.dce and I got a bug check message from cds. I can't say that I know how to
reproduce this.

root@singsing> sh /etc/rc.dce
Starting DCE daemons:
        /opt/dcelocal/bin/rpcd
        /opt/dcelocal/bin/secd
        /opt/dcelocal/bin/sec_clientd
SECD Incomplete NSI registration; task sleeping for 60 seconds
        /opt/dcelocal/bin/cdsadv
        /opt/dcelocal/bin/cdsd
************* BUGCHECK *************
A module in the server has bugchecked
Bugcheck code is ... -902
Thread id .......... 20103490
Thread errno ....... 0
UNIX errno ......... 22
Bug ref# ........... 974
Module id........... ../../../../../src/directory/cds/server/db_compression.c
************* BUGCHECK *************
At 363, writing up to last 500 allocations to ./vm_data
At 363, writing all current allocations to ./vm_data
        /opt/dcelocal/bin/gdad

[08/19/92 public]

Here's the vm_data file contents:




At 363, DECdns Server Database up to last 500 allocations.

     1 Alloc    92 Unkn at  1046, ../../../../../src/directory/cds/library/threads_lib.c
     2 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
     3 Alloc   317 Unkn at   849, ../../../../../src/directory/cds/library/dnscfg.c
     4 Alloc   111 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     5 Alloc   104 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     6 Alloc    81 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     7 Alloc    85 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     8 Alloc    83 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     9 Alloc   272 Unkn at   914, ../../../../../src/directory/cds/library/dnscfg.c
    10 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
    11 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    12 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    13 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    14 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    15 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    16 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    17 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    18 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    19 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    20 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
     21 Alloc    24 Unkn at  1321, ../../../../../src/directory/cds/server/unix_net.c;     31 Freed
    22 Alloc   452 Unkn at  1340, ../../../../../src/directory/cds/server/unix_net.c
     23 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     24 Freed
     25 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     26 Freed
     27 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     28 Freed
     29 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     30 Freed
    32 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    33 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    34 Alloc    36 Unkn at   926, ../../../../../src/directory/cds/server/ta_adver.c
    35 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    36 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    37 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    38 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    39 Alloc  1780 Unkn at  1768, ../../../../../src/directory/cds/server/dns_service_ncl.c
    40 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    41 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    42 Alloc  2828 Perm at  1037, ../../../../../src/directory/cds/server/db_common.c
    43 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    44 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    45 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    46 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    47 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    48 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    49 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    50 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    51 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    52 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    53 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    54 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    55 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    56 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    57 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    58 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    59 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    60 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    61 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    62 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    63 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    64 Alloc  8192 Perm at  2094, ../../../../../src/directory/cds/server/db_btree.c
    65 Alloc  4096 Perm at  1915, ../../../../../src/directory/cds/server/db_btree.c
    66 Alloc  5120 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    67 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    68 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    69 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    70 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    71 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    72 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    73 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    74 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    75 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    76 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    77 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    78 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    79 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    80 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    81 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    82 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    83 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    84 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    85 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    86 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    87 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    88 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    89 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    90 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    91 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    92 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
    93 Alloc  5120 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    94 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    95 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    96 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    97 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    98 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    99 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   100 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   101 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   102 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   103 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   104 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   105 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   106 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   107 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   108 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   109 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   110 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   111 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   112 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   113 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   114 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   115 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   116 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   117 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   118 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   119 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   120 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   121 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   122 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   123 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   124 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   125 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   126 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   127 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   128 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   129 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   130 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   131 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   132 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   133 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   134 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   135 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   136 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   137 Alloc  8192 Perm at  2007, ../../../../../src/directory/cds/server/db_btree.c
   138 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
   139 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
   140 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   141 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   142 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
   143 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
   144 Alloc    12 Unkn at  1

At 363, DECdns Server Database up to last 500 allocations.

     1 Alloc    92 Unkn at  1046, ../../../../../src/directory/cds/library/threads_lib.c
     2 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
     3 Alloc   317 Unkn at   849, ../../../../../src/directory/cds/library/dnscfg.c
     4 Alloc   111 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     5 Alloc   104 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     6 Alloc    81 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     7 Alloc    85 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     8 Alloc    83 Unkn at  1094, ../../../../../src/directory/cds/library/dnscfg.c
     9 Alloc   272 Unkn at   914, ../../../../../src/directory/cds/library/dnscfg.c
    10 Alloc  1060 Unkn at   769, ../../../../../src/directory/cds/library/dnscfg.c
    11 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    12 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    13 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    14 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    15 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    16 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    17 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    18 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    19 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    20 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
     21 Alloc    24 Unkn at  1321, ../../../../../src/directory/cds/server/unix_net.c;     31 Freed
    22 Alloc   452 Unkn at  1340, ../../../../../src/directory/cds/server/unix_net.c
     23 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     24 Freed
     25 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     26 Freed
     27 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     28 Freed
     29 Alloc   122 Unkn at    60, ../../../../../src/directory/cds/library/dnscreatects.c;     30 Freed
    32 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    33 Alloc    40 Temp at  1625, ../../../../../src/directory/cds/server/unix_net.c
    34 Alloc    36 Unkn at   926, ../../../../../src/directory/cds/server/ta_adver.c
    35 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    36 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    37 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    38 Alloc    92 Unkn at  1270, ../../../../../src/directory/cds/library/threads_lib.c
    39 Alloc  1780 Unkn at  1768, ../../../../../src/directory/cds/server/dns_service_ncl.c
    40 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    41 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    42 Alloc  2828 Perm at  1037, ../../../../../src/directory/cds/server/db_common.c
    43 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    44 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    45 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    46 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    47 Alloc  4096 Perm at   474, ../../../../../src/directory/cds/server/db_directory.c
    48 Alloc   540 Perm at   563, ../../../../../src/directory/cds/server/db_hash.c
    49 Alloc    12 Unkn at  1853, ../../../../../src/directory/cds/library/threads_lib.c
    50 Alloc     8 Unkn at  2149, ../../../../../src/directory/cds/library/threads_lib.c
    51 Alloc     8 U

[10/13/92 public]
One more data point from Richard Mark <rmark@llnl.gov>:

We recently installed the V1.0.1 release and have begun testing the various
components as described in the Porting and Testing Guide.  During the process
of testing the CDS using the supplied test scripts, we encountered a
bugcheck in the cdsd when running the cp_abuse.tests.  The script creates a
flurry of directories and then proceeds to create a bunch of object entries.
After creating approximately 1200 object entries, I believe the cdsd crashes.
The following is an example of what appears in the log for the abuse script

cdscp> cre obj /.:/root/testdir/w394.object CDS_Class = object_class CDS_ClassVe
rsion = 1.0
Error on entity: /.../zodiac/root/testdir/w394.object
connection closed (dce / rpc)
Function: dnsCreateObj

cdscp> cre obj /.:/root/testdir/w395.object CDS_Class = object_class CDS_ClassVe
rsion = 1.0
Error on entity: /.../zodiac/root/testdir/w395.object
connection request rejected (dce / rpc)
Function: dnsCreateObj

<several similiar entries deleted>

cdscp> cre obj /.:/root/testdir/w401.object CDS_Class = object_class CDS_ClassVe
rsion = 1.0
Error on entity: /.../zodiac/root/testdir/w401.object
Timeout occurred, operation not performed (dce / cds)
Function: dnsCreateObj

The contents of the cdsd.log file are as follows:

 [16630] Thu Sep 24 16:07:27 1992

************* BUGCHECK *************
A module in the server has bugchecked
Bugcheck code is ... -902
Thread id .......... 20b476d0
Thread errno ....... 0
UNIX errno ......... 22
Bug ref# ........... 966
Module id........... ../../../../../src/directory/cds/server/db_compression.c
************* BUGCHECK *************
At 280747, writing up to last 500 allocations to ./vm_data
At 280747, writing all current allocations to ./vm_data

Since neither of these logs have timestamped entries, I can only assume some
relationship of events. When I went to examine running processes, I didn't
locate a cdsd from which I conclude the bug check forced or caused it to die.
This problem is reproducable, it doesn't occur at the exact same location in
the abuse script but it has the same behavior and the same bugcheck message
is logged.  In recovering from this we had to clean up the environment (using
dce.rm and dce.clean scripts) and the configure again.

In what is probably a related problem, about 5-6 hours after I started the
abuse scripts, we started getting the following messages:

sec_clientd 09/24/92 23:32:17 - Host Principal key management failure
... connection request rejected (dce / rpc)

These messages appear every 10 minutes (which I assume is somebody's retry
value) and then 5 or 6 hours later the following messages appear:

sec_clientd 09/24/92 06:12:56 - Warning - unable to refresh identity ...
will id
le
... Cannot contact any KDC for requested realm (dcsec_clientd 09/24/92 ...
... Cannot contact any KDC for requested realm (dce / krb)

This seems related because of the security service's use of name services and
/or it's inability to make use of those services if the cds daemon is dead.

All other CDS test scripts appear to have been successful.

[12/7/92 public]
Cancelled due to non-reproducibility. Possibly related to the fixed CR 5047.

[12/7/92 public]
My mistake. OSF should attempt to reproduce and cancel if they can't.

[09/14/93 public]
Not reproducable. Cancelled.



CR Number                     : 5114
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : fts
Short Description             : fts lsquota makes a fileset busy
Reported Date                 : 8/18/92
Found in Baseline             : 1.0.1
Found Date                    : 8/18/92
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jafe@transarc.com
Transarc Status               : open

[8/18/92 public]

Currently the fts lsquota command will cause a fileset to be considered
busy if accessed concurrently by other processes.  In discussing this with
Craig he said this does not need to be.  The current behaviour is only
annoying, and is not causing any failures.

Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[11/11/92 public]
In creating OT 6025, Elliot correctly wondered why the CM's error message
looks like
	dfs: fileset (id = XX) is busy with error NNNNNNNNNN
That is, why the CM's console message is confused about the state of
the fileset--in one part of the message it's just busy, and in the other
part of the message it has an ``error'' code.

[11/11/92 public]

The CM output has an error in it. From Elliot's message in OT 6025

	dfs: fileset (id = 1) is busy with error 691089516
	dfs: waiting (691089516) for busy fileset 0,,0

the busy fileset's id should be 0,,1 and not 0,,0.

[11/18/92 public]
Filled in Interest List CC with `dawn%liz.austin.ibm.com@transarc.com'

[1/20/93 public]
I fixed the ``0,,0'' and problem a while ago.
Mike Kazar has already fixed the fundamental problem in 6180, so I'll let him
cancel this when he's submitted 6180.
Changed Interest List CC from `dawn%liz.austin.ibm.com@transarc.com' to 
 `dawn%liz.austin.ibm.com@transarc.com, cfe@transarc.com' 
Changed Responsible Engr. from `cfe@transarc.com' to `kazar@transarc.com' 
Changed Transarc Herder from `mason@transarc.com' to `jafe@transarc.com'

[3/21/94 public]
Assigned to Diane to verify.

[3/22/94 public]

This no longer appears to be a problem.



CR Number                     : 5112
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dced
Subcomponent Name             : dced
Short Description             : dced should export binding info to hosts/<hostname>/self
Reported Date                 : 8/18/92
Found in Baseline             : 1.0.1
Found Date                    : 8/18/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[8/18/92 public]
 
Currently (in 1.0.1) the binding on the hosts/<hostname>/self entry in the
namespace is created by dce_config. It is only a UDP binding (Even if the
cell is being created with only connectionful transports! This is because
dce_config doesn't check what transport are availble.)
 
This entry is not currently used by any part of DCE, so this isn't a big
problem, but it's there for consistency, and for consistency's sake we
should also have the connectionful bindings there.
 
The correct way to fix this is to have rpcd export the binding information
(since only rpcd knows exactly what transports it's willing to accept). This
requires some more fancyness in the cell creation case (obvisously rpcd can't
do the export until after the namespace has been created), but this is a
small programming problem.

[10/16/92 public]
Changed code enginer to Mishkin.

[1/27/93 public]
 
Cancelled after discussion with R. Mackey.

[1/27/93 public]
 
There seems to be some confusion, nothing in DCE will break if this entry isn't
created correctly, indeed, nothing in DCE will break at all if this entry isn't
created by dce_config.
 
Nat had a argument on why the binding on host/<hostname>/self was useful.
Certain applications might need to communicate with the rpcd on a host, using
the bindings on host/<hostname>/self was the way he expected them to do it.
 
NOW, either this shouldn't be supported at all - in which case dce_config
shouldn't put the binding there - or all the bindings that are relavent should
be placed there. Nat felt stongly that they should all be there, and agreed to
make the changes outlined above.
 
In any case, this should be fixed (though it might be reasonable to defer
it from DCE1.0.1) - either by elminating the binding from dce_config, or
preferably, changing rpcd.

[1/30/93 public]
 
The (probably) cleanest fix for this is to introduce a new rpcd
management interface to export all of its bindings to the
namespace.  rpccp would be the client of this interface, and when
dce_config has finished creating the namespace, it would invoke
rpccp to export the rpcd bindings.
 
Changing this OT to an enhancement.

[6/20/94 public]
Since rpcd is going to be replaced by dced in DCE R1.1, this enhancement
is probably moot.  Adding the dced component owner to the CC list
sbut I am canceling this enhancement.

[6/20/94 public]
Is there some reason why you aren't just changing the component for these
defects to dced instead of cancelling them?

[6/20/94 public]
I canceled this one because, as I said above, this one is probably moot.
The 1 other defect that related to rpcd, I assigned to dced.
I would expect Rich to re-open this if, in fact, dced has this problem.

[6/20/94 public]
Is there some characteristic of dced that makes it moot?  It seems like the
above arguments still hold.
 
By the way, in the cells I've seen, /:/fs is a group containing the self
entry for the primary server.

[6/21/94 public]
 
Dave's right, the argument above applies equally well to the dced.

[6/21/94 public]
Well, I don't see you guys jumping to *fix* this.
I also might point out that if it is indeed a dced problem, the
perhaps instead out just pointing this out to me, you could re-assign
the defect (as I have) to the dced component (and the dced componet lead).

[6/24/94 public]
This defect was just forwarded to me, so I haven't been involved in
this discussion, but I would like to point out that one DCE component
would be quite broken without the self entry in the namespace. I believe
that this entry is primarily there for DFS and thus the reason it only
has udp binding information.  When cn RPC was introduced into our code
base, a well-intentioned install/config person modified the config
tools to include the cn binding information for this entry.  DFS
was dead in the water. I don't think this can be changed without
significant impact to DFS. This section of our config tool now
reads:
 
        # Export the DFS endpoint mapper host binding (only for ncadg_ip_udp)
        echo $default_protocols | grep -q "ncadg_ip_udp"
        if [ $? -eq 0 ]; then
        echo "export -i e1af8308-5d1f-11c9-91a4-08002b14a0fa,3.0 \
                -b ncadg_ip_udp:${ip_address}[135] \
                /.:/hosts/$dce_host/self"
        fi
Changed Interest List CC from `rsalz' to `rsalz, dstokes@austin, 
 cfe@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[6/24/94 public]
Well, blush.  Looks like ubik needs to filter its bindings a bit
better than it does, or something.  But, yes, DFS really needs that
hosts/FOO/self entry.
 
But it gets worse.  If a machine has more than one network address,
all those addresses should be put into the hosts/FOO/self entry to get
ubik to work.  Otherwise, one of the Ubik peers might not recognize
RPCs from another of the Ubik peers as members of the configured set.

[07/12/94 public]
Criag and I did some off-line discussion about this.  It turns out
that because of a bug in ubik we can't change what gets put in the self
entry.  However, dced puts everything in the "config" entry so life's
not as bad as it seems.  Marking this as cancel, since that seems a little
more correct then closed.



CR Number                     : 5092
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : make/build
Short Description             : build errors do not say what file failed to build
Reported Date                 : 8/18/92
Found in Baseline             : 1.0.2
Found Date                    : 8/18/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/18/92 public]
Build errors do not say what file they failed to build.  This is
extremely annoying as far as being able to find errors in an automated
way in huge logs.

[09/22/92 public]
This doesn't seem to be a build problem.  The various build errors that
occurr in DCE do (for the most part) identify which file caused
the problem.  I think the complaint here is that the build logs are
so large and soo much information is provided that it is hard to "grep"
for errors and especially hard to look at the log with an editor.

I think what the user is looking for is some tools to extract 
compilation/link/file-not-found errors from the logs.  I'll pass along 
what we use for the nightly build.

[12/23/93 public]
I recommend cancelling this defect.

[7/1/94 public]
As Marty mentioned above -in general build does report an explicit
error message at least once per error -



CR Number                     : 5091
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : make/build
Short Description             : Executables are not rebuilt when libraries change.
Reported Date                 : 8/17/92
Found in Baseline             : 1.0.2
Found Date                    : 8/17/92
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[8/17/92 public]
Executables are not rebuilt when their libraries change.  This makes
ordinary development painful.  After all, wasn't this the original
point of make?
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `jaffe@transarc.com' 
Added field Transarc Status with value `open'

[9/23/92 public]
(I deleted the previous, misleading comments.)

The problem with rebuilding DCE has nothing to do with make.  Make will
handle all the dependencies that we choose to specify.  However, many (if
not most) library dependencies (and include dependencies) have never been
specified in the makefiles, and *therefore* make does not check them.
Component developers are welcome to specify all this information, and make
will check any which are specified.

The DCE Rats are thinking about an enhancement to ODE which would
automatically record and update include and library dependencies.  We have
been working on automatically recording and updating header file
dependencies.  When that is complete, we hope to follow on with library
dependencies.

[9/23/92 public]
I didn't think my comment was misleading.  I asked several months ago how to
add library dependencies and was told that the rats did not know how to do
it.  I can (and have) added dependencies on libraries, but only on libraries
created by the same makefile.  Adding additional libraries to a dependency
line merely gives a build which quits by stating that it does not know how to
make the library.  I believe this is because make does not know where to look
for the library to compute the dependency.

If someone at OSF could explain how to set up such a dependency, independent
of being automatic, I'd be content to leave things at that.  If it cannot be
done, it is a defect.

[12/23/93 public]
Recommend cancelling this defect.  

A alternate (really ugly) solution would be to generate a makefile code
segment which states all the OFILES dependencies on each library, and then
.include it into the current makefile.  See osf.parse_ext.mk as an example
of on-the-fly makefile code generation.  I am NOT recommending this; I'm
simply pointing out that it is possible.

[7/1/94 public ]
Changed assignment to rrizzo and severity - because there is a workaround.
to D 2

[8/24/94 public]
I second Rich's recommendation.  Let's cancel this thing.  The changes for
this will never make it into DCE1.1.  Whoever is picking up the integration
work for DCE 1.2 should think about overhauling the entire build environment
and source tree organization.  I'm sure they are thinking about it and
don't need to be reminded by this CR.



CR Number                     : 4970
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : rpccp
Short Description             : unauthenticated rpccp behavior
differs from cdscp.
Reported Date                 : 8/9/92
Found in Baseline             : 1.0.1b25
Found Date                    : 8/9/92
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/9/92 public]

unauthenticated (no/expired creds) rpccp behavior differs from cdscp:

$ klist
No DCE identity available: No currently established network identity for
which c
ontext exists (dce / sec)

Kerberos Ticket Information:
klist: No credentials cache file found (dce / krb) while setting cache
flags (ti
cket cache /tmp/krb5cc_1252)
$ rpccp show entry /.:/cell-profile

>>> rpc runtime error: No currently established network identity for which
conte
xt exists (dce / sec)

$ cdscp show obj /.:/cell-profile
Warning: you have no network credentials. All requests will be
unauthenticated.

                        SHOW
                      OBJECT   /.../raiford.austin.ibm.com/cell-profile
                          AT   1992-08-09-19:22:35
            RPC_ClassVersion = 0100
                 RPC_Profile =
501e7c0d3a11ca11b71f08001e01dc6c01000000000973656
369646d61700020002f2e2e2e2f726169666f72642e61757374696e2e69626d2e636f6d2f7365630
0
                 RPC_Profile =
50de738f8c76ca11bffc08001e0394310100000000086b726
2357270630020002f2e2e2e2f726169666f72642e61757374696e2e69626d2e636f6d2f73656300
                 RPC_Profile =
f838e3b13395c911a34a08001e019c1e01000000000672707
269760020002f2e2e2e2f726169666f72642e61757374696e2e69626d2e636f6d2f73656300
                 RPC_Profile =
4242266ff8b9c911ad3108002b0dc0350100000000044c414
e0028002f2e2e2e2f726169666f72642e61757374696e2e69626d2e636f6d2f6c616e2d70726f666
96c6500
                 RPC_Profile =
ddf2374d43ed000002c037cf2e00000104000000000366730
01f002f2e2e2e2f726169666f72642e61757374696e2e69626d2e636f6d2f667300
                 RPC_Profile =
2a4e81eb9900ca11867802608c2ea96e04000000000462616
b002f002f2e2e2e2f726169666f72642e61757374696e2e69626d2e636f6d2f7375627379732f646
3652f6466732f62616b00
                     CDS_CTS =
1992-08-07-01:24:57.343905100/10-00-5a-4f-53-3a
                     CDS_UTS =
1992-08-07-01:25:38.338633100/10-00-5a-4f-53-3a
                   CDS_Class = RPC_Profile
            CDS_ClassVersion = 1.0

[10/16/92 public]
Changed to enhancement.

[05/04/94 public]
This enhancement wont be made to rpccp, since it it being replaced by dcecp.
However the dcecp and dced people should take a look at this and 
make sure dcecp has consistant behavior. 
Adding them to the CC list so they can see it.
Canceling this enhancement



CR Number                     : 4948
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : dskl
Subcomponent Name             : diskless/boot/bootpd/Makefile
Short Description             : Makefile explicitly defines
-D_AIX. This should not come here.
Reported Date                 : 8/6/92
Found in Baseline             : 1.0.1
Found Date                    : 8/6/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/6/92 public]

        There is no diskless.mk file, where machine dependent env should
        go. diskless/boot/bootpd/Makefile explicitly uses -D_AIX, making
        it impossible for other platform to compile.

[5/25/94 public]
The diskless source has been defuncted from the tree.
OSF no longer supports diskless.
Canceled.



CR Number                     : 4926
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : 
Short Description             : inconsistent treatment of bak entry
Reported Date                 : 8/5/92
Found in Baseline             : 1.0.1
Found Date                    : 8/5/92
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[8/5/92 public]
Jonathan Chinitz noticed the following inconsistency in dce_config:

The entry

/.:/$SUBSYSDIR/$DFSDIR/bak 

gets created as a *directory* in CDS,

but it also gets added to the cell-profile which implys it should
be a CDS object (ie. a server entry, a group, or a profile).

[1/30/93 public]
I believe this may have been done originally to prevent
spurious errors until DFS back up configuration capability
is added to dce_config.  Changing to enhancement.

[6/7/93 public]
This was fixed when the back up config changes were added to dce_config.



CR Number                     : 4907
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : dce.clean
Short Description             : Why does dce.clean use 'kill'?
Reported Date                 : 7/31/92
Found in Baseline             : 1.0.1
Found Date                    : 7/31/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/31/92 public]
Our CDS people here suggested dce.clean use 'cdscp disable' to kill
servers and clerks.  DTS also has a special command for taking down
dtsd.  Shouldn't these be used in dce.clean instead of 'kill'?

[10/14/93 public]
This will be partly addressed by the 1.1 dced.
I prototyped a dce.clean to try and use some of the shutdown commands,
and it was a failure.  Many things don't shutdown gracefully and
take a long time doing so.  Most dce servers handle SIGTERM and
do the right thing.



CR Number                     : 4870
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : gds
Subcomponent Name             : gds/dua/{d21ref.c d21_c70.c d21lsh.c d21cph.c d21common.c}
Short Description             : size_t is not necessarily defined in <stdio.h>
Reported Date                 : 7/29/92
Found in Baseline             : 1.0.1
Found Date                    : 7/29/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/29/92 public]

        Both osf/1 and aix define size_t in <stdio.h>, so those files
        can be compiled without error. But on Sun, size_t is NOT defined
        in <stdio.h>. Instead, itis defined in <stddef.h>. This causes the 
        failure of compilation of those files: size_t is not defined.

Proposed Solution:

        <stddef.h> should be also included. Definition of size_t in
        <stddef.h> on both osf/1 and aix comes with #ifdef SIZE_T, so it is
        not a problem and redefinition.

[12/08/92 public]
This works on AIX ,PMAX, and SVR4. Idon't want to change this now.
We can decide for Code cleanup what should be changed.

[2/23/93 public]
Assigned to Norbert.

[3/23/93 public]
Agree with Helmut, deferred until 1.1

[1/17/94 public]
I want to cancel this, because site_t is set on POSIX compliant systems
in <stdio.h> Ports to non-POSIX systems should fix it according to their
policy.
Do you agree, Rich?

[1/31/94 public]
Agreed.



CR Number                     : 4868
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : gds
Subcomponent Name             : gds/adm/delupd/{d21lock.c d20errfile.c d21getjob.c} gds/dsa/d26logg.c gds/dua/d21file.c
Short Description             : Not every system defines SEEK_SET in <stdio.h>
Reported Date                 : 7/29/92
Found in Baseline             : 1.0.1
Found Date                    : 7/29/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/29/92 public]

        Both osf/1 and aix define SEEK_SET in <stdio.h>, but not every
        system does it the same. Sun defines it in <unistd.h>.

Proposed Solution:

        Add include of <unistd.h> to those files. This will not create a 
        compiler redefintion problem for osf/1 and aix since the defintion 
        of SEEK_SET in <unistd.h> on osf/1 and aix comes with #ifdef.

[12/08/92 public]
This works on AIX ,PMAX, and SVR4. Idon't want to change this now.
We can decide for Code cleanup what should be changed.

[7/30/92 public]

one more file: security/client/rca/internal_binding.c


Yet one more file: security/krb5/lib/keytab/file/ktf_util.c
but I think it is security/krb5/lib/keytab/file/ktfile.h that should
include <unistd.h>.

[8/5/92 public]

one more: security/client/admin/acl_edit/deif.c
security/client/admin/passwd_export/passwd_export.c

[2/23/93 public]
Assigned to Norbert.

[3/23/93 public]
Deferred for code cleanup in 1.1

[1/17/94 public]
According to POSIX and XPG3, SEKK_SET should be set in <stdio.h>.
People who port to non-POSIX systems should set it in their
environment.
So I want to cancel this bug. Do you agree, Rich?

[1/31/94 public]
Agreed.



CR Number                     : 4768
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : sec
Subcomponent Name             : 2
Short Description             : sec_clientd should decome a daemon only after its initial setup is successful
Reported Date                 : 7/17/92
Found in Baseline             : 1.0.1
Found Date                    : 7/17/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[7/17/92 public]

Currently dce_config starts sec_clientd and always gets a return code of 0
even if sec_clientd failed to start. This is because the parent is the one
who is returning 0 without waiting for the child process to finish its
initialization (eg., register authentication information, export bindings etc).

The above problem can be fixed in dce_config by making it wait for sometime
but the fix also has to be done in sec_clientd. As of now if sec_clientd fails
but dce_config continues as if everything is fine and fails at a later stage.

Is there any reason the "rs_process_make_server" call in sec_clientd.c
cannot be called just before starting the machine context and listener
threads?

The same problem could also exist in secd.

[08/27/92 public]
This has come up before in the DTS context.

I believe rpcd has a routine that does "fork child, wait for it to
get set up and register, then exit with appropriate status."

Let's expose this routine -- rpc_server_fork? -- and convert all our
servers to use it.  I guess this comes under the 1.1 code cleanup banner.

[9/22/92 public]

We could change sec_clientd so that in the normal case control only returned to 
the shell after it completed setup - but this will not fix all cases.  It is
always possible that you are running on a client machine that cannot communicate
with the security server (due to partitions etc.).  In this event sec_clientd
will not be able to complete setup, but it will still want to allow the
machine to complete booting.  Other processes that wish to inherit the
client machine's context must be capable of recovering from this situation.
(They should either report status, or idle and retry)

[08/26/94 public]
In DCE 1.1 sec_clientd is gone for dced secval which does the right thing.
Cancel.



CR Number                     : 4741
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cds
Subcomponent Name             : 
Short Description             : CDS spurious returns error
Reported Date                 : 7/16/92
Found in Baseline             : 1.0.1
Found Date                    : 7/16/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[7/16/92 public]
After running for about a day (actuually 22 hours), CDS calls started
returning "error with socket (dce / cds)" (that's the message from
the DCE error message function.

The CDS client program was a user command, and so the problem is
almost certainly not due to corruption of the client address space,
since it is a fresh one each time.  The command executing was "fts lsquota ."
and the function that was returning this error is rpc_ns_profile_elt_inq_next.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[7/16/92 public]
This looks like a duplicate of 4245: "A rpc call suddenly returns comm_failure"

[8/25/92 public]
Is this behavior still occurring with the frozen 1.0.1? Otherwise this CR
should be cancelled.

[9/30/92 public]

This was observed in the current 1.0.2 by a stress test scenario:

12 clients in separate processes, with the same DCE principal, concurrently
attempting to locate a single server by calls to
rpc_ns_binding_import_next.  Nine clients found the service, the others
received "error with socket (dce / cds)".

Contact Mark Hickey at OSF for more info on this.

[10/9/92 public]

Another data point: This problem was observed when two processes, running
as the machine principal, executed:

	do forever
		cdscp show dir /.:
	end do.

[12/7/92 public]
OSF should attempt to reproduce this problem. We suspect that this is
really an RPC problem. Please verify or cancel.

[08/27/93 public]
I ran Dave's forever loop in three windows on both the hp ant the 486 with
no problems. I beleive this problem has gone away. Cancelled.



CR Number                     : 4710
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : Need a way to config a second flserver site
Reported Date                 : 7/14/92
Found in Baseline             : 1.0.1
Found Date                    : 7/14/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[7/14/92 public]
The dce_config script should have some mechanism to configure multiple
flserver machines.  The latest version that I looked at would allow admins
to create an initial flserver (Fileset Location Database Machine) site,
but would also proceed with creating a root.dfs fileset.

There should be multiple flserver machines in a cell for availability;
there should usually be 3, or generally some odd number larger than 1.

I believe that most of the current flserver configuration is correct in
dce_config; the only difficulty is that this configuration pass may attempt
to create a root.dfs even if there isn't one.  The script could run
``fts lsfldb root.dfs'' to determine if there is a root.dfs fileset already.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[7/14/92 public]
Changed to enhancement.

[6/7/93 public]
This was fixed under another CR which escapes me at the moment.



CR Number                     : 4670
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : gds
Subcomponent Name             : src/directory/xds/dsRead.c
Short Description             : A ds_read operation on an
object with an empty acl returns acl with acl items.
Reported Date                 : 7/9/92
Found in Baseline             : 1.0.1
Found Date                    : 7/9/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : dsRead.c
Sensitivity                   : public

[7/9/92 public]

Full Description:

  Perform a read on an object with an empty acl using ds_read.
  What is returned by XDS for the acl follows:

     ACL
       1 Modify Public ACL item
          DSX_Interpretation = DSX_ROOT_OF_SUBTREE
          DSX_User - Only composed of the DS_C_DS_DN object class oid
       1 Read Standard ACL item
          DSX_Interpretation = DSX_ROOT_OF_SUBTREE
          DSX_User - Only composed of the DS_C_DS_DN object class oid
       1 Modify Standard ACL item
          DSX_Interpretation = DSX_ROOT_OF_SUBTREE
          DSX_User - Only composed of the DS_C_DS_DN object class oid
       1 Read Sensitive ACL item
          DSX_Interpretation = DSX_ROOT_OF_SUBTREE
          DSX_User - Only composed of the DS_C_DS_DN object class oid
       1 Modify Sensitive ACL item
          DSX_Interpretation = DSX_ROOT_OF_SUBTREE
          DSX_User - Only composed of the DS_C_DS_DN object class oid


  The acl should contain no acl items.

Repeat By:

  Perform a ds_read on an object with an empty acl, with the
  selection parameter set to DS_SELECT_ALL_TYPES_AND_VALUES.
  The acl returned will match the above description.

Proposed Solution:

  When an empty acl is read there should be no DSX_C_GDS_ACL_ITEM
  returned.  Location of proposed fix ... ??

[12/08/92 public]
I have given a long explanation over e-mail to
this problem and I think the bug should be canceled.

[2/23/93 public]
Assigned to Norbert.

[3/22/93 public]
Deferred until 1.0.3.

[10/7/93 public]
Defect aging time-out.  Priority bumped to 1.

[10/15/93 public]

hey Helmut, could you give a briefer but no less explanatory note
in this report as to why we should cancel it?

[10/20/93 public]
Deferred to 1.1.

[01/31/94 public]
In GDS you can not have an object without ACL, that means
every single Object have a AACL. At least this ACL can
be the whole subtree below root (what is the current ACL 
showing in the example above). So in every object there is a mandatory 
Attribute for the ACL and you can not remove it.

[01/31/94 public]
My message above means that this is no bug.
If you do a ds_read over XDS and request for 
DS_SELECT_ALL_TYPES_AND_VALUES, you everytime get a
ACL back, that means you everytime get acl items back.
In the XDS/XOM manual is a chapter Access Control is a sentence
The directory attribute DSX_A_ACL is present for each entry in the
DIT. This means implicit that if you read DS_SELECT_ALL_TYPES_AND_VALUES
and if you set PREF_ADM_FUNC you get an ACL back. If you make a
standard ds_read you will not get an ACL Attribute back.
This is no bug , it should be cancelled.

[2/16/94 public]
But the point of the defect was that no ACLs were specified for the object
but ACLs were returned.

[01/31/94 public]
Please close this bug.
I only want to say above, there exist no entry without ACL,
and if you read with DS_ALL_TYPES_AND_VALUES and PREFER_ADM_FUNC you
everytime get an ACL back like you get it on UNIX by an ls -l.
If you make a normal read without PREFER_ADM_FUNC you don't get an ACL
back. There exist no empty ACL attribute in GDS, atleast there exist
an ACL what say everybody below ROOT can read and modify, but it exists.

[01/31/94 public]
 there exist no entry without ACL means that there is an inheritance in GDS
in the form that if you create an entry without ACL it automatically gets
the ACL of the superior entry. That means there really exist no entry 
without ACL.



CR Number                     : 4623
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : dfs
Short Description             : AFS_VFSCACHE feature ifdef has platform dependencies
Reported Date                 : 7/7/92
Found in Baseline             : 1.0.1
Found Date                    : 7/7/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : open

[7/7/92 public]
Recently while adding support for the AFS_VFSCACHE feature macro
on the AIX platform, I found several places where the code was
platform specific.  While adding the support for AIX I tried to
implement it using newly added support in the osi layer to make
it more portable at the higher layers of the system.  Since I
do not have the resources to make and test these changes on the
OSF1 platform I wrapped the AIX code in platform ifdefs and did
not attempt to change the OSF1 code.  I would like for the OSF
to make these changes for OSF1 by adding the neccessary support
in the osi layer and then using the code that is currently within
the AIX platform ifdefs, and eliminate the else portions of these
ifdefs which are the OSF1 platform specific code.
I added the following support to the osi layer:
osi_vptofh() 
    an abstraction for VFS_VPTOFH which does not exist on all platforms
osi_getattr()
    replacement for VOP_GETATTR which assumes a vnode op macro convention
osi_getfh()
    getfh() interface for AIX.  For OSF this whould just be a define to getfh()
osi_fhandle_t
    fhandle structure which is not the same on all platforms.  I only used
    it where I had to in the code, but it should probably be changed
    in all the occurrances of fhandle_t.
osi_vnodecovered()
    replacement for platform specific code which looks at vfs_mntdover
    field of the vnodes vfsp (mount) memter.
I changed the following DFS files for the VFSCACHE support for AIX:
    Editing afsd/afsd.c 4.16 
    Editing cm/cm_init.c 4.27 
    Editing cm/cm_vnodeops.c 4.175 
    Editing config/RIOS/param.h 4.2 
    Editing libafs/RIOS/dfscore.exp 4.18 
    Editing osi/RIOS/Makefile 4.3 
    Editing osi/RIOS/osi_fio.c 1.3 
    Editing osi/RIOS/osi_port_aix.c 4.2 
    Editing osi/RIOS/osi_port_aix.h 4.5 
    Editing osi/osi_printf.c 4.8 
    Editing osi/osi_ufs.c 4.3 
    Adding osi/RIOS/osi_syscall.exp 
I have dropped these changes into the Transarc tree.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[7/7/92 public]
Changed H/W Ref Platform from `rs6000' to `all' 
Changed S/W Ref Platform from `aix' to `all'

[7/20/92 public]
Changed "Fix by" to 1.0.2

[7/29/92 public]

[7/29/92 public]
According to Carl's note this is a work item for OSF.  I'm assigning it to
treff so he can decide who best to assign it to at OSF.  If it shouldn't be
assigned to OSF, we should decide to whom it SHOULD be assigned.
Changed Responsible Engr. from `mason@transarc.com' to `treff' 
Changed Transarc Herder from `mason@transarc.com' to `jaffe@transarc.com'

[07/29/92 public]
Alright, already.  We'll tackle this during 1.0.2 Deluge Week.

[7/20/93 public]
Dave, 
This defect somehow is assigned to Transarc even the resp. eng is you. 
Changed to OSF. Note that I am not sure that this defect is still applicable 
any more. 
Filled in Subcomponent Name with `dfs' 
Changed Interest List CC from `kazar@transarc.com,treff@osf.org,toml@osf.org' 
 to `kazar@transarc.com,treff@osf.org, tu' 
Changed Resp. Engr's Company from `tarc' to `osf'

[10/8/93 public]

Aged relative to Aug 1.

[10/14/93 public]
This has been deemed a code clean up item for 1.1 (if it still applies
after the OSI changes expected from xarc.)

[7/7/92 public]
Looks like this has been cleaned up already.  Cancelled.



CR Number                     : 4433
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : sec
Subcomponent Name             : sec_rgy API
Short Description             : sec_rgy_replace_all core dumps with null user_part.
Reported Date                 : 6/24/92
Found in Baseline             : 1.0.1
Found Date                    : 6/24/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/24/92 public]

Yes, sending in those nulls again.

sec_rgy_acct_replace_all () dumps core when the user_part argument is
is set to null.  When rgy_acct_replace is called the 
user_part->passwd[0] = '\0'; line does the trick.

[6/24/92 public]
The architecture, idl specification, and docs specify that this call takes
a pointer to a sec_rgy_acct_user_t as the user_part argument.  If you
(the programmer) pass in something other than what is specified (NULL *is*
something other than what is specified), then you haven't coded to the spec.
It just so happens that it is possible to check for NULL, to make it easier
for programmers to debug how they shot themselves in the foot, but that's
an enhancement, not a p1 defect.  Changed to an enhancement, lowered the
priority, and marked it 'defer'.  If you can pass in NULL and cause some
other part of security (other than your broken client) to break, then that's
a showstopper and will have to be fixed for 1.0.1, but given that the freeze is
next Tuesday, and we have more than enough real defects for the *two* of us
to fix, no enhancements will be made by then.

[9/29/93 public]
Since Rich has been going out of his way monitoring new CR's and reviewing
Specifications, to make sure that we never check for programming errors passing
NULL, because it makes them harder to find, this CR is now assigned to him
and cancelled.



CR Number                     : 4411
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : dce_config not restartable
Reported Date                 : 6/23/92
Found in Baseline             : 1.0.1b18
Found Date                    : 6/23/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[6/23/92 public]
dce_config issues a fts crserverentry command when configuring a
FLDB server machine but does not actually check if the command
succeeded. The exit status of that command should be checked and
appropriate action taken. Appropriate action could be to prompt 
the user to look in the FtLog file and to correct the situation
and then press ENTER whereupon the script could retry the 
fts crserverentry command and continue if all is ok.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/25/92 public]
Changed Responsible Engr. from `pakhtar@transarc.com' to `rsarbo@osf.org' 
Changed Resp. Engr's Company from `tarc' to `osf'

[1/19/93 public]
Yes, this is more generically the problem of dce_config restartability.
Changed from def to enh.

[8/24/94 public]
Ron and I agree that dce_config will never be truly 'restartable',
however, some progress has been made since this defect was filed
over 2 years ago.

Bug canceled.



CR Number                     : 4406
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : 
Short Description             : cdsd depends on advertiser
Reported Date                 : 6/23/92
Found in Baseline             : 1.0.b13
Found Date                    : 6/23/92
Severity                      : E
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/23/92 public]

The porting guide on page 4-8 talks about the
ability to bring up cdsd withOUT cdsadv.  This
no longer works since the cdsd was changed to
fix a timing problem.  What happens now is:
 <adver_wait_for_advertisement()
 >probe_root_dir()
 attempt #1 to read CDS_CTS from root
 >dthread_delay(1.000000)
 attempt #2 to read CDS_CTS from root
     .
     .
     .

The ablity to bring up a cell without the advertiser
has been lost.  (which makes debugging a clerk a lot
harder).

[6/24/92 public]
Will be fixed subsequent to 1.0.1.

[10/12/92 public]
Change ENH to DEF.

[12/7/92 public]
This will be integrated in 1.1. Abby's fix will be incorporated at that time.

[9/8/93 public]
Tested on both 486(balder) and HP_UX(gnocci), cdsd works fine
without cdsadv now. So cancel this bug.



CR Number                     : 4330
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : src/rpc/runtime/ns*.c
Short Description             : Output context parameter not
checked for all ns..begin APIs
Reported Date                 : 6/18/92
Found in Baseline             : 1.0.1b17
Found Date                    : 6/18/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/18/92 public]

I have entered this as an enhancenment. 

Full Description:

        In rpc_ns_binding_import_begin, the value of import_context
        was not checked before being used to store the import context.

        In rpc_ns_binding_lookup_begin, the value of lookup_context
        was not checked before being used to store the lookup context.

        In rpc_ns_group_mbr_inq_begin, the value of inquiry_context
        was not checked before being used to store the inquiry context.

        In rpc_ns_profile_elt_inq_begin, the value of inquiry_context
        was not checked before being used to store the inquiry context.

        In rpc_ns_entry_object_inq_begin, the value of inquiry_context
        was not checked before being used to store the inquiry context.

        This would cause a write to an invalid address.

Repeat By:

        passing a NULL as the context for any of the above APIs

Proposed Solution:

        At least check for NULL import_context, lookup_context,
        or inquiry_context before storing to it.

[07/20/93 public]
OSF DCE does not have input argument checking as a philosophy.

Canceled.



CR Number                     : 4296
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : There are 9 references to "ncadg_ip_udp" without checking for RPC_SUPPORTED_PROTSEQS
Reported Date                 : 6/16/92
Found in Baseline             : 1.0.1
Found Date                    : 6/16/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/16/92 public]
There are nine references to "ncadg_ip_udp" in dce_config without ever
checking to see if RPC_SUPPORTED_PROTSEQS is set.  I'm not sure if there
should be a check done or not but this did prevent us from configuring
our client machines when the server was brought up using "ncacn_ip_tcp".

[6/29/92 public]
Changed to enh, downgraded priority since this bug applies to "cn-only" 
protocol configuration.

[8/4/93 public]
Please excuse my brash re-opening of someone else's defect, but you may want to
reconsider this one.

dce_config creates several CDS and RPC entries for daemons that do not/can not
do it themselves.  Although ncadg_ip_udp may be okay as a lowest common
denominator, I think configuration would be more complete if such registrations
were performed for each protocol supported.  This not only allows for better
interoperability (if some machines in the heterogeneous network only support
some subset of the total number of protocols a server has available), 
but also allows those services that recognize one protocol as being better 
than another to select the one they want to use.

The default set of protocols should be overridden by RPC_SUPPORTED_PROTSEQS,
if it is set.  Also, the DFS folks tell me that their endpoint mapper host
binding only works over ncadg_ip_udp, so that one should be left hardcoded.

[8/23/94 public]
As of DCE 1.1, the cds component in particular still expects that upon
configuration the DG protocol is supported.  It has this hardwired
in to its code, and I believe not only for the broadcast capability.

Basically, this enhancement will never be performed to dce_config.
Maybe when someone writes a dcecp script, and CDS is fixed, this
will happen.



CR Number                     : 4283
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : EPISODE
Short Description             : newaggr links against xaggr code
Reported Date                 : 6/16/92
Found in Baseline             : 1.0.1b18
Found Date                    : 6/16/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Status               : open
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com

[6/16/92 public]
The newaggr program calls as_init in the xaggr layer, seemingly without any
purpose.  This bug is a reminder we need to look at this and figure out if
there is still good reason for this.  If not, we shouldn't do it.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/16/92 public]
The purpose of calling as_init is to initialize some data structures used in
the dfstab library.  The dfstab library is used to look up aggregate names in
the dfstab file.  The capability of looking up aggregate names in the dfstab
file was added recently (October 1991).  I recommend that this bug be
cancelled.

[6/16/92 public]
When I talked with Ted he wanted this code to either not link against
xaggr code or be moved out of anode.   I'll leave it to him to decide now
if it should still be moved out of anode.

[7/8/92 public]
Changed Defect or Enhancement? from `def' to `enh'

[1/24/94 public]
Changed Subcomponent Name from `lfs' to `EPISODE'

[1/25/94 public]
Canceled because newaggr can depend on xaggr which is in the dfscore.
Also we expect newaggr to eventually use the ftu_ API to lookup
aggregate names so it will do the dfstab lookup on our behalf [TR Defect
3128].
Changed Status from `open' to `cancel'



CR Number                     : 4244
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : dce_config should create multiple aggregates
Reported Date                 : 6/12/92
Found in Baseline             : 1.0.1b18
Found Date                    : 6/12/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[6/12/92 public]
dce_config should allow the user to export more than one aggregate.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/15/92 public]
This is an enhancement.

[6/15/92 public]
This is beyond the scope for dce_config.  Cancelling.



CR Number                     : 4193
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : 
Short Description             : can't NFS mount DFS
Reported Date                 : 6/10/92
Found in Baseline             : 1.0.1b18
Found Date                    : 6/10/92
Severity                      : C
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Status               : open
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com

[6/10/92 public]
Tried to NFS mount /... from a DFS client (actually it was a single 
machine client/server).  mount returned EACCES.  We did trip
over a breakpoint that was set on the mount() system call on the 
client which leads me to believe the mount daemon responded to
our mount request with a file handle.

I see that AFS file ids are 6 longs, while the OSF1 notion
of a file id is at most 5 longs.  I need to look at this more,
but one suspicion I have is that the last long of the file id 
may be getting dropped somewhere.

[6/15/92 public]
More info on the same bug.  It appears the command to enable the 
translator capability is failing on the DFS client.  

"cm exp nfs on" returns the message "The nfs-exporter type is currently 
not supported on this DFS client."  If this feature is not supported
for 1.0.1, it should be documented in the release notes.

[6/16/92 public]
I will look at this, but I need some background.  Can anyone at Transarc,
or IBM fill in the blanks?  Has this ever worked before on PMAX, RIOS?  
For read-only, for read-write? Is there a commitment to support this for 
1.0.1?  Am I doing all the right things to enable this capability?

Is there any documentation on this topic beyond the cm exportdfs man page?  
I haven't found any.  Also, any architectural notes would be useful.  I 
assume the NFS server goes through the glue code on the DFS client.  It gets 
uid and gid information from the NFS client at the RPC layer.  How does 
this translate into DCE security credentials?  What about foreign users
etc.  Any and all information appreciated.

[6/16/92 public]
Filled in Responsible Engr. with `pakhtar@transarc.com' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/18/92 public]
I do not believe that this (NFS/DFS translator) functionality is supported, 
or planned to be supported in the near future. I doubt that anyone has
tried to exercise it. It is not expected to work in its present form.

[7/16/92 public]
This isn't planned for any time in the forseeable future. This OT can be
re-opened when or if such an enhancement is ever scheduled.

Changed Defect or Enhancement? from `def' to `enh' 
Changed Priority from `3' to `4' 
Changed Status from `open' to `defer'

[3/21/94 public]
Last time I checked, this worked on both ref platforms.  Cancelled.



CR Number                     : 4185
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : dfs
Subcomponent Name             : dfsbind
Short Description             : do_GetBind returns reply code " ept_s_not_registered"
Reported Date                 : 6/10/92
Found in Baseline             : 1.0.1b18
Found Date                    : 6/10/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : jaffe@transarc.com
Transarc Status               : closed

[6/10/92 public]

This is on a 1 rios machine [server cum client] cell configured from
the local dfs-101-1.21 build backed by osf build 18. I rebooted the
machine, logged in as rootl and started DCE and DFS by the rc scripts.

 [ dfsbind was started with the debug -d flag]. Then used a local klog
program to authenticate to DCE as cell_admin. Then ran fts tests on
exported UFS fileset. The tests seemed to hang. The messages on the
screen at this point was

do_GetBind (/.../dewitt.com): reply code 382312662
dfsbind: failed to send response back to kernel: (code = -1, errno = 2).
do_GetBind (/.../dewitt.com): reply code 382312662
ls: 0653-341 The file /:/BR.18765.7 does not exist.
do_GetBind (/.../dewitt.com): reply code 382312662

The reply code maps to ept_s_not_registered in usr/include/dce/rpcsts.h.

Vijay used cdscp to find the entry for /.../dewitt.com. The output from cds
is shown below:

 [(rootl)fts] /opt/dcelocal/bin/cdscp
cdscp> show dir /.../dewitt.com

                        SHOW
                   DIRECTORY   /.../dewitt.com
                          AT   1992-06-10-16:03:14
Error on entity: /.../dewitt.com
Error with socket (dce / cds)
Function: dnsEnumAttr

The screen output of the fts tests upto hang point were:

 [The interesting info is right at the end]

fts/runtests running on dewitt at Wed Jun 10 08:49:19 EDT 1992
   in cell dewitt.
Servers are dewitt and dewitt.
1 processes; 1 times; parent process number 18225.
>>> Skipping test12 (replication) (need 2 servers) <<<

Starting iteration number 1

Iteration 1 starting process number 1 at Wed Jun 10 08:49:19 EDT 1992.

Listing /:/...
ls: 0653-341 The file /:/BB.18880.1 does not exist.
ls: 0653-341 The file /:/BB.18880.2 does not exist.
ls: 0653-341 The file /:/BB.18880.3 does not exist.
ls: 0653-341 The file /:/BB.18880.4 does not exist.
ls: 0653-341 The file /:/BB.18880.5 does not exist.

ls: 0653-341 The file /:/BB.18880.6 does not exist.
ls: 0653-341 The file /:/BB.18880.7 does not exist.
ls: 0653-341 The file /:/BB.18880.8 does not exist.
ls: 0653-341 The file /:/BB.18880.9 does not exist.
ls: 0653-341 The file /:/BB.18880.10 does not exist.
ls: 0653-341 The file /:/BB.18880.11 does not exist.
ls: 0653-341 The file /:/BB.18880.12 does not exist.
ls: 0653-341 The file /:/BB.18880.13 does not exist.
ls: 0653-341 The file /:/BB.18880.14 does not exist.
ls: 0653-341 The file /:/BR.18765.7 does not exist.
ls: 0653-341 The file /:/BR.18765.8 does not exist.
ls: 0653-341 The file /:/BR.18765.A does not exist.
total 102
Frw-------   1 100      12             0 Jun 09 16:08 a
Drwxrwxr-x   6 root     adm          512 Feb 19 11:40 adm
drwxrwxrwx   7 root     system      2048 Mar 12 11:19 afsws
Drwxr-xr-x   2 bin      bin         4608 Jun 09 11:41 bin
Frwxr-xr-x   1 root     transarc   57501 May 12 16:33 dce_klog
Drwxr-xr-x   2 bin      bin          512 Jan 21 17:31 dict
Drwxr-xr-x   3 root     system      1024 Jan 21 18:12 etc
Dr--r--r--   2 root     transarc     512 Jun 09 13:17 fred
Frw-------   1 100      12             0 Jun 09 13:17 g
Drwxr-xr-x   2 100      usr          512 Jan 21 16:44 guest
Frw-------   1 4294967294 4294967294       0 Jun 09 13:56 h
Drwxr-xr-x  17 bin      bin         2560 Jan 21 18:17 include
Drwxr-xr-x  15 bin      bin         2048 Jun 09 11:28 lib
Lrwxrwxrwx   1 root     transarc      32 Jun 03 10:41 local -> /afs/transarc.com/@sys/usr/local
Drwx------   2 root     system       512 Jan 21 16:34 lost+found
Drwxrwxr-x   5 root     printq       512 Jan 29 08:30 lpd
Drwxr-xr-x  28 bin      bin          512 Jan 21 18:25 lpp
drwxrwxr-x   2 bin      mail         512 Mar 04 03:34 mail
Drwxr-xr-x  22 bin      bin          512 Jan 21 16:45 man
Drwxrwxrwt   2 bin      bin          512 Jan 21 16:45 msgs
Drwxrwxrwt   2 bin      bin          512 Jan 21 16:45 news
Drwxrwxrwt   2 bin      bin          512 Jan 21 16:45 preserve
Drwxr-xr-x   2 bin      bin          512 Jan 21 16:39 pub
Drwxrwxr-x  10 bin      bin          512 Jan 21 17:36 spool
Drwxr-xr-x   2 root     system       512 Jan 21 18:27 sys
Drwxrwxrwt   2 bin      bin          512 Jun 10 08:37 tmp
Frw-r--r--   1 root     transarc    5219 Apr 23 16:08 typescript
Drwxrwxr-x   2 bin      bin         1536 Jan 21 18:13 ucb
Drwxrwxr-x   2 bin      bin          512 Jan 21 17:49 usg
Drwxr-xr-x   6 100      12           512 Jun 10 08:47 usr
Drwxr-xr-x   4 root     system       512 Jan 21 17:21 vice

Iteration 1 process 1 running test2.
No active transactions on /.:/hosts/dewitt
There is 1 aggregate on the server /.:/hosts/dewitt (dewitt.transarc.com):
                 /usr (/dev/hd2): id=3     (non-LFS)
Non-LFS aggregate /usr (/dev/hd2): 16088 K free out of total 65536
Total filesets on server /.:/hosts/dewitt aggregate /usr (id 3): 1
/dev/hd2 0,,1 RW non-LFS      0 K  states 0x15085 accStatus 0x4  On-line
On-line
    dewitt.transarc.com, aggregate /usr (ID 3)
    Parent 0,,0       Clone 0,,0       Backup 0,,0
    llBack 0,,0       llFwd 0,,0       Version 0,,0      
    MaxQuota       0 K
    Creation Tue Jun  9 18:36:07 1992

Total filesets on-line 1; total off-line 0; total busy 0

Total number of filesets on server /.:/hosts/dewitt: 1 

root.dfs  
	readWrite   ID 0,,1  valid
	readOnly    ID 0,,2  invalid
	backup      ID 0,,3  invalid
number of sites: 1
   server           flags     aggr   siteAge principal      owner          objid
dewitt.transarc.com RW       /usr    0:00:00 hosts/dewitt   <nil>          <nil>
----------------------
Total FLDB entries that were successfully enumerated: 1 (0 failed)

Done at Wed Jun 10 09:02:41 EDT 1992.

test2 PASSED

Iteration 1 process 1 test2 returned 0.

Listing /:/...
ls: 0653-341 The file /:/BB.18880.1 does not exist.
ls: 0653-341 The file /:/BB.18880.2 does not exist.
ls: 0653-341 The file /:/BB.18880.3 does not exist.
ls: 0653-341 The file /:/BB.18880.4 does not exist.
ls: 0653-341 The file /:/BB.18880.5 does not exist.
ls: 0653-341 The file /:/BB.18880.6 does not exist.
ls: 0653-341 The file /:/BB.18880.7 does not exist.
ls: 0653-341 The file /:/BB.18880.8 does not exist.
ls: 0653-341 The file /:/BB.18880.9 does not exist.
ls: 0653-341 The file /:/BB.18880.10 does not exist.
ls: 0653-341 The file /:/BB.18880.11 does not exist.
ls: 0653-341 The file /:/BB.18880.12 does not exist.
ls: 0653-341 The file /:/BB.18880.13 does not exist.
ls: 0653-341 The file /:/BB.18880.14 does not exist.
ls: 0653-341 The file /:/BR.18765.7 does not exist.
ls: 0653-341 The file /:/BR.18765.8 does not exist.
ls: 0653-341 The file /:/BR.18765.A does not exist.
total 102
Frw-------   1 100      12             0 Jun 09 16:08 a
Drwxrwxr-x   6 root     adm          512 Feb 19 11:40 adm
drwxrwxrwx   7 root     system      2048 Mar 12 11:19 afsws
Drwxr-xr-x   2 bin      bin         4608 Jun 09 11:41 bin
Frwxr-xr-x   1 root     transarc   57501 May 12 16:33 dce_klog
Drwxr-xr-x   2 bin      bin          512 Jan 21 17:31 dict
Drwxr-xr-x   3 root     system      1024 Jan 21 18:12 etc
Dr--r--r--   2 root     transarc     512 Jun 09 13:17 fred
Frw-------   1 100      12             0 Jun 09 13:17 g
Drwxr-xr-x   2 100      usr          512 Jan 21 16:44 guest
Frw-------   1 4294967294 4294967294       0 Jun 09 13:56 h
Drwxr-xr-x  17 bin      bin         2560 Jan 21 18:17 include
Drwxr-xr-x  15 bin      bin         2048 Jun 09 11:28 lib
Lrwxrwxrwx   1 root     transarc      32 Jun 03 10:41 local -> /afs/transarc.com/@sys/usr/local
Drwx------   2 root     system       512 Jan 21 16:34 lost+found
Drwxrwxr-x   5 root     printq       512 Jan 29 08:30 lpd
Drwxr-xr-x  28 bin      bin          512 Jan 21 18:25 lpp
drwxrwxr-x   2 bin      mail         512 Mar 04 03:34 mail
Drwxr-xr-x  22 bin      bin          512 Jan 21 16:45 man
Drwxrwxrwt   2 bin      bin          512 Jan 21 16:45 msgs
Drwxrwxrwt   2 bin      bin          512 Jan 21 16:45 news
Drwxrwxrwt   2 bin      bin          512 Jan 21 16:45 preserve
Drwxr-xr-x   2 bin      bin          512 Jan 21 16:39 pub
Drwxrwxr-x  10 bin      bin          512 Jan 21 17:36 spool
Drwxr-xr-x   2 root     system       512 Jan 21 18:27 sys
Drwxrwxrwt   2 bin      bin          512 Jun 10 08:37 tmp
Frw-r--r--   1 root     transarc    5219 Apr 23 16:08 typescript
Drwxrwxr-x   2 bin      bin         1536 Jan 21 18:13 ucb
Drwxrwxr-x   2 bin      bin          512 Jan 21 17:49 usg
Drwxr-xr-x   6 100      12           512 Jun 10 08:47 usr
Drwxr-xr-x   4 root     system       512 Jan 21 17:21 vice

Iteration 1 process 1 running test1.

Wed Jun 10 09:16:59 EDT 1992
RUNNING BASIC fts COMMANDS on SERVER dewitt in CELL dewitt.
========================================================================

Running fts
fts: Type 'fts help' or 'fts help <topic>' for help

Running fts statftserver
fts: Missing required parameter '-server'
GetServer: host 'fubar_argument' could not be translated: not found (dce / rpc).
No active transactions on /.:/hosts/dewitt
No active transactions on /.:/hosts/dewitt
fts: DFS junction for cell '/.:/hosts/dewitt' not found: entry not found (dce / rpc).
The parameter, -cell, requires a non-null argument value.
fts: Too many values after switch -cell
No active transactions on /.:/hosts/dewitt
fts: DFS junction for cell 'fubar_cell' not found: incomplete name (dce / rpc).
GetServer: host 'fubar_server' could not be translated: not found (dce / rpc).

Running fts apropos
fts: Missing required parameter '-topic'
Sorry, no commands found
aggrinfo: list aggregate information
lsaggr: list aggregates on a server
lock: lock FLDB entry for fileset
unlock: release lock on FLDB entry for fileset
unlockfldb: unlock all locked entries in FLDB
clone: create backup clone of fileset
clonesys: create backup clone of group of filesets
create: create a new fileset
crfldbentry: create FLDB entry
crmount: create mount point
crserverentry: create a new server entry in FLDB
lsquota: list fileset quota
setquota: set fileset quota

Running fts help and fts <subcommand> -help
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Unknown topic 'fubar_argument'
fts: Unrecognized switch '-fubar_argument'; type 'fts help help' for detailed help
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edit server attributes in FLDB
help            get help on commands
lock            lock FLDB entry for fileset
lsaggr          list aggregates on a server
lsfldb          list filesets in FLDB
lsft            show information about fileset
lsheader        list filesets on server (bypass FLDB)
lsmount         list mount point
lsquota         list fileset quota
lsreplicas      get status of current replicas
lsserverentry   show attributes of a particular server in FLDB
move            move fileset
release         release fileset
rename          rename fileset
restore         restore fileset
rmsite          remove replication site
setquota        set fileset quota
setrepinfo      set replication parameters
statftserver    report fileset server status
statrepserver   get status of replication server
syncfldb        synchronize FLDB with fileset server
syncserv        synchronize fileset server with FLDB
unlock          release lock on FLDB entry for fileset
unlockfldb      unlock all locked entries in FLDB
update          update fileset replica
zap             delete fileset (bypass FLDB)
fts: Commands are:
addsite         add replication site
aggrinfo        list aggregate information
apropos         search by help text
clone           create backup clone of fileset
clonesys        create backup clone of group of filesets
create          create a new fileset
crfldbentry     create FLDB entry
crmount         create mount point
crserverentry   create a new server entry in FLDB
delete          delete fileset
delfldbentry    delete FLDB entry for fileset
delmount        delete mount point
delserverentry  delete a server entry in FLDB
dump            dump fileset
edserverentry   edi[pakhtar@transarc.com 6/18/92 public]
On the face of it, this looks like a configuration, setup, dfsbind or 
CDS problem.

Changed Responsible Engr. from `pakhtar@transarc.com' to `cfe@transarc.com'

[11/10/92 public]
This was ignored for a long time since its Component was dce rather than
dfs.

In any case, it's a very old defect that should be re-tested and/or
cancelled.  I've reassigned it to Vijay here, but it might need to go to
Diane since she's working on dfsbind these days.

Vijay has been running these fts tests, but I don't think that he has seen
this kind of behavior.  If we can't reproduce this, it should be cancelled.
This is the kind of odd behavior that would at least have changed, if not
gotten fixed, in the intervening months.

[01/18/93 public]
Cancelled



CR Number                     : 4118
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : cfg
Subcomponent Name             : file
Short Description             : libcom_err.a is not needed
when linking.  It should be removed.
Reported Date                 : 6/8/92
Found in Baseline             : 1.0.1
Found Date                    : 6/8/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[6/8/92 public]
Many Makefiles under file have set their LIBS line to include libcom_err.a.
This is not needed since the files in libcom_err.a are also included in
libdce.

[9/17/92 public]
We've been through this before, the initial problem is that libdce.a on the
AIX platform does not contain the libcom_err.c files.

The OSF1 libdce/Makefile picks up com_err.o and error_message.o from 
libkrb5a_OFILES which is defined in security/krb5/lib/krb5/Makefile.
This is then added to the variable libdce_4.a_OFILES, which is then used
by that Makefile to build libdce_4.a, which is then used by 
libdce/PMAX/machdep.mk to build libdce.so on the OSF/1 Platform.

The AIX libdce.a is built using a different technique which never uses the
libdce_N.a files, and thus never picks up com_err.o and error_message.o.

Once this is fixed, Transarc would be all to happy to remove libcom_err.a
from our Makefiles.

Changed Component Name from `dfs' to `dce' 
Filled in Interest List CC with `jaffe@transarc.com' 
Changed Fix By Baseline from `1.0.1' to `1.0.2' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[8/3/93 public]
Not sure how this got assigned to me.  Apparently it
is not even a bug.  Cancelling.



CR Number                     : 4040
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 7044
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : cm
Short Description             : cm may panic if cache is full
Reported Date                 : 6/3/92
Found in Baseline             : 1.0.1b24
Found Date                    : 6/3/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : closed

[6/3/92 public]
The configuration is a rios server with a pmax client.  The pmax client panic'd while running the test10 script
of the low tests.  The stack trace is:
read
vn_read
xglue_read
nosf_read
cm_rdwr
cm_read
cm_getDCache
cm_GetDSlot+1c4
panic: getdslot: !freeDSList

[6/5/92 public]
Filled in Responsible Engr. with `pakhtar@transarc.com' 
Filled in Resp. Engr's Company with `tarc' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/5/92 public]
Filled in Interest List CC with `kazar@transarc.com' 
Changed Responsible Engr. from `pakhtar@transarc.com' to `tu@transarc.com'

[6/11/92 public]
I ran the low/test10 and it did not panic. I believe the fact the system 
panics has nothing to do with low/test10. 
But, I do believe there could, indeed, be a bug regarding dcaches. That is, 
The CM might run out (it should not) of dcaches after a long series of tests 
and the system panics. You may want to consider to lower the priority since 
it is hard to reproduce ? 
Tu 
Changed Interest List CC from `kazar@transarc.com' to `kazar@transarc.com, 
 pakhtar@transarc.com'

[06/11/92 public]
Priority lowerd.  I also hear that this problem was supposed to have been
fixed quite some time ago by Carl?  If this is the case, can someone
knowledgeable take a look at the official source treee to make sure this
fix is in fact in there.

[7/20/92 public]
Changed "Fix by" to 1.0.2

[7/28/92 public]
This problem is still present in b24.  I've just seen it on a 2 
machine PMAX cell.  Tu is correct, it has nothing to do with test 
10.  I was doing a DCE build over DFS when it occured.  It looks 
like the panic Diane saw was in a read while mine is in a write.  
However, the panic message is identical.
panic("!freeDSList")
cm_GetDSlot
cm_GetDCache
cm_write
cm_rdwr
nosf_write
xglue_write
vn_write
rwuio
write
Could this be related to the fact that I had just restarted the client
and I did not clean out the old cache files?

[7/28/92 public]
I have a 1.0.1 configuration that has reproduced this bug 3 times in a row.
Tu believes this problem has been fixed in 1.0.2 since major portions of
the dcache have been re-written and Transarc has not seen this problem
in "a long time".  Therefore, I will document my configuration and
suggest that it might be useful for Transarc to give this a try on
their 1.0.2 source base to see if the problem can be reproduced.
I'm using a 2 machine cell, both PMAX, one client and one server.  I'm
building DCE through DFS.  The panic occurs when building in the gds
directory (cd src/directory/gds;build).  More specifically, the panic
occurs when creating the libaplv2c.a library.  RPC_SUPPORTED_PROTSEQS
was wide open. On all occasions, the client had been restarted after
already being configured on the server.  On 1 of the 3 occasions, all
cache files were cleaned out.  I was dce_login'ed as cell_admin from
my regular user id rsarbo.  I was running sh, and the build command
line was: 
% build 2>&1 | tee build.log

[11/3/92 public]
Both Mike and I believe that GetDownD problem is fixed and works in 1.50 and
beyond (ie., 102).  We have not been experienced this problem for a long
time. 
Ron, 
Please verify it and if the problem does not surface in the next three
weeks, we should consider to cancel it. 
Thanks,

[11/4/92 public]
DFS is currently not sufficiently stable to even think about attempting
to verify this.  Until DFS is stable enough to run a build of dce to
completion, this bug should remain open.

[11/17/92 public]
This defect needs to be resolved for 1.0.2 in order to meet the defect
age limit.
Changed Priority from `2' to `1'

[1/6/93 public]
As agreed, this is being reassigned to the OSF DFS team. If this problem
can be reproduced, we'll be happy to investigate further. Otherwise, we
recommend cancellation.
Changed Interest List CC from `kazar@transarc.com, pakhtar@transarc.com' to 
 `kazar@transarc.com, pakhtar@transarc.com, tu@transarc.com' 
Changed Responsible Engr. from `tu@transarc.com' to `rsarbo@osf.org' 
Changed Resp. Engr's Company from `tarc' to `osf'

[1/15/93 public]
BUILD:	b11 aka dfs 2.2
CONFIG:	2 pmax cell, 1 pmax = sec, cds server, dfs client
			1 pmax = fl server, sec, cds and dfs client
TEST:	dfs.glue with data file containing:
	MACHINES="dce5 dce12"
	DFS_PATH="/:/gmd_dfs"
	UFS_PATH="/usr/gmd_dfs"
	NUMDIRENTRIES=10
	NUMPROCPERMACH=5
	PRINC=gmd 
REGISTRY: unchanged except for addition of test principal gmd
DETAILS:
	Logged in as Unix user gmd and dce principal gmd, attempted
	to run test for 8 hours. Unfortunately, I had left log and
	core files from CR 6846 in the /usr/opt area so I ran out
	of space on the filesystem in ~ 1/2 hour. (NOTE: this filesystem
	is also the one being exported AND the location of the on
	disk cache)
	
	At some point after the /usr: file system full error message had been 
	repeated ~20,000 times - I got the following:
	panic: getdslot: !freeDSList
	kdb kernel trap [dfsd]: Interrupt trap, code=0
	stopped at gimmeabreak: break 1
	kdb> $k
		gimmeabreak
		Debugger
		panic
		cm_GetDSlot
		cm_GetDCache
		cm_bkgQueue
		cm_bkgDaemon
		afscall_cm
	Since I was clearly absolutely out of disk space, is this behavior
	acceptable?

[1/19/93 public]
Pervaze, I'm re-assigning this to you since the symptom has been 
reproduced, though I understand that the underlying cause might well 
be the full filesystem in this latest case.  Is it intended behavior 
for DFS to panic when the cache filesystem fills?  It seems a very
unfriendly failure mode.  Sorry to bounce this around, but as you
know, we've got to get it resolved before 1.0.2 freeze.  Thanks.

[1/19/93 public]
>Is it intended behavior for DFS to panic when the cache filesystem fills?  
In short, no. 
>It seems a very unfriendly failure mode.  
I agree. We should address this problem. The questions are:
- should this be attempted for 1.0.2?
- how destabilizing will the changes be?
- what level of confidence will we have that the system won't fail when
the cache partition fills? i.e. how well will we be able to test the fix, and
are there likely to be other problems in this area?
A conversation with Mike Kazar about this a few days ago, led me to believe
that it would probably be prudent to defer this until after 1.0.2. It
would be reasonable to evaluate this further before making a final decision.
I'll send out mail shortly, to the people concerned.

[1/28/93 public]
It has been agreed that the code changes will be deferred until after 1.0.2.
The documentation will reflect the configuration limitation. Doc defect for
1.0.2 is 7044.
Filled in Inter-dependent CRs with `7044' 
Changed Interest List CC from `kazar@transarc.com, tu@transarc.com' to 
 `pakhtar@transarc.com, tu@transarc.com' 
Changed Severity from `A' to `C' 
Changed Priority from `1' to `2' 
Changed Responsible Engr. from `pakhtar@transarc.com' to `kazar@transarc.com'

[1/28/93 public]
Changed Defect or Enhancement? from `def' to `enh'

[9/10/93 public]
The original panic in getdslot was caused by a race condition that
has been fixed in the Transarc 1.0.3 code base.
This enhancment should be left open since there is still a
possibility that a cache manager could panic if the dfs/cache 
directory runs out of space.  So far, this panic has not been
observed even when the cache paritition was full.
Changed Short Description from `pmax client panics in getdslot' to `cm may panic if cache is full'

[8/12/94 public]
You just can't get this panic any more.  (This panic string is no longer in
our repertoire.)  The definitive fix was in the change that fixed OT defect
8161.  Since that fix is in 1.0.3, I am cancelling this defect.
Changed Interest List CC from `pakhtar@transarc.com, tu@transarc.com' to 
 `bwl@transarc.com' 
Changed Status from `open' to `cancel' 
Changed Transarc Status from `open' to `closed'



CR Number                     : 3943
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : Removing attribute with wrong value behaves incorrectly
Reported Date                 : 6/1/92
Found in Baseline             : 1.0.1b17
Found Date                    : 6/1/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[6/1/92 public]
Create set-valued attribute; remove a value from the attribute that doesn't 
exist--no error given.  Create single-valued attribute; remove an incorrect
value for that attribute--value becomes an empty set.  console follows:

cdscp> cre o /.:/foo
cdscp> set o /.:/foo 1.2.3 = 50
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:00
                       1.2.3 = 50
cdscp> rem o /.:/foo 1.2.3 = 10
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:16
                       1.2.3 = <empty set>
cdscp> add o /.:/foo 1.2.3 = 20
cdscp> add o /.:/foo 1.2.3 = 40
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:40
                       1.2.3 = 20
                       1.2.3 = 40
cdscp> rem o /.:/foo 1.2.3 = 10
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../nec.cell.austin.ibm.com/foo
                          AT   1992-06-01-12:15:54
                       1.2.3 = 20
                       1.2.3 = 40
cdscp>

[6/1/92 public]
> Create set-valued attribute; remove a value from the attribute that doesn't
> exist--no error given.
This is indeed the intended, if not obvious, behavior.

Other problems with attribute values have been previously categorized
as priority 2's and 3's. I am changing this to a 2 as you do not indicate
why this is a "high priority defect".

[6/30/92 public]
Here is a diff of a fix here.  The problem seems to be in ta_modify_attribute 
of file ta_modify.c.  All I basically did was to call set_test() with the 
attribute value that was passed in.
*** 239,244 ****
--- 239,268 ----
       */
      if (status == DNS_SUCCESS)
          {
+ 
+               if (EXT16(valuePresent_p->bl_value) &&
+                       (EXT8(update_p->ud_operation) == UD_absent) &&
+                         rec_p->data_p)
+
+                 {
+                         byte_t *val_p, val_type;
+                         AtomicValue_t av;
+                         int val_len;
+
+                         val_p = SKIP_AttributeSpecifier(update_p->ud_attribute
);
+                         GET8(val_p);
+                         val_len = GET16(val_p);
+                         val_type = GET8(val_p);
+                         INS16(&av.av_length, val_len);
+                         INS8(&av.av_valuetype, val_type);
+                         COPY_bytes(val_p, av.av_value, val_len);
+                         if (set_test(rec_p->data_p, (AttributeName_t *)attribu
te_p->as_name, &av) == FALSE)
+                         {
+                                 db_close_stream(stream_p);
+                                 return(DNS_INVALIDARGUMENT);
+                         }
+                 }
+

<

[7/13/92 public]
Changed strncpy() to COPY_bytes() above ...

[7/28/92 public]
The above fix is overwriting the stack during background skulks.  We're beginning
to investigate why.

[11/17/92 public]
We believe that this is a duplicate of OT 2520.

I have retried this on a stock b20 OSF DCE machine and an AIX DCE machine
with the new sets_lib.c that OT3525 changed.  I still can remove invalid 
attributes from CDS entities and not get any complaints.

I have been running a cdsd with the above mentioned fix and haven't seen any
stack overwrites.  I am keeping an eye out though.

[04/01/93 public]
Fix in 1.0.3.

[07/07/93 public]
What am I missing here. The 1.0.1 documentation says that set object
chagnes the value of a modifiable, *single-valued* attribute of an 
object entry. If it doesn't exist it creates it.

cdscp> cre o /.:/foo
cdscp> set o /.:/foo 1.2.3 = 50
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/foo
                          AT   1993-07-07-05:07:37
                       1.2.3 = 50
cdscp> add o /.:/foo 1.2.3 = 20
Error on entity: /.../vanilla.qadce.osf.org/foo
Specified attribute type is incorrect (dce / cds)
Function: dnsAddAttrValue

This is correct since the attribute is not set valued.

I can however...

cdscp> rem o /.:/foo 1.2.3
cdscp> sh o /.:/foo 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/foo
                          AT   1993-07-07-05:21:02
                       1.2.3 = <empty set>

and the following works...

cdscp> cre o /.:/bar
cdscp> add o /.:/bar 1.2.3 = 50
cdscp> add o /.:/bar 1.2.3 = 20
cdscp> add o /.:/bar 1.2.3 = 40
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:14:39
                       1.2.3 = 50
                       1.2.3 = 20
                       1.2.3 = 40
cdscp> rem o /.:/bar 1.2.3 = 10
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:15:01
                       1.2.3 = 50
                       1.2.3 = 20
                       1.2.3 = 40
cdscp> rem o /.:/bar 1.2.3 = 50
cdscp> rem o /.:/bar 1.2.3 = 20
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:16:45
                       1.2.3 = 40
cdscp> rem o /.:/bar 1.2.3 = 40
cdscp> sh o /.:/bar 1.2.3

                        SHOW
                      OBJECT   /.../vanilla.qadce.osf.org/bar
                          AT   1993-07-07-05:17:53
                       1.2.3 = <empty set>

This all seems ok now.

If noone objects this will be canceled shortly.

[07/07/93 public]
The problem with single-valued attributes was fixed (at some time).  Should the
behaviour for set-valued attributes be documented in the 'cdscp remove object' man
page?  The "success" when removing a non-existent attribute value seems unintuitive.

[07/07/93 public]
I opened a doc bug - 8241. Canceling this.....



CR Number                     : 3934
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : DFS and security installation not separate.
Reported Date                 : 6/1/92
Found in Baseline             : 1.0.1b17
Found Date                    : 6/1/92
Severity                      : E
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[6/1/92 public]

When you select to install the security server in dce_config, why does it
prompt you, asking if you want to install the DFS client binaries.

[6/5/92 public]
I'm changing this to an enhancement.  When you install any DCE server, 
you also implicitly install DCE client software.  You only notice the 
DFS client installation because it prompts you.  The interface may
be somewhat incongruent, but it works.  There are more important
dce_config problems that should be fixed first.

Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[8/3/93 public]
This is just the way dce_config works.  This is not a bug
that's going to get fixed in my lifetime.  Unless someone
has a strong objection, cancelling.



CR Number                     : 3896
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : rpc_ns_binding_export api.
Short Description             : This api returns a status code
which is incorrect.
Reported Date                 : 5/28/92
Found in Baseline             : 1.0.1b16
Found Date                    : 5/28/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/28/92 public]

The rpc_ns_binding_export routine is supplied with the entry 
/.:/DVS_dir/dvs_entry. But the directory DVS_dir does not exist under cell
root (/.:). This routine returns a status: entry not found; which is
incorrect. It should return as status something like directory does not
exist. Also, the Application Development Reference does not list the
status code entry not found under rpc_ns_binding_export reference page.

[6/15/92 public]

The nsentry create routine does a cds create object call.  When the
directory does not exist, cds returns DNS_UNKNOWNENTRY and we convert
that to a status message of rpc_s_entry_not_found.
I don't think we can return anything else unless we change the
behavior of the CDS clerk.

I've marked this an enhancement instead of a defect and downgraded
its severity from B1 to C2.



CR Number                     : 3769
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cds_clerk
Short Description             : clerk should retry binding unauthenticated if authenticated binding fails
Reported Date                 : 5/22/92
Found in Baseline             : 1.0.1b16
Found Date                    : 5/22/92
Severity                      : D
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/22/92 public]
If authenticated binding to server fails, eg when perusing in foreign cell before rgy_edit
cell command is issued, the clerk should retry binding in unauthenticated mode.

[12/7/92 public]
This is work we will consider for 1.1

[6/29/94 public]
This is viewed as undesirable from a security point of view.  this ot is
being canceld.



CR Number                     : 3690
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : idl
Short Description             : idl invokes '/lib/cpp' by default.
Reported Date                 : 5/20/92
Found in Baseline             : 1.0.1
Found Date                    : 5/20/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : rpc/idl/idl_compiler/sysdep.h
Sensitivity                   : public

[5/20/92 public]
On Unix systems, the idl compiler invokes the C preprocesser via
'/lib/cpp'.  This is a bad assumption for the PMAX.  A better answer is to
invoke 'cc -E' instead so that the preprocessor is picked off the command
line and (the big benefit for the PMAX) the GCC_EXEC_PREFIX prefix will be
used.  The code in question is included below.

/*
** Default command to invoke C preprocessor.
*/
#ifdef UNIX
# ifdef apollo
#  define CPP "/usr/lib/cpp "
# else
#  define CPP "/lib/cpp "
# endif
#endif

[1/ 5/93 public]
Changed to a 1.1 code cleanup.

[08/23/93 public]
This doesn't seem to be a high priority problem if we aren't going to
fix it till 1.1.

Lowered to a C3.

[05/13/94 public]
The #define in question are in the system dependant header file for idl.
Since our current use of -cpp_cmd gives us (and anyone else) the 
functionality we need, I don't see any point in changing this code.

Any vendors who wants to invoke a different cpp can do so when porting.

Enhacement canceled.



CR Number                     : 3649
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 6814
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : Change syntax of salvage command
Reported Date                 : 5/19/92
Found in Baseline             : 1.0.1
Found Date                    : 5/19/92
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[5/19/92 public]
The interface of the salvage command needs to be modified for consistency
and clarity.  The syntax of the command is currently
   salvage -aggregate <name> [-verify] [-recover] [-norecover]
      [-verbose] [-nosalvage] [-help]
The syntax of the command should be changed to
   salvage -aggregate <name> [{-verify | -nosalvage}] [-norecover]
      [-verbose] [-help]
The interaction of the command's various options needs to change as well. 
The following table lists the functionality the command needs to be able
to achieve and the options used to achieve it with both the current and
new syntax:
FN'ALITY	CURRENT STX.    	NEW STX.
==================================================
verify		-verify			-verify
					-norecover
recover,	-verify			-verify
verify		-recover
recover		-nosalvage		-nosalvage
recover,	<default>		<default>
salvage
salvage		-norecover		-norecover
==================================================
The primary differences between the command's current and proposed
interface and implementation are
1. For consistency with other commands, the -verbose option is listed
   last.
2. The -recover option is unnecessary because, unless -norecover is used
   with the command, the command *always* runs recovery.
3. The -verify option still turns off salvaging by default; thus, the two
   are syntactically mutually exclusive.
If/when this change is incorporated, the documentation will need to be
changed accordingly.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[5/19/92 public]
Ted, Jeff, and I discussed the command further and have decided on a
different set of modifications.  The proposed changes would result in the
following syntax:
   salvage -aggregate <name> [{-readonly | -verify | -nosalvage | -norecover}]
      [-verbose] [-help]
The options have the following effect:
FN'ALITY	CURRENT STX.
============================
verify		-readonly
recover,	-verify
verify
recover		-nosalvage
recover,	<default>
salvage
salvage		-norecover
============================
Usability being the main thrust of the proposed changes to the interface,
the above modifications seem very reasonable.  One additional change to be
considered is a different name for the -readonly option.

[9/22/92 public]
What's the status of this?  I thought the corresponding doc changed had
already been made so that the coding changes to the salvager should be
made soon.  No?
Filled in Subcomponent Name with `lfs' 
Changed Interest List CC from `jeff@transarc.com, ota@transarc.com' to 
 `jeff@transarc.com, mason@transarc.com, jdp@transarc.com' 
Changed Responsible Engr. from `jdp@transarc.com' to `ota@transarc.com'

[9/22/92 public]
The manpage for salvage remains as it did at release of 1.0.1.  Nothing has
been done yet to update the documentation.  The above changes are still the
most reasonable alternative, but a number of people have expressed disgust
with the -nosalvage option.  We should probably revisit this, but I would
personally rather wait a couple of weeks until I have the time.  Does that
sound acceptable to all for now?

[9/22/92 public]
How about replacing "-nosalvage" in the above proposal with "-recoveronly"?

[1/25/94 public]
These suggestions have been superceded by reorganization of the command
options outlined in OT6814.  These changes have been made and so this
defect is no longer applicable.
Filled in Inter-dependent CRs with `6814' 
Changed Status from `open' to `cancel' 
Filled in Reported by Company's Ref. Number with `4977'



CR Number                     : 3579
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 9022
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : Link count errors develop: root can link/unlink dirs
Reported Date                 : 5/15/92
Found in Baseline             : 1.0.1
Found Date                    : 5/15/92
Severity                      : C
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : mason@transarc.com
Transarc Status               : open

[5/15/92 public]
The salvager reports link count errors on an aggregate that has been in
use for a while.  It isn't possible to say much about the circumstances.
This is what the errors look like:
    In volume fileset1 (avl #5)
      in anode (#4567)
	File's link count is 1 but should be 0
      in anode (#4572)
	File's link count is 1 but should be 0
      in anode (#4886)
	File's link count is 1 but should be 0
The message is saying that these files are not in any directory but the
anode has a link count of one.  I have tried pretty hard to think of a
scenario where the bug fixed by delta "bwl-ot3198-unlink-inactive" might
have caused this type of error but have been unsuccessful.  Bruce and I
have also done a some code reading this morning looking for error paths
that could lead to trouble like this.  These efforts have been
unsuccessful as well.  There is a good chance that the stat bug which
resulted in closing the device out from under Episode could cause
problems like this because Episode isn't very robust to I/O errors.
However, I am loath to write this off so cavalierly.
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `mason@transarc.com' 
Added field Transarc Status with value `open'

[6/12/92 public]
In examining the aggregate more carefully, the orphan files are newly
created directories.  This implies that there is an error path out of
mkdir that doesn't clean things up correctly.
The offending aggregate is in ~ota/de/salvage-data/ot3579.bad_linkcount.Z.

[6/23/92 public]
Further examiniation of the code paths out of mkdir didn't not reveal
any problems.  However, Bruce noticed that superuser does have access to
orphan directories and produce result that look like this.
A similar looking problem has been found associated with rename test17
in the pcts POSIX conformance suite.  Investigation revealed that that
test tries to clean up by unlinking "foo/.."  and "foo" (but not
"foo/.")  on exit from test17.  Thus each round of the pcts test was
leaving an orphaned directory behind.
Apparently it is traditional to allow superuser to link and unlink
directories.  This can easily and accidently lead to path inconsistency
problems that will cause fsck errors.  SunOS and BSD have this feature.
Interestingly JFS also supports the travesty only at the system call
level (the "ln" and "rm" commands will not allow directory targets under
any cirsumstances).  With only a little trouble we were able to panic
the AIX machine during a rename.  It seems that IBM must have found some
fairly good reason to preserve this functionality, but it doesn't get
used, or tested, very often.  From this I infer the existence of some
legacy program(s) of considerable importance to some customer(s).  I
have no idea of the identity of these programs.
Since I am rasher than IBM (indeed probably even Transarc is rasher than
IBM) I am inclined to disable this "feature" at the vnode level.  The
most flexible approach is to control this with a global variable that is
off by default.  If epistat is taught about this flag we can enable
superuser directory mangling on demand if necessary (or a desparate user
could enable it with adb in an emergency).  I have no intention of
documenting this, however, which is why epistat is a reasonable place to
put this escape hatch.  Let these legacy programs come to us!
Comments?
Changed Interest List CC from `wang@sni-usa.com' to `wang@sni-usa.com, 
 bwl@transarc.com, burnett@liz.austin.ibm.com' 
Changed Fix By Baseline from `1.0.1' to `1.0.2'

[6/23/92 public]
Just as you guessed Ted IBM supports this functionality because we found
customers that used it and wanted it.  Like you IBM wanted to take it
out, but did not because of the above.  However thanks for pointing
out the panic.  I will relay this on to our FS group so they can get
it fixed if it is not already fixed in a more recent release. As for 
Episode support of this I think at a minimum you should make it an optional
feature like you described earlier that can be turned on or off.
As for wether it should be the default functionality I can't say.  
What do the folks at OSF say?.  Since
we already know Sun, and BSD support it, what does OSF1 do.  And while
we are asking does any one know what the Veritas File System does?  The
bottom line is we should give the customers what they want.

[8/26/92 public]
As per Ted's request, this is reassigned to Bruce.
Changed Interest List CC from `wang@sni-usa.com, bwl@transarc.com, 
 burnett@liz.austin.ibm.com' to `wang@sni-usa.com, ota@transarc.com, 
 burnett@liz.austin.ibm.com' 
Changed Responsible Engr. from `ota@transarc.com' to `bwl@transarc.com'

[9/3/92 public]
Changed Short Description from `Link count errors develop' to `Link count 
 errors develop: root can unlink dirs'

[10/27/92 public]
 This problem deals with supporting non-POSIX semantics of
questionable value, especially in DFS where there is no concept of
"root" privs for unlinking directories.  As such, I'm marking this as
an enhancement request, not a defect.
Changed Defect or Enhancement? from `def' to `enh' 
Changed Interest List CC from `wang@sni-usa.com, ota@transarc.com, 
 burnett@liz.austin.ibm.com' to `wang@sni-usa.com, ota, 
 burnett@liz.austin.ibm.com'

[9/13/93 public]
I've opened this same defect in Transarc's defect database as DB 4305.
Changed Short Description from `Link count errors develop: root can unlink dirs' to `Link count errors develop: root can 
 link/unlink dirs' 
Filled in Reported by Company's Ref. Number with `4305'

[3/7/94 public]
Through an oversight a new defect, 9022, was created for the same bug, and
the fix was submitted under 9022.  OT does not allow us to dup 3579 to 9022,
so I am canceling 3579.
Filled in Inter-dependent CRs with `9022' 
Changed Status from `open' to `cancel'



CR Number                     : 3531
Defect or Enhancement?        : def
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cds
Subcomponent Name             : cdscp
Short Description             : The 'set directory to skulk' removes wrong softlinks.
Reported Date                 : 5/14/92
Found in Baseline             : 1.0
Found Date                    : 5/14/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : time_actions.c
Sensitivity                   : public

[5/14/92 public]

  The 'set directory to skulk' removes all non-permanent softlinks
  if their expiration time is within 5 hours of when the SKULK is issued.

Repeat By:

  Issue the following CDSCP commands:

--------------------------------------------------------------------------------------
-------------------------
cdscp> create directory /.:/test_dir
cdscp> create link /.:/test_dir/test_link CDS_LinkTarget = /.:/object
CDS_LinkTimeout
= (current time + 4hours)
cdscp> set directory /.:/test_dir to skulk
cdscp> list link /.:/test_dir/*


                        LIST
                    SOFTLINK  /.../c=ca/o=cell3/test_dir
                          AT   1992-05-06-15:49:09
cdscp>



--------------------------------------------------------------------------------------
-------------------------

Proposed Solution:

  CDS should not be deleting these non-permanent soft-links which have
  not yet expired.

[6/2/92 public]
The problem is that cdscp expects the expiration time to be entered in UTC.
It should assume that it is entered in local time and then convert to UTC.
So if your offset from UTC is +5 hours, any timeout less than that will
cause the link to be deleted when the directory is skulked.

[6/9/92 public]
cdscp now converts localtime to UTC, fixed and bsubmit'd, changing status
to "fix".

[6/15/92 public]
Tried test sequence, incorrect behavior persists.  Verified that
control/time_actions.c was successfully submitted.  Resetting status to
OPEN.

[8/4/92 public]
Is this problem occurring because OSF/1's localtime code is broken? If
this problem doesn't occur on AIX 3.2, I suggest that it be cancelled.

[10/12/92 public]

Changed platform to pmax/osf1.  Mark's comment above is correct, but this
remains a functional problem on the pmax reference platform.  Change to
defer.

[08/02/93 public]
This problem does not appear on either the 486 or hp platforms. Tested
both platforms after scratch installations.



CR Number                     : 3207
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 3207
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : rpc
Subcomponent Name             : 
Short Description             : rpc_ss_register_auth_info routine is not supported in DCE1.0, will it be supported in DCE1.0.1?
Reported Date                 : 5/2/92
Found in Baseline             : 1.0
Found Date                    : 5/2/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[5/2/92 public]


Full Description:

        No security on automatic binding;
        The rpc_ss_register_auth_info routine is not supported.
        It is therefore not possible to set authentication and
        authorization information for auto_handles and implicit
        binding handles in general.


	[The Application Development Guide, page 13-16, notes that 
	rpc_ss_register_auth_info is not supported in DCE RPC Version 1.0,
	if this won't be supported in DCE1.0.1 this note needs to be
	updated -  Martha DasSarma]

[5/7/92 public]

Full Description:
	rpc_ss_register_auth_info(3rpc) man page not found in includes or
	libdce.a. 

	Could not find rpc_ss_register_auth_info(3dfs) in the include
	files or in libdce.a.

	Which is correct, the man page or the code?

[10/16/92 public]
Changed code enginer to Mishkin.

[1/7/93 public]
Promoted to enhancement.

[07/20/93 public]
The answer to the question is NO.

Canceled.



CR Number                     : 3166
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : sec
Subcomponent Name             : secidmap
Short Description             : should take login handle rather than rgy_handle
Reported Date                 : 4/30/92
Found in Baseline             : 1.0.1
Found Date                    : 4/30/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/96]
cancel - addressed in DCE1.2.2.

[4/30/92 public]

There is a design botch in the secidmap interface, which results in
unnecessary calls to the name service in security clients.

Currently, the sec_id_parse_{name,group} calls are passed a registry
binding handle to identify the "first" registry to try.  The login context
is included implicitly (by being referenced from the registry binding
handle).

Constructing the registry binding handle is a moderately expensive
operation (you have to make name service calls to look up the address of
the registry server).  There will soon be a registry binding cache, so the
second and subsequent calls will be pretty "cheap", but the first one will
always be expensive.  Ideally, simple application programs should not have
to talk to the security service, or even ask the name service for the
location of the security service, if the needed tickets are already cached.

Given the existence of a name parsing cache, there is no reason to
construct the registry binding handle until *after* a cache miss has
occurred.. in most cases, there will be a cache hit in the name parsing
code, so the registry binding handle won't get used before it is closed.

To fix this, we'd have to add some new entry points to the secidmap
interface which take the new signature, and fix sec_authn.c and other
callers (like the CDS clerk) to use the new routines.



CR Number                     : 3102
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : dce_config is case sensitive with user input.
Reported Date                 : 4/28/92
Found in Baseline             : 1.0.1
Found Date                    : 4/28/92
Severity                      : D
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : 

[4/28/92 public]
dce_config should not be case sensitive with user input.  Specifically,
when dce_config asked "Should this machine be configured as a DFS client? (n)"
I answered with 'Y' and it took that to be no.  I am not sure of all
instances where the responses are case sensitive, but it should probably 
be cleaned up.

[4/28/92 public]
Marked as D2 enhancement.

[4/29/92 public]
Changed assignment to ``dce'' from ``dfs'' since it's a complaint about
dce_config.
Changed Component Name from `dfs' to `dce' 
Added field Transarc Deltas with value `' 
Added field Transarc Herder with value `' 
Added field Transarc Status with value `'

[08/20/93 public]
This isn't going to happen.  dce_config is consistant in its prompts
in that it always wants lower case.

Canceled.



CR Number                     : 3101
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : config
Short Description             : STOP option doesn't handle DFS
Reported Date                 : 4/28/92
Found in Baseline             : 1.0.1b12
Found Date                    : 4/28/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/28/92 public]
The dce.clean script needs to be extended to stop DFS daemons as 
well as the other DCE daemons.

[5/14/92 public]
The "START" option to dce_config also does not work for dfs.  The
rc.dfs startup file gets populated with startup commands by dce_config 
during the CONFIG step, but that file is not invoked from /etc/rc.dce
when the "START" option is selected.

[5/21/92 public]
May need to use bos commands in dce.clean since the fxd's are unkillable 
using kill.  It is unclear whether bos will be able to kill them either.

[8/3/93 public]
This was fixed as well as it's going to get fixed by HP drop.
Cancelling.



CR Number                     : 3024
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : bld
Subcomponent Name             : common Makefiles
Short Description             : export_all_EXPLIB and
export_all_EXPSHLIB do the same thing
Reported Date                 : 4/23/92
Found in Baseline             : 1.0.1
Found Date                    : 4/23/92
Severity                      : C
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/23/92 public]

The targets export_all_EXPLIB and export_all_EXPSHLIB both do the exact
same thing.  They both run the third pass with export_all.  This will
result in both static and shared libraries being built regaurdless of which
target was specified.

This can be solved by putting EXPSHLIB into it's own pass.

[4/24/92 public]
The export_all_EXPSHLIB pass, when run in a directory, only builds the 
EXPSHLIB_TARGETS for that directory, as opposed to the export_all_EXPLIB
pass, which will build all EXPLIB targets.  This is an important difference
in a subdirectory.  This is a clarificaton.  This is not to say that a 
seperate pass for EXPSHLIB is a bad thing.

[9/24/93 public]
Cancelling this.



CR Number                     : 2965
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : dce_config/dts
Short Description             : dce_config doesn't sync time
Reported Date                 : 4/21/92
Found in Baseline             : 1.0.1b12
Found Date                    : 4/21/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[4/21/92 public]

When configuring a client machine, dce_config attempts a dce_login
before it brings up DTS.  But if the clocks are out of sync, the
dce_login and subsequent operations in dce_config will fail.
Unfortunately, none of the error messages allude to any problem
with time, but that's just salt in the wound.

Do we really need to ask sys admins to do a manual time sync with
their security server before they can run dce_config?  That doesn't
seem reasonable.

[5/18/92 public]
Changed to enhancement.  This is reasonable for 1.0.1 and probably for 1.1
and beyond.

[03/28/94 public]
dce_config now checks the time on the security server and the client
before configuring security.  It will allow you to set the clock
if its too far off.

If you are not running DTS (or some other time control) on your
cell and the clocks drift, there isn't much besides manual 
intervention to solve this problem.

Bug Canceled.



CR Number                     : 2807
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dskl
Subcomponent Name             : diskless
Short Description             : Hard coded idl rules in diskless Makefiles
Reported Date                 : 4/16/92
Found in Baseline             : 1.0.1
Found Date                    : 4/16/92
Severity                      : C
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : ./diskless/dl_init/Makefile ./diskless/uninteg/dl_init/Makefile
Sensitivity                   : public

[4/16/92 public]

Two diskless Makefiles have hardcoded idl rules.  They should be removed in
order that the system rules for idl are used.
./diskless/dl_init/Makefile
./diskless/uninteg/dl_init/Makefile
.SUFFIXES: _cstub.c _caux.c _saux.c _sstub.c .idl
.idl.h:
        NLSPATH=$(IDL_NLSPATH) $(IDL) $< $(IDLFLAGS)
.idl_cstub.c:
        NLSPATH=$(IDL_NLSPATH) $(IDL) $< $(IDLFLAGS)
.idl_sstub.c:
        NLSPATH=$(IDL_NLSPATH) $(IDL) $< $(IDLFLAGS)
.idl_caux.c:
        NLSPATH=$(IDL_NLSPATH) $(IDL) $< $(IDLFLAGS)
.idl_saux.c:
        NLSPATH=$(IDL_NLSPATH) $(IDL) $< $(IDLFLAGS)

[04/17/92 public]
Changed cc from ratdce to dce-ot-bld.

[11/17/92 public]

Prior 1->4.

[5/25/94 public]
The diskless source has been defuncted from the tree.
OSF no longer supports diskless.
Canceled.



CR Number                     : 2781
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : all
S/W Ref Platform              : all
Component Name                : dskl
Subcomponent Name             : diskless
Short Description             : hardcoded path names in Makefiles
Reported Date                 : 4/15/92
Found in Baseline             : 1.0.1
Found Date                    : 4/15/92
Severity                      : B
Priority                      : 1
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : diskless/dl_init/Makefile
Sensitivity                   : public

[4/15/92 public]
The diskless/dl_init/Makefile has hardcoded absolute path names of the
following form:
IDLDIR         = /mnt/wigeon/root.port/sys.ncs.5/export/hppa/usr/bin
IDL_NLSPATH    = $(IDLDIR)/%N
KERNEL_ROOT = /mnt/dux/root.port/sys.scott/80kernel

and more....diskless will not build with these in...

[4/15/92 public]

Reassigned to diskless and Sussanna Wallace of HP.
Changed mckeen@osf.org to mckeen so he will get mail.

[04/17/92 public]
Changed CC from ratdce to dce-ot-bld.

[2/16/93 public]

Because neither OSF nor any of the providers are currently dependent on this
code, the priority is being lowered.

[5/25/94 public]
The diskless source has been defuncted from the tree.
OSF no longer supports diskless.
Canceled.



CR Number                     : 2549
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : dfs
Subcomponent Name             : lfs
Short Description             : osi dir shouldn't contain lock.[ch] files
Reported Date                 : 4/6/92
Found in Baseline             : 1.0.1
Found Date                    : 4/6/92
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Status               : open
Transarc Deltas               : mason-ot2549-deal-with-lock-package
Transarc Herder               : jaffe@transarc.com
Transarc Delta                : 

[4/6/92 public]
Locking stuff is handled by code in top-level osi layer only thread support is
in episode tools dir.

[7/20/92 public]
Changed "Fix by" to 1.0.2

[8/31/92 public]
Reassigned.

[9/18/92 public]
Since this currently works, it is not a defect but and enhancment.
The problem is that the Episode version of lock.c includes "thread.h", which
redefines osi_Thread calls in terms of LWP calls when out of the kernel.
I would suggest having all of episode use the CMA version of LWP, and then
remove thread.h, which defines OSI primatives as LWP, and let the DFS osi 
code use the correct normal CMA definitions.  This would then let episode 
use the correct version of lock.c (and lock.h)
The problem with this approach is that there are a number of user level
programs in episode which link with lwpdummy in order to avoid using CMA.
Since those programs link with code that uses lock.c, this code will now
need to be linked with libdce.a.
Changed Defect or Enhancement? from `def' to `enh' 
Filled in Interest List CC with `mason@transarc.com'

[9/21/92 public]
Changed Interest List CC from `mason@transarc.com' to `mason@transarc.com, 
 bwl@transarc.com'

[11/12/92 public]
Canceled by Tony's request.  It just does not seem like a necessary thing to 
do.
Changed Status from `open' to `cancel' 
Filled in Resp. Engr's Company with `tarc'

[11/13/92 public]
Actually, as it turns out it looks like this is only defuncting the file.
I'll handle it.
Changed Interest List CC from `mason@transarc.com, bwl@transarc.com' to `bwl' 
Changed Status from `cancel' to `open' 
Changed Responsible Engr. from `jaffe@transarc.com' to `mason@transarc.com'

[11/16/92 public]
 It appears that nobody uses lock.c except the Episode code.  This is
a straight-forward fix.
Filled in Transarc Deltas with `mason-ot2549-deal-with-lock-package'

[12/11/92 public]
Changed Transarc Status from `open' to `import'

[12/15/92 public]
Tony's change needs a lot more work.  This ain't ready for prime time yet.
Changed Transarc Status from `import' to `export'

[12/16/92 public]
Actually, this is a lot harder than it looks.
Furthermore, osi.h includes lock.h, which is, by measured expert
opinion, wrong.  Unfortunately, excising this little nested include is
non-trivial.
Changed Short Description from `tools dir shouldn't contain lock.[ch] files' to 
 `osi dir shouldn't contain lock.[ch] files' 
Changed Transarc Status from `export' to `open'

[12/17/92 public]
It may be a mistake to get involved with this but let me make a few
quick points.
1. Locking is an appropriate function of an osi layer to provide.
2. All of DFS uses the same conceptual model for locking, namely single
   writer, multiple readers.
3. All user space DFS code can now rely on a pthreads substrate for
   implementing osi_Sleep and osi_Wakeup.
Point 3 above means that lock can be implemented in terms of other osi
primitives in a OS and user/kernel independent fashion (i.e. no ifdefs).
The only problem is that standalone Episode must link against a LWP
implementation of pthreads which supports osi_Sleep/Wakeup.  There is
already support for doing this.  Other user space code already uses
whatever pthreads code it can find (native or CMA).
Thus I suggest that we leave this code here and reorganize things so we
can punt ncs_compat locking and move towards a real osi lock module.
This is not to disagree with MikeM that this is "non-trival", it is.

[11/15/93 public]
Changed Status from `open' to `cancel' 
Added field Transarc Delta with value `'



CR Number                     : 2350
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : pmax
S/W Ref Platform              : osf1
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : Use cdscp from server, not local
Reported Date                 : 3/20/92
Found in Baseline             : 1.0.1
Found Date                    : 3/20/92
Severity                      : B
Priority                      : 2
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/20/92 public]

The routines which add a host to a cell expect cdscp to be present on the
host being added.  According to the DCE packaging document, cdscp should
only be on systems which are licensed as Directory Servers.  Also, as much
of the initialization process should take place from within the existing
cell as possible, to minimize the amount of code and work required on the
new host.

Recommended Solution:  Change the procedure for adding hosts to a cell.
Have as much of the work, including putting the host into the cell
namespace, done from existing members of the cell.

This is not really a good solution.  One the reasons is that in the 
light of the explanation of why the OSF is not concerned with decoupling
the XDS interface from GDS is that function should not be concerned
with the packaging.  The other reason is that the cdscp command is also
in the Admin package which most vendors will be including the admin
commands in with the DCE Client package.  This is clearly spelled out in
the Licensing document.  Also the dce_config script will need to be 
rewritten to add the admin package and to install the correct pieces
with this install option.

[4/16/92 public]
To quote Brad:
I believe this is a non defect because it is not OSF's responsibility
for dce_config to reflect either the OSF packaging scheme or to make
vendor oriented/specific changes.

However, there will be a time in the future where we care about such
things.  For example, we have been told that venders would like all the
admin stuff that is needed to add a client machine to a cell to be able to
be done from one admin station.  Also this type of installation might have
to deal with the fact that dce will already be installed on the client
machine since it might have actually been shipped with the machine, like
and operating system.

[4/16/92 public]

I agree that it should be possible to configure a machine from a single
location.  Also in the licensing terms for DCE it is possible to ship
the "Admin" tools with the client package.  The only reason that I believe
a vendor would not do this is for a "teeny" client machine.  I also think
that the admin tools would be sold and shipped with the client but seperately
installable entities.

Also the install of a pre-loaded machine would parallel the above scenario.

[03/28/94 public]
This is a packaging issue, and as most vendors confgiure DCE with
their own sysadmin tool (smit for AIX, sam for HP-UX, etc), they can
solve these packaging problems on their own.

dce_config will not be redesigned to config a client from another host.

Bug canceled.



CR Number                     : 2186
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : rs6000
S/W Ref Platform              : aix
Component Name                : rpc
Subcomponent Name             : rdacl interface
Short Description             : acl clients forced to use server's language
Reported Date                 : 3/5/92
Found in Baseline             : 1.0
Found Date                    : 3/5/92
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[3/5/92 public]

the rdacl interface doesn't allow the acl client to specify the language
to use for converting internal acls into a printable format (ex. for cds
directories, "rwdtcia").  since the rdacl server is the process that deals
with message catalogues, all acl clients in a cell (for a given rdacl server)
are forced to use the same language that the rdacl server is using.

[3/5/92 public]

You're absolutely right.  It's something that should have been thought
of before, but since some components (secd) don't even use msg catalogs
for permissions yet, it'll be a little more complicated.  The OSF has
decided that Internationalization issues shall be deferred to DCE1.1,
and since this issue needs the time to be thought out (and proposed)
correctly, we'd like to defer this defect to DCE1.1.  None of the auth6
changes planned for DCE1.0.1 will preclude us from fixing the problem
in 1.1. Please lower the severity/priority from B2 as that does not
reflect the severity (and definitely not the priority) of the problem
for 1.0.1 and please change the status to 'defer' from 'open'.

[3/5/92 public]

oops.  changed sev/pri from B2 to D3.

[3/16/92 public]

Mike wasn't quite right - we did consider this before.  It was decided
at a DCE technical meeting at the OSF that there was no standard for
passing locale information over an RPC call.  Given this (and given
issues with threading) we decided to not worry about internationalization
of messages provided in RPCs.  I've reassigned this problem to DCE
instead of security since it is a general problem with the DCE that
has to be solved before action can be taken in the security component.

[03/28/94 public]

This is very old, is it still a valid problem?

Mike, please cancel this enhancement if it no longer is an issue.

[03/29/94 public]
I am cancelling this for two related reasons:
While in DCE 1.1 we do now have a way to send I18N characters around,(1)
for interoperability (reachability, really) there are certain fields in
certain parameters that by design we limit to the portable character set.(2)



CR Number                     : 1043
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : dfs
Subcomponent Name             : cmd processor
Short Description             : bos addadmin not displaying correct syntax
Reported Date                 : 08/26/91
Found in Baseline             : .56e
Found Date                    : 
Severity                      : E
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.0.3
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public
Transarc Deltas               : 
Transarc Herder               : 
Transarc Status               : open

[01/29/92 public]
Orbit reference number 2726
reference     
product
phaseFound    development
History:
lastUpdate    91/11/12 15:32:15
endDate                                
assignDate    91/08/26 14:09:57   
    addDate              action          userLogin (userName)
    -------------------- --------------- ----------------------------------
    91/08/26 14:09:58    create          pehkonen (J. Pehkonen)
    91/09/23 13:31:52    note            hirsch (Phil Hirsch)
    91/10/07 16:08:03    note            pehkonen (J. Pehkonen)
    91/10/08 07:01:41    note            hirsch (Phil Hirsch)
    91/11/05 16:06:31    modify          drb (Defect Review Board)
    91/11/06 10:29:10    note            dstokes (D. Stokes)
    91/11/06 11:22:21    modify          drb (Defect Review Board)
    91/11/06 11:43:32    note            liz (Liz Hughes)
    91/11/12 15:32:15    modify          drb (Defect Review Board)

[08/26/91 public]
The syntax being shown for bos addadmin is incorrect. Executing "bos addadmin -help" shows the following:
bos addadmin -server <machine> -adminlist <filename> [-user <user_name>...] 
 [-group <group_name>...] [-createlist] [-noauth] [-localauth] [-help]
but if you execute "bos addadmin -server <machine> -adminlist <filename>" an
error is returned "bos: Error: no users or groups specified"
It appears either the -user or -group is a required parameter.
This is the AFS5.6 drop (dce.56e).

[09/23/91 public]
This is a limitation of the DFS command parser. The truth of the matter is
that you must specify at least one of -user, -group, or -createlist, but
you're welcome to specify more than one of the three as well. That is, bos
addadmin junior admin.bos -createlist is legal, as is bos addadmin junior
admin.bos -user pdh -createlist and bos addadmin junior admin.bos -user pdh,
but ``bos addadmin junior admin.bos'' by itself is illegal (what would it
do?).

[10/07/91 public]
I understand that one of -user, -group, or -createlist is needed but doing -help
does not show that. It shows it as an unrequired option.  bos addadmin -help 
should be something like this:
bos addadmin -server <machine> -adminlist <filename> { -user <name> | -group
<name> | -createlist} [-noauth] [-localauth] [-help]

[10/08/91 public]
The syntax you suggest would limit the user to choosing exactly one of
the three switches; we'd like to allow more than one to be specified on
the same command line. Unfortunately, our command parser can't do that -
there's no way to say "the user must choose one or more of these options".
The current help message is a compromise, I admit, but it's the best we
can do given our current command parser.

[11/06/91 public]
Transarc would like
to see this defect changed to deferred:
From: Julie_Kownacki@transarc.com:
  The bos addadmin requires that one of three arguments be present.
  Our help messages mark arguments as either being required, or optional.
  (Optional ones are enclosed by brackets.)  Since the help syntax has
  no notion of 'one of several arguments is required', the three arguments
  in question are marked as optional.  The full documentation explains
  that you need to specify one of them.
  The amount of work involved in defining additional syntax for the
  help message and making major changes to the command parser is not
  justified at this time.  The benefit is just too small to warrant that
  amount of work.  We therefore propose that this bug be deferred past
  the DCE 1.0 delivery.

[11/06/91 public]
The IBM dfs team agrees that this defect can be deferred.

[11/12/91 public]
This defect has been marked 'deferred' (do not fix in 1.0) by the DRBoard.  Reason:
As long as the man page is clear, this is too much work for limited gain.

[03/19/92 public]
The complaint is a small detail about the automatically-generated syntax
summary, in a case in which the abstractions of the command-line parser
cannot handle the real constraints of the command.  There are plenty of
such situations in DFS's user-level commands for all kinds of arcane
constraints (e.g. can't use parameter A unless parameter B or parameter C
is given) that [1] don't have a conventional, widely-understood notation in
command-line strings, and [2] don't have an explicit representation in the
abstractions of our command-line parser.  I would recommend deferring the
problem indefinitely.

[4/9/92 public]
Updated transarc status.

[4/15/92 public]
Trying to reflect ``indefinite deferral'' in the severity ranking.
Changed Severity from `D' to `E'

[7/16/92 public]
Mark as an enhancement request
Changed Defect or Enhancement? from `def' to `enh' 
Filled in Subcomponent Name with `cmd processor'

[7/20/92 public]
Changed "Fix by" to 1.0.2

[9/2/92 public]
Could we cancel this, please?
We'll never express all the odd inter-dependencies in the command processor
to make the usage line look just the way it does in the man page.

[8/5/93 public]
Changed Status from `open' to `cancel'



CR Number                     : 791
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : cds
Subcomponent Name             : 
Short Description             : consider changing the name of prs to something else (cdsprs) to
Reported Date                 : 06/20/91
Found in Baseline             : 1.0
Found Date                    : 
Severity                      : D
Priority                      : 4
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[01/29/92 public]

Orbit reference number 2094
reference     
product       dce_osf
phaseFound    development

History:
lastUpdate    91/11/18 08:59:59
endDate                                
assignDate    91/06/20 16:28:58   





    addDate              action          userLogin (userName)
    -------------------- --------------- ----------------------------------
    91/06/20 16:28:58    create          leban (Dick Leban)
    91/08/08 14:48:42    modify          leban (Dick Leban)
    91/08/08 16:57:13    modify          leban (Dick Leban)
    91/10/23 17:29:35    modify          drb (Defect Review Board)
    91/11/18 08:59:59    modify          leban (Dick Leban)

    pref name   compName                  originLogin     duplicate answer
    ---- ------ ------------------------- --------------- --------- ----------
    exte 003226 naming.local.src          page            000002094 duplicate

[06/20/91 public]
consider changing the name of prs to something else (cdsprs) to avoid silly conflicts with sccs tools

[3/19/92 public]
Taken off the front burner, changed to enhancement and defer.

[3/18/94 public]
Changing it caused other sillier but more harmful conficts.



CR Number                     : 584
Defect or Enhancement?        : enh
CR in Code, Doc, or Test?     : code
Inter-dependent CRs           : 
Project Name                  : dce
H/W Ref Platform              : other
S/W Ref Platform              : other
Component Name                : cfg
Subcomponent Name             : dce_config
Short Description             : dce_config should use test, not ls, for portability
Reported Date                 : 01/09/92
Found in Baseline             : .75e
Found Date                    : 
Severity                      : D
Priority                      : 3
Status                        : cancel
Duplicate Of                  : 
Fix By Baseline               : 1.1
Fixed In Baseline             : 
Affected File(s)              : 
Sensitivity                   : public

[01/29/92 public]

Orbit reference number 4488
reference     
product       dce_osf
phaseFound    development

History:
lastUpdate    92/01/09 15:09:45
endDate                                
assignDate    92/01/09 15:09:45   





    addDate              action          userLogin (userName)
    -------------------- --------------- ----------------------------------
    92/01/09 15:09:46    create          kwalker (Ken Walker)

[01/09/92 public]
There are several places in dce_config where ls is used to check for the 
existance of a file or directory.  DEC has pointed out that this may be a
portability problem (ls is not guaranteed to return $? != 0 if the file or
directory is not found?).  They suggest using test instead.

[4/7/92 public]
I changed this to severity D.  At first look it may seem easy to do but it
turns out that ls is used when softlinks are involved, and I don't know of
a "portable" argument to test that checks for the existence of softlinks.
-L works on at least some machines.

[5/27/92 public]
changed to enhancement as it seems to work on all reference platforms.

[08/20/93 public]
Per POSIX.2, ls will return a non-zero error return if a file is not
found.  Plus, this defect has been around longer than the hills and
it is not going to get done.

Canceled.



