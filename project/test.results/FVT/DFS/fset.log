[1] (0:00) --- The test is starting on Tue Nov 12 14:17:46 1996
[1] (0:00) [*] Inserting variable  itlu_CheckResult
[1] (0:00) [*] Inserting variable ITL_Status
[1] (0:00) [*] Inserting variable UKNOWN_ERROR
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[-1]
[1] (0:00) [*] Inserting variable EPERM
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[1]
[1] (0:00) [*] Inserting variable ENOENT
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[2]
[1] (0:00) [*] Inserting variable ESRCH
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[3]
[1] (0:00) [*] Inserting variable EINTR
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[4]
[1] (0:00) [*] Inserting variable EIO
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[5]
[1] (0:00) [*] Inserting variable ENXIO
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[6]
[1] (0:00) [*] Inserting variable E2BIG
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[7]
[1] (0:00) [*] Inserting variable ENOEXEC
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[8]
[1] (0:00) [*] Inserting variable EBADF
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[9]
[1] (0:00) [*] Inserting variable ECHILD
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[10]
[1] (0:00) [*] Inserting variable EAGAIN
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[11]
[1] (0:00) [*] Inserting variable ENOMEM
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[12]
[1] (0:00) [*] Inserting variable EACCES
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[13]
[1] (0:00) [*] Inserting variable EFAULT
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[14]
[1] (0:00) [*] Inserting variable ENOTBLK
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[15]
[1] (0:00) [*] Inserting variable EBUSY
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[16]
[1] (0:00) [*] Inserting variable EEXIST
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[17]
[1] (0:00) [*] Inserting variable EXDEV
[1] (0:00) [*] Inserting variable itlu_error_code_to_name[18]
[1] (0:00) [*] Inserting variable ENODEV
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[19]
[1] (0:01) [*] Inserting variable ENOTDIR
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[20]
[1] (0:01) [*] Inserting variable EISDIR
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[21]
[1] (0:01) [*] Inserting variable EINVAL
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[22]
[1] (0:01) [*] Inserting variable ENFILE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[23]
[1] (0:01) [*] Inserting variable EMFILE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[24]
[1] (0:01) [*] Inserting variable ENOTTY
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[25]
[1] (0:01) [*] Inserting variable ETXTBSY
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[26]
[1] (0:01) [*] Inserting variable EFBIG
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[27]
[1] (0:01) [*] Inserting variable ENOSPC
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[28]
[1] (0:01) [*] Inserting variable ESPIPE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[29]
[1] (0:01) [*] Inserting variable EROFS
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[30]
[1] (0:01) [*] Inserting variable EMLINK
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[31]
[1] (0:01) [*] Inserting variable EPIPE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[32]
[1] (0:01) [*] Inserting variable EDOM
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[33]
[1] (0:01) [*] Inserting variable ERANGE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[34]
[1] (0:01) [*] Inserting variable ENOMSG
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[35]
[1] (0:01) [*] Inserting variable EIDRM
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[36]
[1] (0:01) [*] Inserting variable EDEADLK
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[45]
[1] (0:01) [*] Inserting variable ENOLCK
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[49]
[1] (0:01) [*] Inserting variable ESTALE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[52]
[1] (0:01) [*] Inserting variable EINPROGRESS
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[55]
[1] (0:01) [*] Inserting variable EALREADY
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[56]
[1] (0:01) [*] Inserting variable ENOTSOCK
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[57]
[1] (0:01) [*] Inserting variable EDESTADDRREQ
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[58]
[1] (0:01) [*] Inserting variable EMSGSIZE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[59]
[1] (0:01) [*] Inserting variable EPROTOTYPE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[60]
[1] (0:01) [*] Inserting variable ENOPROTOOPT
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[61]
[1] (0:01) [*] Inserting variable EPROTONOSUPPORT
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[62]
[1] (0:01) [*] Inserting variable ESOCKTNOSUPPORT
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[63]
[1] (0:01) [*] Inserting variable EOPNOTSUPP
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[64]
[1] (0:01) [*] Inserting variable EPFNOSUPPORT
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[65]
[1] (0:01) [*] Inserting variable EAFNOSUPPORT
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[66]
[1] (0:01) [*] Inserting variable EADDRINUSE
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[67]
[1] (0:01) [*] Inserting variable EADDRNOTAVAIL
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[68]
[1] (0:01) [*] Inserting variable ENETDOWN
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[69]
[1] (0:01) [*] Inserting variable ENETUNREACH
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[70]
[1] (0:01) [*] Inserting variable ENETRESET
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[71]
[1] (0:01) [*] Inserting variable ECONNABORTED
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[72]
[1] (0:01) [*] Inserting variable ECONNRESET
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[73]
[1] (0:01) [*] Inserting variable ENOBUFS
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[74]
[1] (0:01) [*] Inserting variable EISCONN
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[75]
[1] (0:01) [*] Inserting variable ENOTCONN
[1] (0:01) [*] Inserting variable itlu_error_code_to_name[76]
[1] (0:01) [*] Inserting variable ESHUTDOWN
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[77]
[1] (0:02) [*] Inserting variable ETIMEDOUT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[78]
[1] (0:02) [*] Inserting variable ECONNREFUSED
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[79]
[1] (0:02) [*] Inserting variable EHOSTDOWN
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[80]
[1] (0:02) [*] Inserting variable EHOSTUNREACH
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[81]
[1] (0:02) [*] Inserting variable EPROCLIM
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[83]
[1] (0:02) [*] Inserting variable EUSERS
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[84]
[1] (0:02) [*] Inserting variable ELOOP
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[85]
[1] (0:02) [*] Inserting variable ENAMETOOLONG
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[86]
[1] (0:02) [*] Inserting variable EDQUOT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[88]
[1] (0:02) [*] Inserting variable EREMOTE
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[93]
[1] (0:02) [*] Inserting variable ENOSYS
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[109]
[1] (0:02) [*] Inserting variable EMEDIA
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[110]
[1] (0:02) [*] Inserting variable ESOFT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[111]
[1] (0:02) [*] Inserting variable ETOOMANYREFS
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[115]
[1] (0:02) [*] Inserting variable ENOSR
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[118]
[1] (0:02) [*] Inserting variable ETIME
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[119]
[1] (0:02) [*] Inserting variable EBADMSG
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[120]
[1] (0:02) [*] Inserting variable EPROTO
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[121]
[1] (0:02) [*] Inserting variable ENODATA
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[122]
[1] (0:02) [*] Inserting variable ENOSTR
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[123]
[1] (0:02) [*] Inserting variable EWOULDBLOCK
[1] (0:02) [*] Inserting variable ENOTEMPTY
[1] (0:02) [*] Inserting variable ERESTART
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[82]
[1] (0:02) [*] Inserting variable ESAD
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[113]
[1] (0:02) [*] Inserting variable ENOTRUST
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[114]
[1] (0:02) [*] Inserting variable ECANCELED
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[117]
[1] (0:02) [*] Inserting variable EWRPROTECT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[47]
[1] (0:02) [*] Inserting variable ENOCONNECT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[50]
[1] (0:02) [*] Inserting variable ECLONEME
[1] (0:02) [*] Inserting variable BOMB_E_MALFORMED_BOMB_POINT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[545394689]
[1] (0:02) [*] Inserting variable BOMB_E_BOMB_POINT_NOT_SET
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[545394690]
[1] (0:02) [*] Inserting variable BOMB_E_NAME_TOO_LONG
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[545394691]
[1] (0:02) [*] Inserting variable BOMB_E_BAD_EXPLOSION_TYPE
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[545394692]
[1] (0:02) [*] Inserting variable BOMB_E_BAD_TRIGGER_TYPE
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[545394693]
[1] (0:02) [*] Inserting variable FTU_E_ALREADY_ATTACHED
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833793]
[1] (0:02) [*] Inserting variable FTU_E_NOT_ATTACHED
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833795]
[1] (0:02) [*] Inserting variable FTU_E_TRY_RECOVERY
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833796]
[1] (0:02) [*] Inserting variable FTU_E_LOCAL_MOUNT
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833797]
[1] (0:02) [*] Inserting variable FTU_E_NO_BACKING_FSET
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833798]
[1] (0:02) [*] Inserting variable FTU_E_NO_SUCH_FSET
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833799]
[1] (0:02) [*] Inserting variable FTU_E_BAD_DUMP
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833811]
[1] (0:02) [*] Inserting variable FTU_E_DISJOINT_DATE
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833813]
[1] (0:02) [*] Inserting variable FTU_E_DISJOINT_VERSION
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833814]
[1] (0:02) [*] Inserting variable FTU_E_RETROGRADE_DATE
[1] (0:02) [*] Inserting variable itlu_error_code_to_name[572833815]
[1] (0:02) [*] Inserting variable FTU_E_RETROGRADE_VERSION
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833816]
[1] (0:03) [*] Inserting variable FTU_E_NAME_TOO_LONG
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833800]
[1] (0:03) [*] Inserting variable FTU_E_ID_CLASH
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833801]
[1] (0:03) [*] Inserting variable FTU_E_NAME_CLASH
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833802]
[1] (0:03) [*] Inserting variable FTU_E_MALFORMED_FSET_ID
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833803]
[1] (0:03) [*] Inserting variable FTU_E_NO_MEMORY
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833812]
[1] (0:03) [*] Inserting variable FTU_E_ATTACHED
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833804]
[1] (0:03) [*] Inserting variable FTU_E_CANT_FIND_CHARACTER_DEVICE
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833806]
[1] (0:03) [*] Inserting variable FTU_E_DEVICE_LOCKED
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833807]
[1] (0:03) [*] Inserting variable FTU_E_NOT_A_BLOCK_DEVICE
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833808]
[1] (0:03) [*] Inserting variable FTU_E_NOT_A_CHARACTER_DEVICE
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833809]
[1] (0:03) [*] Inserting variable FTU_E_NOT_A_DEVICE
[1] (0:03) [*] Inserting variable itlu_error_code_to_name[572833810]
[1] (0:03) [*] Inserting variable F_RDLCK
[1] (0:03) [*] Inserting variable F_WRLCK
[1] (0:03) [*] Inserting variable F_UNLCK
[1] (0:03) [*] Inserting variable O_APPEND
[1] (0:03) [*] Inserting variable O_CREAT
[1] (0:03) [*] Inserting variable O_DEFER
[1] (0:03) [*] Inserting variable O_EXCL
[1] (0:03) [*] Inserting variable O_NDELAY
[1] (0:03) [*] Inserting variable O_NOCTTY
[1] (0:03) [*] Inserting variable O_NONBLOCK
[1] (0:03) [*] Inserting variable O_RDONLY
[1] (0:03) [*] Inserting variable O_RDWR
[1] (0:03) [*] Inserting variable O_SYNC
[1] (0:03) [*] Inserting variable O_TRUNC
[1] (0:03) [*] Inserting variable O_WRONLY
[1] (0:03) [*] Inserting variable O_DELAY
[1] (0:03) [*] Inserting variable O_EXEC
[1] (0:03) [*] Inserting variable O_NONE
[1] (0:03) [*] Inserting variable O_NSHARE
[1] (0:03) [*] Inserting variable O_RSHARE
[1] (0:03) [*] Inserting variable F_DUPFD
[1] (0:03) [*] Inserting variable F_GETFD
[1] (0:03) [*] Inserting variable F_SETFD
[1] (0:03) [*] Inserting variable F_GETFL
[1] (0:03) [*] Inserting variable F_SETFL
[1] (0:03) [*] Inserting variable F_GETOWN
[1] (0:03) [*] Inserting variable F_SETOWN
[1] (0:03) [*] Inserting variable F_GETLK
[1] (0:03) [*] Inserting variable F_SETLK
[1] (0:03) [*] Inserting variable F_SETLKW
[1] (0:03) [*] Inserting variable F_CLOSEM
[1] (0:03) [*] Inserting variable FAPPEND
[1] (0:03) [*] Inserting variable FNDELAY
[1] (0:03) [*] Inserting variable FNONBLOCK
[1] (0:03) [*] Inserting variable FSYNC
[1] (0:03) [*] Inserting variable FASYNC
[1] (0:03) [*] Inserting variable FD_CLOEXEC
[1] (0:03) [*] Inserting variable LOCK_SH
[1] (0:03) [*] Inserting variable LOCK_EX
[1] (0:03) [*] Inserting variable LOCK_NB
[1] (0:03) [*] Inserting variable LOCK_UN
[1] (0:03) [*] Inserting variable GET_FSIZE
[1] (0:03) [*] Inserting variable SET_FSIZE
[1] (0:03) [*] Inserting variable SEEK_SET
[1] (0:03) [*] Inserting variable SEEK_CUR
[1] (0:03) [*] Inserting variable SEEK_END
[1] (0:03) [*] Inserting variable S_ISUID
[1] (0:03) [*] Inserting variable S_ISGID
[1] (0:03) [*] Inserting variable S_ISVTX
[1] (0:03) [*] Inserting variable S_ENFMT
[1] (0:03) [*] Inserting variable S_IRUSR
[1] (0:03) [*] Inserting variable S_IWUSR
[1] (0:03) [*] Inserting variable S_IXUSR
[1] (0:03) [*] Inserting variable S_IRGRP
[1] (0:03) [*] Inserting variable S_IWGRP
[1] (0:03) [*] Inserting variable S_IXGRP
[1] (0:03) [*] Inserting variable S_IROTH
[1] (0:03) [*] Inserting variable S_IWOTH
[1] (0:04) [*] Inserting variable S_IXOTH
[1] (0:04) [*] Inserting variable S_IRWXO
[1] (0:04) [*] Inserting variable S_IFDIR
[1] (0:04) [*] Inserting variable S_IFCHR
[1] (0:04) [*] Inserting variable S_IFBLK
[1] (0:04) [*] Inserting variable S_IFREG
[1] (0:04) [*] Inserting variable S_IFLNK
[1] (0:04) [*] Inserting variable S_IFSOCK
[1] (0:04) [*] Inserting variable S_IFIFO
[1] (0:04) [*] Inserting variable R_ACC
[1] (0:04) [*] Inserting variable W_ACC
[1] (0:04) [*] Inserting variable X_ACC
[1] (0:04) [*] Inserting variable E_ACC
[1] (0:04) [*] Inserting variable NO_ACC
[1] (0:04) [*] Inserting variable R_OK
[1] (0:04) [*] Inserting variable W_OK
[1] (0:04) [*] Inserting variable X_OK
[1] (0:04) [*] Inserting variable F_OK
[1] (0:04) [*] Inserting variable PROT_NONE
[1] (0:04) [*] Inserting variable PROT_READ
[1] (0:04) [*] Inserting variable PROT_WRITE
[1] (0:04) [*] Inserting variable PROT_EXEC
[1] (0:04) [*] Inserting variable MAP_SHARED
[1] (0:04) [*] Inserting variable MAP_PRIVATE
[1] (0:04) [*] Inserting variable MAP_FILE
[1] (0:04) [*] Inserting variable MAP_ANONYMOUS
[1] (0:04) [*] Inserting variable MAP_TYPE
[1] (0:04) [*] Inserting variable MAP_FIXED
[1] (0:04) [*] Inserting variable MAP_VARIABLE
[1] (0:04) [*] Inserting variable MS_ASYNC
[1] (0:04) [*] Inserting variable MS_SYNC
[1] (0:04) [*] Inserting variable MS_INVALIDATE
[1] (0:04) [*] Inserting variable MSEM_UNLOCKED
[1] (0:04) [*] Inserting variable MSEM_LOCKED
[1] (0:04) [*] Inserting variable MSEM_IF_NOWAIT
[1] (0:04) [*] Inserting variable MSEM_IF_WAITERS
[1] (0:04) [*] Inserting variable SIGALRM
[1] (0:04) [*] Inserting variable SIGUSR1
[1] (0:04) [*] Inserting variable SIGUSR2
[1] (0:04) [*] Inserting variable SA_ONSTACK
[1] (0:04) [*] Inserting variable SA_RESTART
[1] (0:04) [*] Inserting variable SV_INTERRUPT
[1] (0:04) [*] Inserting variable SV_ONSTACK
[1] (0:04) [*] Opening the file scripts/all_tests.itl
[1] (0:04) [*] Inserting variable CurrentFile
[1] (0:04) --- *(1): *
[1] (0:04) --- *(1): * @OSF_COPYRIGHT@
[1] (0:04) --- *(1): * COPYRIGHT NOTICE
[1] (0:04) --- *(1): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (0:04) --- *(1): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (0:04) --- *(1): * src directory for the full copyright text.
[1] (0:04) --- *(1): *
[1] (0:04) --- *(1): * HISTORY
[1] (0:04) --- *(1): * $Log: all_tests.itl,v $
[1] (0:05) --- *(1): * Revision 1.1.2.4  1993/02/16  16:26:22  jaffe
[1] (0:05) --- *(1): * 	Transarc delta: jdp-db3072-aggregate-interlocking 1.2
[1] (0:05) --- *(1): * 	  Selected comments:
[1] (0:05) --- *(1): * 	    This delta implements an interlocking feature that keeps
[1] (0:05) --- *(1): * 	    administrative commands like salvage and newaggr from stomping on an
[1] (0:05) --- *(1): * 	    attached (or mounted) fileset.  Two new primitives,
[1] (0:05) --- *(1): * 	    ftu_LockAggrDevice() and ftu_UnlockAggrDevice(), are provided by the
[1] (0:06) --- *(1): * 	    ftutil library and are used in both newaggr and salvage.
[1] (0:06) --- *(1): * 	    Two new test cases were added to the fset (ftutil) tests suite.  The first,
[1] (0:06) --- *(1): * 	    lock00.itl, tests the primitives directly. The second, lock01.itl, tests
[1] (0:06) --- *(1): * 	    interaction with newaggr and salvage for both attached aggregates and
[1] (0:06) --- *(1): * 	    mounted filesets.
[1] (0:06) --- *(1): * 	    Include "lock.itl".
[1] (0:06) --- *(1): * 	    Fix things up for OSF/1.
[1] (0:06) --- *(1): * 	[1993/02/15  19:24:38  jaffe]
[1] (0:06) --- *(1): *
[1] (0:06) --- *(1): * Revision 1.1.2.3  1993/01/11  18:27:22  htf
[1] (0:06) --- *(1): * 	Embedded copyright notice
[1] (0:06) --- *(1): * 	[1993/01/11  17:01:46  htf]
[1] (0:06) --- *(1): * 
[1] (0:07) --- *(1): * Revision 1.1.2.2  1992/10/28  16:23:22  jaffe
[1] (0:07) --- *(1): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (0:07) --- *(1): * 	  Selected comments:
[1] (0:07) --- *(1): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (0:07) --- *(1): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (0:07) --- *(1): * 	    and adds all of the test scripts.
[1] (0:07) --- *(1): * 	    Run all of the ftutil tests.
[1] (0:07) --- *(1): * 	[1992/10/27  18:43:20  jaffe]
[1] (0:07) --- *(1): * 
[1] (0:07) --- *(1): * $EndLog$
[1] (0:07) --- *(1): *
[1] (0:07) --- *(1): 
[1] (0:07) --- *(1): *include "create00.itl"
[1] (0:07) --- *(1): 
[1] (0:07) --- *(1): *include "setstatus00.itl"
[1] (0:07) --- *(1): 
[1] (0:07) --- *(1): include "clone.itl"
[1] (0:08) [*] Opening the file clone.itl
[1] (0:08) [*] Trying to open the file scripts/clone.itl
[1] (0:08) --- *(2): *
[1] (0:08) --- *(2): * @OSF_COPYRIGHT@
[1] (0:08) --- *(2): * COPYRIGHT NOTICE
[1] (0:08) --- *(2): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (0:08) --- *(2): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (0:08) --- *(2): * src directory for the full copyright text.
[1] (0:08) --- *(2): *
[1] (0:08) --- *(2): * HISTORY
[1] (0:08) --- *(2): * $Log: clone.itl,v $
[1] (0:08) --- *(2): * Revision 1.1.2.3  1993/01/11  18:27:23  htf
[1] (0:08) --- *(2): * 	Embedded copyright notice
[1] (0:08) --- *(2): * 	[1993/01/11  17:01:50  htf]
[1] (0:08) --- *(2): *
[1] (0:08) --- *(2): * Revision 1.1.2.2  1992/10/28  16:23:28  jaffe
[1] (0:09) --- *(2): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (0:09) --- *(2): * 	  Selected comments:
[1] (0:09) --- *(2): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (0:09) --- *(2): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (0:09) --- *(2): * 	    and adds all of the test scripts.
[1] (0:09) --- *(2): * 	    Run all of the clone tests.
[1] (0:09) --- *(2): * 	[1992/10/27  18:45:08  jaffe]
[1] (0:09) --- *(2): * 
[1] (0:09) --- *(2): * $EndLog$
[1] (0:09) --- *(2): *
[1] (0:09) --- *(2): 
[1] (0:10) --- *(2): include "clone00.itl"
[1] (0:10) [*] Opening the file clone00.itl
[1] (0:10) [*] Trying to open the file scripts/clone00.itl
[1] (0:10) --- *(3): *
[1] (0:10) --- *(3): * @OSF_COPYRIGHT@
[1] (0:10) --- *(3): * COPYRIGHT NOTICE
[1] (0:10) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (0:10) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (0:10) --- *(3): * src directory for the full copyright text.
[1] (0:10) --- *(3): *
[1] (0:10) --- *(3): * HISTORY
[1] (0:10) --- *(3): * $Log: clone00.itl,v $
[1] (0:14) --- *(3): * Revision 1.1.406.1  1994/02/04  20:41:03  devsrc
[1] (0:14) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (0:14) --- *(3): * 	[1994/02/04  15:22:40  devsrc]
[1] (0:14) --- *(3): *
[1] (0:15) --- *(3): * Revision 1.1.404.1  1993/12/07  17:42:05  jaffe
[1] (0:15) --- *(3): * 	1.0.3a update from Transarc
[1] (0:15) --- *(3): * 	[1993/12/03  18:55:42  jaffe]
[1] (0:15) --- *(3): * 
[1] (0:15) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:25  htf
[1] (0:15) --- *(3): * 	Embedded copyright notice
[1] (0:15) --- *(3): * 	[1993/01/11  17:01:55  htf]
[1] (0:15) --- *(3): * 
[1] (0:15) --- *(3): * Revision 1.1.2.2  1992/10/28  16:23:35  jaffe
[1] (0:15) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (0:15) --- *(3): * 	  Selected comments:
[1] (0:15) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (0:16) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (0:16) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (0:16) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (0:16) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (0:16) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (0:16) --- *(3): * 	    last argument to the command.
[1] (0:17) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (0:17) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (0:17) --- *(3): * 	    variable by the open and opendir comands.
[1] (0:17) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (0:17) --- *(3): * 	    described above.
[1] (0:17) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (0:17) --- *(3): * 	    Cleanup debugging code.
[1] (0:17) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (0:17) --- *(3): * 	  Selected comments:
[1] (0:18) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (0:18) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (0:18) --- *(3): * 	    and adds all of the test scripts.
[1] (0:18) --- *(3): * 	    Clone test.
[1] (0:18) --- *(3): * 	[1992/10/27  18:46:34  jaffe]
[1] (0:18) --- *(3): * 
[1] (0:18) --- *(3): * $EndLog$
[1] (0:18) --- *(3): *
[1] (0:18) --- *(3): 
[1] (0:18) --- *(3): !**********************************************************
[1] (0:18) --- !**********************************************************
[1] (0:18) --- *(3): !*** Clone a fileset
[1] (0:18) --- !*** Clone a fileset
[1] (0:18) --- *(3): !**********************************************************
[1] (0:18) --- !**********************************************************
[1] (0:18) --- *(3): 
[1] (0:18) --- *(3): include "setup.itl"
[1] (0:18) [*] Opening the file setup.itl
[1] (0:18) [*] Trying to open the file scripts/setup.itl
[1] (0:18) --- *(4): *
[1] (0:18) --- *(4): * @OSF_COPYRIGHT@
[1] (0:19) --- *(4): * COPYRIGHT NOTICE
[1] (0:19) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (0:19) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (0:19) --- *(4): * src directory for the full copyright text.
[1] (0:19) --- *(4): *
[1] (0:19) --- *(4): * HISTORY
[1] (0:19) --- *(4): * $Log: setup.itl,v $
[1] (0:19) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (0:19) --- *(4): * 	Embedded copyright notice
[1] (0:19) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (0:19) --- *(4): *
[1] (0:19) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (0:19) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (0:19) --- *(4): * 	  Selected comments:
[1] (0:20) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (0:20) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (0:20) --- *(4): * 	    and adds all of the test scripts.
[1] (0:20) --- *(4): * 	    Setup for a test case.
[1] (0:20) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (0:20) --- *(4): * 
[1] (0:20) --- *(4): * $EndLog$
[1] (0:20) --- *(4): *
[1] (0:20) --- *(4): 
[1] (0:20) --- *(4): include "defaults.itl"
[1] (0:20) [*] Opening the file defaults.itl
[1] (0:20) [*] Trying to open the file scripts/defaults.itl
[1] (0:20) --- *(5): *
[1] (0:20) --- *(5): * @OSF_COPYRIGHT@
[1] (0:20) --- *(5): * COPYRIGHT NOTICE
[1] (0:20) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (0:21) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (0:21) --- *(5): * src directory for the full copyright text.
[1] (0:21) --- *(5): *
[1] (0:21) --- *(5): * HISTORY
[1] (0:21) --- *(5): * $Log: defaults.itl,v $
[1] (0:21) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (0:21) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (0:21) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (0:21) --- *(5): *
[1] (0:21) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (0:21) --- *(5): * 	1.0.3a update from Transarc
[1] (0:21) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (0:21) --- *(5): * 
[1] (0:21) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (0:21) --- *(5): * 	Embedded copyright notice
[1] (0:21) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (0:21) --- *(5): * 
[1] (0:22) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (0:22) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (0:22) --- *(5): * 	  Selected comments:
[1] (0:22) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (0:22) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (0:22) --- *(5): * 	    and adds all of the test scripts.
[1] (0:22) --- *(5): * 	    Set default variables from environment.
[1] (0:22) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (0:22) --- *(5): * 
[1] (0:22) --- *(5): * $EndLog$
[1] (0:23) --- *(5): *
[1] (0:23) --- *(5): 
[1] (0:23) --- *(5): * The following three resources must exist before testing begins
[1] (0:23) --- *(5): getenv FSET_DEVICE
[1] (0:23) [*] Inserting variable FSET_DEVICE
[1] (0:23) --- *(5): if ($FSET_DEVICE == "") {
[1] (0:23) --- *(5): 	set device $FSET_DEVICE
[1] (0:23) [*] Inserting variable device
[1] (0:23) --- *(5): }
[1] (0:23) --- *(5): 
[1] (0:23) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (0:23) [*] Inserting variable FSET_MOUNT_POINT_0
[1] (0:23) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (0:23) --- *(5): 	set mount_point[0] "/mnt"
[1] (0:23) [*] Inserting variable mount_point[0]
[1] (0:23) --- *(5): } else {
[1] (0:23) --- *(5): 
[1] (0:23) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (0:23) [*] Inserting variable FSET_MOUNT_POINT_1
[1] (0:24) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (0:24) --- *(5): 	set mount_point[1] "/mnt2"
[1] (0:24) [*] Inserting variable mount_point[1]
[1] (0:24) --- *(5): } else {
[1] (0:24) --- *(5): 
[1] (0:24) --- *(5): 
[1] (0:24) --- *(5): getenv FSET_AGGR_ID
[1] (0:25) [*] Inserting variable FSET_AGGR_ID
[1] (0:25) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (0:25) --- *(5): 	set aggr_id 1000
[1] (0:25) [*] Inserting variable aggr_id
[1] (0:25) --- *(5): } else {
[1] (0:25) --- *(5): 
[1] (0:25) --- *(5): getenv FSET_BLOCK_SIZE
[1] (0:25) [*] Inserting variable FSET_BLOCK_SIZE
[1] (0:25) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (0:25) --- *(5): 	set block_size 8192
[1] (0:25) [*] Inserting variable block_size
[1] (0:25) --- *(5): } else {
[1] (0:25) --- *(5): 
[1] (0:25) --- *(5): getenv FSET_FRAG_SIZE
[1] (0:25) [*] Inserting variable FSET_FRAG_SIZE
[1] (0:25) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (0:25) --- *(5): 	set frag_size 1024
[1] (0:25) [*] Inserting variable frag_size
[1] (0:25) --- *(5): } else {
[1] (0:25) --- *(5): 
[1] (0:25) --- *(5): set aggr_name	$device
[1] (0:25) [*] Inserting variable aggr_name
[1] (0:25) --- *(5): set aggr_type	"lfs"
[1] (0:25) [*] Inserting variable aggr_type
[1] (0:25) --- *(5): 
[1] (0:26) --- *(5): set fset_id   ($aggr_id + 1)
[1] (0:26) [*] Inserting variable fset_id
[1] (0:26) --- *(5): set fset_name ("fset" + $fset_id)
[1] (0:26) [*] Inserting variable fset_name
[1] (0:26) --- *(5): 
[1] (0:26) --- *(5): set file_name		"zappa"
[1] (0:26) [*] Inserting variable file_name
[1] (0:26) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (0:26) [*] Inserting variable path_name[0]
[1] (0:26) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (0:26) [*] Inserting variable path_name[1]
[1] (0:26) --- *(5): 
[1] (0:26) --- *(5): set setup_aggr proc END
[1] (0:26) --- *(5): !*** Setup the aggregate
[1] (0:26) --- *(5): 	initAggr @device @block_size @frag_size
[1] (0:26) --- *(5): 	verifyAggr @device
[1] (0:27) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (0:27) --- *(5): END
[1] (0:27) [*] Inserting variable setup_aggr
[1] (0:27) --- *(5): 
[1] (0:27) --- *(5): set setup_fset proc END
[1] (0:27) --- *(5): !*** Create and mount a fileset
[1] (0:27) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (0:27) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (0:27) --- *(5): END
[1] (0:27) [*] Inserting variable setup_fset
[1] (0:27) --- *(5): 
[1] (0:27) --- *(5): set shutdown_fset proc END
[1] (0:27) --- *(5): !*** Destroy the fileset
[1] (0:27) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (0:27) --- *(5): END
[1] (0:27) [*] Inserting variable shutdown_fset
[1] (0:27) --- *(5): 
[1] (0:27) --- *(5): set shutdown_aggr proc END
[1] (0:27) --- *(5): !*** Shutdown the aggregate
[1] (0:27) --- *(5): 	detachAggr @aggr_id
[1] (0:27) --- *(5): 	verifyAggr @device
[1] (0:27) --- *(5): END
[1] (0:27) [*] Inserting variable shutdown_aggr
[1] (0:27) --- *(5): 
[1] (0:27) --- *(5): quit
[1] (0:27) --- *(4): 
[1] (0:27) --- *(4): exec setup_aggr
[1] (0:28) --- *(4): 
[1] (0:28) --- *(4): !*** Setup the aggregate
[1] (0:28) --- !*** Setup the aggregate
[1] (0:28) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (0:42) --- *(4): 	verifyAggr $device
[1] (0:49) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (0:49) --- *(4): 
[1] (0:49) --- *(4): 
[1] (0:50) --- *(4): quit
[1] (0:50) [*] <== finished processing the string
[1] (0:50) --- *(4): exec setup_fset
[1] (0:50) --- *(4): 
[1] (0:50) --- *(4): !*** Create and mount a fileset
[1] (0:50) --- !*** Create and mount a fileset
[1] (0:50) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (0:50) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (0:51) --- *(4): 
[1] (0:51) --- *(4): 
[1] (0:51) --- *(4): quit
[1] (0:51) [*] <== finished processing the string
[1] (0:51) --- *(4): quit
[1] (0:51) --- *(3): 
[1] (0:51) --- *(3): getFsetSize $aggr_id $fset_id empty_fset_size
[1] (0:51) [*] Inserting variable empty_fset_size
[1] (0:51) --- *(3): 
[1] (0:51) --- *(3): !*** Write 1 block to a new file
[1] (0:51) --- !*** Write 1 block to a new file
[1] (0:51) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (0:52) [*] Inserting variable fd1
[1] (0:52) --- *(3): set data ("1" * $block_size)
[1] (0:52) [*] Inserting variable data
[1] (0:52) --- *(3): write $fd1 $data
[1] (0:52) [*] Inserting variable CommandResult
[1] (0:52) --- *(3): close $fd1
[1] (0:52) --- *(3): 
[1] (0:52) --- *(3): !*** Verify that the fileset size increased by 1 block
[1] (0:52) --- !*** Verify that the fileset size increased by 1 block
[1] (0:52) --- *(3): getFsetSize $aggr_id $fset_id fset_size
[1] (0:52) [*] Inserting variable fset_size
[1] (0:52) --- *(3): assert ($fset_size == $empty_fset_size + $block_size / $frag_size)
[1] (0:52) --- *(3): 
[1] (0:52) --- *(3): !*** Clone the fileset and mount the clone
[1] (0:52) --- !*** Clone the fileset and mount the clone
[1] (0:52) --- *(3): set clone_name ($fset_name + ".clone")
[1] (0:52) [*] Inserting variable clone_name
[1] (0:52) --- *(3): set clone_id ($fset_id + 1)
[1] (0:52) [*] Inserting variable clone_id
[1] (0:52) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (0:53) --- *(3): mountFset $clone_id $mount_point[1]
[1] (0:53) --- *(3): 
[1] (0:54) --- *(3): !*** Verify the sizes of the two filesets
[1] (0:54) --- !*** Verify the sizes of the two filesets
[1] (0:54) --- *(3): getFsetSize $aggr_id $fset_id fset_size
[1] (0:54) --- *(3): assert ($fset_size == $empty_fset_size - 1)
[1] (0:54) --- *(3): getFsetSize $aggr_id $clone_id fset_size
[1] (0:54) --- *(3): assert ($fset_size == $empty_fset_size + $block_size / $frag_size)
[1] (0:54) --- *(3): 
[1] (0:54) --- *(3): !*** Open backing file and verify contents
[1] (0:54) --- !*** Open backing file and verify contents
[1] (0:54) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (0:54) [*] Inserting variable fd2
[1] (0:54) --- *(3): read $fd2 $block_size clone_data
[1] (0:54) [*] Inserting variable clone_data
[1] (0:54) --- *(3): assert ($clone_data == $data)
[1] (0:54) --- *(3): close $fd2
[1] (0:54) --- *(3): 
[1] (0:54) --- *(3): !*** Unmount the filesets
[1] (0:54) --- !*** Unmount the filesets
[1] (0:54) --- *(3): unmountFset $mount_point[0]
[1] (0:55) --- *(3): unmountFset $mount_point[1]
[1] (0:56) --- *(3): 
[1] (0:56) --- *(3): include "shutdown.itl"
[1] (0:56) [*] Opening the file shutdown.itl
[1] (0:56) [*] Trying to open the file scripts/shutdown.itl
[1] (0:56) --- *(4): *
[1] (0:57) --- *(4): * @OSF_COPYRIGHT@
[1] (0:57) --- *(4): * COPYRIGHT NOTICE
[1] (0:57) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (0:57) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (0:57) --- *(4): * src directory for the full copyright text.
[1] (0:57) --- *(4): *
[1] (0:57) --- *(4): * HISTORY
[1] (0:57) --- *(4): * $Log: shutdown.itl,v $
[1] (0:57) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (0:57) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (0:57) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (0:57) --- *(4): *
[1] (0:57) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (0:57) --- *(4): * 	1.0.3a update from Transarc
[1] (0:57) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (0:57) --- *(4): * 
[1] (0:57) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (0:58) --- *(4): * 	Embedded copyright notice
[1] (0:58) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (0:58) --- *(4): * 
[1] (0:58) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (0:58) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (0:58) --- *(4): * 	  Selected comments:
[1] (0:58) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (0:58) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (0:58) --- *(4): * 	    and adds all of the test scripts.
[1] (0:58) --- *(4): * 	    Shutdown a test case.
[1] (0:58) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (0:58) --- *(4): * 
[1] (0:58) --- *(4): * $EndLog$
[1] (0:58) --- *(4): *
[1] (0:58) --- *(4): 
[1] (0:58) --- *(4): exec shutdown_fset
[1] (0:58) --- *(4): 
[1] (0:58) --- *(4): !*** Destroy the fileset
[1] (0:58) --- !*** Destroy the fileset
[1] (0:58) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (0:59) --- *(4): 
[1] (0:59) --- *(4): 
[1] (0:59) --- *(4): quit
[1] (0:59) [*] <== finished processing the string
[1] (0:59) --- *(4): exec shutdown_aggr
[1] (0:59) --- *(4): 
[1] (0:59) --- *(4): !*** Shutdown the aggregate
[1] (0:59) --- !*** Shutdown the aggregate
[1] (0:59) --- *(4): 	detachAggr $aggr_id
[1] (0:59) --- *(4): 	verifyAggr $device
[1] (1:01) --- *(4): 
[1] (1:01) --- *(4): 
[1] (1:01) --- *(4): quit
[1] (1:01) [*] <== finished processing the string
[1] (1:01) --- *(4): quit
[1] (1:01) --- *(3): quit
[1] (1:01) --- *(2): 
[1] (1:01) --- *(2): include "clone01.itl"
[1] (1:01) [*] Opening the file clone01.itl
[1] (1:01) [*] Trying to open the file scripts/clone01.itl
[1] (1:01) --- *(3): *
[1] (1:01) --- *(3): * @OSF_COPYRIGHT@
[1] (1:01) --- *(3): * COPYRIGHT NOTICE
[1] (1:02) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:02) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:02) --- *(3): * src directory for the full copyright text.
[1] (1:02) --- *(3): *
[1] (1:02) --- *(3): * HISTORY
[1] (1:02) --- *(3): * $Log: clone01.itl,v $
[1] (1:02) --- *(3): * Revision 1.1.407.1  1994/02/04  20:41:05  devsrc
[1] (1:02) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (1:02) --- *(3): * 	[1994/02/04  15:22:40  devsrc]
[1] (1:02) --- *(3): *
[1] (1:02) --- *(3): * Revision 1.1.405.1  1993/12/07  17:42:07  jaffe
[1] (1:02) --- *(3): * 	1.0.3a update from Transarc
[1] (1:02) --- *(3): * 	[1993/12/03  18:56:10  jaffe]
[1] (1:02) --- *(3): * 
[1] (1:02) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:27  htf
[1] (1:02) --- *(3): * 	Embedded copyright notice
[1] (1:03) --- *(3): * 	[1993/01/11  17:01:59  htf]
[1] (1:03) --- *(3): * 
[1] (1:03) --- *(3): * Revision 1.1.2.2  1992/10/28  16:23:42  jaffe
[1] (1:03) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (1:03) --- *(3): * 	  Selected comments:
[1] (1:03) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (1:03) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (1:03) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (1:03) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (1:04) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (1:04) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (1:04) --- *(3): * 	    last argument to the command.
[1] (1:04) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (1:04) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (1:04) --- *(3): * 	    variable by the open and opendir comands.
[1] (1:04) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (1:04) --- *(3): * 	    described above.
[1] (1:04) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (1:04) --- *(3): * 	    Cleanup debugging code.
[1] (1:05) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:05) --- *(3): * 	  Selected comments:
[1] (1:05) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:05) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:05) --- *(3): * 	    and adds all of the test scripts.
[1] (1:05) --- *(3): * 	    Clone test.
[1] (1:05) --- *(3): * 	[1992/10/27  18:47:20  jaffe]
[1] (1:05) --- *(3): * 
[1] (1:05) --- *(3): * $EndLog$
[1] (1:05) --- *(3): *
[1] (1:05) --- *(3): 
[1] (1:05) --- *(3): !**********************************************************
[1] (1:05) --- !**********************************************************
[1] (1:05) --- *(3): !*** Clone a fileset with a ZLC file
[1] (1:05) --- !*** Clone a fileset with a ZLC file
[1] (1:05) --- *(3): !**********************************************************
[1] (1:05) --- !**********************************************************
[1] (1:05) --- *(3): 
[1] (1:05) --- *(3): include "setup.itl"
[1] (1:05) [*] Opening the file setup.itl
[1] (1:05) [*] Trying to open the file scripts/setup.itl
[1] (1:05) --- *(4): *
[1] (1:06) --- *(4): * @OSF_COPYRIGHT@
[1] (1:06) --- *(4): * COPYRIGHT NOTICE
[1] (1:06) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:06) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:06) --- *(4): * src directory for the full copyright text.
[1] (1:06) --- *(4): *
[1] (1:06) --- *(4): * HISTORY
[1] (1:06) --- *(4): * $Log: setup.itl,v $
[1] (1:06) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (1:06) --- *(4): * 	Embedded copyright notice
[1] (1:06) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (1:06) --- *(4): *
[1] (1:06) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (1:06) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:06) --- *(4): * 	  Selected comments:
[1] (1:07) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:07) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:07) --- *(4): * 	    and adds all of the test scripts.
[1] (1:07) --- *(4): * 	    Setup for a test case.
[1] (1:07) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (1:07) --- *(4): * 
[1] (1:07) --- *(4): * $EndLog$
[1] (1:07) --- *(4): *
[1] (1:07) --- *(4): 
[1] (1:07) --- *(4): include "defaults.itl"
[1] (1:07) [*] Opening the file defaults.itl
[1] (1:07) [*] Trying to open the file scripts/defaults.itl
[1] (1:07) --- *(5): *
[1] (1:07) --- *(5): * @OSF_COPYRIGHT@
[1] (1:07) --- *(5): * COPYRIGHT NOTICE
[1] (1:07) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:07) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:07) --- *(5): * src directory for the full copyright text.
[1] (1:07) --- *(5): *
[1] (1:07) --- *(5): * HISTORY
[1] (1:08) --- *(5): * $Log: defaults.itl,v $
[1] (1:08) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (1:08) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (1:08) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (1:08) --- *(5): *
[1] (1:08) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (1:08) --- *(5): * 	1.0.3a update from Transarc
[1] (1:08) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (1:08) --- *(5): * 
[1] (1:08) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (1:08) --- *(5): * 	Embedded copyright notice
[1] (1:08) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (1:08) --- *(5): * 
[1] (1:08) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (1:08) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:08) --- *(5): * 	  Selected comments:
[1] (1:09) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:09) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:09) --- *(5): * 	    and adds all of the test scripts.
[1] (1:09) --- *(5): * 	    Set default variables from environment.
[1] (1:09) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (1:09) --- *(5): * 
[1] (1:09) --- *(5): * $EndLog$
[1] (1:09) --- *(5): *
[1] (1:09) --- *(5): 
[1] (1:09) --- *(5): * The following three resources must exist before testing begins
[1] (1:09) --- *(5): getenv FSET_DEVICE
[1] (1:09) --- *(5): if ($FSET_DEVICE == "") {
[1] (1:09) --- *(5): 	set device $FSET_DEVICE
[1] (1:09) --- *(5): }
[1] (1:09) --- *(5): 
[1] (1:09) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (1:09) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (1:09) --- *(5): 	set mount_point[0] "/mnt"
[1] (1:09) --- *(5): } else {
[1] (1:10) --- *(5): 
[1] (1:10) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (1:10) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (1:10) --- *(5): 	set mount_point[1] "/mnt2"
[1] (1:10) --- *(5): } else {
[1] (1:10) --- *(5): 
[1] (1:10) --- *(5): 
[1] (1:10) --- *(5): getenv FSET_AGGR_ID
[1] (1:10) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (1:10) --- *(5): 	set aggr_id 1000
[1] (1:10) --- *(5): } else {
[1] (1:10) --- *(5): 
[1] (1:10) --- *(5): getenv FSET_BLOCK_SIZE
[1] (1:10) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (1:10) --- *(5): 	set block_size 8192
[1] (1:10) --- *(5): } else {
[1] (1:10) --- *(5): 
[1] (1:10) --- *(5): getenv FSET_FRAG_SIZE
[1] (1:10) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (1:10) --- *(5): 	set frag_size 1024
[1] (1:10) --- *(5): } else {
[1] (1:11) --- *(5): 
[1] (1:11) --- *(5): set aggr_name	$device
[1] (1:11) --- *(5): set aggr_type	"lfs"
[1] (1:11) --- *(5): 
[1] (1:11) --- *(5): set fset_id   ($aggr_id + 1)
[1] (1:11) --- *(5): set fset_name ("fset" + $fset_id)
[1] (1:11) --- *(5): 
[1] (1:11) --- *(5): set file_name		"zappa"
[1] (1:11) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (1:11) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (1:11) --- *(5): 
[1] (1:11) --- *(5): set setup_aggr proc END
[1] (1:11) --- *(5): !*** Setup the aggregate
[1] (1:11) --- *(5): 	initAggr @device @block_size @frag_size
[1] (1:11) --- *(5): 	verifyAggr @device
[1] (1:11) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (1:11) --- *(5): END
[1] (1:11) --- *(5): 
[1] (1:11) --- *(5): set setup_fset proc END
[1] (1:12) --- *(5): !*** Create and mount a fileset
[1] (1:12) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (1:12) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (1:12) --- *(5): END
[1] (1:12) --- *(5): 
[1] (1:12) --- *(5): set shutdown_fset proc END
[1] (1:12) --- *(5): !*** Destroy the fileset
[1] (1:12) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (1:12) --- *(5): END
[1] (1:12) --- *(5): 
[1] (1:12) --- *(5): set shutdown_aggr proc END
[1] (1:12) --- *(5): !*** Shutdown the aggregate
[1] (1:12) --- *(5): 	detachAggr @aggr_id
[1] (1:12) --- *(5): 	verifyAggr @device
[1] (1:12) --- *(5): END
[1] (1:12) --- *(5): 
[1] (1:12) --- *(5): quit
[1] (1:12) --- *(4): 
[1] (1:12) --- *(4): exec setup_aggr
[1] (1:12) --- *(4): 
[1] (1:12) --- *(4): !*** Setup the aggregate
[1] (1:12) --- !*** Setup the aggregate
[1] (1:12) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (1:18) --- *(4): 	verifyAggr $device
[1] (1:19) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (1:20) --- *(4): 
[1] (1:20) --- *(4): 
[1] (1:20) --- *(4): quit
[1] (1:20) [*] <== finished processing the string
[1] (1:20) --- *(4): exec setup_fset
[1] (1:20) --- *(4): 
[1] (1:20) --- *(4): !*** Create and mount a fileset
[1] (1:20) --- !*** Create and mount a fileset
[1] (1:20) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (1:20) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (1:20) --- *(4): 
[1] (1:20) --- *(4): 
[1] (1:20) --- *(4): quit
[1] (1:20) [*] <== finished processing the string
[1] (1:20) --- *(4): quit
[1] (1:20) --- *(3): 
[1] (1:20) --- *(3): !*** Write 1 block + 1 byte to a new file
[1] (1:20) --- !*** Write 1 block + 1 byte to a new file
[1] (1:21) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (1:21) --- *(3): set data ("1" * ($block_size + 1))
[1] (1:21) --- *(3): write $fd1 $data
[1] (1:21) --- *(3): close $fd1
[1] (1:21) --- *(3): 
[1] (1:21) --- *(3): !*** Open the file for reading then unlink it
[1] (1:21) --- !*** Open the file for reading then unlink it
[1] (1:21) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (1:21) --- *(3): unlink $path_name[0]
[1] (1:21) --- *(3): 
[1] (1:21) --- *(3): !*** Make sure the file doesn't exist anymore
[1] (1:21) --- !*** Make sure the file doesn't exist anymore
[1] (1:21) --- *(3): verifyStatus false
[1] (1:21) [*] Using false  for Verify Status.
[1] (1:21) --- Status verification is OFF
[1] (1:21) --- *(3): open $path_name[0] $O_RDONLY 0 x
[1] (1:21) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:21) --- *(3): verifyStatus true
[1] (1:21) [*] Using true  for Verify Status.
[1] (1:21) --- Status verification is ON
[1] (1:21) --- *(3): 
[1] (1:21) --- *(3): !*** Clone the fileset and mount the clone
[1] (1:21) --- !*** Clone the fileset and mount the clone
[1] (1:21) --- *(3): set clone_name ($fset_name + ".clone")
[1] (1:22) --- *(3): set clone_id ($fset_id + 1)
[1] (1:22) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (1:22) --- *(3): mountFset $clone_id $mount_point[1]
[1] (1:22) --- *(3): 
[1] (1:23) --- *(3): !*** Make sure the file doesn't exist in the backing fileset
[1] (1:23) --- !*** Make sure the file doesn't exist in the backing fileset
[1] (1:23) --- *(3): verifyStatus false
[1] (1:23) [*] Using false  for Verify Status.
[1] (1:23) --- Status verification is OFF
[1] (1:23) --- *(3): open $path_name[1] $O_RDONLY 0 x
[1] (1:23) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:23) --- *(3): verifyStatus true
[1] (1:23) [*] Using true  for Verify Status.
[1] (1:23) --- Status verification is ON
[1] (1:23) --- *(3): 
[1] (1:23) --- *(3): !*** Try to read the file
[1] (1:23) --- !*** Try to read the file
[1] (1:23) --- *(3): read $fd1 ($block_size + 1) clone_data
[1] (1:23) --- *(3): assert ($clone_data == $data)
[1] (1:23) --- *(3): close $fd1
[1] (1:23) --- *(3): 
[1] (1:23) --- *(3): !*** Make sure the original file still doesn't exist
[1] (1:23) --- !*** Make sure the original file still doesn't exist
[1] (1:23) --- *(3): verifyStatus false
[1] (1:23) [*] Using false  for Verify Status.
[1] (1:23) --- Status verification is OFF
[1] (1:23) --- *(3): open $path_name[0] $O_RDONLY 0 x
[1] (1:23) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:24) --- *(3): verifyStatus true
[1] (1:24) [*] Using true  for Verify Status.
[1] (1:24) --- Status verification is ON
[1] (1:24) --- *(3): 
[1] (1:24) --- *(3): !*** Unmount the filesets
[1] (1:24) --- !*** Unmount the filesets
[1] (1:24) --- *(3): unmountFset $mount_point[0]
[1] (1:24) --- *(3): unmountFset $mount_point[1]
[1] (1:25) --- *(3): 
[1] (1:25) --- *(3): include "shutdown.itl"
[1] (1:25) [*] Opening the file shutdown.itl
[1] (1:25) [*] Trying to open the file scripts/shutdown.itl
[1] (1:25) --- *(4): *
[1] (1:25) --- *(4): * @OSF_COPYRIGHT@
[1] (1:25) --- *(4): * COPYRIGHT NOTICE
[1] (1:25) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:25) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:25) --- *(4): * src directory for the full copyright text.
[1] (1:25) --- *(4): *
[1] (1:25) --- *(4): * HISTORY
[1] (1:26) --- *(4): * $Log: shutdown.itl,v $
[1] (1:26) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (1:26) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (1:26) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (1:26) --- *(4): *
[1] (1:26) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (1:26) --- *(4): * 	1.0.3a update from Transarc
[1] (1:26) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (1:26) --- *(4): * 
[1] (1:26) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (1:26) --- *(4): * 	Embedded copyright notice
[1] (1:26) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (1:26) --- *(4): * 
[1] (1:26) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (1:26) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:26) --- *(4): * 	  Selected comments:
[1] (1:27) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:27) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:27) --- *(4): * 	    and adds all of the test scripts.
[1] (1:27) --- *(4): * 	    Shutdown a test case.
[1] (1:27) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (1:27) --- *(4): * 
[1] (1:27) --- *(4): * $EndLog$
[1] (1:27) --- *(4): *
[1] (1:27) --- *(4): 
[1] (1:27) --- *(4): exec shutdown_fset
[1] (1:27) --- *(4): 
[1] (1:27) --- *(4): !*** Destroy the fileset
[1] (1:27) --- !*** Destroy the fileset
[1] (1:27) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (1:27) --- *(4): 
[1] (1:27) --- *(4): 
[1] (1:27) --- *(4): quit
[1] (1:27) [*] <== finished processing the string
[1] (1:27) --- *(4): exec shutdown_aggr
[1] (1:27) --- *(4): 
[1] (1:27) --- *(4): !*** Shutdown the aggregate
[1] (1:27) --- !*** Shutdown the aggregate
[1] (1:27) --- *(4): 	detachAggr $aggr_id
[1] (1:27) --- *(4): 	verifyAggr $device
[1] (1:29) --- *(4): 
[1] (1:29) --- *(4): 
[1] (1:29) --- *(4): quit
[1] (1:29) [*] <== finished processing the string
[1] (1:29) --- *(4): quit
[1] (1:29) --- *(3): quit
[1] (1:29) --- *(2): 
[1] (1:29) --- *(2): include "clone02.itl"
[1] (1:29) [*] Opening the file clone02.itl
[1] (1:29) [*] Trying to open the file scripts/clone02.itl
[1] (1:29) --- *(3): *
[1] (1:29) --- *(3): * @OSF_COPYRIGHT@
[1] (1:29) --- *(3): * COPYRIGHT NOTICE
[1] (1:29) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:29) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:29) --- *(3): * src directory for the full copyright text.
[1] (1:29) --- *(3): *
[1] (1:29) --- *(3): * HISTORY
[1] (1:30) --- *(3): * $Log: clone02.itl,v $
[1] (1:30) --- *(3): * Revision 1.1.408.1  1994/02/04  20:41:07  devsrc
[1] (1:30) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (1:30) --- *(3): * 	[1994/02/04  15:22:41  devsrc]
[1] (1:30) --- *(3): *
[1] (1:30) --- *(3): * Revision 1.1.406.1  1993/12/07  17:42:09  jaffe
[1] (1:30) --- *(3): * 	1.0.3a update from Transarc
[1] (1:30) --- *(3): * 	[1993/12/03  18:56:28  jaffe]
[1] (1:30) --- *(3): * 
[1] (1:30) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:28  htf
[1] (1:30) --- *(3): * 	Embedded copyright notice
[1] (1:30) --- *(3): * 	[1993/01/11  17:02:04  htf]
[1] (1:30) --- *(3): * 
[1] (1:30) --- *(3): * Revision 1.1.2.2  1992/10/28  16:23:51  jaffe
[1] (1:30) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (1:30) --- *(3): * 	  Selected comments:
[1] (1:31) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (1:31) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (1:31) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (1:31) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (1:31) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (1:31) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (1:31) --- *(3): * 	    last argument to the command.
[1] (1:32) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (1:32) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (1:32) --- *(3): * 	    variable by the open and opendir comands.
[1] (1:32) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (1:32) --- *(3): * 	    described above.
[1] (1:32) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (1:32) --- *(3): * 	    Cleanup debugging code.
[1] (1:32) --- *(3): * 	    Remove spurious echo command.
[1] (1:32) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:32) --- *(3): * 	  Selected comments:
[1] (1:32) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:33) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:33) --- *(3): * 	    and adds all of the test scripts.
[1] (1:33) --- *(3): * 	    Clone test.
[1] (1:33) --- *(3): * 	[1992/10/27  18:48:29  jaffe]
[1] (1:33) --- *(3): * 
[1] (1:33) --- *(3): * $EndLog$
[1] (1:33) --- *(3): *
[1] (1:33) --- *(3): 
[1] (1:33) --- *(3): !**********************************************************
[1] (1:33) --- !**********************************************************
[1] (1:33) --- *(3): !*** Clone a fileset with a ZLC file open for writing
[1] (1:33) --- !*** Clone a fileset with a ZLC file open for writing
[1] (1:33) --- *(3): !**********************************************************
[1] (1:33) --- !**********************************************************
[1] (1:33) --- *(3): 
[1] (1:33) --- *(3): include "setup.itl"
[1] (1:33) [*] Opening the file setup.itl
[1] (1:33) [*] Trying to open the file scripts/setup.itl
[1] (1:33) --- *(4): *
[1] (1:33) --- *(4): * @OSF_COPYRIGHT@
[1] (1:33) --- *(4): * COPYRIGHT NOTICE
[1] (1:33) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:34) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:34) --- *(4): * src directory for the full copyright text.
[1] (1:34) --- *(4): *
[1] (1:34) --- *(4): * HISTORY
[1] (1:34) --- *(4): * $Log: setup.itl,v $
[1] (1:34) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (1:34) --- *(4): * 	Embedded copyright notice
[1] (1:34) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (1:34) --- *(4): *
[1] (1:34) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (1:34) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:34) --- *(4): * 	  Selected comments:
[1] (1:34) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:34) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:35) --- *(4): * 	    and adds all of the test scripts.
[1] (1:35) --- *(4): * 	    Setup for a test case.
[1] (1:35) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (1:35) --- *(4): * 
[1] (1:35) --- *(4): * $EndLog$
[1] (1:35) --- *(4): *
[1] (1:35) --- *(4): 
[1] (1:35) --- *(4): include "defaults.itl"
[1] (1:35) [*] Opening the file defaults.itl
[1] (1:35) [*] Trying to open the file scripts/defaults.itl
[1] (1:35) --- *(5): *
[1] (1:35) --- *(5): * @OSF_COPYRIGHT@
[1] (1:35) --- *(5): * COPYRIGHT NOTICE
[1] (1:35) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:35) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:35) --- *(5): * src directory for the full copyright text.
[1] (1:35) --- *(5): *
[1] (1:35) --- *(5): * HISTORY
[1] (1:35) --- *(5): * $Log: defaults.itl,v $
[1] (1:35) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (1:35) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (1:36) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (1:36) --- *(5): *
[1] (1:36) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (1:36) --- *(5): * 	1.0.3a update from Transarc
[1] (1:36) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (1:36) --- *(5): * 
[1] (1:36) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (1:36) --- *(5): * 	Embedded copyright notice
[1] (1:36) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (1:36) --- *(5): * 
[1] (1:36) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (1:36) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:36) --- *(5): * 	  Selected comments:
[1] (1:36) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:36) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:37) --- *(5): * 	    and adds all of the test scripts.
[1] (1:37) --- *(5): * 	    Set default variables from environment.
[1] (1:37) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (1:37) --- *(5): * 
[1] (1:37) --- *(5): * $EndLog$
[1] (1:37) --- *(5): *
[1] (1:37) --- *(5): 
[1] (1:37) --- *(5): * The following three resources must exist before testing begins
[1] (1:37) --- *(5): getenv FSET_DEVICE
[1] (1:37) --- *(5): if ($FSET_DEVICE == "") {
[1] (1:37) --- *(5): 	set device $FSET_DEVICE
[1] (1:37) --- *(5): }
[1] (1:37) --- *(5): 
[1] (1:37) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (1:37) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (1:37) --- *(5): 	set mount_point[0] "/mnt"
[1] (1:37) --- *(5): } else {
[1] (1:37) --- *(5): 
[1] (1:37) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (1:37) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (1:38) --- *(5): 	set mount_point[1] "/mnt2"
[1] (1:38) --- *(5): } else {
[1] (1:38) --- *(5): 
[1] (1:38) --- *(5): 
[1] (1:38) --- *(5): getenv FSET_AGGR_ID
[1] (1:38) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (1:38) --- *(5): 	set aggr_id 1000
[1] (1:38) --- *(5): } else {
[1] (1:38) --- *(5): 
[1] (1:38) --- *(5): getenv FSET_BLOCK_SIZE
[1] (1:38) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (1:38) --- *(5): 	set block_size 8192
[1] (1:38) --- *(5): } else {
[1] (1:38) --- *(5): 
[1] (1:38) --- *(5): getenv FSET_FRAG_SIZE
[1] (1:38) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (1:38) --- *(5): 	set frag_size 1024
[1] (1:38) --- *(5): } else {
[1] (1:38) --- *(5): 
[1] (1:38) --- *(5): set aggr_name	$device
[1] (1:38) --- *(5): set aggr_type	"lfs"
[1] (1:38) --- *(5): 
[1] (1:38) --- *(5): set fset_id   ($aggr_id + 1)
[1] (1:39) --- *(5): set fset_name ("fset" + $fset_id)
[1] (1:39) --- *(5): 
[1] (1:39) --- *(5): set file_name		"zappa"
[1] (1:39) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (1:39) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (1:39) --- *(5): 
[1] (1:39) --- *(5): set setup_aggr proc END
[1] (1:39) --- *(5): !*** Setup the aggregate
[1] (1:39) --- *(5): 	initAggr @device @block_size @frag_size
[1] (1:39) --- *(5): 	verifyAggr @device
[1] (1:39) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (1:39) --- *(5): END
[1] (1:39) --- *(5): 
[1] (1:39) --- *(5): set setup_fset proc END
[1] (1:39) --- *(5): !*** Create and mount a fileset
[1] (1:39) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (1:39) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (1:39) --- *(5): END
[1] (1:39) --- *(5): 
[1] (1:39) --- *(5): set shutdown_fset proc END
[1] (1:40) --- *(5): !*** Destroy the fileset
[1] (1:40) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (1:40) --- *(5): END
[1] (1:40) --- *(5): 
[1] (1:40) --- *(5): set shutdown_aggr proc END
[1] (1:40) --- *(5): !*** Shutdown the aggregate
[1] (1:40) --- *(5): 	detachAggr @aggr_id
[1] (1:40) --- *(5): 	verifyAggr @device
[1] (1:40) --- *(5): END
[1] (1:40) --- *(5): 
[1] (1:40) --- *(5): quit
[1] (1:40) --- *(4): 
[1] (1:40) --- *(4): exec setup_aggr
[1] (1:40) --- *(4): 
[1] (1:40) --- *(4): !*** Setup the aggregate
[1] (1:40) --- !*** Setup the aggregate
[1] (1:40) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (1:45) --- *(4): 	verifyAggr $device
[1] (1:47) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (1:47) --- *(4): 
[1] (1:47) --- *(4): 
[1] (1:47) --- *(4): quit
[1] (1:47) [*] <== finished processing the string
[1] (1:47) --- *(4): exec setup_fset
[1] (1:47) --- *(4): 
[1] (1:47) --- *(4): !*** Create and mount a fileset
[1] (1:47) --- !*** Create and mount a fileset
[1] (1:47) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (1:47) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (1:48) --- *(4): 
[1] (1:48) --- *(4): 
[1] (1:48) --- *(4): quit
[1] (1:48) [*] <== finished processing the string
[1] (1:48) --- *(4): quit
[1] (1:48) --- *(3): 
[1] (1:48) --- *(3): !*** Open the file for writing then unlink it
[1] (1:48) --- !*** Open the file for writing then unlink it
[1] (1:48) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (1:48) --- *(3): unlink $path_name[0]
[1] (1:48) --- *(3): 
[1] (1:48) --- *(3): !*** Make sure the file doesn't exist anymore
[1] (1:48) --- !*** Make sure the file doesn't exist anymore
[1] (1:48) --- *(3): verifyStatus false
[1] (1:48) [*] Using false  for Verify Status.
[1] (1:48) --- Status verification is OFF
[1] (1:48) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (1:48) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:48) --- *(3): verifyStatus true
[1] (1:48) [*] Using true  for Verify Status.
[1] (1:48) --- Status verification is ON
[1] (1:48) --- *(3): 
[1] (1:48) --- *(3): !*** Create a random new file 
[1] (1:48) --- !*** Create a random new file 
[1] (1:48) --- *(3): set $random_file ($mount_point[0] + "/random")
[1] (1:48) [*] Inserting variable random_file
[1] (1:49) --- *(3): open $random_file ($O_CREAT|$O_WRONLY) 0666 random_fd
[1] (1:49) [*] Inserting variable random_fd
[1] (1:49) --- *(3): close $random_fd
[1] (1:49) --- *(3): 
[1] (1:49) --- *(3): !*** Clone the fileset and mount the clone
[1] (1:49) --- !*** Clone the fileset and mount the clone
[1] (1:49) --- *(3): set clone_name ($fset_name + ".clone")
[1] (1:49) --- *(3): set clone_id ($fset_id + 1)
[1] (1:49) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (1:49) --- *(3): mountFset $clone_id $mount_point[1]
[1] (1:50) --- *(3): 
[1] (1:50) --- *(3): !*** Make sure the file doesn't exist in the backing fileset
[1] (1:50) --- !*** Make sure the file doesn't exist in the backing fileset
[1] (1:50) --- *(3): verifyStatus false
[1] (1:50) [*] Using false  for Verify Status.
[1] (1:50) --- Status verification is OFF
[1] (1:50) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (1:50) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:50) --- *(3): verifyStatus true
[1] (1:50) [*] Using true  for Verify Status.
[1] (1:50) --- Status verification is ON
[1] (1:50) --- *(3): 
[1] (1:51) --- *(3): !*** Write 1 block + 1 byte to the file
[1] (1:51) --- !*** Write 1 block + 1 byte to the file
[1] (1:51) --- *(3): set data ("1" * ($block_size + 1))
[1] (1:51) --- *(3): write $fd1 $data
[1] (1:51) --- *(3): 
[1] (1:51) --- *(3): !*** Read the data back
[1] (1:51) --- !*** Read the data back
[1] (1:51) --- *(3): lseek $fd1 0 $SEEK_SET
[1] (1:51) --- *(3): read $fd1 ($block_size + 1) read_data
[1] (1:51) [*] Inserting variable read_data
[1] (1:51) --- *(3): assert ($read_data == $data)
[1] (1:51) --- *(3): close $fd1
[1] (1:51) --- *(3): 
[1] (1:51) --- *(3): !*** Make sure the original file still doesn't exist
[1] (1:51) --- !*** Make sure the original file still doesn't exist
[1] (1:51) --- *(3): verifyStatus false
[1] (1:51) [*] Using false  for Verify Status.
[1] (1:51) --- Status verification is OFF
[1] (1:51) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (1:51) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:51) --- *(3): verifyStatus true
[1] (1:51) [*] Using true  for Verify Status.
[1] (1:51) --- Status verification is ON
[1] (1:51) --- *(3): 
[1] (1:51) --- *(3): !*** Make sure the file still doesn't exist in the
[1] (1:51) --- !*** Make sure the file still doesn't exist in the
[1] (1:51) --- *(3): !***    backing fileset
[1] (1:51) --- !***    backing fileset
[1] (1:52) --- *(3): verifyStatus false
[1] (1:52) [*] Using false  for Verify Status.
[1] (1:52) --- Status verification is OFF
[1] (1:52) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (1:52) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (1:52) --- *(3): verifyStatus true
[1] (1:52) [*] Using true  for Verify Status.
[1] (1:52) --- Status verification is ON
[1] (1:52) --- *(3): 
[1] (1:52) --- *(3): !*** Unmount the filesets
[1] (1:52) --- !*** Unmount the filesets
[1] (1:52) --- *(3): unmountFset $mount_point[0]
[1] (1:53) --- *(3): unmountFset $mount_point[1]
[1] (1:53) --- *(3): 
[1] (1:53) --- *(3): include "shutdown.itl"
[1] (1:53) [*] Opening the file shutdown.itl
[1] (1:53) [*] Trying to open the file scripts/shutdown.itl
[1] (1:53) --- *(4): *
[1] (1:53) --- *(4): * @OSF_COPYRIGHT@
[1] (1:53) --- *(4): * COPYRIGHT NOTICE
[1] (1:53) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:54) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:54) --- *(4): * src directory for the full copyright text.
[1] (1:54) --- *(4): *
[1] (1:54) --- *(4): * HISTORY
[1] (1:54) --- *(4): * $Log: shutdown.itl,v $
[1] (1:54) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (1:54) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (1:54) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (1:54) --- *(4): *
[1] (1:54) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (1:54) --- *(4): * 	1.0.3a update from Transarc
[1] (1:54) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (1:54) --- *(4): * 
[1] (1:54) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (1:54) --- *(4): * 	Embedded copyright notice
[1] (1:54) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (1:54) --- *(4): * 
[1] (1:54) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (1:55) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (1:55) --- *(4): * 	  Selected comments:
[1] (1:55) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (1:55) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (1:55) --- *(4): * 	    and adds all of the test scripts.
[1] (1:55) --- *(4): * 	    Shutdown a test case.
[1] (1:55) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (1:55) --- *(4): * 
[1] (1:55) --- *(4): * $EndLog$
[1] (1:55) --- *(4): *
[1] (1:55) --- *(4): 
[1] (1:55) --- *(4): exec shutdown_fset
[1] (1:55) --- *(4): 
[1] (1:55) --- *(4): !*** Destroy the fileset
[1] (1:55) --- !*** Destroy the fileset
[1] (1:55) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (1:55) --- *(4): 
[1] (1:55) --- *(4): 
[1] (1:55) --- *(4): quit
[1] (1:55) [*] <== finished processing the string
[1] (1:55) --- *(4): exec shutdown_aggr
[1] (1:55) --- *(4): 
[1] (1:55) --- *(4): !*** Shutdown the aggregate
[1] (1:55) --- !*** Shutdown the aggregate
[1] (1:55) --- *(4): 	detachAggr $aggr_id
[1] (1:55) --- *(4): 	verifyAggr $device
[1] (1:57) --- *(4): 
[1] (1:57) --- *(4): 
[1] (1:57) --- *(4): quit
[1] (1:57) [*] <== finished processing the string
[1] (1:57) --- *(4): quit
[1] (1:57) --- *(3): quit
[1] (1:57) --- *(2): 
[1] (1:57) --- *(2): include "clone03.itl"
[1] (1:57) [*] Opening the file clone03.itl
[1] (1:57) [*] Trying to open the file scripts/clone03.itl
[1] (1:57) --- *(3): *
[1] (1:57) --- *(3): * @OSF_COPYRIGHT@
[1] (1:57) --- *(3): * COPYRIGHT NOTICE
[1] (1:57) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (1:57) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (1:58) --- *(3): * src directory for the full copyright text.
[1] (1:58) --- *(3): *
[1] (1:58) --- *(3): * HISTORY
[1] (1:58) --- *(3): * $Log: clone03.itl,v $
[1] (1:58) --- *(3): * Revision 1.1.409.1  1994/02/04  20:41:10  devsrc
[1] (1:58) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (1:58) --- *(3): * 	[1994/02/04  15:22:42  devsrc]
[1] (1:58) --- *(3): *
[1] (1:58) --- *(3): * Revision 1.1.407.1  1993/12/07  17:42:11  jaffe
[1] (1:58) --- *(3): * 	1.0.3a update from Transarc
[1] (1:58) --- *(3): * 	[1993/12/03  18:56:49  jaffe]
[1] (1:58) --- *(3): * 
[1] (1:58) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:30  htf
[1] (1:58) --- *(3): * 	Embedded copyright notice
[1] (1:58) --- *(3): * 	[1993/01/11  17:02:08  htf]
[1] (1:58) --- *(3): * 
[1] (1:58) --- *(3): * Revision 1.1.2.2  1992/10/28  16:24:04  jaffe
[1] (1:58) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (1:59) --- *(3): * 	  Selected comments:
[1] (1:59) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (1:59) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (1:59) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (1:59) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (1:59) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (1:59) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (1:59) --- *(3): * 	    last argument to the command.
[1] (2:00) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (2:00) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (2:00) --- *(3): * 	    variable by the open and opendir comands.
[1] (2:00) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (2:00) --- *(3): * 	    described above.
[1] (2:00) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (2:00) --- *(3): * 	    Cleanup debugging code.
[1] (2:00) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:00) --- *(3): * 	  Selected comments:
[1] (2:00) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:01) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:01) --- *(3): * 	    and adds all of the test scripts.
[1] (2:01) --- *(3): * 	    Clone test.
[1] (2:01) --- *(3): * 	[1992/10/27  18:49:25  jaffe]
[1] (2:01) --- *(3): * 
[1] (2:01) --- *(3): * $EndLog$
[1] (2:01) --- *(3): *
[1] (2:01) --- *(3): 
[1] (2:01) --- *(3): !**********************************************************
[1] (2:01) --- !**********************************************************
[1] (2:01) --- *(3): !*** Clone a fileset with a file open for reading
[1] (2:01) --- !*** Clone a fileset with a file open for reading
[1] (2:01) --- *(3): !**********************************************************
[1] (2:01) --- !**********************************************************
[1] (2:01) --- *(3): 
[1] (2:01) --- *(3): include "setup.itl"
[1] (2:01) [*] Opening the file setup.itl
[1] (2:01) [*] Trying to open the file scripts/setup.itl
[1] (2:01) --- *(4): *
[1] (2:01) --- *(4): * @OSF_COPYRIGHT@
[1] (2:01) --- *(4): * COPYRIGHT NOTICE
[1] (2:01) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:02) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:02) --- *(4): * src directory for the full copyright text.
[1] (2:02) --- *(4): *
[1] (2:02) --- *(4): * HISTORY
[1] (2:02) --- *(4): * $Log: setup.itl,v $
[1] (2:02) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (2:02) --- *(4): * 	Embedded copyright notice
[1] (2:02) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (2:02) --- *(4): *
[1] (2:02) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (2:02) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:02) --- *(4): * 	  Selected comments:
[1] (2:02) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:02) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:02) --- *(4): * 	    and adds all of the test scripts.
[1] (2:03) --- *(4): * 	    Setup for a test case.
[1] (2:03) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (2:03) --- *(4): * 
[1] (2:03) --- *(4): * $EndLog$
[1] (2:03) --- *(4): *
[1] (2:03) --- *(4): 
[1] (2:03) --- *(4): include "defaults.itl"
[1] (2:03) [*] Opening the file defaults.itl
[1] (2:03) [*] Trying to open the file scripts/defaults.itl
[1] (2:03) --- *(5): *
[1] (2:03) --- *(5): * @OSF_COPYRIGHT@
[1] (2:03) --- *(5): * COPYRIGHT NOTICE
[1] (2:03) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:03) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:03) --- *(5): * src directory for the full copyright text.
[1] (2:03) --- *(5): *
[1] (2:03) --- *(5): * HISTORY
[1] (2:03) --- *(5): * $Log: defaults.itl,v $
[1] (2:03) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (2:03) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (2:03) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (2:03) --- *(5): *
[1] (2:04) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (2:04) --- *(5): * 	1.0.3a update from Transarc
[1] (2:04) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (2:04) --- *(5): * 
[1] (2:04) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (2:04) --- *(5): * 	Embedded copyright notice
[1] (2:04) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (2:04) --- *(5): * 
[1] (2:04) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (2:04) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:04) --- *(5): * 	  Selected comments:
[1] (2:04) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:04) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:05) --- *(5): * 	    and adds all of the test scripts.
[1] (2:05) --- *(5): * 	    Set default variables from environment.
[1] (2:05) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (2:05) --- *(5): * 
[1] (2:05) --- *(5): * $EndLog$
[1] (2:05) --- *(5): *
[1] (2:05) --- *(5): 
[1] (2:05) --- *(5): * The following three resources must exist before testing begins
[1] (2:05) --- *(5): getenv FSET_DEVICE
[1] (2:05) --- *(5): if ($FSET_DEVICE == "") {
[1] (2:05) --- *(5): 	set device $FSET_DEVICE
[1] (2:05) --- *(5): }
[1] (2:05) --- *(5): 
[1] (2:05) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (2:05) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (2:05) --- *(5): 	set mount_point[0] "/mnt"
[1] (2:05) --- *(5): } else {
[1] (2:05) --- *(5): 
[1] (2:05) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (2:05) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (2:06) --- *(5): 	set mount_point[1] "/mnt2"
[1] (2:06) --- *(5): } else {
[1] (2:06) --- *(5): 
[1] (2:06) --- *(5): 
[1] (2:06) --- *(5): getenv FSET_AGGR_ID
[1] (2:06) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (2:06) --- *(5): 	set aggr_id 1000
[1] (2:06) --- *(5): } else {
[1] (2:06) --- *(5): 
[1] (2:06) --- *(5): getenv FSET_BLOCK_SIZE
[1] (2:06) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (2:06) --- *(5): 	set block_size 8192
[1] (2:06) --- *(5): } else {
[1] (2:06) --- *(5): 
[1] (2:06) --- *(5): getenv FSET_FRAG_SIZE
[1] (2:06) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (2:06) --- *(5): 	set frag_size 1024
[1] (2:06) --- *(5): } else {
[1] (2:06) --- *(5): 
[1] (2:06) --- *(5): set aggr_name	$device
[1] (2:06) --- *(5): set aggr_type	"lfs"
[1] (2:06) --- *(5): 
[1] (2:07) --- *(5): set fset_id   ($aggr_id + 1)
[1] (2:07) --- *(5): set fset_name ("fset" + $fset_id)
[1] (2:07) --- *(5): 
[1] (2:07) --- *(5): set file_name		"zappa"
[1] (2:07) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (2:07) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (2:07) --- *(5): 
[1] (2:07) --- *(5): set setup_aggr proc END
[1] (2:07) --- *(5): !*** Setup the aggregate
[1] (2:07) --- *(5): 	initAggr @device @block_size @frag_size
[1] (2:07) --- *(5): 	verifyAggr @device
[1] (2:07) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (2:07) --- *(5): END
[1] (2:07) --- *(5): 
[1] (2:07) --- *(5): set setup_fset proc END
[1] (2:07) --- *(5): !*** Create and mount a fileset
[1] (2:07) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (2:07) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (2:07) --- *(5): END
[1] (2:07) --- *(5): 
[1] (2:08) --- *(5): set shutdown_fset proc END
[1] (2:08) --- *(5): !*** Destroy the fileset
[1] (2:08) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (2:08) --- *(5): END
[1] (2:08) --- *(5): 
[1] (2:08) --- *(5): set shutdown_aggr proc END
[1] (2:08) --- *(5): !*** Shutdown the aggregate
[1] (2:08) --- *(5): 	detachAggr @aggr_id
[1] (2:08) --- *(5): 	verifyAggr @device
[1] (2:08) --- *(5): END
[1] (2:08) --- *(5): 
[1] (2:08) --- *(5): quit
[1] (2:08) --- *(4): 
[1] (2:08) --- *(4): exec setup_aggr
[1] (2:08) --- *(4): 
[1] (2:08) --- *(4): !*** Setup the aggregate
[1] (2:08) --- !*** Setup the aggregate
[1] (2:08) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (2:13) --- *(4): 	verifyAggr $device
[1] (2:15) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (2:15) --- *(4): 
[1] (2:15) --- *(4): 
[1] (2:15) --- *(4): quit
[1] (2:15) [*] <== finished processing the string
[1] (2:15) --- *(4): exec setup_fset
[1] (2:15) --- *(4): 
[1] (2:15) --- *(4): !*** Create and mount a fileset
[1] (2:15) --- !*** Create and mount a fileset
[1] (2:15) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (2:15) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (2:16) --- *(4): 
[1] (2:16) --- *(4): 
[1] (2:16) --- *(4): quit
[1] (2:16) [*] <== finished processing the string
[1] (2:16) --- *(4): quit
[1] (2:16) --- *(3): 
[1] (2:16) --- *(3): !*** Write 2 blocks + 1 byte to a new file
[1] (2:16) --- !*** Write 2 blocks + 1 byte to a new file
[1] (2:16) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (2:16) --- *(3): set data1 ("1" * $block_size)
[1] (2:16) [*] Inserting variable data1
[1] (2:16) --- *(3): write $fd1 $data1
[1] (2:16) --- *(3): set data2 ("2" * ($block_size + 1))
[1] (2:16) [*] Inserting variable data2
[1] (2:16) --- *(3): write $fd1 $data2
[1] (2:16) --- *(3): close $fd1
[1] (2:16) --- *(3): 
[1] (2:16) --- *(3): !*** Open the file for reading and read a block
[1] (2:16) --- !*** Open the file for reading and read a block
[1] (2:17) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (2:17) --- *(3): read $fd1 $block_size read_data1
[1] (2:17) [*] Inserting variable read_data1
[1] (2:17) --- *(3): assert ($read_data1 == $data1)
[1] (2:17) --- *(3): 
[1] (2:17) --- *(3): !*** Clone the fileset and mount the clone
[1] (2:17) --- !*** Clone the fileset and mount the clone
[1] (2:17) --- *(3): set clone_name ($fset_name + ".clone")
[1] (2:17) --- *(3): set clone_id ($fset_id + 1)
[1] (2:17) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (2:17) --- *(3): mountFset $clone_id $mount_point[1]
[1] (2:18) --- *(3): 
[1] (2:18) --- *(3): !*** Try to read the next block + 1 byte
[1] (2:18) --- !*** Try to read the next block + 1 byte
[1] (2:18) --- *(3): read $fd1 ($block_size + 1) read_data2
[1] (2:18) [*] Inserting variable read_data2
[1] (2:18) --- *(3): assert ($read_data2 == $data2)
[1] (2:18) --- *(3): close $fd1
[1] (2:18) --- *(3): 
[1] (2:18) --- *(3): !*** Try to read the data in the clone
[1] (2:18) --- !*** Try to read the data in the clone
[1] (2:18) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (2:19) --- *(3): read $fd2 (2 * $block_size + 1) clone_data
[1] (2:19) --- *(3): assert ($clone_data == ($data1 + $data2))
[1] (2:19) --- *(3): close $fd2
[1] (2:19) --- *(3): 
[1] (2:19) --- *(3): !*** Unmount the filesets
[1] (2:19) --- !*** Unmount the filesets
[1] (2:19) --- *(3): unmountFset $mount_point[0]
[1] (2:19) --- *(3): unmountFset $mount_point[1]
[1] (2:20) --- *(3): 
[1] (2:20) --- *(3): include "shutdown.itl"
[1] (2:20) [*] Opening the file shutdown.itl
[1] (2:20) [*] Trying to open the file scripts/shutdown.itl
[1] (2:20) --- *(4): *
[1] (2:20) --- *(4): * @OSF_COPYRIGHT@
[1] (2:20) --- *(4): * COPYRIGHT NOTICE
[1] (2:20) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:20) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:21) --- *(4): * src directory for the full copyright text.
[1] (2:21) --- *(4): *
[1] (2:21) --- *(4): * HISTORY
[1] (2:21) --- *(4): * $Log: shutdown.itl,v $
[1] (2:21) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (2:21) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (2:21) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (2:21) --- *(4): *
[1] (2:21) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (2:21) --- *(4): * 	1.0.3a update from Transarc
[1] (2:21) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (2:21) --- *(4): * 
[1] (2:21) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (2:21) --- *(4): * 	Embedded copyright notice
[1] (2:21) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (2:21) --- *(4): * 
[1] (2:21) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (2:21) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:22) --- *(4): * 	  Selected comments:
[1] (2:22) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:22) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:22) --- *(4): * 	    and adds all of the test scripts.
[1] (2:22) --- *(4): * 	    Shutdown a test case.
[1] (2:22) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (2:22) --- *(4): * 
[1] (2:22) --- *(4): * $EndLog$
[1] (2:22) --- *(4): *
[1] (2:22) --- *(4): 
[1] (2:22) --- *(4): exec shutdown_fset
[1] (2:22) --- *(4): 
[1] (2:22) --- *(4): !*** Destroy the fileset
[1] (2:22) --- !*** Destroy the fileset
[1] (2:22) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (2:22) --- *(4): 
[1] (2:22) --- *(4): 
[1] (2:22) --- *(4): quit
[1] (2:22) [*] <== finished processing the string
[1] (2:22) --- *(4): exec shutdown_aggr
[1] (2:22) --- *(4): 
[1] (2:22) --- *(4): !*** Shutdown the aggregate
[1] (2:22) --- !*** Shutdown the aggregate
[1] (2:22) --- *(4): 	detachAggr $aggr_id
[1] (2:23) --- *(4): 	verifyAggr $device
[1] (2:24) --- *(4): 
[1] (2:24) --- *(4): 
[1] (2:24) --- *(4): quit
[1] (2:24) [*] <== finished processing the string
[1] (2:24) --- *(4): quit
[1] (2:24) --- *(3): quit
[1] (2:24) --- *(2): 
[1] (2:24) --- *(2): include "clone04.itl"
[1] (2:24) [*] Opening the file clone04.itl
[1] (2:24) [*] Trying to open the file scripts/clone04.itl
[1] (2:24) --- *(3): *
[1] (2:24) --- *(3): * @OSF_COPYRIGHT@
[1] (2:24) --- *(3): * COPYRIGHT NOTICE
[1] (2:25) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:25) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:25) --- *(3): * src directory for the full copyright text.
[1] (2:25) --- *(3): *
[1] (2:25) --- *(3): * HISTORY
[1] (2:25) --- *(3): * $Log: clone04.itl,v $
[1] (2:25) --- *(3): * Revision 1.1.410.1  1994/02/04  20:41:12  devsrc
[1] (2:25) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (2:25) --- *(3): * 	[1994/02/04  15:22:43  devsrc]
[1] (2:25) --- *(3): *
[1] (2:25) --- *(3): * Revision 1.1.408.1  1993/12/07  17:42:12  jaffe
[1] (2:25) --- *(3): * 	1.0.3a update from Transarc
[1] (2:25) --- *(3): * 	[1993/12/03  18:57:06  jaffe]
[1] (2:25) --- *(3): * 
[1] (2:26) --- *(3): * Revision 1.1.2.4  1993/01/11  18:27:31  htf
[1] (2:26) --- *(3): * 	Embedded copyright notice
[1] (2:26) --- *(3): * 	[1993/01/11  17:02:13  htf]
[1] (2:26) --- *(3): * 
[1] (2:26) --- *(3): * Revision 1.1.2.3  1992/12/09  21:31:51  jaffe
[1] (2:26) --- *(3): * 	Transarc delta: jaffe-fix-2.2-test-build 1.2
[1] (2:26) --- *(3): * 	  Selected comments:
[1] (2:26) --- *(3): * 
[1] (2:26) --- *(3): * 	    Fix the script to handle itl failing on incomplete reads.
[1] (2:26) --- *(3): * 	[1992/12/04  20:26:58  jaffe]
[1] (2:26) --- *(3): * 
[1] (2:26) --- *(3): * Revision 1.1.2.2  1992/10/28  16:24:11  jaffe
[1] (2:26) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (2:26) --- *(3): * 	  Selected comments:
[1] (2:27) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (2:27) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (2:27) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (2:27) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (2:27) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (2:27) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (2:28) --- *(3): * 	    last argument to the command.
[1] (2:28) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (2:28) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (2:28) --- *(3): * 	    variable by the open and opendir comands.
[1] (2:28) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (2:28) --- *(3): * 	    described above.
[1] (2:28) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (2:28) --- *(3): * 	    Cleanup debugging code.
[1] (2:28) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:28) --- *(3): * 	  Selected comments:
[1] (2:29) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:29) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:29) --- *(3): * 	    and adds all of the test scripts.
[1] (2:29) --- *(3): * 	    Clone test.
[1] (2:29) --- *(3): * 	[1992/10/27  18:50:25  jaffe]
[1] (2:29) --- *(3): * 
[1] (2:29) --- *(3): * $EndLog$
[1] (2:29) --- *(3): *
[1] (2:29) --- *(3): 
[1] (2:29) --- *(3): !**********************************************************
[1] (2:29) --- !**********************************************************
[1] (2:29) --- *(3): !*** Clone a fileset with a file open for writing
[1] (2:29) --- !*** Clone a fileset with a file open for writing
[1] (2:29) --- *(3): !**********************************************************
[1] (2:29) --- !**********************************************************
[1] (2:29) --- *(3): 
[1] (2:29) --- *(3): include "setup.itl"
[1] (2:29) [*] Opening the file setup.itl
[1] (2:29) [*] Trying to open the file scripts/setup.itl
[1] (2:29) --- *(4): *
[1] (2:29) --- *(4): * @OSF_COPYRIGHT@
[1] (2:29) --- *(4): * COPYRIGHT NOTICE
[1] (2:30) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:30) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:30) --- *(4): * src directory for the full copyright text.
[1] (2:30) --- *(4): *
[1] (2:30) --- *(4): * HISTORY
[1] (2:30) --- *(4): * $Log: setup.itl,v $
[1] (2:30) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (2:30) --- *(4): * 	Embedded copyright notice
[1] (2:30) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (2:30) --- *(4): *
[1] (2:30) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (2:30) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:30) --- *(4): * 	  Selected comments:
[1] (2:30) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:31) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:31) --- *(4): * 	    and adds all of the test scripts.
[1] (2:31) --- *(4): * 	    Setup for a test case.
[1] (2:31) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (2:31) --- *(4): * 
[1] (2:31) --- *(4): * $EndLog$
[1] (2:31) --- *(4): *
[1] (2:31) --- *(4): 
[1] (2:31) --- *(4): include "defaults.itl"
[1] (2:31) [*] Opening the file defaults.itl
[1] (2:31) [*] Trying to open the file scripts/defaults.itl
[1] (2:31) --- *(5): *
[1] (2:31) --- *(5): * @OSF_COPYRIGHT@
[1] (2:31) --- *(5): * COPYRIGHT NOTICE
[1] (2:31) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:31) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:31) --- *(5): * src directory for the full copyright text.
[1] (2:31) --- *(5): *
[1] (2:31) --- *(5): * HISTORY
[1] (2:31) --- *(5): * $Log: defaults.itl,v $
[1] (2:31) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (2:31) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (2:32) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (2:32) --- *(5): *
[1] (2:32) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (2:32) --- *(5): * 	1.0.3a update from Transarc
[1] (2:32) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (2:32) --- *(5): * 
[1] (2:32) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (2:32) --- *(5): * 	Embedded copyright notice
[1] (2:32) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (2:32) --- *(5): * 
[1] (2:32) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (2:32) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:32) --- *(5): * 	  Selected comments:
[1] (2:32) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:32) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:33) --- *(5): * 	    and adds all of the test scripts.
[1] (2:33) --- *(5): * 	    Set default variables from environment.
[1] (2:33) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (2:33) --- *(5): * 
[1] (2:33) --- *(5): * $EndLog$
[1] (2:33) --- *(5): *
[1] (2:33) --- *(5): 
[1] (2:33) --- *(5): * The following three resources must exist before testing begins
[1] (2:33) --- *(5): getenv FSET_DEVICE
[1] (2:33) --- *(5): if ($FSET_DEVICE == "") {
[1] (2:33) --- *(5): 	set device $FSET_DEVICE
[1] (2:33) --- *(5): }
[1] (2:33) --- *(5): 
[1] (2:33) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (2:33) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (2:33) --- *(5): 	set mount_point[0] "/mnt"
[1] (2:33) --- *(5): } else {
[1] (2:33) --- *(5): 
[1] (2:33) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (2:34) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (2:34) --- *(5): 	set mount_point[1] "/mnt2"
[1] (2:34) --- *(5): } else {
[1] (2:34) --- *(5): 
[1] (2:34) --- *(5): 
[1] (2:34) --- *(5): getenv FSET_AGGR_ID
[1] (2:34) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (2:34) --- *(5): 	set aggr_id 1000
[1] (2:34) --- *(5): } else {
[1] (2:34) --- *(5): 
[1] (2:34) --- *(5): getenv FSET_BLOCK_SIZE
[1] (2:34) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (2:34) --- *(5): 	set block_size 8192
[1] (2:34) --- *(5): } else {
[1] (2:34) --- *(5): 
[1] (2:34) --- *(5): getenv FSET_FRAG_SIZE
[1] (2:34) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (2:34) --- *(5): 	set frag_size 1024
[1] (2:34) --- *(5): } else {
[1] (2:34) --- *(5): 
[1] (2:34) --- *(5): set aggr_name	$device
[1] (2:34) --- *(5): set aggr_type	"lfs"
[1] (2:34) --- *(5): 
[1] (2:35) --- *(5): set fset_id   ($aggr_id + 1)
[1] (2:35) --- *(5): set fset_name ("fset" + $fset_id)
[1] (2:35) --- *(5): 
[1] (2:35) --- *(5): set file_name		"zappa"
[1] (2:35) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (2:35) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (2:35) --- *(5): 
[1] (2:35) --- *(5): set setup_aggr proc END
[1] (2:35) --- *(5): !*** Setup the aggregate
[1] (2:35) --- *(5): 	initAggr @device @block_size @frag_size
[1] (2:35) --- *(5): 	verifyAggr @device
[1] (2:35) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (2:35) --- *(5): END
[1] (2:35) --- *(5): 
[1] (2:35) --- *(5): set setup_fset proc END
[1] (2:35) --- *(5): !*** Create and mount a fileset
[1] (2:35) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (2:35) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (2:35) --- *(5): END
[1] (2:36) --- *(5): 
[1] (2:36) --- *(5): set shutdown_fset proc END
[1] (2:36) --- *(5): !*** Destroy the fileset
[1] (2:36) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (2:36) --- *(5): END
[1] (2:36) --- *(5): 
[1] (2:36) --- *(5): set shutdown_aggr proc END
[1] (2:36) --- *(5): !*** Shutdown the aggregate
[1] (2:36) --- *(5): 	detachAggr @aggr_id
[1] (2:36) --- *(5): 	verifyAggr @device
[1] (2:36) --- *(5): END
[1] (2:36) --- *(5): 
[1] (2:36) --- *(5): quit
[1] (2:36) --- *(4): 
[1] (2:36) --- *(4): exec setup_aggr
[1] (2:36) --- *(4): 
[1] (2:36) --- *(4): !*** Setup the aggregate
[1] (2:36) --- !*** Setup the aggregate
[1] (2:36) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (2:42) --- *(4): 	verifyAggr $device
[1] (2:43) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (2:43) --- *(4): 
[1] (2:43) --- *(4): 
[1] (2:43) --- *(4): quit
[1] (2:43) [*] <== finished processing the string
[1] (2:43) --- *(4): exec setup_fset
[1] (2:43) --- *(4): 
[1] (2:43) --- *(4): !*** Create and mount a fileset
[1] (2:43) --- !*** Create and mount a fileset
[1] (2:43) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (2:43) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (2:44) --- *(4): 
[1] (2:44) --- *(4): 
[1] (2:44) --- *(4): quit
[1] (2:44) [*] <== finished processing the string
[1] (2:44) --- *(4): quit
[1] (2:44) --- *(3): 
[1] (2:44) --- *(3): !*** Write 1 block + 1 byte to a new file
[1] (2:44) --- !*** Write 1 block + 1 byte to a new file
[1] (2:44) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (2:44) --- *(3): set data1 ("1" * ($block_size + 1))
[1] (2:44) --- *(3): write $fd1 $data1
[1] (2:44) --- *(3): 
[1] (2:44) --- *(3): !*** Clone the fileset and mount the clone
[1] (2:44) --- !*** Clone the fileset and mount the clone
[1] (2:44) --- *(3): set clone_name ($fset_name + ".clone")
[1] (2:45) --- *(3): set clone_id ($fset_id + 1)
[1] (2:45) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (2:45) --- *(3): mountFset $clone_id $mount_point[1]
[1] (2:45) --- *(3): 
[1] (2:46) --- *(3): !*** Write another 1 block + 1 byte
[1] (2:46) --- !*** Write another 1 block + 1 byte
[1] (2:46) --- *(3): set data2 ("2" * ($block_size + 1))
[1] (2:46) --- *(3): write $fd1 $data2
[1] (2:46) --- *(3): close $fd1
[1] (2:46) --- *(3): 
[1] (2:46) --- *(3): !*** Open the original file and read the data
[1] (2:46) --- !*** Open the original file and read the data
[1] (2:46) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (2:46) --- *(3): read $fd1 ($block_size + 1) read_data1
[1] (2:46) --- *(3): assert ($read_data1 == $data1)
[1] (2:46) --- *(3): read $fd1 ($block_size + 1) read_data2
[1] (2:46) --- *(3): assert ($read_data2 == $data2)
[1] (2:46) --- *(3): close $fd1
[1] (2:46) --- *(3): 
[1] (2:46) --- *(3): !*** Try to read the data in the clone
[1] (2:46) --- !*** Try to read the data in the clone
[1] (2:46) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (2:47) --- *(3): read $fd2 ($block_size + 1) clone_data
[1] (2:47) --- *(3): assert ($clone_data == $data1)
[1] (2:47) --- *(3): verifyStatus false
[1] (2:47) [*] Using false  for Verify Status.
[1] (2:47) --- Status verification is OFF
[1] (2:47) --- *(3): read $fd2 ($block_size + 1) clone_data
[1] (2:47) --- *(3): assert (($ITL_Status == 0) && ($CommandResult == 0))
[1] (2:47) --- *(3): verifyStatus true
[1] (2:47) [*] Using true  for Verify Status.
[1] (2:47) --- Status verification is ON
[1] (2:47) --- *(3): close $fd2
[1] (2:47) --- *(3): 
[1] (2:47) --- *(3): !*** Unmount the filesets
[1] (2:47) --- !*** Unmount the filesets
[1] (2:47) --- *(3): unmountFset $mount_point[0]
[1] (2:48) --- *(3): unmountFset $mount_point[1]
[1] (2:48) --- *(3): 
[1] (2:48) --- *(3): include "shutdown.itl"
[1] (2:48) [*] Opening the file shutdown.itl
[1] (2:48) [*] Trying to open the file scripts/shutdown.itl
[1] (2:48) --- *(4): *
[1] (2:48) --- *(4): * @OSF_COPYRIGHT@
[1] (2:48) --- *(4): * COPYRIGHT NOTICE
[1] (2:49) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:49) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:49) --- *(4): * src directory for the full copyright text.
[1] (2:49) --- *(4): *
[1] (2:49) --- *(4): * HISTORY
[1] (2:49) --- *(4): * $Log: shutdown.itl,v $
[1] (2:49) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (2:49) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (2:49) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (2:49) --- *(4): *
[1] (2:49) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (2:49) --- *(4): * 	1.0.3a update from Transarc
[1] (2:49) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (2:49) --- *(4): * 
[1] (2:49) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (2:49) --- *(4): * 	Embedded copyright notice
[1] (2:50) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (2:50) --- *(4): * 
[1] (2:50) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (2:50) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:50) --- *(4): * 	  Selected comments:
[1] (2:50) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:50) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:50) --- *(4): * 	    and adds all of the test scripts.
[1] (2:50) --- *(4): * 	    Shutdown a test case.
[1] (2:50) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (2:50) --- *(4): * 
[1] (2:50) --- *(4): * $EndLog$
[1] (2:50) --- *(4): *
[1] (2:50) --- *(4): 
[1] (2:50) --- *(4): exec shutdown_fset
[1] (2:50) --- *(4): 
[1] (2:50) --- *(4): !*** Destroy the fileset
[1] (2:50) --- !*** Destroy the fileset
[1] (2:50) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (2:51) --- *(4): 
[1] (2:51) --- *(4): 
[1] (2:51) --- *(4): quit
[1] (2:51) [*] <== finished processing the string
[1] (2:51) --- *(4): exec shutdown_aggr
[1] (2:51) --- *(4): 
[1] (2:51) --- *(4): !*** Shutdown the aggregate
[1] (2:51) --- !*** Shutdown the aggregate
[1] (2:51) --- *(4): 	detachAggr $aggr_id
[1] (2:51) --- *(4): 	verifyAggr $device
[1] (2:52) --- *(4): 
[1] (2:52) --- *(4): 
[1] (2:52) --- *(4): quit
[1] (2:52) [*] <== finished processing the string
[1] (2:52) --- *(4): quit
[1] (2:52) --- *(3): quit
[1] (2:52) --- *(2): quit
[1] (2:52) --- *(1): 
[1] (2:52) --- *(1): include "reclone.itl"
[1] (2:52) [*] Opening the file reclone.itl
[1] (2:52) [*] Trying to open the file scripts/reclone.itl
[1] (2:52) --- *(2): *
[1] (2:52) --- *(2): * @OSF_COPYRIGHT@
[1] (2:52) --- *(2): * COPYRIGHT NOTICE
[1] (2:53) --- *(2): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:53) --- *(2): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:53) --- *(2): * src directory for the full copyright text.
[1] (2:53) --- *(2): *
[1] (2:53) --- *(2): * HISTORY
[1] (2:53) --- *(2): * $Log: reclone.itl,v $
[1] (2:53) --- *(2): * Revision 1.1.2.3  1993/01/11  18:27:45  htf
[1] (2:53) --- *(2): * 	Embedded copyright notice
[1] (2:53) --- *(2): * 	[1993/01/11  17:02:48  htf]
[1] (2:53) --- *(2): *
[1] (2:53) --- *(2): * Revision 1.1.2.2  1992/10/28  16:33:29  jaffe
[1] (2:53) --- *(2): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:53) --- *(2): * 	  Selected comments:
[1] (2:53) --- *(2): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:54) --- *(2): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:54) --- *(2): * 	    and adds all of the test scripts.
[1] (2:54) --- *(2): * 	    Run all of the reclone tests.
[1] (2:54) --- *(2): * 	[1992/10/27  19:02:52  jaffe]
[1] (2:54) --- *(2): * 
[1] (2:54) --- *(2): * $EndLog$
[1] (2:54) --- *(2): *
[1] (2:54) --- *(2): 
[1] (2:54) --- *(2): include "reclone00.itl"
[1] (2:54) [*] Opening the file reclone00.itl
[1] (2:54) [*] Trying to open the file scripts/reclone00.itl
[1] (2:54) --- *(3): *
[1] (2:54) --- *(3): * @OSF_COPYRIGHT@
[1] (2:54) --- *(3): * COPYRIGHT NOTICE
[1] (2:54) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:54) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:54) --- *(3): * src directory for the full copyright text.
[1] (2:54) --- *(3): *
[1] (2:55) --- *(3): * HISTORY
[1] (2:55) --- *(3): * $Log: reclone00.itl,v $
[1] (2:55) --- *(3): * Revision 1.1.420.1  1994/02/04  20:41:46  devsrc
[1] (2:55) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (2:55) --- *(3): * 	[1994/02/04  15:22:58  devsrc]
[1] (2:55) --- *(3): *
[1] (2:55) --- *(3): * Revision 1.1.418.1  1993/12/07  17:42:31  jaffe
[1] (2:55) --- *(3): * 	1.0.3a update from Transarc
[1] (2:55) --- *(3): * 	[1993/12/03  18:59:01  jaffe]
[1] (2:55) --- *(3): * 
[1] (2:55) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:47  htf
[1] (2:55) --- *(3): * 	Embedded copyright notice
[1] (2:55) --- *(3): * 	[1993/01/11  17:02:51  htf]
[1] (2:55) --- *(3): * 
[1] (2:55) --- *(3): * Revision 1.1.2.2  1992/10/28  16:33:37  jaffe
[1] (2:55) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (2:55) --- *(3): * 	  Selected comments:
[1] (2:56) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (2:56) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (2:56) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (2:56) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (2:56) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (2:56) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (2:56) --- *(3): * 	    last argument to the command.
[1] (2:57) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (2:57) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (2:57) --- *(3): * 	    variable by the open and opendir comands.
[1] (2:57) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (2:57) --- *(3): * 	    described above.
[1] (2:57) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (2:57) --- *(3): * 	    Cleanup debugging code.
[1] (2:57) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:57) --- *(3): * 	  Selected comments:
[1] (2:57) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:58) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:58) --- *(3): * 	    and adds all of the test scripts.
[1] (2:58) --- *(3): * 	    Reclone test.
[1] (2:58) --- *(3): * 	[1992/10/27  19:03:23  jaffe]
[1] (2:58) --- *(3): * 
[1] (2:58) --- *(3): * $EndLog$
[1] (2:58) --- *(3): *
[1] (2:58) --- *(3): 
[1] (2:58) --- *(3): !**********************************************************
[1] (2:58) --- !**********************************************************
[1] (2:58) --- *(3): !*** Reclone a fileset so that a file open in the read-only
[1] (2:58) --- !*** Reclone a fileset so that a file open in the read-only
[1] (2:58) --- *(3): !*** fileset gets deleted.
[1] (2:58) --- !*** fileset gets deleted.
[1] (2:58) --- *(3): !**********************************************************
[1] (2:58) --- !**********************************************************
[1] (2:58) --- *(3): 
[1] (2:58) --- *(3): include "setup.itl"
[1] (2:58) [*] Opening the file setup.itl
[1] (2:58) [*] Trying to open the file scripts/setup.itl
[1] (2:58) --- *(4): *
[1] (2:58) --- *(4): * @OSF_COPYRIGHT@
[1] (2:58) --- *(4): * COPYRIGHT NOTICE
[1] (2:58) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (2:59) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (2:59) --- *(4): * src directory for the full copyright text.
[1] (2:59) --- *(4): *
[1] (2:59) --- *(4): * HISTORY
[1] (2:59) --- *(4): * $Log: setup.itl,v $
[1] (2:59) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (2:59) --- *(4): * 	Embedded copyright notice
[1] (2:59) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (2:59) --- *(4): *
[1] (2:59) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (2:59) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (2:59) --- *(4): * 	  Selected comments:
[1] (2:59) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (2:59) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (2:59) --- *(4): * 	    and adds all of the test scripts.
[1] (3:00) --- *(4): * 	    Setup for a test case.
[1] (3:00) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (3:00) --- *(4): * 
[1] (3:00) --- *(4): * $EndLog$
[1] (3:00) --- *(4): *
[1] (3:00) --- *(4): 
[1] (3:00) --- *(4): include "defaults.itl"
[1] (3:00) [*] Opening the file defaults.itl
[1] (3:00) [*] Trying to open the file scripts/defaults.itl
[1] (3:00) --- *(5): *
[1] (3:00) --- *(5): * @OSF_COPYRIGHT@
[1] (3:00) --- *(5): * COPYRIGHT NOTICE
[1] (3:00) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:00) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:00) --- *(5): * src directory for the full copyright text.
[1] (3:00) --- *(5): *
[1] (3:00) --- *(5): * HISTORY
[1] (3:00) --- *(5): * $Log: defaults.itl,v $
[1] (3:00) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (3:00) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (3:00) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (3:00) --- *(5): *
[1] (3:01) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (3:01) --- *(5): * 	1.0.3a update from Transarc
[1] (3:01) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (3:01) --- *(5): * 
[1] (3:01) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (3:01) --- *(5): * 	Embedded copyright notice
[1] (3:01) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (3:01) --- *(5): * 
[1] (3:01) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (3:01) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:01) --- *(5): * 	  Selected comments:
[1] (3:01) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:01) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:01) --- *(5): * 	    and adds all of the test scripts.
[1] (3:02) --- *(5): * 	    Set default variables from environment.
[1] (3:02) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (3:02) --- *(5): * 
[1] (3:02) --- *(5): * $EndLog$
[1] (3:02) --- *(5): *
[1] (3:02) --- *(5): 
[1] (3:02) --- *(5): * The following three resources must exist before testing begins
[1] (3:02) --- *(5): getenv FSET_DEVICE
[1] (3:02) --- *(5): if ($FSET_DEVICE == "") {
[1] (3:02) --- *(5): 	set device $FSET_DEVICE
[1] (3:02) --- *(5): }
[1] (3:02) --- *(5): 
[1] (3:02) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (3:02) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (3:02) --- *(5): 	set mount_point[0] "/mnt"
[1] (3:02) --- *(5): } else {
[1] (3:02) --- *(5): 
[1] (3:02) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (3:02) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (3:02) --- *(5): 	set mount_point[1] "/mnt2"
[1] (3:02) --- *(5): } else {
[1] (3:03) --- *(5): 
[1] (3:03) --- *(5): 
[1] (3:03) --- *(5): getenv FSET_AGGR_ID
[1] (3:03) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (3:03) --- *(5): 	set aggr_id 1000
[1] (3:03) --- *(5): } else {
[1] (3:03) --- *(5): 
[1] (3:03) --- *(5): getenv FSET_BLOCK_SIZE
[1] (3:03) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (3:03) --- *(5): 	set block_size 8192
[1] (3:03) --- *(5): } else {
[1] (3:03) --- *(5): 
[1] (3:03) --- *(5): getenv FSET_FRAG_SIZE
[1] (3:03) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (3:03) --- *(5): 	set frag_size 1024
[1] (3:03) --- *(5): } else {
[1] (3:03) --- *(5): 
[1] (3:03) --- *(5): set aggr_name	$device
[1] (3:03) --- *(5): set aggr_type	"lfs"
[1] (3:03) --- *(5): 
[1] (3:03) --- *(5): set fset_id   ($aggr_id + 1)
[1] (3:04) --- *(5): set fset_name ("fset" + $fset_id)
[1] (3:04) --- *(5): 
[1] (3:04) --- *(5): set file_name		"zappa"
[1] (3:04) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (3:04) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (3:04) --- *(5): 
[1] (3:04) --- *(5): set setup_aggr proc END
[1] (3:04) --- *(5): !*** Setup the aggregate
[1] (3:04) --- *(5): 	initAggr @device @block_size @frag_size
[1] (3:04) --- *(5): 	verifyAggr @device
[1] (3:04) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (3:04) --- *(5): END
[1] (3:04) --- *(5): 
[1] (3:04) --- *(5): set setup_fset proc END
[1] (3:04) --- *(5): !*** Create and mount a fileset
[1] (3:04) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (3:04) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (3:04) --- *(5): END
[1] (3:04) --- *(5): 
[1] (3:04) --- *(5): set shutdown_fset proc END
[1] (3:05) --- *(5): !*** Destroy the fileset
[1] (3:05) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (3:05) --- *(5): END
[1] (3:05) --- *(5): 
[1] (3:05) --- *(5): set shutdown_aggr proc END
[1] (3:05) --- *(5): !*** Shutdown the aggregate
[1] (3:05) --- *(5): 	detachAggr @aggr_id
[1] (3:05) --- *(5): 	verifyAggr @device
[1] (3:05) --- *(5): END
[1] (3:05) --- *(5): 
[1] (3:05) --- *(5): quit
[1] (3:05) --- *(4): 
[1] (3:05) --- *(4): exec setup_aggr
[1] (3:05) --- *(4): 
[1] (3:05) --- *(4): !*** Setup the aggregate
[1] (3:05) --- !*** Setup the aggregate
[1] (3:05) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (3:11) --- *(4): 	verifyAggr $device
[1] (3:12) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (3:12) --- *(4): 
[1] (3:12) --- *(4): 
[1] (3:12) --- *(4): quit
[1] (3:12) [*] <== finished processing the string
[1] (3:12) --- *(4): exec setup_fset
[1] (3:12) --- *(4): 
[1] (3:12) --- *(4): !*** Create and mount a fileset
[1] (3:12) --- !*** Create and mount a fileset
[1] (3:12) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (3:12) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (3:13) --- *(4): 
[1] (3:13) --- *(4): 
[1] (3:13) --- *(4): quit
[1] (3:13) [*] <== finished processing the string
[1] (3:13) --- *(4): quit
[1] (3:13) --- *(3): 
[1] (3:13) --- *(3): !*** Create a 1-block file
[1] (3:13) --- !*** Create a 1-block file
[1] (3:13) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (3:13) --- *(3): set data ("1" * $block_size)
[1] (3:13) --- *(3): write $fd1 $data
[1] (3:13) --- *(3): close $fd1
[1] (3:13) --- *(3): 
[1] (3:13) --- *(3): !*** Clone the original fileset and mount the clone
[1] (3:13) --- !*** Clone the original fileset and mount the clone
[1] (3:14) --- *(3): set clone_name ($fset_name + ".clone")
[1] (3:14) --- *(3): set clone_id ($fset_id + 1)
[1] (3:14) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (3:14) --- *(3): mountFset $clone_id $mount_point[1]
[1] (3:15) --- *(3): 
[1] (3:15) --- *(3): !*** Open file in read-only fileset
[1] (3:15) --- !*** Open file in read-only fileset
[1] (3:15) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (3:15) --- *(3): 
[1] (3:15) --- *(3): !*** Remove file in read/write fileset
[1] (3:15) --- !*** Remove file in read/write fileset
[1] (3:15) --- *(3): remove $path_name[0]
[1] (3:15) --- *(3): 
[1] (3:15) --- *(3): !*** Reclone read/write fileset
[1] (3:15) --- !*** Reclone read/write fileset
[1] (3:15) --- *(3): recloneFset $aggr_id $fset_id
[1] (3:15) --- *(3): 
[1] (3:15) --- *(3): !*** Attempt to read the deleted file in the read-only
[1] (3:15) --- !*** Attempt to read the deleted file in the read-only
[1] (3:16) --- *(3): !***    fileset (expect ESTALE)
[1] (3:16) --- !***    fileset (expect ESTALE)
[1] (3:16) --- *(3): verifyStatus false
[1] (3:16) [*] Using false  for Verify Status.
[1] (3:16) --- Status verification is OFF
[1] (3:16) --- *(3): read $fd2 $block_size junk
[1] (3:16) --- *(3): assert ($ITL_Status == $ESTALE)
[1] (3:16) --- *(3): 
[1] (3:16) --- *(3): !*** Close the file in the read-only fileset
[1] (3:16) --- !*** Close the file in the read-only fileset
[1] (3:16) --- *(3): close $fd2
[1] (3:16) --- *(3): assert ($ITL_Status == $ESTALE)
[1] (3:16) --- *(3): verifyStatus true
[1] (3:16) [*] Using true  for Verify Status.
[1] (3:16) --- Status verification is ON
[1] (3:16) --- *(3): 
[1] (3:16) --- *(3): !*** Unmount filesets
[1] (3:16) --- !*** Unmount filesets
[1] (3:16) --- *(3): unmountFset $mount_point[0]
[1] (3:17) --- *(3): unmountFset $mount_point[1]
[1] (3:17) --- *(3): 
[1] (3:17) --- *(3): include "shutdown.itl"
[1] (3:17) [*] Opening the file shutdown.itl
[1] (3:17) [*] Trying to open the file scripts/shutdown.itl
**** Assertion warning. cma__open_general: file descriptor is already open
     at line 1230 in /afs/transarc.com/project/fs/osf/dce1.2/src/threads/RIOS/cma_thread_io.c pid = 23258
[1] (3:17) --- *(4): *
[1] (3:17) --- *(4): * @OSF_COPYRIGHT@
[1] (3:18) --- *(4): * COPYRIGHT NOTICE
[1] (3:18) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:18) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:18) --- *(4): * src directory for the full copyright text.
[1] (3:18) --- *(4): *
[1] (3:18) --- *(4): * HISTORY
[1] (3:18) --- *(4): * $Log: shutdown.itl,v $
[1] (3:18) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (3:18) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (3:18) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (3:18) --- *(4): *
[1] (3:18) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (3:18) --- *(4): * 	1.0.3a update from Transarc
[1] (3:18) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (3:18) --- *(4): * 
[1] (3:19) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (3:19) --- *(4): * 	Embedded copyright notice
[1] (3:19) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (3:19) --- *(4): * 
[1] (3:19) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (3:19) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:19) --- *(4): * 	  Selected comments:
[1] (3:19) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:19) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:19) --- *(4): * 	    and adds all of the test scripts.
[1] (3:19) --- *(4): * 	    Shutdown a test case.
[1] (3:19) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (3:19) --- *(4): * 
[1] (3:19) --- *(4): * $EndLog$
[1] (3:19) --- *(4): *
[1] (3:19) --- *(4): 
[1] (3:19) --- *(4): exec shutdown_fset
[1] (3:19) --- *(4): 
[1] (3:19) --- *(4): !*** Destroy the fileset
[1] (3:19) --- !*** Destroy the fileset
[1] (3:19) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (3:20) --- *(4): 
[1] (3:20) --- *(4): 
[1] (3:20) --- *(4): quit
[1] (3:20) [*] <== finished processing the string
[1] (3:20) --- *(4): exec shutdown_aggr
[1] (3:20) --- *(4): 
[1] (3:20) --- *(4): !*** Shutdown the aggregate
[1] (3:20) --- !*** Shutdown the aggregate
[1] (3:20) --- *(4): 	detachAggr $aggr_id
[1] (3:20) --- *(4): 	verifyAggr $device
[1] (3:21) --- *(4): 
[1] (3:21) --- *(4): 
[1] (3:21) --- *(4): quit
[1] (3:21) [*] <== finished processing the string
[1] (3:21) --- *(4): quit
[1] (3:21) --- *(3): quit
[1] (3:21) --- *(2): 
[1] (3:21) --- *(2): include "reclone01.itl"
[1] (3:21) [*] Opening the file reclone01.itl
[1] (3:21) [*] Trying to open the file scripts/reclone01.itl
[1] (3:21) --- *(3): *
[1] (3:22) --- *(3): * @OSF_COPYRIGHT@
[1] (3:22) --- *(3): * COPYRIGHT NOTICE
[1] (3:22) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:22) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:22) --- *(3): * src directory for the full copyright text.
[1] (3:22) --- *(3): *
[1] (3:22) --- *(3): * HISTORY
[1] (3:22) --- *(3): * $Log: reclone01.itl,v $
[1] (3:22) --- *(3): * Revision 1.1.421.1  1994/02/04  20:41:48  devsrc
[1] (3:22) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (3:22) --- *(3): * 	[1994/02/04  15:22:59  devsrc]
[1] (3:22) --- *(3): *
[1] (3:22) --- *(3): * Revision 1.1.419.1  1993/12/07  17:42:33  jaffe
[1] (3:22) --- *(3): * 	1.0.3a update from Transarc
[1] (3:22) --- *(3): * 	[1993/12/03  18:59:19  jaffe]
[1] (3:22) --- *(3): * 
[1] (3:23) --- *(3): * Revision 1.1.2.4  1993/01/11  18:27:48  htf
[1] (3:23) --- *(3): * 	Embedded copyright notice
[1] (3:23) --- *(3): * 	[1993/01/11  17:02:56  htf]
[1] (3:23) --- *(3): * 
[1] (3:23) --- *(3): * Revision 1.1.2.3  1992/12/09  21:31:55  jaffe
[1] (3:23) --- *(3): * 	Transarc delta: jaffe-fix-2.2-test-build 1.2
[1] (3:23) --- *(3): * 	  Selected comments:
[1] (3:23) --- *(3): * 
[1] (3:23) --- *(3): * 	    Fix the script to handle itl failing on incomplete reads.
[1] (3:23) --- *(3): * 	[1992/12/04  20:27:16  jaffe]
[1] (3:23) --- *(3): * 
[1] (3:23) --- *(3): * Revision 1.1.2.2  1992/10/28  16:33:50  jaffe
[1] (3:23) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (3:23) --- *(3): * 	  Selected comments:
[1] (3:23) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (3:24) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (3:24) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (3:24) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (3:24) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (3:24) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (3:24) --- *(3): * 	    last argument to the command.
[1] (3:24) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (3:24) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (3:25) --- *(3): * 	    variable by the open and opendir comands.
[1] (3:25) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (3:25) --- *(3): * 	    described above.
[1] (3:25) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (3:25) --- *(3): * 	    Cleanup debugging code.
[1] (3:25) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:25) --- *(3): * 	  Selected comments:
[1] (3:25) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:25) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:25) --- *(3): * 	    and adds all of the test scripts.
[1] (3:25) --- *(3): * 	    Reclone test.
[1] (3:26) --- *(3): * 	[1992/10/27  19:04:15  jaffe]
[1] (3:26) --- *(3): * 
[1] (3:26) --- *(3): * $EndLog$
[1] (3:26) --- *(3): *
[1] (3:26) --- *(3): 
[1] (3:26) --- *(3): !**********************************************************
[1] (3:26) --- !**********************************************************
[1] (3:26) --- *(3): !*** Reclone a fileset so that a file open in the read-only
[1] (3:26) --- !*** Reclone a fileset so that a file open in the read-only
[1] (3:26) --- *(3): !*** fileset gets truncated.
[1] (3:26) --- !*** fileset gets truncated.
[1] (3:26) --- *(3): !**********************************************************
[1] (3:26) --- !**********************************************************
[1] (3:26) --- *(3): 
[1] (3:26) --- *(3): include "setup.itl"
[1] (3:26) [*] Opening the file setup.itl
[1] (3:26) [*] Trying to open the file scripts/setup.itl
[1] (3:26) --- *(4): *
[1] (3:26) --- *(4): * @OSF_COPYRIGHT@
[1] (3:26) --- *(4): * COPYRIGHT NOTICE
[1] (3:26) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:26) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:26) --- *(4): * src directory for the full copyright text.
[1] (3:26) --- *(4): *
[1] (3:27) --- *(4): * HISTORY
[1] (3:27) --- *(4): * $Log: setup.itl,v $
[1] (3:27) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (3:27) --- *(4): * 	Embedded copyright notice
[1] (3:27) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (3:27) --- *(4): *
[1] (3:27) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (3:27) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:27) --- *(4): * 	  Selected comments:
[1] (3:27) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:27) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:27) --- *(4): * 	    and adds all of the test scripts.
[1] (3:27) --- *(4): * 	    Setup for a test case.
[1] (3:27) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (3:27) --- *(4): * 
[1] (3:27) --- *(4): * $EndLog$
[1] (3:27) --- *(4): *
[1] (3:27) --- *(4): 
[1] (3:28) --- *(4): include "defaults.itl"
[1] (3:28) [*] Opening the file defaults.itl
[1] (3:28) [*] Trying to open the file scripts/defaults.itl
[1] (3:28) --- *(5): *
[1] (3:28) --- *(5): * @OSF_COPYRIGHT@
[1] (3:28) --- *(5): * COPYRIGHT NOTICE
[1] (3:28) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:28) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:28) --- *(5): * src directory for the full copyright text.
[1] (3:28) --- *(5): *
[1] (3:28) --- *(5): * HISTORY
[1] (3:28) --- *(5): * $Log: defaults.itl,v $
[1] (3:28) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (3:28) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (3:28) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (3:28) --- *(5): *
[1] (3:28) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (3:28) --- *(5): * 	1.0.3a update from Transarc
[1] (3:28) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (3:28) --- *(5): * 
[1] (3:29) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (3:29) --- *(5): * 	Embedded copyright notice
[1] (3:29) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (3:29) --- *(5): * 
[1] (3:29) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (3:29) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:29) --- *(5): * 	  Selected comments:
[1] (3:29) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:29) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:29) --- *(5): * 	    and adds all of the test scripts.
[1] (3:29) --- *(5): * 	    Set default variables from environment.
[1] (3:29) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (3:29) --- *(5): * 
[1] (3:29) --- *(5): * $EndLog$
[1] (3:29) --- *(5): *
[1] (3:29) --- *(5): 
[1] (3:30) --- *(5): * The following three resources must exist before testing begins
[1] (3:30) --- *(5): getenv FSET_DEVICE
[1] (3:30) --- *(5): if ($FSET_DEVICE == "") {
[1] (3:30) --- *(5): 	set device $FSET_DEVICE
[1] (3:30) --- *(5): }
[1] (3:30) --- *(5): 
[1] (3:30) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (3:30) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (3:30) --- *(5): 	set mount_point[0] "/mnt"
[1] (3:30) --- *(5): } else {
[1] (3:30) --- *(5): 
[1] (3:30) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (3:30) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (3:30) --- *(5): 	set mount_point[1] "/mnt2"
[1] (3:30) --- *(5): } else {
[1] (3:30) --- *(5): 
[1] (3:30) --- *(5): 
[1] (3:30) --- *(5): getenv FSET_AGGR_ID
[1] (3:30) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (3:31) --- *(5): 	set aggr_id 1000
[1] (3:31) --- *(5): } else {
[1] (3:31) --- *(5): 
[1] (3:31) --- *(5): getenv FSET_BLOCK_SIZE
[1] (3:31) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (3:31) --- *(5): 	set block_size 8192
[1] (3:31) --- *(5): } else {
[1] (3:31) --- *(5): 
[1] (3:31) --- *(5): getenv FSET_FRAG_SIZE
[1] (3:31) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (3:31) --- *(5): 	set frag_size 1024
[1] (3:31) --- *(5): } else {
[1] (3:31) --- *(5): 
[1] (3:31) --- *(5): set aggr_name	$device
[1] (3:31) --- *(5): set aggr_type	"lfs"
[1] (3:31) --- *(5): 
[1] (3:31) --- *(5): set fset_id   ($aggr_id + 1)
[1] (3:31) --- *(5): set fset_name ("fset" + $fset_id)
[1] (3:31) --- *(5): 
[1] (3:31) --- *(5): set file_name		"zappa"
[1] (3:31) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (3:32) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (3:32) --- *(5): 
[1] (3:32) --- *(5): set setup_aggr proc END
[1] (3:32) --- *(5): !*** Setup the aggregate
[1] (3:32) --- *(5): 	initAggr @device @block_size @frag_size
[1] (3:32) --- *(5): 	verifyAggr @device
[1] (3:32) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (3:32) --- *(5): END
[1] (3:32) --- *(5): 
[1] (3:32) --- *(5): set setup_fset proc END
[1] (3:32) --- *(5): !*** Create and mount a fileset
[1] (3:32) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (3:32) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (3:32) --- *(5): END
[1] (3:32) --- *(5): 
[1] (3:32) --- *(5): set shutdown_fset proc END
[1] (3:32) --- *(5): !*** Destroy the fileset
[1] (3:32) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (3:32) --- *(5): END
[1] (3:32) --- *(5): 
[1] (3:32) --- *(5): set shutdown_aggr proc END
[1] (3:33) --- *(5): !*** Shutdown the aggregate
[1] (3:33) --- *(5): 	detachAggr @aggr_id
[1] (3:33) --- *(5): 	verifyAggr @device
[1] (3:33) --- *(5): END
[1] (3:33) --- *(5): 
[1] (3:33) --- *(5): quit
[1] (3:33) --- *(4): 
[1] (3:33) --- *(4): exec setup_aggr
[1] (3:33) --- *(4): 
[1] (3:33) --- *(4): !*** Setup the aggregate
[1] (3:33) --- !*** Setup the aggregate
[1] (3:33) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (3:38) --- *(4): 	verifyAggr $device
[1] (3:39) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (3:39) --- *(4): 
[1] (3:39) --- *(4): 
[1] (3:39) --- *(4): quit
[1] (3:39) [*] <== finished processing the string
[1] (3:39) --- *(4): exec setup_fset
[1] (3:39) --- *(4): 
[1] (3:39) --- *(4): !*** Create and mount a fileset
[1] (3:39) --- !*** Create and mount a fileset
[1] (3:39) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (3:40) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (3:40) --- *(4): 
[1] (3:40) --- *(4): 
[1] (3:40) --- *(4): quit
[1] (3:40) [*] <== finished processing the string
[1] (3:40) --- *(4): quit
[1] (3:40) --- *(3): 
[1] (3:40) --- *(3): !*** Create a 1-block file
[1] (3:40) --- !*** Create a 1-block file
[1] (3:40) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (3:40) --- *(3): set data ("1" * $block_size)
[1] (3:40) --- *(3): write $fd1 $data
[1] (3:41) --- *(3): close $fd1
[1] (3:41) --- *(3): 
[1] (3:41) --- *(3): !*** Clone the original fileset and mount the clone
[1] (3:41) --- !*** Clone the original fileset and mount the clone
[1] (3:41) --- *(3): set clone_name ($fset_name + ".clone")
[1] (3:41) --- *(3): set clone_id ($fset_id + 1)
[1] (3:41) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (3:41) --- *(3): mountFset $clone_id $mount_point[1]
[1] (3:42) --- *(3): 
[1] (3:42) --- *(3): !*** Open file in read-only fileset
[1] (3:42) --- !*** Open file in read-only fileset
[1] (3:42) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (3:42) --- *(3): 
[1] (3:42) --- *(3): !*** Truncate file in read/write fileset
[1] (3:42) --- !*** Truncate file in read/write fileset
[1] (3:42) --- *(3): open $path_name[0] ($O_TRUNC|$O_WRONLY) 0 fd1
[1] (3:42) --- *(3): close $fd1
[1] (3:42) --- *(3): 
[1] (3:42) --- *(3): !*** Reclone read/write fileset
[1] (3:42) --- !*** Reclone read/write fileset
[1] (3:42) --- *(3): recloneFset $aggr_id $fset_id
[1] (3:42) --- *(3): 
[1] (3:42) --- *(3): !*** Attempt to read the truncated file in the read-only
[1] (3:42) --- !*** Attempt to read the truncated file in the read-only
[1] (3:42) --- *(3): !***    fileset
[1] (3:42) --- !***    fileset
[1] (3:42) --- *(3): verifyStatus false
[1] (3:42) [*] Using false  for Verify Status.
[1] (3:43) --- Status verification is OFF
[1] (3:43) --- *(3): read $fd2 $block_size read_data
[1] (3:43) --- *(3): assert (($ITL_Status == 0) && ($CommandResult == 0))
[1] (3:43) --- *(3): verifyStatus true
[1] (3:43) [*] Using true  for Verify Status.
[1] (3:43) --- Status verification is ON
[1] (3:43) --- *(3): 
[1] (3:43) --- *(3): !*** Seek out a few blocks and try to read again
[1] (3:43) --- !*** Seek out a few blocks and try to read again
[1] (3:43) --- *(3): lseek $fd2 $SEEK_SET (100 * $block_size)
[1] (3:43) --- *(3): verifyStatus false
[1] (3:43) [*] Using false  for Verify Status.
[1] (3:43) --- Status verification is OFF
[1] (3:43) --- *(3): read $fd2 3 read_data
[1] (3:43) --- *(3): assert (($ITL_Status == 0) && ($CommandResult == 0))
[1] (3:43) --- *(3): verifyStatus true
[1] (3:43) [*] Using true  for Verify Status.
[1] (3:43) --- Status verification is ON
[1] (3:43) --- *(3): 
[1] (3:43) --- *(3): !*** Close the file in the read-only fileset
[1] (3:43) --- !*** Close the file in the read-only fileset
[1] (3:43) --- *(3): close $fd2
[1] (3:43) --- *(3): 
[1] (3:43) --- *(3): !*** Unmount filesets
[1] (3:43) --- !*** Unmount filesets
[1] (3:43) --- *(3): unmountFset $mount_point[0]
[1] (3:44) --- *(3): unmountFset $mount_point[1]
[1] (3:45) --- *(3): 
[1] (3:45) --- *(3): include "shutdown.itl"
[1] (3:45) [*] Opening the file shutdown.itl
[1] (3:45) [*] Trying to open the file scripts/shutdown.itl
[1] (3:45) --- *(4): *
[1] (3:45) --- *(4): * @OSF_COPYRIGHT@
[1] (3:45) --- *(4): * COPYRIGHT NOTICE
[1] (3:45) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:45) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:45) --- *(4): * src directory for the full copyright text.
[1] (3:45) --- *(4): *
[1] (3:45) --- *(4): * HISTORY
[1] (3:45) --- *(4): * $Log: shutdown.itl,v $
[1] (3:45) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (3:45) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (3:45) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (3:45) --- *(4): *
[1] (3:46) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (3:46) --- *(4): * 	1.0.3a update from Transarc
[1] (3:46) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (3:46) --- *(4): * 
[1] (3:46) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (3:46) --- *(4): * 	Embedded copyright notice
[1] (3:46) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (3:46) --- *(4): * 
[1] (3:46) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (3:46) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:46) --- *(4): * 	  Selected comments:
[1] (3:46) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:46) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:46) --- *(4): * 	    and adds all of the test scripts.
[1] (3:47) --- *(4): * 	    Shutdown a test case.
[1] (3:47) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (3:47) --- *(4): * 
[1] (3:47) --- *(4): * $EndLog$
[1] (3:47) --- *(4): *
[1] (3:47) --- *(4): 
[1] (3:47) --- *(4): exec shutdown_fset
[1] (3:47) --- *(4): 
[1] (3:47) --- *(4): !*** Destroy the fileset
[1] (3:47) --- !*** Destroy the fileset
[1] (3:47) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (3:47) --- *(4): 
[1] (3:47) --- *(4): 
[1] (3:47) --- *(4): quit
[1] (3:47) [*] <== finished processing the string
[1] (3:47) --- *(4): exec shutdown_aggr
[1] (3:47) --- *(4): 
[1] (3:47) --- *(4): !*** Shutdown the aggregate
[1] (3:47) --- !*** Shutdown the aggregate
[1] (3:47) --- *(4): 	detachAggr $aggr_id
[1] (3:47) --- *(4): 	verifyAggr $device
[1] (3:48) --- *(4): 
[1] (3:48) --- *(4): 
[1] (3:48) --- *(4): quit
[1] (3:48) [*] <== finished processing the string
[1] (3:48) --- *(4): quit
[1] (3:48) --- *(3): quit
[1] (3:48) --- *(2): 
[1] (3:48) --- *(2): include "reclone02.itl"
[1] (3:48) [*] Opening the file reclone02.itl
[1] (3:48) [*] Trying to open the file scripts/reclone02.itl
[1] (3:49) --- *(3): *
[1] (3:49) --- *(3): * @OSF_COPYRIGHT@
[1] (3:49) --- *(3): * COPYRIGHT NOTICE
[1] (3:49) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:49) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:49) --- *(3): * src directory for the full copyright text.
[1] (3:49) --- *(3): *
[1] (3:49) --- *(3): * HISTORY
[1] (3:49) --- *(3): * $Log: reclone02.itl,v $
[1] (3:49) --- *(3): * Revision 1.1.422.1  1994/02/04  20:41:49  devsrc
[1] (3:49) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (3:49) --- *(3): * 	[1994/02/04  15:23:00  devsrc]
[1] (3:49) --- *(3): *
[1] (3:49) --- *(3): * Revision 1.1.420.1  1993/12/07  17:42:35  jaffe
[1] (3:50) --- *(3): * 	1.0.3a update from Transarc
[1] (3:50) --- *(3): * 	[1993/12/03  18:59:38  jaffe]
[1] (3:50) --- *(3): * 
[1] (3:50) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:50  htf
[1] (3:50) --- *(3): * 	Embedded copyright notice
[1] (3:50) --- *(3): * 	[1993/01/11  17:03:03  htf]
[1] (3:50) --- *(3): * 
[1] (3:50) --- *(3): * Revision 1.1.2.2  1992/10/28  16:33:59  jaffe
[1] (3:50) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (3:50) --- *(3): * 	  Selected comments:
[1] (3:50) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (3:51) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (3:51) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (3:51) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (3:51) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (3:51) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (3:51) --- *(3): * 	    last argument to the command.
[1] (3:52) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (3:52) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (3:52) --- *(3): * 	    variable by the open and opendir comands.
[1] (3:52) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (3:52) --- *(3): * 	    described above.
[1] (3:52) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (3:52) --- *(3): * 	    Cleanup debugging code.
[1] (3:52) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:52) --- *(3): * 	  Selected comments:
[1] (3:52) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:53) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:53) --- *(3): * 	    and adds all of the test scripts.
[1] (3:53) --- *(3): * 	    Reclone test.
[1] (3:53) --- *(3): * 	[1992/10/27  19:05:06  jaffe]
[1] (3:53) --- *(3): * 
[1] (3:53) --- *(3): * $EndLog$
[1] (3:53) --- *(3): *
[1] (3:53) --- *(3): 
[1] (3:53) --- *(3): !**********************************************************
[1] (3:53) --- !**********************************************************
[1] (3:53) --- *(3): !*** Reclone a fileset so that a file open in the read-only
[1] (3:53) --- !*** Reclone a fileset so that a file open in the read-only
[1] (3:53) --- *(3): !*** fileset gets modified.
[1] (3:53) --- !*** fileset gets modified.
[1] (3:53) --- *(3): !**********************************************************
[1] (3:53) --- !**********************************************************
[1] (3:53) --- *(3): 
[1] (3:53) --- *(3): include "setup.itl"
[1] (3:53) [*] Opening the file setup.itl
[1] (3:53) [*] Trying to open the file scripts/setup.itl
[1] (3:53) --- *(4): *
[1] (3:53) --- *(4): * @OSF_COPYRIGHT@
[1] (3:53) --- *(4): * COPYRIGHT NOTICE
[1] (3:54) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:54) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:54) --- *(4): * src directory for the full copyright text.
[1] (3:54) --- *(4): *
[1] (3:54) --- *(4): * HISTORY
[1] (3:54) --- *(4): * $Log: setup.itl,v $
[1] (3:54) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (3:54) --- *(4): * 	Embedded copyright notice
[1] (3:54) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (3:54) --- *(4): *
[1] (3:54) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (3:54) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:54) --- *(4): * 	  Selected comments:
[1] (3:54) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:55) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:55) --- *(4): * 	    and adds all of the test scripts.
[1] (3:55) --- *(4): * 	    Setup for a test case.
[1] (3:55) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (3:55) --- *(4): * 
[1] (3:55) --- *(4): * $EndLog$
[1] (3:55) --- *(4): *
[1] (3:55) --- *(4): 
[1] (3:55) --- *(4): include "defaults.itl"
[1] (3:55) [*] Opening the file defaults.itl
[1] (3:55) [*] Trying to open the file scripts/defaults.itl
[1] (3:55) --- *(5): *
[1] (3:55) --- *(5): * @OSF_COPYRIGHT@
[1] (3:55) --- *(5): * COPYRIGHT NOTICE
[1] (3:55) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (3:55) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (3:55) --- *(5): * src directory for the full copyright text.
[1] (3:55) --- *(5): *
[1] (3:55) --- *(5): * HISTORY
[1] (3:55) --- *(5): * $Log: defaults.itl,v $
[1] (3:55) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (3:56) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (3:56) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (3:56) --- *(5): *
[1] (3:56) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (3:56) --- *(5): * 	1.0.3a update from Transarc
[1] (3:56) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (3:56) --- *(5): * 
[1] (3:56) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (3:56) --- *(5): * 	Embedded copyright notice
[1] (3:56) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (3:56) --- *(5): * 
[1] (3:56) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (3:56) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (3:56) --- *(5): * 	  Selected comments:
[1] (3:56) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (3:57) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (3:57) --- *(5): * 	    and adds all of the test scripts.
[1] (3:57) --- *(5): * 	    Set default variables from environment.
[1] (3:57) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (3:57) --- *(5): * 
[1] (3:57) --- *(5): * $EndLog$
[1] (3:57) --- *(5): *
[1] (3:57) --- *(5): 
[1] (3:57) --- *(5): * The following three resources must exist before testing begins
[1] (3:57) --- *(5): getenv FSET_DEVICE
[1] (3:57) --- *(5): if ($FSET_DEVICE == "") {
[1] (3:57) --- *(5): 	set device $FSET_DEVICE
[1] (3:57) --- *(5): }
[1] (3:57) --- *(5): 
[1] (3:57) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (3:57) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (3:57) --- *(5): 	set mount_point[0] "/mnt"
[1] (3:57) --- *(5): } else {
[1] (3:57) --- *(5): 
[1] (3:58) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (3:58) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (3:58) --- *(5): 	set mount_point[1] "/mnt2"
[1] (3:58) --- *(5): } else {
[1] (3:58) --- *(5): 
[1] (3:58) --- *(5): 
[1] (3:58) --- *(5): getenv FSET_AGGR_ID
[1] (3:58) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (3:58) --- *(5): 	set aggr_id 1000
[1] (3:58) --- *(5): } else {
[1] (3:58) --- *(5): 
[1] (3:58) --- *(5): getenv FSET_BLOCK_SIZE
[1] (3:58) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (3:58) --- *(5): 	set block_size 8192
[1] (3:58) --- *(5): } else {
[1] (3:58) --- *(5): 
[1] (3:58) --- *(5): getenv FSET_FRAG_SIZE
[1] (3:58) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (3:58) --- *(5): 	set frag_size 1024
[1] (3:58) --- *(5): } else {
[1] (3:58) --- *(5): 
[1] (3:58) --- *(5): set aggr_name	$device
[1] (3:59) --- *(5): set aggr_type	"lfs"
[1] (3:59) --- *(5): 
[1] (3:59) --- *(5): set fset_id   ($aggr_id + 1)
[1] (3:59) --- *(5): set fset_name ("fset" + $fset_id)
[1] (3:59) --- *(5): 
[1] (3:59) --- *(5): set file_name		"zappa"
[1] (3:59) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (3:59) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (3:59) --- *(5): 
[1] (3:59) --- *(5): set setup_aggr proc END
[1] (3:59) --- *(5): !*** Setup the aggregate
[1] (3:59) --- *(5): 	initAggr @device @block_size @frag_size
[1] (3:59) --- *(5): 	verifyAggr @device
[1] (3:59) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (3:59) --- *(5): END
[1] (3:59) --- *(5): 
[1] (3:59) --- *(5): set setup_fset proc END
[1] (3:59) --- *(5): !*** Create and mount a fileset
[1] (3:59) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (4:00) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (4:00) --- *(5): END
[1] (4:00) --- *(5): 
[1] (4:00) --- *(5): set shutdown_fset proc END
[1] (4:00) --- *(5): !*** Destroy the fileset
[1] (4:00) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (4:00) --- *(5): END
[1] (4:00) --- *(5): 
[1] (4:00) --- *(5): set shutdown_aggr proc END
[1] (4:00) --- *(5): !*** Shutdown the aggregate
[1] (4:00) --- *(5): 	detachAggr @aggr_id
[1] (4:00) --- *(5): 	verifyAggr @device
[1] (4:00) --- *(5): END
[1] (4:00) --- *(5): 
[1] (4:00) --- *(5): quit
[1] (4:00) --- *(4): 
[1] (4:00) --- *(4): exec setup_aggr
[1] (4:00) --- *(4): 
[1] (4:00) --- *(4): !*** Setup the aggregate
[1] (4:00) --- !*** Setup the aggregate
[1] (4:00) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (4:06) --- *(4): 	verifyAggr $device
[1] (4:07) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (4:07) --- *(4): 
[1] (4:07) --- *(4): 
[1] (4:07) --- *(4): quit
[1] (4:07) [*] <== finished processing the string
[1] (4:07) --- *(4): exec setup_fset
[1] (4:07) --- *(4): 
[1] (4:07) --- *(4): !*** Create and mount a fileset
[1] (4:07) --- !*** Create and mount a fileset
[1] (4:07) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (4:07) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (4:08) --- *(4): 
[1] (4:08) --- *(4): 
[1] (4:08) --- *(4): quit
[1] (4:08) [*] <== finished processing the string
[1] (4:08) --- *(4): quit
[1] (4:08) --- *(3): 
[1] (4:08) --- *(3): !*** Create a 1-block file
[1] (4:08) --- !*** Create a 1-block file
[1] (4:08) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (4:08) --- *(3): set data ("1" * $block_size)
[1] (4:08) --- *(3): write $fd1 $data
[1] (4:08) --- *(3): close $fd1
[1] (4:08) --- *(3): 
[1] (4:08) --- *(3): !*** Clone the original fileset and mount the clone
[1] (4:08) --- !*** Clone the original fileset and mount the clone
[1] (4:09) --- *(3): set clone_name ($fset_name + ".clone")
[1] (4:09) --- *(3): set clone_id ($fset_id + 1)
[1] (4:09) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (4:09) --- *(3): mountFset $clone_id $mount_point[1]
[1] (4:10) --- *(3): 
[1] (4:10) --- *(3): !*** Open file in read-only fileset and verify data
[1] (4:10) --- !*** Open file in read-only fileset and verify data
[1] (4:10) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (4:10) --- *(3): read $fd2 $block_size read_data
[1] (4:10) --- *(3): assert ($read_data == $data)
[1] (4:10) --- *(3): 
[1] (4:10) --- *(3): !*** Modify file in read/write fileset
[1] (4:10) --- !*** Modify file in read/write fileset
[1] (4:10) --- *(3): open $path_name[0] ($O_TRUNC|$O_WRONLY) 0 fd1
[1] (4:10) --- *(3): set data ("2" * $block_size)
[1] (4:10) --- *(3): write $fd1 $data
[1] (4:10) --- *(3): close $fd1
[1] (4:10) --- *(3): 
[1] (4:10) --- *(3): !*** Reclone read/write fileset
[1] (4:10) --- !*** Reclone read/write fileset
[1] (4:10) --- *(3): recloneFset $aggr_id $fset_id
[1] (4:10) --- *(3): 
[1] (4:11) --- *(3): !*** Read the modified data in the read-only fileset
[1] (4:11) --- !*** Read the modified data in the read-only fileset
[1] (4:11) --- *(3): lseek $fd2 0 $SEEK_SET
[1] (4:11) --- *(3): read $fd2 $block_size read_data
[1] (4:11) --- *(3): assert ($read_data == $data)
[1] (4:11) --- *(3): close $fd2
[1] (4:11) --- *(3): 
[1] (4:11) --- *(3): !*** Unmount filesets
[1] (4:11) --- !*** Unmount filesets
[1] (4:11) --- *(3): unmountFset $mount_point[0]
[1] (4:12) --- *(3): unmountFset $mount_point[1]
[1] (4:12) --- *(3): 
[1] (4:12) --- *(3): include "shutdown.itl"
[1] (4:12) [*] Opening the file shutdown.itl
[1] (4:12) [*] Trying to open the file scripts/shutdown.itl
[1] (4:12) --- *(4): *
[1] (4:12) --- *(4): * @OSF_COPYRIGHT@
[1] (4:12) --- *(4): * COPYRIGHT NOTICE
[1] (4:12) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:13) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:13) --- *(4): * src directory for the full copyright text.
[1] (4:13) --- *(4): *
[1] (4:13) --- *(4): * HISTORY
[1] (4:13) --- *(4): * $Log: shutdown.itl,v $
[1] (4:13) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (4:13) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (4:13) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (4:13) --- *(4): *
[1] (4:13) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (4:13) --- *(4): * 	1.0.3a update from Transarc
[1] (4:13) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (4:13) --- *(4): * 
[1] (4:13) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (4:13) --- *(4): * 	Embedded copyright notice
[1] (4:13) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (4:13) --- *(4): * 
[1] (4:14) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (4:14) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:14) --- *(4): * 	  Selected comments:
[1] (4:14) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:14) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:14) --- *(4): * 	    and adds all of the test scripts.
[1] (4:14) --- *(4): * 	    Shutdown a test case.
[1] (4:14) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (4:14) --- *(4): * 
[1] (4:14) --- *(4): * $EndLog$
[1] (4:14) --- *(4): *
[1] (4:14) --- *(4): 
[1] (4:14) --- *(4): exec shutdown_fset
[1] (4:14) --- *(4): 
[1] (4:14) --- *(4): !*** Destroy the fileset
[1] (4:14) --- !*** Destroy the fileset
[1] (4:14) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (4:14) --- *(4): 
[1] (4:14) --- *(4): 
[1] (4:14) --- *(4): quit
[1] (4:14) [*] <== finished processing the string
[1] (4:14) --- *(4): exec shutdown_aggr
[1] (4:14) --- *(4): 
[1] (4:14) --- *(4): !*** Shutdown the aggregate
[1] (4:14) --- !*** Shutdown the aggregate
[1] (4:14) --- *(4): 	detachAggr $aggr_id
[1] (4:15) --- *(4): 	verifyAggr $device
[1] (4:16) --- *(4): 
[1] (4:16) --- *(4): 
[1] (4:16) --- *(4): quit
[1] (4:16) [*] <== finished processing the string
[1] (4:16) --- *(4): quit
[1] (4:16) --- *(3): quit
[1] (4:16) --- *(2): 
[1] (4:16) --- *(2): include "reclone03.itl"
[1] (4:16) [*] Opening the file reclone03.itl
[1] (4:16) [*] Trying to open the file scripts/reclone03.itl
[1] (4:16) --- *(3): *
[1] (4:16) --- *(3): * @OSF_COPYRIGHT@
[1] (4:16) --- *(3): * COPYRIGHT NOTICE
[1] (4:17) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:17) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:17) --- *(3): * src directory for the full copyright text.
[1] (4:17) --- *(3): *
[1] (4:17) --- *(3): * HISTORY
[1] (4:17) --- *(3): * $Log: reclone03.itl,v $
[1] (4:17) --- *(3): * Revision 1.1.423.1  1994/02/04  20:41:51  devsrc
[1] (4:17) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (4:17) --- *(3): * 	[1994/02/04  15:23:00  devsrc]
[1] (4:17) --- *(3): *
[1] (4:17) --- *(3): * Revision 1.1.421.1  1993/12/07  17:42:37  jaffe
[1] (4:17) --- *(3): * 	1.0.3a update from Transarc
[1] (4:17) --- *(3): * 	[1993/12/03  18:59:56  jaffe]
[1] (4:17) --- *(3): * 
[1] (4:17) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:52  htf
[1] (4:17) --- *(3): * 	Embedded copyright notice
[1] (4:18) --- *(3): * 	[1993/01/11  17:03:07  htf]
[1] (4:18) --- *(3): * 
[1] (4:18) --- *(3): * Revision 1.1.2.2  1992/10/28  16:34:14  jaffe
[1] (4:18) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (4:18) --- *(3): * 	  Selected comments:
[1] (4:18) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (4:18) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (4:18) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (4:18) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (4:19) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (4:19) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (4:19) --- *(3): * 	    last argument to the command.
[1] (4:19) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (4:19) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (4:19) --- *(3): * 	    variable by the open and opendir comands.
[1] (4:19) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (4:19) --- *(3): * 	    described above.
[1] (4:19) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (4:20) --- *(3): * 	    Cleanup debugging code.
[1] (4:20) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:20) --- *(3): * 	  Selected comments:
[1] (4:20) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:20) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:20) --- *(3): * 	    and adds all of the test scripts.
[1] (4:20) --- *(3): * 	    Reclone test.
[1] (4:20) --- *(3): * 	[1992/10/27  19:06:10  jaffe]
[1] (4:20) --- *(3): * 
[1] (4:20) --- *(3): * $EndLog$
[1] (4:20) --- *(3): *
[1] (4:20) --- *(3): 
[1] (4:20) --- *(3): !**********************************************************
[1] (4:20) --- !**********************************************************
[1] (4:20) --- *(3): !*** Reclone a fileset with a ZLC file in the read/write
[1] (4:20) --- !*** Reclone a fileset with a ZLC file in the read/write
[1] (4:20) --- *(3): !*** fileset.
[1] (4:20) --- !*** fileset.
[1] (4:21) --- *(3): !**********************************************************
[1] (4:21) --- !**********************************************************
[1] (4:21) --- *(3): 
[1] (4:21) --- *(3): include "setup.itl"
[1] (4:21) [*] Opening the file setup.itl
[1] (4:21) [*] Trying to open the file scripts/setup.itl
[1] (4:21) --- *(4): *
[1] (4:21) --- *(4): * @OSF_COPYRIGHT@
[1] (4:21) --- *(4): * COPYRIGHT NOTICE
[1] (4:21) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:21) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:21) --- *(4): * src directory for the full copyright text.
[1] (4:21) --- *(4): *
[1] (4:21) --- *(4): * HISTORY
[1] (4:21) --- *(4): * $Log: setup.itl,v $
[1] (4:21) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (4:21) --- *(4): * 	Embedded copyright notice
[1] (4:21) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (4:21) --- *(4): *
[1] (4:21) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (4:21) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:22) --- *(4): * 	  Selected comments:
[1] (4:22) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:22) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:22) --- *(4): * 	    and adds all of the test scripts.
[1] (4:22) --- *(4): * 	    Setup for a test case.
[1] (4:22) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (4:22) --- *(4): * 
[1] (4:22) --- *(4): * $EndLog$
[1] (4:22) --- *(4): *
[1] (4:22) --- *(4): 
[1] (4:22) --- *(4): include "defaults.itl"
[1] (4:22) [*] Opening the file defaults.itl
[1] (4:22) [*] Trying to open the file scripts/defaults.itl
[1] (4:22) --- *(5): *
[1] (4:22) --- *(5): * @OSF_COPYRIGHT@
[1] (4:22) --- *(5): * COPYRIGHT NOTICE
[1] (4:22) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:22) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:23) --- *(5): * src directory for the full copyright text.
[1] (4:23) --- *(5): *
[1] (4:23) --- *(5): * HISTORY
[1] (4:23) --- *(5): * $Log: defaults.itl,v $
[1] (4:23) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (4:23) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (4:23) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (4:23) --- *(5): *
[1] (4:23) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (4:23) --- *(5): * 	1.0.3a update from Transarc
[1] (4:23) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (4:23) --- *(5): * 
[1] (4:23) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (4:23) --- *(5): * 	Embedded copyright notice
[1] (4:23) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (4:23) --- *(5): * 
[1] (4:23) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (4:23) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:24) --- *(5): * 	  Selected comments:
[1] (4:24) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:24) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:24) --- *(5): * 	    and adds all of the test scripts.
[1] (4:24) --- *(5): * 	    Set default variables from environment.
[1] (4:24) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (4:24) --- *(5): * 
[1] (4:24) --- *(5): * $EndLog$
[1] (4:24) --- *(5): *
[1] (4:24) --- *(5): 
[1] (4:24) --- *(5): * The following three resources must exist before testing begins
[1] (4:24) --- *(5): getenv FSET_DEVICE
[1] (4:24) --- *(5): if ($FSET_DEVICE == "") {
[1] (4:24) --- *(5): 	set device $FSET_DEVICE
[1] (4:24) --- *(5): }
[1] (4:24) --- *(5): 
[1] (4:24) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (4:25) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (4:25) --- *(5): 	set mount_point[0] "/mnt"
[1] (4:25) --- *(5): } else {
[1] (4:25) --- *(5): 
[1] (4:25) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (4:25) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (4:25) --- *(5): 	set mount_point[1] "/mnt2"
[1] (4:25) --- *(5): } else {
[1] (4:25) --- *(5): 
[1] (4:25) --- *(5): 
[1] (4:25) --- *(5): getenv FSET_AGGR_ID
[1] (4:25) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (4:25) --- *(5): 	set aggr_id 1000
[1] (4:25) --- *(5): } else {
[1] (4:25) --- *(5): 
[1] (4:25) --- *(5): getenv FSET_BLOCK_SIZE
[1] (4:25) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (4:25) --- *(5): 	set block_size 8192
[1] (4:25) --- *(5): } else {
[1] (4:25) --- *(5): 
[1] (4:25) --- *(5): getenv FSET_FRAG_SIZE
[1] (4:26) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (4:26) --- *(5): 	set frag_size 1024
[1] (4:26) --- *(5): } else {
[1] (4:26) --- *(5): 
[1] (4:26) --- *(5): set aggr_name	$device
[1] (4:26) --- *(5): set aggr_type	"lfs"
[1] (4:26) --- *(5): 
[1] (4:26) --- *(5): set fset_id   ($aggr_id + 1)
[1] (4:26) --- *(5): set fset_name ("fset" + $fset_id)
[1] (4:26) --- *(5): 
[1] (4:26) --- *(5): set file_name		"zappa"
[1] (4:26) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (4:26) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (4:26) --- *(5): 
[1] (4:26) --- *(5): set setup_aggr proc END
[1] (4:26) --- *(5): !*** Setup the aggregate
[1] (4:26) --- *(5): 	initAggr @device @block_size @frag_size
[1] (4:26) --- *(5): 	verifyAggr @device
[1] (4:27) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (4:27) --- *(5): END
[1] (4:27) --- *(5): 
[1] (4:27) --- *(5): set setup_fset proc END
[1] (4:27) --- *(5): !*** Create and mount a fileset
[1] (4:27) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (4:27) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (4:27) --- *(5): END
[1] (4:27) --- *(5): 
[1] (4:27) --- *(5): set shutdown_fset proc END
[1] (4:27) --- *(5): !*** Destroy the fileset
[1] (4:27) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (4:27) --- *(5): END
[1] (4:27) --- *(5): 
[1] (4:27) --- *(5): set shutdown_aggr proc END
[1] (4:27) --- *(5): !*** Shutdown the aggregate
[1] (4:27) --- *(5): 	detachAggr @aggr_id
[1] (4:27) --- *(5): 	verifyAggr @device
[1] (4:27) --- *(5): END
[1] (4:27) --- *(5): 
[1] (4:27) --- *(5): quit
[1] (4:27) --- *(4): 
[1] (4:27) --- *(4): exec setup_aggr
[1] (4:27) --- *(4): 
[1] (4:27) --- *(4): !*** Setup the aggregate
[1] (4:27) --- !*** Setup the aggregate
[1] (4:27) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (4:32) --- *(4): 	verifyAggr $device
[1] (4:34) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (4:34) --- *(4): 
[1] (4:34) --- *(4): 
[1] (4:34) --- *(4): quit
[1] (4:34) [*] <== finished processing the string
[1] (4:34) --- *(4): exec setup_fset
[1] (4:34) --- *(4): 
[1] (4:34) --- *(4): !*** Create and mount a fileset
[1] (4:34) --- !*** Create and mount a fileset
[1] (4:34) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (4:34) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (4:35) --- *(4): 
[1] (4:35) --- *(4): 
[1] (4:35) --- *(4): quit
[1] (4:35) [*] <== finished processing the string
[1] (4:35) --- *(4): quit
[1] (4:35) --- *(3): 
[1] (4:35) --- *(3): !*** Create a 1-block file
[1] (4:35) --- !*** Create a 1-block file
[1] (4:35) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (4:35) --- *(3): set data ("1" * $block_size)
[1] (4:35) --- *(3): write $fd1 $data
[1] (4:35) --- *(3): close $fd1
[1] (4:35) --- *(3): 
[1] (4:35) --- *(3): !*** Create a second 1-block file
[1] (4:35) --- !*** Create a second 1-block file
[1] (4:35) --- *(3): set file2 ($mount_point[0] + "/" + $file_name + "2")
[1] (4:35) [*] Inserting variable file2
[1] (4:35) --- *(3): open $file2 ($O_CREAT|$O_WRONLY) 0666 fd2
[1] (4:35) --- *(3): set data ("2" * $block_size)
[1] (4:35) --- *(3): write $fd2 $data
[1] (4:35) --- *(3): close $fd2
[1] (4:35) --- *(3): 
[1] (4:35) --- *(3): !*** Clone the original fileset and mount the clone
[1] (4:35) --- !*** Clone the original fileset and mount the clone
[1] (4:36) --- *(3): set clone_name ($fset_name + ".clone")
[1] (4:36) --- *(3): set clone_id ($fset_id + 1)
[1] (4:36) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (4:36) --- *(3): mountFset $clone_id $mount_point[1]
[1] (4:37) --- *(3): 
[1] (4:37) --- *(3): !*** Open file in the read-write fileset and delete it
[1] (4:37) --- !*** Open file in the read-write fileset and delete it
[1] (4:37) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (4:37) --- *(3): unlink $path_name[0]
[1] (4:37) --- *(3): 
[1] (4:37) --- *(3): !*** Open second file in both filesets and then unlink it
[1] (4:37) --- !*** Open second file in both filesets and then unlink it
[1] (4:37) --- *(3): open $file2 $O_RDONLY 0 fd2
[1] (4:37) --- *(3): set file2_in_clone ($mount_point[1] + "/" + $file_name + "2")
[1] (4:37) [*] Inserting variable file2_in_clone
[1] (4:37) --- *(3): open $file2_in_clone $O_RDONLY 0 fd3
[1] (4:37) [*] Inserting variable fd3
[1] (4:37) --- *(3): unlink $file2
[1] (4:37) --- *(3): 
[1] (4:37) --- *(3): !*** Reclone read/write fileset
[1] (4:37) --- !*** Reclone read/write fileset
[1] (4:37) --- *(3): recloneFset $aggr_id $fset_id
[1] (4:38) --- *(3): 
[1] (4:38) --- *(3): !*** Attempt to open the first deleted file in read-only
[1] (4:38) --- !*** Attempt to open the first deleted file in read-only
[1] (4:38) --- *(3): verifyStatus false
[1] (4:38) [*] Using false  for Verify Status.
[1] (4:38) --- Status verification is OFF
[1] (4:38) --- *(3): open $path_name[1] $O_RDONLY 0 fd4
[1] (4:38) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (4:38) --- *(3): verifyStatus true
[1] (4:38) [*] Using true  for Verify Status.
[1] (4:38) --- Status verification is ON
[1] (4:38) --- *(3): 
[1] (4:38) --- *(3): !*** Attempt to read data from second file in read-only
[1] (4:38) --- !*** Attempt to read data from second file in read-only
[1] (4:38) --- *(3): read $fd3 $block_size clone_data
[1] (4:38) --- *(3): assert ($clone_data == $data)
[1] (4:38) --- *(3): close $fd3
[1] (4:38) --- *(3): 
[1] (4:38) --- *(3): !*** Close files in read/write fileset
[1] (4:38) --- !*** Close files in read/write fileset
[1] (4:38) --- *(3): close $fd1
[1] (4:38) --- *(3): close $fd2
[1] (4:38) --- *(3): 
[1] (4:38) --- *(3): !*** Unmount filesets
[1] (4:38) --- !*** Unmount filesets
[1] (4:39) --- *(3): unmountFset $mount_point[0]
[1] (4:39) --- *(3): unmountFset $mount_point[1]
[1] (4:40) --- *(3): 
[1] (4:40) --- *(3): include "shutdown.itl"
[1] (4:40) [*] Opening the file shutdown.itl
[1] (4:40) [*] Trying to open the file scripts/shutdown.itl
[1] (4:40) --- *(4): *
[1] (4:40) --- *(4): * @OSF_COPYRIGHT@
[1] (4:40) --- *(4): * COPYRIGHT NOTICE
[1] (4:40) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:40) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:40) --- *(4): * src directory for the full copyright text.
[1] (4:40) --- *(4): *
[1] (4:40) --- *(4): * HISTORY
[1] (4:40) --- *(4): * $Log: shutdown.itl,v $
[1] (4:40) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (4:40) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (4:41) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (4:41) --- *(4): *
[1] (4:41) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (4:41) --- *(4): * 	1.0.3a update from Transarc
[1] (4:41) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (4:41) --- *(4): * 
[1] (4:41) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (4:41) --- *(4): * 	Embedded copyright notice
[1] (4:41) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (4:41) --- *(4): * 
[1] (4:41) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (4:41) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:41) --- *(4): * 	  Selected comments:
[1] (4:41) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:41) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:42) --- *(4): * 	    and adds all of the test scripts.
[1] (4:42) --- *(4): * 	    Shutdown a test case.
[1] (4:42) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (4:42) --- *(4): * 
[1] (4:42) --- *(4): * $EndLog$
[1] (4:42) --- *(4): *
[1] (4:42) --- *(4): 
[1] (4:42) --- *(4): exec shutdown_fset
[1] (4:42) --- *(4): 
[1] (4:42) --- *(4): !*** Destroy the fileset
[1] (4:42) --- !*** Destroy the fileset
[1] (4:42) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (4:42) --- *(4): 
[1] (4:42) --- *(4): 
[1] (4:42) --- *(4): quit
[1] (4:42) [*] <== finished processing the string
[1] (4:42) --- *(4): exec shutdown_aggr
[1] (4:42) --- *(4): 
[1] (4:42) --- *(4): !*** Shutdown the aggregate
[1] (4:42) --- !*** Shutdown the aggregate
[1] (4:42) --- *(4): 	detachAggr $aggr_id
[1] (4:42) --- *(4): 	verifyAggr $device
[1] (4:43) --- *(4): 
[1] (4:43) --- *(4): 
[1] (4:43) --- *(4): quit
[1] (4:43) [*] <== finished processing the string
[1] (4:43) --- *(4): quit
[1] (4:43) --- *(3): quit
[1] (4:43) --- *(2): 
[1] (4:43) --- *(2): include "reclone04.itl"
[1] (4:43) [*] Opening the file reclone04.itl
[1] (4:43) [*] Trying to open the file scripts/reclone04.itl
[1] (4:44) --- *(3): *
[1] (4:44) --- *(3): * @OSF_COPYRIGHT@
[1] (4:44) --- *(3): * COPYRIGHT NOTICE
[1] (4:44) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:44) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:44) --- *(3): * src directory for the full copyright text.
[1] (4:44) --- *(3): *
[1] (4:44) --- *(3): * HISTORY
[1] (4:44) --- *(3): * $Log: reclone04.itl,v $
[1] (4:44) --- *(3): * Revision 1.1.424.1  1994/02/04  20:41:53  devsrc
[1] (4:44) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (4:44) --- *(3): * 	[1994/02/04  15:23:01  devsrc]
[1] (4:44) --- *(3): *
[1] (4:45) --- *(3): * Revision 1.1.422.1  1993/12/07  17:42:38  jaffe
[1] (4:45) --- *(3): * 	1.0.3a update from Transarc
[1] (4:45) --- *(3): * 	[1993/12/03  19:00:16  jaffe]
[1] (4:45) --- *(3): * 
[1] (4:45) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:53  htf
[1] (4:45) --- *(3): * 	Embedded copyright notice
[1] (4:45) --- *(3): * 	[1993/01/11  17:03:13  htf]
[1] (4:45) --- *(3): * 
[1] (4:45) --- *(3): * Revision 1.1.2.2  1992/10/28  17:19:46  jaffe
[1] (4:45) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (4:45) --- *(3): * 	  Selected comments:
[1] (4:45) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (4:45) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (4:46) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (4:46) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (4:46) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (4:46) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (4:46) --- *(3): * 	    last argument to the command.
[1] (4:46) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (4:46) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (4:47) --- *(3): * 	    variable by the open and opendir comands.
[1] (4:47) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (4:47) --- *(3): * 	    described above.
[1] (4:47) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (4:47) --- *(3): * 	    Cleanup debugging code.
[1] (4:47) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:47) --- *(3): * 	  Selected comments:
[1] (4:47) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:47) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:47) --- *(3): * 	    and adds all of the test scripts.
[1] (4:47) --- *(3): * 	    Reclone test.
[1] (4:47) --- *(3): * 	[1992/10/27  19:06:57  jaffe]
[1] (4:48) --- *(3): * 
[1] (4:48) --- *(3): * $EndLog$
[1] (4:48) --- *(3): *
[1] (4:48) --- *(3): 
[1] (4:48) --- *(3): !**********************************************************
[1] (4:48) --- !**********************************************************
[1] (4:48) --- *(3): !*** Reclone a fileset with a file open for reading
[1] (4:48) --- !*** Reclone a fileset with a file open for reading
[1] (4:48) --- *(3): !**********************************************************
[1] (4:48) --- !**********************************************************
[1] (4:48) --- *(3): 
[1] (4:48) --- *(3): include "setup.itl"
[1] (4:48) [*] Opening the file setup.itl
[1] (4:48) [*] Trying to open the file scripts/setup.itl
[1] (4:48) --- *(4): *
[1] (4:48) --- *(4): * @OSF_COPYRIGHT@
[1] (4:48) --- *(4): * COPYRIGHT NOTICE
[1] (4:48) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:48) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:48) --- *(4): * src directory for the full copyright text.
[1] (4:48) --- *(4): *
[1] (4:48) --- *(4): * HISTORY
[1] (4:48) --- *(4): * $Log: setup.itl,v $
[1] (4:49) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (4:49) --- *(4): * 	Embedded copyright notice
[1] (4:49) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (4:49) --- *(4): *
[1] (4:49) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (4:49) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:49) --- *(4): * 	  Selected comments:
[1] (4:49) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:49) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:49) --- *(4): * 	    and adds all of the test scripts.
[1] (4:49) --- *(4): * 	    Setup for a test case.
[1] (4:49) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (4:49) --- *(4): * 
[1] (4:49) --- *(4): * $EndLog$
[1] (4:49) --- *(4): *
[1] (4:49) --- *(4): 
[1] (4:49) --- *(4): include "defaults.itl"
[1] (4:49) [*] Opening the file defaults.itl
[1] (4:49) [*] Trying to open the file scripts/defaults.itl
[1] (4:49) --- *(5): *
[1] (4:50) --- *(5): * @OSF_COPYRIGHT@
[1] (4:50) --- *(5): * COPYRIGHT NOTICE
[1] (4:50) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (4:50) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (4:50) --- *(5): * src directory for the full copyright text.
[1] (4:50) --- *(5): *
[1] (4:50) --- *(5): * HISTORY
[1] (4:50) --- *(5): * $Log: defaults.itl,v $
[1] (4:50) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (4:50) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (4:50) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (4:50) --- *(5): *
[1] (4:50) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (4:50) --- *(5): * 	1.0.3a update from Transarc
[1] (4:50) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (4:50) --- *(5): * 
[1] (4:51) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (4:51) --- *(5): * 	Embedded copyright notice
[1] (4:51) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (4:51) --- *(5): * 
[1] (4:51) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (4:51) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (4:51) --- *(5): * 	  Selected comments:
[1] (4:51) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (4:51) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (4:51) --- *(5): * 	    and adds all of the test scripts.
[1] (4:51) --- *(5): * 	    Set default variables from environment.
[1] (4:51) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (4:51) --- *(5): * 
[1] (4:51) --- *(5): * $EndLog$
[1] (4:52) --- *(5): *
[1] (4:52) --- *(5): 
[1] (4:52) --- *(5): * The following three resources must exist before testing begins
[1] (4:52) --- *(5): getenv FSET_DEVICE
[1] (4:52) --- *(5): if ($FSET_DEVICE == "") {
[1] (4:52) --- *(5): 	set device $FSET_DEVICE
[1] (4:52) --- *(5): }
[1] (4:52) --- *(5): 
[1] (4:52) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (4:52) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (4:52) --- *(5): 	set mount_point[0] "/mnt"
[1] (4:52) --- *(5): } else {
[1] (4:52) --- *(5): 
[1] (4:52) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (4:53) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (4:53) --- *(5): 	set mount_point[1] "/mnt2"
[1] (4:53) --- *(5): } else {
[1] (4:53) --- *(5): 
[1] (4:53) --- *(5): 
[1] (4:53) --- *(5): getenv FSET_AGGR_ID
[1] (4:53) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (4:53) --- *(5): 	set aggr_id 1000
[1] (4:53) --- *(5): } else {
[1] (4:53) --- *(5): 
[1] (4:53) --- *(5): getenv FSET_BLOCK_SIZE
[1] (4:53) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (4:53) --- *(5): 	set block_size 8192
[1] (4:53) --- *(5): } else {
[1] (4:54) --- *(5): 
[1] (4:54) --- *(5): getenv FSET_FRAG_SIZE
[1] (4:54) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (4:54) --- *(5): 	set frag_size 1024
[1] (4:54) --- *(5): } else {
[1] (4:54) --- *(5): 
[1] (4:54) --- *(5): set aggr_name	$device
[1] (4:54) --- *(5): set aggr_type	"lfs"
[1] (4:54) --- *(5): 
[1] (4:54) --- *(5): set fset_id   ($aggr_id + 1)
[1] (4:54) --- *(5): set fset_name ("fset" + $fset_id)
[1] (4:54) --- *(5): 
[1] (4:54) --- *(5): set file_name		"zappa"
[1] (4:54) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (4:55) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (4:55) --- *(5): 
[1] (4:55) --- *(5): set setup_aggr proc END
[1] (4:55) --- *(5): !*** Setup the aggregate
[1] (4:55) --- *(5): 	initAggr @device @block_size @frag_size
[1] (4:55) --- *(5): 	verifyAggr @device
[1] (4:55) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (4:55) --- *(5): END
[1] (4:55) --- *(5): 
[1] (4:55) --- *(5): set setup_fset proc END
[1] (4:55) --- *(5): !*** Create and mount a fileset
[1] (4:56) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (4:56) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (4:56) --- *(5): END
[1] (4:56) --- *(5): 
[1] (4:56) --- *(5): set shutdown_fset proc END
[1] (4:56) --- *(5): !*** Destroy the fileset
[1] (4:56) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (4:56) --- *(5): END
[1] (4:56) --- *(5): 
[1] (4:56) --- *(5): set shutdown_aggr proc END
[1] (4:56) --- *(5): !*** Shutdown the aggregate
[1] (4:56) --- *(5): 	detachAggr @aggr_id
[1] (4:56) --- *(5): 	verifyAggr @device
[1] (4:56) --- *(5): END
[1] (4:56) --- *(5): 
[1] (4:56) --- *(5): quit
[1] (4:56) --- *(4): 
[1] (4:56) --- *(4): exec setup_aggr
[1] (4:56) --- *(4): 
[1] (4:56) --- *(4): !*** Setup the aggregate
[1] (4:56) --- !*** Setup the aggregate
[1] (4:56) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (5:09) --- *(4): 	verifyAggr $device
[1] (5:10) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (5:10) --- *(4): 
[1] (5:10) --- *(4): 
[1] (5:10) --- *(4): quit
[1] (5:10) [*] <== finished processing the string
[1] (5:10) --- *(4): exec setup_fset
[1] (5:10) --- *(4): 
[1] (5:10) --- *(4): !*** Create and mount a fileset
[1] (5:10) --- !*** Create and mount a fileset
[1] (5:10) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (5:10) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (5:11) --- *(4): 
[1] (5:11) --- *(4): 
[1] (5:11) --- *(4): quit
[1] (5:11) [*] <== finished processing the string
[1] (5:11) --- *(4): quit
[1] (5:11) --- *(3): 
[1] (5:12) --- *(3): !*** Write 1 block + 1 byte to a new file
[1] (5:12) --- !*** Write 1 block + 1 byte to a new file
[1] (5:12) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (5:12) --- *(3): set data1 ("1" * ($block_size + 1))
[1] (5:12) --- *(3): write $fd1 $data1
[1] (5:12) --- *(3): 
[1] (5:12) --- *(3): !*** Clone the fileset and mount the clone
[1] (5:12) --- !*** Clone the fileset and mount the clone
[1] (5:12) --- *(3): set clone_name ($fset_name + ".clone")
[1] (5:12) --- *(3): set clone_id ($fset_id + 1)
[1] (5:12) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (5:13) --- *(3): mountFset $clone_id $mount_point[1]
[1] (5:14) --- *(3): 
[1] (5:14) --- *(3): !*** Write another 1 block + 1 byte
[1] (5:14) --- !*** Write another 1 block + 1 byte
[1] (5:14) --- *(3): set data2 ("2" * ($block_size + 1))
[1] (5:14) --- *(3): write $fd1 $data2
[1] (5:14) --- *(3): close $fd1
[1] (5:14) --- *(3): 
[1] (5:15) --- *(3): !*** Open the file for reading and read a block
[1] (5:15) --- !*** Open the file for reading and read a block
[1] (5:15) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (5:15) --- *(3): read $fd1 ($block_size + 1) read_data1
[1] (5:15) --- *(3): assert ($read_data1 == $data1)
[1] (5:15) --- *(3): 
[1] (5:15) --- *(3): !*** Reclone the fileset
[1] (5:15) --- !*** Reclone the fileset
[1] (5:15) --- *(3): recloneFset $aggr_id $fset_id
[1] (5:16) --- *(3): 
[1] (5:16) --- *(3): !*** Try to read the next block + 1 byte
[1] (5:16) --- !*** Try to read the next block + 1 byte
[1] (5:17) --- *(3): read $fd1 ($block_size + 1) read_data2
[1] (5:17) --- *(3): assert ($read_data2 == $data2)
[1] (5:17) --- *(3): close $fd1
[1] (5:17) --- *(3): 
[1] (5:18) --- *(3): !*** Try to read the data in the clone
[1] (5:18) --- !*** Try to read the data in the clone
[1] (5:18) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (5:18) --- *(3): read $fd2 (2 * $block_size + 2) clone_data
[1] (5:19) --- *(3): assert ($clone_data == ($data1 + $data2))
[1] (5:19) --- *(3): close $fd2
[1] (5:20) --- *(3): 
[1] (5:20) --- *(3): !*** Unmount the filesets
[1] (5:20) --- !*** Unmount the filesets
[1] (5:20) --- *(3): unmountFset $mount_point[0]
[1] (5:21) --- *(3): unmountFset $mount_point[1]
[1] (5:25) --- *(3): 
[1] (5:25) --- *(3): include "shutdown.itl"
[1] (5:25) [*] Opening the file shutdown.itl
[1] (5:25) [*] Trying to open the file scripts/shutdown.itl
[1] (5:25) --- *(4): *
[1] (5:25) --- *(4): * @OSF_COPYRIGHT@
[1] (5:25) --- *(4): * COPYRIGHT NOTICE
[1] (5:26) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (5:27) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (5:27) --- *(4): * src directory for the full copyright text.
[1] (5:27) --- *(4): *
[1] (5:27) --- *(4): * HISTORY
[1] (5:27) --- *(4): * $Log: shutdown.itl,v $
[1] (5:27) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (5:27) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (5:28) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (5:28) --- *(4): *
[1] (5:28) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (5:28) --- *(4): * 	1.0.3a update from Transarc
[1] (5:28) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (5:28) --- *(4): * 
[1] (5:28) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (5:28) --- *(4): * 	Embedded copyright notice
[1] (5:28) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (5:28) --- *(4): * 
[1] (5:28) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (5:29) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (5:29) --- *(4): * 	  Selected comments:
[1] (5:29) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (5:29) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (5:29) --- *(4): * 	    and adds all of the test scripts.
[1] (5:29) --- *(4): * 	    Shutdown a test case.
[1] (5:29) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (5:29) --- *(4): * 
[1] (5:29) --- *(4): * $EndLog$
[1] (5:29) --- *(4): *
[1] (5:29) --- *(4): 
[1] (5:29) --- *(4): exec shutdown_fset
[1] (5:29) --- *(4): 
[1] (5:29) --- *(4): !*** Destroy the fileset
[1] (5:29) --- !*** Destroy the fileset
[1] (5:29) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (5:29) --- *(4): 
[1] (5:30) --- *(4): 
[1] (5:30) --- *(4): quit
[1] (5:30) [*] <== finished processing the string
[1] (5:30) --- *(4): exec shutdown_aggr
[1] (5:30) --- *(4): 
[1] (5:30) --- *(4): !*** Shutdown the aggregate
[1] (5:30) --- !*** Shutdown the aggregate
[1] (5:30) --- *(4): 	detachAggr $aggr_id
[1] (5:30) --- *(4): 	verifyAggr $device
[1] (5:33) --- *(4): 
[1] (5:33) --- *(4): 
[1] (5:33) --- *(4): quit
[1] (5:33) [*] <== finished processing the string
[1] (5:33) --- *(4): quit
[1] (5:33) --- *(3): quit
[1] (5:33) --- *(2): 
[1] (5:33) --- *(2): include "reclone05.itl"
[1] (5:33) [*] Opening the file reclone05.itl
[1] (5:33) [*] Trying to open the file scripts/reclone05.itl
[1] (5:34) --- *(3): *
[1] (5:34) --- *(3): * @OSF_COPYRIGHT@
[1] (5:34) --- *(3): * COPYRIGHT NOTICE
[1] (5:34) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (5:34) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (5:34) --- *(3): * src directory for the full copyright text.
[1] (5:34) --- *(3): *
[1] (5:34) --- *(3): * HISTORY
[1] (5:34) --- *(3): * $Log: reclone05.itl,v $
[1] (5:34) --- *(3): * Revision 1.1.425.1  1994/02/04  20:41:55  devsrc
[1] (5:34) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (5:34) --- *(3): * 	[1994/02/04  15:23:02  devsrc]
[1] (5:34) --- *(3): *
[1] (5:34) --- *(3): * Revision 1.1.423.1  1993/12/07  17:42:40  jaffe
[1] (5:35) --- *(3): * 	1.0.3a update from Transarc
[1] (5:35) --- *(3): * 	[1993/12/03  19:00:37  jaffe]
[1] (5:35) --- *(3): * 
[1] (5:35) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:55  htf
[1] (5:35) --- *(3): * 	Embedded copyright notice
[1] (5:35) --- *(3): * 	[1993/01/11  17:03:17  htf]
[1] (5:35) --- *(3): * 
[1] (5:35) --- *(3): * Revision 1.1.2.2  1992/10/28  17:19:57  jaffe
[1] (5:35) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (5:35) --- *(3): * 	  Selected comments:
[1] (5:35) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (5:37) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (5:37) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (5:38) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (5:38) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (5:38) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (5:39) --- *(3): * 	    last argument to the command.
[1] (5:39) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (5:39) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (5:39) --- *(3): * 	    variable by the open and opendir comands.
[1] (5:39) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (5:39) --- *(3): * 	    described above.
[1] (5:40) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (5:40) --- *(3): * 	    Cleanup debugging code.
[1] (5:40) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (5:40) --- *(3): * 	  Selected comments:
[1] (5:40) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (5:40) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (5:40) --- *(3): * 	    and adds all of the test scripts.
[1] (5:40) --- *(3): * 	    Reclone test.
[1] (5:40) --- *(3): * 	[1992/10/27  19:11:03  jaffe]
[1] (5:40) --- *(3): * 
[1] (5:40) --- *(3): * $EndLog$
[1] (5:40) --- *(3): *
[1] (5:40) --- *(3): 
[1] (5:40) --- *(3): !**********************************************************
[1] (5:40) --- !**********************************************************
[1] (5:40) --- *(3): !*** Reclone a fileset with a file open for writing
[1] (5:40) --- !*** Reclone a fileset with a file open for writing
[1] (5:41) --- *(3): !**********************************************************
[1] (5:41) --- !**********************************************************
[1] (5:41) --- *(3): 
[1] (5:41) --- *(3): include "setup.itl"
[1] (5:41) [*] Opening the file setup.itl
[1] (5:41) [*] Trying to open the file scripts/setup.itl
[1] (5:41) --- *(4): *
[1] (5:41) --- *(4): * @OSF_COPYRIGHT@
[1] (5:41) --- *(4): * COPYRIGHT NOTICE
[1] (5:41) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (5:41) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (5:41) --- *(4): * src directory for the full copyright text.
[1] (5:41) --- *(4): *
[1] (5:41) --- *(4): * HISTORY
[1] (5:41) --- *(4): * $Log: setup.itl,v $
[1] (5:41) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (5:41) --- *(4): * 	Embedded copyright notice
[1] (5:41) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (5:41) --- *(4): *
[1] (5:41) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (5:42) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (5:42) --- *(4): * 	  Selected comments:
[1] (5:42) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (5:42) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (5:42) --- *(4): * 	    and adds all of the test scripts.
[1] (5:42) --- *(4): * 	    Setup for a test case.
[1] (5:42) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (5:42) --- *(4): * 
[1] (5:42) --- *(4): * $EndLog$
[1] (5:42) --- *(4): *
[1] (5:42) --- *(4): 
[1] (5:42) --- *(4): include "defaults.itl"
[1] (5:42) [*] Opening the file defaults.itl
[1] (5:42) [*] Trying to open the file scripts/defaults.itl
[1] (5:42) --- *(5): *
[1] (5:42) --- *(5): * @OSF_COPYRIGHT@
[1] (5:42) --- *(5): * COPYRIGHT NOTICE
[1] (5:42) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (5:43) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (5:43) --- *(5): * src directory for the full copyright text.
[1] (5:43) --- *(5): *
[1] (5:43) --- *(5): * HISTORY
[1] (5:43) --- *(5): * $Log: defaults.itl,v $
[1] (5:43) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (5:43) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (5:43) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (5:43) --- *(5): *
[1] (5:43) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (5:43) --- *(5): * 	1.0.3a update from Transarc
[1] (5:43) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (5:43) --- *(5): * 
[1] (5:43) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (5:43) --- *(5): * 	Embedded copyright notice
[1] (5:43) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (5:43) --- *(5): * 
[1] (5:43) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (5:44) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (5:44) --- *(5): * 	  Selected comments:
[1] (5:44) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (5:44) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (5:44) --- *(5): * 	    and adds all of the test scripts.
[1] (5:44) --- *(5): * 	    Set default variables from environment.
[1] (5:44) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (5:44) --- *(5): * 
[1] (5:44) --- *(5): * $EndLog$
[1] (5:44) --- *(5): *
[1] (5:44) --- *(5): 
[1] (5:44) --- *(5): * The following three resources must exist before testing begins
[1] (5:44) --- *(5): getenv FSET_DEVICE
[1] (5:44) --- *(5): if ($FSET_DEVICE == "") {
[1] (5:44) --- *(5): 	set device $FSET_DEVICE
[1] (5:45) --- *(5): }
[1] (5:45) --- *(5): 
[1] (5:45) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (5:45) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (5:45) --- *(5): 	set mount_point[0] "/mnt"
[1] (5:45) --- *(5): } else {
[1] (5:45) --- *(5): 
[1] (5:45) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (5:45) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (5:45) --- *(5): 	set mount_point[1] "/mnt2"
[1] (5:45) --- *(5): } else {
[1] (5:45) --- *(5): 
[1] (5:45) --- *(5): 
[1] (5:45) --- *(5): getenv FSET_AGGR_ID
[1] (5:45) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (5:45) --- *(5): 	set aggr_id 1000
[1] (5:45) --- *(5): } else {
[1] (5:45) --- *(5): 
[1] (5:45) --- *(5): getenv FSET_BLOCK_SIZE
[1] (5:46) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (5:46) --- *(5): 	set block_size 8192
[1] (5:46) --- *(5): } else {
[1] (5:46) --- *(5): 
[1] (5:46) --- *(5): getenv FSET_FRAG_SIZE
[1] (5:46) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (5:46) --- *(5): 	set frag_size 1024
[1] (5:46) --- *(5): } else {
[1] (5:46) --- *(5): 
[1] (5:46) --- *(5): set aggr_name	$device
[1] (5:46) --- *(5): set aggr_type	"lfs"
[1] (5:46) --- *(5): 
[1] (5:46) --- *(5): set fset_id   ($aggr_id + 1)
[1] (5:46) --- *(5): set fset_name ("fset" + $fset_id)
[1] (5:46) --- *(5): 
[1] (5:46) --- *(5): set file_name		"zappa"
[1] (5:46) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (5:46) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (5:46) --- *(5): 
[1] (5:47) --- *(5): set setup_aggr proc END
[1] (5:47) --- *(5): !*** Setup the aggregate
[1] (5:47) --- *(5): 	initAggr @device @block_size @frag_size
[1] (5:47) --- *(5): 	verifyAggr @device
[1] (5:47) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (5:47) --- *(5): END
[1] (5:47) --- *(5): 
[1] (5:47) --- *(5): set setup_fset proc END
[1] (5:47) --- *(5): !*** Create and mount a fileset
[1] (5:47) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (5:47) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (5:47) --- *(5): END
[1] (5:47) --- *(5): 
[1] (5:47) --- *(5): set shutdown_fset proc END
[1] (5:47) --- *(5): !*** Destroy the fileset
[1] (5:47) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (5:47) --- *(5): END
[1] (5:47) --- *(5): 
[1] (5:47) --- *(5): set shutdown_aggr proc END
[1] (5:47) --- *(5): !*** Shutdown the aggregate
[1] (5:47) --- *(5): 	detachAggr @aggr_id
[1] (5:47) --- *(5): 	verifyAggr @device
[1] (5:47) --- *(5): END
[1] (5:47) --- *(5): 
[1] (5:47) --- *(5): quit
[1] (5:47) --- *(4): 
[1] (5:48) --- *(4): exec setup_aggr
[1] (5:48) --- *(4): 
[1] (5:48) --- *(4): !*** Setup the aggregate
[1] (5:48) --- !*** Setup the aggregate
[1] (5:48) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (5:56) --- *(4): 	verifyAggr $device
[1] (5:58) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (5:58) --- *(4): 
[1] (5:58) --- *(4): 
[1] (5:58) --- *(4): quit
[1] (5:58) [*] <== finished processing the string
[1] (5:58) --- *(4): exec setup_fset
[1] (5:58) --- *(4): 
[1] (5:58) --- *(4): !*** Create and mount a fileset
[1] (5:58) --- !*** Create and mount a fileset
[1] (5:58) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (5:58) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (5:59) --- *(4): 
[1] (5:59) --- *(4): 
[1] (5:59) --- *(4): quit
[1] (5:59) [*] <== finished processing the string
[1] (5:59) --- *(4): quit
[1] (5:59) --- *(3): 
[1] (5:59) --- *(3): !*** Clone the fileset and mount the clone
[1] (5:59) --- !*** Clone the fileset and mount the clone
[1] (5:59) --- *(3): set clone_name ($fset_name + ".clone")
[1] (5:59) --- *(3): set clone_id ($fset_id + 1)
[1] (5:59) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (5:59) --- *(3): mountFset $clone_id $mount_point[1]
[1] (6:00) --- *(3): 
[1] (6:00) --- *(3): !*** Open the file for writing and write 3 blocks
[1] (6:00) --- !*** Open the file for writing and write 3 blocks
[1] (6:00) --- *(3): open $path_name[0] ($O_CREAT|$O_WRONLY) 0666 fd1
[1] (6:00) --- *(3): set data1 ("1" * ($block_size + 1))
[1] (6:00) --- *(3): write $fd1 $data1
[1] (6:00) --- *(3): set data2 ("2" * ($block_size + 1))
[1] (6:00) --- *(3): write $fd1 $data2
[1] (6:01) --- *(3): set data3 ("3" * ($block_size + 1))
[1] (6:01) [*] Inserting variable data3
[1] (6:01) --- *(3): write $fd1 $data3
[1] (6:01) --- *(3): 
[1] (6:01) --- *(3): !*** Reclone the fileset
[1] (6:01) --- !*** Reclone the fileset
[1] (6:01) --- *(3): recloneFset $aggr_id $fset_id
[1] (6:01) --- *(3): 
[1] (6:01) --- *(3): !*** Overwrite the second block
[1] (6:01) --- !*** Overwrite the second block
[1] (6:01) --- *(3): lseek $fd1 $SEEK_SET ($block_size + 1)
[1] (6:01) --- *(3): set data4 ("4" * ($block_size + 1))
[1] (6:01) [*] Inserting variable data4
[1] (6:01) --- *(3): write $fd1 $data4
[1] (6:01) --- *(3): close $fd1
[1] (6:01) --- *(3): 
[1] (6:01) --- *(3): !*** Verify the read/write file
[1] (6:01) --- !*** Verify the read/write file
[1] (6:02) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (6:02) --- *(3): read $fd1 (3 * $block_size + 3) rw_data
[1] (6:02) [*] Inserting variable rw_data
[1] (6:02) --- *(3): assert ($rw_data == $data1 + $data4 + $data3)
[1] (6:02) --- *(3): close $fd1
[1] (6:02) --- *(3): 
[1] (6:02) --- *(3): !*** Verify the readonly file
[1] (6:02) --- !*** Verify the readonly file
[1] (6:02) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (6:02) --- *(3): read $fd2 (3 * $block_size + 3) ro_data
[1] (6:02) [*] Inserting variable ro_data
[1] (6:02) --- *(3): assert ($ro_data == ($data1 + $data2 + $data3))
[1] (6:02) --- *(3): close $fd2
[1] (6:02) --- *(3): 
[1] (6:02) --- *(3): !*** Unmount the filesets
[1] (6:02) --- !*** Unmount the filesets
[1] (6:02) --- *(3): unmountFset $mount_point[0]
[1] (6:03) --- *(3): unmountFset $mount_point[1]
[1] (6:04) --- *(3): 
[1] (6:04) --- *(3): include "shutdown.itl"
[1] (6:04) [*] Opening the file shutdown.itl
[1] (6:04) [*] Trying to open the file scripts/shutdown.itl
[1] (6:04) --- *(4): *
[1] (6:04) --- *(4): * @OSF_COPYRIGHT@
[1] (6:04) --- *(4): * COPYRIGHT NOTICE
[1] (6:04) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:04) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:04) --- *(4): * src directory for the full copyright text.
[1] (6:04) --- *(4): *
[1] (6:04) --- *(4): * HISTORY
[1] (6:04) --- *(4): * $Log: shutdown.itl,v $
[1] (6:04) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (6:04) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (6:04) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (6:04) --- *(4): *
[1] (6:04) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (6:05) --- *(4): * 	1.0.3a update from Transarc
[1] (6:05) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (6:05) --- *(4): * 
[1] (6:05) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (6:05) --- *(4): * 	Embedded copyright notice
[1] (6:05) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (6:05) --- *(4): * 
[1] (6:05) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (6:05) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:05) --- *(4): * 	  Selected comments:
[1] (6:05) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:05) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:05) --- *(4): * 	    and adds all of the test scripts.
[1] (6:05) --- *(4): * 	    Shutdown a test case.
[1] (6:06) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (6:06) --- *(4): * 
[1] (6:06) --- *(4): * $EndLog$
[1] (6:06) --- *(4): *
[1] (6:06) --- *(4): 
[1] (6:06) --- *(4): exec shutdown_fset
[1] (6:06) --- *(4): 
[1] (6:06) --- *(4): !*** Destroy the fileset
[1] (6:06) --- !*** Destroy the fileset
[1] (6:06) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (6:06) --- *(4): 
[1] (6:06) --- *(4): 
[1] (6:06) --- *(4): quit
[1] (6:06) [*] <== finished processing the string
[1] (6:06) --- *(4): exec shutdown_aggr
[1] (6:06) --- *(4): 
[1] (6:06) --- *(4): !*** Shutdown the aggregate
[1] (6:06) --- !*** Shutdown the aggregate
[1] (6:06) --- *(4): 	detachAggr $aggr_id
[1] (6:06) --- *(4): 	verifyAggr $device
[1] (6:07) --- *(4): 
[1] (6:07) --- *(4): 
[1] (6:07) --- *(4): quit
[1] (6:07) [*] <== finished processing the string
[1] (6:07) --- *(4): quit
[1] (6:07) --- *(3): quit
[1] (6:07) --- *(2): 
[1] (6:07) --- *(2): include "reclone06.itl"
[1] (6:07) [*] Opening the file reclone06.itl
[1] (6:07) [*] Trying to open the file scripts/reclone06.itl
[1] (6:08) --- *(3): *
[1] (6:08) --- *(3): * @OSF_COPYRIGHT@
[1] (6:08) --- *(3): * COPYRIGHT NOTICE
[1] (6:08) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:08) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:08) --- *(3): * src directory for the full copyright text.
[1] (6:08) --- *(3): *
[1] (6:08) --- *(3): * HISTORY
[1] (6:08) --- *(3): * $Log: reclone06.itl,v $
[1] (6:08) --- *(3): * Revision 1.1.426.1  1994/02/04  20:41:58  devsrc
[1] (6:08) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (6:08) --- *(3): * 	[1994/02/04  15:23:03  devsrc]
[1] (6:08) --- *(3): *
[1] (6:08) --- *(3): * Revision 1.1.424.1  1993/12/07  17:42:41  jaffe
[1] (6:09) --- *(3): * 	1.0.3a update from Transarc
[1] (6:09) --- *(3): * 	[1993/12/03  19:00:57  jaffe]
[1] (6:09) --- *(3): * 
[1] (6:09) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:56  htf
[1] (6:09) --- *(3): * 	Embedded copyright notice
[1] (6:09) --- *(3): * 	[1993/01/11  17:03:22  htf]
[1] (6:09) --- *(3): * 
[1] (6:09) --- *(3): * Revision 1.1.2.2  1992/10/28  17:20:03  jaffe
[1] (6:09) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (6:09) --- *(3): * 	  Selected comments:
[1] (6:09) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (6:09) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (6:09) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (6:10) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (6:10) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (6:10) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (6:10) --- *(3): * 	    last argument to the command.
[1] (6:10) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (6:10) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (6:10) --- *(3): * 	    variable by the open and opendir comands.
[1] (6:10) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (6:11) --- *(3): * 	    described above.
[1] (6:11) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (6:11) --- *(3): * 	    Cleanup debugging code.
[1] (6:11) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:11) --- *(3): * 	  Selected comments:
[1] (6:11) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:11) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:11) --- *(3): * 	    and adds all of the test scripts.
[1] (6:11) --- *(3): * 	    Reclone test.
[1] (6:11) --- *(3): * 	[1992/10/27  19:12:15  jaffe]
[1] (6:11) --- *(3): * 
[1] (6:11) --- *(3): * $EndLog$
[1] (6:11) --- *(3): *
[1] (6:11) --- *(3): 
[1] (6:11) --- *(3): !**********************************************************
[1] (6:11) --- !**********************************************************
[1] (6:11) --- *(3): !*** Reclone a fileset with a ZLC file
[1] (6:11) --- !*** Reclone a fileset with a ZLC file
[1] (6:12) --- *(3): !**********************************************************
[1] (6:12) --- !**********************************************************
[1] (6:12) --- *(3): 
[1] (6:12) --- *(3): include "setup.itl"
[1] (6:12) [*] Opening the file setup.itl
[1] (6:12) [*] Trying to open the file scripts/setup.itl
[1] (6:12) --- *(4): *
[1] (6:12) --- *(4): * @OSF_COPYRIGHT@
[1] (6:12) --- *(4): * COPYRIGHT NOTICE
[1] (6:12) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:12) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:12) --- *(4): * src directory for the full copyright text.
[1] (6:12) --- *(4): *
[1] (6:12) --- *(4): * HISTORY
[1] (6:12) --- *(4): * $Log: setup.itl,v $
[1] (6:12) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (6:12) --- *(4): * 	Embedded copyright notice
[1] (6:12) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (6:12) --- *(4): *
[1] (6:12) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (6:13) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:13) --- *(4): * 	  Selected comments:
[1] (6:13) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:13) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:13) --- *(4): * 	    and adds all of the test scripts.
[1] (6:13) --- *(4): * 	    Setup for a test case.
[1] (6:13) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (6:13) --- *(4): * 
[1] (6:13) --- *(4): * $EndLog$
[1] (6:13) --- *(4): *
[1] (6:13) --- *(4): 
[1] (6:13) --- *(4): include "defaults.itl"
[1] (6:13) [*] Opening the file defaults.itl
[1] (6:13) [*] Trying to open the file scripts/defaults.itl
[1] (6:13) --- *(5): *
[1] (6:13) --- *(5): * @OSF_COPYRIGHT@
[1] (6:13) --- *(5): * COPYRIGHT NOTICE
[1] (6:13) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:14) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:14) --- *(5): * src directory for the full copyright text.
[1] (6:14) --- *(5): *
[1] (6:14) --- *(5): * HISTORY
[1] (6:14) --- *(5): * $Log: defaults.itl,v $
[1] (6:14) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (6:14) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (6:14) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (6:14) --- *(5): *
[1] (6:14) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (6:14) --- *(5): * 	1.0.3a update from Transarc
[1] (6:14) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (6:14) --- *(5): * 
[1] (6:14) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (6:14) --- *(5): * 	Embedded copyright notice
[1] (6:14) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (6:14) --- *(5): * 
[1] (6:14) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (6:15) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:15) --- *(5): * 	  Selected comments:
[1] (6:15) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:15) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:15) --- *(5): * 	    and adds all of the test scripts.
[1] (6:15) --- *(5): * 	    Set default variables from environment.
[1] (6:15) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (6:15) --- *(5): * 
[1] (6:15) --- *(5): * $EndLog$
[1] (6:15) --- *(5): *
[1] (6:15) --- *(5): 
[1] (6:15) --- *(5): * The following three resources must exist before testing begins
[1] (6:15) --- *(5): getenv FSET_DEVICE
[1] (6:15) --- *(5): if ($FSET_DEVICE == "") {
[1] (6:16) --- *(5): 	set device $FSET_DEVICE
[1] (6:16) --- *(5): }
[1] (6:16) --- *(5): 
[1] (6:16) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (6:16) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (6:16) --- *(5): 	set mount_point[0] "/mnt"
[1] (6:16) --- *(5): } else {
[1] (6:16) --- *(5): 
[1] (6:16) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (6:16) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (6:16) --- *(5): 	set mount_point[1] "/mnt2"
[1] (6:16) --- *(5): } else {
[1] (6:16) --- *(5): 
[1] (6:16) --- *(5): 
[1] (6:16) --- *(5): getenv FSET_AGGR_ID
[1] (6:16) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (6:16) --- *(5): 	set aggr_id 1000
[1] (6:16) --- *(5): } else {
[1] (6:16) --- *(5): 
[1] (6:17) --- *(5): getenv FSET_BLOCK_SIZE
[1] (6:17) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (6:17) --- *(5): 	set block_size 8192
[1] (6:17) --- *(5): } else {
[1] (6:17) --- *(5): 
[1] (6:17) --- *(5): getenv FSET_FRAG_SIZE
[1] (6:17) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (6:17) --- *(5): 	set frag_size 1024
[1] (6:17) --- *(5): } else {
[1] (6:17) --- *(5): 
[1] (6:17) --- *(5): set aggr_name	$device
[1] (6:17) --- *(5): set aggr_type	"lfs"
[1] (6:17) --- *(5): 
[1] (6:17) --- *(5): set fset_id   ($aggr_id + 1)
[1] (6:17) --- *(5): set fset_name ("fset" + $fset_id)
[1] (6:17) --- *(5): 
[1] (6:17) --- *(5): set file_name		"zappa"
[1] (6:17) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (6:17) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (6:17) --- *(5): 
[1] (6:17) --- *(5): set setup_aggr proc END
[1] (6:18) --- *(5): !*** Setup the aggregate
[1] (6:18) --- *(5): 	initAggr @device @block_size @frag_size
[1] (6:18) --- *(5): 	verifyAggr @device
[1] (6:18) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (6:18) --- *(5): END
[1] (6:18) --- *(5): 
[1] (6:18) --- *(5): set setup_fset proc END
[1] (6:18) --- *(5): !*** Create and mount a fileset
[1] (6:18) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (6:18) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (6:18) --- *(5): END
[1] (6:18) --- *(5): 
[1] (6:18) --- *(5): set shutdown_fset proc END
[1] (6:18) --- *(5): !*** Destroy the fileset
[1] (6:18) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (6:18) --- *(5): END
[1] (6:18) --- *(5): 
[1] (6:18) --- *(5): set shutdown_aggr proc END
[1] (6:18) --- *(5): !*** Shutdown the aggregate
[1] (6:18) --- *(5): 	detachAggr @aggr_id
[1] (6:18) --- *(5): 	verifyAggr @device
[1] (6:18) --- *(5): END
[1] (6:19) --- *(5): 
[1] (6:19) --- *(5): quit
[1] (6:19) --- *(4): 
[1] (6:19) --- *(4): exec setup_aggr
[1] (6:19) --- *(4): 
[1] (6:19) --- *(4): !*** Setup the aggregate
[1] (6:19) --- !*** Setup the aggregate
[1] (6:19) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (6:24) --- *(4): 	verifyAggr $device
[1] (6:26) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (6:26) --- *(4): 
[1] (6:26) --- *(4): 
[1] (6:26) --- *(4): quit
[1] (6:26) [*] <== finished processing the string
[1] (6:26) --- *(4): exec setup_fset
[1] (6:26) --- *(4): 
[1] (6:26) --- *(4): !*** Create and mount a fileset
[1] (6:26) --- !*** Create and mount a fileset
[1] (6:26) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (6:26) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (6:27) --- *(4): 
[1] (6:27) --- *(4): 
[1] (6:27) --- *(4): quit
[1] (6:27) [*] <== finished processing the string
[1] (6:27) --- *(4): quit
[1] (6:27) --- *(3): 
[1] (6:27) --- *(3): !*** Clone the fileset and mount the clone
[1] (6:27) --- !*** Clone the fileset and mount the clone
[1] (6:27) --- *(3): set clone_name ($fset_name + ".clone")
[1] (6:27) --- *(3): set clone_id ($fset_id + 1)
[1] (6:27) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (6:27) --- *(3): mountFset $clone_id $mount_point[1]
[1] (6:28) --- *(3): 
[1] (6:28) --- *(3): !*** Write 1 block + 1 byte to a new file
[1] (6:28) --- !*** Write 1 block + 1 byte to a new file
[1] (6:28) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (6:28) --- *(3): set data ("1" * ($block_size + 1))
[1] (6:28) --- *(3): write $fd1 $data
[1] (6:28) --- *(3): close $fd1
[1] (6:28) --- *(3): 
[1] (6:28) --- *(3): !*** Open the file for reading then unlink it
[1] (6:28) --- !*** Open the file for reading then unlink it
[1] (6:28) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (6:28) --- *(3): unlink $path_name[0]
[1] (6:28) --- *(3): 
[1] (6:29) --- *(3): !*** Make sure the file doesn't exist anymore
[1] (6:29) --- !*** Make sure the file doesn't exist anymore
[1] (6:29) --- *(3): verifyStatus false
[1] (6:29) [*] Using false  for Verify Status.
[1] (6:29) --- Status verification is OFF
[1] (6:29) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (6:29) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:29) --- *(3): verifyStatus true
[1] (6:29) [*] Using true  for Verify Status.
[1] (6:29) --- Status verification is ON
[1] (6:29) --- *(3): 
[1] (6:29) --- *(3): !*** Reclone the fileset
[1] (6:29) --- !*** Reclone the fileset
[1] (6:29) --- *(3): recloneFset $aggr_id $fset_id
[1] (6:29) --- *(3): 
[1] (6:29) --- *(3): !*** Make sure the file doesn't exist in the backing fileset
[1] (6:29) --- !*** Make sure the file doesn't exist in the backing fileset
[1] (6:29) --- *(3): verifyStatus false
[1] (6:29) [*] Using false  for Verify Status.
[1] (6:29) --- Status verification is OFF
[1] (6:29) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (6:29) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:29) --- *(3): verifyStatus true
[1] (6:29) [*] Using true  for Verify Status.
[1] (6:29) --- Status verification is ON
[1] (6:29) --- *(3): 
[1] (6:30) --- *(3): !*** Try to read the file
[1] (6:30) --- !*** Try to read the file
[1] (6:30) --- *(3): read $fd1 ($block_size + 1) read_data
[1] (6:30) --- *(3): assert ($read_data == $data)
[1] (6:30) --- *(3): close $fd1
[1] (6:30) --- *(3): 
[1] (6:30) --- *(3): !*** Make sure the original file still doesn't exist
[1] (6:30) --- !*** Make sure the original file still doesn't exist
[1] (6:30) --- *(3): verifyStatus false
[1] (6:30) [*] Using false  for Verify Status.
[1] (6:30) --- Status verification is OFF
[1] (6:30) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (6:30) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:30) --- *(3): verifyStatus true
[1] (6:30) [*] Using true  for Verify Status.
[1] (6:30) --- Status verification is ON
[1] (6:30) --- *(3): 
[1] (6:30) --- *(3): !*** Unmount the filesets
[1] (6:30) --- !*** Unmount the filesets
[1] (6:30) --- *(3): unmountFset $mount_point[0]
[1] (6:31) --- *(3): unmountFset $mount_point[1]
[1] (6:32) --- *(3): 
[1] (6:32) --- *(3): include "shutdown.itl"
[1] (6:32) [*] Opening the file shutdown.itl
[1] (6:32) [*] Trying to open the file scripts/shutdown.itl
[1] (6:32) --- *(4): *
[1] (6:32) --- *(4): * @OSF_COPYRIGHT@
[1] (6:32) --- *(4): * COPYRIGHT NOTICE
[1] (6:32) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:32) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:32) --- *(4): * src directory for the full copyright text.
[1] (6:32) --- *(4): *
[1] (6:32) --- *(4): * HISTORY
[1] (6:32) --- *(4): * $Log: shutdown.itl,v $
[1] (6:32) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (6:32) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (6:32) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (6:32) --- *(4): *
[1] (6:32) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (6:33) --- *(4): * 	1.0.3a update from Transarc
[1] (6:33) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (6:33) --- *(4): * 
[1] (6:33) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (6:33) --- *(4): * 	Embedded copyright notice
[1] (6:33) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (6:33) --- *(4): * 
[1] (6:33) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (6:33) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:33) --- *(4): * 	  Selected comments:
[1] (6:33) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:33) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:33) --- *(4): * 	    and adds all of the test scripts.
[1] (6:33) --- *(4): * 	    Shutdown a test case.
[1] (6:34) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (6:34) --- *(4): * 
[1] (6:34) --- *(4): * $EndLog$
[1] (6:34) --- *(4): *
[1] (6:34) --- *(4): 
[1] (6:34) --- *(4): exec shutdown_fset
[1] (6:34) --- *(4): 
[1] (6:34) --- *(4): !*** Destroy the fileset
[1] (6:34) --- !*** Destroy the fileset
[1] (6:34) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (6:34) --- *(4): 
[1] (6:34) --- *(4): 
[1] (6:34) --- *(4): quit
[1] (6:34) [*] <== finished processing the string
[1] (6:34) --- *(4): exec shutdown_aggr
[1] (6:34) --- *(4): 
[1] (6:34) --- *(4): !*** Shutdown the aggregate
[1] (6:34) --- !*** Shutdown the aggregate
[1] (6:34) --- *(4): 	detachAggr $aggr_id
[1] (6:34) --- *(4): 	verifyAggr $device
[1] (6:35) --- *(4): 
[1] (6:35) --- *(4): 
[1] (6:35) --- *(4): quit
[1] (6:35) [*] <== finished processing the string
[1] (6:35) --- *(4): quit
[1] (6:35) --- *(3): quit
[1] (6:35) --- *(2): 
[1] (6:35) --- *(2): include "reclone07.itl"
[1] (6:35) [*] Opening the file reclone07.itl
[1] (6:35) [*] Trying to open the file scripts/reclone07.itl
[1] (6:36) --- *(3): *
[1] (6:36) --- *(3): * @OSF_COPYRIGHT@
[1] (6:36) --- *(3): * COPYRIGHT NOTICE
[1] (6:36) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:36) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:36) --- *(3): * src directory for the full copyright text.
[1] (6:36) --- *(3): *
[1] (6:36) --- *(3): * HISTORY
[1] (6:36) --- *(3): * $Log: reclone07.itl,v $
[1] (6:36) --- *(3): * Revision 1.1.427.1  1994/02/04  20:42:01  devsrc
[1] (6:36) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (6:36) --- *(3): * 	[1994/02/04  15:23:04  devsrc]
[1] (6:36) --- *(3): *
[1] (6:36) --- *(3): * Revision 1.1.425.1  1993/12/07  17:42:42  jaffe
[1] (6:36) --- *(3): * 	1.0.3a update from Transarc
[1] (6:37) --- *(3): * 	[1993/12/03  19:01:15  jaffe]
[1] (6:37) --- *(3): * 
[1] (6:37) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:58  htf
[1] (6:37) --- *(3): * 	Embedded copyright notice
[1] (6:37) --- *(3): * 	[1993/01/11  17:03:26  htf]
[1] (6:37) --- *(3): * 
[1] (6:37) --- *(3): * Revision 1.1.2.2  1992/10/28  17:20:09  jaffe
[1] (6:37) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (6:37) --- *(3): * 	  Selected comments:
[1] (6:37) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (6:37) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (6:37) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (6:38) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (6:38) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (6:38) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (6:38) --- *(3): * 	    last argument to the command.
[1] (6:38) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (6:38) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (6:38) --- *(3): * 	    variable by the open and opendir comands.
[1] (6:38) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (6:38) --- *(3): * 	    described above.
[1] (6:39) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (6:39) --- *(3): * 	    Cleanup debugging code.
[1] (6:39) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:39) --- *(3): * 	  Selected comments:
[1] (6:39) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:39) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:39) --- *(3): * 	    and adds all of the test scripts.
[1] (6:39) --- *(3): * 	    Reclone test.
[1] (6:39) --- *(3): * 	[1992/10/27  19:12:51  jaffe]
[1] (6:39) --- *(3): * 
[1] (6:39) --- *(3): * $EndLog$
[1] (6:39) --- *(3): *
[1] (6:39) --- *(3): 
[1] (6:39) --- *(3): !**********************************************************
[1] (6:39) --- !**********************************************************
[1] (6:39) --- *(3): !*** Reclone a fileset with a ZLC file open for writing
[1] (6:40) --- !*** Reclone a fileset with a ZLC file open for writing
[1] (6:40) --- *(3): !**********************************************************
[1] (6:40) --- !**********************************************************
[1] (6:40) --- *(3): 
[1] (6:40) --- *(3): include "setup.itl"
[1] (6:40) [*] Opening the file setup.itl
[1] (6:40) [*] Trying to open the file scripts/setup.itl
[1] (6:40) --- *(4): *
[1] (6:40) --- *(4): * @OSF_COPYRIGHT@
[1] (6:40) --- *(4): * COPYRIGHT NOTICE
[1] (6:40) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:40) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:40) --- *(4): * src directory for the full copyright text.
[1] (6:40) --- *(4): *
[1] (6:40) --- *(4): * HISTORY
[1] (6:40) --- *(4): * $Log: setup.itl,v $
[1] (6:40) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (6:40) --- *(4): * 	Embedded copyright notice
[1] (6:40) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (6:40) --- *(4): *
[1] (6:40) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (6:41) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:41) --- *(4): * 	  Selected comments:
[1] (6:41) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:41) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:41) --- *(4): * 	    and adds all of the test scripts.
[1] (6:41) --- *(4): * 	    Setup for a test case.
[1] (6:41) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (6:41) --- *(4): * 
[1] (6:41) --- *(4): * $EndLog$
[1] (6:41) --- *(4): *
[1] (6:41) --- *(4): 
[1] (6:41) --- *(4): include "defaults.itl"
[1] (6:41) [*] Opening the file defaults.itl
[1] (6:41) [*] Trying to open the file scripts/defaults.itl
[1] (6:41) --- *(5): *
[1] (6:41) --- *(5): * @OSF_COPYRIGHT@
[1] (6:41) --- *(5): * COPYRIGHT NOTICE
[1] (6:41) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (6:42) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (6:42) --- *(5): * src directory for the full copyright text.
[1] (6:42) --- *(5): *
[1] (6:42) --- *(5): * HISTORY
[1] (6:42) --- *(5): * $Log: defaults.itl,v $
[1] (6:42) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (6:42) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (6:42) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (6:42) --- *(5): *
[1] (6:42) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (6:42) --- *(5): * 	1.0.3a update from Transarc
[1] (6:42) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (6:42) --- *(5): * 
[1] (6:42) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (6:42) --- *(5): * 	Embedded copyright notice
[1] (6:42) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (6:42) --- *(5): * 
[1] (6:42) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (6:43) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (6:43) --- *(5): * 	  Selected comments:
[1] (6:43) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (6:43) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (6:43) --- *(5): * 	    and adds all of the test scripts.
[1] (6:43) --- *(5): * 	    Set default variables from environment.
[1] (6:43) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (6:43) --- *(5): * 
[1] (6:43) --- *(5): * $EndLog$
[1] (6:43) --- *(5): *
[1] (6:43) --- *(5): 
[1] (6:43) --- *(5): * The following three resources must exist before testing begins
[1] (6:43) --- *(5): getenv FSET_DEVICE
[1] (6:43) --- *(5): if ($FSET_DEVICE == "") {
[1] (6:43) --- *(5): 	set device $FSET_DEVICE
[1] (6:43) --- *(5): }
[1] (6:43) --- *(5): 
[1] (6:44) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (6:44) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (6:44) --- *(5): 	set mount_point[0] "/mnt"
[1] (6:44) --- *(5): } else {
[1] (6:44) --- *(5): 
[1] (6:44) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (6:44) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (6:44) --- *(5): 	set mount_point[1] "/mnt2"
[1] (6:44) --- *(5): } else {
[1] (6:44) --- *(5): 
[1] (6:44) --- *(5): 
[1] (6:44) --- *(5): getenv FSET_AGGR_ID
[1] (6:44) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (6:44) --- *(5): 	set aggr_id 1000
[1] (6:44) --- *(5): } else {
[1] (6:44) --- *(5): 
[1] (6:44) --- *(5): getenv FSET_BLOCK_SIZE
[1] (6:44) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (6:44) --- *(5): 	set block_size 8192
[1] (6:44) --- *(5): } else {
[1] (6:45) --- *(5): 
[1] (6:45) --- *(5): getenv FSET_FRAG_SIZE
[1] (6:45) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (6:45) --- *(5): 	set frag_size 1024
[1] (6:45) --- *(5): } else {
[1] (6:45) --- *(5): 
[1] (6:45) --- *(5): set aggr_name	$device
[1] (6:45) --- *(5): set aggr_type	"lfs"
[1] (6:45) --- *(5): 
[1] (6:45) --- *(5): set fset_id   ($aggr_id + 1)
[1] (6:45) --- *(5): set fset_name ("fset" + $fset_id)
[1] (6:45) --- *(5): 
[1] (6:45) --- *(5): set file_name		"zappa"
[1] (6:45) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (6:45) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (6:45) --- *(5): 
[1] (6:45) --- *(5): set setup_aggr proc END
[1] (6:45) --- *(5): !*** Setup the aggregate
[1] (6:46) --- *(5): 	initAggr @device @block_size @frag_size
[1] (6:46) --- *(5): 	verifyAggr @device
[1] (6:46) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (6:46) --- *(5): END
[1] (6:46) --- *(5): 
[1] (6:46) --- *(5): set setup_fset proc END
[1] (6:46) --- *(5): !*** Create and mount a fileset
[1] (6:46) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (6:46) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (6:46) --- *(5): END
[1] (6:46) --- *(5): 
[1] (6:46) --- *(5): set shutdown_fset proc END
[1] (6:46) --- *(5): !*** Destroy the fileset
[1] (6:46) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (6:46) --- *(5): END
[1] (6:46) --- *(5): 
[1] (6:46) --- *(5): set shutdown_aggr proc END
[1] (6:46) --- *(5): !*** Shutdown the aggregate
[1] (6:46) --- *(5): 	detachAggr @aggr_id
[1] (6:46) --- *(5): 	verifyAggr @device
[1] (6:46) --- *(5): END
[1] (6:46) --- *(5): 
[1] (6:46) --- *(5): quit
[1] (6:46) --- *(4): 
[1] (6:46) --- *(4): exec setup_aggr
[1] (6:46) --- *(4): 
[1] (6:46) --- *(4): !*** Setup the aggregate
[1] (6:46) --- !*** Setup the aggregate
[1] (6:46) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (6:52) --- *(4): 	verifyAggr $device
[1] (6:53) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (6:53) --- *(4): 
[1] (6:53) --- *(4): 
[1] (6:53) --- *(4): quit
[1] (6:53) [*] <== finished processing the string
[1] (6:53) --- *(4): exec setup_fset
[1] (6:53) --- *(4): 
[1] (6:53) --- *(4): !*** Create and mount a fileset
[1] (6:54) --- !*** Create and mount a fileset
[1] (6:54) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (6:54) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (6:54) --- *(4): 
[1] (6:54) --- *(4): 
[1] (6:54) --- *(4): quit
[1] (6:54) [*] <== finished processing the string
[1] (6:54) --- *(4): quit
[1] (6:54) --- *(3): 
[1] (6:54) --- *(3): !*** Clone the fileset and mount the clone
[1] (6:54) --- !*** Clone the fileset and mount the clone
[1] (6:55) --- *(3): set clone_name ($fset_name + ".clone")
[1] (6:55) --- *(3): set clone_id ($fset_id + 1)
[1] (6:55) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (6:55) --- *(3): mountFset $clone_id $mount_point[1]
[1] (6:56) --- *(3): 
[1] (6:56) --- *(3): !*** Open a file for writing then unlink it
[1] (6:56) --- !*** Open a file for writing then unlink it
[1] (6:56) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (6:56) --- *(3): unlink $path_name[0]
[1] (6:56) --- *(3): 
[1] (6:56) --- *(3): !*** Make sure the file doesn't exist anymore
[1] (6:56) --- !*** Make sure the file doesn't exist anymore
[1] (6:56) --- *(3): verifyStatus false
[1] (6:56) [*] Using false  for Verify Status.
[1] (6:56) --- Status verification is OFF
[1] (6:56) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (6:56) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:56) --- *(3): verifyStatus true
[1] (6:56) [*] Using true  for Verify Status.
[1] (6:56) --- Status verification is ON
[1] (6:56) --- *(3): 
[1] (6:56) --- *(3): !*** Create a random new file 
[1] (6:56) --- !*** Create a random new file 
[1] (6:56) --- *(3): set $random_file ($mount_point[0] + "/random")
[1] (6:56) [*] Inserting variable /mnt/random
[1] (6:57) --- *(3): open $random_file ($O_CREAT|$O_WRONLY) 0666 random_fd
[1] (6:57) --- *(3): close $random_fd
[1] (6:57) --- *(3): 
[1] (6:57) --- *(3): !*** Reclone the fileset
[1] (6:57) --- !*** Reclone the fileset
[1] (6:57) --- *(3): recloneFset $aggr_id $fset_id
[1] (6:57) --- *(3): 
[1] (6:57) --- *(3): !*** Make sure the file doesn't exist in the backing fileset
[1] (6:57) --- !*** Make sure the file doesn't exist in the backing fileset
[1] (6:57) --- *(3): verifyStatus false
[1] (6:57) [*] Using false  for Verify Status.
[1] (6:57) --- Status verification is OFF
[1] (6:57) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (6:57) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:57) --- *(3): verifyStatus true
[1] (6:57) [*] Using true  for Verify Status.
[1] (6:57) --- Status verification is ON
[1] (6:57) --- *(3): 
[1] (6:57) --- *(3): !*** Write 1 block + 1 byte to the file
[1] (6:57) --- !*** Write 1 block + 1 byte to the file
[1] (6:57) --- *(3): set data ("1" * ($block_size + 1))
[1] (6:57) --- *(3): write $fd1 $data
[1] (6:57) --- *(3): 
[1] (6:57) --- *(3): !*** Read the data back
[1] (6:57) --- !*** Read the data back
[1] (6:58) --- *(3): lseek $fd1 0 $SEEK_SET
[1] (6:58) --- *(3): read $fd1 ($block_size + 1) read_data
[1] (6:58) --- *(3): assert ($read_data == $data)
[1] (6:58) --- *(3): close $fd1
[1] (6:58) --- *(3): 
[1] (6:58) --- *(3): !*** Make sure the original file still doesn't exist
[1] (6:58) --- !*** Make sure the original file still doesn't exist
[1] (6:58) --- *(3): verifyStatus false
[1] (6:58) [*] Using false  for Verify Status.
[1] (6:58) --- Status verification is OFF
[1] (6:58) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (6:58) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:58) --- *(3): verifyStatus true
[1] (6:58) [*] Using true  for Verify Status.
[1] (6:58) --- Status verification is ON
[1] (6:58) --- *(3): 
[1] (6:58) --- *(3): !*** Make sure the file still doesn't exist in the
[1] (6:58) --- !*** Make sure the file still doesn't exist in the
[1] (6:58) --- *(3): !***    backing fileset
[1] (6:58) --- !***    backing fileset
[1] (6:58) --- *(3): verifyStatus false
[1] (6:58) [*] Using false  for Verify Status.
[1] (6:58) --- Status verification is OFF
[1] (6:58) --- *(3): open $path_name[1] $O_RDONLY 0 fd2
[1] (6:58) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (6:58) --- *(3): verifyStatus true
[1] (6:58) [*] Using true  for Verify Status.
[1] (6:58) --- Status verification is ON
[1] (6:58) --- *(3): 
[1] (6:59) --- *(3): !*** Unmount the filesets
[1] (6:59) --- !*** Unmount the filesets
[1] (6:59) --- *(3): unmountFset $mount_point[0]
[1] (6:59) --- *(3): unmountFset $mount_point[1]
[1] (7:00) --- *(3): 
[1] (7:00) --- *(3): include "shutdown.itl"
[1] (7:00) [*] Opening the file shutdown.itl
[1] (7:00) [*] Trying to open the file scripts/shutdown.itl
[1] (7:00) --- *(4): *
[1] (7:00) --- *(4): * @OSF_COPYRIGHT@
[1] (7:00) --- *(4): * COPYRIGHT NOTICE
[1] (7:00) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:00) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:00) --- *(4): * src directory for the full copyright text.
[1] (7:00) --- *(4): *
[1] (7:00) --- *(4): * HISTORY
[1] (7:00) --- *(4): * $Log: shutdown.itl,v $
[1] (7:00) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (7:01) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (7:01) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (7:01) --- *(4): *
[1] (7:01) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (7:01) --- *(4): * 	1.0.3a update from Transarc
[1] (7:01) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (7:01) --- *(4): * 
[1] (7:01) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (7:01) --- *(4): * 	Embedded copyright notice
[1] (7:01) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (7:01) --- *(4): * 
[1] (7:01) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (7:01) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:01) --- *(4): * 	  Selected comments:
[1] (7:01) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:02) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:02) --- *(4): * 	    and adds all of the test scripts.
[1] (7:02) --- *(4): * 	    Shutdown a test case.
[1] (7:02) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (7:02) --- *(4): * 
[1] (7:02) --- *(4): * $EndLog$
[1] (7:02) --- *(4): *
[1] (7:02) --- *(4): 
[1] (7:02) --- *(4): exec shutdown_fset
[1] (7:02) --- *(4): 
[1] (7:02) --- *(4): !*** Destroy the fileset
[1] (7:02) --- !*** Destroy the fileset
[1] (7:02) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (7:02) --- *(4): 
[1] (7:02) --- *(4): 
[1] (7:02) --- *(4): quit
[1] (7:02) [*] <== finished processing the string
[1] (7:02) --- *(4): exec shutdown_aggr
[1] (7:02) --- *(4): 
[1] (7:02) --- *(4): !*** Shutdown the aggregate
[1] (7:02) --- !*** Shutdown the aggregate
[1] (7:02) --- *(4): 	detachAggr $aggr_id
[1] (7:02) --- *(4): 	verifyAggr $device
[1] (7:04) --- *(4): 
[1] (7:04) --- *(4): 
[1] (7:04) --- *(4): quit
[1] (7:04) [*] <== finished processing the string
[1] (7:04) --- *(4): quit
[1] (7:04) --- *(3): quit
[1] (7:04) --- *(2): 
[1] (7:04) --- *(2): include "reclone08.itl"
[1] (7:04) [*] Opening the file reclone08.itl
[1] (7:04) [*] Trying to open the file scripts/reclone08.itl
[1] (7:04) --- *(3): *
[1] (7:04) --- *(3): * @OSF_COPYRIGHT@
[1] (7:04) --- *(3): * COPYRIGHT NOTICE
[1] (7:04) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:04) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:04) --- *(3): * src directory for the full copyright text.
[1] (7:04) --- *(3): *
[1] (7:04) --- *(3): * HISTORY
[1] (7:04) --- *(3): * $Log: reclone08.itl,v $
[1] (7:05) --- *(3): * Revision 1.1.428.1  1994/02/04  20:42:03  devsrc
[1] (7:05) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (7:05) --- *(3): * 	[1994/02/04  15:23:06  devsrc]
[1] (7:05) --- *(3): *
[1] (7:05) --- *(3): * Revision 1.1.426.1  1993/12/07  17:42:43  jaffe
[1] (7:05) --- *(3): * 	1.0.3a update from Transarc
[1] (7:05) --- *(3): * 	[1993/12/03  19:01:29  jaffe]
[1] (7:05) --- *(3): * 
[1] (7:05) --- *(3): * Revision 1.1.2.3  1993/01/11  18:28:00  htf
[1] (7:05) --- *(3): * 	Embedded copyright notice
[1] (7:05) --- *(3): * 	[1993/01/11  17:03:30  htf]
[1] (7:05) --- *(3): * 
[1] (7:05) --- *(3): * Revision 1.1.2.2  1992/10/28  17:20:15  jaffe
[1] (7:05) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:05) --- *(3): * 	  Selected comments:
[1] (7:05) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:06) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:06) --- *(3): * 	    and adds all of the test scripts.
[1] (7:06) --- *(3): * 	    Reclone test.
[1] (7:06) --- *(3): * 	[1992/10/27  19:16:48  jaffe]
[1] (7:06) --- *(3): * 
[1] (7:06) --- *(3): * $EndLog$
[1] (7:06) --- *(3): *
[1] (7:06) --- *(3): 
[1] (7:06) --- *(3): !**********************************************************
[1] (7:06) --- !**********************************************************
[1] (7:06) --- *(3): !*** Reclone a readonly fileset
[1] (7:06) --- !*** Reclone a readonly fileset
[1] (7:06) --- *(3): !**********************************************************
[1] (7:06) --- !**********************************************************
[1] (7:06) --- *(3): 
[1] (7:06) --- *(3): include "setup.itl"
[1] (7:06) [*] Opening the file setup.itl
[1] (7:06) [*] Trying to open the file scripts/setup.itl
[1] (7:06) --- *(4): *
[1] (7:06) --- *(4): * @OSF_COPYRIGHT@
[1] (7:06) --- *(4): * COPYRIGHT NOTICE
[1] (7:06) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:07) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:07) --- *(4): * src directory for the full copyright text.
[1] (7:07) --- *(4): *
[1] (7:07) --- *(4): * HISTORY
[1] (7:07) --- *(4): * $Log: setup.itl,v $
[1] (7:07) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (7:07) --- *(4): * 	Embedded copyright notice
[1] (7:07) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (7:07) --- *(4): *
[1] (7:07) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (7:07) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:07) --- *(4): * 	  Selected comments:
[1] (7:07) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:07) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:07) --- *(4): * 	    and adds all of the test scripts.
[1] (7:08) --- *(4): * 	    Setup for a test case.
[1] (7:08) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (7:08) --- *(4): * 
[1] (7:08) --- *(4): * $EndLog$
[1] (7:08) --- *(4): *
[1] (7:08) --- *(4): 
[1] (7:08) --- *(4): include "defaults.itl"
[1] (7:08) [*] Opening the file defaults.itl
[1] (7:08) [*] Trying to open the file scripts/defaults.itl
[1] (7:08) --- *(5): *
[1] (7:08) --- *(5): * @OSF_COPYRIGHT@
[1] (7:08) --- *(5): * COPYRIGHT NOTICE
[1] (7:08) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:08) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:08) --- *(5): * src directory for the full copyright text.
[1] (7:08) --- *(5): *
[1] (7:08) --- *(5): * HISTORY
[1] (7:08) --- *(5): * $Log: defaults.itl,v $
[1] (7:08) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (7:08) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (7:08) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (7:08) --- *(5): *
[1] (7:09) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (7:09) --- *(5): * 	1.0.3a update from Transarc
[1] (7:09) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (7:09) --- *(5): * 
[1] (7:09) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (7:09) --- *(5): * 	Embedded copyright notice
[1] (7:09) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (7:09) --- *(5): * 
[1] (7:09) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (7:09) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:09) --- *(5): * 	  Selected comments:
[1] (7:09) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:09) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:09) --- *(5): * 	    and adds all of the test scripts.
[1] (7:10) --- *(5): * 	    Set default variables from environment.
[1] (7:10) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (7:10) --- *(5): * 
[1] (7:10) --- *(5): * $EndLog$
[1] (7:10) --- *(5): *
[1] (7:10) --- *(5): 
[1] (7:10) --- *(5): * The following three resources must exist before testing begins
[1] (7:10) --- *(5): getenv FSET_DEVICE
[1] (7:10) --- *(5): if ($FSET_DEVICE == "") {
[1] (7:10) --- *(5): 	set device $FSET_DEVICE
[1] (7:10) --- *(5): }
[1] (7:10) --- *(5): 
[1] (7:10) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (7:10) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (7:10) --- *(5): 	set mount_point[0] "/mnt"
[1] (7:10) --- *(5): } else {
[1] (7:10) --- *(5): 
[1] (7:10) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (7:10) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (7:10) --- *(5): 	set mount_point[1] "/mnt2"
[1] (7:10) --- *(5): } else {
[1] (7:11) --- *(5): 
[1] (7:11) --- *(5): 
[1] (7:11) --- *(5): getenv FSET_AGGR_ID
[1] (7:11) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (7:11) --- *(5): 	set aggr_id 1000
[1] (7:11) --- *(5): } else {
[1] (7:11) --- *(5): 
[1] (7:11) --- *(5): getenv FSET_BLOCK_SIZE
[1] (7:11) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (7:11) --- *(5): 	set block_size 8192
[1] (7:11) --- *(5): } else {
[1] (7:11) --- *(5): 
[1] (7:11) --- *(5): getenv FSET_FRAG_SIZE
[1] (7:11) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (7:11) --- *(5): 	set frag_size 1024
[1] (7:11) --- *(5): } else {
[1] (7:11) --- *(5): 
[1] (7:11) --- *(5): set aggr_name	$device
[1] (7:11) --- *(5): set aggr_type	"lfs"
[1] (7:11) --- *(5): 
[1] (7:11) --- *(5): set fset_id   ($aggr_id + 1)
[1] (7:11) --- *(5): set fset_name ("fset" + $fset_id)
[1] (7:11) --- *(5): 
[1] (7:12) --- *(5): set file_name		"zappa"
[1] (7:12) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (7:12) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (7:12) --- *(5): 
[1] (7:12) --- *(5): set setup_aggr proc END
[1] (7:12) --- *(5): !*** Setup the aggregate
[1] (7:12) --- *(5): 	initAggr @device @block_size @frag_size
[1] (7:12) --- *(5): 	verifyAggr @device
[1] (7:12) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (7:12) --- *(5): END
[1] (7:12) --- *(5): 
[1] (7:12) --- *(5): set setup_fset proc END
[1] (7:12) --- *(5): !*** Create and mount a fileset
[1] (7:12) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (7:12) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (7:12) --- *(5): END
[1] (7:12) --- *(5): 
[1] (7:12) --- *(5): set shutdown_fset proc END
[1] (7:12) --- *(5): !*** Destroy the fileset
[1] (7:13) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (7:13) --- *(5): END
[1] (7:13) --- *(5): 
[1] (7:13) --- *(5): set shutdown_aggr proc END
[1] (7:13) --- *(5): !*** Shutdown the aggregate
[1] (7:13) --- *(5): 	detachAggr @aggr_id
[1] (7:13) --- *(5): 	verifyAggr @device
[1] (7:13) --- *(5): END
[1] (7:13) --- *(5): 
[1] (7:13) --- *(5): quit
[1] (7:13) --- *(4): 
[1] (7:13) --- *(4): exec setup_aggr
[1] (7:13) --- *(4): 
[1] (7:13) --- *(4): !*** Setup the aggregate
[1] (7:13) --- !*** Setup the aggregate
[1] (7:13) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (7:18) --- *(4): 	verifyAggr $device
[1] (7:19) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (7:20) --- *(4): 
[1] (7:20) --- *(4): 
[1] (7:20) --- *(4): quit
[1] (7:20) [*] <== finished processing the string
[1] (7:20) --- *(4): exec setup_fset
[1] (7:20) --- *(4): 
[1] (7:20) --- *(4): !*** Create and mount a fileset
[1] (7:20) --- !*** Create and mount a fileset
[1] (7:20) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (7:20) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (7:20) --- *(4): 
[1] (7:20) --- *(4): 
[1] (7:20) --- *(4): quit
[1] (7:20) [*] <== finished processing the string
[1] (7:20) --- *(4): quit
[1] (7:20) --- *(3): 
[1] (7:21) --- *(3): !*** Clone the fileset
[1] (7:21) --- !*** Clone the fileset
[1] (7:21) --- *(3): set clone_name ($fset_name + ".clone")
[1] (7:21) --- *(3): set clone_id ($fset_id + 1)
[1] (7:21) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (7:21) --- *(3): 
[1] (7:21) --- *(3): !*** Attempt to reclone the readonly fileset
[1] (7:21) --- !*** Attempt to reclone the readonly fileset
[1] (7:21) --- *(3): verifyStatus false
[1] (7:21) [*] Using false  for Verify Status.
[1] (7:21) --- Status verification is OFF
[1] (7:21) --- *(3): recloneFset $aggr_id $clone_id
[1] (7:21) --- *(3): assert ($ITL_Status == $FTU_E_NO_BACKING_FSET)
[1] (7:21) --- *(3): verifyStatus true
[1] (7:21) [*] Using true  for Verify Status.
[1] (7:21) --- Status verification is ON
[1] (7:21) --- *(3): 
[1] (7:21) --- *(3): !*** Clone the fileset again
[1] (7:21) --- !*** Clone the fileset again
[1] (7:21) --- *(3): set clone_name ($fset_name + ".clone2")
[1] (7:21) --- *(3): set clone_id ($fset_id + 2)
[1] (7:22) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (7:22) --- *(3): 
[1] (7:22) --- *(3): !*** Reclone the new clone
[1] (7:22) --- !*** Reclone the new clone
[1] (7:22) --- *(3): recloneFset $aggr_id $clone_id
[1] (7:22) --- *(3): 
[1] (7:22) --- *(3): !*** Unmount the fileset
[1] (7:22) --- !*** Unmount the fileset
[1] (7:22) --- *(3): unmountFset $mount_point[0]
[1] (7:23) --- *(3): 
[1] (7:23) --- *(3): include "shutdown.itl"
[1] (7:23) [*] Opening the file shutdown.itl
[1] (7:23) [*] Trying to open the file scripts/shutdown.itl
[1] (7:23) --- *(4): *
[1] (7:23) --- *(4): * @OSF_COPYRIGHT@
[1] (7:23) --- *(4): * COPYRIGHT NOTICE
[1] (7:23) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:23) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:23) --- *(4): * src directory for the full copyright text.
[1] (7:23) --- *(4): *
[1] (7:23) --- *(4): * HISTORY
[1] (7:23) --- *(4): * $Log: shutdown.itl,v $
[1] (7:23) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (7:23) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (7:23) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (7:23) --- *(4): *
[1] (7:24) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (7:24) --- *(4): * 	1.0.3a update from Transarc
[1] (7:24) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (7:24) --- *(4): * 
[1] (7:24) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (7:24) --- *(4): * 	Embedded copyright notice
[1] (7:24) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (7:24) --- *(4): * 
[1] (7:24) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (7:24) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:24) --- *(4): * 	  Selected comments:
[1] (7:24) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:24) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:24) --- *(4): * 	    and adds all of the test scripts.
[1] (7:25) --- *(4): * 	    Shutdown a test case.
[1] (7:25) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (7:25) --- *(4): * 
[1] (7:25) --- *(4): * $EndLog$
[1] (7:25) --- *(4): *
[1] (7:25) --- *(4): 
[1] (7:25) --- *(4): exec shutdown_fset
[1] (7:25) --- *(4): 
[1] (7:25) --- *(4): !*** Destroy the fileset
[1] (7:25) --- !*** Destroy the fileset
[1] (7:25) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (7:25) --- *(4): 
[1] (7:25) --- *(4): 
[1] (7:25) --- *(4): quit
[1] (7:25) [*] <== finished processing the string
[1] (7:25) --- *(4): exec shutdown_aggr
[1] (7:25) --- *(4): 
[1] (7:25) --- *(4): !*** Shutdown the aggregate
[1] (7:25) --- !*** Shutdown the aggregate
[1] (7:25) --- *(4): 	detachAggr $aggr_id
[1] (7:25) --- *(4): 	verifyAggr $device
[1] (7:26) --- *(4): 
[1] (7:26) --- *(4): 
[1] (7:26) --- *(4): quit
[1] (7:26) [*] <== finished processing the string
[1] (7:26) --- *(4): quit
[1] (7:26) --- *(3): quit
[1] (7:26) --- *(2): quit
[1] (7:27) --- *(1): 
[1] (7:27) --- *(1): include "destroy.itl"
[1] (7:27) [*] Opening the file destroy.itl
[1] (7:27) [*] Trying to open the file scripts/destroy.itl
[1] (7:27) --- *(2): *
[1] (7:27) --- *(2): * @OSF_COPYRIGHT@
[1] (7:27) --- *(2): * COPYRIGHT NOTICE
[1] (7:27) --- *(2): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:27) --- *(2): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:27) --- *(2): * src directory for the full copyright text.
[1] (7:27) --- *(2): *
[1] (7:27) --- *(2): * HISTORY
[1] (7:27) --- *(2): * $Log: destroy.itl,v $
[1] (7:27) --- *(2): * Revision 1.1.2.3  1993/01/11  18:27:37  htf
[1] (7:27) --- *(2): * 	Embedded copyright notice
[1] (7:27) --- *(2): * 	[1993/01/11  17:02:28  htf]
[1] (7:27) --- *(2): *
[1] (7:28) --- *(2): * Revision 1.1.2.2  1992/10/28  16:32:42  jaffe
[1] (7:28) --- *(2): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:28) --- *(2): * 	  Selected comments:
[1] (7:28) --- *(2): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:28) --- *(2): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:28) --- *(2): * 	    and adds all of the test scripts.
[1] (7:28) --- *(2): * 	    Run all of the destroy tests.
[1] (7:28) --- *(2): * 	[1992/10/27  18:55:57  jaffe]
[1] (7:28) --- *(2): * 
[1] (7:28) --- *(2): * $EndLog$
[1] (7:28) --- *(2): *
[1] (7:28) --- *(2): 
[1] (7:28) --- *(2): include "destroy00.itl"
[1] (7:28) [*] Opening the file destroy00.itl
[1] (7:28) [*] Trying to open the file scripts/destroy00.itl
[1] (7:28) --- *(3): *
[1] (7:29) --- *(3): * @OSF_COPYRIGHT@
[1] (7:29) --- *(3): * COPYRIGHT NOTICE
[1] (7:29) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:29) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:29) --- *(3): * src directory for the full copyright text.
[1] (7:29) --- *(3): *
[1] (7:29) --- *(3): * HISTORY
[1] (7:29) --- *(3): * $Log: destroy00.itl,v $
[1] (7:29) --- *(3): * Revision 1.1.415.1  1994/02/04  20:41:22  devsrc
[1] (7:29) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (7:29) --- *(3): * 	[1994/02/04  15:22:47  devsrc]
[1] (7:29) --- *(3): *
[1] (7:29) --- *(3): * Revision 1.1.413.1  1993/12/07  17:42:22  jaffe
[1] (7:29) --- *(3): * 	1.0.3a update from Transarc
[1] (7:29) --- *(3): * 	[1993/12/03  18:58:06  jaffe]
[1] (7:29) --- *(3): * 
[1] (7:29) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:38  htf
[1] (7:30) --- *(3): * 	Embedded copyright notice
[1] (7:30) --- *(3): * 	[1993/01/11  17:02:32  htf]
[1] (7:30) --- *(3): * 
[1] (7:30) --- *(3): * Revision 1.1.2.2  1992/10/28  16:32:52  jaffe
[1] (7:30) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (7:30) --- *(3): * 	  Selected comments:
[1] (7:30) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (7:30) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (7:30) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (7:30) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (7:31) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (7:31) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (7:31) --- *(3): * 	    last argument to the command.
[1] (7:31) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (7:31) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (7:31) --- *(3): * 	    variable by the open and opendir comands.
[1] (7:31) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (7:31) --- *(3): * 	    described above.
[1] (7:31) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (7:32) --- *(3): * 	    Cleanup debugging code.
[1] (7:32) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:32) --- *(3): * 	  Selected comments:
[1] (7:32) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:32) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:32) --- *(3): * 	    and adds all of the test scripts.
[1] (7:32) --- *(3): * 	    Destroy test.
[1] (7:32) --- *(3): * 	[1992/10/27  18:57:02  jaffe]
[1] (7:32) --- *(3): * 
[1] (7:32) --- *(3): * $EndLog$
[1] (7:32) --- *(3): *
[1] (7:32) --- *(3): 
[1] (7:32) --- *(3): !**********************************************************
[1] (7:32) --- !**********************************************************
[1] (7:32) --- *(3): !*** Destroy a backing fileset that stores the blocks for
[1] (7:32) --- !*** Destroy a backing fileset that stores the blocks for
[1] (7:32) --- *(3): !*** a file open in the read/write fileset
[1] (7:32) --- !*** a file open in the read/write fileset
[1] (7:33) --- *(3): !**********************************************************
[1] (7:33) --- !**********************************************************
[1] (7:33) --- *(3): 
[1] (7:33) --- *(3): include "setup.itl"
[1] (7:33) [*] Opening the file setup.itl
[1] (7:33) [*] Trying to open the file scripts/setup.itl
[1] (7:33) --- *(4): *
[1] (7:33) --- *(4): * @OSF_COPYRIGHT@
[1] (7:33) --- *(4): * COPYRIGHT NOTICE
[1] (7:33) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:33) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:33) --- *(4): * src directory for the full copyright text.
[1] (7:33) --- *(4): *
[1] (7:33) --- *(4): * HISTORY
[1] (7:33) --- *(4): * $Log: setup.itl,v $
[1] (7:33) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (7:33) --- *(4): * 	Embedded copyright notice
[1] (7:33) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (7:33) --- *(4): *
[1] (7:33) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (7:34) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:34) --- *(4): * 	  Selected comments:
[1] (7:34) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:34) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:34) --- *(4): * 	    and adds all of the test scripts.
[1] (7:34) --- *(4): * 	    Setup for a test case.
[1] (7:34) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (7:34) --- *(4): * 
[1] (7:34) --- *(4): * $EndLog$
[1] (7:34) --- *(4): *
[1] (7:34) --- *(4): 
[1] (7:34) --- *(4): include "defaults.itl"
[1] (7:34) [*] Opening the file defaults.itl
[1] (7:34) [*] Trying to open the file scripts/defaults.itl
[1] (7:34) --- *(5): *
[1] (7:34) --- *(5): * @OSF_COPYRIGHT@
[1] (7:34) --- *(5): * COPYRIGHT NOTICE
[1] (7:34) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:34) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:35) --- *(5): * src directory for the full copyright text.
[1] (7:35) --- *(5): *
[1] (7:35) --- *(5): * HISTORY
[1] (7:35) --- *(5): * $Log: defaults.itl,v $
[1] (7:35) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (7:35) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (7:35) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (7:35) --- *(5): *
[1] (7:35) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (7:35) --- *(5): * 	1.0.3a update from Transarc
[1] (7:35) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (7:35) --- *(5): * 
[1] (7:35) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (7:35) --- *(5): * 	Embedded copyright notice
[1] (7:35) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (7:35) --- *(5): * 
[1] (7:35) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (7:35) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:36) --- *(5): * 	  Selected comments:
[1] (7:36) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:36) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:36) --- *(5): * 	    and adds all of the test scripts.
[1] (7:36) --- *(5): * 	    Set default variables from environment.
[1] (7:36) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (7:36) --- *(5): * 
[1] (7:36) --- *(5): * $EndLog$
[1] (7:36) --- *(5): *
[1] (7:36) --- *(5): 
[1] (7:36) --- *(5): * The following three resources must exist before testing begins
[1] (7:36) --- *(5): getenv FSET_DEVICE
[1] (7:36) --- *(5): if ($FSET_DEVICE == "") {
[1] (7:36) --- *(5): 	set device $FSET_DEVICE
[1] (7:36) --- *(5): }
[1] (7:36) --- *(5): 
[1] (7:36) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (7:37) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (7:37) --- *(5): 	set mount_point[0] "/mnt"
[1] (7:37) --- *(5): } else {
[1] (7:37) --- *(5): 
[1] (7:37) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (7:37) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (7:37) --- *(5): 	set mount_point[1] "/mnt2"
[1] (7:37) --- *(5): } else {
[1] (7:37) --- *(5): 
[1] (7:37) --- *(5): 
[1] (7:37) --- *(5): getenv FSET_AGGR_ID
[1] (7:37) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (7:37) --- *(5): 	set aggr_id 1000
[1] (7:37) --- *(5): } else {
[1] (7:37) --- *(5): 
[1] (7:37) --- *(5): getenv FSET_BLOCK_SIZE
[1] (7:37) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (7:37) --- *(5): 	set block_size 8192
[1] (7:37) --- *(5): } else {
[1] (7:37) --- *(5): 
[1] (7:38) --- *(5): getenv FSET_FRAG_SIZE
[1] (7:38) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (7:38) --- *(5): 	set frag_size 1024
[1] (7:38) --- *(5): } else {
[1] (7:38) --- *(5): 
[1] (7:38) --- *(5): set aggr_name	$device
[1] (7:38) --- *(5): set aggr_type	"lfs"
[1] (7:38) --- *(5): 
[1] (7:38) --- *(5): set fset_id   ($aggr_id + 1)
[1] (7:38) --- *(5): set fset_name ("fset" + $fset_id)
[1] (7:38) --- *(5): 
[1] (7:38) --- *(5): set file_name		"zappa"
[1] (7:38) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (7:38) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (7:38) --- *(5): 
[1] (7:38) --- *(5): set setup_aggr proc END
[1] (7:38) --- *(5): !*** Setup the aggregate
[1] (7:38) --- *(5): 	initAggr @device @block_size @frag_size
[1] (7:38) --- *(5): 	verifyAggr @device
[1] (7:39) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (7:39) --- *(5): END
[1] (7:39) --- *(5): 
[1] (7:39) --- *(5): set setup_fset proc END
[1] (7:39) --- *(5): !*** Create and mount a fileset
[1] (7:39) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (7:39) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (7:39) --- *(5): END
[1] (7:39) --- *(5): 
[1] (7:39) --- *(5): set shutdown_fset proc END
[1] (7:39) --- *(5): !*** Destroy the fileset
[1] (7:39) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (7:39) --- *(5): END
[1] (7:39) --- *(5): 
[1] (7:39) --- *(5): set shutdown_aggr proc END
[1] (7:39) --- *(5): !*** Shutdown the aggregate
[1] (7:39) --- *(5): 	detachAggr @aggr_id
[1] (7:39) --- *(5): 	verifyAggr @device
[1] (7:39) --- *(5): END
[1] (7:39) --- *(5): 
[1] (7:39) --- *(5): quit
[1] (7:39) --- *(4): 
[1] (7:39) --- *(4): exec setup_aggr
[1] (7:39) --- *(4): 
[1] (7:39) --- *(4): !*** Setup the aggregate
[1] (7:39) --- !*** Setup the aggregate
[1] (7:39) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (7:44) --- *(4): 	verifyAggr $device
[1] (7:46) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (7:46) --- *(4): 
[1] (7:46) --- *(4): 
[1] (7:46) --- *(4): quit
[1] (7:46) [*] <== finished processing the string
[1] (7:46) --- *(4): exec setup_fset
[1] (7:46) --- *(4): 
[1] (7:46) --- *(4): !*** Create and mount a fileset
[1] (7:46) --- !*** Create and mount a fileset
[1] (7:46) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (7:46) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (7:47) --- *(4): 
[1] (7:47) --- *(4): 
[1] (7:47) --- *(4): quit
[1] (7:47) [*] <== finished processing the string
[1] (7:47) --- *(4): quit
[1] (7:47) --- *(3): 
[1] (7:47) --- *(3): !*** Create a 1-block file
[1] (7:47) --- !*** Create a 1-block file
[1] (7:47) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (7:47) --- *(3): set data ("1" * $block_size)
[1] (7:47) --- *(3): write $fd1 $data
[1] (7:47) --- *(3): close $fd1
[1] (7:47) --- *(3): 
[1] (7:47) --- *(3): !*** Clone the original fileset
[1] (7:47) --- !*** Clone the original fileset
[1] (7:47) --- *(3): set clone_name ($fset_name + ".clone")
[1] (7:47) --- *(3): set clone_id ($fset_id + 1)
[1] (7:47) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name 
[1] (7:48) --- *(3): 
[1] (7:48) --- *(3): !*** Open file in read/write fileset
[1] (7:48) --- !*** Open file in read/write fileset
[1] (7:48) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (7:48) --- *(3): 
[1] (7:48) --- *(3): !*** Destroy the backing fileset
[1] (7:48) --- !*** Destroy the backing fileset
[1] (7:48) --- *(3): destroyFset $aggr_id $clone_id
[1] (7:48) --- *(3): 
[1] (7:48) --- *(3): !*** Attempt to read the file
[1] (7:48) --- !*** Attempt to read the file
[1] (7:48) --- *(3): read $fd1 $block_size read_data
[1] (7:48) --- *(3): assert ($read_data == $data)
[1] (7:48) --- *(3): 
[1] (7:48) --- *(3): !*** Close the file
[1] (7:48) --- !*** Close the file
[1] (7:48) --- *(3): close $fd1
[1] (7:48) --- *(3): 
[1] (7:48) --- *(3): !*** Unmount filesets
[1] (7:48) --- !*** Unmount filesets
[1] (7:49) --- *(3): unmountFset $mount_point[0]
[1] (7:49) --- *(3): 
[1] (7:49) --- *(3): include "shutdown.itl"
[1] (7:49) [*] Opening the file shutdown.itl
[1] (7:49) [*] Trying to open the file scripts/shutdown.itl
[1] (7:49) --- *(4): *
[1] (7:49) --- *(4): * @OSF_COPYRIGHT@
[1] (7:49) --- *(4): * COPYRIGHT NOTICE
[1] (7:49) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:50) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:50) --- *(4): * src directory for the full copyright text.
[1] (7:50) --- *(4): *
[1] (7:50) --- *(4): * HISTORY
[1] (7:50) --- *(4): * $Log: shutdown.itl,v $
[1] (7:50) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (7:50) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (7:50) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (7:50) --- *(4): *
[1] (7:50) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (7:50) --- *(4): * 	1.0.3a update from Transarc
[1] (7:50) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (7:50) --- *(4): * 
[1] (7:50) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (7:50) --- *(4): * 	Embedded copyright notice
[1] (7:50) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (7:50) --- *(4): * 
[1] (7:50) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (7:51) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:51) --- *(4): * 	  Selected comments:
[1] (7:51) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:51) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:51) --- *(4): * 	    and adds all of the test scripts.
[1] (7:51) --- *(4): * 	    Shutdown a test case.
[1] (7:51) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (7:51) --- *(4): * 
[1] (7:51) --- *(4): * $EndLog$
[1] (7:51) --- *(4): *
[1] (7:51) --- *(4): 
[1] (7:51) --- *(4): exec shutdown_fset
[1] (7:51) --- *(4): 
[1] (7:51) --- *(4): !*** Destroy the fileset
[1] (7:51) --- !*** Destroy the fileset
[1] (7:51) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (7:51) --- *(4): 
[1] (7:51) --- *(4): 
[1] (7:51) --- *(4): quit
[1] (7:51) [*] <== finished processing the string
[1] (7:51) --- *(4): exec shutdown_aggr
[1] (7:51) --- *(4): 
[1] (7:51) --- *(4): !*** Shutdown the aggregate
[1] (7:51) --- !*** Shutdown the aggregate
[1] (7:51) --- *(4): 	detachAggr $aggr_id
[1] (7:51) --- *(4): 	verifyAggr $device
[1] (7:53) --- *(4): 
[1] (7:53) --- *(4): 
[1] (7:53) --- *(4): quit
[1] (7:53) [*] <== finished processing the string
[1] (7:53) --- *(4): quit
[1] (7:53) --- *(3): 
[1] (7:53) --- *(3): 
[1] (7:53) --- *(3): 
[1] (7:53) --- *(3): 
[1] (7:53) --- *(3): quit
[1] (7:53) --- *(2): 
[1] (7:53) --- *(2): include "destroy01.itl"
[1] (7:53) [*] Opening the file destroy01.itl
[1] (7:53) [*] Trying to open the file scripts/destroy01.itl
[1] (7:53) --- *(3): *
[1] (7:53) --- *(3): * @OSF_COPYRIGHT@
[1] (7:53) --- *(3): * COPYRIGHT NOTICE
[1] (7:53) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:53) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:53) --- *(3): * src directory for the full copyright text.
[1] (7:53) --- *(3): *
[1] (7:53) --- *(3): * HISTORY
[1] (7:53) --- *(3): * $Log: destroy01.itl,v $
[1] (7:54) --- *(3): * Revision 1.1.416.1  1994/02/04  20:41:24  devsrc
[1] (7:54) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (7:54) --- *(3): * 	[1994/02/04  15:22:48  devsrc]
[1] (7:54) --- *(3): *
[1] (7:54) --- *(3): * Revision 1.1.414.1  1993/12/07  17:42:24  jaffe
[1] (7:54) --- *(3): * 	1.0.3a update from Transarc
[1] (7:54) --- *(3): * 	[1993/12/03  18:58:21  jaffe]
[1] (7:54) --- *(3): * 
[1] (7:54) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:40  htf
[1] (7:54) --- *(3): * 	Embedded copyright notice
[1] (7:54) --- *(3): * 	[1993/01/11  17:02:36  htf]
[1] (7:54) --- *(3): * 
[1] (7:54) --- *(3): * Revision 1.1.2.2  1992/10/28  16:33:02  jaffe
[1] (7:54) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (7:54) --- *(3): * 	  Selected comments:
[1] (7:54) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (7:55) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (7:55) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (7:55) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (7:55) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (7:55) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (7:55) --- *(3): * 	    last argument to the command.
[1] (7:56) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (7:56) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (7:56) --- *(3): * 	    variable by the open and opendir comands.
[1] (7:56) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (7:56) --- *(3): * 	    described above.
[1] (7:56) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (7:56) --- *(3): * 	    Cleanup debugging code.
[1] (7:56) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:56) --- *(3): * 	  Selected comments:
[1] (7:56) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:57) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:57) --- *(3): * 	    and adds all of the test scripts.
[1] (7:57) --- *(3): * 	    Destroy test.
[1] (7:57) --- *(3): * 	[1992/10/27  18:59:18  jaffe]
[1] (7:57) --- *(3): * 
[1] (7:57) --- *(3): * $EndLog$
[1] (7:57) --- *(3): *
[1] (7:57) --- *(3): 
[1] (7:57) --- *(3): !**********************************************************
[1] (7:57) --- !**********************************************************
[1] (7:57) --- *(3): !*** Destroy a deeper backing fileset that stores the
[1] (7:57) --- !*** Destroy a deeper backing fileset that stores the
[1] (7:57) --- *(3): !*** blocks for a file open in the read/write fileset
[1] (7:57) --- !*** blocks for a file open in the read/write fileset
[1] (7:57) --- *(3): !**********************************************************
[1] (7:57) --- !**********************************************************
[1] (7:57) --- *(3): 
[1] (7:57) --- *(3): include "setup.itl"
[1] (7:57) [*] Opening the file setup.itl
[1] (7:57) [*] Trying to open the file scripts/setup.itl
[1] (7:57) --- *(4): *
[1] (7:57) --- *(4): * @OSF_COPYRIGHT@
[1] (7:57) --- *(4): * COPYRIGHT NOTICE
[1] (7:58) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:58) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:58) --- *(4): * src directory for the full copyright text.
[1] (7:58) --- *(4): *
[1] (7:58) --- *(4): * HISTORY
[1] (7:58) --- *(4): * $Log: setup.itl,v $
[1] (7:58) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (7:58) --- *(4): * 	Embedded copyright notice
[1] (7:58) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (7:58) --- *(4): *
[1] (7:58) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (7:58) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (7:58) --- *(4): * 	  Selected comments:
[1] (7:58) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (7:59) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (7:59) --- *(4): * 	    and adds all of the test scripts.
[1] (7:59) --- *(4): * 	    Setup for a test case.
[1] (7:59) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (7:59) --- *(4): * 
[1] (7:59) --- *(4): * $EndLog$
[1] (7:59) --- *(4): *
[1] (7:59) --- *(4): 
[1] (7:59) --- *(4): include "defaults.itl"
[1] (7:59) [*] Opening the file defaults.itl
[1] (7:59) [*] Trying to open the file scripts/defaults.itl
[1] (7:59) --- *(5): *
[1] (7:59) --- *(5): * @OSF_COPYRIGHT@
[1] (7:59) --- *(5): * COPYRIGHT NOTICE
[1] (7:59) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (7:59) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (7:59) --- *(5): * src directory for the full copyright text.
[1] (7:59) --- *(5): *
[1] (7:59) --- *(5): * HISTORY
[1] (7:59) --- *(5): * $Log: defaults.itl,v $
[1] (7:59) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (8:00) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (8:00) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (8:00) --- *(5): *
[1] (8:00) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (8:00) --- *(5): * 	1.0.3a update from Transarc
[1] (8:00) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (8:00) --- *(5): * 
[1] (8:00) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (8:00) --- *(5): * 	Embedded copyright notice
[1] (8:00) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (8:00) --- *(5): * 
[1] (8:00) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (8:00) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:00) --- *(5): * 	  Selected comments:
[1] (8:00) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:01) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:01) --- *(5): * 	    and adds all of the test scripts.
[1] (8:01) --- *(5): * 	    Set default variables from environment.
[1] (8:01) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (8:01) --- *(5): * 
[1] (8:01) --- *(5): * $EndLog$
[1] (8:01) --- *(5): *
[1] (8:01) --- *(5): 
[1] (8:01) --- *(5): * The following three resources must exist before testing begins
[1] (8:01) --- *(5): getenv FSET_DEVICE
[1] (8:01) --- *(5): if ($FSET_DEVICE == "") {
[1] (8:01) --- *(5): 	set device $FSET_DEVICE
[1] (8:01) --- *(5): }
[1] (8:01) --- *(5): 
[1] (8:01) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (8:01) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (8:01) --- *(5): 	set mount_point[0] "/mnt"
[1] (8:01) --- *(5): } else {
[1] (8:01) --- *(5): 
[1] (8:01) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (8:02) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (8:02) --- *(5): 	set mount_point[1] "/mnt2"
[1] (8:02) --- *(5): } else {
[1] (8:02) --- *(5): 
[1] (8:02) --- *(5): 
[1] (8:02) --- *(5): getenv FSET_AGGR_ID
[1] (8:02) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (8:02) --- *(5): 	set aggr_id 1000
[1] (8:02) --- *(5): } else {
[1] (8:02) --- *(5): 
[1] (8:02) --- *(5): getenv FSET_BLOCK_SIZE
[1] (8:02) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (8:02) --- *(5): 	set block_size 8192
[1] (8:02) --- *(5): } else {
[1] (8:02) --- *(5): 
[1] (8:02) --- *(5): getenv FSET_FRAG_SIZE
[1] (8:02) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (8:02) --- *(5): 	set frag_size 1024
[1] (8:02) --- *(5): } else {
[1] (8:02) --- *(5): 
[1] (8:02) --- *(5): set aggr_name	$device
[1] (8:03) --- *(5): set aggr_type	"lfs"
[1] (8:03) --- *(5): 
[1] (8:03) --- *(5): set fset_id   ($aggr_id + 1)
[1] (8:03) --- *(5): set fset_name ("fset" + $fset_id)
[1] (8:03) --- *(5): 
[1] (8:03) --- *(5): set file_name		"zappa"
[1] (8:03) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (8:03) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (8:03) --- *(5): 
[1] (8:03) --- *(5): set setup_aggr proc END
[1] (8:03) --- *(5): !*** Setup the aggregate
[1] (8:03) --- *(5): 	initAggr @device @block_size @frag_size
[1] (8:03) --- *(5): 	verifyAggr @device
[1] (8:03) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (8:03) --- *(5): END
[1] (8:03) --- *(5): 
[1] (8:03) --- *(5): set setup_fset proc END
[1] (8:03) --- *(5): !*** Create and mount a fileset
[1] (8:03) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (8:04) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (8:04) --- *(5): END
[1] (8:04) --- *(5): 
[1] (8:04) --- *(5): set shutdown_fset proc END
[1] (8:04) --- *(5): !*** Destroy the fileset
[1] (8:04) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (8:04) --- *(5): END
[1] (8:04) --- *(5): 
[1] (8:04) --- *(5): set shutdown_aggr proc END
[1] (8:04) --- *(5): !*** Shutdown the aggregate
[1] (8:04) --- *(5): 	detachAggr @aggr_id
[1] (8:04) --- *(5): 	verifyAggr @device
[1] (8:04) --- *(5): END
[1] (8:04) --- *(5): 
[1] (8:04) --- *(5): quit
[1] (8:04) --- *(4): 
[1] (8:04) --- *(4): exec setup_aggr
[1] (8:04) --- *(4): 
[1] (8:04) --- *(4): !*** Setup the aggregate
[1] (8:04) --- !*** Setup the aggregate
[1] (8:04) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (8:09) --- *(4): 	verifyAggr $device
[1] (8:10) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (8:11) --- *(4): 
[1] (8:11) --- *(4): 
[1] (8:11) --- *(4): quit
[1] (8:11) [*] <== finished processing the string
[1] (8:11) --- *(4): exec setup_fset
[1] (8:11) --- *(4): 
[1] (8:11) --- *(4): !*** Create and mount a fileset
[1] (8:11) --- !*** Create and mount a fileset
[1] (8:11) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (8:11) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (8:11) --- *(4): 
[1] (8:11) --- *(4): 
[1] (8:11) --- *(4): quit
[1] (8:11) [*] <== finished processing the string
[1] (8:11) --- *(4): quit
[1] (8:11) --- *(3): 
[1] (8:11) --- *(3): !*** Create a 1-block file
[1] (8:11) --- !*** Create a 1-block file
[1] (8:12) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (8:12) --- *(3): set data ("1" * $block_size)
[1] (8:12) --- *(3): write $fd1 $data
[1] (8:12) --- *(3): close $fd1
[1] (8:12) --- *(3): 
[1] (8:12) --- *(3): !*** Clone the original fileset
[1] (8:12) --- !*** Clone the original fileset
[1] (8:12) --- *(3): set clone_name ($fset_name + ".clone")
[1] (8:12) --- *(3): set clone_id ($fset_id + 1)
[1] (8:12) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (8:12) --- *(3): 
[1] (8:12) --- *(3): !*** Clone it again
[1] (8:12) --- !*** Clone it again
[1] (8:12) --- *(3): set clone_name ($fset_name + ".clone2")
[1] (8:12) --- *(3): set clone_id ($fset_id + 2)
[1] (8:13) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (8:13) --- *(3): 
[1] (8:13) --- *(3): !*** Open file in read/write fileset
[1] (8:13) --- !*** Open file in read/write fileset
[1] (8:13) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (8:13) --- *(3): 
[1] (8:13) --- *(3): !*** Destroy the backing fileset
[1] (8:13) --- !*** Destroy the backing fileset
[1] (8:13) --- *(3): destroyFset $aggr_id $clone_id
[1] (8:13) --- *(3): 
[1] (8:13) --- *(3): !*** Attempt to read the file
[1] (8:13) --- !*** Attempt to read the file
[1] (8:13) --- *(3): read $fd1 $block_size read_data
[1] (8:13) --- *(3): assert ($read_data == $data)
[1] (8:13) --- *(3): 
[1] (8:13) --- *(3): !*** Close the file
[1] (8:13) --- !*** Close the file
[1] (8:13) --- *(3): close $fd1
[1] (8:13) --- *(3): 
[1] (8:14) --- *(3): !*** Unmount the fileset
[1] (8:14) --- !*** Unmount the fileset
[1] (8:14) --- *(3): unmountFset $mount_point[0]
[1] (8:14) --- *(3): 
[1] (8:14) --- *(3): include "shutdown.itl"
[1] (8:14) [*] Opening the file shutdown.itl
[1] (8:14) [*] Trying to open the file scripts/shutdown.itl
[1] (8:14) --- *(4): *
[1] (8:14) --- *(4): * @OSF_COPYRIGHT@
[1] (8:14) --- *(4): * COPYRIGHT NOTICE
[1] (8:14) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:15) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (8:15) --- *(4): * src directory for the full copyright text.
[1] (8:15) --- *(4): *
[1] (8:15) --- *(4): * HISTORY
[1] (8:15) --- *(4): * $Log: shutdown.itl,v $
[1] (8:15) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (8:15) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (8:15) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (8:15) --- *(4): *
[1] (8:15) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (8:15) --- *(4): * 	1.0.3a update from Transarc
[1] (8:15) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (8:15) --- *(4): * 
[1] (8:15) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (8:15) --- *(4): * 	Embedded copyright notice
[1] (8:15) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (8:15) --- *(4): * 
[1] (8:16) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (8:16) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:16) --- *(4): * 	  Selected comments:
[1] (8:16) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:16) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:16) --- *(4): * 	    and adds all of the test scripts.
[1] (8:16) --- *(4): * 	    Shutdown a test case.
[1] (8:16) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (8:16) --- *(4): * 
[1] (8:16) --- *(4): * $EndLog$
[1] (8:16) --- *(4): *
[1] (8:16) --- *(4): 
[1] (8:16) --- *(4): exec shutdown_fset
[1] (8:16) --- *(4): 
[1] (8:16) --- *(4): !*** Destroy the fileset
[1] (8:16) --- !*** Destroy the fileset
[1] (8:16) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (8:17) --- *(4): 
[1] (8:17) --- *(4): 
[1] (8:17) --- *(4): quit
[1] (8:17) [*] <== finished processing the string
[1] (8:17) --- *(4): exec shutdown_aggr
[1] (8:17) --- *(4): 
[1] (8:17) --- *(4): !*** Shutdown the aggregate
[1] (8:17) --- !*** Shutdown the aggregate
[1] (8:17) --- *(4): 	detachAggr $aggr_id
[1] (8:17) --- *(4): 	verifyAggr $device
[1] (8:18) --- *(4): 
[1] (8:18) --- *(4): 
[1] (8:18) --- *(4): quit
[1] (8:18) [*] <== finished processing the string
[1] (8:18) --- *(4): quit
[1] (8:18) --- *(3): 
[1] (8:18) --- *(3): quit
[1] (8:18) --- *(2): 
[1] (8:18) --- *(2): include "destroy02.itl"
[1] (8:18) [*] Opening the file destroy02.itl
[1] (8:18) [*] Trying to open the file scripts/destroy02.itl
[1] (8:18) --- *(3): *
[1] (8:19) --- *(3): * @OSF_COPYRIGHT@
[1] (8:19) --- *(3): * COPYRIGHT NOTICE
[1] (8:19) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:19) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (8:19) --- *(3): * src directory for the full copyright text.
[1] (8:19) --- *(3): *
[1] (8:19) --- *(3): * HISTORY
[1] (8:19) --- *(3): * $Log: destroy02.itl,v $
[1] (8:19) --- *(3): * Revision 1.1.417.1  1994/02/04  20:41:26  devsrc
[1] (8:19) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (8:19) --- *(3): * 	[1994/02/04  15:22:49  devsrc]
[1] (8:19) --- *(3): *
[1] (8:19) --- *(3): * Revision 1.1.415.1  1993/12/07  17:42:26  jaffe
[1] (8:19) --- *(3): * 	1.0.3a update from Transarc
[1] (8:19) --- *(3): * 	[1993/12/03  18:58:34  jaffe]
[1] (8:19) --- *(3): * 
[1] (8:20) --- *(3): * Revision 1.1.2.3  1993/01/11  18:27:41  htf
[1] (8:20) --- *(3): * 	Embedded copyright notice
[1] (8:20) --- *(3): * 	[1993/01/11  17:02:40  htf]
[1] (8:20) --- *(3): * 
[1] (8:20) --- *(3): * Revision 1.1.2.2  1992/10/28  16:33:09  jaffe
[1] (8:20) --- *(3): * 	Transarc delta: fred-itl-make-open-like-c 1.3
[1] (8:20) --- *(3): * 	  Selected comments:
[1] (8:20) --- *(3): * 	    Fix ITL system calls to have more C like syntax.  Previously only a
[1] (8:20) --- *(3): * 	    single open or opendir could be issued against a file resource, since the
[1] (8:20) --- *(3): * 	    filename/directory name being opened was hashed.  Now the names are no longer
[1] (8:20) --- *(3): * 	    hashed and the resulting file descriptor (or DIR *) is placed in a
[1] (8:21) --- *(3): * 	    user supplied variable.  This changes the syntax of the open, creat,
[1] (8:21) --- *(3): * 	    opendir and mmap commands.  They now all require a variable name as the
[1] (8:21) --- *(3): * 	    last argument to the command.
[1] (8:21) --- *(3): * 	    Also a number of commands that previously took a filename or directory
[1] (8:21) --- *(3): * 	    name, now take the actual file descriptor or DIR *, as was placed in a
[1] (8:21) --- *(3): * 	    variable by the open and opendir comands.
[1] (8:21) --- *(3): * 	    Make the necessary changes to the fset ("ftutil") tests to match the
[1] (8:21) --- *(3): * 	    described above.
[1] (8:21) --- *(3): * 	    Convert system calls to use the more traditional usage.
[1] (8:22) --- *(3): * 	    Cleanup debugging code.
[1] (8:22) --- *(3): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:22) --- *(3): * 	  Selected comments:
[1] (8:22) --- *(3): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:22) --- *(3): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:22) --- *(3): * 	    and adds all of the test scripts.
[1] (8:22) --- *(3): * 	    Destroy test.
[1] (8:22) --- *(3): * 	[1992/10/27  19:01:12  jaffe]
[1] (8:22) --- *(3): * 
[1] (8:22) --- *(3): * $EndLog$
[1] (8:22) --- *(3): *
[1] (8:22) --- *(3): 
[1] (8:22) --- *(3): !**********************************************************
[1] (8:22) --- !**********************************************************
[1] (8:22) --- *(3): !*** Destroy a backing fileset that stores the blocks for
[1] (8:22) --- !*** Destroy a backing fileset that stores the blocks for
[1] (8:22) --- *(3): !*** a ZLC file open in the read/write fileset
[1] (8:22) --- !*** a ZLC file open in the read/write fileset
[1] (8:23) --- *(3): !**********************************************************
[1] (8:23) --- !**********************************************************
[1] (8:23) --- *(3): 
[1] (8:23) --- *(3): include "setup.itl"
[1] (8:23) [*] Opening the file setup.itl
[1] (8:23) [*] Trying to open the file scripts/setup.itl
[1] (8:23) --- *(4): *
[1] (8:23) --- *(4): * @OSF_COPYRIGHT@
[1] (8:23) --- *(4): * COPYRIGHT NOTICE
[1] (8:23) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:23) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (8:23) --- *(4): * src directory for the full copyright text.
[1] (8:23) --- *(4): *
[1] (8:23) --- *(4): * HISTORY
[1] (8:23) --- *(4): * $Log: setup.itl,v $
[1] (8:23) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:03  htf
[1] (8:23) --- *(4): * 	Embedded copyright notice
[1] (8:23) --- *(4): * 	[1993/01/11  17:03:43  htf]
[1] (8:23) --- *(4): *
[1] (8:23) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:27  jaffe
[1] (8:24) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:24) --- *(4): * 	  Selected comments:
[1] (8:24) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:24) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:24) --- *(4): * 	    and adds all of the test scripts.
[1] (8:24) --- *(4): * 	    Setup for a test case.
[1] (8:24) --- *(4): * 	[1992/10/27  19:18:23  jaffe]
[1] (8:24) --- *(4): * 
[1] (8:24) --- *(4): * $EndLog$
[1] (8:24) --- *(4): *
[1] (8:24) --- *(4): 
[1] (8:24) --- *(4): include "defaults.itl"
[1] (8:24) [*] Opening the file defaults.itl
[1] (8:24) [*] Trying to open the file scripts/defaults.itl
[1] (8:24) --- *(5): *
[1] (8:24) --- *(5): * @OSF_COPYRIGHT@
[1] (8:24) --- *(5): * COPYRIGHT NOTICE
[1] (8:24) --- *(5): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:25) --- *(5): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (8:25) --- *(5): * src directory for the full copyright text.
[1] (8:25) --- *(5): *
[1] (8:25) --- *(5): * HISTORY
[1] (8:25) --- *(5): * $Log: defaults.itl,v $
[1] (8:25) --- *(5): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (8:25) --- *(5): * 	Merged from 1.0.3a to 1.1
[1] (8:25) --- *(5): * 	[1994/02/04  15:22:47  devsrc]
[1] (8:25) --- *(5): *
[1] (8:25) --- *(5): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (8:25) --- *(5): * 	1.0.3a update from Transarc
[1] (8:25) --- *(5): * 	[1993/12/03  18:57:43  jaffe]
[1] (8:25) --- *(5): * 
[1] (8:25) --- *(5): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (8:25) --- *(5): * 	Embedded copyright notice
[1] (8:25) --- *(5): * 	[1993/01/11  17:02:21  htf]
[1] (8:25) --- *(5): * 
[1] (8:25) --- *(5): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (8:26) --- *(5): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:26) --- *(5): * 	  Selected comments:
[1] (8:26) --- *(5): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:26) --- *(5): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:26) --- *(5): * 	    and adds all of the test scripts.
[1] (8:26) --- *(5): * 	    Set default variables from environment.
[1] (8:26) --- *(5): * 	[1992/10/27  18:53:31  jaffe]
[1] (8:26) --- *(5): * 
[1] (8:26) --- *(5): * $EndLog$
[1] (8:26) --- *(5): *
[1] (8:26) --- *(5): 
[1] (8:26) --- *(5): * The following three resources must exist before testing begins
[1] (8:26) --- *(5): getenv FSET_DEVICE
[1] (8:26) --- *(5): if ($FSET_DEVICE == "") {
[1] (8:26) --- *(5): 	set device $FSET_DEVICE
[1] (8:26) --- *(5): }
[1] (8:26) --- *(5): 
[1] (8:27) --- *(5): getenv FSET_MOUNT_POINT_0
[1] (8:27) --- *(5): if ($FSET_MOUNT_POINT_0 == "") {
[1] (8:27) --- *(5): 	set mount_point[0] "/mnt"
[1] (8:27) --- *(5): } else {
[1] (8:27) --- *(5): 
[1] (8:27) --- *(5): getenv FSET_MOUNT_POINT_1
[1] (8:27) --- *(5): if ($FSET_MOUNT_POINT_1 == "") {
[1] (8:27) --- *(5): 	set mount_point[1] "/mnt2"
[1] (8:27) --- *(5): } else {
[1] (8:27) --- *(5): 
[1] (8:27) --- *(5): 
[1] (8:27) --- *(5): getenv FSET_AGGR_ID
[1] (8:27) --- *(5): if ($FSET_AGGR_ID == "") {
[1] (8:27) --- *(5): 	set aggr_id 1000
[1] (8:27) --- *(5): } else {
[1] (8:27) --- *(5): 
[1] (8:27) --- *(5): getenv FSET_BLOCK_SIZE
[1] (8:27) --- *(5): if ($FSET_BLOCK_SIZE == "") {
[1] (8:27) --- *(5): 	set block_size 8192
[1] (8:27) --- *(5): } else {
[1] (8:27) --- *(5): 
[1] (8:28) --- *(5): getenv FSET_FRAG_SIZE
[1] (8:28) --- *(5): if ($FSET_FRAG_SIZE == "") {
[1] (8:28) --- *(5): 	set frag_size 1024
[1] (8:28) --- *(5): } else {
[1] (8:28) --- *(5): 
[1] (8:28) --- *(5): set aggr_name	$device
[1] (8:28) --- *(5): set aggr_type	"lfs"
[1] (8:28) --- *(5): 
[1] (8:28) --- *(5): set fset_id   ($aggr_id + 1)
[1] (8:28) --- *(5): set fset_name ("fset" + $fset_id)
[1] (8:28) --- *(5): 
[1] (8:28) --- *(5): set file_name		"zappa"
[1] (8:28) --- *(5): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (8:28) --- *(5): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (8:28) --- *(5): 
[1] (8:28) --- *(5): set setup_aggr proc END
[1] (8:28) --- *(5): !*** Setup the aggregate
[1] (8:28) --- *(5): 	initAggr @device @block_size @frag_size
[1] (8:28) --- *(5): 	verifyAggr @device
[1] (8:29) --- *(5): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (8:29) --- *(5): END
[1] (8:29) --- *(5): 
[1] (8:29) --- *(5): set setup_fset proc END
[1] (8:29) --- *(5): !*** Create and mount a fileset
[1] (8:29) --- *(5): 	createFset @aggr_id @fset_id @fset_name
[1] (8:29) --- *(5): 	mountFset @fset_id @mount_point[0]
[1] (8:29) --- *(5): END
[1] (8:29) --- *(5): 
[1] (8:29) --- *(5): set shutdown_fset proc END
[1] (8:29) --- *(5): !*** Destroy the fileset
[1] (8:29) --- *(5): 	destroyFset @aggr_id @fset_id
[1] (8:29) --- *(5): END
[1] (8:29) --- *(5): 
[1] (8:29) --- *(5): set shutdown_aggr proc END
[1] (8:29) --- *(5): !*** Shutdown the aggregate
[1] (8:29) --- *(5): 	detachAggr @aggr_id
[1] (8:29) --- *(5): 	verifyAggr @device
[1] (8:29) --- *(5): END
[1] (8:29) --- *(5): 
[1] (8:29) --- *(5): quit
[1] (8:29) --- *(4): 
[1] (8:29) --- *(4): exec setup_aggr
[1] (8:29) --- *(4): 
[1] (8:29) --- *(4): !*** Setup the aggregate
[1] (8:29) --- !*** Setup the aggregate
[1] (8:29) --- *(4): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (8:34) --- *(4): 	verifyAggr $device
[1] (8:36) --- *(4): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (8:36) --- *(4): 
[1] (8:36) --- *(4): 
[1] (8:36) --- *(4): quit
[1] (8:36) [*] <== finished processing the string
[1] (8:36) --- *(4): exec setup_fset
[1] (8:36) --- *(4): 
[1] (8:36) --- *(4): !*** Create and mount a fileset
[1] (8:36) --- !*** Create and mount a fileset
[1] (8:36) --- *(4): 	createFset $aggr_id $fset_id $fset_name
[1] (8:36) --- *(4): 	mountFset $fset_id $mount_point[0]
[1] (8:37) --- *(4): 
[1] (8:37) --- *(4): 
[1] (8:37) --- *(4): quit
[1] (8:37) [*] <== finished processing the string
[1] (8:37) --- *(4): quit
[1] (8:37) --- *(3): 
[1] (8:37) --- *(3): !*** Create a 1-block file
[1] (8:37) --- !*** Create a 1-block file
[1] (8:37) --- *(3): open $path_name[0] ($O_CREAT|$O_RDWR) 0666 fd1
[1] (8:37) --- *(3): set data ("1" * $block_size)
[1] (8:37) --- *(3): write $fd1 $data
[1] (8:37) --- *(3): close $fd1
[1] (8:37) --- *(3): 
[1] (8:37) --- *(3): !*** Clone the original fileset
[1] (8:37) --- !*** Clone the original fileset
[1] (8:37) --- *(3): set clone_name ($fset_name + ".clone")
[1] (8:37) --- *(3): set clone_id ($fset_id + 1)
[1] (8:37) --- *(3): cloneFset $aggr_id $fset_id $clone_id $clone_name
[1] (8:37) --- *(3): 
[1] (8:37) --- *(3): !*** Open file in read/write fileset
[1] (8:37) --- !*** Open file in read/write fileset
[1] (8:38) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (8:38) --- *(3): 
[1] (8:38) --- *(3): !*** Remove the file
[1] (8:38) --- !*** Remove the file
[1] (8:38) --- *(3): unlink $path_name[0]
[1] (8:38) --- *(3): 
[1] (8:38) --- *(3): !*** Destroy the backing fileset
[1] (8:38) --- !*** Destroy the backing fileset
[1] (8:38) --- *(3): destroyFset $aggr_id $clone_id
[1] (8:38) --- *(3): 
[1] (8:38) --- *(3): !*** Attempt to read the file
[1] (8:38) --- !*** Attempt to read the file
[1] (8:38) --- *(3): read $fd1 $block_size read_data
[1] (8:38) --- *(3): assert ($read_data == $data)
[1] (8:38) --- *(3): 
[1] (8:38) --- *(3): !*** Close the file
[1] (8:38) --- !*** Close the file
[1] (8:38) --- *(3): close $fd1
[1] (8:38) --- *(3): 
[1] (8:38) --- *(3): !*** Unmount the fileset
[1] (8:38) --- !*** Unmount the fileset
[1] (8:38) --- *(3): unmountFset $mount_point[0]
[1] (8:39) --- *(3): 
[1] (8:39) --- *(3): !*** Detach and verify the aggregate
[1] (8:39) --- !*** Detach and verify the aggregate
[1] (8:39) --- *(3): detachAggr $aggr_id
[1] (8:39) --- *(3): verifyAggr $device
[1] (8:41) --- *(3): 
[1] (8:41) --- *(3): !*** Reattach the aggregate
[1] (8:41) --- !*** Reattach the aggregate
[1] (8:41) --- *(3): attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (8:41) --- *(3): 
[1] (8:41) --- *(3): !*** Mount the fileset
[1] (8:41) --- !*** Mount the fileset
[1] (8:41) --- *(3): mountFset $fset_id $mount_point[0]
[1] (8:42) --- *(3): 
[1] (8:42) --- *(3): !*** Verify that the file is gone
[1] (8:42) --- !*** Verify that the file is gone
[1] (8:42) --- *(3): verifyStatus false
[1] (8:42) [*] Using false  for Verify Status.
[1] (8:42) --- Status verification is OFF
[1] (8:42) --- *(3): open $path_name[0] $O_RDONLY 0 fd1
[1] (8:42) --- *(3): assert ($ITL_Status == $ENOENT)
[1] (8:42) --- *(3): verifyStatus true
[1] (8:42) [*] Using true  for Verify Status.
[1] (8:42) --- Status verification is ON
[1] (8:42) --- *(3): 
[1] (8:42) --- *(3): !*** Ensure that the fileset can't be deleted while mounted
[1] (8:42) --- !*** Ensure that the fileset can't be deleted while mounted
[1] (8:42) --- *(3): verifyStatus false
[1] (8:42) [*] Using false  for Verify Status.
[1] (8:42) --- Status verification is OFF
[1] (8:42) --- *(3): destroyFset $aggr_id $fset_id
[1] (8:42) --- *(3): assert ($ITL_Status == $FTU_E_LOCAL_MOUNT)
[1] (8:42) --- *(3): verifyStatus true
[1] (8:42) [*] Using true  for Verify Status.
[1] (8:43) --- Status verification is ON
[1] (8:43) --- *(3): 
[1] (8:43) --- *(3): !*** Unmount the fileset
[1] (8:43) --- !*** Unmount the fileset
[1] (8:43) --- *(3): unmountFset $mount_point[0]
[1] (8:43) --- *(3): 
[1] (8:43) --- *(3): include "shutdown.itl"
[1] (8:43) [*] Opening the file shutdown.itl
[1] (8:43) [*] Trying to open the file scripts/shutdown.itl
[1] (8:43) --- *(4): *
[1] (8:43) --- *(4): * @OSF_COPYRIGHT@
[1] (8:43) --- *(4): * COPYRIGHT NOTICE
[1] (8:43) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:44) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (8:44) --- *(4): * src directory for the full copyright text.
[1] (8:44) --- *(4): *
[1] (8:44) --- *(4): * HISTORY
[1] (8:44) --- *(4): * $Log: shutdown.itl,v $
[1] (8:44) --- *(4): * Revision 1.1.431.1  1994/02/04  20:42:10  devsrc
[1] (8:44) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (8:44) --- *(4): * 	[1994/02/04  15:23:08  devsrc]
[1] (8:44) --- *(4): *
[1] (8:44) --- *(4): * Revision 1.1.429.1  1993/12/07  17:42:46  jaffe
[1] (8:44) --- *(4): * 	1.0.3a update from Transarc
[1] (8:44) --- *(4): * 	[1993/12/03  19:01:59  jaffe]
[1] (8:44) --- *(4): * 
[1] (8:44) --- *(4): * Revision 1.1.2.3  1993/01/11  18:28:05  htf
[1] (8:44) --- *(4): * 	Embedded copyright notice
[1] (8:44) --- *(4): * 	[1993/01/11  17:03:48  htf]
[1] (8:44) --- *(4): * 
[1] (8:45) --- *(4): * Revision 1.1.2.2  1992/10/28  17:20:38  jaffe
[1] (8:45) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:45) --- *(4): * 	  Selected comments:
[1] (8:45) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:45) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:45) --- *(4): * 	    and adds all of the test scripts.
[1] (8:45) --- *(4): * 	    Shutdown a test case.
[1] (8:45) --- *(4): * 	[1992/10/27  19:19:20  jaffe]
[1] (8:45) --- *(4): * 
[1] (8:45) --- *(4): * $EndLog$
[1] (8:45) --- *(4): *
[1] (8:45) --- *(4): 
[1] (8:45) --- *(4): exec shutdown_fset
[1] (8:45) --- *(4): 
[1] (8:45) --- *(4): !*** Destroy the fileset
[1] (8:45) --- !*** Destroy the fileset
[1] (8:45) --- *(4): 	destroyFset $aggr_id $fset_id
[1] (8:45) --- *(4): 
[1] (8:45) --- *(4): 
[1] (8:45) --- *(4): quit
[1] (8:45) [*] <== finished processing the string
[1] (8:45) --- *(4): exec shutdown_aggr
[1] (8:45) --- *(4): 
[1] (8:45) --- *(4): !*** Shutdown the aggregate
[1] (8:45) --- !*** Shutdown the aggregate
[1] (8:45) --- *(4): 	detachAggr $aggr_id
[1] (8:46) --- *(4): 	verifyAggr $device
[1] (8:47) --- *(4): 
[1] (8:47) --- *(4): 
[1] (8:47) --- *(4): quit
[1] (8:47) [*] <== finished processing the string
[1] (8:47) --- *(4): quit
[1] (8:47) --- *(3): quit
[1] (8:47) --- *(2): quit
[1] (8:47) --- *(1): 
[1] (8:47) --- *(1): include "lock.itl"
[1] (8:47) [*] Opening the file lock.itl
[1] (8:47) [*] Trying to open the file scripts/lock.itl
[1] (8:47) --- *(2): *
[1] (8:47) --- *(2): * @OSF_COPYRIGHT@
[1] (8:47) --- *(2): * COPYRIGHT NOTICE
[1] (8:47) --- *(2): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:47) --- *(2): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE for
[1] (8:48) --- *(2): * the full copyright text.
[1] (8:48) --- *(2): *
[1] (8:48) --- *(2): * HISTORY
[1] (8:48) --- *(2): * $Log: lock.itl,v $
[1] (8:48) --- *(2): * Revision 1.1.6.1  1994/02/04  20:41:33  devsrc
[1] (8:48) --- *(2): * 	Merged from 1.0.3a to 1.1
[1] (8:48) --- *(2): * 	[1994/02/04  15:22:52  devsrc]
[1] (8:48) --- *(2): *
[1] (8:48) --- *(2): * Revision 1.1.4.1  1994/01/28  20:44:02  annie
[1] (8:48) --- *(2): * 	expand OSF copyright
[1] (8:48) --- *(2): * 	[1994/01/28  20:42:31  annie]
[1] (8:48) --- *(2): * 
[1] (8:48) --- *(2): * Revision 1.1.2.2  1993/02/16  16:26:38  jaffe
[1] (8:48) --- *(2): * 	Transarc delta: jdp-db3072-aggregate-interlocking 1.2
[1] (8:48) --- *(2): * 	  Selected comments:
[1] (8:48) --- *(2): * 	    This delta implements an interlocking feature that keeps
[1] (8:48) --- *(2): * 	    administrative commands like salvage and newaggr from stomping on an
[1] (8:49) --- *(2): * 	    attached (or mounted) fileset.  Two new primitives,
[1] (8:49) --- *(2): * 	    ftu_LockAggrDevice() and ftu_UnlockAggrDevice(), are provided by the
[1] (8:49) --- *(2): * 	    ftutil library and are used in both newaggr and salvage.
[1] (8:49) --- *(2): * 	    Two new test cases were added to the fset (ftutil) tests suite.  The first,
[1] (8:49) --- *(2): * 	    lock00.itl, tests the primitives directly. The second, lock01.itl, tests
[1] (8:49) --- *(2): * 	    interaction with newaggr and salvage for both attached aggregates and
[1] (8:49) --- *(2): * 	    mounted filesets.
[1] (8:49) --- *(2): * 	    This script runs the locking tests.
[1] (8:49) --- *(2): * 	    Fix things up for OSF/1.
[1] (8:50) --- *(2): * 	[1993/02/15  19:25:32  jaffe]
[1] (8:50) --- *(2): * 
[1] (8:50) --- *(2): * $EndLog$
[1] (8:50) --- *(2): *
[1] (8:50) --- *(2): 
[1] (8:50) --- *(2): include "lock00.itl"
[1] (8:50) [*] Opening the file lock00.itl
[1] (8:50) [*] Trying to open the file scripts/lock00.itl
[1] (8:50) --- *(3): *
[1] (8:50) --- *(3): * @OSF_COPYRIGHT@
[1] (8:50) --- *(3): * COPYRIGHT NOTICE
[1] (8:50) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:50) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE for
[1] (8:50) --- *(3): * the full copyright text.
[1] (8:50) --- *(3): *
[1] (8:50) --- *(3): * HISTORY
[1] (8:50) --- *(3): * $Log: lock00.itl,v $
[1] (8:50) --- *(3): * Revision 1.1.6.1  1994/02/04  20:41:35  devsrc
[1] (8:50) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (8:50) --- *(3): * 	[1994/02/04  15:22:53  devsrc]
[1] (8:50) --- *(3): *
[1] (8:51) --- *(3): * Revision 1.1.4.1  1994/01/28  20:44:03  annie
[1] (8:51) --- *(3): * 	expand OSF copyright
[1] (8:51) --- *(3): * 	[1994/01/28  20:42:32  annie]
[1] (8:51) --- *(3): * 
[1] (8:51) --- *(3): * Revision 1.1.2.2  1993/02/16  16:26:42  jaffe
[1] (8:51) --- *(3): * 	Transarc delta: jdp-db3072-aggregate-interlocking 1.2
[1] (8:51) --- *(3): * 	  Selected comments:
[1] (8:51) --- *(3): * 	    This delta implements an interlocking feature that keeps
[1] (8:51) --- *(3): * 	    administrative commands like salvage and newaggr from stomping on an
[1] (8:51) --- *(3): * 	    attached (or mounted) fileset.  Two new primitives,
[1] (8:51) --- *(3): * 	    ftu_LockAggrDevice() and ftu_UnlockAggrDevice(), are provided by the
[1] (8:52) --- *(3): * 	    ftutil library and are used in both newaggr and salvage.
[1] (8:52) --- *(3): * 	    Two new test cases were added to the fset (ftutil) tests suite.  The first,
[1] (8:52) --- *(3): * 	    lock00.itl, tests the primitives directly. The second, lock01.itl, tests
[1] (8:52) --- *(3): * 	    interaction with newaggr and salvage for both attached aggregates and
[1] (8:52) --- *(3): * 	    mounted filesets.
[1] (8:52) --- *(3): * 	    This script tests the ftutil locking primitives.
[1] (8:52) --- *(3): * 	    Fix things up for OSF/1.
[1] (8:52) --- *(3): * 	[1993/02/15  19:26:01  jaffe]
[1] (8:52) --- *(3): * 
[1] (8:52) --- *(3): * $EndLog$
[1] (8:52) --- *(3): *
[1] (8:52) --- *(3): 
[1] (8:52) --- *(3): !**********************************************************
[1] (8:52) --- !**********************************************************
[1] (8:52) --- *(3): !*** Test basic locking routines
[1] (8:52) --- !*** Test basic locking routines
[1] (8:53) --- *(3): !**********************************************************
[1] (8:53) --- !**********************************************************
[1] (8:53) --- *(3): 
[1] (8:53) --- *(3): include "defaults.itl"
[1] (8:53) [*] Opening the file defaults.itl
[1] (8:53) [*] Trying to open the file scripts/defaults.itl
[1] (8:53) --- *(4): *
[1] (8:53) --- *(4): * @OSF_COPYRIGHT@
[1] (8:53) --- *(4): * COPYRIGHT NOTICE
[1] (8:53) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (8:53) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (8:53) --- *(4): * src directory for the full copyright text.
[1] (8:53) --- *(4): *
[1] (8:53) --- *(4): * HISTORY
[1] (8:53) --- *(4): * $Log: defaults.itl,v $
[1] (8:53) --- *(4): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (8:53) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (8:53) --- *(4): * 	[1994/02/04  15:22:47  devsrc]
[1] (8:53) --- *(4): *
[1] (8:53) --- *(4): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (8:54) --- *(4): * 	1.0.3a update from Transarc
[1] (8:54) --- *(4): * 	[1993/12/03  18:57:43  jaffe]
[1] (8:54) --- *(4): * 
[1] (8:54) --- *(4): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (8:54) --- *(4): * 	Embedded copyright notice
[1] (8:54) --- *(4): * 	[1993/01/11  17:02:21  htf]
[1] (8:54) --- *(4): * 
[1] (8:54) --- *(4): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (8:54) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (8:54) --- *(4): * 	  Selected comments:
[1] (8:54) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (8:54) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (8:54) --- *(4): * 	    and adds all of the test scripts.
[1] (8:54) --- *(4): * 	    Set default variables from environment.
[1] (8:55) --- *(4): * 	[1992/10/27  18:53:31  jaffe]
[1] (8:55) --- *(4): * 
[1] (8:55) --- *(4): * $EndLog$
[1] (8:55) --- *(4): *
[1] (8:55) --- *(4): 
[1] (8:55) --- *(4): * The following three resources must exist before testing begins
[1] (8:55) --- *(4): getenv FSET_DEVICE
[1] (8:55) --- *(4): if ($FSET_DEVICE == "") {
[1] (8:55) --- *(4): 	set device $FSET_DEVICE
[1] (8:55) --- *(4): }
[1] (8:55) --- *(4): 
[1] (8:55) --- *(4): getenv FSET_MOUNT_POINT_0
[1] (8:55) --- *(4): if ($FSET_MOUNT_POINT_0 == "") {
[1] (8:55) --- *(4): 	set mount_point[0] "/mnt"
[1] (8:55) --- *(4): } else {
[1] (8:55) --- *(4): 
[1] (8:55) --- *(4): getenv FSET_MOUNT_POINT_1
[1] (8:55) --- *(4): if ($FSET_MOUNT_POINT_1 == "") {
[1] (8:55) --- *(4): 	set mount_point[1] "/mnt2"
[1] (8:56) --- *(4): } else {
[1] (8:56) --- *(4): 
[1] (8:56) --- *(4): 
[1] (8:56) --- *(4): getenv FSET_AGGR_ID
[1] (8:56) --- *(4): if ($FSET_AGGR_ID == "") {
[1] (8:56) --- *(4): 	set aggr_id 1000
[1] (8:56) --- *(4): } else {
[1] (8:56) --- *(4): 
[1] (8:56) --- *(4): getenv FSET_BLOCK_SIZE
[1] (8:56) --- *(4): if ($FSET_BLOCK_SIZE == "") {
[1] (8:56) --- *(4): 	set block_size 8192
[1] (8:56) --- *(4): } else {
[1] (8:56) --- *(4): 
[1] (8:56) --- *(4): getenv FSET_FRAG_SIZE
[1] (8:56) --- *(4): if ($FSET_FRAG_SIZE == "") {
[1] (8:56) --- *(4): 	set frag_size 1024
[1] (8:56) --- *(4): } else {
[1] (8:56) --- *(4): 
[1] (8:56) --- *(4): set aggr_name	$device
[1] (8:56) --- *(4): set aggr_type	"lfs"
[1] (8:56) --- *(4): 
[1] (8:56) --- *(4): set fset_id   ($aggr_id + 1)
[1] (8:57) --- *(4): set fset_name ("fset" + $fset_id)
[1] (8:57) --- *(4): 
[1] (8:57) --- *(4): set file_name		"zappa"
[1] (8:57) --- *(4): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (8:57) --- *(4): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (8:57) --- *(4): 
[1] (8:57) --- *(4): set setup_aggr proc END
[1] (8:57) --- *(4): !*** Setup the aggregate
[1] (8:57) --- *(4): 	initAggr @device @block_size @frag_size
[1] (8:57) --- *(4): 	verifyAggr @device
[1] (8:57) --- *(4): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (8:57) --- *(4): END
[1] (8:57) --- *(4): 
[1] (8:57) --- *(4): set setup_fset proc END
[1] (8:57) --- *(4): !*** Create and mount a fileset
[1] (8:57) --- *(4): 	createFset @aggr_id @fset_id @fset_name
[1] (8:57) --- *(4): 	mountFset @fset_id @mount_point[0]
[1] (8:57) --- *(4): END
[1] (8:57) --- *(4): 
[1] (8:57) --- *(4): set shutdown_fset proc END
[1] (8:58) --- *(4): !*** Destroy the fileset
[1] (8:58) --- *(4): 	destroyFset @aggr_id @fset_id
[1] (8:58) --- *(4): END
[1] (8:58) --- *(4): 
[1] (8:58) --- *(4): set shutdown_aggr proc END
[1] (8:58) --- *(4): !*** Shutdown the aggregate
[1] (8:58) --- *(4): 	detachAggr @aggr_id
[1] (8:58) --- *(4): 	verifyAggr @device
[1] (8:58) --- *(4): END
[1] (8:58) --- *(4): 
[1] (8:58) --- *(4): quit
[1] (8:58) --- *(3): 
[1] (8:58) --- *(3): !*** Lock the raw device
[1] (8:58) --- !*** Lock the raw device
[1] (8:58) --- *(3): getRawDeviceName $device raw_device
[1] (8:58) [*] Inserting variable raw_device
[1] (8:58) --- *(3): lockAggrDevice $raw_device dev_lock
[1] (8:58) [*] Inserting variable dev_lock
[1] (8:58) --- *(3): 
[1] (8:58) --- *(3): !*** Attempt to gain second lock in another process
[1] (8:58) --- !*** Attempt to gain second lock in another process
[1] (8:58) --- *(3): set shell_cmd "./fset_test -I scripts/lock00_helper1.itl"
[1] (8:58) [*] Inserting variable shell_cmd
[1] (8:58) --- *(3): shellExec shell_cmd
[1] (0:00) --- The test is starting on Tue Nov 12 14:26:51 1996
[1] (0:08) --- Status verification is OFF
[1] (0:08) --- Status verification is ON
[1] (9:14) --- *(3): 
[1] (9:14) --- *(3): !*** Unlock the raw device
[1] (9:14) --- !*** Unlock the raw device
[1] (9:14) --- *(3): unlockAggrDevice $dev_lock
[1] (9:14) --- *(3): 
[1] (9:14) --- *(3): !*** Ensure that we can now gain the lock in another process
[1] (9:14) --- !*** Ensure that we can now gain the lock in another process
[1] (9:14) --- *(3): set shell_cmd "./fset_test -I scripts/lock00_helper2.itl"
[1] (9:14) --- *(3): shellExec shell_cmd
[1] (0:00) --- The test is starting on Tue Nov 12 14:27:01 1996
[1] (9:25) --- *(3): 
[1] (9:25) --- *(3): !*** Lock the raw device again
[1] (9:25) --- !*** Lock the raw device again
[1] (9:25) --- *(3): lockAggrDevice $raw_device dev_lock
[1] (9:25) --- *(3): 
[1] (9:25) --- *(3): !*** Attempt to attach the aggregate in another process
[1] (9:25) --- !*** Attempt to attach the aggregate in another process
[1] (9:26) --- *(3): set shell_cmd "./fset_test -I scripts/lock00_helper3.itl"
[1] (9:26) --- *(3): shellExec shell_cmd
[1] (0:00) --- The test is starting on Tue Nov 12 14:27:12 1996
[1] (0:08) --- Status verification is OFF
[1] (0:08) --- Status verification is ON
[1] (9:37) --- *(3): 
[1] (9:37) --- *(3): !*** Unlock the raw device
[1] (9:37) --- !*** Unlock the raw device
[1] (9:37) --- *(3): unlockAggrDevice $dev_lock
[1] (9:37) --- *(3): 
[1] (9:37) --- *(3): exec setup_aggr
[1] (9:37) --- *(3): 
[1] (9:37) --- *(3): !*** Setup the aggregate
[1] (9:37) --- !*** Setup the aggregate
[1] (9:37) --- *(3): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (9:43) --- *(3): 	verifyAggr $device
[1] (9:44) --- *(3): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (9:44) --- *(3): 
[1] (9:44) --- *(3): 
[1] (9:44) --- *(3): quit
[1] (9:44) [*] <== finished processing the string
[1] (9:44) --- *(3): 
[1] (9:44) --- *(3): !*** Attempt to lock the raw device
[1] (9:44) --- !*** Attempt to lock the raw device
[1] (9:44) --- *(3): verifyStatus false
[1] (9:44) [*] Using false  for Verify Status.
[1] (9:44) --- Status verification is OFF
[1] (9:44) --- *(3): lockAggrDevice $raw_device dev_lock_scratch
[1] (9:44) --- *(3): assert ($ITL_Status == $FTU_E_ATTACHED)
[1] (9:45) --- *(3): verifyStatus true
[1] (9:45) [*] Using true  for Verify Status.
[1] (9:45) --- Status verification is ON
[1] (9:45) --- *(3): 
[1] (9:45) --- *(3): exec shutdown_aggr
[1] (9:45) --- *(3): 
[1] (9:45) --- *(3): !*** Shutdown the aggregate
[1] (9:45) --- !*** Shutdown the aggregate
[1] (9:45) --- *(3): 	detachAggr $aggr_id
[1] (9:45) --- *(3): 	verifyAggr $device
[1] (9:46) --- *(3): 
[1] (9:46) --- *(3): 
[1] (9:46) --- *(3): quit
[1] (9:46) [*] <== finished processing the string
[1] (9:46) --- *(3): quit
[1] (9:46) --- *(2): 
[1] (9:46) --- *(2): include "lock01.itl"
[1] (9:46) [*] Opening the file lock01.itl
[1] (9:46) [*] Trying to open the file scripts/lock01.itl
[1] (9:46) --- *(3): *
[1] (9:46) --- *(3): * @OSF_COPYRIGHT@
[1] (9:46) --- *(3): * COPYRIGHT NOTICE
[1] (9:46) --- *(3): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (9:47) --- *(3): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE for
[1] (9:47) --- *(3): * the full copyright text.
[1] (9:47) --- *(3): *
[1] (9:47) --- *(3): * HISTORY
[1] (9:47) --- *(3): * $Log: lock01.itl,v $
[1] (9:47) --- *(3): * Revision 1.1.6.1  1994/02/04  20:41:44  devsrc
[1] (9:47) --- *(3): * 	Merged from 1.0.3a to 1.1
[1] (9:47) --- *(3): * 	[1994/02/04  15:22:57  devsrc]
[1] (9:47) --- *(3): *
[1] (9:47) --- *(3): * Revision 1.1.4.1  1994/01/28  20:44:08  annie
[1] (9:47) --- *(3): * 	expand OSF copyright
[1] (9:47) --- *(3): * 	[1994/01/28  20:42:35  annie]
[1] (9:47) --- *(3): * 
[1] (9:47) --- *(3): * Revision 1.1.2.2  1993/02/16  16:35:35  jaffe
[1] (9:47) --- *(3): * 	Transarc delta: jdp-db3072-aggregate-interlocking 1.2
[1] (9:47) --- *(3): * 	  Selected comments:
[1] (9:48) --- *(3): * 	    This delta implements an interlocking feature that keeps
[1] (9:48) --- *(3): * 	    administrative commands like salvage and newaggr from stomping on an
[1] (9:48) --- *(3): * 	    attached (or mounted) fileset.  Two new primitives,
[1] (9:48) --- *(3): * 	    ftu_LockAggrDevice() and ftu_UnlockAggrDevice(), are provided by the
[1] (9:48) --- *(3): * 	    ftutil library and are used in both newaggr and salvage.
[1] (9:48) --- *(3): * 	    Two new test cases were added to the fset (ftutil) tests suite.  The first,
[1] (9:48) --- *(3): * 	    lock00.itl, tests the primitives directly. The second, lock01.itl, tests
[1] (9:49) --- *(3): * 	    interaction with newaggr and salvage for both attached aggregates and
[1] (9:49) --- *(3): * 	    mounted filesets.
[1] (9:49) --- *(3): * 	    This script tests the locking interaction of newaggr and salvage.
[1] (9:49) --- *(3): * 	    Fix things up for OSF/1.
[1] (9:49) --- *(3): * 	[1993/02/15  19:29:50  jaffe]
[1] (9:49) --- *(3): * 
[1] (9:49) --- *(3): * $EndLog$
[1] (9:49) --- *(3): *
[1] (9:49) --- *(3): 
[1] (9:49) --- *(3): !**********************************************************
[1] (9:49) --- !**********************************************************
[1] (9:49) --- *(3): !*** Test locking interaction with administrative commands
[1] (9:49) --- !*** Test locking interaction with administrative commands
[1] (9:49) --- *(3): !**********************************************************
[1] (9:49) --- !**********************************************************
[1] (9:49) --- *(3): 
[1] (9:49) --- *(3): include "defaults.itl"
[1] (9:49) [*] Opening the file defaults.itl
[1] (9:49) [*] Trying to open the file scripts/defaults.itl
[1] (9:49) --- *(4): *
[1] (9:49) --- *(4): * @OSF_COPYRIGHT@
[1] (9:49) --- *(4): * COPYRIGHT NOTICE
[1] (9:50) --- *(4): * Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.
[1] (9:50) --- *(4): * ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the
[1] (9:50) --- *(4): * src directory for the full copyright text.
[1] (9:50) --- *(4): *
[1] (9:50) --- *(4): * HISTORY
[1] (9:50) --- *(4): * $Log: defaults.itl,v $
[1] (9:50) --- *(4): * Revision 1.1.414.1  1994/02/04  20:41:20  devsrc
[1] (9:50) --- *(4): * 	Merged from 1.0.3a to 1.1
[1] (9:50) --- *(4): * 	[1994/02/04  15:22:47  devsrc]
[1] (9:50) --- *(4): *
[1] (9:50) --- *(4): * Revision 1.1.412.1  1993/12/07  17:42:20  jaffe
[1] (9:50) --- *(4): * 	1.0.3a update from Transarc
[1] (9:50) --- *(4): * 	[1993/12/03  18:57:43  jaffe]
[1] (9:50) --- *(4): * 
[1] (9:50) --- *(4): * Revision 1.1.2.3  1993/01/11  18:27:35  htf
[1] (9:50) --- *(4): * 	Embedded copyright notice
[1] (9:51) --- *(4): * 	[1993/01/11  17:02:21  htf]
[1] (9:51) --- *(4): * 
[1] (9:51) --- *(4): * Revision 1.1.2.2  1992/10/28  16:32:35  jaffe
[1] (9:51) --- *(4): * 	Transarc delta: jdp-itl-add-fset-driver 1.2
[1] (9:51) --- *(4): * 	  Selected comments:
[1] (9:51) --- *(4): * 	    Add the code for fset_test, the fileset (ftutil) test driver.
[1] (9:51) --- *(4): * 	    This delta adds "fset" to the list of build directories in the test tree
[1] (9:51) --- *(4): * 	    and adds all of the test scripts.
[1] (9:51) --- *(4): * 	    Set default variables from environment.
[1] (9:51) --- *(4): * 	[1992/10/27  18:53:31  jaffe]
[1] (9:51) --- *(4): * 
[1] (9:51) --- *(4): * $EndLog$
[1] (9:51) --- *(4): *
[1] (9:51) --- *(4): 
[1] (9:51) --- *(4): * The following three resources must exist before testing begins
[1] (9:52) --- *(4): getenv FSET_DEVICE
[1] (9:52) --- *(4): if ($FSET_DEVICE == "") {
[1] (9:52) --- *(4): 	set device $FSET_DEVICE
[1] (9:52) --- *(4): }
[1] (9:52) --- *(4): 
[1] (9:52) --- *(4): getenv FSET_MOUNT_POINT_0
[1] (9:52) --- *(4): if ($FSET_MOUNT_POINT_0 == "") {
[1] (9:52) --- *(4): 	set mount_point[0] "/mnt"
[1] (9:52) --- *(4): } else {
[1] (9:52) --- *(4): 
[1] (9:52) --- *(4): getenv FSET_MOUNT_POINT_1
[1] (9:52) --- *(4): if ($FSET_MOUNT_POINT_1 == "") {
[1] (9:52) --- *(4): 	set mount_point[1] "/mnt2"
[1] (9:52) --- *(4): } else {
[1] (9:52) --- *(4): 
[1] (9:52) --- *(4): 
[1] (9:52) --- *(4): getenv FSET_AGGR_ID
[1] (9:52) --- *(4): if ($FSET_AGGR_ID == "") {
[1] (9:52) --- *(4): 	set aggr_id 1000
[1] (9:52) --- *(4): } else {
[1] (9:52) --- *(4): 
[1] (9:53) --- *(4): getenv FSET_BLOCK_SIZE
[1] (9:53) --- *(4): if ($FSET_BLOCK_SIZE == "") {
[1] (9:53) --- *(4): 	set block_size 8192
[1] (9:53) --- *(4): } else {
[1] (9:53) --- *(4): 
[1] (9:53) --- *(4): getenv FSET_FRAG_SIZE
[1] (9:53) --- *(4): if ($FSET_FRAG_SIZE == "") {
[1] (9:53) --- *(4): 	set frag_size 1024
[1] (9:53) --- *(4): } else {
[1] (9:53) --- *(4): 
[1] (9:53) --- *(4): set aggr_name	$device
[1] (9:53) --- *(4): set aggr_type	"lfs"
[1] (9:53) --- *(4): 
[1] (9:53) --- *(4): set fset_id   ($aggr_id + 1)
[1] (9:53) --- *(4): set fset_name ("fset" + $fset_id)
[1] (9:53) --- *(4): 
[1] (9:53) --- *(4): set file_name		"zappa"
[1] (9:53) --- *(4): set path_name[0]	($mount_point[0] + "/" + $file_name)
[1] (9:53) --- *(4): set path_name[1]	($mount_point[1] + "/" + $file_name)
[1] (9:53) --- *(4): 
[1] (9:54) --- *(4): set setup_aggr proc END
[1] (9:54) --- *(4): !*** Setup the aggregate
[1] (9:54) --- *(4): 	initAggr @device @block_size @frag_size
[1] (9:54) --- *(4): 	verifyAggr @device
[1] (9:54) --- *(4): 	attachAggr @device @aggr_type @aggr_name @aggr_id
[1] (9:54) --- *(4): END
[1] (9:54) --- *(4): 
[1] (9:54) --- *(4): set setup_fset proc END
[1] (9:54) --- *(4): !*** Create and mount a fileset
[1] (9:54) --- *(4): 	createFset @aggr_id @fset_id @fset_name
[1] (9:54) --- *(4): 	mountFset @fset_id @mount_point[0]
[1] (9:54) --- *(4): END
[1] (9:54) --- *(4): 
[1] (9:54) --- *(4): set shutdown_fset proc END
[1] (9:54) --- *(4): !*** Destroy the fileset
[1] (9:54) --- *(4): 	destroyFset @aggr_id @fset_id
[1] (9:54) --- *(4): END
[1] (9:54) --- *(4): 
[1] (9:54) --- *(4): set shutdown_aggr proc END
[1] (9:54) --- *(4): !*** Shutdown the aggregate
[1] (9:54) --- *(4): 	detachAggr @aggr_id
[1] (9:54) --- *(4): 	verifyAggr @device
[1] (9:54) --- *(4): END
[1] (9:54) --- *(4): 
[1] (9:54) --- *(4): quit
[1] (9:54) --- *(3): 
[1] (9:55) --- *(3): !*** Check interaction with an attached fileset
[1] (9:55) --- !*** Check interaction with an attached fileset
[1] (9:55) --- *(3): exec setup_aggr
[1] (9:55) --- *(3): 
[1] (9:55) --- *(3): !*** Setup the aggregate
[1] (9:55) --- !*** Setup the aggregate
[1] (9:55) --- *(3): 	initAggr $device $block_size $frag_size
*** /dev/repi2 ALREADY CONTAINS AN EPISODE FILE SYSTEM
*** CONTINUING
*** Using default initialempty value of 1.
*** Using default number of (8192-byte) blocks: 9727
*** Defaulting to 98 log blocks (maximum of 10 concurrent transactions).
Done.  /dev/repi2 is now an Episode aggregate.
[1] (10:02) --- *(3): 	verifyAggr $device
[1] (10:04) --- *(3): 	attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (10:04) --- *(3): 
[1] (10:04) --- *(3): 
[1] (10:04) --- *(3): quit
[1] (10:04) [*] <== finished processing the string
[1] (10:04) --- *(3): 
[1] (10:04) --- *(3): !*** Ensure that the aggregate can be verified
[1] (10:04) --- !*** Ensure that the aggregate can be verified
[1] (10:04) --- *(3): verifyAggr $device
[1] (10:05) --- *(3): 
[1] (10:05) --- *(3): verifyStatus false
[1] (10:05) [*] Using false  for Verify Status.
[1] (10:05) --- Status verification is OFF
[1] (10:05) --- *(3): 
[1] (10:05) --- *(3): !*** Ensure that the aggregate can't be reinitialized
[1] (10:05) --- !*** Ensure that the aggregate can't be reinitialized
[1] (10:05) --- *(3): initAggr $device $block_size $frag_size
newaggr: Unknown code DFS:ftu 12 (572833804) locking device
[1] (10:06) --- newaggr returned a non-zero exit status, status = 1
[1] (10:06) --- *(3): assert ($ITL_Status == 1)
[1] (10:06) --- *(3): 
[1] (10:06) --- *(3): !*** Ensure that the aggregate can't be recovered
[1] (10:06) --- !*** Ensure that the aggregate can't be recovered
[1] (10:06) --- *(3): recoverAggr $device
salvage : status 0x2224c00c (dfs / ftu) locking device
[1] (10:07) --- salvage returned a non-zero exit status, status = 16
[1] (10:07) --- *(3): assert ($ITL_Status == 16)
[1] (10:07) --- *(3): 
[1] (10:07) --- *(3): !*** Ensure that the aggregate can't be salvaged
[1] (10:07) --- !*** Ensure that the aggregate can't be salvaged
[1] (10:07) --- *(3): salvageAggr $device
salvage : status 0x2224c00c (dfs / ftu) locking device
[1] (10:08) --- salvage returned a non-zero exit status, status = 16
[1] (10:08) --- *(3): assert ($ITL_Status == 16)
[1] (10:08) --- *(3): 
[1] (10:08) --- *(3): verifyStatus true
[1] (10:08) [*] Using true  for Verify Status.
[1] (10:08) --- Status verification is ON
[1] (10:08) --- *(3): 
[1] (10:08) --- *(3): !*** Check interaction with a mounted fileset
[1] (10:08) --- !*** Check interaction with a mounted fileset
[1] (10:08) --- *(3): exec setup_fset
[1] (10:08) --- *(3): 
[1] (10:08) --- *(3): !*** Create and mount a fileset
[1] (10:08) --- !*** Create and mount a fileset
[1] (10:08) --- *(3): 	createFset $aggr_id $fset_id $fset_name
[1] (10:08) --- *(3): 	mountFset $fset_id $mount_point[0]
[1] (10:09) --- *(3): 
[1] (10:09) --- *(3): 
[1] (10:09) --- *(3): quit
[1] (10:09) [*] <== finished processing the string
[1] (10:09) --- *(3): 
[1] (10:09) --- *(3): verifyStatus false
[1] (10:09) [*] Using false  for Verify Status.
[1] (10:09) --- Status verification is OFF
[1] (10:09) --- *(3): 
[1] (10:09) --- *(3): !*** Ensure that the aggregate can't be detached. 
[1] (10:09) --- !*** Ensure that the aggregate can't be detached. 
[1] (10:09) --- *(3): detachAggr $aggr_id
[1] (10:09) --- *(3): assert ($ITL_Status == 16)
[1] (10:09) --- *(3): 
[1] (10:09) --- *(3): !*** Ensure that the aggregate can't be reinitialized
[1] (10:09) --- !*** Ensure that the aggregate can't be reinitialized
[1] (10:09) --- *(3): initAggr $device $block_size $frag_size
newaggr: Unknown code DFS:ftu 12 (572833804) locking device
[1] (10:10) --- newaggr returned a non-zero exit status, status = 1
[1] (10:10) --- *(3): assert ($ITL_Status == 1)
[1] (10:10) --- *(3): 
[1] (10:10) --- *(3): !*** Ensure that the aggregate can't be recovered
[1] (10:10) --- !*** Ensure that the aggregate can't be recovered
[1] (10:10) --- *(3): recoverAggr $device
salvage : status 0x2224c00c (dfs / ftu) locking device
[1] (10:11) --- salvage returned a non-zero exit status, status = 16
[1] (10:11) --- *(3): assert ($ITL_Status == 16)
[1] (10:11) --- *(3): 
[1] (10:11) --- *(3): !*** Ensure that the aggregate can't be salvaged
[1] (10:11) --- !*** Ensure that the aggregate can't be salvaged
[1] (10:11) --- *(3): salvageAggr $device
salvage : status 0x2224c00c (dfs / ftu) locking device
[1] (10:12) --- salvage returned a non-zero exit status, status = 16
[1] (10:12) --- *(3): assert ($ITL_Status == 16)
[1] (10:12) --- *(3): 
[1] (10:12) --- *(3): verifyStatus true
[1] (10:12) [*] Using true  for Verify Status.
[1] (10:12) --- Status verification is ON
[1] (10:12) --- *(3): 
[1] (10:12) --- *(3): !*** Check interaction after unmounting fileset
[1] (10:12) --- !*** Check interaction after unmounting fileset
[1] (10:12) --- *(3): unmountFset $mount_point[0]
[1] (10:12) --- *(3): 
[1] (10:12) --- *(3): verifyStatus false
[1] (10:12) [*] Using false  for Verify Status.
[1] (10:12) --- Status verification is OFF
[1] (10:12) --- *(3): 
[1] (10:13) --- *(3): !*** Ensure that the aggregate can't be reinitialized
[1] (10:13) --- !*** Ensure that the aggregate can't be reinitialized
[1] (10:13) --- *(3): initAggr $device $block_size $frag_size
newaggr: Unknown code DFS:ftu 12 (572833804) locking device
[1] (10:13) --- newaggr returned a non-zero exit status, status = 1
[1] (10:13) --- *(3): assert ($ITL_Status == 1)
[1] (10:13) --- *(3): 
[1] (10:13) --- *(3): !*** Ensure that the aggregate can't be recovered
[1] (10:13) --- !*** Ensure that the aggregate can't be recovered
[1] (10:13) --- *(3): recoverAggr $device
salvage : status 0x2224c00c (dfs / ftu) locking device
[1] (10:14) --- salvage returned a non-zero exit status, status = 16
[1] (10:14) --- *(3): assert ($ITL_Status == 16)
[1] (10:14) --- *(3): 
[1] (10:14) --- *(3): !*** Ensure that the aggregate can't be salvaged
[1] (10:14) --- !*** Ensure that the aggregate can't be salvaged
[1] (10:14) --- *(3): salvageAggr $device
salvage : status 0x2224c00c (dfs / ftu) locking device
[1] (10:15) --- salvage returned a non-zero exit status, status = 16
[1] (10:15) --- *(3): assert ($ITL_Status == 16)
[1] (10:15) --- *(3): 
[1] (10:15) --- *(3): verifyStatus true
[1] (10:15) [*] Using true  for Verify Status.
[1] (10:15) --- Status verification is ON
[1] (10:15) --- *(3): 
[1] (10:15) --- *(3): !*** Destroy the fileset
[1] (10:15) --- !*** Destroy the fileset
[1] (10:15) --- *(3): exec shutdown_fset
[1] (10:15) --- *(3): 
[1] (10:15) --- *(3): !*** Destroy the fileset
[1] (10:15) --- !*** Destroy the fileset
[1] (10:15) --- *(3): 	destroyFset $aggr_id $fset_id
[1] (10:15) --- *(3): 
[1] (10:15) --- *(3): 
[1] (10:15) --- *(3): quit
[1] (10:15) [*] <== finished processing the string
[1] (10:15) --- *(3): 
[1] (10:15) --- *(3): !*** Detach the aggregate
[1] (10:15) --- !*** Detach the aggregate
[1] (10:15) --- *(3): detachAggr $aggr_id
[1] (10:15) --- *(3): 
[1] (10:16) --- *(3): !*** Ensure that the aggregate can be verified and re-attached
[1] (10:16) --- !*** Ensure that the aggregate can be verified and re-attached
[1] (10:16) --- *(3): verifyAggr $device
[1] (10:17) --- *(3): attachAggr $device $aggr_type $aggr_name $aggr_id
[1] (10:17) --- *(3): 
[1] (10:17) --- *(3): exec shutdown_aggr
[1] (10:17) --- *(3): 
[1] (10:17) --- *(3): !*** Shutdown the aggregate
[1] (10:17) --- !*** Shutdown the aggregate
[1] (10:17) --- *(3): 	detachAggr $aggr_id
[1] (10:17) --- *(3): 	verifyAggr $device
[1] (10:19) --- *(3): 
[1] (10:19) --- *(3): 
[1] (10:19) --- *(3): quit
[1] (10:19) [*] <== finished processing the string
[1] (10:19) --- *(3): quit
[1] (10:19) --- *(2): quit
[1] (10:19) --- *(1): quit
