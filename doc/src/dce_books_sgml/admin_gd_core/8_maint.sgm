<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: 8_maint.sgm,v $
# Revision 1.1.2.10  1996/12/04  22:49:21  carrig
# 	{enh,R1.2.2}
# 	JC's edits
# 	[1996/12/04  22:47:11  carrig]
#
# Revision 1.1.2.9  1996/11/29  20:20:56  carrig
# 	{enh,R1.2.2}
# 	Finished edit changes; must scale graphics
# 	[1996/11/29  20:17:33  carrig]
# 
# Revision 1.1.2.8  1996/11/27  21:43:41  carrig
# 	{enh,R1.2.2}
# 	More editor's comments
# 	[1996/11/27  21:41:49  carrig]
# 
# 	{enh,R1.2.2}
# 	More editor's comments
# 	[1996/11/27  21:28:35  carrig]
# 
# Revision 1.1.2.7  1996/11/26  21:45:19  carrig
# 	{enh,R1.2.2}
# 	Putting in editor's comments
# 	[1996/11/26  21:41:04  carrig]
# 
# Revision 1.1.2.6  1996/11/25  21:51:22  carrig
# 	{enh,R1.2.2}
# 	Started to put in editor's comments
# 	[1996/11/25  21:49:29  carrig]
# 
# Revision 1.1.2.5  1996/11/07  20:43:33  weir
# 	Cleaned up history
# 	[1996/11/07  20:41:44  weir]
# 
# Revision 1.1.2.4  1996/11/06  20:40:42  carrig
# 	{enh,R1.2.2}
# 	OK for editing
# 	[1996/11/06  20:38:14  carrig]
# 
# Revision 1.1.2.3  1996/11/05  18:58:54  carrig
# 	{enh,R1.2.2}
# 	Second pass
# 	[1996/11/05  18:55:43  carrig]
# 
# Revision 1.1.2.2  1996/11/04  22:03:48  carrig
# 	{enh,R1.2.2}
# 	First pass at corrections
# 	[1996/11/04  22:00:23  carrig]
# 
# Revision 1.1.2.1  1996/11/01  18:20:38  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 	[1996/11/01  18:18:03  wardr]
# 
# Revision 1.1.1.2  1996/11/01  18:18:03  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 
# $EndLog$
-->
<!---->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
]>
-->
<!---->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the-->
<!-- src directory for the full copyright text.-->
<!---->
<!---->
<!-- HISTORY-->
<!-- Revision 1.1.8.2  1996/10/21  18:08:24  wardr-->
<!-- 	{edit,R1.2.2}-->
<!-- 	Update for sgml conversion-->
<!-- 	[1996/10/21  18:07:57  wardr]-->
<!---->
<!-- Revision 1.1.8.1  1996/09/19  17:15:58  sherman-->
<!-- 	{def,13575,R1.2.2}-->
<!-- 	Fixed various dcecp problems-->
<!-- 	[1996/09/19  17:15:37  sherman]-->
<!-- -->
<!-- Revision 1.1.6.26  1995/05/25  19:08:43  rcb-->
<!-- 	PRENTICE HALL reformat: *really* last change-->
<!-- 	[1995/05/25  14:12:10  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat: *really* last change-->
<!-- 	[1995/05/25  14:07:49  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat: final changes-->
<!-- 	[1995/05/25  13:25:06  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat - index entries, odds and ends-->
<!-- 	[1995/03/27  19:51:19  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat-->
<!-- 	[1995/03/14  14:07:58  rcb]-->
<!-- -->
<!-- 	incorporated 1.1 edits-->
<!-- 	[1995/03/14  13:23:06  rcb]-->
<!-- -->
<!-- Revision 1.1.6.25  1994/10/20  20:26:34  wardr-->
<!-- 	{edit R1.1}-->
<!-- 	Final GA release edits-->
<!-- 	[1994/10/20  20:25:47  wardr]-->
<!-- -->
<!-- Revision 1.1.6.24  1994/10/18  21:20:55  millette-->
<!-- 	{enh, 10014, R1.1}-->
<!-- 	More HP edits-->
<!-- 	[1994/10/18  21:20:17  millette]-->
<!-- -->
<!-- Revision 1.1.6.23  1994/10/13  22:25:54  millette-->
<!-- 	{enh, 10014, R1.1}-->
<!-- 	HP edits-->
<!-- 	[1994/10/13  22:24:55  millette]-->
<!-- -->
<!-- Revision 1.1.6.22  1994/09/29  20:12:24  millette-->
<!-- 	No changes made-->
<!-- 	[1994/09/29  20:11:56  millette]-->
<!-- -->
<!-- Revision 1.1.6.21  1994/09/23  21:23:56  millette-->
<!-- 	(enh, 10014, R1.1)-->
<!-- 	dcecp edits-->
<!-- 	[1994/09/23  21:23:00  millette]-->
<!-- -->
<!-- Revision 1.1.6.20  1994/09/09  19:17:44  wardr-->
<!-- 	{enh, CR10014, R1.1}-->
<!-- 	dced/dcecp admin changes-->
<!-- 	[1994/09/09  19:17:12  wardr]-->
<!-- -->
<!-- Revision 1.1.6.19  1994/07/21  15:52:11  steto-->
<!-- 	{enh, CR10014, R1.1, Removed sec_admin information}-->
<!-- 	Removed detail about the sec-admin program's syntax, also mentions of-->
<!-- 	commands for performing maitnenace tasks.-->
<!-- 	[1994/07/21  15:51:46  steto]-->
<!-- -->
<!-- Revision 1.1.6.18  1994/06/21  19:34:41  millette-->
<!-- 	(def, 9306, R1.1)-->
<!-- 	Fix initial message.-->
<!-- 	[1994/06/21  19:34:12  millette]-->
<!-- -->
<!-- Revision 1.1.6.17  1994/06/20  18:41:25  millette-->
<!-- 	 (def, 8628, R1.1)-->
<!-- 	 Used wrong CR number in last fix-->
<!-- 	[1994/06/20  18:40:57  millette]-->
<!-- -->
<!-- Revision 1.1.6.16  1994/06/20  18:26:48  millette-->
<!-- 	(def, 8628, R1.1)-->
<!-- 	Remove explicit references to chpass and su-->
<!-- 	[1994/06/20  18:26:09  millette]-->
<!-- -->
<!-- Revision 1.1.6.15  1994/05/31  14:05:05  wardr-->
<!-- 	{edit R1.1}-->
<!-- 	Fixed index range errors-->
<!-- 	[1994/05/31  14:04:19  wardr]-->
<!-- -->
<!-- Revision 1.1.6.14  1994/05/29  19:41:03  steto-->
<!-- 	[edt, R1.1}-->
<!-- 	Fixed .CS/.cE pair causing some subsections not to print.-->
<!-- 	[1994/05/29  19:40:38  steto]-->
<!-- -->
<!-- Revision 1.1.6.13  1994/05/23  20:51:56  steto-->
<!-- 	{edt, R1.1}-->
<!-- 	Fixed bad index entries.-->
<!-- 	[1994/05/23  20:51:39  steto]-->
<!-- -->
<!-- Revision 1.1.6.12  1994/05/19  15:53:43  steto-->
<!-- 	{edt, R1.1}-->
<!-- 	Fixed more index entries causing build errors.-->
<!-- 	[1994/05/19  15:53:21  steto]-->
<!-- -->
<!-- Revision 1.1.6.11  1994/05/19  15:15:38  steto-->
<!-- 	[edt, R1.1}-->
<!-- 	Fixed index entries causing build errors.-->
<!-- 	[1994/05/19  15:15:16  steto]-->
<!-- -->
<!-- Revision 1.1.6.10  1994/05/15  21:39:59  steto-->
<!-- 	{enh, 10014, edt, r1.1}-->
<!-- 	Updated for dcecp; Made a few edits for Beta.-->
<!-- 	[1994/05/15  21:39:39  steto]-->
<!-- -->
<!-- Revision 1.1.6.9  1994/05/15  02:54:57  steto-->
<!-- 	{edt, R1.1}-->
<!-- 	Looked at file; did not make changes.-->
<!-- 	[1994/05/15  02:54:31  steto]-->
<!-- -->
<!-- Revision 1.1.6.8  1994/04/27  20:26:32  grinham-->
<!-- 	Changes made:  Add explanation of new file group_override; expand explanation-->
<!-- 	                  of the passwd_export command (-n and -x options) to-->
<!-- 	                  accommodate this new file.-->
<!-- 	File name:     src/dcebooks/admin_gd/security/security/8_maint.gpsml-->
<!-- 	Change Request Number:  10415-->
<!-- 	[1994/04/27  20:25:22  grinham]-->
<!-- -->
<!-- Revision 1.1.6.7  1994/03/28  21:08:43  zahn-->
<!-- 	{enh,5923,R1.1}-->
<!-- -->
<!-- 	Corrected cross-references to User's Guide-->
<!-- 	and Reference, since it no longer exists.-->
<!-- 	[1994/03/28  21:08:28  zahn]-->
<!-- -->
<!-- Revision 1.1.6.6  1993/09/09  19:35:40  millette-->
<!-- 	(defect, 8565, R1.0.3)-->
<!-- 	principal UIDs are not encrypted in passwd_override file-->
<!-- 	[1993/09/09  19:34:43  millette]-->
<!-- -->
<!-- Revision 1.1.6.5  1993/09/01  17:03:44  tmw-->
<!-- 	Index correction.-->
<!-- 	[1993/09/01  17:01:57  tmw]-->
<!-- -->
<!-- Revision 1.1.6.4  1993/08/30  03:38:43  tmw-->
<!-- 	Added index entries for second version of master index.-->
<!-- 	[1993/08/30  03:36:10  tmw]-->
<!-- -->
<!-- Revision 1.1.6.3  1993/07/06  18:38:06  buckler-->
<!-- 	{edit, R1.0.2}-->
<!-- 	Prentice-Hall editorial changes.-->
<!-- 	[1993/07/06  18:19:55  buckler]-->
<!-- -->
<!-- Revision 1.1.6.2  1993/06/01  18:36:09  millette-->
<!-- 	Prentice Hall edits-->
<!-- 	[1993/06/01  18:34:36  millette]-->
<!-- -->
<!-- Revision 1.1.4.9  1993/02/22  16:04:56  millette-->
<!-- 	Bug 7215: Editorial corrections from 1.0.2 review.-->
<!-- 	[1993/02/19  23:04:22  millette]-->
<!-- -->
<!-- Revision 1.1.4.8  1993/02/01  16:08:44  millette-->
<!-- 	Fixed bug number in change marker-->
<!-- 	[1993/02/01  16:06:57  millette]-->
<!-- -->
<!-- Revision 1.1.4.7  1993/01/28  20:10:21  dbelch-->
<!-- 	Embedding copyright notice-->
<!-- 	[1993/01/28  18:46:50  dbelch]-->
<!-- -->
<!-- Revision 1.1.4.6  1993/01/27  17:03:46  buckler-->
<!-- 	Fixed cross-refs and figure calls for new book org-->
<!-- 	[1993/01/27  16:59:26  buckler]-->
<!-- -->
<!-- Revision 1.1.4.5  1993/01/08  19:32:23  millette-->
<!-- 	Bug 6469: Update for 1.0.2 replication.  Also did an editorial pass-->
<!-- 	to ensure consistent replication terminology use and correct terminology and-->
<!-- 	capitalization of Security Server and Security Service (e.g., not Security server-->
<!-- 	and not Security component)-->
<!-- 	[1993/01/08  18:54:20  millette]-->
<!-- -->
<!-- Revision 1.1.4.4  1992/09/25  16:07:01  millette-->
<!-- 	Bug 4890: Clarify keyfield in overrides-->
<!-- 	[1992/09/25  16:05:33  millette]-->
<!-- -->
<!-- Revision 1.1.4.3  1992/08/26  13:13:08  weir-->
<!-- 	Test-->
<!-- 	[1992/08/26  13:10:11  weir]-->
<!-- -->
<!-- 	Removed change bars-->
<!-- 	[1992/08/26  12:29:08  weir]-->
<!-- -->
<!-- Revision 1.1.4.2  1992/08/25  21:26:05  weir-->
<!-- 	Moved to dce1.0.2doc-->
<!-- 	[1992/08/25  21:08:07  weir]-->
<!-- -->
<!-- Revision 1.1.2.7  1992/06/30  20:10:33  millette-->
<!-- 	Bug 4470: Add -n passwd_export option-->
<!-- 	Bug 4181: Add that sec_admin requires a DCE login-->
<!-- 	[1992/06/30  20:08:52  millette]-->
<!-- -->
<!-- Revision 1.1.2.6  1992/06/04  22:20:27  millette-->
<!-- 	Bug 3792: Miscellaneous editorial changes-->
<!-- 	[1992/06/04  21:38:51  millette]-->
<!-- -->
<!-- Revision 1.1.2.5  1992/05/20  15:36:48  millette-->
<!-- 	Bug 3249: Add -v option-->
<!-- 	Bug 3023: Miscellaneous editoral changes-->
<!-- 	[1992/05/20  14:51:22  millette]-->
<!-- -->
<!-- Revision 1.1.2.4  1992/05/08  15:19:53  millette-->
<!-- 	Bug 3255: passwd_override enhancements-->
<!-- 	[1992/05/08  15:18:26  millette]-->
<!-- -->
<!-- Revision 1.1.2.3  1992/04/30  15:42:32  millette-->
<!-- 	Bug 2771:  Miscellaneous editoral change.  No change bars used.-->
<!-- 	[1992/04/30  15:41:04  millette]-->
<!-- -->
<!-- Revision 1.1.2.2  1992/04/16  18:01:14  millette-->
<!-- 	Bug 2638: Change backup procedures to include master key file.-->
<!-- 	[1992/04/16  16:08:49  millette]-->
<!-- -->
<!-- Revision 1.1  1992/01/29  16:24:34  damon-->
<!-- 	Initial revision-->
<!-- -->
<!---->
<!-- (c) Copyright 1991, Open Software Foundation, Inc.  ALL RIGHTS RESERVED-->
<!-- -->
<!-- ********************************************************************-->
<!--                                                                    *-->
<!-- HP/DIGITAL CONFIDENTIAL-->
<!-- Copyright (c) 1991 Hewlett-Packard Co. and Digital Equipment Corp.  -->
<!-- All rights reserved.-->
<!--                                                                    *-->
<!-- ********************************************************************-->
<!-- -->
<Chapter Id="AGCC.SECMNT.div.1">
<Title>Performing Routine Maintenance</Title>
<Para><IndexTerm Id="AGCC.SECMNT.indx.1">
<Primary>registry</Primary>
<Secondary>database</Secondary>
<Tertiary>routine maintenance</Tertiary>
</IndexTerm>This chapter describes security maintenance procedures that
should be performed on a regular basis, such as
</Para>
<ItemizedList>
<ListItem>
<Para>Adding new users to the registry
</Para>
</ListItem>
<ListItem>
<Para>Creating overrides for individual machines 
</Para>
</ListItem>
<ListItem>
<Para>Changing the master key
</Para>
</ListItem>
<ListItem>
<Para>Backing up and restoring the database
</Para>
</ListItem>
<ListItem>
<Para>Updating the <Filename>/etc/passwd</Filename> and <Filename>/etc/group</Filename>
files so that they are consistent with the registry
</Para>
</ListItem>
</ItemizedList>
<!-- You will also employ other-->
<!-- DCE tools, such as the \*Lchpass\*O command,-->
<!-- which modifies the passwords for the local servers in the registry.-->
<!-- .H 3 "Automatic Binding to the Master" -->
<!-- .P-->
<!-- Some of the \*Lsec_admin\*O commands can act only on the -->
<!-- master replica and thus require binding to the master.  -->
<!-- If you execute a command that acts only on the master and the master is not-->
<!-- the  default replica, \*Lsec_admin\*O automatically attempts to bind to the -->
<!-- master replica in the current default cell.  If this attempt is -->
<!-- successful, \*Lsec_admin\*O displays a warning message, informing you -->
<!-- that the default replica has been changed to the master registry.  The -->
<!-- master registry will then remain the default replica until you change -->
<!-- it with the \*Lsite\*O command.  If the attempt to bind is not -->
<!-- successful, \*Lsec_admin\*O displays an error message, and the command -->
<!-- fails. -->
<!-- .H 3 "Displaying Replica Information" -->
<!-- .P-->
<!-- .iX "-[" "security" "checking a replica status"-->
<!-- .iX "-[" "replicas" "checking the status"-->
<!-- .P-->
<!-- The \*Linfo\*O command displays status information about the default replica.-->
<!-- The command is in the following format: -->
<!-- .sS-->
<!-- \*Linfo\*O [\*L-full\*O]-->
<!-- .sE -->
<!-- .P -->
<!-- If you enter no options, \*Linfo\*O displays:-->
<!-- .ML-->
<!-- .LI-->
<!-- The default replica's name and the name of the cell in which the replica-->
<!-- exists.-->
<!-- .LI-->
<!-- Whether the replica is a master or a slave.-->
<!-- .LI-->
<!-- The replica's state.  A given replica can be in only one of the following-->
<!-- states at a time:-->
<!-- .ML-->
<!-- .LI-->
<!-- \*LUninitialized\*O\(emThe database is -->
<!-- a stub database that has not been initialized by the master replica or -->
<!-- another up-to-date replica.-->
<!-- .LI -->
<!-- \*LInitializing\*O\(emThe replica is in the process -->
<!-- of being initialized by the master replica or another up-to-date replica.-->
<!-- .LI -->
<!-- \*LIn Service\*O\(emThe replica is available for use. -->
<!-- .LI -->
<!-- \*LSaving Database\*O\(emThe replica is in the process of saving its-->
<!-- database to disk. -->
<!-- .LI -->
<!-- \*LCopying Database\*O\(emThe replica is in the process of initializing-->
<!-- (copying its database to) another replica.-->
<!-- .LI -->
<!-- \*LIn Maintenance\*O\(emThe replica is  unavailable for updates but will-->
<!-- accept queries.-->
<!-- .LI -->
<!-- \*LChanging Master Key\*O\(emThe replica is in the process of having its-->
<!-- master key changed. -->
<!-- .LI-->
<!-- \*LBecoming master\*O\(emThe replica is in the process of becoming the-->
<!-- master replica (applicable to slave replicas only)-->
<!-- .LI -->
<!-- \*LClosed\*O\(emThe replica is in the process of stopping.-->
<!-- .LI -->
<!-- \*LDeleted\*O\(emThe replica is in the process of deleting itself.-->
<!-- .LE -->
<!-- .LI                                             -->
<!-- The date and time the replica was last updated and the update sequence number.-->
<!-- .LE-->
<!-- .P-->
<!-- The \%\*L-full\*O option displays all the preceding information plus the -->
<!-- following information:-->
<!-- .ML-->
<!-- .LI-->
<!-- The default replica's unique identifier.-->
<!-- .LI-->
<!-- The replica's network addresses.-->
<!-- .LI-->
<!-- The unique identifier of the cell's master replica.-->
<!-- .LI-->
<!-- The master sequence number, which is the sequence number of the event that-->
<!-- made the replica the master.-->
<!-- .LI-->
<!-- The network addresses of the cell's master replica.-->
<!-- ...\" .LI-->
<!-- ...\" The DCE software version number and the security compatibility version-->
<!-- number -->
<!-- ...\" of the \*Lsec_admin\*O command.  (Use these  -->
<!-- ...\" version numbers to ensure compatibility among the \*Lsec_admin\*O-->
<!-- servers.)-->
<!-- .LI-->
<!-- If the replica is the master replica, the update sequence numbers that are-->
<!-- still in the propagation queue and have yet to be propagated. -->
<!-- .LE-->
<!-- .iX "-]" "security" "checking a replica status"-->
<!-- .iX "-]" "replicas" "checking the status"-->
<!-- .H 3 "Invoking sec_admin"-->
<!-- .P-->
<!-- When you invoke \*Lsec_admin\*O, it displays the current default replica's-->
<!-- full global name and the cell in which the replica exists.  -->
<!-- Then it displays the \*Csec_admin>\*O prompt. -->
<!-- .iS-->
<!-- \*C$\*L sec_admin\*C -->
<!-- .iE-->
<!-- .oS-->
<!-- Default replica: /.../dresden.com/subsys/dce/sec/music -->
<!-- Default cell: /.../dresden.com\*C-->
<!-- sec_admin>\*O-->
<!-- .oE-->
<!-- .P-->
<!-- At the \*Csec_admin>\*O prompt, you can enter any of the \*Lsec_admin\*O-->
<!-- commands described in Table 24-1.  The commands are described in-->
<!-- detail in the \*(Ar \*Lsec_admin\*O-->
<!-- reference page.-->
<Sect1 Id="AGCC.SECMNT.div.2">
<Title>Adding Accounts</Title>
<Para>To add new user accounts to the registry, you must have the appropriate
permissions to the registry (see 
<!-- Chapter 13).  -->
Chapter 41).  Once you have the appropriate permissions, you can proceed as
follows to add accounts:
</Para>
<OrderedList>
<ListItem>
<Para>If the principal to be used in the account does not already exist, execute
the <Command>principal create</Command> command to add the principal.
</Para>
</ListItem>
<ListItem>
<Para>Execute the <Command>group create</Command> command to add the group to be used in the
account if this group does not already exist.
</Para>
</ListItem>
<ListItem>
<Para>Execute the <Command>organization create</Command> command to add the organization to be
used in the account if this organization does not already exist.
</Para>
</ListItem>
<ListItem>
<Para>Finally, execute the <Command>account create</Command> command to add the account.
</Para>
</ListItem>
</OrderedList>
</Sect1>
<Sect1 Id="AGCC.SECMNT.div.3">
<Title>Overriding Entries in the Local Registry</Title>
<IndexTerm Id="AGCC.SECMNT.indx.2">
<Primary>registry</Primary>
<Secondary>local overrides</Secondary>
</IndexTerm>
<Para>You can override registry entries for local machines.  By using overrides,
you can, for example, prevent individuals
and groups from logging into a particular machine, establish local
root passwords, and tailor local user environments.  The override
information is in effect for the local machine only and has no effect
on the account information that is stored in the registry.
</Para>
<Para>The override mechanism provides a high level of local autonomy and
allows individual users to control their own machines.  For example,
an administrator who is responsible for a group of machines can use the
override facility to restrict access to those machines.  The administrator
can allow access to specific groups, or the administrator can allow
access to everyone except specific groups or principals. 
</Para>
<Sect2 Id="AGCC.SECMNT.div.4">
<Title>How Overrides Work</Title>
<IndexTerm Id="AGCC.SECMNT.indx.3">
<Primary><Filename>passwd_override</Filename> file</Primary>
<Secondary>scope</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.4">
<Primary>overrides</Primary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.5">
<Primary>GECOS information</Primary>
<Secondary>overriding</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.6">
<Primary>UNIX IDs</Primary>
<Secondary>overriding</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.7">
<Primary>principals</Primary>
<Secondary>overriding UNIX IDs</Secondary>
</IndexTerm>
<Para>The
<Filename>passwd_override</Filename> administrative file that is stored in the local
machine's <Symbol Role="Variable">dcelocal</Symbol><Filename>/etc/security</Filename>
directory contains override information.  By using this file, you can
enter overrides for the following: 
</Para>
<ItemizedList>
<ListItem>
<Para>Passwords
</Para>
</ListItem>
<ListItem>
<Para>GECOS information
</Para>
</ListItem>
<ListItem>
<Para>Home directories
</Para>
</ListItem>
<ListItem>
<Para>Login shells 
</Para>
</ListItem>
<ListItem>
<Para>Group memberships
</Para>
</ListItem>
<ListItem>
<Para>UNIX IDs for principals 
</Para>
</ListItem>
</ItemizedList>
<Para>The override information that you enter is in effect only for the local
machine, which is the machine on which the <Filename>passwd_override</Filename> file is
stored.  When a user logs into a machine with an override file, any information
for the user's account in the override file replaces the pertinent
information obtained from the registry. 
</Para>
<Para>For example, assume that the registry account for <Literal>bach</Literal>
specifies a Korn shell at login.  Since <Literal>bach</Literal> normally logs
into a machine that can run a Korn shell, this is fine for a majority
of situations.  However, <Literal>bach</Literal> occasionally works for another
department and logs into a machine that cannot run a Korn shell. 
To accommodate <Literal>bach</Literal>'s needs, you can create an override file
on the machine that cannot run the Korn shell.  The override can
specify a Bourne login shell.  Then, if <Literal>bach</Literal> logs into the
machine that can run a Korn shell, registry data is used and a Korn
shell is invoked.  When <Literal>bach</Literal> logs into the machine that
cannot run a Korn shell, override data is used and a Bourne shell
is invoked.
</Para>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.5">
<Title>The passwd_override File Format</Title>
<IndexTerm Id="AGCC.SECMNT.indx.8">
<Primary><Filename>passwd_override</Filename> file</Primary>
<Secondary>format</Secondary>
</IndexTerm>
<Para>Entries in the <Filename>passwd_override</Filename> file have the following format:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput><Symbol Role="Variable">principal_name</Symbol><Literal>:</Literal><Symbol Role="Variable">passwd</Symbol><Literal>:</Literal><Symbol Role="Variable">principal_uid</Symbol><Literal>:</Literal><Symbol Role="Variable">group_uid</Symbol><Literal>:</Literal><Symbol Role="Variable">GECOS</Symbol><Literal>:</Literal><Symbol Role="Variable">home_dir</Symbol><Literal>:</Literal><Symbol Role="Variable">shell
</Symbol></UserInput></ProgramListing></Para>
</InformalExample>
<Para>where:
</Para>
<VariableList>
<VarListEntry role="linebreak">
<Term><Symbol Role="Variable">principal_name</Symbol></Term>
<ListItem>
<Para>A keyfield that contains a principal name that identifies
the principal to whose account the override applies.  Enter
<Symbol Role="Variable">principal_name</Symbol> to apply the override only to the account for the 
principal's primary name and not to any accounts for the principal's aliases. 
</Para>
<Para>You must enter one of the keyfields (<Symbol Role="Variable">principal_name</Symbol>,
<Symbol Role="Variable">principal_uid</Symbol>, or <Symbol Role="Variable">group_uid</Symbol>) to identify the account(s) to
which the override applies.  
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">passwd</Symbol></Term>
<ListItem>
<Para>The encrypted password.  If you specify an override, the password that
you enter here is in effect for this local machine only.
</Para>
<Para>You can also specify <Literal>OMIT</Literal> in the <Symbol Role="Variable">passwd</Symbol> field
to disallow login on the local machine.  The use of<Literal> OMIT</Literal>
in conjunction with an option to the <Command>passwd_export</Command> command
prevents the inclusion of the user in the password file created by
<Command>passwd_export</Command>.  (See 
<!-- the section titled "Omitting Users from the Local Password Files" -->
Section 36.2.8.)
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Symbol Role="Variable">principal_uid</Symbol></Term>
<ListItem>
<Para>The <Symbol Role="Variable">principal_uid</Symbol> field, which contains a UNIX ID that 
specifies the local identity of a principal, can function as 
a keyfield when the <Symbol Role="Variable">principal_name</Symbol> keyfield is not  
entered, or as a field containing an override when entered in conjunction with 
<Symbol Role="Variable">principal_name</Symbol>.  
</Para>
<Para>Enter <Symbol Role="Variable">principal_uid</Symbol> and not <Symbol Role="Variable">principal_name</Symbol> when
you want to apply the overrides to all of a principal's accounts, including
any accounts for the principal's aliases.  The <Symbol Role="Variable">principal_uid</Symbol> keyfield
is especially useful for overrides to <Literal>root</Literal>. 
For example, if <Literal>root</Literal> has an alias of <Literal>virtuoso</Literal>, an
override that is keyed by principal name applies only when root logs
in as <Literal>root</Literal>.  An override that is keyed by root's <Symbol Role="Variable">principal_uid</Symbol>
applies when root logs in as <Literal>root</Literal>, as <Literal>virtuoso</Literal>, and under
any other alias. 
</Para>
<Para><?sml-need 2>Enter <Symbol Role="Variable">principal_uid</Symbol> and <Symbol Role="Variable">principal_name</Symbol> to override the UNIX ID
of the named principal.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">group_uid</Symbol></Term>
<ListItem>
<?sml-need 4>
<Para>The <Symbol Role="Variable">group_uid</Symbol> field, which contains a group UNIX ID, can function as 
a keyfield when no other keyfields are entered, or as a field containing an
override when entered in conjunction with <Symbol Role="Variable">principal_name</Symbol> or
<Symbol Role="Variable">principal_uid</Symbol>.  
</Para>
<Para>Enter <Symbol Role="Variable">group_uid</Symbol> and no other keyfield (<Symbol Role="Variable">principal_name</Symbol> or
<Symbol Role="Variable">principal_uid</Symbol>) to apply the override to all members of the group that
is identified by <Symbol Role="Variable">group_uid</Symbol>.  In this instance, the 
<Symbol Role="Variable">group_uid</Symbol> field functions as a keyfield, identifying the 
accounts to which to apply the overrides; that is, accounts whose principal 
is a member of the specified group.
</Para>
<Para>Enter <Symbol Role="Variable">group_uid</Symbol> and <Symbol Role="Variable">principal_name</Symbol> to change the group of the 
principal that is identified by <Symbol Role="Variable">principal_name</Symbol> to the group that is
identified by <Symbol Role="Variable">group_uid</Symbol>.  The change applies only 
to the account for the principal's primary name, not to any accounts for the 
principal's aliases.  Enter <Symbol Role="Variable">group_uid</Symbol> and <Symbol Role="Variable">principal_uid</Symbol> to 
apply the group override to all of the principal's accounts, including any
for the principal's aliases.
In these instances, the <Symbol Role="Variable">group_uid</Symbol> field functions as  
a field that supplies override information, not as a keyfield.  
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">GECOS</Symbol></Term>
<ListItem>
<Para>The account's GECOS field.  If you specify an override, it is reflected in
the information that is displayed by the UNIX <Command>finger</Command> command.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">home_dir</Symbol></Term>
<ListItem>
<Para>The account's home directory.  If you specify an override, the directory
that you specify is the account's home directory on this machine only. 
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">shell</Symbol></Term>
<ListItem>
<Para>The shell that is invoked when the account logs in.  If you specify an
override, the shell that you specify is invoked at login to this machine. 
</Para>
</ListItem>
</VarListEntry>
</VariableList>
<IndexTerm Id="AGCC.SECMNT.indx.9" SpanEnd="AGCC.SECMNT.indx.8">
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.6">
<Title>The group_override File Format</Title>
<IndexTerm Id="AGCC.SECMNT.indx.10">
<Primary><Literal>group_override</Literal> file</Primary>
<Secondary>format</Secondary>
</IndexTerm>
<Para>This section explains the <Literal>group_override</Literal> file.
</Para>
<Sect3 Id="AGCC.SECMNT.div.7">
<Title>Description</Title>
<Para>The <Filename>/opt/</Filename><Symbol Role="Variable">dcelocal</Symbol><Filename>/etc/group_override</Filename> administrative
file lets you override the UNIX group ID for a group similar to
the way in which the <Filename>passwd_override</Filename> file permits overriding
information in the network registry database.
</Para>
<Para>The <Literal>group_override</Literal> file is stored on each machine.  Any changes
you make to it are in effect for the local machine only; they have no
effect on the centralized registry.  You might find working with file
<Literal>group_override</Literal> especially useful in overriding the default group
definitions supplied with the registry if they do not match your
local UNIX system.
</Para>
</Sect3>
<Sect3 Id="AGCC.SECMNT.div.8">
<Title>File Format</Title>
<Para>The format of the entries in file <Literal>group_override</Literal> is similar
to the format of the entries in the UNIX <Command>group</Command> file.  This
format is
</Para>
<InformalExample>
<Para><ProgramListing><UserInput><Symbol Role="Variable">group_name:passwd:group_uid:members</Symbol>
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>In this entry, <Symbol Role="Variable">group_name</Symbol> and <Symbol Role="Variable">group_uid</Symbol> are keyfields.
You must enter one to identify the group to which the override applies.
The keyfield is used to perform a lookup in the override file when
you use the <Command>passwd_export</Command> command.  The lookup is performed in
order as the entries are specified in an override file: first by
group name, then by group UNIX ID.  If you specify both keyfields in an
override entry, the group name is used as the lookup key; subsequent
fields are used as overrides.
<?sml-break><?sml-need 10></Para>
</Sect3>
<Sect3 Id="AGCC.SECMNT.div.9">
<Title>Field Descriptions</Title>
<Para>The following list describes each entry in the file <Literal>group_override</Literal>:
</Para>
<VariableList>
<VarListEntry>
<Term><Symbol Role="Variable">group_name</Symbol></Term>
<ListItem>
<Para>A keyfield that contains the name that identifies the group to which
the override applies.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">passwd</Symbol></Term>
<ListItem>
<Para>This field specifies the encrypted password.  If you specify an override
in this field, the password you enter is in effect for this local
machine only.
</Para>
<Para>The use of <Literal>OMIT</Literal> along with
an option to the <Command>passwd_export</Command> command prevents the inclusion
of this group in the group file created by the <Command>passwd_export</Command>
command.  This effectively disallows <Literal>newgrp</Literal> commands to this
group on the local machine.
(See Section 36.2.3.5 
<!-- titled "Using \*LOMIT\*O" later in this-->
for details.)
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">group_uid</Symbol></Term>
<ListItem>
<Para>A UNIX group ID.  This field can function as a keyfield when no other
keyfields are entered.  It can also function as a field containing
an override when entered along with <Symbol Role="Variable">group_name</Symbol>.  The <Symbol Role="Variable">group_uid</Symbol>
value specifies the local override of the group ID supplied by the network
registry server.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">members</Symbol></Term>
<ListItem>
<Para>This field specifies a comma-separated list of members of the group.
The contents of this field will override information in the registry
when the <Command>passwd_export</Command> command creates an <Filename>/etc/group</Filename> file.
Note that, to specify a null membership, as opposed to indicating that no
override is required, use an * (asterisk) for this field.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
</Sect3>
<Sect3 Id="AGCC.SECMNT.div.10">
<Title>Leaving Fields Blank</Title>
<Para>If you do not want to override an item, leave its field blank, separating
each blank field with a : (colon).  Note that, to override a group with
a null membership list, enter an asterisk for the <Symbol Role="Variable">members</Symbol> field.
</Para>
</Sect3>
<Sect3 Id="AGCC.SECMNT.div.11">
<Title>Using <Literal>OMIT</Literal></Title>
<Para>If you specify <Literal>OMIT</Literal> and issue a <Command>passwd_export</Command>
command with the <Option>x</Option> option, then the named group will not appear in
the <Filename>/etc/group</Filename> file produced by the <Command>passwd_export</Command> command.
Subsequent to this, users will not be able to issue a <Literal>newgrp</Literal> command
to this group on the local machine.
</Para>
<Para>The <Command>ls</Command> command is likewise affected.  For example, the following
command accesses the group file to obtain additional information about
a group:  
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>ls -lg
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>If the group is omitted, no group entry will exist and no
information will be available.  For this reason, you should use
<Literal>OMIT</Literal> to omit groups from file <Filename>/etc/group</Filename> only if your
user community is very large and either of the following conditions
occur:
</Para>
<ItemizedList>
<ListItem>
<Para>The group file is taking up too much space.
</Para>
</ListItem>
<ListItem>
<Para>Group ID-to-name mapping is too slow (during an <Literal>ls -lg</Literal> command,
for example).
</Para>
</ListItem>
</ItemizedList>
</Sect3>
<Sect3 Id="AGCC.SECMNT.div.12">
<Title>Examples</Title>
<Para>To override the group ID of group <Command>kmem</Command> to be <Literal>3</Literal>,
use the following entry:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>kmem::3:
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>To override the group password and membership for group <Literal>system</Literal> to the
single account <Literal>root</Literal>, use the following entry:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>system:*::root
</UserInput></ProgramListing></Para>
</InformalExample>
</Sect3>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.13">
<Title>Creating Override File Entries</Title>
<IndexTerm Id="AGCC.SECMNT.indx.11">
<Primary>password</Primary>
<Secondary>overriding</Secondary>
</IndexTerm>
<Para>To
create override file entries, edit the <Filename>passwd_override</Filename> file
and supply the override entries.  The entry must identify the account (or 
accounts) to which the override applies by specifying one of the following
keyfields:
</Para>
<VariableList>
<VarListEntry role="linebreak">
<Term><Symbol Role="Variable">principal_name</Symbol></Term>
<ListItem>
<Para>The name of the specific principal to which to apply 
the overrides.  The override applies only to the account for the principal's 
primary name.  For example, if you specify <Literal>mahler</Literal> as the principal
name in an override entry, the overrides apply only to principal <Literal>mahler</Literal>'s
account, and not to any accounts for <Literal>mahler</Literal>'s aliases.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Symbol Role="Variable">principal_uid</Symbol></Term>
<ListItem>
<Para>A UNIX ID that identifies the accounts to which to
apply the override if <Symbol Role="Variable">principal_name</Symbol> is not specified.  The override
is applied to all accounts for the principal that is identified by 
<Symbol Role="Variable">principal_uid</Symbol>, including any accounts for the principal's aliases.  
For example, suppose that principal <Literal>mahler</Literal> has a UNIX ID of <Literal>2195</Literal>.  
If you specify <Literal>2195</Literal> as the key of the entry, the overrides apply to all 
accounts that are associated with that UNIX ID.  Because a principal's
primary name and aliases carry the same UNIX ID, this means that the
overrides apply to accounts for the principal's primary name and all aliases.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Symbol Role="Variable">group_uid</Symbol></Term>
<ListItem>
<Para>A UNIX ID that identifies the group to 
which to apply the overrides if neither <Symbol Role="Variable">principal_name</Symbol> nor
<Symbol Role="Variable">principal_uid</Symbol> are specified.  The overrides are applied to all accounts
for all principals that are members of the identified group.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
<Para>The <Symbol Role="Variable">principal_name</Symbol> field always acts as the keyfield and cannot be
overridden.  If you enter <Symbol Role="Variable">principal_name</Symbol>, it identifies the specific
account to be overridden.  The <Symbol Role="Variable">principal_uid</Symbol> or the <Symbol Role="Variable">group_uid</Symbol>
field can act as the keyfield or they can act as override fields.  Only one
of the possible keyfields is used as a key for any one entry; the others
(if entered) are used as override fields.  The <Symbol Role="Variable">principal_name</Symbol> field 
takes precedence, followed by <Symbol Role="Variable">principal_uid</Symbol>, and finally
<Symbol Role="Variable">group_uid</Symbol>. 
</Para>
<Para><?sml-need 4>For example, if you enter <Symbol Role="Variable">principal_uid</Symbol> and <Replaceable>do not</Replaceable> enter
<Symbol Role="Variable">principal_name</Symbol>, <Symbol Role="Variable">principal_uid</Symbol> is used as the keyfield.  If you
enter <Symbol Role="Variable">principal_uid</Symbol> and <Symbol Role="Variable">principal_name</Symbol>, <Symbol Role="Variable">principal_name</Symbol> is
used as the keyfield and <Symbol Role="Variable">principal_uid</Symbol> is used as an override field. 
</Para>
<Para>If you enter the <Symbol Role="Variable">group_uid</Symbol> field and <Replaceable>do not</Replaceable> enter any other
keyfields (<Symbol Role="Variable">principal_name</Symbol> or <Symbol Role="Variable">principal_uid</Symbol>), <Symbol Role="Variable">group_uid</Symbol>
is used as the keyfield, and the overrides apply to the accounts of all
members of the group.  If you enter <Symbol Role="Variable">principal_name</Symbol> and <Symbol Role="Variable">group_uid</Symbol>,
<Symbol Role="Variable">principal_name</Symbol> is used as the keyfield, and the group affiliation of
the named principal is overridden by the group that is identified by the
group UNIX ID.
<!-- .nS note-->
<!-- The UNIX \*Lchpass\*O command that changes account information is -->
<!-- modified to allow users to modify not only their registry entries -->
<!-- but entries in the \*Lpasswd_override\*O file as well.  (See -->
<!-- the section titled "Overrides and Commands to Change Account Information" -->
<!-- Section 24.3.12 for more information.)-->
<!-- .nE -->
</Para>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.14">
<Title>Leaving passwd_override File Fields Blank</Title>
<Para>If you do not want to override an item in the <Filename>passwd_override</Filename> file, 
leave its field blank, separating each blank field with a : (colon).  You
must enter one of the keyfields, however, to identify the principal or 
group for which you are creating overrides.  For example, an entry to override
the home directory for the account identified by <Literal>mozart</Literal> looks like
this:  
</Para>
<InformalExample>
<Para><ProgramListing>mozart:::::/aria/wolfgang:
</ProgramListing></Para>
</InformalExample>
<Para>You must enter the colons that are associated with any blank
trailing fields.  In the preceding example, a colon is required for the
shell field, which is the remaining field after the home directory field. 
</Para>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.15">
<Title>Specifying Passwords for a Specific Machine</Title>
<Para>Manually edit the password entry in the <Filename>passwd_override</Filename>
file on the local machine to create an entry in the
override file to override passwords on the local machine.
The password that you enter must be encrypted,
but you can copy the encrypted password from the <Filename>/etc/passwd</Filename>
file or you can write a program that generates encrypted passwords. 
</Para>
<Para><?sml-need 7>When you override a principal's password, only the principal's local 
credentials are obtained at login, not the principal's network credentials.  
Without network credentials, the principal cannot access the  
network registry and obtain the information that is normally 
provided at network login.  Therefore, you must supply all of this information 
in the <Filename>password_override</Filename> file entry.  For overrides to passwords,
you must enter all of the fields in the override entry, including all
keyfields. 
</Para>
<Para>The following example shows a <Filename>passwd_override</Filename> file entry
that changes a specific machine's password for user <Literal>mozart</Literal>'s 
account: 
</Para>
<InformalExample>
<Para><ProgramListing role="page-wide"><?sml-point-size 10>mozart:sq1Rc1Urrb1L6:678:893:Wolfgang A.  Mozart:/aria/wolfgang:/bin/csh 
<?sml-point-size 12></ProgramListing></Para>
</InformalExample>
<Note>
<Para>If your password is overridden and you then use <Command>rlogin</Command> or <Command>rsh</Command> to 
log in remotely to the machine with the overrides, you are prompted for a 
password, regardless of what is in either the <Filename>/etc/hosts.equiv</Filename> or
<Literal>.rhosts</Literal> file. 
</Para>
</Note>
<IndexTerm Id="AGCC.SECMNT.indx.12" SpanEnd="AGCC.SECMNT.indx.11">
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.16">
<Title>Preventing Login to a Machine</Title>
<IndexTerm Id="AGCC.SECMNT.indx.13">
<Primary>login</Primary>
<Secondary>preventing</Secondary>
</IndexTerm>
<Para>To prevent users from logging into a machine, create an override
entry with an invalid string in the <Command>passwd</Command> field.  Because
the <Command>passwd</Command> field contains an encrypted password, any character
string that is not exactly 13 characters in length can be used as
an invalid password.  For example, the following entry in the 
<Filename>passwd_override</Filename> file supplies <Command>exclude</Command> as a password.   
This string of less than 13 characters prevents members of the group
that is identified by a UNIX ID of <Literal>25</Literal> from logging in.
</Para>
<InformalExample>
<Para><ProgramListing>:exclude::25:::
</ProgramListing></Para>
</InformalExample>
<?sml-break>
<?sml-need 12>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.17">
<Title>Omitting Users from the Local Password Files</Title>
<IndexTerm Id="AGCC.SECMNT.indx.14">
<Primary><Literal>OMIT</Literal> entry</Primary>
<Secondary>in <Filename>passwd_override</Filename> file</Secondary>
</IndexTerm>
<Para>An invalid password entry in the <Filename>passwd_override</Filename> file prohibits
users from logging into the machine on which the file exists.  However,
the invalid entry <Literal>OMIT</Literal> has a special meaning.  Just as with
any other invalid password, if you enter <Literal>OMIT</Literal>, the user cannot
log in.  Additionally, however, if you maintain the standard
<Filename>/etc/passwd</Filename> and <Filename>/etc/group</Filename> files and used the <Command>passwd_export</Command>
command to keep these files consistent with the registry database,
you can specify that users with a password of<Literal> OMIT</Literal> be excluded
from the <Filename>/etc/passwd</Filename> file.  (See 
<!-- "Ensuring Consistent Local Files" later in this chapter -->
Section 36.7 for more information on the <Command>passwd_export</Command> command.)
</Para>
<Para>Also, be aware that, if you have omitted users from the <Filename>/etc/passwd</Filename>
file, information about those users is not available to any programs
that use the password file.  For example, the <Literal>ls -l</Literal> and the
<Command>finger</Command> commands both access the password file to obtain further
information about a user identified by a UNIX ID.  If the user is
omitted, no password entry exists and no information is available on
that user. 
</Para>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.18">
<Title>Specifying a Home Directory and Login Shell for a Machine</Title>
<IndexTerm Id="AGCC.SECMNT.indx.15">
<Primary>login</Primary>
<Secondary>changing defaults</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.16">
<Primary>login shells</Primary>
<Secondary>overriding</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.17">
<Primary>directories</Primary>
<Secondary>overriding default</Secondary>
</IndexTerm>
<Para>To change an account's home directory and login shell for a specific
machine, create an override entry with a home directory name and a
login shell name.  For example, the following entry changes the home
directory and login shell for user <Literal>mozart</Literal>'s account:
</Para>
<InformalExample>
<Para><ProgramListing>mozart:::::rondo/mozart:/bin/ksh
</ProgramListing></Para>
</InformalExample>
<?sml-break>
<?sml-need 12>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.19">
<Title>Overriding a Principal's Group Affiliation</Title>
<IndexTerm Id="AGCC.SECMNT.indx.18">
<Primary>principals</Primary>
<Secondary>overriding group memberships</Secondary>
</IndexTerm>
<Para>To override a principal's group affiliation, create an override entry that 
contains the principal's name or UNIX ID as a key and the UNIX ID of the 
group that is to be used as the override.  Use the principal's name as a key
to apply the overrides only to the account for the principal's primary name.  
Use the principal's UNIX ID as a key to apply the overrides to all of the
principal's accounts, including any accounts for the principal's
aliases.  For example, the following entry overrides the group 
that is normally associated with the account for principal <Literal>mozart</Literal>:
</Para>
<InformalExample>
<Para><ProgramListing>mozart:::356:::
</ProgramListing></Para>
</InformalExample>
<Para>This override does not apply to any accounts for any of <Literal>mozart</Literal>'s 
aliases.  To apply the overrides to those accounts, the entry must 
be keyed by <Literal>mozart</Literal>'s UNIX ID (<Literal>567</Literal>), as follows: 
</Para>
<InformalExample>
<Para><ProgramListing>::567:356:::
</ProgramListing></Para>
</InformalExample>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.20">
<Title>Applying Overrides to All Members of a Group</Title>
<IndexTerm Id="AGCC.SECMNT.indx.19">
<Primary>groups</Primary>
<Secondary>overriding memberships</Secondary>
</IndexTerm>
<Para>To apply overrides to all members of a specific group, create an override
entry that contains the group's UNIX ID as a key and the items to override.  
For groups, you can override passwords, GECOS information, home directories,
and shells.  For example, the following entry makes <Filename>/sonata/piano</Filename>
the home directory for all members of the group that is identified by UNIX ID
<Literal>356</Literal>:
</Para>
<InformalExample>
<Para><ProgramListing>:::356::/sonata/piano:
</ProgramListing></Para>
</InformalExample>
<Para>Be sure not to include the <Symbol Role="Variable">principal_name</Symbol> or <Symbol Role="Variable">principal_uid</Symbol> 
keyfields.  If you do, the principal name or UNIX ID that you supply will be
used as a keyfield, and the group UNIX ID will be used to override that
principal's group affiliations.
</Para>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.21">
<Title>How passwd_override Handles Multiple Override Entries</Title>
<Para>When more than one override entry applies to an account, the entry
with the most specific account identifier (that is, either a principal UNIX ID,
a group UNIX ID, or a principal name) is selected.  Principal names are
the most specific, followed by the principal UNIX ID and group UNIX ID.
</Para>
<Para>For example, assume that the override file contains the following two entries
that override the login shells:
</Para>
<InformalExample>
<Para><ProgramListing>mozart::::::/bin/ksh
:::25:::/bin/csh
</ProgramListing></Para>
</InformalExample>
<Para>If a principal logs in as <Literal>mozart</Literal>, the override that is keyed by
<Literal>mozart</Literal> is in effect.  In this case, the principal (<Literal>mozart</Literal>)
is more specific than the group (<Literal>25</Literal>). 
<!-- .H 3 "Overrides and Commands to Change Account Information"-->
<!-- .iX "Security Service commands" "\*Lchpass\*O"-->
<!-- .P-->
<!-- When you invoke the \*Lchpass\*O command to change user information, you-->
<!-- can supply an option (\*L-l\*O for local and \*L-n\*O for network)-->
<!-- that tells the system whether you want to change the information -->
<!-- that is stored in the network registry or in the local \*Lpasswd_override\*O-->
<!-- file, which is the file on the machine from which you execute the command.  If-->
<!-- you do not enter an option and overrides exist for the information-->
<!-- that you are changing, you are prompted to reinvoke the command with one-->
<!-- of the options.  If no overrides exist for the information that you are-->
<!-- changing, you are not required to enter an option.  The programs update-->
<!-- the registry by default.-->
<!-- .zA "enh,5923,R1.1,fix User Guide and Ref cross-refs"-->
<!-- (See the \*Lchpass\*O reference page-->
<!-- in the \*(Ar for details.) -->
<!-- .zZ "enh,5923,R1.1,fix User Guide and Ref cross-refs"-->
<IndexTerm Id="AGCC.SECMNT.indx.20" SpanEnd="AGCC.SECMNT.indx.2"><IndexTerm Id="AGCC.SECMNT.indx.21" SpanEnd="AGCC.SECMNT.indx.4"></Para>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.SECMNT.div.22">
<Title>Changing the Registry's Master Key</Title>
<IndexTerm Id="AGCC.SECMNT.indx.22">
<Primary>registry</Primary>
<Secondary>database</Secondary>
<Tertiary>changing master key</Tertiary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.23">
<Primary>master keys</Primary>
<Secondary>changing</Secondary>
</IndexTerm>
<Para>All passwords stored in a registry are encrypted by a master
key.  Note that the master key is created when you create the registry
database during system configuration.
</Para>
<Para>You can use the <Command>dcecp registry modify</Command> command with the <Option>key</Option> 
option to
change the registry's master key and to reencrypt all passwords with
the new master key.  Each replica
(master and slave) maintains its own master key to access the data in its
copy of the registry.  
</Para>
<Para>You should change each replica's master key on a regular basis.  Before you
run either program to do this, ensure that you are logged into an
administrative account.
</Para>
<Para RevisionFlag="Changed">The following command line changes the master key and reencrypts all the
passwords for the replica <Literal>art_server_1</Literal>:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">dcecp> <Literal>registry modify /.../giverny.com/subsys/dce/sec/art_server_1 -key</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output">
</Sect1>
<Sect1 Id="AGCC.SECMNT.div.23">
<Title>Validating the Authenticity of the DCE Security Service</Title>
<Para>The <Command>secval</Command> process within the DCE daemon can confirm that the
DCE security server is an authentic server.  An illegitimate DCE
security server could give a malicious user root access on a machine
by returning a counterfeit local system identity.  A <Command>secval ping</Command>
operation confirms the authenticity of the DCE security server by
performing an authenticated RPC to the <Command>secval</Command> process.  A
successful return (<Literal>1</Literal>) indicates that the security server used all of
the correct passwords needed for the authenticated RPC to succeed.
</Para>
<Para>You can perform a <Command>secval ping</Command> operation on the local host or you
can supply an argument to operate on a remote host.  Because remote
hosts might use different security servers, performing <Literal>secval
ping</Literal> operations on remote hosts provides a way to test the
authenticity of other security servers operating in a cell.
</Para>
<Para RevisionFlag="Changed">The following example illustrates a <Command>secval ping</Command> operation to the
<Command>secval</Command> process on remote host <Literal>charon</Literal>:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">dcecp> <Literal>secval ping /.:/hosts/charon/config/secval</Literal>
1
dcecp>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></ProgramListing></Para>
</InformalExample>
</Sect1>
<Sect1 Id="AGCC.SECMNT.div.24">
<Title>Backing Up and Restoring the Registry Database</Title>
<Para><IndexTerm Id="AGCC.SECMNT.indx.24">
<Primary>registry</Primary>
<Secondary>database</Secondary>
<Tertiary>backing up</Tertiary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.25">
<Primary>master keys</Primary>
<Secondary>backing up</Secondary>
</IndexTerm>Use the exact procedures
that are described here to back up the registry database to prevent 
backups from arriving at the master during the backup.
</Para>
<Para>Only the master replica database and its master key file need to be backed
up.  Use the procedures that are described in the following subsections 
when you back up the entire disk on which the master replica and its master
key are stored, and when you back up only the master's database files and
its master key file. 
</Para>
<Sect2 Id="AGCC.SECMNT.div.25">
<Title>Procedures for Backing Up the Registry Database</Title>
<Para>To run the backup procedures, ensure that you are logged into DCE via  
an administrative account.  Then, run the DCE control program to do the
backup.  The backup steps are as follows:
<IndexTerm Id="AGCC.SECMNT.indx.26">
<Primary>master keys</Primary>
<Secondary>backing up</Secondary>
</IndexTerm></Para>
<OrderedList>
<!-- .LI-->
<!-- Use the \*Ldcecp set\*O command to ensure that the subsequent commands will -->
<!-- bind to the master replica.  For example, to make the master replica in the cell -->
<!-- \*Lgiverny.com \*O the default replica for subsequent \*Ldcecp\*O commands, enter:-->
<!-- .iS-->
<!-- \*Cdcecp>\*O \*Lset  -s (sec)   /.../giverny.com/subsys/dce/sec/master\*O-->
<!-- \*Cdcecp-->
<!-- .iE-->
<!-- .P-->
<ListItem>
<Para RevisionFlag="Changed">Enter the <Command>registry disable</Command> command to set the master replica to the
maintenance state.  The following command sets the master registry in the cell 
<Filename>giverny.com </Filename> to maintenance state:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">dcecp> <Literal>registry disable  /.../giverny.com/subsys/dce/sec/oddball</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output">
<Para>Setting the master replica to the maintenance state causes the master to
save its database to disk and refuse all updates. 
</Para>
</ListItem>
<ListItem>
<Para>Back up the master registry by backing up either the entire volume 
or the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/rgy_data</Filename> tree (the registry)
and the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/.mkey</Filename> file, which is the file that
contains the master key used to encrypt all keys in the 
registry.  Note that, because the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/.mkey</Filename> 
file contains the master key, restoring a backup of the registry database is 
useless unless the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/.mkey</Filename> file is also 
restored.
</Para>
<Para>The exact commands that are used for the backup are a matter of personal
preference.  However, if you write both the database and the 
master key file to the same tape, store the tape in a locked area with
restricted access.  Alternatively, you can write the database and the key
file to separate tapes and store each tape in a different location.
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">When the backup completes, take the master replica out of maintenance
state, as follows:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">dcecp> <Literal>registry enable  /.../giverny.com/subsys/dce/sec/oddball</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output">
<Para>The security server resumes accepting updates.
</Para>
</ListItem>
</OrderedList>
<Para>Note that the previous examples supplied the name of the 
registry master site to the <Command>registry enable</Command> and 
<Command>registry disable</Command> commands.  If you do not supply a 
registry site name, the commands use 
the site named in the <Literal>_s(sec)</Literal> variable.  
If this variable is not set, the commands use the
master registry of the machine's default cell.  See Section 36.6
for more information.
</Para>
</Sect2>
<Sect2 Id="AGCC.SECMNT.div.26">
<Title>Procedure for Restoring the Registry Database</Title>
<Para><!-- .iX "-[" "registry" "database" "restoring"-->
<IndexTerm Id="AGCC.SECMNT.indx.27">
<Primary>master keys</Primary>
<Secondary>restoring</Secondary>
</IndexTerm>This section provides instructions for restoring the master replica's
database files and master key file.  The procedure assumes that the database 
is being restored to the same machine from which it was backed up, and that
you are using the DCE control program.  If you are moving the database to a
different machine, follow the instructions in Chapter 37.
<!-- Chapter 9 in the section titled "Moving the Master Registry."-->
</Para>
<Para>To restore the registry database to a machine, perform the following steps:
</Para>
<OrderedList>
<ListItem>
<Para>Log in as <Literal>root</Literal> at the master registry site. 
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">If <Command>secd</Command> is running, stop it by issuing the
<Command>registry stop</Command> command.  When you use this command, you must 
supply the fully qualified name of a specific replica as an argument.  
The following sample command stops the <Command>secd</Command>  named <Literal>master</Literal>:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">dcecp> <Literal>registry stop  /.../giverny.com/subsys/dce/sec/oddball</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output">
</ListItem>
<ListItem>
<Para>Copy the backup files from the backup media to the machine.  
If you have backed up only the registry data files and the master key files, 
be sure to copy the registry database to 
<Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/rgy_data</Filename> 
and the master key file to <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/.mkey</Filename>.  
Note that, because the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/.mkey</Filename> 
file contains the master key, restoring a backup of the registry database is 
useless unless the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/security/.mkey</Filename> file is also 
restored. 
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Restart the server by invoking <Command>secd</Command> with the <Literal>-restore_master</Literal> option, as follows:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing><UserInput><Symbol Role="Variable" RevisionFlag="Changed">dcelocal</Symbol><Literal RevisionFlag="Changed">/bin/secd -restore_master &amp;</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output">
<Para>This command starts <Command>secd</Command> and causes the master to mark all 
slaves to be reinitialized.  
</Para>
</ListItem>
<ListItem>
<Para>Verify that <Command>secd</Command> starts automatically at system startup. 
</Para>
</ListItem>
</OrderedList>
<?sml-space>
<Note>
<Para>If you are restoring <Symbol Role="Variable">only</Symbol> a 
master key file and have not changed the master key, 
you can simply copy the master key file from the backup media without 
performing all of the other steps that are in the restore procedures.
</Para>
</Note>
<!-- .iX "-]" "registry" "database" "restoring"-->
<!---->
</Sect2>
</Sect1>
<Sect1 Id="AGCC.SECMNT.div.27">
<Title>Setting the _s(sec) Variable</Title>
<!-- -->
<Para RevisionFlag="Changed">You can supply the name of the registry site to bind to as an argument to the 
<Command>dcecp</Command> commands that operate on the registry.  
If you do not supply a name, the command binds to the replica named in 
the <Literal>_s(sec)</Literal> variable.  If this variable is not 
set, the command binds to the cell's master replica.  
You can set the <Literal>_s(sec)</Literal> variable and then use that replica as 
the default replica for <Command>dcecp registry</Command> commands.   
To do so, use the <Literal>set</Literal> command as shown in the following 
sample that sets the default replica to the master replica 
(named <Literal>slave_3</Literal>) in the cell <Filename>giverny.com</Filename>:
<?og-ChangeStart def, 13575,R1.2.2,Added dcecp prompt at the end of all output"></Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">dcecp> <Literal>set _s(sec) /.../giverny.com/subsys/dce/sec/slave_3
</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<?og-ChangeEnd def, 13575,R1.2.2,Added dcecp prompt at the end of all output">
<Para>The name of the new default replica that you supply as an argument
to the <Literal>set</Literal> command can be in any of the following forms:
</Para>
<ItemizedList>
<ListItem>
<Para>A cell name (for example, <Filename>/.../dresden.com</Filename>)
</Para>
<Para>If you enter a 
cell name, the named cell becomes the default cell.  The DCE control
program randomly chooses a replica to bind to in the 
named cell, and that replica becomes the default replica. 
</Para>
</ListItem>
<ListItem>
<Para>The global name given to the replica when it was created (for example,
<Filename>/.../dresden.com/subsys/dce/sec/rs_server_250_2</Filename>)
</Para>
<Para>A global 
name identifies a specific replica in a specific cell.  That cell becomes the 
default cell, and that replica becomes the default replica.  
</Para>
</ListItem>
<ListItem>
<Para>The replica's name as it appears on the replica list of the current default 
replica (that is, its cell-relative 
name; for example, <Literal>subsys/dce/sec/rs_server_250_2</Literal>)
</Para>
<Para>That 
replica becomes the default replica, and 
the cell in which the replica exists becomes the default cell.  
</Para>
</ListItem>
<ListItem>
<Para>The network address of the host on which the replica is running (for example, 
<Literal>ncadg_ip_udp:15.22.144.248</Literal>)
</Para>
<Para>The replica on that host becomes
the default replica, and the cell in which the host exists becomes the
default cell.  
</Para>
</ListItem>
</ItemizedList>
<Para RevisionFlag="Changed"><?og-ChangeStart def, 13575,R1.2.2,Fixed paragraph"><?sml-need 9>Some of the <Command>dcecp</Command> commands can act only on the 
master replica and thus require binding to the master.  
If you execute a 
command that acts only on the master and the master is not the 
default replica, in most cases <Command>dcecp</Command> automatically attempts to bind to 
the 
master replica in the current default cell.   In
other cases, <Command>dcecp</Command> displays an error message, and the command 
fails. 


<?og-ChangeEnd def, 13575,R1.2.2,Fixed paragraph"></Para>
</Sect1>
<Sect1 Id="AGCC.SECMNT.div.28">
<Title>Ensuring Consistent Local Files</Title>
<Para><IndexTerm Id="AGCC.SECMNT.indx.28">
<Primary>security</Primary>
<Secondary>commands</Secondary>
<Tertiary><Command>passwd_export</Command></Tertiary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.29">
<Primary><Filename>/etc/passwd</Filename> file</Primary>
</IndexTerm>
<IndexTerm Id="AGCC.SECMNT.indx.30">
<Primary><Filename>/etc/group</Filename> file</Primary>
</IndexTerm>The <Command>passwd_export</Command> command makes the standard <Filename>/etc/passwd</Filename>
and <Filename>/etc/group</Filename> files on the local machine consistent with
the registry database.  Run the <Command>passwd_export</Command> command on
a regular, but staggered, basis preferably as part of <Command>cron</Command>
processing.  If <Command>passwd_export</Command> succeeds in creating the new
password and group files, it saves the current files as backups that
are named <Filename>passwd.bak</Filename> and <Filename>group.bak</Filename>.  If it fails,
it leaves the current files as is. 
</Para>
<Para>The <Command>passwd_export</Command> command has the following syntax:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>passwd_export [<Option>n</Option>][<Option>d</Option><Symbol Role="Variable"> directory_name</Symbol>] [<Option>x</Option>] [<Option>m</Option> <Symbol Role="Variable">max_entries</Symbol>] [<Option>s</Option>] | [<Option>h</Option>[<Literal>elp</Literal>] [<Option>v</Option>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>where:
</Para>
<VariableList>
<VarListEntry>
<Term><Option>n</Option></Term>
<ListItem>
<Para>Specifies that <Filename>passwd_override</Filename> and <Literal>group_override</Literal>
file entries should be ignored.  
Without this flag, <Command>passwd_export</Command> applies the 
override entries from both files
to the local password and group files that it creates. 
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Option>d</Option> <Symbol Role="Variable">directory_name</Symbol></Term>
<ListItem>
<Para>Specifies the name of a directory in which to store the local password and
group files that are created by <Command>passwd_export</Command>.  If you do not enter
this option, the files are stored by default in the <Filename>/etc</Filename> directory on
the local node.  
</Para>
<Para><?sml-need 4>For example, to store the files in the directory
that is called <Filename>/etc/locals</Filename>, enter the command in the following form:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput><Symbol Role="Variable">dceshared</Symbol><Literal>/bin/passwd_export -d/etc/locals
</Literal></UserInput></ProgramListing></Para>
</InformalExample>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>x</Option></Term>
<ListItem>
<Para>Prohibits the creation of entries for users with password or group
overrides (on the local machine) that specify<Literal> OMIT</Literal> as their
encrypted password.  Use the <Option>x</Option> option to exclude omitted
users or groups from the password and group files that are
created by <Command>passwd_export</Command>.  To
omit a user, you must create an override entry for the user and enter
the word<Literal> OMIT</Literal> as the user's password field entry.  Omitted
users are unable to log into the local machine.  (See 
<!-- the section titled "Omitting Users from the Local Password Files.")-->
Section 36.2.8.)
To omit a group, create an override entry for the group and enter the
word <Literal>OMIT</Literal> as the group's password field entry.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Option>m</Option><Symbol Role="Variable"> max_entries</Symbol></Term>
<ListItem>
<Para>Sets the maximum number of registry
entries that are put in the <Filename>/etc/passwd</Filename> and /<Filename>etc/group</Filename>
files.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>s</Option></Term>
<ListItem>
<Para>Sorts the entries in the<Filename> /etc/passwd</Filename> and
/<Filename>etc/group</Filename> files by UNIX number.  If this option is not specified,
the entries are in the random order in which they are retrieved from
the registry.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>h[elp]</Option></Term>
<ListItem>
<Para>Displays help information. 
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>v</Option></Term>
<ListItem>
<Para>Runs in verbose mode.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
<IndexTerm Id="AGCC.SECMNT.indx.31" SpanEnd="AGCC.SECMNT.indx.28">
<IndexTerm Id="AGCC.SECMNT.indx.32" SpanEnd="AGCC.SECMNT.indx.1">
</Sect1>
</Chapter>
<!--+ 10/31/96 16:05:54
    | tagMorph:  $Id: 8_maint.sgm,v 1.1.2.10 1996/12/04 22:49:21 carrig Exp $
    | tagMorph library:  $Id: 8_maint.sgm,v 1.1.2.10 1996/12/04 22:49:21 carrig Exp $
    | sml-to-docbook:  1.24
    +-->
