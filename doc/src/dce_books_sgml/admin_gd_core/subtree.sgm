<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: subtree.sgm,v $
# Revision 1.1.2.10  1996/12/04  22:49:52  carrig
# 	{enh,R1.2.2}
# 	JC's edits
# 	[1996/12/04  22:47:50  carrig]
#
# Revision 1.1.2.9  1996/11/29  20:21:24  carrig
# 	{enh,R1.2.2}
# 	Finished edit changes; must scale graphics
# 	[1996/11/29  20:18:17  carrig]
# 
# Revision 1.1.2.8  1996/11/27  21:44:07  carrig
# 	{enh,R1.2.2}
# 	More editor's comments
# 	[1996/11/27  21:42:21  carrig]
# 
# 	{enh,R1.2.2}
# 	More editor's comments
# 	[1996/11/27  21:29:13  carrig]
# 
# Revision 1.1.2.7  1996/11/26  21:45:43  carrig
# 	{enh,R1.2.2}
# 	Putting in editor's comments
# 	[1996/11/26  21:41:40  carrig]
# 
# Revision 1.1.2.6  1996/11/25  21:51:46  carrig
# 	{enh,R1.2.2}
# 	Started to put in editor's comments
# 	[1996/11/25  21:50:06  carrig]
# 
# Revision 1.1.2.5  1996/11/07  20:44:00  weir
# 	Cleaned up history
# 	[1996/11/07  20:42:12  weir]
# 
# Revision 1.1.2.4  1996/11/06  20:41:14  carrig
# 	{enh,R1.2.2}
# 	OK for editing
# 	[1996/11/06  20:38:48  carrig]
# 
# Revision 1.1.2.3  1996/11/05  18:59:21  carrig
# 	{enh,R1.2.2}
# 	Second pass
# 	[1996/11/05  18:56:18  carrig]
# 
# Revision 1.1.2.2  1996/11/04  22:04:15  carrig
# 	{enh,R1.2.2}
# 	First pass at corrections
# 	[1996/11/04  22:01:00  carrig]
# 
# Revision 1.1.2.1  1996/11/01  18:21:14  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 	[1996/11/01  18:18:30  wardr]
# 
# Revision 1.1.1.2  1996/11/01  18:18:30  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 
# $EndLog$
-->
<!---->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
<!ENTITY AGCC.CDSSBT.ent.1 SYSTEM "eps/subtree_namespace.ps" NDATA eps>
<!ENTITY AGCC.CDSSBT.ent.2 SYSTEM "eps/subtree_merge.ps" NDATA eps>
<!ENTITY AGCC.CDSSBT.ent.3 SYSTEM "eps/subtree_append.ps" NDATA eps>
]>
-->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993, 1994 Open Software Foundation, Inc.-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE for-->
<!-- the full copyright text.-->
<!-- -->
<!-- -->
<!-- HISTORY-->
<!-- Revision 1.1.4.1  1996/09/19  15:01:02  sherman-->
<!-- 	{def,13575,R1.2.2}-->
<!-- 	Miscellaneous dcecp fixes-->
<!-- 	[1996/09/19  15:00:27  sherman]-->
<!---->
<!-- Revision 1.1.2.11  1995/05/25  19:04:06  rcb-->
<!-- 	PRENTICE HALL reformat: final changes-->
<!-- 	[1995/05/25  13:15:05  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat - index entries, odds and ends-->
<!-- 	[1995/03/27  19:49:58  rcb]-->
<!-- -->
<!-- 	prevented hyphenation of option names-->
<!-- 	[1995/03/09  15:01:02  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat-->
<!-- 	[1995/03/01  15:52:33  rcb]-->
<!-- -->
<!-- 	incoroporated 1.1 edits-->
<!-- 	[1995/03/01  14:39:20  rcb]-->
<!-- -->
<!-- Revision 1.1.2.10  1994/10/19  20:56:44  wardr-->
<!-- 	{edit R1.1}-->
<!-- 	Final GA release edits-->
<!-- 	[1994/10/19  20:55:15  wardr]-->
<!-- -->
<!-- Revision 1.1.2.9  1994/10/14  18:38:06  steto-->
<!-- 	{edt, R1.1, Incorporated review comments.}-->
<!-- 	[1994/10/14  18:37:35  steto]-->
<!-- -->
<!-- Revision 1.1.2.8  1994/09/14  15:40:06  steto-->
<!-- 	{enh, CR 10014, R1.1, Inc'd. add'l. engineer's comments.}-->
<!-- 	[1994/09/14  15:39:34  steto]-->
<!-- -->
<!-- Revision 1.1.2.7  1994/09/06  21:35:15  steto-->
<!-- 	{enh, CR10014, R1.1, Prepared for final review.}-->
<!-- 	[1994/09/06  21:34:53  steto]-->
<!-- -->
<!-- Revision 1.1.2.6  1994/08/19  22:13:51  steto-->
<!-- 	[enh, CR10014, R1.1, Changed for final review.}-->
<!-- 	[1994/08/19  22:13:29  steto]-->
<!-- -->
<!-- Revision 1.1.2.5  1994/06/28  20:25:47  steto-->
<!-- 	{CR10014,R1.1}-->
<!-- 	Updated the chapter so procedures use dcecp instead of cdscp.  Was an extensive rewrite because dcecp does not use a temp or log file and recovery is different.  Also, dcecp does not preserve the source object ACLs, therefore these have to be recreated at the target.-->
<!-- 	[1994/06/28  20:25:20  steto]-->
<!-- -->
<!-- Revision 1.1.2.4  1994/06/13  17:24:18  devobj-->
<!-- 	cr10872 - fix copyright-->
<!-- 	[1994/06/13  17:24:06  devobj]-->
<!-- -->
<!-- Revision 1.1.2.3  1994/05/24  11:36:18  wardr-->
<!-- 	{edit R1.1}-->
<!-- 	fixed build problem-->
<!-- 	[1994/05/24  11:35:36  wardr]-->
<!-- -->
<!-- Revision 1.1.2.2  1994/05/13  19:16:03  rjohnson-->
<!-- 	Changes made: Changed names of figure files-->
<!-- 	File name: admin_gd/directory/cds/subtree.gpsml-->
<!-- 	CR#: 10606-->
<!-- 	[1994/05/13  19:15:44  rjohnson]-->
<!-- -->
<!-- Revision 1.1.2.1  1994/05/12  13:32:45  rjohnson-->
<!-- 	Changes made: New subtree chapter-->
<!-- 	File name: admin_gd/directory/cds/subtree.gpsml-->
<!-- 	CR#: 10606-->
<!-- 	[1994/05/12  13:32:24  rjohnson]-->
<!-- -->
<Chapter Id="AGCC.CDSSBT.div.1">
<Title>Using the CDS Subtree Commands to Restructure CDS Directories</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.1">
<Primary>merging CDS directories</Primary>
<Secondary>overview</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.CDSSBT.indx.2">
<Primary>directories</Primary>
<Secondary>merging</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.CDSSBT.indx.3">
<Primary>subtrees</Primary>
<Secondary>merging</Secondary>
</IndexTerm>Sometimes, because of corporate restructuring or for other reasons, you 
need to combine or rearrange various directories or subtrees of
directories in your CDS namespace.
</Para>
<Para>For example, suppose the engineering group in your
organization, <Filename>/.:/eng</Filename>, is combined with the research and development
group, <Filename>/.:/rnd</Filename>, and that the two groups begin to share a
common set of applications and other network resources.  You can reflect
this organizational change in your namespace hierarchy by merging the
contents of these directories.
</Para>
<Para>Similarly, if the engineering group becomes subordinate to the research
and development group, you can reflect this change by creating an empty
directory named 
<Filename>/.:/rnd/eng</Filename>
and then merging the contents of the
<Filename>/.:/eng</Filename>
directory into
<Filename>/.:/rnd/eng</Filename>,
effectively appending
<Filename>/.:/eng</Filename>
below
<Filename>/.:/rnd</Filename>.
</Para>
<Sect1 Id="AGCC.CDSSBT.div.2">
<Title>Overview of the Merge and Append Procedures</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.4">
<Primary>merging</Primary>
<Secondary>overview of procedure</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.CDSSBT.indx.5">
<Primary>interim file</Primary>
</IndexTerm>To merge or append CDS directories, you use the DCE control program
(<Command>dcecp</Command>) <Command>directory merge</Command> command.  The basic steps for both
procedures are as follows:
</Para>
<OrderedList>
<ListItem>
<Para>At your system prompt, enter <Command>dcecp</Command> to invoke the DCE control program.
</Para>
</ListItem>
<ListItem>
<Para>Merge or append one existing directory with another existing
directory.  To do this, use the <Command>directory merge</Command> command
to combine the directory's information about its descendants (object
entries, soft links, and child directories) with
another directory's information or to append the information below
an existing bottom-level directory.
</Para>
</ListItem>
<ListItem>
<Para>Delete the source directory or subtree (and its contents) that you merged
in step 2 from its old location in the hierarchy by using the
<Command>directory delete</Command> command.  Replace the deleted directory information
with a single soft link of the same name to redirect lookups of the
information at the new location by using the <Command>link create</Command> command.
</Para>
</ListItem>
</OrderedList>
<Note>
<Para>The presence of clearinghouses, duplicate names, or
unreachable names in a merged directory requires special handling.
The <Literal>merge</Literal> and <Literal>append</Literal> operations described in the following
sections assume that no duplicate names exist in the source and target
directory or subtree, and that the clearinghouses that store the master
replicas of affected directories are enabled and reachable at the time the
operations are initiated.
</Para>
</Note>
<Para>The example <Literal>merge</Literal> and <Literal>append</Literal>
operations described in this section are
based on an example namespace, shown in the following figure. 
</Para>
<?sml-need 2.25i>
<Figure>
<Title>Example Namespace Hierarchy</Title>
<Graphic Entityref="AGCC.CDSSBT.ent.1"></Graphic>
</Figure>
<?sml-space .5>
<Para>The example namespace consists of two directories under
the root:
<Filename>/.:/eng</Filename>
and
<Filename>/.:/rnd</Filename>.
The source directory
(<Filename>/.:/eng</Filename>)
contains two entries:
<Filename>/.:/eng/obj1</Filename> and
<Filename>/.:/eng/link1</Filename>.
The target directory
(<Filename>/.:/rnd</Filename>)
also contains two entries:
<Filename>/.:/rnd/obj2</Filename> and
<Filename>/.:/rnd/link2</Filename>.
</Para>
</Sect1>
<Sect1 Id="AGCC.CDSSBT.div.3">
<Title>Merging CDS Directories</Title>
<Para RevisionFlag="Changed"><?og-ChangeStart def,13575,R1.2.2,Replaced command with operation">
<IndexTerm Id="AGCC.CDSSBT.indx.6">
<Primary>CDS</Primary>
<Secondary>merging directories</Secondary>
</IndexTerm>The following procedure merges the source directory
<Filename>/.:/eng</Filename>
into the target directory
<Filename>/.:/rnd</Filename>:
</Para>
<OrderedList>
<ListItem>
<Para RevisionFlag="Changed">Perform a skulk on the <Filename>/.:/eng</Filename> directory before merging it with the
<Filename>/.:/rnd</Filename> directory.  This synchronization of the source directory's
replicas can prevent errors that cause the merge operation to fail.
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory synchronize  /.:/eng</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Run the <Command>directory merge</Command> command to merge the <Filename>/.:/eng</Filename> and
<Filename>/.:/rnd</Filename> directories:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory merge  /.:/eng  -into  /.:/rnd</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">Note that the <Command>directory merge</Command> command merges only the immediate
contents of the source directory named in the command-line argument 
(that is, the object entries, soft links, and child directories
in these directories).
</Para>
<Para RevisionFlag="Changed"><?sml-need 6>To copy the descendants of any child directories of
a directory to a target location, you must use
the <Option>tree</Option> option of the command.  For example,
if the <Filename>/.:/eng</Filename> directory in the previous example included the child
directories <Literal>dev</Literal> and <Literal>qa</Literal>, and you wanted to merge the contents
of these directories into the target directory <Filename>/.:/rnd</Filename>, you would
enter the following command line:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory merge  /.:/eng  -into  /.:/rnd  -tree</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">By default, the <Command>directory merge</Command> command places all object entries,
soft links, and child directories in the target directory's master
clearinghouse.  You can, however, place child directories in another
clearinghouse.  To do this, you use the <Option>clearinghouse</Option> option
of the command to specify the name of the other clearinghouse.
</Para>
<Para RevisionFlag="Changed">Note that you are allowed to specify only one alternate clearinghouse in the
<Option>clearinghouse</Option> option.  If you wish to place child directories in
different alternate clearinghouses, you must issue separate
<Command>directory merge</Command> commands for each clearinghouse, or you must issue
a single <Command>directory merge</Command> command to place all the child directories
in one clearinghouse, then relocate the directories after
the merge operation.
</Para>
<Note>
<Para RevisionFlag="Changed">The CDS objects created by the <Command>directory merge</Command> command
retain all of the writable attribute values and some of the read-only attribute
values of the source objects.  However, these objects do not
inherit the ACLs of the source objects.  If the merged object is a directory,
the <Command>directory merge</Command> command gives it the default ACLs of the
initial container.  If the merged object is any other CDS object type, the
<Command>directory merge</Command> command gives it the default ACLs of the initial object.
</Para>
</Note>
<Para RevisionFlag="Changed">If the <Command>directory merge</Command> command encounters problems with the merge
operation, it behaves in one of two ways.  If you include the 
<Option>nocheck</Option> option, the command does not check for errors before
performing the operation.  It proceeds immediately to perform
the operation, and, if it encounters an error, stops.
If you omit the <Option>nocheck</Option> option, the command checks 
for certain error conditions
before starting the merge.  If it finds errors, it displays messages
for the errors and stops; otherwise, it proceeds
with the merge.
</Para>
<Para RevisionFlag="Changed"><?sml-need 6>Error messages returned by the <Command>directory merge</Command> command identify
the CDS entity causing the problem and provide a brief description of
the problem.  You should fix any problems that the command encounters,
before running it again.  (See
Section 20.3 for more information on the types of errors that can occur
during a merge operation.)
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">After the merge operation, the <Filename>/.:/eng</Filename>
directory (and its contents) still exists at the source location.  Run the
following commands to delete the <Filename>/.:/eng</Filename> directory from its original
location and create a soft link named <Filename>/.:/eng</Filename> in place of the deleted
directory.  The soft link will redirect lookups of the <Literal>obj1</Literal> and
<Literal>link1</Literal> object entries to their new locations in the <Filename>/.:/rnd</Filename>
directory.
</Para>
<Para RevisionFlag="Changed">It is recommended that you perform a skulk on a source
directory before deleting it.  This synchronization of the directory's
replicas can prevent errors that cause the delete operation to fail.
</Para>
<Para RevisionFlag="Changed">The sequence of commands to synchronize and delete the <Filename>/.:/eng</Filename> directory
and then create soft links for the former contents are as follows:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory synchronize  /.:/eng</Literal>
dcecp> <Literal>directory delete  /.:/eng  -tree</Literal>
dcecp> <Literal>link create  /.:/eng  -to  /.:/rnd
</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">The <Command>directory delete</Command> command invoked with the <Option>tree</Option> option deletes
a directory and all the object entries, soft links, and
child directories beneath that directory.  If you use the
the <Command>directory delete</Command> command without the <Option>tree</Option> option, all of
the directories to be deleted must be empty, or errors will occur.
</Para>
<Para RevisionFlag="Changed">Figure 20-2 shows the structure of the example namespace before and 
after the merge operation in our example.
</Para>
<?sml-need 2.5i>
<Figure>
<Title RevisionFlag="Changed">Example Namespace Before and After the Merge Operation</Title>
<Graphic Entityref="AGCC.CDSSBT.ent.2" Scalefit="1" Reprodep="350" Reprowid="350"></Graphic>
</Figure>
<?sml-space .5>
</ListItem>
</OrderedList>
<Sect2 Id="AGCC.CDSSBT.div.4">
<Title RevisionFlag="Changed">Appending CDS Directories</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.7">
<Primary RevisionFlag="Changed">CDS</Primary>
<Secondary RevisionFlag="Changed">appending directories</Secondary>
</IndexTerm>The following procedure appends the source directory
<Filename RevisionFlag="Changed">/.:/eng</Filename> to the <Filename RevisionFlag="Changed">/.:/rnd</Filename> directory
(that is, copies the <Filename RevisionFlag="Changed">/.:/eng</Filename>
directory into the empty target directory <Filename RevisionFlag="Changed">/eng</Filename> under the
<Filename RevisionFlag="Changed">/.:/rnd</Filename> directory):
</Para>
<OrderedList>
<ListItem>
<Para RevisionFlag="Changed">Run the <Command>directory create</Command> command to create a new empty directory
named <Filename>/.:/rnd/eng</Filename> into which the contents of the source directory
<Filename>/.:/eng</Filename> can be placed:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory create  /.:/rnd/eng
</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">By default, the <Command>directory create</Command> command creates new directories in
the same clearinghouse as the parent directory.  If you wish to create a
directory in another clearinghouse, you must use the <Option>clearinghouse</Option>
option of the command to specify the other clearinghouse.
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Perform a skulk on the <Filename>/.:/eng</Filename> directory before appending it to the
<Filename>/.:/rnd</Filename> directory.  This synchronization of the source directory's
replicas can prevent errors that cause the append operation to fail:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory synchronize  /.:/eng</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Run the <Command>directory merge</Command> command to append the source directory
<Filename>/.:/eng</Filename> to the <Filename>/.:/rnd</Filename> directory (or merge it into the
new <Filename>/.:/rnd/eng</Filename> directory):
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory merge  /.:/eng  -into  /.:/rnd/eng</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed"><?sml-need 5>If the source directory contains any child directories whose contents
you want to copy over, you must specify the <Option>tree</Option> option in
the <Command>directory merge</Command> command line.  Additionally, you need to specify the
<Option>clearinghouse</Option> option if you wish to place the child directory
and its contents in a different clearinghouse from the
<Filename>/.:/rnd/eng</Filename> directory.
</Para>
<Para RevisionFlag="Changed">If the merge operation is not successful, you can delete any partially merged
information at the target location and run the command again.  Be sure,
though, to delete any duplicate names and to make certain that connectivity
to the affected clearinghouses can be maintained.
</Para>
<Note>
<Para RevisionFlag="Changed">The CDS objects created by the <Command>directory merge</Command> command
retain all of the writable attribute values and some of the read-only attribute
values of the source objects.  However, these objects do not
inherit the ACLs of the source objects.  The ACLs on the target objects
are either those that are inherited from the initial container (the parent
directory into which the objects are merged) or the initial object.
</Para>
</Note>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">After the append operation, the <Filename>/.:/eng</Filename> directory (and its contents)
still exists at the source location.  You need to delete the
<Filename>/.:/eng</Filename> directory from its original location and create 
a soft link named <Filename>/.:/eng</Filename> in place of the deleted directory.
The soft link will redirect lookups of the <Literal>obj1</Literal> and
<Literal>link1</Literal> object entries to their new locations in the <Filename>/.:/rnd/eng</Filename>
directory.
</Para>
<Para RevisionFlag="Changed">It is recommended that you perform a skulk on a source directory
before deleting it.  This synchronization of the directory's replicas can
prevent errors that cause the delete operation to fail.
</Para>
<Para RevisionFlag="Changed">The sequence of <Command>dcecp</Command> commands for removing the
<Filename>/.:/eng</Filename> directory from the source location is the following:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory synchronize  /.:/eng</Literal>
dcecp> <Literal>directory delete  /.:/eng</Literal>
dcecp> <Literal>link create  /.:/eng  -to  /.:/rnd/eng</Literal>
dcecp>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">Figure 20-3 shows the structure of our example namespace before and after
the append operation.
</Para>
<?sml-need 5.25i>
<Figure>
<Title RevisionFlag="Changed">Example Namespace Before and After the Append Operation</Title>
<Graphic Entityref="AGCC.CDSSBT.ent.3" Scalefit="1" Reprodep="350" Reprowid="350"></Graphic>
</Figure>
<?sml-space .5>
</ListItem>
</OrderedList>
</Sect2>
<Sect2 Id="AGCC.CDSSBT.div.5">
<Title RevisionFlag="Changed">Modifying ACLs at the Target Location</Title>
<Para RevisionFlag="Changed">To preserve the access by principals to the merged information in the
target directories, the ACLs on the newly
created objects at the target location need to match those of the objects
in the source directories.  Because the <Command>directory merge</Command> command
does not recreate the source ACLs on the CDS objects at the new location,
you may need to modify the target ACLs after the
merge operation.  To modify these ACLs, use the <Command>dcecp</Command> 
<Command>acl replace</Command> or <Command>acl modify</Command> command, depending on whether you
want to replace an entire ACL or just modify ACL entries. 
</Para>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSSBT.div.6">
<Title RevisionFlag="Changed">Handling Errors</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.8">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">appending errors</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.CDSSBT.indx.9">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">merging errors</Secondary>
</IndexTerm>Most of the errors that the <Command RevisionFlag="Changed">directory merge</Command> command encounters during
its operations are caused by the following:
</Para>
<ItemizedList>
<ListItem>
<Para RevisionFlag="Changed">Duplicate names that are detected during the merge
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Names in the source subtree whose master clearinghouses were
not reachable when the command was executing
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Entries not created in the target location due to insufficient
permissions
</Para>
</ListItem>
</ItemizedList>
<Para RevisionFlag="Changed">The following subsections explain how to recover from these errors.
</Para>
<Sect2 Id="AGCC.CDSSBT.div.7">
<Title RevisionFlag="Changed">Duplicate Names</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.10">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">merging</Secondary>
<Tertiary RevisionFlag="Changed">duplicate name problems</Tertiary>
</IndexTerm>If the full name of a CDS object entry or soft link is identical to a full
name of an object entry or soft link at the target location, the
<Command RevisionFlag="Changed">directory merge</Command> command lists these duplicate names and stops.  Duplicate
names are not merged to avoid overwriting and destroying the identical names in
the target directory.
</Para>
<Para RevisionFlag="Changed">If duplicate names exist, you need to decide which names you want to
preserve: the names in the source subtree or the names in the target
subtree.  Once you have made your decision, proceed in
the following manner:
</Para>
<OrderedList>
<ListItem>
<Para RevisionFlag="Changed">Use the <Command>dcecp</Command> <Literal>create</Literal>
operations to recreate (under a new name) any duplicate object entry
or soft link as a new object entry or soft link
in the source or target subtree.  Then delete the duplicate name.
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">When you are certain that connectivity to the affected clearinghouses
can be maintained, rerun the <Command>directory merge</Command> command to merge the
contents of the source and target directories.
</Para>
</ListItem>
</OrderedList>
</Sect2>
<Sect2 Id="AGCC.CDSSBT.div.8">
<Title RevisionFlag="Changed">Unreachable Name Failures</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.11">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">merging</Secondary>
<Tertiary RevisionFlag="Changed">handling unreachable name failures</Tertiary>
</IndexTerm>Sometimes, the clearinghouse that stores the master replica of a directory
you are trying to merge is disabled or unreachable when you
enter the <Command RevisionFlag="Changed">directory merge</Command> command.  When this happens, the command
cannot create the directory and the entries it contains at the new target
location.
</Para>
<Para RevisionFlag="Changed">When unable to merge a name for this reason, the
<Command>directory merge</Command> command displays an error message
specifying the name that could not be created and terminates.
</Para>
</Sect2>
<Sect2 Id="AGCC.CDSSBT.div.9">
<Title RevisionFlag="Changed">Insufficient Permissions</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.12">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">merging</Secondary>
<Tertiary RevisionFlag="Changed">handling insufficient permissions</Tertiary>
</IndexTerm>The <Command RevisionFlag="Changed">directory merge</Command> command cannot create CDS objects at a target
location if it lacks the appropriate permissions.  If the command returns
error messages indicating insufficient permissions, you need to
examine the ACLs for the target clearinghouse, directories, and object
entries to see the current permissions and change the inappropriate ones.
</Para>
<Para RevisionFlag="Changed"><?sml-need 2>Table 20-1 shows the permissions required to create directories and
other CDS object entries at the target.
</Para>
<?sml-need 14>
<Table Frame="all" Remap="center" Orient="Port">
<Title RevisionFlag="Changed">Permissions Required To Create Target Objects</Title>
<TGroup Rowsep="0" Colsep="0" Cols="2">
<ColSpec Colsep="1" Align="Left" Colwidth="1*" Colname="col1" Colnum="1">
<ColSpec Align="Left" Colwidth="2*" Colname="col2" Colnum="2">
<TBody>
<Row>
<Entry Rowsep="1"><Literal RevisionFlag="Changed">Objects</Literal></Entry>
<Entry Rowsep="1"><Literal RevisionFlag="Changed">Required Permissions</Literal></Entry>
</Row>
<Row>
<Entry Rowsep="1" RevisionFlag="Changed">directory</Entry>
<Entry Rowsep="1" RevisionFlag="Changed">Write permission to the clearinghouse that is to store the
master replica of the new directory.
<?sml-space .3>Insert and read permissions to the parent of the new directory.
<?sml-space .3>Insert and read permissions to the initial container for the new directory.
<?sml-space .3>The server principal also needs read and insert permissions to the parent
directory of the new directory.
</Entry>
</Row>
<Row>
<Entry RevisionFlag="Changed">other CDS object</Entry>
<Entry RevisionFlag="Changed">Insert and read permissions to the directory where it is to be created.
<?sml-space .3>Insert and read permissions to the initial object for its object type.
</Entry>
</Row>
</TBody>
</TGroup>
</Table>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSSBT.div.10">
<Title RevisionFlag="Changed">Merging CDS Directories into a Foreign Cell</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.13">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">merging into foreign cells</Secondary>
</IndexTerm>You can also use the <Command RevisionFlag="Changed">directory merge</Command> command
to merge CDS directories into the namespace of a foreign cell.
In general, the procedure you follow is the same as the procedure you
use to merge directories or subtrees in the same namespace.  There are,
however, some additional considerations to keep in mind:
</Para>
<ItemizedList RevisionFlag="Changed">
<?sml-need 3>
<ListItem>
<Para>You need to establish cross-cell authentication in advance.
</Para>
</ListItem>
<ListItem>
<Para>You need to merge the entire directory hierarchy in the source and target 
cells.
</Para>
</ListItem>
</ItemizedList>
<Para RevisionFlag="Changed">Also, you need to modify the ACLs of the newly created target objects as
when you merge directories in the same namespace. 
</Para>
<Sect2 Id="AGCC.CDSSBT.div.11">
<Title RevisionFlag="Changed">Establishing Cross-Cell Authentication</Title>
<Para RevisionFlag="Changed">If you want users and applications in the source cell to be able to
continue accessing their merged information in the target
cell conveniently, make sure that an agreement of cross-cell authentication
exists between the source cell and foreign (target) cell.  Otherwise,
principals from the source cell requesting newly merged information will not
be permitted to communicate with the target cell.  See Part 6
for complete information on how to set up cross-cell authentication.
</Para>
</Sect2>
<Sect2 Id="AGCC.CDSSBT.div.12">
<Title RevisionFlag="Changed">Performing a Merge Operation into a Foreign Cell</Title>
<Para RevisionFlag="Changed">To merge CDS data into the namespace of a foreign cell, follow these steps:
</Para>
<OrderedList>
<ListItem>
<Para RevisionFlag="Changed">While logged into a privileged account (<Literal>cell_admin</Literal> or a member of
<Literal>cds-admin</Literal> group) on the target machine in the foreign cell, run the
<Command>directory merge</Command> command to merge the contents of the source cell's
directory with an existing directory. 
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">If you intend to continue accessing the merged information from the source
cell, delete the uppermost directory in the source subtree
and replace the deleted information with a single soft link of the same
name as that directory.  This redirects lookups of the information to its
new location in the foreign cell.
</Para>
</ListItem>
</OrderedList>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSSBT.div.13">
<Title RevisionFlag="Changed">Restoring Merged CDS Directories</Title>
<Para><IndexTerm Id="AGCC.CDSSBT.indx.14">
<Primary RevisionFlag="Changed">CDS</Primary>
<Secondary RevisionFlag="Changed">restoring merged directories</Secondary>
</IndexTerm>You can use the <Command RevisionFlag="Changed">dcecp</Command> <Command RevisionFlag="Changed">link delete</Command> and
<Command RevisionFlag="Changed">directory merge</Command> commands to restore deleted directories and their
contents to your namespace.
</Para>
<Para RevisionFlag="Changed">First run the <Command>link delete</Command> command to remove the soft links in the
former source location, then use the <Command>directory merge</Command>
command to append the copy of the directory back under its former parent
directory.
</Para>
<Para RevisionFlag="Changed">If the directory has slave replicas, use the
<Command>directory create</Command> command to create a new replica of the directory
in each of the clearinghouses from which the directory was deleted.
</Para>
<Para RevisionFlag="Changed">Remember that the <Command>directory merge</Command>
command affects only directories and their contents.  It does not
copy clearinghouses or their associated clearinghouse object entries
and therefore cannot be used to restore clearinghouses or to
account for discrepancies in information among individual replicas resident on
different clearinghouses.  Furthermore, the directory information in a
particular location may have changed since the time of the original merge
operation.
<?og-ChangeEnd def,13575,R1.2.2,Replaced command with operation"></Para>
</Sect1>
</Chapter>
<!--+ 10/31/96 16:05:54
    | tagMorph:  $Id: subtree.sgm,v 1.1.2.10 1996/12/04 22:49:52 carrig Exp $
    | tagMorph library:  $Id: subtree.sgm,v 1.1.2.10 1996/12/04 22:49:52 carrig Exp $
    | sml-to-docbook:  1.24
    +-->
