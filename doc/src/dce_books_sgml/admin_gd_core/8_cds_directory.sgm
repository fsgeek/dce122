<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: 8_cds_directory.sgm,v $
# Revision 1.1.2.13  1996/12/05  20:16:51  carrig
# 	{enh,R1.2.2}
# 	Fixed bug in Replaceable (typo)
# 	[1996/12/05  20:16:34  carrig]
#
# Revision 1.1.2.12  1996/12/04  22:49:19  carrig
# 	{enh,R1.2.2}
# 	JC's edits
# 	[1996/12/04  22:47:09  carrig]
# 
# Revision 1.1.2.11  1996/11/29  20:20:55  carrig
# 	{enh,R1.2.2}
# 	Finished edit changes; must scale graphics
# 	[1996/11/29  20:17:31  carrig]
# 
# Revision 1.1.2.10  1996/11/27  21:43:40  carrig
# 	{enh,R1.2.2}
# 	More editor's comments
# 	[1996/11/27  21:41:47  carrig]
# 
# 	{enh,R1.2.2}
# 	More editor's comments
# 	[1996/11/27  21:28:33  carrig]
# 
# Revision 1.1.2.9  1996/11/26  21:45:17  carrig
# 	{enh,R1.2.2}
# 	Putting in editor's comments
# 	[1996/11/26  21:41:02  carrig]
# 
# Revision 1.1.2.8  1996/11/25  21:51:21  carrig
# 	{enh,R1.2.2}
# 	Started to put in editor's comments
# 	[1996/11/25  21:49:27  carrig]
# 
# Revision 1.1.2.7  1996/11/25  13:57:14  weir
# 	Fixed various Adept errors
# 	[1996/11/25  13:44:43  weir]
# 
# Revision 1.1.2.6  1996/11/18  19:04:05  willie
# 	Removed RevisionFlag within <IndexTerm>s and
# 	within an empty <InformalExample><ProgramListing>.  Also
# 	removed the empty <InformalExample><ProgramListing>.
# 	[1996/11/18  19:03:52  willie]
# 
# Revision 1.1.2.5  1996/11/07  20:43:32  weir
# 	Cleaned up history
# 	[1996/11/07  20:41:42  weir]
# 
# Revision 1.1.2.4  1996/11/06  20:40:41  carrig
# 	{enh,R1.2.2}
# 	OK for editing
# 	[1996/11/06  20:38:11  carrig]
# 
# Revision 1.1.2.3  1996/11/05  18:58:53  carrig
# 	{enh,R1.2.2}
# 	Second pass
# 	[1996/11/05  18:55:41  carrig]
# 
# Revision 1.1.2.2  1996/11/04  22:03:46  carrig
# 	{enh,R1.2.2}
# 	First pass at corrections
# 	[1996/11/04  22:00:21  carrig]
# 
# Revision 1.1.2.1  1996/11/01  18:20:36  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 	[1996/11/01  18:18:02  wardr]
# 
# Revision 1.1.1.2  1996/11/01  18:18:02  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 
# $EndLog$
-->
<!---->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
]>
-->
<!---->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the-->
<!-- src directory for the full copyright text.-->
<!---->
<!---->
<!-- HISTORY-->
<!-- Revision 1.1.10.1  1996/09/19  14:55:44  sherman-->
<!-- 	{def,13575,R1.2.2}-->
<!-- 	Miscellaneous dcecp fixes-->
<!-- 	[1996/09/19  14:54:56  sherman]-->
<!---->
<!-- Revision 1.1.8.1  1996/03/12  15:53:40  wardr-->
<!-- 	{edit R1.2.1}-->
<!-- 	Release Edits-->
<!-- 	[1996/03/12  15:53:25  wardr]-->
<!-- -->
<!-- Revision 1.1.6.15  1995/05/25  19:03:02  rcb-->
<!-- 	PRENTICE HALL reformat: final changes-->
<!-- 	[1995/05/25  13:14:46  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat - index entries, odds and ends-->
<!-- 	[1995/03/27  19:49:49  rcb]-->
<!-- -->
<!-- 	prevented hyphenation of option names-->
<!-- 	[1995/03/09  15:00:42  rcb]-->
<!-- -->
<!-- 	minor editorial fix: init cap on "For" in headers-->
<!-- 	[1995/03/06  17:07:21  rcb]-->
<!-- -->
<!-- 	additional 1.1 edit change-->
<!-- 	[1995/02/27  17:07:52  rcb]-->
<!-- -->
<!-- 	PRENTICE HALL reformat-->
<!-- 	[1995/02/23  20:51:07  rcb]-->
<!-- -->
<!-- 	incorporated 1.1 edits-->
<!-- 	[1995/02/23  20:37:56  rcb]-->
<!-- -->
<!-- Revision 1.1.6.14  1994/10/21  17:02:08  rjohnson-->
<!-- 	No changes were made.-->
<!-- 	[1994/10/21  17:01:40  rjohnson]-->
<!-- -->
<!-- Revision 1.1.6.13  1994/10/19  15:58:53  wardr-->
<!-- 	{edit R1.1}-->
<!-- 	Final GA release edits-->
<!-- 	[1994/10/19  15:58:05  wardr]-->
<!-- -->
<!-- Revision 1.1.6.12  1994/10/16  20:44:00  zahn-->
<!-- 	{edt,12399,R1.1}-->
<!-- -->
<!-- 	Removed section in this chapter on "Managing Cell Names".-->
<!-- 	Section contained an invalid cross-reference to the-->
<!-- 	dcecp cellalias command as the way to create hierarchical-->
<!-- 	cells.  Also, the remaining cross-reference information to cdsalias-->
<!-- 	reference pages didn't warrant a separate section,-->
<!-- 	and finally, a section on "Managing Cell Names" already-->
<!-- 	exists in Chapter 6 (admin_gd/tasks/task_cellalias.gpmsl).-->
<!-- 	[1994/10/16  20:43:44  zahn]-->
<!-- -->
<!-- Revision 1.1.6.11  1994/09/06  21:05:52  steto-->
<!-- 	{enh, CR10014, R1.1, Prepared for final review.}-->
<!-- 	[1994/09/06  21:05:34  steto]-->
<!-- -->
<!-- Revision 1.1.6.10  1994/09/01  15:56:27  rjohnson-->
<!-- 	Changes made: Added new section describing how to respond to "Server clocks-->
<!-- 	are not sychronized" message.-->
<!-- 	[1994/09/01  15:56:03  rjohnson]-->
<!-- -->
<!-- Revision 1.1.6.9  1994/08/26  14:11:46  rjohnson-->
<!-- 	Changes made: Incorporated review comments.-->
<!-- 	[1994/08/26  14:11:27  rjohnson]-->
<!-- -->
<!-- Revision 1.1.6.8  1994/08/12  21:10:53  steto-->
<!-- 	{enh, CR 10015, R1.1, Added dcecp examples.}-->
<!-- 	[1994/08/12  21:10:32  steto]-->
<!-- -->
<!-- Revision 1.1.6.7  1994/05/18  13:04:04  wardr-->
<!-- 	{edit R1.1}SGML fixes-->
<!-- 	[1994/05/18  13:03:48  wardr]-->
<!-- -->
<!-- Revision 1.1.6.6  1994/05/15  00:36:01  steto-->
<!-- 	{enh, 10014, edt, R1.1}-->
<!-- 	Prepared for Beta.-->
<!-- 	[1994/05/15  00:31:59  steto]-->
<!-- -->
<!-- Revision 1.1.6.5  1994/05/11  19:00:03  rjohnson-->
<!-- 	No changes made.-->
<!-- 	[1994/05/11  18:59:45  rjohnson]-->
<!-- -->
<!-- 	Changes made: None-->
<!-- 	File name: admin_gd/directory/cds/8_cds_directory.gpsml-->
<!-- -->
<!-- Revision 1.1.6.4  1993/08/24  01:37:31  tmw-->
<!-- 	Added index entries for second version of master index.-->
<!-- 	[1993/08/24  01:33:02  tmw]-->
<!-- -->
<!-- Revision 1.1.6.3  1993/07/06  18:34:28  buckler-->
<!-- 	{edit, R1.0.2}-->
<!-- 	More Prentice-Hall edits.-->
<!-- 	[1993/06/29  21:30:26  buckler]-->
<!-- -->
<!-- Revision 1.1.6.2  1993/06/01  18:16:21  buckler-->
<!-- 	{edit, R1.0.2}-->
<!-- 	Prentice-Hall editorial review.-->
<!-- 	[1993/06/01  18:09:28  buckler]-->
<!-- -->
<!-- Revision 1.1.4.4  1993/01/28  19:06:58  dbelch-->
<!-- 	Embedding copyright notice-->
<!-- 	[1993/01/28  18:31:52  dbelch]-->
<!-- -->
<!-- Revision 1.1.4.3  1993/01/27  16:04:10  buckler-->
<!-- 	Fixed cross-refs and figure calls for new book org-->
<!-- 	[1993/01/27  16:00:35  buckler]-->
<!-- -->
<!-- Revision 1.1.4.2  1992/08/25  20:34:23  weir-->
<!-- 	Moved to dce1.0.2doc-->
<!-- 	[1992/08/25  20:27:25  weir]-->
<!-- -->
<!-- Revision 1.1.2.2  1992/07/04  12:52:14  lipsky-->
<!-- 	Changes made:  None.  Skulk time is correct.-->
<!-- 	File name:  src/admin_gd./directory/cds/8_cds_directory.gpsml-->
<!-- 	Review:  Ken Goach's review-->
<!-- 	[1992/07/04  12:51:30  lipsky]-->
<!-- -->
<!-- Revision 1.1  1992/01/29  16:16:14  damon-->
<!-- 	Initial revision-->
<!-- -->
<!---->
<!-- (c) Copyright 1991, Open Software Foundation, Inc.  ALL RIGHTS RESERVED-->
<!--   HISTORY COMMENTS:-->
<!---->
<!--   DATE:                            COMMENT:-->
<!---->
<!--	Tues Oct 29, 1991                Initial File Submission for final-->
<!--                                    integration at IBM-->
<!---->
<!-- ********************************************************************-->
<!--                                                                    *-->
<!-- COPYRIGHT (c) 1991 BY DIGITAL EQUIPMENT CORPORATION,               *-->
<!-- Maynard, Massachusetts                                             *-->
<!-- All Rights Reserved.                                               *-->
<!--                                                                    *-->
<!-- This document is furnished under a license and may be used and     *-->
<!-- copied only in accordance with the terms of such license and with  *-->
<!-- the inclusion of the above copyright notice.  No title to or        *-->
<!-- ownership of the document is hereby transferred.                   *-->
<!--                                                                    *-->
<!-- The information in this document is subject to change without      *-->
<!-- notice and should not be construed as a commitment by Digital      *-->
<!-- Equipment Corporation.                                             *-->
<!--                                                                    *-->
<!-- ********************************************************************-->
<Chapter Id="AGCC.CDSDIR.div.1">
<Title>Managing CDS Directories</Title>
<Para><IndexTerm Id="AGCC.CDSDIR.indx.1">
<Primary>CDS</Primary>
<Secondary>managing directories</Secondary>
</IndexTerm>If you manage a namespace in a small, slow-growth network of 25 nodes or
less, you can maintain all your names in the root directory
and may not need to create additional directories.  However, if you manage a
namespace in a network of more than 25 nodes,
you should consider creating at least one additional level of directories
under the root.
</Para>
<Para>This chapter explains how to create directory hierarchies in the cell
namespace and describes tasks related to managing directories, such as
</Para>
<ItemizedList>
<ListItem>
<Para>Creating and deleting directory replicas
</Para>
</ListItem>
<ListItem>
<Para>Skulking a directory
</Para>
</ListItem>
<ListItem>
<Para>Modifying a directory's convergence
</Para>
</ListItem>
</ItemizedList>
<Sect1 Id="AGCC.CDSDIR.div.2">
<Title>Creating Directories</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.2">
<Primary>directories</Primary>
<Secondary>creating (CDS)</Secondary>
</IndexTerm>
<Para>By creating directories, you make it possible to
replicate and manage groups of object entries according to where, how often,
or by whom they are used.  Grouping related object entries into separate
directories also makes it easier to control access because it allows you
to take advantage of default ACL entry propagation.
</Para>
<Para>CDS cell configuration creates an initial hierarchy of directories under the
root so that DCE components can fix locations within the namespace where
they can create and catalog their object entries.  Among the directories
created by cell configuration is the <Literal>subsys</Literal> directory, beneath which
independent software vendors (ISVs) can create their own directories
to store the object entries that are used by their distributed applications.
</Para>
<Para>Alternatively, ISVs and other users of the namespace may prefer to create
a hierarchy of directories of their own design under the root to store their
information.
</Para>
<Para>(See the &DCEAi; for more information on the initial hierarchy that is
established by cell configuration.)
</Para>


<Sect2 Id="AGCC.CDSDIR.div.3">
<Title>Permissions for Creating a Directory</Title>
<Para><IndexTerm Id="AGCC.CDSDIR.indx.3">
<Primary>directories</Primary>
<Secondary>permissions needed to create</Secondary>
</IndexTerm>To create a directory, you need the following permissions:
</Para>
<ItemizedList>
<ListItem>
<Para>Insert permission to the parent of the new directory.
</Para>
</ListItem>
<ListItem>
<Para>Write permission to the clearinghouse that stores the master
replica of the new directory.
</Para>
</ListItem>
<ListItem>
<Para>The server principal for the server system where you enter the
DCE control program's (<Command>dcecp</Command>) <Command>directory create</Command>
command must have read and insert permissions to the
parent directory of the new directory.
</Para>
<Para>If the server is included in the server authorization group
<Filename>subsys/dce/cds-servers</Filename>, these permissions should already be
in place.  If in doubt, use the <Command>dcecp</Command> <Command>acl show</Command>
command on the parent directory to verify that
the server principal has the appropriate permissions.  (See the
<Literal>acl(8dce)</Literal> reference page for more 
information on arguments to the <Command>acl show</Command>
command.)
</Para>
</ListItem>
</ItemizedList>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.4">
<Title>Entering the directory create Command</Title>
<Para><IndexTerm Id="AGCC.CDSDIR.indx.4">
<Primary>directories</Primary>
<Secondary>creating</Secondary>
</IndexTerm>Use the <Command>directory create</Command> command to create a new directory 
(master replica) with the name that you specify.  When you use this command,
CDS, by default, stores the master replica of the new directory in the same
clearinghouse that stores the master replica of the new directory's parent
directory.
</Para>
<Para RevisionFlag="Changed">For example, to create a directory named <Filename>/.:/sales</Filename> and
store the master replica of the new directory in the root directory's
initial clearinghouse, you enter the following command:
<?og-ChangeStart def,13575,R1.2.2,Added dcecp as the return prompt"></Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory create  /.:/sales
</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
<Note>
<Para RevisionFlag="Changed">For the directory creation to succeed, the
master replica of the new directory's parent directory must be available
when you enter the command.
</Para>
</Note>
<Para RevisionFlag="Changed">You can use the <Command>directory create</Command> command's <Option>clearinghouse</Option> option
to store the master replica of a new directory in a different clearinghouse
than the parent directory's clearinghouse.  For example, to place the
new directory created in the previous example into another clearinghouse
(<Filename>/.:/Chicago1_CH</Filename>), you would enter the following command:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory create  /.:/sales  -clearinghouse  /.:/Chicago1_CH</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">(See the <Command>directory(8dce)</Command> reference page for complete information 
on arguments and options to the <Command>directory create</Command> command.)
</Para>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.5">
<Title RevisionFlag="Changed">Checking the ACL Entries for a New Directory</Title>
<Para><IndexTerm Id="AGCC.CDSDIR.indx.5">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">checking the ACLs for</Secondary>
</IndexTerm>After you create a directory, you want to verify that the
users and applications for whom the directory was created have the
appropriate permissions.  To do this, use the <Command RevisionFlag="Changed">acl show</Command> command on
the directory to see the associated ACL entries.  For example:
</Para>
<InformalExample>
<Para><ProgramListing><?sml-need 5>dcecp>  <Literal>acl show   /.:/sales</Literal>
{unauthenticated r--t-}
{group subsys/dce/cds-admin rwdtc}
{group subsys/dce/cds-server rwdtc}
{any_other r--t-}
dcecp> 
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">(See the <Literal>acl(8dce)</Literal> reference page for complete information on the <Command>acl show</Command> command.)
</Para>
<Para RevisionFlag="Changed">If the required permissions were not inherited
from the new directory's parent directory, use the <Command>acl modify</Command> command
to create the necessary ACL entries.  For example:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp>  <Literal>acl modify  /.:/sales  -add {user cell_admin rwdtcia}
</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">(See
<!-- the chapter in this module on managing CDS access control Chapter 7-->
<!-- for more information on CDS permissions.  See -->
<!-- the \*EDCE Security Service\*O module of this guide-->
the <Literal>acl(8dce)</Literal> reference page for complete information on the arguments and options for the
<Command>acl modify</Command> command.)
<IndexTerm Id="AGCC.CDSDIR.indx.6" SpanEnd="AGCC.CDSDIR.indx.2">
<IndexTerm Id="AGCC.CDSDIR.indx.7">
<Primary>ACLs</Primary>
<Secondary>inheritance</Secondary>
</IndexTerm></Para>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.6">
<Title RevisionFlag="Changed">Upgrading the Directory Version on the Cell Root Directory</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.8">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">upgrading the cell root directory version</Secondary>
</IndexTerm>
<Para RevisionFlag="Changed">Upgrading the directory version on the cell root directory has special
significance.  This procedure implies that all CDS servers in the cell
have been upgraded to the latest version, given that a cell root
directory is replicated in all CDS servers in the cell.  After you have
set the <Literal>CDS_UpgradeTo</Literal> attribute on the cell root directory, the
server software soon recognizes this and sets the <Literal>CDS_UpgradeTo</Literal>
attribute on all directories in the cell.  Eventually, the
<Literal>CDS_DirectoryVersion</Literal> attribute on all the affected directories
in the cell will be upgraded to the new value. 
</Para>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.7">
<Title RevisionFlag="Changed">Upgrading the Directory Version on a Directory</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.9">
<Primary RevisionFlag="Changed">directories</Primary>
<Secondary RevisionFlag="Changed">upgrading the directory version</Secondary>
</IndexTerm>
<Para RevisionFlag="Changed">To use new features in a given release of CDS, you may need to explicitly
update the directory version of a directory.  This typically occurs when
the servers replicating the directory all have been upgraded to the latest
version of software, as older versions will not recognize the new
features. 
</Para>
<Para RevisionFlag="Changed"><?sml-need 2>To upgrade the directory version, you need write permission to the
directory and you must use the following commands: 
</Para>
<InformalExample>
<Para><ProgramListing><?sml-need 2>dcecp> <Literal>directory modify </Literal><Replaceable>directory-name </Replaceable><Literal>-add {CDS_UpgradeTo </Literal><Replaceable>&lt;v.n></Replaceable>} <Literal>\</Literal>
> <Literal>-single</Literal> 
<?sml-break>dcecp> <Literal>directory synchronize </Literal><Replaceable>directory-name</Replaceable>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">Eventually, all clearinghouses that contain a replica of
this directory will detect the presence of the <Literal>CDS_UpgradeTo</Literal> 
attribute and upgrade the <Literal>CDS_ReplicaVersion</Literal> attribute on the
appropriate replica.  You can also use the following command on all
clearinghouses that are replicating the directory:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>clearinghouse verify </Literal><Replaceable>clearinghouse-name</Replaceable>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">This command forces the server background thread to run, thereby freeing
you to perform other tasks until the job finishes.  After you have
verified all affected clearinghouses, you will need to perform another
skulk of the directory to finally set the <Literal>CSA_DirectoryVersion</Literal>
attribute to the appropriate value.  The <Literal>CDS_DirectoryVersion</Literal>
attribute is not upgraded until all of the <Literal>CDS_ReplicaVersion</Literal>
attribute values of all replicas contain the new value. 
</Para>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSDIR.div.8">
<Title RevisionFlag="Changed">Creating a Read-Only Replica</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.10">
<Primary RevisionFlag="Changed">replica</Primary>
<Secondary RevisionFlag="Changed">creating (CDS)</Secondary>
</IndexTerm>
<Para RevisionFlag="Changed">From time to time, you will want to create read-only replicas of directories.
You create read-only replicas of a directory for the following purposes:
</Para>
<ItemizedList>
<ListItem>
<Para RevisionFlag="Changed">To distribute the information that is 
contained in the directory throughout your
network, and to make the information more accessible to users and applications
at other locations.
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">To improve response time, especially in a namespace where users are
dispersed over long distances.  You should create read-only
replicas in clearinghouses
that are located near the user groups and applications that most frequently
use the information that is contained in the directory.
</Para>
</ListItem>
<ListItem RevisionFlag="Changed">
<?sml-need 10>
<Para>To preserve a backup of the information that is contained in the master
replica of the directory.  Maintaining multiple replicas ensures that
the temporary loss of an individual replica does not cause an interruption
in service and that the loss of a replica can be easily recovered.
Even directories that store information used at only one particular site
should be replicated in at least one other clearinghouse, 
preferably on a server
at another location, so that a local failure at one site does not cause both
replicas to be unreachable at the same time.  (See 
<!-- the chapter in this module on managing-->
<!-- clerks, servers, and clearinghouses -->
Chapter 17
for more information on using directory
replication as a means of backing up CDS information.)
</Para>
</ListItem>
</ItemizedList>
<Para RevisionFlag="Changed">Read-only replicas of directories are safe from alteration by users.  Users
can look up information in a read-only replica, but they are not permitted
to create new information or modify existing information.
</Para>
<Para RevisionFlag="Changed">You create read-only replicas with the <Option>replica</Option> option of the
<Command>directory create</Command> command.  You should create the replicas in
clearinghouses whose users need to access the directory but do not need,
or are not permitted, to update its contents.
</Para>
<Sect2 Id="AGCC.CDSDIR.div.9">
<Title RevisionFlag="Changed">Before You Create a Replica</Title>
<Para RevisionFlag="Changed">Before you try to create a replica, 
verify that the clearinghouse containing the master replica of the
directory you intend to replicate is running and reachable.
To verify that this condition is satisfied, follow these steps:
</Para>
<OrderedList>
<ListItem>
<Para RevisionFlag="Changed">For the directory that you intend to replicate, use the
<Command>directory show</Command> command to display the directories attribute values
and look at the <Literal>CDS_Replicas</Literal> attribute.  The value of this attribute
shows the names of the clearinghouses that currently store a replica of
the directory.  For example:
</Para>
<?sml-need 27><?sml-point-size 9>
<!--no-op:  11-->
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed" role="page-wide"><?sml-need 27><?sml-point-size 9>
dcecp> <Literal>directory show  /.:/sales</Literal>
<?sml-need 27><?sml-point-size 9>
{RPC_ClassVersion {01 00}}
{CDS_CTS 1994-08-12-09:52:30.396-04:00I0.000/00-00-c0-f7-de-56}
{CDS_UTS 1994-08-12-09:52:31.506-04:00I0.000/00-00-c0-f7-de-56}
{CDS_ObjectUUID a37d84d0-b5dc-11cd-8ffe-0000c0f7de56}
{CDS_Replicas
 {{CH_UUID ce7ed810-b5db-11cd-8ffe-0000c0f7de56}
  {CH_Name /.../Chicago1/Chicago1_CH}
  {Replica_Type Master}  
  {Tower {ncacn_ip_tcp 130.105.5.16}}
  {Tower {ncadg_ip_udp 130.105.5.16}}}}
{CDS_AllUpTo 1994-08-12-09:52:31.566-04:00I0.000/00-00-c0-f7-de-56}
{CDS_Convergence medium}
{CDS_ParentPointer
 {{Parent_UUID d034bc25-b5db-11cd-8ffe-0000c0f7de56}
  {Timeout
   {expiration 1994-08-12-09:52:30.396}
   {extension +1-00:00:00.000I0.000}}
  {myname /.../Chicago1/sales}}}
{CDS_DirectoryVersion 3.0}
{CDS_ReplicaState on}
{CDS_ReplicaType Master}
{CDS_LastSkulk 1994-08-12-09:52:31.566-04:00I0.000/00-00-c0-f7-de-56}
{CDS_LastUpdate 1994-08-12-09:52:31.506-04:00I0.000/00-00-c0-f7-de-56}
{CDS_RingPointer ce7ed810-b5db-11cd-8ffe-0000c0f7de56}
{CDS_Epoch a3df2a50-b5dc-11cd-8ffe-0000c0f7de56}
{CDS_ReplicaVersion 3.0}
dcecp> 
<?sml-point-size 12>
<!--no-op:  14-->
</ProgramListing></Para>
</InformalExample>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">With this information, use the <Command>directory show</Command> command with the
<Option>clearinghouse</Option> and <Option>replica</Option> options to verify
that you can get a response from the clearinghouse that stores the master
replica.  For example:
</Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed" role="page-wide"><?sml-need 27><?sml-point-size 9>
<!--no-op:  11-->
dcecp> <Literal>directory show  /.:/sales  -replica -clearinghouse  /.:/Chicago1_CH</Literal>
<?sml-need 27><?sml-point-size 9>
<!--no-op:  11-->
{RPC_ClassVersion {01 00}}
{CDS_CTS 1994-08-12-09:52:30.396-04:00I0.000/00-00-c0-f7-de-56}
{CDS_UTS 1994-08-12-09:52:31.506-04:00I0.000/00-00-c0-f7-de-56}
{CDS_ObjectUUID a37d84d0-b5dc-11cd-8ffe-0000c0f7de56}
{CDS_Replicas
 {{CH_UUID ce7ed810-b5db-11cd-8ffe-0000c0f7de56}
  {CH_Name /.../Chicago1/Chicago1_CH}
  {Replica_Type Master}  
  {Tower {ncacn_ip_tcp 130.105.5.16}}
  {Tower {ncadg_ip_udp 130.105.5.16}}}}
{CDS_AllUpTo 1994-08-12-09:52:31.566-04:00I0.000/00-00-c0-f7-de-56}
{CDS_Convergence medium}
{CDS_ParentPointer
 {{Parent_UUID d034bc25-b5db-11cd-8ffe-0000c0f7de56}
  {Timeout
   {expiration 1994-08-12-09:52:30.396}
   {extension +1-00:00:00.000I0.000}}
  {myname /.../Chicago1/sales}}}
{CDS_DirectoryVersion 3.0}
{CDS_ReplicaState on}
{CDS_ReplicaType Master}
{CDS_LastSkulk 1994-08-12-09:52:31.566-04:00I0.000/00-00-c0-f7-de-56}
{CDS_LastUpdate 1994-08-12-09:52:31.506-04:00I0.000/00-00-c0-f7-de-56}
{CDS_RingPointer ce7ed810-b5db-11cd-8ffe-0000c0f7de56}
{CDS_Epoch a3df2a50-b5dc-11cd-8ffe-0000c0f7de56}
{CDS_ReplicaVersion 3.0}
dcecp> 
<?sml-point-size 12>
<!--no-op:  14-->
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">The <Command>directory show</Command> command with the <Option>clearinghouse</Option> and
<Option>replica</Option> options displays all the attribute values for the directory
and its replica role.
</Para>
</ListItem>
</OrderedList>
<Note>
<Para RevisionFlag="Changed">If any read-only replicas in the directory's existing replica set are
unavailable, the replication cannot complete.  The normal skulking process
completes the replication as soon as all replicas in the directory's replica
set become available.
</Para>
</Note>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.10">
<Title RevisionFlag="Changed">Permissions for Creating Replicas</Title>
<Para RevisionFlag="Changed">To create a replica, you need the following permissions:
</Para>
<ItemizedList>
<ListItem>
<Para RevisionFlag="Changed">Administer permission to the directory that you intend to replicate
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Write permission to the clearinghouse that stores the new replica
</Para>
</ListItem>
<ListItem RevisionFlag="Changed">
<?sml-need 4>
<Para>For the replica creation to succeed,
the server principal for the server system where you enter the
<Command>directory create</Command> command with the <Option>replica</Option> and
<Literal>_clearinghouse</Literal> options
must have read, write, and administer permissions to the
directory that you intend to replicate.
</Para>
<Para>If the server is included in the server authorization group
<Filename>subsys/dce/cds-servers</Filename>,
these permissions should already be in place.  If in doubt,
use the <Command>acl check</Command> command to verify that the server principal
has the appropriate permissions.  (See 
<!-- the \*EDCE Security Service\*O module of this guide-->
the <Literal>acl(8dce)</Literal> reference page
for complete information on using the <Command>acl check</Command> command.)
</Para>
</ListItem>
</ItemizedList>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.11">
<Title RevisionFlag="Changed">Entering the directory create Command</Title>
<Para RevisionFlag="Changed">Use the <Command>directory create</Command> command with the <Option>replica</Option> and
<Option>clearinghouse</Option> options
to create a replica of a directory and store it in the clearinghouse
that you specify.  For example, the
following command creates a replica of the
<Filename>/.:/mfg</Filename>
directory and stores the replica in a clearinghouse that is named
<Filename>/.:/Paris1_CH</Filename>:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory create  /.:/mfg  -replica -clearinghouse /.:/Paris1_CH
</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
<IndexTerm Id="AGCC.CDSDIR.indx.11" SpanEnd="AGCC.CDSDIR.indx.10">
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSDIR.div.12">
<Title RevisionFlag="Changed">Deleting a Read-Only Replica</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.12">
<Primary RevisionFlag="Changed">replica</Primary>
<Secondary RevisionFlag="Changed">deleting (CDS)</Secondary>
</IndexTerm>
<Para RevisionFlag="Changed">Sometimes you may need to delete a read-only replica when the information
that it contains is no longer needed by the local users of the clearinghouse in
which the replica is stored.  You may also need to delete a read-only
replica to prepare for deleting the directory of which the replica is a
member, or before permanently removing the clearinghouse in which the replica
is stored.
</Para>
<Sect2 Id="AGCC.CDSDIR.div.13">
<Title RevisionFlag="Changed">Permissions for Deleting a Replica</Title>
<Para RevisionFlag="Changed">To delete a replica, you must have the following permissions:
</Para>
<ItemizedList>
<ListItem>
<Para RevisionFlag="Changed">Administer permission to the directory whose replica you want to delete
</Para>
</ListItem>
<ListItem RevisionFlag="Changed">
<?sml-need 2>
<Para>Write permission to the clearinghouse from which you are deleting the
replica
</Para>
</ListItem>
</ItemizedList>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.14">
<Title RevisionFlag="Changed">Entering the directory delete Command</Title>
<Para RevisionFlag="Changed">Use the <Command>directory delete</Command> command with the <Option>replica</Option> and
<Option>clearinghouse</Option> options to delete a  replica from the clearinghouse that
you specify.  For example, the following command deletes a replica of the
<Filename>/.:/eng</Filename> directory from the <Filename>/.:/Chicago2_CH</Filename> clearinghouse:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory delete  /.:/eng  -replica -clearinghouse /.:/Chicago2_CH
</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
<Note>
<Para RevisionFlag="Changed">You can delete a directory's master replica only by deleting the directory
itself (by using the <Command>directory delete</Command> command).  (See 
<!-- the chapter in this module-->
<!-- on restructuring a namespace -->
Chapter 21
for complete information on how to delete a master replica.)
</Para>
</Note>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSDIR.div.15">
<Title RevisionFlag="Changed">Skulking a Directory</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.13">
<Primary>directories</Primary>
<Secondary>updating (CDS)</Secondary>
</IndexTerm>
<IndexTerm Id="AGCC.CDSDIR.indx.14">
<Primary>skulking</Primary>
</IndexTerm>
<Para RevisionFlag="Changed">The skulk operation is a periodic distribution of recent modifications 
that were made to the namespace.
CDS skulks every directory at regular intervals according to the value
assigned to the directory's <Literal>CDS_Convergence</Literal>
attribute.  To ensure that updates are distributed to all replicas of a
directory as soon as possible, you can initiate a skulk of the directory by
using the <Command>directory synchronize</Command>
command rather than waiting for the next scheduled skulk to distribute the
new information.  You can use this command to perform the following tasks:
</Para>
<ItemizedList>
<ListItem>
<Para RevisionFlag="Changed">Distribute crucial updates that were made to a directory's contents
or replica set when you do not want to wait for the next skulk
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">Skulk directories that store replicas on servers that were inoperative for
an extended period and were just brought back online
</Para>
</ListItem>
</ItemizedList>
<Sect2 Id="AGCC.CDSDIR.div.16">
<Title RevisionFlag="Changed">Permissions for Skulking a Directory</Title>
<Para RevisionFlag="Changed">To skulk a directory, you must have the following permissions:
</Para>
<ItemizedList>
<ListItem>
<Para RevisionFlag="Changed">Administer, write, insert, or delete permission to the
directory.
</Para>
</ListItem>
<ListItem>
<Para RevisionFlag="Changed">The server principal for the server system where you enter the
<Command>directory synchronize</Command> command
needs read, write, and administer permissions to the directory that
you intend to skulk.
</Para>
<Para RevisionFlag="Changed">If the server is included in the
server authorization group
<Filename>subsys/dce/cds-servers</Filename>,
these permissions should already
be in place.  If in doubt,
use the <Command>acl show</Command> command to verify that the server principal
has the appropriate permissions.  (See 
<!-- the \*EDCE Security Service\*O module of this guide-->
the <Literal>acl(8dce)</Literal> reference page
for complete information on the <Command>acl show</Command> command arguments.)
</Para>
</ListItem>
</ItemizedList>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.17">
<Title RevisionFlag="Changed">Entering the directory synchronize Command</Title>
<Para RevisionFlag="Changed">Use the <Command>directory synchronize</Command> command to initiate an immediate
skulk on a directory.
</Para>
<Para RevisionFlag="Changed">After you enter the command, <Command>dcecp</Command> temporarily suspends
the <Literal>dcecp></Literal> prompt while the skulk is in progress.  Skulks of
directories with large replica sets may take some time to execute.  If the
prompt returns with no error messages, the skulk is successful.  If error
messages are displayed before the prompt returns, the skulk failed.
</Para>
<Para RevisionFlag="Changed">For a skulk to succeed, every replica in the directory's replica
set must be reachable.  Skulks may sometimes fail, especially on directories
with large replica sets, or when the servers that store replicas of the
directory are located over great distances where network connectivity is
not always reliable.
</Para>
<Para RevisionFlag="Changed">Skulk failure does not make CDS unusable.  Although the skulking process
is unable to update information
in a replica that it cannot contact, it always updates information in the
replicas that it can reach.  Temporarily, some replicas contain the
latest information and some do not.  When a skulk fails, CDS
automatically repeats the skulking process, at an interval based on the
directory's convergence value, until all replicas in the set are updated
with the latest changes.  When all replicas contain identical information,
CDS considers the skulk successful.
</Para>
<Para RevisionFlag="Changed">If skulks of a particular directory continue to fail, you can determine the
cause by reviewing the log of CDS events on the server that stores the master
replica of the directory.  For example, the following command initiates a
skulk on the <Filename>/.:/admin</Filename> directory:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory synchronize /.:/admin</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.18">
<Title RevisionFlag="Changed">Synchronizing CDS Server Clocks</Title>
<IndexTerm Id="AGCC.CDSDIR.indx.15">
<Primary>synchronizing CDS server clocks</Primary>
</IndexTerm>
<Para RevisionFlag="Changed">After performing a skulk operation on a directory, you may receive 
the message
</Para>
<InformalExample>
<Para><ProgramListing RevisionFlag="Changed">Server clocks are not synchronized
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">indicating that the server clocks 
are not synchronized.  If so, you should
first check to see whether the system clocks on the server systems are indeed
synchronized.  If they are and you still receive the message, then 
perhaps the system clock on an individual server was mistakenly set 
to a future time and subsequently restored.  This causes a problem for 
CDS because 
there may be timestamps stored in a clearinghouse that are invalid 
(any timestamp greater than 5 minutes in the future from the current time). 
</Para>
<Para RevisionFlag="Changed">If this is the case, you should adjust the system clock to the current time and
then enter the following command:  
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>clearinghouse repair</Literal> &lt;<Replaceable>clearinghouse-name</Replaceable> <Literal>timestamps</Literal>
</ProgramListing></Para>
</InformalExample>
<Para RevisionFlag="Changed">This command will disable the clearinghouse, analyze and repair bad timestamps, checkpoint the clearinghouse to disk, and reenable the clearinghouse. 
To use the command, you need write permission to the server on 
which the clearinghouse resides.  Also, you should execute this command on 
all clearinghouses 
that replicate the directory (and its objects) that needs to be repaired. 
</Para>
<Para RevisionFlag="Changed">After executing the <Literal>clearinghouse repair</Literal> command, 
you should be able to skulk the directory successfully. 
</Para>
</Sect2>
</Sect1>
<Sect1 Id="AGCC.CDSDIR.div.19">
<Title RevisionFlag="Changed">Modifying a Directory's Convergence</Title>
<Para><IndexTerm Id="AGCC.CDSDIR.indx.16">
<Primary>directories</Primary>
<Secondary>convergence (CDS)</Secondary>
</IndexTerm>The value assigned to a directory's <Literal RevisionFlag="Changed">CDS_Convergence</Literal> attribute
determines how frequently the server that stores the master replica of the
directory initiates a skulk of the directory's replica set.  A directory's
convergence can be set to a value of <Literal RevisionFlag="Changed">high</Literal>, <Literal RevisionFlag="Changed">medium</Literal>, or
<Literal RevisionFlag="Changed">low</Literal>.
<!-- See the \*(Ar for-->
<!-- complete information on the skulk intervals that result from each of these-->
<!-- convergence settings.-->
</Para>
<Para RevisionFlag="Changed">A directory that is set to a convergence value of <Literal>high</Literal>
is skulked at least once every 12
hours.  If an update is made to the directory, the
server that stores the master replica
immediately attempts to propagate the new information to the entire replica
set.  If this update propagation fails, the server schedules a skulk of the
directory to begin within the hour.  If this initial skulk fails, additional
skulks are initiated at 1-hour intervals until the skulk succeeds.
</Para>
<Para RevisionFlag="Changed">A directory that is set to a convergence value of <Literal>medium</Literal>
is skulked at least once every
12 hours.  If an update is made to the directory,
the server that stores the master replica
immediately attempts to propagate the new information to the entire replica
set.  If the propagation fails, the server waits for the next skulk to
synchronize the replica set.
</Para>
<Para RevisionFlag="Changed">A directory that is set to a convergence value of <Literal>low</Literal>
is skulked at least once every 24 hours.  The server on which a
low-convergence directory resides makes no immediate attempt to
propagate updates and waits for the next skulk to synchronize the replica set.
</Para>
<Para RevisionFlag="Changed">Every newly created directory inherits the convergence value of its parent
directory.  When you create a namespace, the root directory is automatically
assigned a convergence value of <Literal>medium</Literal>.  Unless you change
this value, or the convergence values of any lower-level directories after
you create them, all directories that you create under
the root also have a convergence value of <Literal>medium</Literal>.
For most directories, you never need to modify this value.  However, you may
occasionally find it useful to set a directory's convergence to
<Literal>high</Literal> or <Literal>low</Literal>. 
</Para>
<Sect2 Id="AGCC.CDSDIR.div.20">
<Title RevisionFlag="Changed">Before You Modify a Directory's Convergence</Title>
<Para RevisionFlag="Changed">Before you modify a directory's convergence, you want to verify the current
convergence value of the directory.  To do this, use the <Command>directory show</Command>
command to display the directory's attribute values and look at the 
<Literal>CDS_Convergence</Literal> attribute value.
</Para>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.21">
<Title RevisionFlag="Changed">Permissions for Modifying a Directory's Convergence</Title>
<Para RevisionFlag="Changed">To modify a directory's convergence, you must have write permission to the
directory.
</Para>
</Sect2>
<Sect2 Id="AGCC.CDSDIR.div.22">
<Title RevisionFlag="Changed">Entering the directory modify Command</Title>
<Para RevisionFlag="Changed">Use the <Command>directory modify</Command> command with the <Option>change</Option> option
to assign a value of <Literal>high</Literal>, <Literal>medium</Literal>, or <Literal>low</Literal> to a directory's
<Literal>CDS_Convergence</Literal> attribute.  For example, the following command sets
the convergence value of the <Filename>/.:/sales/us</Filename> directory to <Literal>high</Literal>:
</Para>
<InformalExample>
<Para><ProgramListing>dcecp> <Literal>directory modify /.:/sales/us -change {CDS_Convergence  high}
</Literal>
dcecp> 
</ProgramListing></Para>
</InformalExample>
<IndexTerm Id="AGCC.CDSDIR.indx.17" SpanEnd="AGCC.CDSDIR.indx.13">
<IndexTerm Id="AGCC.CDSDIR.indx.18" SpanEnd="AGCC.CDSDIR.indx.14">
<IndexTerm Id="AGCC.CDSDIR.indx.19" SpanEnd="AGCC.CDSDIR.indx.1">
<?og-ChangeEnd def,13575,R1.2.2,Added dcecp as the return prompt">
</Sect2>
</Sect1>
</Chapter>
<!--+ 10/31/96 16:05:54
    | tagMorph:  $Id: 8_cds_directory.sgm,v 1.1.2.13 1996/12/05 20:16:51 carrig Exp $
    | tagMorph library:  $Id: 8_cds_directory.sgm,v 1.1.2.13 1996/12/05 20:16:51 carrig Exp $
    | sml-to-docbook:  1.24
    +-->













