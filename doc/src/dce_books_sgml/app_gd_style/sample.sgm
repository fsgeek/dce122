<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: sample.sgm,v $
# Revision 1.1.2.7  1996/11/25  18:18:59  carrig
# 	{enh,R1.2.2}
# 	VarListEntry, Figure, Table, Code Examples
# 	[1996/11/25  18:18:16  carrig]
#
# Revision 1.1.2.6  1996/11/23  23:04:44  weir
# 	No change
# 	[1996/11/23  23:04:13  weir]
# 
# Revision 1.1.2.5  1996/11/21  18:06:55  weir
# 	Shortened some source lines
# 	[1996/11/21  18:06:02  weir]
# 
# Revision 1.1.2.4  1996/11/21  16:52:41  weir
# 	Corrected entity declarations, etc.
# 	[1996/11/21  16:51:50  weir]
# 
# Revision 1.1.2.3  1996/11/20  22:33:08  weir
# 	Removed entity declarations (temporarily)
# 	[1996/11/20  22:32:45  weir]
# 
# Revision 1.1.2.2  1996/11/20  22:28:06  weir
# 	Added entity declarations
# 	[1996/11/20  22:27:25  weir]
# 
# Revision 1.1.2.1  1996/11/20  21:56:22  weir
# 	Initial submission
# 	[1996/11/20  21:55:18  weir]
# 
# $EndLog$
-->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
<!ENTITY  ADGISG.SAMPL.ent.1  SYSTEM "sample_code/generic_app/sample.idl">
<!ENTITY  ADGISG.SAMPL.ent.2  SYSTEM "sample_code/generic_app/sample.acf">
<!ENTITY  ADGISG.SAMPL.ent.3  SYSTEM "sample_code/generic_app/sample_db.idl">
<!ENTITY  ADGISG.SAMPL.ent.4  SYSTEM "sample_code/generic_app/sample_db.acf">
<!ENTITY  ADGISG.SAMPL.ent.5  SYSTEM "sample_code/generic_app/sample_server.h">
<!ENTITY  ADGISG.SAMPL.ent.6  SYSTEM "sample_code/generic_app/sample_server.c">
<!ENTITY  ADGISG.SAMPL.ent.7  SYSTEM "sample_code/generic_app/sample_bind.c">
<!ENTITY  ADGISG.SAMPL.ent.8  SYSTEM "sample_code/generic_app/sample_bind.idl">
<!ENTITY  ADGISG.SAMPL.ent.9  SYSTEM "sample_code/generic_app/sample_bind.acf">
<!ENTITY  ADGISG.SAMPL.ent.10  SYSTEM "sample_code/generic_app/sample_manager.c">
<!ENTITY  ADGISG.SAMPL.ent.11  SYSTEM "sample_code/generic_app/sample_client.c">
<!ENTITY  ADGISG.SAMPL.ent.12  SYSTEM "sample_code/generic_app/smp.sams">
<!ENTITY  ADGISG.SAMPL.ent.13  SYSTEM "sample_code/generic_app/Makefile">
]>
-->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993, 1994 Open Software Foundation, Inc.-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE for-->
<!-- the full copyright text.-->
<!-- -->
<!-- -->
<!-- OLD HISTORY-->
<!-- Revision 1.1.2.15  1995/06/27  17:46:23  buckler-->
<!-- 	More 1.1 edits.-->
<!-- 	[1995/06/27  17:45:47  buckler]-->
<!---->
<!-- Revision 1.1.2.14  1995/06/27  17:04:17  buckler-->
<!-- 	1.1 edits and Prentice Hall reformat-->
<!-- 	[1995/06/27  17:03:02  buckler]-->
<!-- -->
<!-- Revision 1.1.2.13  1994/11/15  16:25:52  weir-->
<!-- 	No change-->
<!-- 	[1994/11/15  16:25:15  weir]-->
<!-- -->
<!-- Revision 1.1.2.12  1994/10/21  15:04:22  weir-->
<!-- 	Some small corrections-->
<!-- 	[1994/10/21  15:03:59  weir]-->
<!-- -->
<!-- Revision 1.1.2.11  1994/10/19  20:48:22  weir-->
<!-- 	Review comments-->
<!-- 	[1994/10/19  20:47:31  weir]-->
<!-- -->
<!-- Revision 1.1.2.10  1994/10/19  16:02:55  weir-->
<!-- 	Review comments and edits-->
<!-- 	[1994/10/19  16:02:10  weir]-->
<!-- -->
<!-- Revision 1.1.2.9  1994/10/15  17:55:10  weir-->
<!-- 	Added some source files-->
<!-- 	[1994/10/15  17:54:44  weir]-->
<!-- -->
<!-- Revision 1.1.2.8  1994/10/11  14:05:52  weir-->
<!-- 	Updates-->
<!-- 	[1994/10/11  14:04:59  weir]-->
<!-- -->
<!-- Revision 1.1.2.7  1994/09/23  19:57:49  weir-->
<!-- 	Updates for review-->
<!-- 	[1994/09/23  19:57:00  weir]-->
<!-- -->
<!-- Revision 1.1.2.6  1994/08/17  20:56:31  weir-->
<!-- 	First set of updates-->
<!-- 	[1994/08/17  20:55:46  weir]-->
<!-- -->
<!-- Revision 1.1.2.5  1994/07/20  16:37:06  weir-->
<!-- 	Updated for new code files-->
<!-- 	[1994/07/20  16:36:40  weir]-->
<!-- -->
<!-- Revision 1.1.2.4  1994/06/13  18:22:39  devobj-->
<!-- 	cr10872 - fix copyright-->
<!-- 	[1994/06/13  18:20:04  devobj]-->
<!-- -->
<!-- Revision 1.1.2.3  1994/04/04  18:04:45  rom-->
<!-- 	{enh, 10129, R1.1}-->
<!-- 	Add .nr H1 0 to make this file become Appendix A.-->
<!-- 	[1994/04/04  18:04:25  rom]-->
<!-- -->
<!-- Revision 1.1.2.2  1994/03/14  22:00:57  rom-->
<!-- 	{enh, 10129, R1.1}-->
<!-- 	Fix pathnames of included files for new three-book organization.-->
<!-- 	[1994/03/14  21:20:34  rom]-->
<!-- -->
<!-- Revision 1.1.2.1  1994/03/11  23:05:12  rom-->
<!-- 	{enh, 10129, R1.1}-->
<!-- 	Initial split of App Dev Guide into three books and creation of-->
<!-- 	Intro and Style Guide.-->
<!-- 	[1994/03/11  23:01:57  rom]-->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<Chapter Id="ADGISG.SAMPL.div.1">
<Title>A Sample Application</Title>
<!-- - -->
<!-- -->
<Para>This chapter presents the complete code for a generic sample application that
illustrates the recommended policies. The code is as generic as possible in
the sense that it demonstrates things that most servers need to do. This
generic server code is contained in the <Filename>sample_server.c</Filename> and
<Literal>sample_server.h</Literal> modules. The application-specific portion consists of a
set of simple examples to illustrate various styles of RPC data usage, including
pointers, pipes, and context handles. These illustrations are contained in
<Filename>sample_manager.c</Filename> (the server side) and <Literal>sample_client.c</Literal> (the client
side). <Literal>sample.idl</Literal> contains a set of sample interface definitions for the
illustrated usages.
<!-- -->
<!-- -->
<!-- - -->
<?sml-break><?sml-need 12></Para>
<Sect1 Id="ADGISG.SAMPL.div.2">
<Title>The Generic Server</Title>
<!-- - -->
<!-- -->
<Para>The generic server implemented by <Filename>sample_server.c</Filename> demonstrates a variety
of tasks that most servers need to carry out, such as exporting bindings,
creating an authentication identity, establishing an ACL manager, and handling
asynchronous signals. As much as possible, the bulk of each task is implemented
as one or more separate functions. This modularity makes it easier to understand
the requirements for coding each task since each function or related set of
functions can be studied separately. Also, because the tasks performed are fairly
generic, the functions should be reusable in something close to the form presented
here by many servers.
</Para>
<Para>The IDL file <Literal>sample.idl</Literal> is included here mainly to demonstrate the data type
declarations used for the ACL manager. A more complete IDL file is given in Section
A.2 to show how the illustrated RPC data types are declared.
<!-- -->
<?sml-break><?sml-point-size 9>
<!--no-op:  12-->
</Para>
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.1;
&ADGISG.SAMPL.ent.2;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
<!-- -->
<Para>The IDL file <Filename>sample_db.idl</Filename> and the ACF file <Filename>sample_db.idl</Filename> are required
to generate a server-only stub for the database serialization routines used by the
ACL manager.
<!-- -->
<?sml-break><?sml-need 12><?sml-point-size 9>
<!--no-op:  12-->
</Para>
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.3;
&ADGISG.SAMPL.ent.4;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
<!-- -->
<Para>The generic server is then implemented by <Literal>sample_server.h</Literal> and
<Filename>sample_server.c</Filename>.
<!-- -->
<?sml-break><?sml-need 4.5i><?sml-point-size 9>
<!--no-op:  12-->
</Para>
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.5;
&ADGISG.SAMPL.ent.6;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
<!-- -->
<Para>Note that the server code contained in these files is nearly all generic. In the ACL
manager, the only application specific elements are the type of data stored in the
object database, declared in <Literal>sample.idl</Literal>, and the name and object UUID for the
initial object created during ACL manager setup. The export objects operation uses
application-specific names and object uuids. The signal catcher thread installs
application-specific handling for asynchronous signals, although the actual signal
handling code simply causes the listen loop to return and invoke the generic cleanup
operations.
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<?sml-break><?sml-need 4.5i>
<!-- - -->
</Para>
</Sect1>
<Sect1 Id="ADGISG.SAMPL.div.3">
<Title>Object Bind Interface</Title>
<!-- - -->
<!-- -->
<!-- -->
<?sml-break>
<?sml-point-size 9>
<!--no-op:  12-->
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.7;
&ADGISG.SAMPL.ent.8;
&ADGISG.SAMPL.ent.9;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- - -->
</Sect1>
<Sect1 Id="ADGISG.SAMPL.div.4">
<Title>Manager and Client Illustrations</Title>
<!-- - -->
<!-- -->
<Para>Most of the application-specific server code is contained in <Filename>sample_manager.c</Filename>.
Since generic client tasks are so simple, the whole client is contained in
<Literal>sample_client.c</Literal>.
<!-- -->
<!-- These still need to have the RPC data usage examples inserted-->
<!-- -->
<?sml-break><?sml-point-size 9>
<!--no-op:  12-->
</Para>
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.10;
&ADGISG.SAMPL.ent.11;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
<!-- -->
<!-- -->
<!-- - -->
</Sect1>
<Sect1 Id="ADGISG.SAMPL.div.5">
<Title>Message (sams) File</Title>
<!-- - -->
<!-- -->
<Para>The sample application's <Command>sams</Command> file, which contains definitions for
various messages output by the serviceability interface routines, is as
follows:
<!-- -->
<!-- -->
<?sml-break><?sml-point-size 9>
<!--no-op:  12-->
</Para>
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.12;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
<!-- -->
<!-- -->
<!-- -->
<!-- - -->
<?sml-break>
<?sml-need 25>
</Sect1>
<Sect1 Id="ADGISG.SAMPL.div.6">
<Title>Makefile</Title>
<!-- - -->
<!-- -->
<Para>A generic Makefile suitable for building the sample code is as follows:
<!-- -->
<?sml-break><?sml-point-size 9>
<!--no-op:  12-->
</Para>
<InformalExample>
<Para>
<ProgramListing role="page-wide">
&ADGISG.SAMPL.ent.13;
</ProgramListing>
</Para>
</InformalExample>
<?sml-point-size 12>
<!--no-op:  14-->
</Sect1>
</Chapter>
<!--+ 11/13/96 22:48:26
    | tagMorph:  $Id: sample.sgm,v 1.1.2.7 1996/11/25 18:18:59 carrig Exp $
    | tagMorph library:  $Id: sample.sgm,v 1.1.2.7 1996/11/25 18:18:59 carrig Exp $
    | sml-to-docbook:  1.24
    +-->
