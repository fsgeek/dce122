<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: sec_admin.8sec,v $
# Revision 1.1.2.7  1996/12/15  19:50:51  carrig
# 	{enh,R1.2.2}
# 	Minor edits
# 	[1996/12/15  19:50:24  carrig]
#
# Revision 1.1.2.6  1996/12/13  18:13:33  carrig
# 	{enh,R1.2.2}
# 	Corrections to Synopses
# 	[1996/12/13  18:12:43  carrig]
# 
# Revision 1.1.2.5  1996/12/01  20:57:50  carrig
# 	{enh,R1.2.2}
# 	Ward's comments
# 	[1996/12/01  20:57:01  carrig]
# 
# Revision 1.1.2.4  1996/11/22  21:20:48  carrig
# 	{enh,R1.2.2}
# 	Ready for editor
# 	[1996/11/22  21:19:59  carrig]
# 
# Revision 1.1.2.3  1996/11/21  20:43:27  wardr
# 	{edit,R1.2.2}
# 	Init capped heads
# 	[1996/11/21  20:42:28  wardr]
# 
# Revision 1.1.2.2  1996/11/20  20:16:09  carrig
# 	{enh,R1.2.2}
# 	VarListEntry
# 	[1996/11/20  20:15:19  carrig]
# 
# Revision 1.1.2.1  1996/11/11  23:23:50  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 	[1996/11/11  23:17:53  wardr]
# 
# $EndLog$
-->
<!---->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
]>
-->
<RefEntry Id="DCECR.MAN171.rsml.1">
<RefMeta>
<RefEntryTitle>sec_admin</RefEntryTitle>
<ManVolNum>8sec</ManVolNum>
</RefMeta>
<RefNameDiv>
<RefName><Command>sec_admin</Command></RefName>
<RefPurpose>Registry replica administration tool
</RefPurpose>
</RefNameDiv>
<!---->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the-->
<!-- src directory for the full copyright text.-->
<!---->
<!---->
<!-- HISTORY -->
<!-- Revision 1.1.8.13  1995/12/18  17:25:07  rcb-->
<!-- 	PH1.1: final fixes-->
<!-- 	[1995/12/18  13:43:21  rcb]-->
<!---->
<!-- Revision 1.1.8.12  1995/10/18  13:52:24  rcb-->
<!-- 	no change-->
<!-- 	[1995/10/17  20:11:58  rcb]-->
<!-- -->
<!-- 	PH1.1: editorial improvement and Prentice-Hall publish formatting-->
<!-- 	[1995/10/17  13:47:18  rcb]-->
<!-- -->
<!-- 	PH1.1: editorial improvement and Prentice-Hall publish formatting-->
<!-- 	[1995/10/13  21:34:31  rcb]-->
<!-- -->
<!-- Revision 1.1.8.11  1995/10/09  13:41:49  rcb-->
<!-- 	1.1PH: interim edits-->
<!-- 	[1995/10/06  20:45:55  rcb]-->
<!-- -->
<!-- Revision 1.1.8.10  1995/09/22  18:39:39  rcb-->
<!-- 	preliminary editing (including outstanding 1.1 edits) for 1.1PH, 1.2-->
<!-- 	[1995/09/22  18:32:07  rcb]-->
<!-- -->
<!-- Revision 1.1.8.9  1994/10/18  19:38:40  millette-->
<!-- 	(def,9373,R1.1)-->
<!-- 	More work on adding propagation states-->
<!-- 	[1994/10/18  19:38:07  millette]-->
<!-- -->
<!-- Revision 1.1.8.8  1994/09/02  18:07:30  hileman-->
<!-- 	Added caveat and list of subcommands-->
<!-- 	that do not have dcecp equivalents-->
<!-- 	[1994/09/02  18:07:00  hileman]-->
<!-- -->
<!-- Revision 1.1.8.7  1994/09/02  18:03:56  millette-->
<!-- 	(def,9373,R1.1)-->
<!-- 	Add propagation states-->
<!-- 	(def,9368,R1.1)-->
<!-- 	Add software version and propagation queue seqnos to-->
<!-- 	output of info -f-->
<!-- 	[1994/09/02  18:03:29  millette]-->
<!-- -->
<!-- Revision 1.1.8.6  1994/06/21  19:38:25  millette-->
<!-- 	(def, 9306, R1.1)-->
<!-- 	Fix initial message.-->
<!-- 	[1994/06/21  19:37:52  millette]-->
<!-- -->
<!-- Revision 1.1.8.5  1994/05/25  21:30:11  millette-->
<!-- 	(enh, 10774, R1.1)-->
<!-- 	Added change_master, become -master and -slave-->
<!-- 	[1994/05/25  21:29:36  millette]-->
<!-- -->
<!-- Revision 1.1.8.4  1993/11/05  16:03:42  zahn-->
<!-- 	{def,9360,R1.0.3}-->
<!-- -->
<!-- 	Fixed "processes" typo - changed-->
<!-- 	to "process".-->
<!-- 	[1993/11/05  16:03:10  zahn]-->
<!-- -->
<!-- Revision 1.1.8.3  1993/07/27  03:12:51  tmw-->
<!-- 	Added index entries for second version of master index.-->
<!-- 	[1993/07/27  02:57:59  tmw]-->
<!-- -->
<!-- Revision 1.1.8.2  1993/06/18  20:13:46  millette-->
<!-- 	Bug 8134: Release Notes fixes-->
<!-- 	[1993/06/18  20:11:12  millette]-->
<!-- -->
<!-- Revision 1.1.6.9  1993/04/01  16:20:40  weir-->
<!-- 	Fixed missing page break with -nochange format-->
<!-- 	[1993/04/01  16:19:59  weir]-->
<!-- -->
<!-- Revision 1.1.6.8  1993/03/15  21:43:50  buckler-->
<!-- 	Moved .zA code that was interfering with page break.-->
<!-- 	[1993/03/15  21:42:01  buckler]-->
<!-- -->
<!-- Revision 1.1.6.7  1993/03/02  22:27:53  buckler-->
<!-- 	Fixed mismatching .zA and .zZ codes-->
<!-- 	[1993/03/02  22:27:26  buckler]-->
<!-- -->
<!-- Revision 1.1.6.6  1993/02/22  21:29:12  millette-->
<!-- 	Bug 7274: 1.0.2 review corrections-->
<!-- 	[1993/02/22  21:26:17  millette]-->
<!-- -->
<!-- Revision 1.1.6.5  1993/01/28  02:38:03  dbelch-->
<!-- 	Embedding copyright notice-->
<!-- 	[1993/01/28  00:57:00  dbelch]-->
<!-- -->
<!-- Revision 1.1.6.4  1993/01/08  22:27:30  millette-->
<!-- 	Bug 6780: Fixed two typos and one garbled sentence.  No-->
<!-- 	change bars used; changes were editorial.-->
<!-- 	[1993/01/08  22:25:51  millette]-->
<!-- -->
<!-- Revision 1.1.6.3  1992/12/15  18:28:38  millette-->
<!-- 	Bug 6450: Updated for 1.0.2 functionality.  To make this change,-->
<!-- 	I replaced the entire file.-->
<!-- 	[1992/12/15  18:26:47  millette]-->
<!-- -->
<!-- Revision 1.1.6.2  1992/09/10  17:49:25  weir-->
<!-- 	Removed change bar macros; moved to 1.0.2doc tree-->
<!-- 	[1992/09/10  17:41:17  weir]-->
<!-- -->
<!-- Revision 1.1.4.2  1992/09/08  21:53:06  casey-->
<!-- 	Prentice Hall production - index corrections-->
<!-- 	[1992/09/08  17:29:02  casey]-->
<!-- -->
<!-- 	Prentice Hall production-->
<!-- 	[1992/08/14  19:29:06  casey]-->
<!-- -->
<!-- Revision 1.1.2.2  1992/06/16  15:18:47  buckler-->
<!-- 	Fixed unterminated list found during book build.-->
<!-- 	[1992/06/16  15:17:55  buckler]-->
<!-- -->
<!-- Revision 1.1  1992/01/29  15:59:50  damon-->
<!-- 	Initial revision-->
<!-- -->
<!---->
<!-- (c) Copyright 1991, Open Software Foundation, Inc.  ALL RIGHTS RESERVED-->
<!-- Copyright Hewlett-Packard Company 1991-->
<!---->
<!--All Rights Reserved.  Reproduction, adaptation,-->
<!--or translation without prior written permission-->
<!--is prohibited, except as allowed under the-->
<!--copyright laws-->
<!--  -->
<IndexTerm Id="DCECR.MAN171.indx.1">
<Primary>Security Servers</Primary>
<Secondary>administering</Secondary>
</IndexTerm>
<IndexTerm Id="DCECR.MAN171.indx.2">
<Primary>master keys</Primary>
<Secondary>creating</Secondary>
</IndexTerm>
<IndexTerm Id="DCECR.MAN171.indx.3">
<Primary>registry database</Primary>
<Secondary>updating</Secondary>
</IndexTerm>
<IndexTerm Id="DCECR.MAN171.indx.4">
<Primary>Security Service commands</Primary>
<Secondary><Command>sec_admin</Command></Secondary>
</IndexTerm>
<RefSynopsisDiv>
<CmdSynopsis>
<Command>sec_admin</Command>
<Arg Choice="opt"><Option>site</Option><Replaceable>name</Replaceable></Arg>
<Arg Choice="opt"><Option>nq</Option></Arg>
</CmdSynopsis>
</RefSynopsisDiv>
<RefSect1>
<Title>Options</Title>
<VariableList>
<VarListEntry>
<Term><Option>site</Option> <Symbol Role="Variable">name</Symbol></Term>
<ListItem>
<Para>Causes <Command>sec_admin</Command> to bind to the replica
specified by the <Symbol Role="Variable">name</Symbol> argument.  If the option is not supplied, 
<Command>sec_admin</Command> binds randomly to any replica in the local cell.
The <Symbol Role="Variable">name</Symbol> argument can be one of the following:
<!--no-op:  l-->
</Para>
<ItemizedList>
<ListItem>
<Para>A specific cell_name (or <Literal>/.:</Literal> for the local cell), to bind to any 
replica in the named cell.
</Para>
</ListItem>
<ListItem>
<Para>The global name of a replica, to bind to 
that specific replica in that specific cell.
</Para>
</ListItem>
<ListItem>
<Para>The name of a replica as it appears on the replica list, to bind to 
that replica in the local cell.
</Para>
</ListItem>
<ListItem>
<Para>A string binding to a specific replica.  An example of a string binding is 
<Literal>ncadg_ip_udp:15.22.144.163</Literal>.  This form is used primarily for debugging 
or if the Cell Directory Service (CDS) is not available. 
</Para>
</ListItem>
</ItemizedList>
<!--no-op:  b-->
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>nq</Option></Term>
<ListItem>
<Para>Turns off queries initiated by certain 
<Command>sec_admin</Command> subcommands before they perform a specified operation. 
For example, the <Command>delrep</Command> subcommand deletes a registry replica;
before the deletion, <Command>sec_admin</Command> prompts 
for verification.  If you invoke <Command>sec_admin</Command> with the <Option>nq</Option> option, 
the deletion is performed without prompting.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
</RefSect1>
<RefSect1>
<Title>Description</Title>
<Note>
<Para>With the exception of the following subcommands, this command is
replaced at DCE Version 1.1 by the <Command>dcecp</Command> command.  This command may
be fully replaced by the <Command>dcecp</Command> command in a future release of
DCE, and may no longer be supported at that time.
</Para>
<ItemizedList>
<ListItem>
<Para><Literal>monitor</Literal>
</Para>
</ListItem>
<ListItem>
<Para><Command>exit</Command>
</Para>
</ListItem>
<ListItem>
<Para><Command>help</Command>
</Para>
</ListItem>
<ListItem>
<Para><Command>quit</Command>
</Para>
</ListItem>
</ItemizedList>
</Note>
<Para>The registry database is replicated: each instance of a registry server, 
<Command>secd</Command>, maintains a working copy of the database in virtual memory and 
on disk.  One server, called the master replica,  
accepts updates and handles the subsequent propagation of changes to 
all other replicas.  All other 
replicas are  slave replicas, which accept only queries. 
Each cell has one master replica and numerous slave replicas.  
</Para>
<Para>Using the <Command>sec_admin</Command> command, you can:
</Para>
<ItemizedList>
<ListItem>
<Para>View a list of replicas.
</Para>
</ListItem>
<ListItem>
<Para>Delete a replica.
</Para>
</ListItem>
<ListItem>
<Para>Reinitialize a replica.
</Para>
</ListItem>
<ListItem>
<Para>Stop a replica.
</Para>
</ListItem>
<ListItem>
<Para>Put the master replica into and out of the maintenance state.
</Para>
</ListItem>
<ListItem>
<Para>Generate a new master key used to encrypt principal keys.
</Para>
</ListItem>
<ListItem>
<Para>Turn &ensp;the master &ensp;registry into &ensp;a slave &ensp;registry and &ensp;a slave registry into the 
master registry.
</Para>
</ListItem>
</ItemizedList>
<Para>Note that <Command>sec_admin</Command> cannot add, delete, or modify information in the 
database, such as names and accounts.  Use <Command>rgy_edit</Command> to 
modify registry database entries.  
</Para>
<RefSect2>
<Title>The Default Replica and Default Cell</Title>
<Para>Most <Command>sec_admin</Command> commands are directed to a default replica.  When 
<Command>sec_admin</Command> is invoked, it automatically binds to a replica in the 
local cell.  This replica becomes the default replica.
</Para>
</RefSect2>
<RefSect2>
<Title>Identifying the Default Replica and the Default Cell</Title>
<Para>Use the <Filename>site</Filename> subcommand to change the default replica and, 
optionally, the default cell.  
When you use the <Filename>site</Filename> subcommand, you can supply the name of a 
specific replica, or you can simply supply the name of a cell.  
If you supply a cell name, <Command>sec_admin</Command> binds to a 
replica in that cell randomly.  If you supply a specific 
replica name, <Command>sec_admin</Command> binds to that replica.
</Para>
<Para>Specifically, you can supply any of the following 
names to the <Filename>site</Filename> subcommand:
</Para>
<ItemizedList>
<ListItem>
<Para>A cell name.  If you enter a cell name, the named cell becomes the default 
cell.  The <Command>sec_admin</Command> command randomly chooses a replica to bind to in the 
named cell, and that replica becomes the default replica.
</Para>
</ListItem>
<ListItem>
<Para>The global name given to the replica when it was created.  A global 
name identifies a specific replica in a specific cell.  That cell becomes the 
default cell and that replica the default replica.  
</Para>
</ListItem>
<ListItem>
<Para>The &ensp;replica's name &ensp;as it &ensp;appears on &ensp;the replica &ensp;list (a &ensp;list maintained by 
each security server containing the network addresses of each 
replica in the local cell).  That replica becomes the default replica and 
the cell in which the replica exists becomes the default cell.  
</Para>
</ListItem>
<ListItem>
<Para>The network address of the host on which the replica is running.  
The replica on that host becomes the default replica, and the cell in 
which the host exists becomes the default cell.  
</Para>
</ListItem>
</ItemizedList>
</RefSect2>
<RefSect2>
<Title>Naming the Default Replica</Title>
<Para>As an example, assume that the following is true of a
replica named <Filename>subsys/dce/sec/rs_server_250_2</Filename>: 
</Para>
<ItemizedList>
<ListItem>
<Para>It exists in the local cell <Literal>/.../dresden.com</Literal>.
</Para>
</ListItem>
<ListItem>
<Para>It has a global name of <Literal>/.../dresden.com/subsys/dce/sec/rs_server_250_2</Literal>.
</Para>
</ListItem>
<ListItem>
<Para>It is named <Filename>subsys/dce/sec/rs_server_250_2</Filename> on the replica list.
</Para>
</ListItem>
<ListItem>
<Para>It runs on a host whose <Literal>ip</Literal> network address is <Literal>15.22.144.248</Literal>.
</Para>
</ListItem>
</ItemizedList>
<Para>This replica can be identified to the <Filename>site</Filename> subcommand in any 
of the following ways:
</Para>
<VariableList>
<VarListEntry role="linebreak">
<Term><Literal>/.../dresden.com/subsys/dce/sec/rs_server_250_2</Literal></Term>
<ListItem>
<Para>The replica's full global name.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Filename>subsys/dce/sec/rs_server_250_2</Filename></Term>
<ListItem>
<Para>The replica's cell-relative name on the replica list. 
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>ncadg_ip_udp:15.22.144.248</Literal></Term>
<ListItem>
<Para>The network address of the host on which the replica runs. 
</Para>
</ListItem>
</VarListEntry>
</VariableList>
</RefSect2>
<RefSect2>
<Title>Naming the Default Cell</Title>
<Para>When a default replica is identified specifically, its cell 
becomes the default cell.  In the example in the previous section,
the default cell is <Literal>/.../dresden.com</Literal>.
</Para>
<Para>You can specify simply a cell name to the <Filename>site</Filename> subcommand.  
When this is done, any replica in that cell is selected as the 
default replica.
</Para>
<Para><?sml-need 5>For example, assume that the following 
are replicas in the cell <Literal>/.../bayreuth.com</Literal>:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>/.../bayreuth.com/subsys/dce/sec/rs_server_300_1
<?sml-space .5>/.../bayreuth.com/subsys/dce/sec/rs_server_300_2
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>If you enter <Filename>site /.../bayreuth.com</Filename>, then
<Literal>/.../bayreuth.com</Literal> becomes the default cell and one of the
following becomes the default replica:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>/.../bayreuth.com/subsys/dce/sec/rs_server_300_1
<?sml-space .5>/.../bayreuth.com/subsys/dce/sec/rs_server_300_2
</UserInput></ProgramListing></Para>
</InformalExample>
</RefSect2>
<RefSect2>
<Title>Automatic Binding to the Master</Title>
<Para>Some of the <Command>sec_admin</Command> subcommands can act only on the master registry 
and thus require binding to the master registry.  If you execute a 
subcommand that acts only on the master and the master is not the 
default replica, <Command>sec_admin</Command> attempts to bind to the 
master replica in the current default cell automatically.  If this attempt is 
successful, <Command>sec_admin</Command> displays a warning message informing you 
that the default replica has been changed to the master registry.  The 
master registry will then remain the default replica until you change 
it with the <Filename>site</Filename> subcommand.  If the attempt to bind is not 
successful, <Command>sec_admin</Command> displays an error message, and the subcommand 
fails. 
</Para>
</RefSect2>
<RefSect2>
<Title>Invoking sec_admin</Title>
<Para>When you invoke <Command>sec_admin</Command>, it displays the current default 
replica's full global name 
and the cell in which the replica exists.  
Then it displays the <Literal>sec_admin></Literal> prompt. 
</Para>
<InformalExample>
<Para><ProgramListing>
<Literal>
sec_admin 
     Default replica: /.../dresden.com/subsys/dce/sec/music 
     Default cell: /.../dresden.com
</Literal>
sec_admin>
</ProgramListing></Para>
</InformalExample>
<Para>At the <Literal>sec_admin></Literal> prompt, you can enter any of the 
<Command>sec_admin</Command> subcommands. 
</Para>
</RefSect2>
<RefSect2>
<Title>Subcommands</Title>
<Para>The subcommand descriptions that follow use <Symbol Role="Variable">default_replica</Symbol> 
to indicate the default replica and <Symbol Role="Variable">other_replica</Symbol> to 
indicate a replica other than the default.  The <Symbol Role="Variable">other_replica</Symbol> 
argument must identify a replica in the default cell.  
It is specified by its name on the cell's replica list 
(that is, by its cell-relative name).
Use the <Command>lrep</Command> subcommand to view the default cell's replica list.
</Para>
<VariableList>
<?sml-need 7>
<VarListEntry role="linebreak">
<Term><Literal>become</Literal> [<Option>master</Option>] [<Option>slave</Option>]</Term>
<ListItem>
<Para>The <Option>master</Option> option makes the current default replica
(which must be a slave) the master replica.  
</Para>
<Para>The <Option>slave</Option> option makes the current default replica
(which must be the master) a slave replica.  
</Para>
<Para><?sml-need 5>This method of changing to master or slave can cause updates to be lost.  
The <Literal>change_master</Literal>
subcommand is the preferred means of designating a different 
master replica.  However, you may find the <Literal>become -master</Literal> command 
useful if the master server is irrevocably damaged and you are unable 
to use <Literal>change_master</Literal>.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>change_master -to</Literal> <Symbol Role="Variable">other_replica</Symbol></Term>
<ListItem>
<Para>Makes the replica specified by <Symbol Role="Variable">other_replica</Symbol> the master replica.  
To perform this operation, <Symbol Role="Variable">other_replica</Symbol> must be a slave, and 
the current default replica must be the master.  
If the current default replica is not the 
master, <Command>sec_admin</Command> attempts to bind to the master.
If the change operation is successful, the current master does the
following:
</Para>
<OrderedList>
<ListItem>
<Para>Applies all updates to <Symbol Role="Variable">other_replica</Symbol>.
</Para>
</ListItem>
<ListItem>
<Para>Becomes a slave.
</Para>
</ListItem>
<ListItem>
<Para>Tells <Symbol Role="Variable">other_replica</Symbol> to become the master.
</Para>
</ListItem>
</OrderedList>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Command>delr</Command>[<Literal>ep</Literal>] <Symbol Role="Variable">other_replica</Symbol> [<Option>force</Option>]</Term>
<ListItem>
<Para>Deletes the registry replica identified by <Symbol Role="Variable">other_replica</Symbol>. 
To perform this operation, the current default replica must be the master.  
If it is not, <Command>sec_admin</Command> attempts to bind to the master.
If the delete operation is successful, the master does the following:
</Para>
<OrderedList>
<ListItem>
<Para>Marks <Symbol Role="Variable">other_replica</Symbol> as deleted.
</Para>
</ListItem>
<ListItem>
<Para>Propagates the deletion to all replicas on its replica list.
</Para>
</ListItem>
<ListItem>
<Para>Delivers the delete request to <Symbol Role="Variable">other_replica</Symbol>.
</Para>
</ListItem>
<ListItem>
<Para>Removes <Symbol Role="Variable">other_replica</Symbol> from its replica list.
</Para>
</ListItem>
</OrderedList>
<Para>The <Option>force</Option> option causes a more drastic deletion.  
It causes the master to first delete <Symbol Role="Variable">other_replica</Symbol> 
from its replica list and then to propagate the deletion to the replicas 
that remain on its list.  Since this operation never 
communicates with the deleted replica, you should use <Option>force</Option> 
only when the replica has died irrecoverably.  If you use <Option>force</Option> 
while <Symbol Role="Variable">other_replica</Symbol> is still running, you should then use the 
<Command>destroy</Command> subcommand to eliminate the deleted replica. 
<?sml-break><?sml-need 4></Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>h</Literal>[<Literal>elp</Literal>] [<Symbol Role="Variable">command</Symbol>]</Term>
<ListItem>
<Para>Lists the <Command>sec_admin</Command> subcommands and shows their 
allowed abbreviations.  If <Symbol Role="Variable">command</Symbol> is specified, displays 
help for the specified command.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Command>info</Command> [<Option>full</Option>] </Term>
<ListItem>
<Para>Displays status information about the default replica.  The <Command>info</Command> 
subcommand contacts the default replica to obtain the appropriate information.  
If this information is not available, <Command>info</Command> prints the replica name and 
a message stating that the information is not available. 
</Para>
<Para>Without the <Option>full</Option> option, <Command>info</Command> displays the following:
<!--no-op:  l-->
</Para>
<ItemizedList>
<ListItem>
<Para>The default replica's name and the name of the cell in which the replica exists.
</Para>
</ListItem>
<ListItem>
<Para>Whether the replica is a master or a slave.
</Para>
</ListItem>
<ListItem>
<Para>The date and time the replica was last updated and the update sequence number.
<!--no-op:  b-->
</Para>
</ListItem>
<ListItem>
<Para>An indication of the replica's state, as follows:
</Para>
<VariableList>
<VarListEntry>
<Term><Literal>Bad State</Literal></Term>
<ListItem>
<Para>The state of the replica prohibits the requested operation.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>Uninitialized</Literal></Term>
<ListItem>
<Para>The database is a stub database that has not been initialized by 
the master replica or another up-to-date replica
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>Initializing</Literal></Term>
<ListItem>
<Para>The replica is in the process of being initialized by the 
master replica or another up-to-date replica
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>In Service</Literal></Term>
<ListItem>
<Para>The replica is available for queries and propagation updates if it is a 
slave replica or queries and updates if it is the master replica
<!-- .LI -->
<!-- \*LRenaming\*O\(emThe replica is in process of renaming itself-->
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Copying Database</Literal></Term>
<ListItem>
<Para>The replica is in the process of initializing (copying its database to) 
another replica 
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Saving Database</Literal></Term>
<ListItem>
<Para>The replica is in the process of saving its database to disk.
<?sml-break><?sml-need 3></Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>In Maintenance</Literal></Term>
<ListItem>
<Para>The replica is unavailable for updates but will accept queries 
<?sml-break><?sml-need 3></Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Changing Master Key</Literal></Term>
<ListItem>
<Para>The replica is in the process of having its master key changed 
</Para>
</ListItem>
</VarListEntry>

<VarListEntry role="linebreak">
<Term><Literal>Becoming Master</Literal></Term>
<ListItem>
<Para>The replica is in the process of becoming the master replica 
(applicable to slave replicas only)
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Becoming Slave</Literal></Term>
<ListItem>
<Para>The master replica is in the process of becoming a slave replica 
(applicable to the master replicas only)
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>Closed</Literal></Term>
<ListItem>
<Para>The replica is in the process of stopping
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>Deleted</Literal></Term>
<ListItem>
<Para>The replica is in the process of deleting itself
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Duplicate Master</Literal></Term>
<ListItem>
<Para>The replica is a duplicate master and should be deleted  
</Para>
</ListItem>
</VarListEntry>
</VariableList>
<Para>The master replica is available for queries when it is in
the <Literal>In Service</Literal>, <Literal>Copying Database</Literal>, <Literal>In Maintenance</Literal>,
<Literal>Changing Master Key</Literal>, and <Literal>Becoming Slave</Literal> states.
It is available for updates only when it is in the 
<Literal>In Service</Literal> state.
</Para>
<Para>A slave replica is available for queries when it is in the
the <Literal>In Service</Literal>, <Literal>Copying Database</Literal>, 
<Literal>Changing Master Key</Literal>, and <Literal>Becoming Master</Literal> states.
It accepts updates from the master replica only when it is in the 
<Literal>In Service</Literal> state.
It accepts a request from the master replica to initialize only when it is
in the <Literal>Uninitialized</Literal> or <Literal>In Service</Literal> state.
</Para>
</ListItem>
</ItemizedList>
<Para>The <Option>full</Option> option displays all the above information and the 
following information as well:
<!--no-op:  l-->
</Para>
<ItemizedList>
<ListItem>
<Para>The default replica's unique identifier.
</Para>
</ListItem>
<ListItem>
<Para>The replica's network addresses.
</Para>
</ListItem>
<ListItem>
<Para>The unique identifier of the cell's master replica.
</Para>
</ListItem>
<ListItem>
<Para>The network addresses of the cell's master replica.
</Para>
</ListItem>
<ListItem>
<Para>The master sequence number, which is the sequence number of 
the event that made the replica the master.
</Para>
</ListItem>
<ListItem>
<Para>If the replica is the master, the update sequence numbers that 
are still in the propagation queue and have yet to be propagated.
</Para>
</ListItem>
<ListItem>
<Para>The DCE software version number.
</Para>
</ListItem>
</ItemizedList>
<!--no-op:  b-->
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>initr</Literal>[<Literal>ep]</Literal> <Symbol Role="Variable">other_replica</Symbol></Term>
<ListItem>
<Para>Reinitializes a replica by copying an up-to-date database to 
<Symbol Role="Variable">other_replica</Symbol>.  The master replica initiates and guides the operation.  
If the operation is successful, the following actions take place:
</Para>
<OrderedList>
<ListItem>
<Para>The master replica does the following:
</Para>
<OrderedList>
<ListItem>
<Para>Marks <Symbol Role="Variable">other_replica</Symbol> for reinitialization.
</Para>
</ListItem>
<ListItem>
<Para>Tells <Symbol Role="Variable">other_replica</Symbol> to reinitialize itself.
</Para>
</ListItem>
<ListItem>
<Para>Gives <Symbol Role="Variable">other_replica</Symbol> a list of replicas with up-to-date databases.
</Para>
</ListItem>
</OrderedList>
</ListItem>
<ListItem>
<Para>The <Symbol Role="Variable">other_replica</Symbol> picks a replica from the list and asks that replica 
to initialize it (that is, to copy its database to <Symbol Role="Variable">other_replica</Symbol>).
</Para>
</ListItem>
</OrderedList>
<Para>To perform this operation, <Symbol Role="Variable">other_replica</Symbol> must be a slave, and 
the current default replica must be the master.  
If the current default replica is not the 
master, <Command>sec_admin</Command> attempts to bind to the master. 
</Para>
<Para>This subcommand is generally not used under normal conditions.  
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Command>lr</Command>[<Literal>ep</Literal>] [<Option>s</Option>[<Literal>tate</Literal>]] [<Option>u</Option>[<Literal>uid</Literal>]] [<Option>a</Option>[<Literal>ddr</Literal>]] [<Option>p</Option>[<Literal>rop</Literal>]] [<Option>al</Option>[<Literal>l</Literal>]]</Term>
<ListItem>
<Para>Lists the replicas on the default replica's replica list.  
</Para>
<Para>If you enter no options, the display includes the 
replica name and whether or not it is the master replica.  In addition if the 
master replica's list is being displayed, slave replicas marked for deletion 
are noted.  With options, the display includes this information and the 
information described in the following paragraphs.
</Para>
<Para><?sml-need 5>The <Option>state</Option> option shows each replica's current state, the 
date and time the replica was last updated, and the update sequence number.  
To obtain this information, <Command>lrep</Command> contacts each replica.  
If this information is not available from the replica, <Command>lrep</Command> 
prints the replica name and a message stating the information is 
not available.
</Para>
<Para>The <Option>addr</Option> option shows each replica's network addresses. 
The <Option>uuid</Option> option shows each replica's unique identifier.
The <Option>prop</Option> option shows the following:
<!--no-op:  l-->
</Para>
<ItemizedList>
<ListItem>
<Para>The date and time  of the last update the master sent to each slave replica.
</Para>
</ListItem>
<ListItem>
<Para>The sequence number of the last update to each slave replica.
</Para>
</ListItem>
<ListItem>
<Para>The number of updates not yet applied to each slave replica.
</Para>
</ListItem>
<ListItem>
<Para>The status of the master replica's last communication with each slave replica.
</Para>
</ListItem>
<ListItem>
<Para>The propagation state of each slave replica.  This state, illustrates 
how the master replica views the slave replica, can be 
any of the following:
<!--no-op:  b-->
</Para>
<VariableList>
<VarListEntry>
<Term><Literal>Bad State</Literal></Term>
<ListItem>
<Para>The state of the replica prohibits the requested operation.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Marked for Initialization</Literal></Term>
<ListItem>
<Para>The replica has been marked for deletion by the master replica.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>Initialized</Literal></Term>
<ListItem>
<Para>The replica has been marked for initialization by the master replica.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>Initializing</Literal></Term>
<ListItem>
<Para>The replica is in the process of being initialized by the master replica.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Ready for Updates</Literal></Term>
<ListItem>
<Para>The replica has been initialized by the master replica and in now available for 
propagation updates from the master replica.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>Marked for Deletion</Literal></Term>
<ListItem>
<Para>The replica has been marked for deletion by the master replica.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
</ListItem>
</ItemizedList>
<Para><?sml-need 2>This information is obtained from the master replica; the slave replicas 
are not contacted for this information.
</Para>
<Para>The <Option>prop</Option> option is valid only for the master.
</Para>
<Para>For slave replicas, the <Option>all</Option> option shows all the information 
above except that displayed by the <Option>prop</Option> option.  
For the master replica, the <Option>all</Option> option shows 
all the information.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>mas</Literal>[<Literal>ter_key</Literal>]   </Term>
<ListItem>
<?sml-break>
<Para>Generates a new master key for the default replica 
and reencrypts account keys using the new 
key.  The new master key is randomly generated.
Each replica (master and slaves) maintains its own master key used to 
access the data in its copy of the database.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>monitor </Literal>[<Option>r</Option> <Symbol Role="Variable">m</Symbol>]</Term>
<ListItem>
<Para>Periodically lists the registry replicas stored in the current default 
replica's replica list.  The list includes each replica's current state, the 
date and time the replica was last updated and the update sequence number.  
Note that this is the same information as that displayed by the <Command>info</Command> 
subcommand with no options.
</Para>
<Para>The <Literal>monitor</Literal> subcommand contacts each replica to obtain the information 
it displays.  If this information is not available from the replica, 
<Literal>monitor</Literal> prints the replica name and a message stating the information is 
not available.
</Para>
<Para>The <Option>r</Option> option causes the replicas to be listed at 
intervals you specify.  The <Symbol Role="Variable">m</Symbol> argument is a number of minutes between 
intervals.  The default is 15 minutes.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Command>destroy</Command> <Symbol Role="Variable">default_replica</Symbol></Term>
<ListItem>
<Para>Destroys the current default replica.  
To perform this operation, the current default replica and the 
default replica you name as <Symbol Role="Variable">default_replica</Symbol> must 
be the same.  This is to confirm your desire to 
perform the deletion.
</Para>
<Para>If the operation is successful, the default replica deletes 
its copy of the registry database and stops running.  
This subcommand does not delete <Symbol Role="Variable">default_replica</Symbol> from the 
replica lists.  Use the <Literal>delrep -force</Literal> subcommand to delete 
the replica from the other replica lists. 
</Para>
<Para>The preferred way to delete replicas is to use the <Command>delrep</Command> 
subcommand.  However, the <Command>destroy</Command> subcommand can 
be used if <Command>delrep</Command> is unusable because the master is 
unreachable or the replica is not on the master's replica list.
<?sml-break><?sml-need 5></Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Filename>site</Filename> [<Symbol Role="Variable">name</Symbol> [<Option>u</Option>[<Literal>pdate</Literal>]]]</Term>
<ListItem>
<Para>Sets or displays the default cell and the default replica.
</Para>
<Para>The <Symbol Role="Variable">name</Symbol> argument identifies the replica to set as the 
default replica and, as a consequence, the default cell.  It can be
one of the following:
<!--no-op:  l-->
</Para>
<ItemizedList>
<ListItem>
<Para>A specific cell_name (or <Literal>/.:</Literal> for the local cell) to make any 
replica in the named cell the default.
</Para>
</ListItem>
<ListItem>
<Para>The global name of a replica to make the specified replica in the specified 
cell the default.
</Para>
</ListItem>
<ListItem>
<Para>The name of a replica as it appears on the replica list to make the named 
replica (which exists in the default cell) the default replica.
</Para>
</ListItem>
<ListItem>
<Para>A string binding to a specific replica.  An example of a string binding is 
<Literal>ncadg_ip_udp:15.22.144.163</Literal>.  This form is used 
primarily for debugging or if CDS is not available. 
</Para>
</ListItem>
</ItemizedList>
<!--no-op:  b-->
<Para>The <Option>u</Option> option specifies that <Command>sec_admin</Command> should find the master 
replica.  Normally you specify the name of a cell for 
<Symbol Role="Variable">name</Symbol> in conjunction with the <Option>u</Option> option.  In this case 
<Command>sec_admin</Command> finds the master replica in that cell.  
If you use a replica name for <Symbol Role="Variable">name</Symbol>, <Command>sec_admin</Command> queries the named 
replica to find the master replica in the named replica's cell.    
</Para>
<Para>If you supply no arguments, <Command>sec_admin</Command> displays the current
default replica and default cell.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Literal>stop</Literal></Term>
<ListItem>
<Para>Stops the security server (<Command>secd</Command>) associated with the default replica.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>sta</Literal>[<Literal>te</Literal>] <Option>maintenance</Option> | <Option>service</Option></Term>
<ListItem>
<Para>Puts the master replica into maintenance state or takes it out of maintenance 
state.  This subcommand is useful for performing backups of the 
registry database.
</Para>
<Para>If the current default replica is not the 
master, <Command>sec_admin</Command> attempts to bind to the master.
</Para>
<Para>The <Option>maintenance</Option> flag causes the master replica to save its database 
to disk and refuse any updates.
</Para>
<Para>The <Option>service</Option> flag causes the master replica to return to its normal 
"in service" state and start accepting updates. 
<?sml-break><?sml-need 2></Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Literal>e</Literal>[<Literal>xit</Literal>] or <Literal>q</Literal>[<Literal>ui</Literal>t]</Term>
<ListItem>
<Para>Ends the <Command>sec_admin</Command> session.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
</RefSect2>
</RefSect1>
<RefSect1>
<Title>Examples</Title>
<OrderedList>
<ListItem>
<Para>The following example invokes <Command>sec_admin</Command> and uses the 
<Command>lrep</Command> subcommand to list replicas on the replica list and their states:
</Para>
<InformalExample>
<Para><ProgramListing><Literal>/opt/dcelocal/bin/sec_admin</Literal>
          Default replica: \
            /.../dresden.com/subsys/dce/sec/rs_server_250_2 
          Default cell: /.../dresden.com
sec_admin> <Literal>lrep  -st</Literal>
  Replicas in cell /.../dresden.com
  (master) subsys/dce/sec/master
               state: in service
               Last update received at:  1993/11/16.12:46:59 
               Last update's seqno:  0.3bc
           subsys/dce/sec/rs_server_250_2 
               state: in service  
               Last update received at:  1993/11/16.12:46:59 
               Last update's seqno:  0.3bc
           subsys/dce/sec/rs_server_250_3 
               state: in service  
               Last update received at:  1993/11/16.12:46:59 
               Last update's seqno:  0.3bc
</ProgramListing></Para>
</InformalExample>
</ListItem>
<ListItem>
<Para>The following example sets the default replica to the master in 
the local cell:
</Para>
<InformalExample>
<Para><ProgramListing>sec_admin> <Literal>site  /.:  -u</Literal>
    Default replica: /.../dresden.com/subsys/dce/sec/master
    Default cell: /.../dresden.com
</ProgramListing></Para>
</InformalExample>
</ListItem>
</OrderedList>
<IndexTerm Id="DCECR.MAN171.indx.5" SpanEnd="DCECR.MAN171.indx.1">
<IndexTerm Id="DCECR.MAN171.indx.6" SpanEnd="DCECR.MAN171.indx.4">
</RefSect1>
<RefSect1>
<Title>Related Information</Title>
<Para><!--no-op:  l-->
Commands:
<Filename MoreInfo="RefEntry">rgy_edit(8sec)</Filename>,
<Filename MoreInfo="RefEntry">dtscp(8dts)</Filename>.
<!--no-op:  b-->
</Para>
</RefSect1>
<!--+ 11/07/96 22:10:27
    | tagMorph:  $Id: sec_admin.8sec,v 1.1.2.7 1996/12/15 19:50:51 carrig Exp $
    | tagMorph library:  $Id: sec_admin.8sec,v 1.1.2.7 1996/12/15 19:50:51 carrig Exp $
    | sml-to-docbook:  1.24
    +-->
</RefEntry>
