<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: scout.sgm,v $
# Revision 1.1.2.6  1996/12/15  23:02:20  wardr
# 	{edit,R1.2.2}
# 	[D[DFiformatting problems before penultimate build
# 	[1996/12/15  23:00:49  wardr]
#
# Revision 1.1.2.5  1996/12/14  23:14:36  wardr
# 	{edit,R1.2.2}
# 	Fixed figure problems
# 	[1996/12/14  23:12:58  wardr]
# 
# Revision 1.1.2.4  1996/11/06  18:47:21  weir
# 	Cleaned up history
# 	[1996/11/06  18:46:18  weir]
# 
# Revision 1.1.2.3  1996/10/28  17:34:01  carrig
# 	{enh,R1.2.2}
# 	Ready for editor
# 	[1996/10/28  17:19:49  carrig]
# 
# Revision 1.1.2.2  1996/10/24  20:10:38  carrig
# 	{enh,R1.2.2}
# 	Fixed tables
# 	[1996/10/24  20:08:50  carrig]
# 
# Revision 1.1.2.1  1996/10/22  20:43:11  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 	[1996/10/22  20:41:25  wardr]
# 
# Revision 1.1.1.2  1996/10/22  20:41:25  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 
# $EndLog$
-->
<!---->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
]>
-->
<!---->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the-->
<!-- src directory for the full copyright text.-->
<!---->
<!---->
<!-- HISTORY-->
<!-- Revision 1.1.10.2  1996/05/24  19:34:44  wfl-->
<!-- 	ODE test of guide chapter.-->
<!-- 	[1996/05/24  19:34:26  wfl]-->
<!---->
<!-- Revision 1.1.10.1  1996/05/14  19:52:45  wardr-->
<!-- 	{enh,R1.2.2}-->
<!-- 	Removed changebars-->
<!-- 	[1996/05/14  19:51:26  wardr]-->
<!-- -->
<!-- Revision 1.1.8.1  1995/09/04  20:08:55  jeff-->
<!-- 	Testing ODE on Labor Day...-->
<!-- 	[1995/09/04  20:08:45  jeff]-->
<!-- -->
<!-- Revision 1.1.6.15  1995/07/24  18:42:44  weir-->
<!-- 	Prentice-Hall corrections-->
<!-- 	[1995/07/24  18:42:09  weir]-->
<!-- -->
<!-- Revision 1.1.6.12  1994/10/11  22:49:12  jeff-->
<!-- 	{defect, 12569, R1.1}-->
<!-- 	Correct text for scout -server/-basename options.-->
<!-- 	[1994/10/11  22:48:47  jeff]-->
<!-- -->
<!-- Revision 1.1.6.11  1994/08/23  21:10:57  jeff-->
<!-- 	Editorial changes.-->
<!-- 	[1994/08/23  21:10:06  jeff]-->
<!-- -->
<!-- Revision 1.1.6.10  1994/06/01  22:06:49  jeff-->
<!-- 	{defect, 10825, R1.1}-->
<!-- 	Correct scout documentation.-->
<!-- 	[1994/06/01  22:05:25  jeff]-->
<!-- -->
<!-- Revision 1.1.6.9  1994/05/06  13:52:23  jeff-->
<!-- 	{defect, 10552, R1.1}-->
<!-- 	Fix index entry inconsistencies.-->
<!-- 	[1994/05/06  13:50:57  jeff]-->
<!-- -->
<!-- Revision 1.1.6.8  1994/04/28  22:21:26  jeff-->
<!-- 	{defect, 10439, R1.1}-->
<!-- 	Correct cross-references for reorganization of DFS documentation.-->
<!-- 	[1994/04/28  22:20:39  jeff]-->
<!-- -->
<!-- Revision 1.1.6.7  1993/10/14  18:56:35  kdu-->
<!-- 	{def,7967,R1.0.3}-->
<!-- 	Scout has Server column heading.-->
<!-- 	[1993/10/14  18:56:12  kdu]-->
<!-- -->
<!-- Revision 1.1.6.6  1993/10/13  20:51:52  tmw-->
<!-- 	Added index entries for second version of master index.-->
<!-- 	[1993/10/13  20:50:41  tmw]-->
<!-- -->
<!-- Revision 1.1.6.5  1993/10/12  19:53:30  kdu-->
<!-- 	{def,6222,R1.0.3}-->
<!-- 	Document the DFS Trace Facility.-->
<!-- 	Made additional changes for 6222.-->
<!-- 	[1993/10/12  19:51:24  kdu]-->
<!-- -->
<!-- Revision 1.1.6.4  1993/10/12  17:15:33  kdu-->
<!-- 	{def,6222,R1.0.3}-->
<!-- 	Document the DFS Trace Facility.-->
<!-- 	[1993/10/12  17:15:03  kdu]-->
<!-- -->
<!-- Revision 1.1.6.4  1993/10/01  17:41:22  kdu-->
<!-- 	Test of new doc tree.-->
<!-- 	[1993/10/01  17:40:25  kdu]-->
<!-- -->
<!-- Revision 1.1.6.3  1993/08/10  23:47:40  jeff-->
<!-- 	Changed versions for defect fixes from 1.0.2A to 1.0.3.-->
<!-- 	[1993/08/10  23:47:11  jeff]-->
<!-- -->
<!-- Revision 1.1.6.2  1993/07/30  18:11:47  kdu-->
<!-- 	{def,8386,R1.0.3}-->
<!-- 	Incorporate OSF editorial comments into DFS Admin Guide and related-->
<!-- 	documentation.-->
<!-- 	[1993/07/30  18:10:38  kdu]-->
<!-- -->
<!-- Revision 1.1.4.5  1993/02/22  17:35:15  jeff-->
<!-- 	Fix for defect 7219, review comments.-->
<!-- 	[1993/02/22  17:34:52  jeff]-->
<!-- -->
<!-- Revision 1.1.4.4  1993/01/28  19:04:55  dbelch-->
<!-- 	Embedding copyright notice-->
<!-- 	[1993/01/28  18:28:46  dbelch]-->
<!-- -->
<!-- Revision 1.1.4.3  1993/01/27  21:10:36  buckler-->
<!-- 	Fixed cross-refs and figure calls for new book org-->
<!-- 	[1993/01/27  21:06:21  buckler]-->
<!-- -->
<!-- Revision 1.1.4.2  1992/08/26  12:09:00  weir-->
<!-- 	Moved to dce1.0.2doc-->
<!-- 	[1992/08/26  12:05:10  weir]-->
<!-- -->
<!-- Revision 1.1.2.3  1992/06/07  02:07:47  jeff-->
<!-- 	Clarified the description of the DCE pathname used to-->
<!-- 	specify a server machine.-->
<!-- 	[1992/06/07  00:02:44  jeff]-->
<!-- -->
<!-- Revision 1.1.2.2  1992/05/12  16:01:18  jeff-->
<!-- 	Verified and/or modified italics and other editorial-->
<!-- 	aspects of the file.-->
<!-- 	[1992/05/12  14:29:16  jeff]-->
<!-- -->
<!-- Revision 1.1  1992/01/29  16:14:34  damon-->
<!-- 	Initial revision-->
<!-- -->
<!---->
<!-- (c) Copyright 1991, Open Software Foundation, Inc.  ALL RIGHTS RESERVED-->
<!--Copyright (C) 1989, 1991, Transarc Corporation-->
<!--The Gulf Tower-->
<!--707 Grant Street-->
<!--Pittsburgh, PA  15219-->
<!-- CHANGED-->
<!-- 12-10-91:  In Section 11.2, moved the colon outside the italic region-->
<!--            in the first line of the fifth item of the nested list.-->
<!-- 12-10-91:  In Section 11.2, removed the paragraph break between 95% and-->
<!--            used in the last item of the nested list (Disk attn item).-->
<!-- END CHANGED-->
<Chapter Id="DFSAGR.SCOUT.div.1">
<Title>Monitoring and Tracing Tools</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.1">
<Primary>File Exporter</Primary>
<Secondary>monitoring</Secondary>
</IndexTerm>
<Para>DFS provides two tools to help you monitor and probe the file system:
</Para>
<ItemizedList>
<ListItem>
<Para>The <Command>scout</Command> program is used to monitor the File Exporter process on a File
Server machine.
</Para>
</ListItem>
<ListItem>
<Para>The <Command>dfstrace</Command> command suite is used to diagnose problems associated with
the DFS kernel or with DFS server processes.
</Para>
</ListItem>
</ItemizedList>
<Sect1 Id="DFSAGR.SCOUT.div.2">
<Title>Monitoring File Exporters with the scout Program</Title>
<Para>The <Command>scout</Command> program can help you monitor the File Exporter running on
any File Server machine.  When you use <Command>scout</Command>, it periodically collects
statistics from the File Server machines that you specify and displays the
information in a graphical format.  The program has several useful features:
</Para>
<ItemizedList>
<ListItem>
<Para>You can monitor the File Exporters on several File Server machines, including
the local machine and machines in other cells, from one location.
<?sml-break><?sml-need 20></Para>
</ListItem>
<ListItem>
<IndexTerm Id="DFSAGR.SCOUT.indx.2">
<Primary>attention thresholds</Primary>
</IndexTerm>
<Para>You can set attention thresholds for many of the statistics.  When a value
exceeds the specified threshold, <Command>scout</Command> highlights it with reverse video;
when the value drops below the threshold, <Command>scout</Command> removes the highlighting.
</Para>
</ListItem>
<ListItem>
<Para>If the File Exporter on a machine does not respond to <Command>scout</Command>'s probes,
the program highlights the machine's name on the screen and blanks the other
fields for the machine.  When the File Exporter returns to service, the machine
name and the statistics are again displayed normally.
</Para>
</ListItem>
</ItemizedList>
<Sect2 Id="DFSAGR.SCOUT.div.3">
<Title>An Overview of the scout Program</Title>
<Para>You can run <Command>scout</Command> from any machine configured as a DFS client or server.
In a standard configuration, the binary file for <Command>scout</Command> is stored in the
<Symbol Role="Variable">dceshared</Symbol><Filename>/bin/scout</Filename> file.  Both terminals and windowing systems that
emulate terminals can display <Command>scout</Command>'s statistics; the display appears
best on systems that support reverse video and cursor addressing.
</Para>
<Para>When using <Command>scout</Command>, set the <Literal>TERM</Literal> environment variable (or its
equivalent) to the correct terminal type or to one with characteristics
similar to the actual ones.  Do not resize the window while <Command>scout</Command> is
running; the program does not adjust to the new dimensions if the window is
made larger, and, if it is made smaller, the columns may not align properly.
To resize the window, stop <Command>scout</Command>, resize the window, and then restart
the program.
</Para>
<Para>Although no special privileges are required to run <Command>scout</Command>, it is useful
primarily for system administrators who need to monitor File Exporter usage.
While <Command>scout</Command> imposes only a minimal burden on the File Exporter on a File
Server machine, you may wish to place the binary file for the program in a
secure directory that is available only to administrative users.  Other users
are then prevented from needlessly running the program.
</Para>
<Para>You can run multiple <Command>scout</Command> processes from a single machine; because the
<Command>scout</Command> program must run in the foreground, each instance runs in a
separate, dedicated window.  You can also run <Command>scout</Command> on several machines
and view the output on a single machine.  To do this, open several windows on
one machine, log into different remote machines in each window (by using
<Command>telnet</Command> or an appropriate program), and run <Command>scout</Command> in the windows.
You may find it useful to include the <Option>host</Option> option with the <Command>scout</Command>
command; this option marks each window with the name of the host machine that
is running the program.
</Para>
<Para>You use the <Option>server</Option> option of the <Command>scout</Command> command to indicate each
File Server machine whose File Exporter is to be monitored.  You can specify
machines by DCE pathname, hostname, or IP address.
</Para>
<Para>In most cells, the DCE pathnames of all File Server machines share the same
basename, or common DCE prefix; for example, all File Server machines in the
cell <Replaceable>abc.com</Replaceable> have DCE pathnames of the form
<Replaceable>/.../abc.com/hosts/</Replaceable><Symbol Role="Variable">hostname</Symbol>.  If all of the machines to be monitored
have the same DCE pathname prefix, you can specify the common prefix
(for example, <Replaceable>/.../abc.com/hosts</Replaceable>) with the <Option>basename</Option> option and
specify only the unique part of each machine name (for example, <Literal>fs1</Literal> or
<Literal>fs2</Literal>) with the <Option>server</Option> option.  If you use the <Option>basename</Option>
option, the common prefix you specify is displayed on the screen (see Section
11.1.2).
</Para>
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.4">
<Title>The scout Screen</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.3">
<Primary><Command>scout</Command> command</Primary>
<Secondary>screen format</Secondary>
</IndexTerm>
<Para>The output generated by the <Command>scout</Command> program appears in the following three
main regions on the screen:
</Para>
<ItemizedList>
<ListItem>
<Para>The banner line at the top of the screen displays the word <ComputerOutput>scout</ComputerOutput>,
indicating that the program is running; it can display additional information
if you include the following options:
</Para>
<ItemizedList>
<ListItem>
<Para>The <Option>host</Option> option displays the name of the machine executing the
<Command>scout</Command> program.
</Para>
</ListItem>
<ListItem>
<Para>The <Option>basename</Option> option, if specified, displays the common DCE pathname
prefix of all File Server machines being monitored.
</Para>
</ListItem>
</ItemizedList>
</ListItem>
<ListItem>
<Para>The statistics display region comprises the majority of the window.  In this
region, <Command>scout</Command> displays the statistics gathered for each File Exporter;
it displays each File Exporter on its own line.  The area is divided into six
columns, with the following labels and information:
</Para>
<ItemizedList>
<ListItem>
<Para><ComputerOutput>Conn</ComputerOutput>
</Para>
<Para>The number of open connections with principals.  This column
displays the number of connections that principals (users and machines) have
open to the File Exporter.  This number usually exceeds the number in the
<ComputerOutput>Ws</ComputerOutput> column, which shows the number of active client machines, because
each user on a machine can have several separate connections open at once and
because one client machine can handle several users.
</Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>Fetch</ComputerOutput>
</Para>
<Para>The number of fetches sent from client machines to the File
Exporter.  A fetch is an RPC requesting that the File Exporter send data.  The
statistic represents the number of fetches since the File Exporter started;
it is reset to 0 (zero) whenever the File Exporter restarts.
</Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>Store</ComputerOutput>
</Para>
<Para>The number of stores sent from client machines to the File
Exporter.  A store is an RPC requesting that the File Exporter store data.  The
statistic represents the number of stores since the File Exporter started; it
is reset to 0 (zero) whenever the File Exporter restarts.
</Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>Ws</ComputerOutput>
</Para>
<Para>The number of active client machines.  This column shows the number of
client machines that have communicated with the File Exporter in the last 15
minutes.  This number is usually smaller than the value for <ComputerOutput>Conn</ComputerOutput> because
a single client machine can have several connections open to one server.
</Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>Server</ComputerOutput>
</Para>
<Para>The File Server machine name.  This column contains the name of
the File Server machine where the File Exporter is running.  Names are shortened
to display only the first 10 characters of the unique part of each machine
name, which are the characters that follow the <Literal>hosts</Literal> element of a DCE
pathname.  If two or more machines from different cells have a common name
(for example, <Replaceable>/.../abc.com/hosts/fs1</Replaceable> and <Replaceable>/.../def.com/hosts/fs1</Replaceable>),
the name of each cell followed by a colon is displayed before the name of each
machine (<Replaceable>abc.com:fs1</Replaceable> and <Literal>def.com:fs1</Literal>).  If the name of a File Server
machine is too long for the width of the column, an <Literal>*</Literal> (asterisk) can
appear in place of one or more characters in the name.
<?sml-break><?sml-need 20></Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>Disk attn</ComputerOutput>
</Para>
<Para>The disk usage.  This column displays the number of kilobyte
blocks available on each DFS aggregate on the File Server machine.  For example,
a value of <ComputerOutput>/dev/lv01:8949</ComputerOutput> indicates that the aggregate <Filename>/dev/lv01</Filename>
has 8949 kilobyte blocks free.  If the window is not wide enough for all of
the aggregate names, <Command>scout</Command> automatically creates subcolumns for the
information.  As with the names of server machines, if the name of an aggregate
is too long for the width of the column, an <Literal>*</Literal> (asterisk) can appear in
place of one or more characters in the name.
</Para>
<Para>The label on this column indicates the threshold value at which entries become
highlighted.  By default, <Command>scout</Command> highlights the entry for any aggregate
that is over 95% full.  Therefore, the default label for this column appears as
<ComputerOutput>Disk attn:> 95% used</ComputerOutput>.
</Para>
</ListItem>
</ItemizedList>
<Para>For all columns except the <ComputerOutput>Server</ComputerOutput> column, you can use the
<Option>attention</Option> option to set a threshold at which entries in the column are
highlighted.  This notifies you that a certain value is exceeded. <ComputerOutput>Disk
attn</ComputerOutput> is the only statistic with a preset default.
</Para>
</ListItem>
<ListItem>
<Para>The message/probe line at the bottom of the screen indicates how many times
<Command>scout</Command> probed the File Exporters for statistics.  By default, <Command>scout</Command>
probes every 60 seconds; you can use the <Option>frequency</Option> option to specify a
different rate of time.
</Para>
</ListItem>
</ItemizedList>
<IndexTerm Id="DFSAGR.SCOUT.indx.4" SpanEnd="DFSAGR.SCOUT.indx.3">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.5">
<Title>Setting Attention Thresholds</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.5">
<Primary>attention thresholds</Primary>
<Secondary>setting</Secondary>
</IndexTerm>
<IndexTerm Id="DFSAGR.SCOUT.indx.6">
<Primary><Command>scout</Command> command</Primary>
<Secondary>attention thresholds</Secondary>
</IndexTerm>
<Para>The <Option>attention</Option> option can be used to set the threshold value for all
but the <ComputerOutput>Server</ComputerOutput> column in the display region.  Any threshold that you set
applies to all of the entries in a column; you cannot set thresholds on a
per-machine basis.
</Para>
<Para>You can use more than one argument with the <Option>attention</Option> option; each
argument is a combination of a statistic and a threshold.  Legal values for
statistic/threshold pairs are as follows:
</Para>
<ItemizedList>
<ListItem>
<Para>The <Literal>conn</Literal> <Symbol Role="Variable">connections</Symbol> argument sets the threshold for the maximum
number of connections that principals can have open to the File Exporter before
the value is highlighted.  The highlighting is removed when the value goes below
the threshold.
<?sml-break><?sml-need 20></Para>
</ListItem>
<ListItem>
<Para>The <Literal>fetch</Literal> <Symbol Role="Variable">number_of_fetches</Symbol> argument sets the threshold for the
maximum number of fetches the File Exporter can service before the value is
highlighted.  The highlighting is removed when the File Exporter is restarted.
</Para>
</ListItem>
<ListItem>
<Para>The <Literal>store</Literal> <Symbol Role="Variable">number_of_stores</Symbol> argument sets the threshold for the
maximum number of stores the File Exporter can accept before the value is
highlighted.  The highlighting is removed when the File Exporter is restarted.
</Para>
</ListItem>
<ListItem>
<Para>The <Literal>ws</Literal> <Symbol Role="Variable">active_client_machines</Symbol> argument sets the threshold for the
maximum number of active client machines that the File Exporter can serve
before the value is highlighted; <Command>active</Command> indicates those machines that
communicated with the File Exporter in the past 15 minutes.  The highlighting
is removed when the value goes below the threshold.
</Para>
</ListItem>
<ListItem>
<Para>The <Literal>disk</Literal> <Symbol Role="Variable">percent_full</Symbol><Literal>%</Literal> argument sets the threshold for the
maximum percentage of an aggregate that can contain data before the value is
highlighted.  This threshold is applied to each exported aggregate or partition
on a File Server machine being monitored.  Legal thresholds are integers from 0
(zero) to 99; the default is <ComputerOutput>95% used</ComputerOutput>.  You <Replaceable>must</Replaceable> enter the %
(percent sign) with this threshold; if the % (percent sign) is absent,
<Command>scout</Command> interprets the number as a number of kilobyte blocks.
</Para>
<Para><Literal>or</Literal>
</Para>
<Para>The <Literal>disk</Literal> <Symbol Role="Variable">minimum_blocks_free</Symbol> argument sets the threshold that
determines the minimum number of kilobyte blocks to be available on the
aggregate before the value is highlighted.  This threshold is applied to each
exported aggregate or partition on a File Server machine being monitored.
</Para>
</ListItem>
</ItemizedList>
<Para>To change these attention settings, you must stop and restart <Command>scout</Command>. In
addition, <Command>scout</Command> does not store the settings from previous instances; you
must specify the desired settings each time you start the program.
</Para>
<Para>You cannot set a threshold or control the highlighting in the <ComputerOutput>Server</ComputerOutput>
column.  If the File Exporter on a machine does not respond to <Command>scout</Command>'s
probes, the name is automatically highlighted and the values for that machine
in the other columns are removed.  A lack of response can indicate that a File
Server machine or the network is unavailable.
<?sml-break><?sml-need 20></Para>
<Para>When a machine resumes responding to <Command>scout</Command>'s probes, its name is
displayed without highlighting with the other values on its line of the
display.  If all of the machine names are highlighted simultaneously, a network
outage has possibly disrupted the connections between the File Server machines
and the client machine running <Command>scout</Command>.
</Para>
<Para>The following examples demonstrate the different types of <Option>attention
</Option>settings.  The first example causes <Command>scout</Command> to highlight entries in the
<ComputerOutput>Conn</ComputerOutput> column that exceed 100, entries in the <ComputerOutput>Ws</ComputerOutput> column that exceed
20, and entries in the <ComputerOutput>Disk attn</ComputerOutput> column that reflect aggregate fullness
usage of 75% or more on the machines named <Replaceable>/.../abc.com/hosts/fs1</Replaceable> and
<Replaceable>/.../abc.com/hosts/fs2</Replaceable>:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>scout -server /.../abc.com/hosts/fs1 /.../abc.com/hosts/fs2 \
-attention conn 100 ws 20 disk 75%</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The second example is identical to the previous example, except that
<Command>scout</Command> highlights entries in the <ComputerOutput>Disk attn</ComputerOutput> column that fall below
5000 free blocks:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>scout -server /.../abc.com/hosts/fs1 /.../abc.com/hosts/fs2 \
-attention disk 5000 ws 20 conn 100</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The third example causes <Command>scout</Command> to highlight entries in the <ComputerOutput>Fetch</ComputerOutput>
column that equal or exceed 20,000 fetches:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>scout -server /.../abc.com/hosts/fs1 /.../abc.com/hosts/fs2 \
-attention fetch 20000</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<IndexTerm Id="DFSAGR.SCOUT.indx.7" SpanEnd="DFSAGR.SCOUT.indx.5">
<IndexTerm Id="DFSAGR.SCOUT.indx.8" SpanEnd="DFSAGR.SCOUT.indx.6">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.6">
<Title>Using the scout Program</Title>
<Para>Start the <Command>scout</Command> program by issuing the <Command>scout</Command> command to initialize
it in each window in which you want it to run.  No further commands can be
issued in the window as long as the program is running.  To stop <Command>scout</Command>,
enter the interrupt command (<Literal>&lt;Ctrl-c></Literal> or its equivalent) for your system
in the window in which <Command>scout</Command> is running.
<?sml-break><?sml-need 20></Para>
<Sect3 Id="DFSAGR.SCOUT.div.7">
<Title>Starting the scout Program</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.9">
<Primary><Command>scout</Command> command</Primary>
<Secondary>starting and stopping</Secondary>
</IndexTerm>
<Para>To start the <Command>scout</Command> program, do the following:
</Para>
<OrderedList>
<ListItem>
<Para>Open a command shell window for each instance of <Command>scout</Command> you want to run.
</Para>
</ListItem>
<ListItem>
<Para>Initialize <Command>scout</Command> in each window; note that you will not be able to issue
any further commands in the window as long as <Command>scout</Command> is running:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>scout -server </Command><Symbol Role="Variable">machine</Symbol>... [<Option>basename </Option><Symbol Role="Variable">common_prefix</Symbol>] [<Option>host</Option>] \
[<Option>frequency </Option><Symbol Role="Variable">seconds</Symbol>] [<Option>attention </Option><Symbol Role="Variable">stat/threshold_pair</Symbol>...] \
[<Option>debug </Option><Symbol Role="Variable">filename</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>server</Option> <Symbol Role="Variable">machine</Symbol> option specifies each File Server machine
whose File Exporter is to be monitored.  Use one of the following to indicate
each File Server machine:
</Para>
<ItemizedList>
<ListItem>
<Para>The machine's DCE pathname (for example, <Replaceable>/.../abc.com/hosts/fs1</Replaceable>).  If you
use the <Option>basename</Option> option to specify a pathname prefix common to all
machines to be monitored, you need to provide only the unique suffix of each
machine name; you can omit the common DCE pathname prefix.
</Para>
</ListItem>
<ListItem>
<Para>The machine's hostname (for example, <Literal>fs1.abc.com</Literal> or <Literal>fs1</Literal>).
</Para>
</ListItem>
<ListItem>
<Para>The machine's IP address (for example, <Literal>11.22.33.44</Literal>).
</Para>
</ListItem>
</ItemizedList>
<Para>The <Option>basename</Option> <Symbol Role="Variable">common_prefix</Symbol> option specifies the DCE pathname
prefix (for example, <Replaceable>/.../abc.com/hosts</Replaceable>) common to all File Server
machines specified with the <Option>server</Option> option.  Do not include the <Filename>/</Filename>
(slash) that separates the prefix from the unique part of each machine name;
it is included automatically with the <Option>basename</Option> option.  The basename,
if specified, is displayed in the banner line.
</Para>
<Para>Use this option only if you are specifying the DCE pathname of each File Server
machine to be monitored.  Omit this option if you are specifying the hostnames
or IP addresses of one or more machines.
</Para>
<Para>The <Option>host</Option> option displays the name of the machine running the
<Command>scout</Command> program in the banner line; this is useful if you are logged into
the machine remotely.
</Para>
<Para>The <Option>frequency</Option> <Symbol Role="Variable">seconds</Symbol> option indicates how often the <Command>scout</Command>
program is to probe the File Exporters.  Specify a positive integer as a value
in seconds; the default is 60 seconds.
</Para>
<Para>The <Option>attention</Option> <Symbol Role="Variable">stat/threshold_pair</Symbol> option specifies a list of
attention settings (statistic and threshold pairs); <Command>scout</Command> highlights any
value for a statistic that exceeds its threshold. (See Section 11.1.3 for a
discussion of legal values for this argument.)
</Para>
<Para>The <Option>debug</Option> <Symbol Role="Variable">filename</Symbol> option enables debugging output and directs
it to the specified <Symbol Role="Variable">filename</Symbol>.  Provide a complete pathname for
<Symbol Role="Variable">filename</Symbol>; the current working directory is used by default.  If this
option is omitted, no debugging output is written.
</Para>
<Para>The following example causes <Command>scout</Command> to monitor the File Exporters on the
File Server machines named <Literal>fs1</Literal> and <Literal>fs2</Literal> in the cell named
<Replaceable>abc.com</Replaceable>; the <Option>basename</Option> option is used, so the common DCE prefix
is specified only once, and it appears in the banner line.  The <Command>scout</Command>
program probes the File Exporters every 30 seconds and prints debugging
information to the file named <Replaceable>/.../abc.com/fs/usr/terry/scout.one</Replaceable>.
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>scout -server fs1 fs2 -basename /.../abc.com/hosts -frequency 30 \
-debug /.../abc.com/fs/usr/terry/scout.one</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The following example again instructs <Command>scout</Command> to monitor the File Exporters
on the machines <Literal>fs1</Literal> and <Literal>fs2</Literal> in the cell <Replaceable>abc.com</Replaceable>; the
<Option>basename</Option> option is again used to indicate the common prefix.  The
<Option>host</Option> option is used, so the name of the machine running <Command>scout</Command>
appears in the banner line with the basename prefix.  The <Command>scout</Command> program
highlights an entry in the <ComputerOutput>Fetch</ComputerOutput> column if 30,000 or more fetches are
sent to the File Exporter; the program highlights an entry in the <ComputerOutput>Store</ComputerOutput>
column if 20,000 or more stores are sent to the File Exporter.
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>scout -server fs1 fs2 -b /.../abc.com/hosts -host -attention fetch 30000 \
store 20000</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
</ListItem>
</OrderedList>
<?sml-break>
<?sml-need 20>
</Sect3>
<Sect3 Id="DFSAGR.SCOUT.div.8">
<Title>Stopping the scout Program</Title>
<Para>To stop the <Command>scout</Command> program, enter the interrupt command (<Literal>&lt;Ctrl-c></Literal>
or its equivalent) for your operating system in the <Command>scout</Command> window.
</Para>
</Sect3>
</Sect2>
</Sect1>
<Sect1 Id="DFSAGR.SCOUT.div.9">
<Title>Tracing DFS Kernel and Server Process Events with the dfstrace Command Suite</Title>
<Para>To properly diagnose a DFS problem, it is sometimes necessary to analyze
in detail the workings of the DFS kernel and DFS server processes.  The
<Command>dfstrace</Command> command suite provides commands that allow you to perform
this analysis and related tasks.
<IndexTerm Id="DFSAGR.SCOUT.indx.10">
<Primary><Command>scout</Command> command</Primary>
<Secondary>starting and stopping</Secondary>
</IndexTerm><IndexTerm Id="DFSAGR.SCOUT.indx.11" SpanEnd="DFSAGR.SCOUT.indx.1"></Para>
<Sect2 Id="DFSAGR.SCOUT.div.10">
<Title>An Overview of the dfstrace Command Suite</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.12">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary>overview</Secondary>
</IndexTerm>
<Para>The <Command>dfstrace</Command> command suite allows a system administrator to manipulate
the two main elements of the underlying DFS trace facility: the event set and
the trace log.
</Para>
<Para>An <Replaceable>event set</Replaceable> is a logical grouping of related kernel or server process
events.  Events with similar characteristics are grouped into event sets to aid
in the diagnosis of specific types of problems.  When an event in an event set
occurs, a message is logged to each appropriate trace log; event set
information from one event set can be written to from one to eight trace logs.
</Para>
<Para>An event set can be in one of three states:
</Para>
<ItemizedList>
<ListItem>
<Para><ComputerOutput>active</ComputerOutput> &minus; Tracing is enabled for the event set.
</Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>inactive</ComputerOutput> &minus; Tracing is temporarily disabled for the event set; however,
the event set continues to claim space occupied by the logs to which it sends
data.
</Para>
</ListItem>
<ListItem>
<Para><ComputerOutput>dormant</ComputerOutput> &minus; Tracing is disabled for the event set; furthermore, the event
set releases its claim to space occupied by the logs to which it sends data.
When all of the event sets that send data to a particular log are in this
state, the space for that log is deallocated.
</Para>
</ListItem>
</ItemizedList>
<Para>Following are some of the DFS kernel event sets that you can trace:
</Para>
<ItemizedList>
<ListItem>
<Para><Command>cm</Command> &minus; Cache Manager package
</Para>
</ListItem>
<ListItem>
<Para><Literal>fshost</Literal> &minus; File exporter host package
</Para>
</ListItem>
<ListItem>
<Para><Literal>fx</Literal> &minus; File exporter package
</Para>
</ListItem>
<ListItem>
<Para><Literal>episode</Literal>/<Literal>anode</Literal> &minus; DCE LFS anode package
</Para>
</ListItem>
<ListItem>
<Para><Literal>episode</Literal>/<Literal>logbuf</Literal> &minus; DCE LFS buffer/logging package
</Para>
</ListItem>
<ListItem>
<Para><Literal>episode</Literal>/<Literal>vnops</Literal> &minus; DCE LFS vnode package
</Para>
</ListItem>
<ListItem>
<Para><Literal>tkc</Literal> &minus; Token cache package
</Para>
</ListItem>
<ListItem>
<Para><Literal>tkm</Literal> &minus; Token manager package
</Para>
</ListItem>
<ListItem>
<Para><Literal>tpq</Literal> &minus; Thread pool queue package
</Para>
</ListItem>
<ListItem>
<Para><Literal>xops</Literal> &minus; Vnode-to-fileset synchronization package
</Para>
</ListItem>
</ItemizedList>
<Para>Following are some of the server process event sets that you can trace:
</Para>
<ItemizedList>
<ListItem>
<Para><Command>bosserver</Command> &minus; <Command>bosserver</Command> package
</Para>
</ListItem>
<ListItem>
<Para><Literal>dacl</Literal> &minus; DFS ACL package
</Para>
</ListItem>
<ListItem>
<Para><Literal>dfsauth</Literal>  &minus; DFS security package
</Para>
</ListItem>
<ListItem>
<Para><Command>flserver</Command> &minus; <Command>flserver</Command> package
</Para>
</ListItem>
<ListItem>
<Para><Command>ftserver</Command> &minus; <Command>ftserver</Command> package
</Para>
</ListItem>
<ListItem>
<Para><Literal>ftutil</Literal> &minus; Fileset utility package
</Para>
</ListItem>
<ListItem>
<Para><Literal>ubikdisk</Literal> &minus; Disk I/O subset of Ubik package
</Para>
</ListItem>
<ListItem>
<Para><Literal>ubikvote</Literal> &minus; Sync site election subset of Ubik package
</Para>
</ListItem>
</ItemizedList>
<Para>A <Replaceable>trace log</Replaceable> is a piece of memory within the kernel or server process
where event information is written when an event associated with an
<ComputerOutput>active</ComputerOutput> event set occurs.  Multiple event sets that contain related events
often write information to the same log to aid in problem diagnosis.  Every
trace log has a default size assigned to it; however, the size of a log can be
increased or decreased.
</Para>
<Para>A trace log can either be <ComputerOutput>allocated</ComputerOutput> or <ComputerOutput>deallocated</ComputerOutput>:
</Para>
<ItemizedList>
<ListItem>
<Para>When a trace log is <ComputerOutput>allocated</ComputerOutput>, space is allocated for it in the kernel or
server process memory.  A trace log is <ComputerOutput>allocated</ComputerOutput> when one or more of the
event sets that write to the log are either active or inactive.
</Para>
</ListItem>
<ListItem>
<Para>When a trace log is <ComputerOutput>deallocated</ComputerOutput>, no space is allocated for the log in
the kernel or server process memory.  A trace log is <ComputerOutput>deallocated</ComputerOutput> when all
of the event sets that write to the log are dormant.
</Para>
</ListItem>
</ItemizedList>
<Para>Both event sets and trace logs can have a persistence attribute permanently
assigned to them.  If an event set is <ComputerOutput>persistent</ComputerOutput>, its state cannot be set
as part of a global event set state setting (performed with the <Command>dfstrace
setset</Command> command), but its state can be manipulated if indicated explicitly.
If a trace log is <ComputerOutput>persistent</ComputerOutput>, it cannot be cleared as part of a global
log clearing (performed with the <Command>dfstrace clear</Command> command), but it can be
cleared if indicated explicitly.
</Para>
<Sect3 Id="DFSAGR.SCOUT.div.11">
<Title>The dfstrace Commands</Title>
<Para>The <Command>dfstrace</Command> commands allow you to manipulate the event sets and trace
logs that make up the underlying DFS trace facility.  You can perform the
following functions with the <Command>dfstrace</Command> commands:
</Para>
<ItemizedList>
<ListItem>
<Para>List information about event sets with the <Command>dfstrace lsset</Command> command.  You
can list event sets and get state and persistence information on each set.
</Para>
</ListItem>
<ListItem>
<Para>Set an event set's state with the <Command>dfstrace setset</Command> command.  You can set
an event set's state to <ComputerOutput>active</ComputerOutput>, <ComputerOutput>inactive</ComputerOutput>, or <ComputerOutput>dormant</ComputerOutput>.
</Para>
</ListItem>
<ListItem>
<Para>List information about trace logs with the <Command>dfstrace lslog</Command> command.  You
can list trace logs and get size and allocation information on each log.
</Para>
</ListItem>
<ListItem>
<Para>Change the size of trace logs with the <Command>dfstrace setlog</Command> command.  The size
of trace logs are specified in 4-kilobyte units (kwords).
</Para>
</ListItem>
<ListItem>
<Para>Dump the contents of trace logs with the <Command>dfstrace dump</Command> command.  You can
dump kernel trace logs to standard output or to a file; you can also
continuously dump a kernel trace log.  You can dump server process logs to a
file only.
</Para>
</ListItem>
<ListItem>
<Para>Clear trace logs with the <Command>dfstrace clear</Command> command.  You can completely
remove the current contents of one or more trace logs.
</Para>
</ListItem>
</ItemizedList>
<IndexTerm Id="DFSAGR.SCOUT.indx.13" SpanEnd="DFSAGR.SCOUT.indx.12">
</Sect3>
<Sect3 Id="DFSAGR.SCOUT.div.12">
<Title>General Recommendations for Diagnosing DFS Problems</Title>
<Para>Use the following general guidelines when diagnosing a DFS problem:
</Para>
<OrderedList>
<ListItem>
<Para>When a problem occurs, determine the event sets related to the problem and set
their states to <ComputerOutput>active</ComputerOutput> using the <Command>dfstrace setset</Command> command.  Messages
from multiple event sets are indistinguishable from each other if they are
written to a single log; therefore, by disabling event sets whose events are
unrelated to a problem, you can more easily diagnose that problem.
</Para>
</ListItem>
<ListItem>
<Para>If a problem is reproducible, clear the appropriate logs with the <Command>dfstrace
clear</Command> command and reproduce the problem.  If the problem is not easily
reproduced, keep tracing enabled until the problem recurs.
</Para>
</ListItem>
<ListItem>
<Para>Dump the appropriate logs using the <Command>dfstrace dump</Command> command.
</Para>
</ListItem>
</OrderedList>
<Note>
<Para>When you are not diagnosing problems, set all event sets to the <ComputerOutput>dormant</ComputerOutput>
state using the <Command>dfstrace setset</Command> command.  When tracing is enabled, system
performance is affected.
</Para>
</Note>
</Sect3>
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.13">
<Title>Standard Information on the dfstrace Command Suite</Title>
<Para>This section presents options and arguments common to many of the
<Command>dfstrace</Command> commands described in this chapter.  It also presents a common
operation that can be useful when performing <Command>dfstrace</Command> operations.
</Para>
<Sect3 Id="DFSAGR.SCOUT.div.14">
<Title>Standard Options and Arguments</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.14">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary>options</Secondary>
</IndexTerm>
<Para>The following options and arguments are used with many of the <Command>dfstrace</Command>
commands described in this chapter.  If an option or argument is not described
with a command in the text, a description of it appears here. (See Part 2 of
this guide and reference for complete details about each command.)
<?sml-break><?sml-need 20></Para>
<ItemizedList>
<ListItem>
<Para>The <Option>log</Option> <Symbol Role="Variable">log_name</Symbol> option specifies the name of a server process
or kernel trace log to be utilized by the command.  All logs are stored in
kernel or server process memory that is allocated on the initialization of the
kernel or server process.  The default size of a log, which is measured in
kwords, is predefined; however, this size can be changed.  Any number of event
sets can write to a single log.
</Para>
</ListItem>
<ListItem>
<Para>The <Option>cdsentry</Option> <Symbol Role="Variable">server_entry_in_CDS</Symbol> option specifies the name of a
server process to which to connect.  This option is required when performing
operations on server process logs and event sets; it must be omitted when
performing operations on kernel logs and event sets.  The full DCE pathname of
a server process must be specified with this option
(<Filename>/.:/hosts/</Filename><Symbol Role="Variable">machine</Symbol><Filename>/</Filename><Symbol Role="Variable">process_name</Symbol>).
</Para>
</ListItem>
</ItemizedList>
</Sect3>
<Sect3 Id="DFSAGR.SCOUT.div.15">
<Title>Determining Administrative Privilege</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.15">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary>determining appropriate privileges</Secondary>
</IndexTerm>
<Para>To perform the majority of <Command>dfstrace</Command> commands on a server process event
set or log, the issuer must be listed in the appropriate administrative list
(for example, <Filename>admin.fl</Filename> for the <Command>flserver</Command> process and <Filename>admin.ft</Filename>
for the <Command>ftserver</Command> process).  To determine the members of a list, issue the
<Command>bos lsadmin</Command> command:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>bos lsadmin -server </Command><Symbol Role="Variable">machine</Symbol> <Option>adminlist</Option> <Symbol Role="Variable">filename</Symbol>
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>server </Option><Symbol Role="Variable">machine</Symbol> option names the server machine that houses the
administrative list whose principals and groups are to be displayed.  The BOS
Server on this machine executes the command.  Specify the File Server machine
using the machine's DCE pathname, the machine's hostname, or the machine's
IP address.
</Para>
<Para>The <Option>adminlist</Option> <Symbol Role="Variable">filename</Symbol> option specifies that members of the
administrative list <Symbol Role="Variable">filename</Symbol> to be listed.
</Para>
<Note>
<Para>To perform <Command>dfstrace</Command> commands on a kernel event set or log, the issuer
must be logged into the local machine as <Literal>root</Literal>.
</Para>
</Note>
<?sml-break>
<?sml-need 20>
</Sect3>
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.16">
<Title>Listing Information about Event Sets</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.16">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary><Command>lsset</Command></Secondary>
</IndexTerm>
<Para>The <Command>dfstrace lsset</Command> command provides state and persistence information on
specified event sets.  To list information about event sets, do the following:
</Para>
<OrderedList>
<ListItem>
<Para>Verify that you have the necessary privilege.  To list information about a
kernel event set, you must be logged in as <Literal>root</Literal> on the local machine.
To list information about a server process event set, you must be listed in
the administrative list associated with that process on the corresponding
machine; if necessary, issue the <Command>bos lsadmin</Command> command to check.
</Para>
</ListItem>
<ListItem>
<Para>Issue the <Command>dfstrace lsset</Command> command to list information about each 
specified event set:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>dfstrace lsset</Command> [<Option>set </Option><Symbol Role="Variable">set_name</Symbol>...] \
[<Option>cdsentry </Option><Symbol Role="Variable">server_entry_in_CDS</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>set </Option><Symbol Role="Variable">set_name</Symbol> option specifies the name of each event set you
want to list.  Omit this option to list all kernel event sets on the local
machine or all server process event sets for the server process specified
with the <Option>cdsentry</Option> option.
</Para>
<Para>The command lists each event set and its state; if the event set is persistent,
the word <ComputerOutput>persistent</ComputerOutput> appears after the state.  If an event set is
<ComputerOutput>persistent</ComputerOutput>, its state cannot be set during a global state setting
(executed by issuing the <Command>dfstrace setset</Command> command with the <Option>set</Option>
option).  Of course, the event set's state can still be set if the event set
is otherwise specified with the <Command>dfstrace setset</Command> command.  The
<ComputerOutput>persistent</ComputerOutput> attribute prevents accidental resetting of an event set's
state.  The attribute is assigned to an event set when the kernel or server
process is compiled and it cannot be changed.
</Para>
</ListItem>
</OrderedList>
<Para>The following command lists all kernel event sets and their states on the 
local machine:
<?sml-break><?sml-need 20></Para>
<InformalExample>
<Para><ProgramListing><UserInput># <Command>dfstrace lss</Command>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing>Available sets:
cm: active
fx: active
fshost: active
xops: active
episode/anode: dormant
episode/logbuf: dormant
episode/vnops: dormant
tkc: inactive
tpq: active
tkm: active
</ProgramListing></Para>
</InformalExample>
<Para>The following command lists state information on the event set <Literal>ubikvote</Literal> 
for the <Command>flserver</Command> process on the machine named <Literal>fs1</Literal>:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>dfstrace lss -set ubikvote -cdsentry /.:/hosts/fs1/flserver</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing>ubikvote: active
</ProgramListing></Para>
</InformalExample>
<IndexTerm Id="DFSAGR.SCOUT.indx.17" SpanEnd="DFSAGR.SCOUT.indx.16">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.17">
<Title>Setting an Event Set's State</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.18">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary><Command>setset</Command></Secondary>
</IndexTerm>
<Para>An event set's state determines whether information on the events in that event
set is logged to the event set's trace logs.  To set an event set's  state, do
the following:
</Para>
<OrderedList>
<ListItem>
<Para>Verify that you have the necessary privilege.  To set the state of a kernel
event set, you must be logged in as <Literal>root</Literal> on the local machine.  To set
the state of a server process event set, you must be listed in the
administrative list associated with that process on the corresponding machine;
if necessary, issue the <Command>bos lsadmin</Command> command to check.
<?sml-break><?sml-need 20></Para>
</ListItem>
<ListItem>
<Para>Issue the <Command>dfstrace setset</Command> command to set the state of each specified
event set:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>dfstrace setset</Command> [<Option>set </Option><Symbol Role="Variable">set_name</Symbol>...] [{<Option>active</Option> | \
<Option>inactive</Option> | <Option>dormant</Option>}] [<Option>cdsentry </Option><Symbol Role="Variable">server_entry_in_CDS</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>set </Option><Symbol Role="Variable">set_name</Symbol> option specifies the name of each event set whose
state you want to set.  Omit this option to set the state for all
non<ComputerOutput>persistent</ComputerOutput> kernel event sets on the local machine or all
non<ComputerOutput>persistent</ComputerOutput> server process event sets for the server process specified
with the <Option>cdsentry</Option> option.
</Para>
<Para>The <Option>active</Option> option sets the state of each specified event set to
<ComputerOutput>active</ComputerOutput>.  This option enables tracing for each specified event set.  Use
this option or the <Option>inactive</Option> or <Option>dormant</Option> option.
</Para>
<Para>The <Option>inactive</Option> option sets the state of each specified event set to
<ComputerOutput>inactive</ComputerOutput>.  This option disables tracing for each specified event set;
however, each event set continues to claim space occupied by each log to which
it sends data.  Use this option or the <Option>active</Option> or <Option>dormant</Option> option.
</Para>
<Para>The <Option>dormant</Option> option sets the state of each specified event set to
<ComputerOutput>dormant</ComputerOutput>.  This option disables tracing for each event set; furthermore,
each event set releases its claim to space occupied by each log to which it
sends data.  Use this option or the <Option>active</Option> or <Option>inactive</Option> option.
</Para>
</ListItem>
</OrderedList>
<Para>The following command sets the event state of all non-<ComputerOutput>persistent</ComputerOutput> kernel
event sets on the local machine to <ComputerOutput>inactive</ComputerOutput>:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput># <Command>dfstrace sets -inactive</Command>
</UserInput></ProgramListing></Para>
</InformalExample>
<IndexTerm Id="DFSAGR.SCOUT.indx.19" SpanEnd="DFSAGR.SCOUT.indx.18">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.18">
<Title>Listing Information about Trace Logs</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.20">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary><Command>lslog</Command></Secondary>
</IndexTerm>
<Para>The <Command>dfstrace lslog</Command> command provides size and allocation information on
specified trace logs.  To list information about a trace log, do the following:
<?sml-break><?sml-need 20></Para>
<OrderedList>
<ListItem>
<Para>Verify that you have the necessary privilege.  To list information about a
kernel log, you must be logged in as <Literal>root</Literal> on the local machine.  To list
information about a server process log, you must be listed in the
administrative list associated with that process on the corresponding machine;
if necessary,  issue the <Command>bos lsadmin</Command> command to check.
</Para>
</ListItem>
<ListItem>
<Para>Issue the <Command>dfstrace lslog</Command> command to list information about each specified
log:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>dfstrace lslog</Command> [{<Option>set </Option><Symbol Role="Variable">set_name</Symbol>... | <Option>log </Option><Symbol Role="Variable">log_name</Symbol>...}] \
[<Option>long</Option>] [<Option>cdsentry </Option><Symbol Role="Variable">server_entry_in_CDS</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>set </Option><Symbol Role="Variable">set_name</Symbol> option specifies the name of each event set whose
corresponding logs you want to list.  Specify this option or the <Option>log</Option>
option; omit both to list all kernel logs on the local machine or all server
process logs for the server process specified with the <Option>cdsentry</Option> option.
</Para>
<Para>The <Option>long</Option> option directs the <Command>dfstrace lslog</Command> command to also 
provide information on the size of each log in kwords and 
whether the log is physically allocated in the kernel or server process 
memory.
</Para>
<Para>When run <Replaceable>without</Replaceable> the <Option>long</Option> option, the <Command>dfstrace lslog</Command>
command lists the logs only.  When run with the <Option>long</Option> option, the
command lists the logs, the size of each log in kwords, and the allocation
state of each log.
</Para>
<Para>A log can also be <ComputerOutput>persistent</ComputerOutput>; however, the persistence of a log cannot
currently be determined using <Command>dfstrace</Command> commands.  If a log is
<ComputerOutput>persistent</ComputerOutput>, it cannot be cleared during a global log clearing (executed
by issuing the <Command>dfstrace clear</Command> command without the <Option>set</Option> or
<Option>log</Option> option).  Of course, the log can still be cleared if it is otherwise
named with the <Command>dfstrace clear</Command> command.  The <ComputerOutput>persistent</ComputerOutput> attribute
prevents accidental clearing of important logs.  The attribute is assigned to a
log when the kernel or server process is compiled and cannot be changed.
</Para>
</ListItem>
</OrderedList>
<Para>The following command lists all kernel logs on the local machine:
<?sml-break><?sml-need 20></Para>
<InformalExample>
<Para><ProgramListing><UserInput># <Command>dfstrace lsl</Command>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing>Available logs:
cmfx
DFS syslog
</ProgramListing></Para>
</InformalExample>
<Para>The following command lists all server process logs used by the <Command>flserver</Command>
process on the machine named <Literal>fs1</Literal>; it also provides the size and the
allocation status of each log.
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>dfstrace lsl -long -cdsentry /.:/hosts/fs1/flserver</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing>Available logs:
ubikvote : 30 kwords (allocated)
common : 30 kwords (allocated)
</ProgramListing></Para>
</InformalExample>
<IndexTerm Id="DFSAGR.SCOUT.indx.21" SpanEnd="DFSAGR.SCOUT.indx.20">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.19">
<Title>Changing the Size of Trace Logs</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.22">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary><Command>setlog</Command></Secondary>
</IndexTerm>
<Para>By default, trace logs occupy a specific amount of kernel or server process
memory; however, the size of this memory space can be changed.  To change the
size of a trace log, do the following:
</Para>
<OrderedList>
<ListItem>
<Para>Verify that you have the necessary privilege.  To change the size of a kernel
log, you must be logged in as <Literal>root</Literal> on the local machine.  To change the
size of a server process log, you must be listed in the administrative list
associated with that process on the corresponding machine; if necessary, issue
the <Command>bos lsadmin</Command> command to check.
</Para>
</ListItem>
<ListItem>
<Para>Issue the <Command>dfstrace setlog</Command> command to set the state of each specified
event set:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>dfstrace setlog -log </Command><Symbol Role="Variable">log_name</Symbol> <Option>buffersize </Option><Symbol Role="Variable">4_kilobyte_units</Symbol> \
[<Option>cdsentry </Option><Symbol Role="Variable">server_entry_in_CDS</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>buffersize</Option> option defines the size of the log in kwords. If a
specified log is already allocated, it is cleared and freed when this command
is run, and a new log of the desired size is created.  Otherwise, a log of the
desired size is created when the log is allocated.
</Para>
</ListItem>
</OrderedList>
<Para>The following command sets the size of the <Literal>ubikvote</Literal> server process log
on the machine named <Literal>fs1</Literal> to 120 kilobytes (30 kwords):
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>dfstrace setl ubikvote 30 -cdsentry /.:/hosts/fs1/flserver</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<IndexTerm Id="DFSAGR.SCOUT.indx.23" SpanEnd="DFSAGR.SCOUT.indx.22">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.20">
<Title>Dumping the Contents of Trace Logs</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.24">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary><Command>dump</Command></Secondary>
</IndexTerm>
<Para>To view the information contained in a trace log, you must dump the log. You
can dump a kernel log to standard output or to a file; you can also
continuously dump a kernel log.  You can dump a server process log to a file
only.  To dump a trace log, do the following:
</Para>
<OrderedList>
<ListItem>
<Para>Verify that you have the necessary privilege.  To dump a kernel log, you must be
logged in as <Literal>root</Literal> on the local machine.  To dump a server process log, you
must be listed in the administrative list associated with that process on the
corresponding machine; if necessary, issue the <Command>bos lsadmin</Command> command to
check.
</Para>
</ListItem>
<ListItem>
<Para>Issue the <Command>dfstrace dump</Command> command to dump each specified log:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>dfstrace dump</Command> [{<Option>set </Option><Symbol Role="Variable">set_name</Symbol>... | <Option>follow </Option><Symbol Role="Variable">log_name</Symbol>}] \
[<Option>file </Option><Symbol Role="Variable">output_filename</Symbol>] [<Option>sleep </Option><Symbol Role="Variable">seconds_between_reads</Symbol>] \
[<Option>cdsentry </Option><Symbol Role="Variable">server_entry_in_CDS</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>set </Option><Symbol Role="Variable">set_name</Symbol> option specifies the name of each event set whose
corresponding logs you want to dump.  Specify this option or the <Option>follow</Option>
option; omit both to dump all kernel logs on the local machine or all server
process logs for the server process specified with the <Option>cdsentry</Option> option.
If you specify multiple event sets that point to the same log, that log is
dumped multiple times.
</Para>
<Para>The <Option>follow </Option><Symbol Role="Variable">log_name</Symbol> option specifies the name of a kernel log to
continuously dump.  Process server logs cannot be continuously dumped.  When a
log is continuously dumped, it is also cleared.  Specify this option or the
<Option>set</Option> option; omit both to dump all kernel logs on the local machine or
all server process logs for the server process specified with the
<Option>cdsentry</Option> option.
<?sml-break><?sml-need 20></Para>
<Para>The <Option>file </Option><Symbol Role="Variable">output_filename</Symbol> option indicates the name of a file to
which to write the output of the command.  If the log being dumped is a server
process log, the <Symbol Role="Variable">output_filename</Symbol> cannot contain slashes (/); the file is
automatically placed in the directory <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/dfs/adm</Filename>.
Furthermore, if an <Symbol Role="Variable">output_filename</Symbol> is not provided, the output is placed
in the file <Literal>icl.</Literal><Symbol Role="Variable">server_process_name</Symbol>.  Server process logs cannot be
directly dumped to standard output. (If the output file for a server process
log already exists, the older version is moved to the file
<Symbol Role="Variable">output_filename</Symbol><Literal>.old</Literal>.) If the log being dumped is a kernel log, the
<Symbol Role="Variable">output_filename</Symbol> must specify the full or relative pathname of the output
file.
</Para>
<Para>The <Option>sleep </Option><Symbol Role="Variable">seconds_between_reads</Symbol> option defines the number of seconds
that the command pauses between dumps when dumping a kernel log in continuous
mode.  This option can only be used with the <Option>follow</Option> option.  The default
value is 10 seconds.
</Para>
</ListItem>
</OrderedList>
<Note>
<Para>Sending a <Literal>SIGUSR1</Literal> signal to a server process that supports tracing is
another way of directing the server process to dump the current contents of its logs
into the dump file <Symbol Role="Variable">dcelocal</Symbol><Literal>/var/dfs/adm/icl.</Literal><Symbol Role="Variable">server_process_name</Symbol>.  This is
the only way to dump the logs associated with the <Command>dfsbind</Command> process because
this process does not support an RPC interface.
</Para>
</Note>
<Para>At the beginning of the output of each dump is the date and time at which the
dump began.  Unless the <Option>follow</Option> option is specified, the number of logs
being dumped is displayed.  The content of each log is preceded by a message
identifying the log.
</Para>
<Para>Each log message contains the following three components:
</Para>
<ItemizedList>
<ListItem>
<Para>The timestamp associated with the message
</Para>
</ListItem>
<ListItem>
<Para>The process ID or thread ID associated with the message
</Para>
</ListItem>
<ListItem>
<Para>The message itself
</Para>
</ListItem>
</ItemizedList>
<Para>Every 1024 seconds, a current time message is written to each log if there is 
message activity in the log.  This message has the following format:
</Para>
<InformalExample>
<Para><ProgramListing>time <Symbol Role="Variable">timestamp</Symbol>, pid 0: Current time: <Symbol Role="Variable">unix_time</Symbol>
</ProgramListing></Para>
</InformalExample>
<Para>Use the current time message to determine the actual time associated with each
log message as follows:
<?sml-break><?sml-need 20></Para>
<OrderedList>
<ListItem>
<Para>Locate the log message whose actual time you want to determine. 
</Para>
</ListItem>
<ListItem>
<Para>Search backward through the dump record until you come to a current time
message.
</Para>
</ListItem>
<ListItem>
<Para>If the current time message's timestamp is smaller than the log message's
timestamp, subtract the former from the latter.  If the current time message's
timestamp is larger than the log message's timestamp, add 1024 to the latter
and subtract the former from the result.
</Para>
</ListItem>
<ListItem>
<Para>Add the resulting number to the current time message's <Symbol Role="Variable">unix_time</Symbol> to
determine the log message's actual time.
</Para>
</ListItem>
</OrderedList>
<Para>Because log data is stored in a finite, circular buffer, some of the data can
be overwritten before being read.  If this happens, the following message
appears at the appropriate place in the dump:
</Para>
<InformalExample>
<Para><ProgramListing>Log wrapped; data missing.
</ProgramListing></Para>
</InformalExample>
<Note>
<Para>If this message appears in the middle of a dump, which can happen under load,
it indicates that not all of the log data is being written to the log.
Increasing the size of the log with the <Command>dfstrace setlog</Command> command may
alleviate this problem.
</Para>
</Note>
<Para>The following command dumps the log used by the <Command>cm</Command> kernel event set on
the local machine:
<?sml-break><?sml-need 30></Para>
<InformalExample>
<Para><ProgramListing><UserInput><?sml-size -1>
# <Command>dfstrace dump cm</Command>
<?sml-size +1>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing><?sml-size -1>
DFS Trace Dump -
<?sml-break>   Date: Fri Oct  8 10:18:02 1993
<?sml-break>Found 1 logs.
<?sml-break>Contents of log cmfx:
Log wrapped; data missing.
time 520.211319, pid 25135: found a princ 62b4144 ref 3
time 520.211355, pid 25135: find a princ (fast path) 62b4144, ref 3
time 520.211387, pid 25135: fshs_GetPrincipal END 62b4144, ref 3
time 520.211411, pid 25135: fshs_PutPrincipal 62b4144 ref 3
time 520.219153, pid 25135: Lookup 8005a4d.81c6c35.0.3fe/param.h, \
flags 0x1
time 520.219440, pid 25135: fshs_GetPrincipal START
time 520.219483, pid 25135: fshs_GetHost, cookie 667de00
time 520.219511, pid 25135: fshs_FindHost, cookie 667de00
time 520.219559, pid 25135: find a prime host 62a2068
time 520.219590, pid 25135: find a host in fast path 62a2068
time 520.219625, pid 25135: fshs_FindPrincipal ..
time 715.203951, pid 0: Current time: Mon Sep 20 13:05:15 1993
time 717.969835, pid 24621: fshs_GetPrincipal START
time 717.969881, pid 24621: fshs_GetHost, cookie 66eed80
time 718.969910, pid 24621: fshs_FindHost, cookie 66eed80
time 718.969959, pid 24621: find a prime host 62a2068
<?sml-size +1>
</ProgramListing></Para>
</InformalExample>
<IndexTerm Id="DFSAGR.SCOUT.indx.25" SpanEnd="DFSAGR.SCOUT.indx.24">
</Sect2>
<Sect2 Id="DFSAGR.SCOUT.div.21">
<Title>Clearing Trace Logs</Title>
<IndexTerm Id="DFSAGR.SCOUT.indx.26">
<Primary><Command>dfstrace</Command> command suite</Primary>
<Secondary><Command>clear</Command></Secondary>
</IndexTerm>
<Para>When you are no longer concerned with the information in a trace log, you can
clear that log.  To clear a trace log, do the following:
</Para>
<OrderedList>
<ListItem>
<Para>Verify that you have the necessary privilege.  To clear a kernel log, you must
be logged in as <Literal>root</Literal> on the local machine.  To clear a server process log,
you must be listed in the administrative list associated with that process on
the corresponding machine; if necessary, issue the <Command>bos lsadmin</Command> command
to check.
<?sml-break><?sml-need 20></Para>
</ListItem>
<ListItem>
<Para>Issue the <Command>dfstrace clear</Command> command to clear each specified log:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Command>dfstrace clear</Command> [{<Option>set </Option><Symbol Role="Variable">set_name</Symbol>... | <Option>log </Option><Symbol Role="Variable">log_name</Symbol>...}] \
[<Option>cdsentry </Option><Symbol Role="Variable">server_entry_in_CDS</Symbol>]
</UserInput></ProgramListing></Para>
</InformalExample>
<Para>The <Option>set </Option><Symbol Role="Variable">set_name</Symbol> option specifies the name of each event set whose
logs you want to clear.  Specify this option or the <Option>log</Option> option; omit
both to clear all non<ComputerOutput>persistent</ComputerOutput> kernel logs on the local machine or all
non<ComputerOutput>persistent</ComputerOutput> server process logs for the server process specified with
the <Option>cdsentry</Option> option.
</Para>
</ListItem>
</OrderedList>
<Para>The following command clears all logs used by the <Command>ftserver</Command> process on the
machine named <Literal>fs1</Literal>:
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>dfstrace clear -cdsentry /.:/hosts/fs1/ftserver</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
</Sect2>
</Sect1>
</Chapter>
<!--+ 10/19/96 18:43:16
    | tagMorph:  $Id: scout.sgm,v 1.1.2.6 1996/12/15 23:02:20 wardr Exp $
    | tagMorph library:  $Id: scout.sgm,v 1.1.2.6 1996/12/15 23:02:20 wardr Exp $
    | sml-to-docbook:  1.23
    +-->
