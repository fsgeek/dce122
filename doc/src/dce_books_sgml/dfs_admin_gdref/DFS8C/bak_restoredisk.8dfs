<!--
# @OSF_COPYRIGHT@
# 
# 
# HISTORY
# $Log: bak_restoredisk.8dfs,v $
# Revision 1.1.2.4  1996/11/07  18:41:43  weir
# 	Cleaned up history
# 	[1996/11/07  18:41:22  weir]
#
# Revision 1.1.2.3  1996/10/28  17:43:37  carrig
# 	{enh,R1.2.2}
# 	Ready for editing
# 	[1996/10/28  17:39:28  carrig]
# 
# Revision 1.1.2.2  1996/10/24  19:54:09  carrig
# 	{enh,R1.2.2}
# 	Fixed VarLists
# 	[1996/10/24  19:53:41  carrig]
# 
# Revision 1.1.2.1  1996/10/22  20:54:07  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 	[1996/10/22  20:50:12  wardr]
# 
# Revision 1.1.1.2  1996/10/22  20:50:12  wardr
# 	{edit,R1.2.2}
# 	Initial checkin after sgml conversion
# 
# $EndLog$
-->
<!---->
<!-- Fragment document type declaration subset:
ArborText, Inc., 1988-1993, v.4001
<!DOCTYPE Book PUBLIC "-//Davenport//DTD DocBook V2.4//EN" [
]>
-->
<RefEntry Id="DFSAGR.MAN43.rsml.1">
<RefMeta>
<RefEntryTitle>bak restoredisk</RefEntryTitle>
<ManVolNum>8dfs</ManVolNum>
</RefMeta>
<RefNameDiv>
<RefName><Command>bak restoredisk</Command></RefName>
<RefPurpose><Command>bak restoredisk</Command> &minus; Restores the contents of an entire aggregate from tape
</RefPurpose>
</RefNameDiv>
<!---->
<!-- COPYRIGHT NOTICE-->
<!-- Copyright (c) 1990, 1991, 1992, 1993 Open Software Foundation, Inc.-->
<!--  Copyright (C) 1989, 1991, 1992, 1993 Transarc Corporation-->
<!-- ALL RIGHTS RESERVED (DCE).  See the file named COPYRIGHT.DCE in the-->
<!-- src directory for the full copyright text.-->
<!---->
<!---->
<!-- HISTORY-->
<!-- Revision 1.1.12.1  1996/05/14  20:26:43  wardr-->
<!-- 	{enh,R1.2.2}-->
<!-- 	Removed changebars-->
<!-- 	[1996/05/14  20:22:03  wardr]-->
<!---->
<!-- Revision 1.1.10.2  1995/12/29  17:42:42  wfl-->
<!-- 	{edit R.1.2.1}-->
<!-- 	made copy edits-->
<!-- 	[1995/12/29  17:42:17  wfl]-->
<!-- -->
<!-- Revision 1.1.10.1  1995/10/04  15:03:41  wfl-->
<!-- 	{def, 13140, R1.2.1}-->
<!-- 	Fixed quotes in change markers-->
<!-- 	[1995/10/04  14:20:13  wfl]-->
<!-- -->
<!-- Revision 1.1.8.7  1995/07/13  19:14:32  buckler-->
<!-- 	1.1 edits and Prentice Hall reformat-->
<!-- 	[1995/07/13  19:13:38  buckler]-->
<!-- -->
<!-- Revision 1.1.8.6  1994/07/08  17:30:23  jeff-->
<!-- 	Correct editorial mistakes.-->
<!-- 	[1994/07/08  17:29:50  jeff]-->
<!-- -->
<!-- Revision 1.1.8.5  1994/05/12  19:08:11  jeff-->
<!-- 	{defect, 8118, R1.1}-->
<!-- 	Work release notes into documentation.-->
<!-- 	[1994/05/12  19:07:51  jeff]-->
<!-- -->
<!-- Revision 1.1.8.4  1993/10/08  15:01:23  weir-->
<!-- 	Inserted Transarc copyright-->
<!-- 	[1993/10/08  14:58:11  weir]-->
<!-- -->
<!-- Revision 1.1.8.3  1993/09/16  11:38:18  kdu-->
<!-- 	{def,5778,R1.0.3}-->
<!-- 	Short forms of machine names.-->
<!-- 	[1993/09/16  11:37:54  kdu]-->
<!-- -->
<!-- Revision 1.1.8.2  1993/07/31  02:11:26  tmw-->
<!-- 	Added index entries for second version of master index.-->
<!-- 	[1993/07/31  02:03:18  tmw]-->
<!-- -->
<!-- Revision 1.1.6.6  1993/02/23  21:42:44  jeff-->
<!-- 	Defect fixes for backup documentation (5795, 6832, and 6835).-->
<!-- 	[1993/02/23  21:42:21  jeff]-->
<!-- -->
<!-- Revision 1.1.6.5  1993/02/09  01:38:46  jeff-->
<!-- 	Fix for defect 7156, correct dump/restore restrictions.-->
<!-- 	[1993/02/09  01:36:31  jeff]-->
<!-- -->
<!-- Revision 1.1.6.4  1993/01/28  02:12:25  dbelch-->
<!-- 	Embedding copyright notice-->
<!-- 	[1993/01/28  00:46:40  dbelch]-->
<!-- -->
<!-- Revision 1.1.6.3  1992/12/16  19:01:48  buckler-->
<!-- 	Added intro words to RELATED INFO-->
<!-- 	[1992/12/16  19:00:25  buckler]-->
<!-- -->
<!-- Revision 1.1.6.2  1992/09/10  15:16:28  weir-->
<!-- 	Removed change bar macros; moved into 1.0.2doc tree-->
<!-- 	[1992/09/10  14:11:20  weir]-->
<!-- -->
<!-- Revision 1.1.4.2  1992/09/08  18:54:44  casey-->
<!-- 	Prentice Hall production-->
<!-- 	[1992/09/08  16:48:19  casey]-->
<!-- -->
<!-- Revision 1.1.2.3  1992/06/07  02:26:35  jeff-->
<!-- 	Clarified the description of the DCE pathname used to-->
<!-- 	specify a machine name.-->
<!-- 	[1992/06/07  01:39:28  jeff]-->
<!-- -->
<!-- Revision 1.1.2.2  1992/05/10  16:32:19  jeff-->
<!-- 	Verified and/or modified italics and other editorial-->
<!-- 	aspects of the file.-->
<!-- 	[1992/05/10  16:21:49  jeff]-->
<!-- -->
<!-- Revision 1.1  1992/01/29  15:53:46  damon-->
<!-- 	Initial revision-->
<!-- -->
<!---->
<!-- (c) Copyright 1991, Open Software Foundation, Inc.  ALL RIGHTS RESERVED-->
<!--DOCUMENTSTYLE [12pt]{book}-->
<IndexTerm Id="DFSAGR.MAN43.indx.1">
<Primary><Command>bak</Command> command suite</Primary>
<Secondary><Command>restoredisk</Command></Secondary>
</IndexTerm>
<IndexTerm Id="DFSAGR.MAN43.indx.2">
<Primary>filesets</Primary>
<Secondary>restoring from tape</Secondary>
</IndexTerm>
<IndexTerm Id="DFSAGR.MAN43.indx.3">
<Primary>aggregates</Primary>
<Secondary>restoring contents</Secondary>
</IndexTerm>
<RefSynopsisDiv>
<CmdSynopsis>
<Command>bak restoredisk</Command>
<Arg Choice="plain"><Option>server</Option><Replaceable>machine</Replaceable></Arg>
<Arg Choice="plain"><Option>aggregate</Option><Replaceable>name</Replaceable></Arg>
<Arg Choice="opt"><Option>tcid</Option><Replaceable>tc_number</Replaceable></Arg>
<Arg Choice="opt"><Option>newserver</Option><Replaceable>machine</Replaceable></Arg>
<Arg Choice="opt"><Option>newaggregate</Option><Replaceable>name</Replaceable></Arg>
<Arg Choice="opt"><Option>noaction</Option></Arg>
<Arg Choice="opt"><Option>help</Option></Arg>
</CmdSynopsis>
</RefSynopsisDiv>
<RefSect1>
<Title>ALIAS</Title>
<Para><Command>bak dkrestore</Command>
</Para>
</RefSect1>
<RefSect1>
<Title>OPTIONS</Title>
<VariableList>
<VarListEntry role="linebreak">
<Term><Option>server</Option> <Symbol Role="Variable">machine</Symbol></Term>
<ListItem>
<Para>Names the File Server machine that houses the aggregate you want to restore.
Specify the File Server machine using the machine's DCE pathname, the 
machine's host name, or the machine's IP address.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Option>aggregate</Option> <Symbol Role="Variable">name</Symbol></Term>
<ListItem>
<Para>Specifies the device name or aggregate name of the aggregate on the machine
indicated with the <Option>server</Option> option that you want to restore.  These names
are specified in the first and second fields of the entry for the aggregate in
the <Symbol Role="Variable">dcelocal</Symbol><Filename>/var/dfs/dfstab</Filename> file.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Option>tcid</Option> <Symbol Role="Variable">tc_number</Symbol></Term>
<ListItem>
<Para>Specifies the Tape Coordinator ID (TCID) of the Tape Coordinator for the tape
drive in which you are placing the necessary tapes.  If omitted, it defaults to
<Literal>0</Literal> (zero).
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Option>newserver</Option> <Symbol Role="Variable">machine</Symbol></Term>
<ListItem>
<Para>Names the File Server machine to which to restore the data.  Specify the File
Server machine using the machine's DCE pathname, the machine's host name, or
the machine's IP address.  Use this option only if the destination server is
different from the server specified with the <Option>server</Option> option.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry role="linebreak">
<Term><Option>newaggregate</Option> <Symbol Role="Variable">name</Symbol></Term>
<ListItem>
<Para>Specifies the device name or aggregate name of the aggregate to which to
restore the data.  These names are specified in the first and second fields of
the entry for the aggregate in the <Literal>dfstab</Literal> file.  Use this option only if
the name of the destination aggregate is different from the name of the
aggregate specified with the <Option>aggregate</Option> option.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>noaction</Option></Term>
<ListItem>
<Para>Directs the command to display the list of tapes necessary to perform the
indicated restore without actually performing the operation.
</Para>
</ListItem>
</VarListEntry>
<VarListEntry>
<Term><Option>help</Option></Term>
<ListItem>
<Para>Prints the online help for this command.  All other valid options specified with
this option are ignored.
</Para>
</ListItem>
</VarListEntry>
</VariableList>
</RefSect1>
<RefSect1>
<Title>DESCRIPTION</Title>
<Para>The <Command>bak restoredisk</Command> command restores the contents of the aggregate
specified with the <Option>server</Option> and <Option>aggregate</Option> options to the file
system.  To do this, the <Command>bak</Command> program contacts the Fileset Location Server
(FL Server) for a listing from the Fileset Location Database (FLDB) of all the
filesets that reside on the specified aggregate.  It then consults the Backup
Database to learn which tapes contain the full and incremental dumps needed to
restore every fileset from the aggregate.  This command is useful if a disk or
machine failure destroys the data on an entire aggregate.
</Para>
<Para>To restore filesets from the specified aggregate to the same site (the site
specified with the <Option>server</Option> and <Option>aggregate</Option> options), omit the
<Option>newserver</Option> and <Option>newaggregate</Option> options.  The data in the restored
filesets overwrites the filesets' current contents; there is no change in the
Fileset Location Database (FLDB) entries for the filesets.
</Para>
<Para>To restore the filesets to an alternate site, include the <Option>newserver</Option>
option, the <Option>newaggregate</Option> option, or both.  The filesets continue to use
their existing FLDB entries and fileset ID numbers, and the filesets' FLDB
entries are updated to record the new site.  The current contents of each
fileset are replaced with the data restored from tape.  The command allows you
to restore filesets to a new site as follows:
<!--no-op:  l-->
</Para>
<ItemizedList>
<ListItem>
<Para>To restore the filesets to a different aggregate on the same File Server
machine, specify the new aggregate with the <Option>newaggregate</Option> option.
</Para>
</ListItem>
<ListItem>
<Para>To restore the filesets to an aggregate of the same name on a different File
Server machine, specify the new File Server machine with the <Option>newserver</Option>
option.
</Para>
</ListItem>
<ListItem>
<Para>To restore the filesets to a completely different site, specify the new File
Server machine with the <Option>newserver</Option> option and the new aggregate with the
<Option>newaggregate</Option> option.
</Para>
</ListItem>
</ItemizedList>
<!--no-op:  b-->
<Para><?sml-need 10>If you specify a new site and the filesets to be restored currently exist at
their old site, you must use the <Command>fts zap</Command> command to delete the existing
filesets before issuing the <Command>bak restoredisk</Command> command.  The <Command>bak
restoredisk</Command> command fails if you do not use the <Command>fts zap</Command> command to
delete the existing filesets before using the <Command>bak restoredisk</Command> command
to restore the filesets to the new site.
</Para>
<Note>
<Para>Do not use the <Command>fts delete</Command> command to delete the existing filesets and
their FLDB entries before issuing the <Command>bak restoredisk</Command> command.  If you
use the <Command>fts delete</Command> command instead of the <Command>fts zap</Command> command, you
cannot use the <Command>bak restoredisk</Command> command to restore the filesets; you can
restore the filesets only with the <Command>bak restoreft</Command> command.
</Para>
</Note>
<Para>The <Option>noaction</Option> option instructs the command to produce a list of the tapes
the Backup System would need to perform the indicated restore without actually
performing the operation.  To do so, include the <Option>noaction</Option> option with all
of the other options to be used with the actual command.
</Para>
<Para>Data can be dumped and restored between different types of file systems.  For
example, data dumped from a DCE LFS fileset can be restored to a DCE LFS
fileset or to any type of nonLFS fileset; likewise, data dumped from a
nonLFS fileset can be restored to a DCE LFS fileset or to a different type
of nonLFS fileset. (See your vendor's documentation to verify the level of
support for dump and restore operations between different types of file
systems.)
</Para>
<Para>Restored data is translated into the appropriate format for the file system to
which it is restored.  Note that incompatible information may be lost when a
fileset is dumped and restored between different types of file systems.  For
example, ACLs on objects in a DCE LFS fileset may be lost if the fileset is
restored to a file system that does not support ACLs.
</Para>
<Para>Use the <Command>bak restoreft</Command> command to restore one or more filesets to
a single site. Use the <Command>bak restoreftfamily</Command> command to restore a
fileset family or to restore one or more filesets to the same site or
to different sites.
</Para>
<RefSect2>
<Title>Privilege Required</Title>
<Para>The issuer must be listed in the <Filename>admin.bak</Filename> files on all Backup Database
machines.  The issuer must also be listed in the <Filename>admin.fl</Filename> files on all
Fileset Database machines and in the <Filename>admin.ft</Filename> file on the File Server
machine to which filesets are to be restored.
</Para>
</RefSect2>
</RefSect1>
<RefSect1>
<Title>OUTPUT</Title>
<Para>If you do not include the <Option>noaction</Option> option, the <Command>bak restoredisk</Command>
command returns the unique dump ID number associated with the restore
operation.  The dump ID is displayed in the command window following the
command line and in the Tape Coordinator's monitoring window if the <Command>butc</Command>
command is issued with debug level 1. The dump ID is not the same as the job
ID number visible with the <Literal>(bak) jobs</Literal> command if the <Command>bak
restoredisk</Command> command is issued in interactive mode.
</Para>
<Para><?sml-need 10>If you include the <Option>noaction</Option> option, a <Literal>Tapes needed:</Literal> header is
displayed, followed by a list of the tapes necessary to complete the restore
operation.  No dump ID number is reported because none is assigned.
</Para>
</RefSect1>
<RefSect1>
<Title>EXAMPLES</Title>
<Para>The following command restores the filesets listed in the FLDB as residing on
the aggregate named <Filename>/dev/lv01</Filename> on the File Server machine named <Literal>fs5</Literal>.
The filesets are restored to the same aggregate and server machine.  Tapes are
placed in the drive with a TCID of <Literal>3</Literal>.
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>bak restored /.../abc.com/hosts/fs5 /dev/lv01 3</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing>Starting restore
bak: dump ID of restore operation: 253
bak: Finished doing restore
</ProgramListing></Para>
</InformalExample>
<Para>The following command restores the filesets listed in the FLDB as stored on
the aggregate named <Filename>/dev/lv02</Filename> on the File Server machine named <Literal>fs1</Literal>.
The filesets are restored to a new site, the aggregate <Filename>/dev/lv01</Filename> on the
File Server machine <Literal>fs3</Literal>.  The <Command>fts zap</Command> command is used to delete
existing filesets from the current site before the <Command>bak restoredisk</Command>
command is issued.  Tapes are placed in the drive with a TCID of <Literal>0</Literal> (zero).
</Para>
<InformalExample>
<Para><ProgramListing><UserInput>$ <Literal>bak restored /.../abc.com/hosts/fs1 /dev/lv02 -news /.../abc.com/hosts/fs3 &bsol;
-newa /dev/lv01</Literal>
</UserInput></ProgramListing></Para>
</InformalExample>
<InformalExample>
<Para><ProgramListing>Starting restore
bak: dump ID of restore operation: 256
bak: Finished doing restore
</ProgramListing></Para>
</InformalExample>
</RefSect1>
<RefSect1>
<Title>RELATED INFORMATION</Title>
<!--no-op:  l-->
<Para>Commands: 
<Literal>bak&ensp;dump(8dfs)</Literal>,
<Literal>bak&ensp;restoreft(8dfs)</Literal>,
<Literal>bak restoreftfamily(8dfs)</Literal>,
<Literal>fts&ensp;delete(8dfs)</Literal>,
<Literal>fts&ensp;zap(8dfs)</Literal>.
<!--no-op:  b-->
</Para>
<Para>Files:
<Literal>dfstab(4dfs)</Literal>.
<IndexTerm Id="DFSAGR.MAN43.indx.4" SpanEnd="DFSAGR.MAN43.indx.1"><IndexTerm Id="DFSAGR.MAN43.indx.5" SpanEnd="DFSAGR.MAN43.indx.2"><IndexTerm Id="DFSAGR.MAN43.indx.6" SpanEnd="DFSAGR.MAN43.indx.3"></Para>
</RefSect1>
<!--+ 10/19/96 18:43:16
    | tagMorph:  $Id: bak_restoredisk.8dfs,v 1.1.2.4 1996/11/07 18:41:43 weir Exp $
    | tagMorph library:  $Id: bak_restoredisk.8dfs,v 1.1.2.4 1996/11/07 18:41:43 weir Exp $
    | sml-to-docbook:  1.23
    +-->
</RefEntry>
